!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).CesiumPro={})}(this,(function(t){"use strict";var e=6371008.8,i={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*e,kilometers:6371.0088,kilometres:6371.0088,meters:e,metres:e,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:e/1852,radians:1,yards:6967335.223679999};function n(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function r(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,i)}function o(t,e,i){void 0===i&&(i={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function s(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function a(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function l(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}function u(t,e){void 0===e&&(e="kilometers");var n=i[e];if(!n)throw new Error(e+" units is invalid");return t*n}function c(t,e){void 0===e&&(e="kilometers");var n=i[e];if(!n)throw new Error(e+" units is invalid");return t/n}function h(t){return 180*(t%(2*Math.PI))/Math.PI}function p(t){return t%360*Math.PI/180}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function f(t){return!!t&&t.constructor===Object}function g(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function m(t){return"Feature"===t.type?t.geometry:t}function _(t,e,i){void 0===i&&(i={});var n=g(t),r=g(e),o=p(r[1]-n[1]),s=p(r[0]-n[0]),a=p(n[1]),l=p(r[1]),c=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return u(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),i.units)}function y(t,e,i){if(null!==t)for(var n,r,o,s,a,l,u,c,h=0,p=0,d=t.type,f="FeatureCollection"===d,g="Feature"===d,m=f?t.features.length:1,_=0;_<m;_++){a=(c=!!(u=f?t.features[_].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<a;v++){var C=0,x=0;if(null!==(s=c?u.geometries[v]:u)){l=s.coordinates;var w=s.type;switch(h=!i||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(l,p,_,C,x))return!1;p++,C++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],p,_,C,x))return!1;p++,"MultiPoint"===w&&C++}"LineString"===w&&C++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(r=0;r<l[n].length-h;r++){if(!1===e(l[n][r],p,_,C,x))return!1;p++}"MultiLineString"===w&&C++,"Polygon"===w&&x++}"Polygon"===w&&C++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(x=0,r=0;r<l[n].length;r++){for(o=0;o<l[n][r].length-h;o++){if(!1===e(l[n][r][o],p,_,C,x))return!1;p++}x++}C++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===y(s.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function v(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function C(t,e){var i,n,r,o,s,a,l,u,c,h,p=0,d="FeatureCollection"===t.type,f="Feature"===t.type,g=d?t.features.length:1;for(i=0;i<g;i++){for(a=d?t.features[i].geometry:f?t.geometry:t,u=d?t.features[i].properties:f?t.properties:{},c=d?t.features[i].bbox:f?t.bbox:void 0,h=d?t.features[i].id:f?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,u,c,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],p,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,u,c,h))return!1;p++}}function x(t,e){C(t,(function(t,i,r,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n(t,r,{bbox:o,id:s}),i,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c=t.coordinates[u];if(!1===e(n({type:a,coordinates:c},r),i,u))return!1}}))}function w(t,e,i){var n=i,r=!1;return function(t,e){x(t,(function(t,i,n){var r=0;if(t.geometry){var o=t.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var a,l=0,u=0,c=0;return!1!==y(t,(function(o,h,p,d,f){if(void 0===a||i>l||d>u||f>c)return a=o,l=i,u=d,c=f,void(r=0);var g=s([a,o],t.properties);if(!1===e(g,i,n,f,r))return!1;r++,a=o}))&&void 0}}}))}(t,(function(t,o,s,a,l){n=!1===r&&void 0===i?t:e(n,t,o,s,a,l),r=!0})),n}function b(t,e,i){if(void 0===i&&(i={}),!0===i.final)return function(t,e){var i=b(e,t);return i=(i+180)%360}(t,e);var n=g(t),r=g(e),o=p(n[0]),s=p(r[0]),a=p(n[1]),l=p(r[1]),u=Math.sin(s-o)*Math.cos(l),c=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-o);return h(Math.atan2(u,c))}function E(t,e,i,n){void 0===n&&(n={});var o=g(t),s=p(o[0]),a=p(o[1]),l=p(i),u=c(e,n.units),d=Math.asin(Math.sin(a)*Math.cos(u)+Math.cos(a)*Math.sin(u)*Math.cos(l));return r([h(s+Math.atan2(Math.sin(l)*Math.sin(u)*Math.cos(a),Math.cos(u)-Math.sin(a)*Math.sin(d))),h(d)],n.properties)}function S(t,e,i,n){if(!f(n=n||{}))throw new Error("options is invalid");var r,o=[];if("Feature"===t.type)r=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");r=t.coordinates}for(var a,l,u,c=r.length,h=0,p=0;p<r.length&&!(e>=h&&p===r.length-1);p++){if(h>e&&0===o.length){if(!(a=e-h))return o.push(r[p]),s(o);l=b(r[p],r[p-1])-180,u=E(r[p],a,l,n),o.push(u.geometry.coordinates)}if(h>=i)return(a=i-h)?(l=b(r[p],r[p-1])-180,u=E(r[p],a,l,n),o.push(u.geometry.coordinates),s(o)):(o.push(r[p]),s(o));if(h>=e&&o.push(r[p]),p===r.length-1)return s(o);h+=_(r[p],r[p+1],n)}if(h<e&&r.length===c)throw new Error("Start position is beyond line");var d=r[r.length-1];return s([d,d])}function T(t,e,i){if(!f(i=i||{}))throw new Error("options is invalid");var n=i.units,r=i.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var o=[];return x(t,(function(t){r&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,i,n){var r=function(t,e){return void 0===e&&(e={}),w(t,(function(t,i){var n=i.geometry.coordinates;return t+_(n[0],n[1],e)}),0)}(t,{units:i});if(r<=e)return n(t);var o=r/e;Number.isInteger(o)||(o=Math.floor(o)+1);for(var s=0;s<o;s++){n(S(t,e*s,e*(s+1),{units:i}),s)}}(t,e,n,(function(t){o.push(t)}))})),a(o)}function P(t){var e=[1/0,1/0,-1/0,-1/0];return y(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}P.default=P;var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function I(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function L(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var i=function t(){if(this instanceof t){var i=[null];i.push.apply(i,arguments);var n=Function.bind.apply(e,i);return new n}return e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(i,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})})),i}function N(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=g(t),r=m(e),o=r.type,s=e.bbox,a=r.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(n,s))return!1;"Polygon"===o&&(a=[a]);for(var l=!1,u=0;u<a.length&&!l;u++)if(M(n,a[u][0],i.ignoreBoundary)){for(var c=!1,h=1;h<a[u].length&&!c;)M(n,a[u][h],!i.ignoreBoundary)&&(c=!0),h++;c||(l=!0)}return l}function M(t,e,i){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!i;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(n=!n)}return n}var D=6378137;function R(t){return function(t,e,i){var n=i;return C(t,(function(t,r,o,s,a){n=0===r&&void 0===i?t:e(n,t,r,o,s,a)})),n}(t,(function(t,e){return t+function(t){var e,i=0;switch(t.type){case"Polygon":return O(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=O(t.coordinates[e]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function O(t){var e=0;if(t&&t.length>0){e+=Math.abs(F(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(F(t[i]))}return e}function F(t){var e,i,n,r,o,s,a=0,l=t.length;if(l>2){for(s=0;s<l;s++)s===l-2?(n=l-2,r=l-1,o=0):s===l-1?(n=l-1,r=0,o=1):(n=s,r=s+1,o=s+2),e=t[n],i=t[r],a+=(k(t[o][0])-k(e[0]))*Math.sin(k(i[1]));a=a*D*D/2}return a}function k(t){return t*Math.PI/180}function z(t,e,i){void 0===i&&(i={});for(var n=g(t),r=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(e),o=0;o<r.length-1;o++){var s=!1;if(i.ignoreEndVertices&&(0===o&&(s="start"),o===r.length-2&&(s="end"),0===o&&o+1===r.length-1&&(s="both")),G(r[o],r[o+1],n,s,void 0===i.epsilon?null:i.epsilon))return!0}return!1}function G(t,e,i,n,r){var o=i[0],s=i[1],a=t[0],l=t[1],u=e[0],c=e[1],h=u-a,p=c-l,d=(i[0]-a)*p-(i[1]-l)*h;if(null!==r){if(Math.abs(d)>r)return!1}else if(0!==d)return!1;return n?"start"===n?Math.abs(h)>=Math.abs(p)?h>0?a<o&&o<=u:u<=o&&o<a:p>0?l<s&&s<=c:c<=s&&s<l:"end"===n?Math.abs(h)>=Math.abs(p)?h>0?a<=o&&o<u:u<o&&o<=a:p>0?l<=s&&s<c:c<s&&s<=l:"both"===n&&(Math.abs(h)>=Math.abs(p)?h>0?a<o&&o<u:u<o&&o<a:p>0?l<s&&s<c:c<s&&s<l):Math.abs(h)>=Math.abs(p)?h>0?a<=o&&o<=u:u<=o&&o<=a:p>0?l<=s&&s<=c:c<=s&&s<=l}function B(t,e){var i=m(t),n=m(e),r=i.type,o=n.type;switch(r){case"Point":switch(o){case"MultiPoint":return function(t,e){var i,n=!1;for(i=0;i<e.coordinates.length;i++)if(V(e.coordinates[i],t.coordinates)){n=!0;break}return n}(i,n);case"LineString":return z(i,n,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return N(i,n,{ignoreBoundary:!0});default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"MultiPoint":return function(t,e){for(var i=0;i<t.coordinates.length;i++){for(var n=!1,r=0;r<e.coordinates.length;r++)V(t.coordinates[i],e.coordinates[r])&&(n=!0);if(!n)return!1}return!0}(i,n);case"LineString":return function(t,e){for(var i=!1,n=0;n<t.coordinates.length;n++){if(!z(t.coordinates[n],e))return!1;i||(i=z(t.coordinates[n],e,{ignoreEndVertices:!0}))}return i}(i,n);case"Polygon":case"MultiPolygon":return function(t,e){for(var i=!0,n=!1,r=0;r<t.coordinates.length;r++){if(!(n=N(t.coordinates[1],e))){i=!1;break}n=N(t.coordinates[1],e,{ignoreBoundary:!0})}return i&&n}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"LineString":return function(t,e){for(var i=0;i<t.coordinates.length;i++)if(!z(t.coordinates[i],e))return!1;return!0}(i,n);case"Polygon":case"MultiPolygon":return function(t,e){var i=P(e),n=P(t);if(!U(i,n))return!1;for(var r=!1,o=0;o<t.coordinates.length-1;o++){if(!N(t.coordinates[o],e))return!1;if(r||(r=N(t.coordinates[o],e,{ignoreBoundary:!0})),!r)r=N(H(t.coordinates[o],t.coordinates[o+1]),e,{ignoreBoundary:!0})}return r}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Polygon":case"MultiPolygon":return function(t,e){var i=P(t);if(!U(P(e),i))return!1;for(var n=0;n<t.coordinates[0].length;n++)if(!N(t.coordinates[0][n],e))return!1;return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}}function U(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function V(t,e){return t[0]===e[0]&&t[1]===e[1]}function H(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function W(t,e,i){void 0===i&&(i={}),i.mask&&!i.units&&(i.units="kilometers");for(var n=[],o=t[0],s=t[1],l=t[2],u=t[3],c=e/_([o,s],[l,s],i)*(l-o),h=e/_([o,s],[o,u],i)*(u-s),p=l-o,d=u-s,f=Math.floor(p/c),g=(d-Math.floor(d/h)*h)/2,m=o+(p-f*c)/2;m<=l;){for(var y=s+g;y<=u;){var v=r([m,y],i.properties);i.mask?B(v,i.mask)&&n.push(v):n.push(v),y+=h}m+=c}return a(n)}function j(t){return function(){return t}}function q(t){return t[0]}function Y(t){return t[1]}function X(){this._=null}function $(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function J(t,e){var i=e,n=e.R,r=i.U;r?r.L===i?r.L=n:r.R=n:t._=n,n.U=r,i.U=n,i.R=n.L,i.R&&(i.R.U=i),n.L=i}function Q(t,e){var i=e,n=e.L,r=i.U;r?r.L===i?r.L=n:r.R=n:t._=n,n.U=r,i.U=n,i.L=n.R,i.L&&(i.L.U=i),n.R=i}function Z(t){for(;t.L;)t=t.L;return t}function K(t,e,i,n){var r=[null,null],o=bt.push(r)-1;return r.left=t,r.right=e,i&&et(r,t,e,i),n&&et(r,e,t,n),xt[t.index].halfedges.push(o),xt[e.index].halfedges.push(o),r}function tt(t,e,i){var n=[e,i];return n.left=t,n}function et(t,e,i,n){t[0]||t[1]?t.left===i?t[1]=n:t[0]=n:(t[0]=n,t.left=e,t.right=i)}function it(t,e,i,n,r){var o,s=t[0],a=t[1],l=s[0],u=s[1],c=0,h=1,p=a[0]-l,d=a[1]-u;if(o=e-l,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=n-l,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}if(o=i-u,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>c&&(c=o)}if(o=r-u,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*p,u+c*d]),h<1&&(t[1]=[l+h*p,u+h*d]),!0)}}}}}function nt(t,e,i,n,r){var o=t[1];if(o)return!0;var s,a,l=t[0],u=t.left,c=t.right,h=u[0],p=u[1],d=c[0],f=c[1],g=(h+d)/2,m=(p+f)/2;if(f===p){if(g<e||g>=n)return;if(h>d){if(l){if(l[1]>=r)return}else l=[g,i];o=[g,r]}else{if(l){if(l[1]<i)return}else l=[g,r];o=[g,i]}}else if(a=m-(s=(h-d)/(f-p))*g,s<-1||s>1)if(h>d){if(l){if(l[1]>=r)return}else l=[(i-a)/s,i];o=[(r-a)/s,r]}else{if(l){if(l[1]<i)return}else l=[(r-a)/s,r];o=[(i-a)/s,i]}else if(p<f){if(l){if(l[0]>=n)return}else l=[e,s*e+a];o=[n,s*n+a]}else{if(l){if(l[0]<e)return}else l=[n,s*n+a];o=[e,s*e+a]}return t[0]=l,t[1]=o,!0}function rt(t,e){var i=t.site,n=e.left,r=e.right;return i===r&&(r=n,n=i),r?Math.atan2(r[1]-n[1],r[0]-n[0]):(i===n?(n=e[1],r=e[0]):(n=e[0],r=e[1]),Math.atan2(n[0]-r[0],r[1]-n[1]))}function ot(t,e){return e[+(e.left!==t.site)]}function st(t,e){return e[+(e.left===t.site)]}X.prototype={constructor:X,insert:function(t,e){var i,n,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;i=t}else this._?(t=Z(this._),e.P=null,e.N=t,t.P=t.L=e,i=t):(e.P=e.N=null,this._=e,i=null);for(e.L=e.R=null,e.U=i,e.C=!0,t=e;i&&i.C;)i===(n=i.U).L?(r=n.R)&&r.C?(i.C=r.C=!1,n.C=!0,t=n):(t===i.R&&(J(this,i),i=(t=i).U),i.C=!1,n.C=!0,Q(this,n)):(r=n.L)&&r.C?(i.C=r.C=!1,n.C=!0,t=n):(t===i.L&&(Q(this,i),i=(t=i).U),i.C=!1,n.C=!0,J(this,n)),i=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,i,n,r=t.U,o=t.L,s=t.R;if(i=o?s?Z(s):o:s,r?r.L===t?r.L=i:r.R=i:this._=i,o&&s?(n=i.C,i.C=t.C,i.L=o,o.U=i,i!==s?(r=i.U,i.U=t.U,t=i.R,r.L=t,i.R=s,s.U=i):(i.U=r,r=i,t=i.R)):(n=t.C,t=i),t&&(t.U=r),!n)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,J(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Q(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,J(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Q(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,J(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Q(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var at,lt=[];function ut(){$(this),this.x=this.y=this.arc=this.site=this.cy=null}function ct(t){var e=t.P,i=t.N;if(e&&i){var n=e.site,r=t.site,o=i.site;if(n!==o){var s=r[0],a=r[1],l=n[0]-s,u=n[1]-a,c=o[0]-s,h=o[1]-a,p=2*(l*h-u*c);if(!(p>=-St)){var d=l*l+u*u,f=c*c+h*h,g=(h*d-u*f)/p,m=(l*f-c*d)/p,_=lt.pop()||new ut;_.arc=t,_.site=r,_.x=g+s,_.y=(_.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=_;for(var y=null,v=wt._;v;)if(_.y<v.y||_.y===v.y&&_.x<=v.x){if(!v.L){y=v.P;break}v=v.L}else{if(!v.R){y=v;break}v=v.R}wt.insert(y,_),y||(at=_)}}}}function ht(t){var e=t.circle;e&&(e.P||(at=e.N),wt.remove(e),lt.push(e),$(e),t.circle=null)}var pt=[];function dt(){$(this),this.edge=this.site=this.circle=null}function ft(t){var e=pt.pop()||new dt;return e.site=t,e}function gt(t){ht(t),Ct.remove(t),pt.push(t),$(t)}function mt(t){var e=t.circle,i=e.x,n=e.cy,r=[i,n],o=t.P,s=t.N,a=[t];gt(t);for(var l=o;l.circle&&Math.abs(i-l.circle.x)<Et&&Math.abs(n-l.circle.cy)<Et;)o=l.P,a.unshift(l),gt(l),l=o;a.unshift(l),ht(l);for(var u=s;u.circle&&Math.abs(i-u.circle.x)<Et&&Math.abs(n-u.circle.cy)<Et;)s=u.N,a.push(u),gt(u),u=s;a.push(u),ht(u);var c,h=a.length;for(c=1;c<h;++c)u=a[c],l=a[c-1],et(u.edge,l.site,u.site,r);l=a[0],(u=a[h-1]).edge=K(l.site,u.site,null,r),ct(l),ct(u)}function _t(t){for(var e,i,n,r,o=t[0],s=t[1],a=Ct._;a;)if((n=yt(a,s)-o)>Et)a=a.L;else{if(!((r=o-vt(a,s))>Et)){n>-Et?(e=a.P,i=a):r>-Et?(e=a,i=a.N):e=i=a;break}if(!a.R){e=a;break}a=a.R}!function(t){xt[t.index]={site:t,halfedges:[]}}(t);var l=ft(t);if(Ct.insert(e,l),e||i){if(e===i)return ht(e),i=ft(e.site),Ct.insert(l,i),l.edge=i.edge=K(e.site,l.site),ct(e),void ct(i);if(i){ht(e),ht(i);var u=e.site,c=u[0],h=u[1],p=t[0]-c,d=t[1]-h,f=i.site,g=f[0]-c,m=f[1]-h,_=2*(p*m-d*g),y=p*p+d*d,v=g*g+m*m,C=[(m*y-d*v)/_+c,(p*v-g*y)/_+h];et(i.edge,u,f,C),l.edge=K(u,t,null,C),i.edge=K(t,f,null,C),ct(e),ct(i)}else l.edge=K(e.site,l.site)}}function yt(t,e){var i=t.site,n=i[0],r=i[1],o=r-e;if(!o)return n;var s=t.P;if(!s)return-1/0;var a=(i=s.site)[0],l=i[1],u=l-e;if(!u)return a;var c=a-n,h=1/o-1/u,p=c/u;return h?(-p+Math.sqrt(p*p-2*h*(c*c/(-2*u)-l+u/2+r-o/2)))/h+n:(n+a)/2}function vt(t,e){var i=t.N;if(i)return yt(i,e);var n=t.site;return n[1]===e?n[0]:1/0}var Ct,xt,wt,bt,Et=1e-6,St=1e-12;function Tt(t,e,i){return(t[0]-i[0])*(e[1]-t[1])-(t[0]-e[0])*(i[1]-t[1])}function Pt(t,e){return e[1]-t[1]||e[0]-t[0]}function At(t,e){var i,n,r,o=t.sort(Pt).pop();for(bt=[],xt=new Array(t.length),Ct=new X,wt=new X;;)if(r=at,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===i&&o[1]===n||(_t(o),i=o[0],n=o[1]),o=t.pop();else{if(!r)break;mt(r.arc)}if(function(){for(var t,e,i,n,r=0,o=xt.length;r<o;++r)if((t=xt[r])&&(n=(e=t.halfedges).length)){var s=new Array(n),a=new Array(n);for(i=0;i<n;++i)s[i]=i,a[i]=rt(t,bt[e[i]]);for(s.sort((function(t,e){return a[e]-a[t]})),i=0;i<n;++i)a[i]=e[s[i]];for(i=0;i<n;++i)e[i]=a[i]}}(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,i,n){for(var r,o=bt.length;o--;)nt(r=bt[o],t,e,i,n)&&it(r,t,e,i,n)&&(Math.abs(r[0][0]-r[1][0])>Et||Math.abs(r[0][1]-r[1][1])>Et)||delete bt[o]}(s,a,l,u),function(t,e,i,n){var r,o,s,a,l,u,c,h,p,d,f,g,m=xt.length,_=!0;for(r=0;r<m;++r)if(o=xt[r]){for(s=o.site,a=(l=o.halfedges).length;a--;)bt[l[a]]||l.splice(a,1);for(a=0,u=l.length;a<u;)f=(d=st(o,bt[l[a]]))[0],g=d[1],h=(c=ot(o,bt[l[++a%u]]))[0],p=c[1],(Math.abs(f-h)>Et||Math.abs(g-p)>Et)&&(l.splice(a,0,bt.push(tt(s,d,Math.abs(f-t)<Et&&n-g>Et?[t,Math.abs(h-t)<Et?p:n]:Math.abs(g-n)<Et&&i-f>Et?[Math.abs(p-n)<Et?h:i,n]:Math.abs(f-i)<Et&&g-e>Et?[i,Math.abs(h-i)<Et?p:e]:Math.abs(g-e)<Et&&f-t>Et?[Math.abs(p-e)<Et?h:t,e]:null))-1),++u);u&&(_=!1)}if(_){var y,v,C,x=1/0;for(r=0,_=null;r<m;++r)(o=xt[r])&&(C=(y=(s=o.site)[0]-t)*y+(v=s[1]-e)*v)<x&&(x=C,_=o);if(_){var w=[t,e],b=[t,n],E=[i,n],S=[i,e];_.halfedges.push(bt.push(tt(s=_.site,w,b))-1,bt.push(tt(s,b,E))-1,bt.push(tt(s,E,S))-1,bt.push(tt(s,S,w))-1)}}for(r=0;r<m;++r)(o=xt[r])&&(o.halfedges.length||delete xt[r])}(s,a,l,u)}this.edges=bt,this.cells=xt,Ct=wt=bt=xt=null}function It(t){return(t=t.slice()).push(t[0]),o([t])}function Lt(t,e){if(!f(e=e||{}))throw new Error("options is invalid");var i=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(i))throw new Error("bbox is invalid");return function(t,e,i){if(!t)throw new Error("No featureCollection passed");if(!i)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+i+", FeatureCollection required");for(var n=0,r=t.features;n<r.length;n++){var o=r[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+o.geometry.type)}}(t,"Point","points"),a(function(){var t=q,e=Y,i=null;function n(n){return new At(n.map((function(i,r){var o=[Math.round(t(i,r,n)/Et)*Et,Math.round(e(i,r,n)/Et)*Et];return o.index=r,o.data=i,o})),i)}return n.polygons=function(t){return n(t).polygons()},n.links=function(t){return n(t).links()},n.triangles=function(t){return n(t).triangles()},n.x=function(e){return arguments.length?(t="function"==typeof e?e:j(+e),n):t},n.y=function(t){return arguments.length?(e="function"==typeof t?t:j(+t),n):e},n.extent=function(t){return arguments.length?(i=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],n):i&&[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},n.size=function(t){return arguments.length?(i=null==t?null:[[0,0],[+t[0],+t[1]]],n):i&&[i[1][0]-i[0][0],i[1][1]-i[0][1]]},n}().x((function(t){return t.geometry.coordinates[0]})).y((function(t){return t.geometry.coordinates[1]})).extent([[i[0],i[1]],[i[2],i[3]]]).polygons(t.features).map(It))}
/**
     * splaytree v3.1.2
     * Fast Splay tree for Node and browser
     *
     * @author Alexander Milevski <info@w8r.name>
     * @license MIT
     * @preserve
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function Nt(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}At.prototype={constructor:At,polygons:function(){var t=this.edges;return this.cells.map((function(e){var i=e.halfedges.map((function(i){return ot(e,t[i])}));return i.data=e.site.data,i}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(i,n){if(o=(r=i.halfedges).length)for(var r,o,s,a=i.site,l=-1,u=e[r[o-1]],c=u.left===a?u.right:u.left;++l<o;)s=c,c=(u=e[r[l]]).left===a?u.right:u.left,s&&c&&n<s.index&&n<c.index&&Tt(a,s,c)<0&&t.push([a.data,s.data,c.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,i){for(var n,r,o=this,s=o._found||0,a=o.cells.length;!(r=o.cells[s]);)if(++s>=a)return null;var l=t-r.site[0],u=e-r.site[1],c=l*l+u*u;do{r=o.cells[n=s],s=null,r.halfedges.forEach((function(i){var n=o.edges[i],a=n.left;if(a!==r.site&&a||(a=n.right)){var l=t-a[0],u=e-a[1],h=l*l+u*u;h<c&&(c=h,s=a.index)}}))}while(null!==s);return o._found=n,null==i||c<=i*i?r.site:null}};var Mt=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function Dt(t,e){return t>e?1:t<e?-1:0}function Rt(t,e,i){for(var n=new Mt(null,null),r=n,o=n;;){var s=i(t,e.key);if(s<0){if(null===e.left)break;if(i(t,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,null===(e=a).left)break}o.left=e,o=e,e=e.left}else{if(!(s>0))break;if(null===e.right)break;if(i(t,e.right.key)>0){a=e.right;if(e.right=a.left,a.left=e,null===(e=a).right)break}r.right=e,r=e,e=e.right}}return r.right=e.left,o.left=e.right,e.left=n.right,e.right=n.left,e}function Ot(t,e,i,n){var r=new Mt(t,e);if(null===i)return r.left=r.right=null,r;var o=n(t,(i=Rt(t,i,n)).key);return o<0?(r.left=i.left,r.right=i,i.left=null):o>=0&&(r.right=i.right,r.left=i,i.right=null),r}function Ft(t,e,i){var n=null,r=null;if(e){var o=i((e=Rt(t,e,i)).key,t);0===o?(n=e.left,r=e.right):o<0?(r=e.right,e.right=null,n=e):(n=e.left,e.left=null,r=e)}return{left:n,right:r}}function kt(t,e,i,n,r){if(t){n(e+(i?"└── ":"├── ")+r(t)+"\n");var o=e+(i?"    ":"│   ");t.left&&kt(t.left,o,!1,n,r),t.right&&kt(t.right,o,!0,n,r)}}var zt=function(){function t(t){void 0===t&&(t=Dt),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=Ot(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var i=new Mt(t,e);null===this._root&&(i.left=i.right=null,this._size++,this._root=i);var n=this._comparator,r=Rt(t,this._root,n),o=n(t,r.key);return 0===o?this._root=r:(o<0?(i.left=r.left,i.right=r,r.left=null):o>0&&(i.right=r.right,i.left=r,r.right=null),this._size++,this._root=i),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,i){var n;return null===e?null:0===i(t,(e=Rt(t,e,i)).key)?(null===e.left?n=e.right:(n=Rt(t,e.left,i)).right=e.right,this._size--,n):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=Rt(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=Rt(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var i=this._root,n=[],r=!1;!r;)null!==i?(n.push(i),i=i.left):0!==n.length?(i=n.pop(),t.call(e,i),i=i.right):r=!0;return this},t.prototype.range=function(t,e,i,n){for(var r=[],o=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var i=e.key;return t.push(i)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var i=e.data;return t.push(i)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,i=!1,n=0,r=[];!i;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),n===t)return e;n++,e=e.right}else i=!0;return null},t.prototype.next=function(t){var e=this._root,i=null;if(t.right){for(i=t.right;i.left;)i=i.left;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?(i=e,e=e.left):e=e.right}return i},t.prototype.prev=function(t){var e=this._root,i=null;if(null!==t.left){for(i=t.left;i.right;)i=i.right;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?e=e.left:(i=e,e=e.right)}return i},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){var e=t,i=[],n=!1,r=new Mt(null,null),o=r;for(;!n;)e?(i.push(e),e=e.left):i.length>0?e=(e=o=o.next=i.pop()).right:n=!0;return o.next=null,r.next}(this._root)},t.prototype.load=function(t,e,i){void 0===e&&(e=[]),void 0===i&&(i=!1);var n=t.length,r=this._comparator;if(i&&Ut(t,e,0,n-1,r),null===this._root)this._root=Gt(t,e,0,n),this._size=n;else{var o=function(t,e,i){var n=new Mt(null,null),r=n,o=t,s=e;for(;null!==o&&null!==s;)i(o.key,s.key)<0?(r.next=o,o=o.next):(r.next=s,s=s.next),r=r.next;null!==o?r.next=o:null!==s&&(r.next=s);return n.next}(this.toList(),function(t,e){for(var i=new Mt(null,null),n=i,r=0;r<t.length;r++)n=n.next=new Mt(t[r],e[r]);return n.next=null,i.next}(t,e),r);n=this._size+n,this._root=Bt({head:o},0,n)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return kt(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,i){var n=this._comparator,r=Ft(t,this._root,n),o=r.left,s=r.right;n(t,e)<0?s=Ot(e,i,s,n):o=Ot(e,i,o,n),this._root=function(t,e,i){return null===e?t:(null===t||((e=Rt(t.key,e,i)).left=t),e)}(o,s,n)},t.prototype.split=function(t){return Ft(t,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var t,e,i;return Nt(this,(function(n){switch(n.label){case 0:t=this._root,e=[],i=!1,n.label=1;case 1:return i?[3,6]:null===t?[3,2]:(e.push(t),t=t.left,[3,5]);case 2:return 0===e.length?[3,4]:[4,t=e.pop()];case 3:return n.sent(),t=t.right,[3,5];case 4:i=!0,n.label=5;case 5:return[3,1];case 6:return[2]}}))},t}();function Gt(t,e,i,n){var r=n-i;if(r>0){var o=i+Math.floor(r/2),s=t[o],a=e[o],l=new Mt(s,a);return l.left=Gt(t,e,i,o),l.right=Gt(t,e,o+1,n),l}return null}function Bt(t,e,i){var n=i-e;if(n>0){var r=e+Math.floor(n/2),o=Bt(t,e,r),s=t.head;return s.left=o,t.head=t.head.next,s.right=Bt(t,r+1,i),s}return null}function Ut(t,e,i,n,r){if(!(i>=n)){for(var o=t[i+n>>1],s=i-1,a=n+1;;){do{s++}while(r(t[s],o)<0);do{a--}while(r(t[a],o)>0);if(s>=a)break;var l=t[s];t[s]=t[a],t[a]=l,l=e[s],e[s]=e[a],e[a]=l}Ut(t,e,i,a,r),Ut(t,e,a+1,n,r)}}function Vt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ht(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wt(t,e,i){return e&&Ht(t.prototype,e),i&&Ht(t,i),t}var jt=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},qt=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var i=t.ll.x<e.ll.x?e.ll.x:t.ll.x,n=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},Yt=Number.EPSILON;void 0===Yt&&(Yt=Math.pow(2,-52));var Xt=Yt*Yt,$t=function(t,e){if(-Yt<t&&t<Yt&&-Yt<e&&e<Yt)return 0;var i=t-e;return i*i<Xt*t*e?0:t<e?-1:1},Jt=function(){function t(){Vt(this,t),this.reset()}return Wt(t,[{key:"reset",value:function(){this.xRounder=new Qt,this.yRounder=new Qt}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),Qt=function(){function t(){Vt(this,t),this.tree=new zt,this.round(0)}return Wt(t,[{key:"round",value:function(t){var e=this.tree.add(t),i=this.tree.prev(e);if(null!==i&&0===$t(e.key,i.key))return this.tree.remove(t),i.key;var n=this.tree.next(e);return null!==n&&0===$t(e.key,n.key)?(this.tree.remove(t),n.key):t}}]),t}(),Zt=new Jt,Kt=function(t,e){return t.x*e.y-t.y*e.x},te=function(t,e){return t.x*e.x+t.y*e.y},ee=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y},o=Kt(n,r);return $t(o,0)},ie=function(t){return Math.sqrt(te(t,t))},ne=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return te(r,n)/ie(r)/ie(n)},re=function(t,e,i){return 0===e.y?null:{x:t.x+e.x/e.y*(i-t.y),y:i}},oe=function(t,e,i){return 0===e.x?null:{x:i,y:t.y+e.y/e.x*(i-t.x)}},se=function(){function t(e,i){Vt(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=i}return Wt(t,null,[{key:"compare",value:function(e,i){var n=t.comparePoints(e.point,i.point);return 0!==n?n:(e.point!==i.point&&e.link(i),e.isLeft!==i.isLeft?e.isLeft?1:-1:le.compare(e.segment,i.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),Wt(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,i=0,n=e.length;i<n;i++){var r=e[i];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var i=this.point.events[e];if(void 0===i.segment.consumedBy)for(var n=e+1;n<t;n++){var r=this.point.events[n];void 0===r.consumedBy&&(i.otherSE.point.events===r.otherSE.point.events&&i.segment.consume(r.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,i=this.point.events.length;e<i;e++){var n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,i=new Map,n=function(n){var r,o,s,a,l,u=n.otherSE;i.set(n,{sine:(r=e.point,o=t.point,s=u.point,a={x:o.x-r.x,y:o.y-r.y},l={x:s.x-r.x,y:s.y-r.y},Kt(l,a)/ie(l)/ie(a)),cosine:ne(e.point,t.point,u.point)})};return function(t,e){i.has(t)||n(t),i.has(e)||n(e);var r=i.get(t),o=r.sine,s=r.cosine,a=i.get(e),l=a.sine,u=a.cosine;return o>=0&&l>=0?s<u?1:s>u?-1:0:o<0&&l<0?s<u?-1:s>u?1:0:l<o?-1:l>o?1:0}}}]),t}(),ae=0,le=function(){function t(e,i,n,r){Vt(this,t),this.id=++ae,this.leftSE=e,e.segment=this,e.otherSE=i,this.rightSE=i,i.segment=this,i.otherSE=e,this.rings=n,this.windings=r}return Wt(t,null,[{key:"compare",value:function(t,e){var i=t.leftSE.point.x,n=e.leftSE.point.x,r=t.rightSE.point.x,o=e.rightSE.point.x;if(o<i)return 1;if(r<n)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(i<n){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var c=t.comparePoint(e.leftSE.point);if(c<0)return 1;if(c>0)return-1;var h=e.comparePoint(t.rightSE.point);return 0!==h?h:-1}if(i>n){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;var p=e.comparePoint(t.leftSE.point);if(0!==p)return p;var d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(r<o){var f=e.comparePoint(t.rightSE.point);if(0!==f)return f}if(r>o){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(r!==o){var m=l-s,_=r-i,y=u-a,v=o-n;if(m>_&&y<v)return 1;if(m<_&&y>v)return-1}return r>o?1:r<o||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),Wt(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,i=this.rightSE.point,n=this.vector();if(e.x===i.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/n.y,o=e.x+r*n.x;if(t.x===o)return 0;var s=(t.x-e.x)/n.x,a=e.y+s*n.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),i=t.bbox(),n=qt(e,i);if(null===n)return null;var r=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=jt(e,s)&&0===this.comparePoint(s),u=jt(i,r)&&0===t.comparePoint(r),c=jt(e,a)&&0===this.comparePoint(a),h=jt(i,o)&&0===t.comparePoint(o);if(u&&l)return h&&!c?o:!h&&c?a:null;if(u)return c&&r.x===a.x&&r.y===a.y?null:r;if(l)return h&&o.x===s.x&&o.y===s.y?null:s;if(h&&c)return null;if(h)return o;if(c)return a;var p=function(t,e,i,n){if(0===e.x)return oe(i,n,t.x);if(0===n.x)return oe(t,e,i.x);if(0===e.y)return re(i,n,t.y);if(0===n.y)return re(t,e,i.y);var r=Kt(e,n);if(0==r)return null;var o={x:i.x-t.x,y:i.y-t.y},s=Kt(o,e)/r,a=Kt(o,n)/r;return{x:(t.x+a*e.x+(i.x+s*n.x))/2,y:(t.y+a*e.y+(i.y+s*n.y))/2}}(r,this.vector(),s,t.vector());return null===p?null:jt(n,p)?Zt.round(p.x,p.y):null}},{key:"split",value:function(e){var i=[],n=void 0!==e.events,r=new se(e,!0),o=new se(e,!1),s=this.rightSE;this.replaceRightSE(o),i.push(o),i.push(r);var a=new t(r,s,this.rings.slice(),this.windings.slice());return se.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),se.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),o.checkForConsuming()),i}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,i=this.windings.length;e<i;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var i=this,n=e;i.consumedBy;)i=i.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var r=t.compare(i,n);if(0!==r){if(r>0){var o=i;i=n,n=o}if(i.prev===n){var s=i;i=n,n=s}for(var a=0,l=n.rings.length;a<l;a++){var u=n.rings[a],c=n.windings[a],h=i.rings.indexOf(u);-1===h?(i.rings.push(u),i.windings.push(c)):i.windings[h]+=c}n.rings=null,n.windings=null,n.consumedBy=i,n.leftSE.consumedBy=i.leftSE,n.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys,r=0,o=this.rings.length;r<o;r++){var s=this.rings[r],a=this.windings[r],l=e.indexOf(s);-1===l?(e.push(s),i.push(a)):i[l]+=a}for(var u=[],c=[],h=0,p=e.length;h<p;h++)if(0!==i[h]){var d=e[h],f=d.poly;if(-1===c.indexOf(f))if(d.isExterior)u.push(f);else{-1===c.indexOf(f)&&c.push(f);var g=u.indexOf(d.poly);-1!==g&&u.splice(g,1)}}for(var m=0,_=u.length;m<_;m++){var y=u[m].multiPoly;-1===n.indexOf(y)&&n.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(ve.type){case"union":var i=0===t.length,n=0===e.length;this._isInResult=i!==n;break;case"intersection":var r,o;t.length<e.length?(r=t.length,o=e.length):(r=e.length,o=t.length),this._isInResult=o===ve.numMultiPolys&&r<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(ve.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,i,n){var r,o,s,a=se.comparePoints(e,i);if(a<0)r=e,o=i,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));r=i,o=e,s=-1}return new t(new se(r,!0),new se(o,!1),[n],[s])}}]),t}(),ue=function(){function t(e,i,n){if(Vt(this,t),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=n,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=Zt.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var o=r,s=1,a=e.length;s<a;s++){if("number"!=typeof e[s][0]||"number"!=typeof e[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var l=Zt.round(e[s][0],e[s][1]);l.x===o.x&&l.y===o.y||(this.segments.push(le.fromRing(o,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),o=l)}r.x===o.x&&r.y===o.y||this.segments.push(le.fromRing(o,r,this))}return Wt(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.segments.length;e<i;e++){var n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}]),t}(),ce=function(){function t(e,i){if(Vt(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ue(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,r=e.length;n<r;n++){var o=new ue(e[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=i}return Wt(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,i=this.interiorRings.length;e<i;e++)for(var n=this.interiorRings[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),t}(),he=function(){function t(e,i){if(Vt(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,r=e.length;n<r;n++){var o=new ce(e[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=i}return Wt(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++)for(var n=this.polys[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),t}(),pe=function(){function t(e){Vt(this,t),this.events=e;for(var i=0,n=e.length;i<n;i++)e[i].segment.ringOut=this;this.poly=null}return Wt(t,null,[{key:"factory",value:function(e){for(var i=[],n=0,r=e.length;n<r;n++){var o=e[n];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,l=o.rightSE,u=[a],c=a.point,h=[];s=a,a=l,u.push(a),a.point!==c;)for(;;){var p=a.getAvailableLinkedEvents();if(0===p.length){var d=u[0].point,f=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(f.x,", ").concat(f.y,"]."))}if(1===p.length){l=p[0].otherSE;break}for(var g=null,m=0,_=h.length;m<_;m++)if(h[m].point===a.point){g=m;break}if(null===g){h.push({index:u.length,point:a.point});var y=a.getLeftmostComparator(s);l=p.sort(y)[0].otherSE;break}var v=h.splice(g)[0],C=u.splice(v.index);C.unshift(C[0].otherSE),i.push(new t(C.reverse()))}i.push(new t(u))}}return i}}]),Wt(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],i=1,n=this.events.length-1;i<n;i++){var r=this.events[i].point,o=this.events[i+1].point;0!==ee(r,t,o)&&(e.push(r),t=r)}if(1===e.length)return null;var s=e[0],a=e[1];0===ee(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,c=this.isExteriorRing()?e.length:-1,h=[],p=u;p!=c;p+=l)h.push([e[p].x,e[p].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,i=this.events.length;e<i;e++){var n=this.events[e];se.compare(t,n)>0&&(t=n)}for(var r=t.segment.prevInResult(),o=r?r.prevInResult():null;;){if(!r)return null;if(!o)return r.ringOut;if(o.ringOut!==r.ringOut)return o.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=o.prevInResult(),o=r?r.prevInResult():null}}}]),t}(),de=function(){function t(e){Vt(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return Wt(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,i=this.interiorRings.length;e<i;e++){var n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}]),t}(),fe=function(){function t(e){Vt(this,t),this.rings=e,this.polys=this._composePolys(e)}return Wt(t,[{key:"getGeom",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++){var n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}},{key:"_composePolys",value:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];if(!r.poly)if(r.isExteriorRing())e.push(new de(r));else{var o=r.enclosingRing();o.poly||e.push(new de(o)),o.poly.addInterior(r)}}return e}}]),t}(),ge=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le.compare;Vt(this,t),this.queue=e,this.tree=new zt(i),this.segments=[]}return Wt(t,[{key:"process",value:function(t){var e=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),i;var n=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!n)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=n,o=n,s=void 0,a=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var c=this._splitSafely(s,u),h=0,p=c.length;h<p;h++)i.push(c[h])}var d=null;if(a){var f=a.getIntersection(e);if(null!==f&&(e.isAnEndpoint(f)||(d=f),!a.isAnEndpoint(f)))for(var g=this._splitSafely(a,f),m=0,_=g.length;m<_;m++)i.push(g[m])}if(null!==l||null!==d){var y=null;if(null===l)y=d;else if(null===d)y=l;else{y=se.comparePoints(l,d)<=0?l:d}this.queue.remove(e.rightSE),i.push(e.rightSE);for(var v=e.split(y),C=0,x=v.length;C<x;C++)i.push(v[C])}i.length>0?(this.tree.remove(e),i.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var w=s.getIntersection(a);if(null!==w){if(!s.isAnEndpoint(w))for(var b=this._splitSafely(s,w),E=0,S=b.length;E<S;E++)i.push(b[E]);if(!a.isAnEndpoint(w))for(var T=this._splitSafely(a,w),P=0,A=T.length;P<A;P++)i.push(T[P])}}this.tree.remove(e)}return i}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var i=t.rightSE;this.queue.remove(i);var n=t.split(e);return n.push(i),void 0===t.consumedBy&&this.tree.insert(t),n}}]),t}(),me="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,_e="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ye=function(){function t(){Vt(this,t)}return Wt(t,[{key:"run",value:function(t,e,i){ve.type=t,Zt.reset();for(var n=[new he(e,!0)],r=0,o=i.length;r<o;r++)n.push(new he(i[r],!1));if(ve.numMultiPolys=n.length,"difference"===ve.type)for(var s=n[0],a=1;a<n.length;)null!==qt(n[a].bbox,s.bbox)?a++:n.splice(a,1);if("intersection"===ve.type)for(var l=0,u=n.length;l<u;l++)for(var c=n[l],h=l+1,p=n.length;h<p;h++)if(null===qt(c.bbox,n[h].bbox))return[];for(var d=new zt(se.compare),f=0,g=n.length;f<g;f++)for(var m=n[f].getSweepEvents(),_=0,y=m.length;_<y;_++)if(d.insert(m[_]),d.size>me)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var v=new ge(d),C=d.size,x=d.pop();x;){var w=x.key;if(d.size===C){var b=w.segment;throw new Error("Unable to pop() ".concat(w.isLeft?"left":"right"," SweepEvent ")+"[".concat(w.point.x,", ").concat(w.point.y,"] from segment #").concat(b.id," ")+"[".concat(b.leftSE.point.x,", ").concat(b.leftSE.point.y,"] -> ")+"[".concat(b.rightSE.point.x,", ").concat(b.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(d.size>me)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(v.segments.length>_e)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var E=v.process(w),S=0,T=E.length;S<T;S++){var P=E[S];void 0===P.consumedBy&&d.insert(P)}C=d.size,x=d.pop()}Zt.reset();var A=pe.factory(v.segments);return new fe(A).getGeom()}}]),t}(),ve=new ye,Ce={union:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return ve.run("union",t,i)},intersection:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return ve.run("intersection",t,i)},xor:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return ve.run("xor",t,i)},difference:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return ve.run("difference",t,i)}},xe=Ce;"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),i=Math.max(Math.min(e.length,9007199254740991),0)||0,n=1 in arguments&&parseInt(Number(arguments[1]),10)||0;n=n<0?Math.max(i+n,0):Math.min(n,i);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:i;for(r=r<0?Math.max(i+arguments[2],0):Math.min(r,i);n<r;)e[n]=t,++n;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var we=function(){};we.prototype.interfaces_=function(){return[]},we.prototype.getClass=function(){return we},we.prototype.equalsWithTolerance=function(t,e,i){return Math.abs(t-e)<=i};var be=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),Ee=function(){},Se={MAX_VALUE:{configurable:!0}};Ee.isNaN=function(t){return Number.isNaN(t)},Ee.doubleToLongBits=function(t){return t},Ee.longBitsToDouble=function(t){return t},Ee.isInfinite=function(t){return!Number.isFinite(t)},Se.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(Ee,Se);var Te=function(){},Pe=function(){},Ae=function(){};function Ie(){}var Le=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Ne={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Le.prototype.setOrdinate=function(t,e){switch(t){case Le.X:this.x=e;break;case Le.Y:this.y=e;break;case Le.Z:this.z=e;break;default:throw new be("Invalid ordinate index: "+t)}},Le.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!we.equalsWithTolerance(this.x,e.x,i)&&!!we.equalsWithTolerance(this.y,e.y,i)}},Le.prototype.getOrdinate=function(t){switch(t){case Le.X:return this.x;case Le.Y:return this.y;case Le.Z:return this.z}throw new be("Invalid ordinate index: "+t)},Le.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Ee.isNaN(this.z))&&Ee.isNaN(t.z)},Le.prototype.equals=function(t){return t instanceof Le&&this.equals2D(t)},Le.prototype.equalInZ=function(t,e){return we.equalsWithTolerance(this.z,t.z,e)},Le.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},Le.prototype.clone=function(){},Le.prototype.copy=function(){return new Le(this)},Le.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},Le.prototype.distance3D=function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)},Le.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},Le.prototype.hashCode=function(){var t=17;return t=37*(t=37*t+Le.hashCode(this.x))+Le.hashCode(this.y)},Le.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},Le.prototype.interfaces_=function(){return[Te,Pe,Ie]},Le.prototype.getClass=function(){return Le},Le.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=Ee.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},Ne.DimensionalComparator.get=function(){return Me},Ne.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},Ne.NULL_ORDINATE.get=function(){return Ee.NaN},Ne.X.get=function(){return 0},Ne.Y.get=function(){return 1},Ne.Z.get=function(){return 2},Object.defineProperties(Le,Ne);var Me=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new be("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};Me.prototype.compare=function(t,e){var i=t,n=e,r=Me.compare(i.x,n.x);if(0!==r)return r;var o=Me.compare(i.y,n.y);return 0!==o?o:this._dimensionsToTest<=2?0:Me.compare(i.z,n.z)},Me.prototype.interfaces_=function(){return[Ae]},Me.prototype.getClass=function(){return Me},Me.compare=function(t,e){return t<e?-1:t>e?1:Ee.isNaN(t)?Ee.isNaN(e)?0:-1:Ee.isNaN(e)?1:0};var De=function(){};De.prototype.create=function(){},De.prototype.interfaces_=function(){return[]},De.prototype.getClass=function(){return De};var Re=function(){},Oe={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re},Re.toLocationSymbol=function(t){switch(t){case Re.EXTERIOR:return"e";case Re.BOUNDARY:return"b";case Re.INTERIOR:return"i";case Re.NONE:return"-"}throw new be("Unknown location value: "+t)},Oe.INTERIOR.get=function(){return 0},Oe.BOUNDARY.get=function(){return 1},Oe.EXTERIOR.get=function(){return 2},Oe.NONE.get=function(){return-1},Object.defineProperties(Re,Oe);var Fe=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},ke=function(){},ze={LOG_10:{configurable:!0}};ke.prototype.interfaces_=function(){return[]},ke.prototype.getClass=function(){return ke},ke.log10=function(t){var e=Math.log(t);return Ee.isInfinite(e)||Ee.isNaN(e)?e:e/ke.LOG_10},ke.min=function(t,e,i,n){var r=t;return e<r&&(r=e),i<r&&(r=i),n<r&&(r=n),r},ke.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var n=arguments[0],r=arguments[1],o=arguments[2];return n<r?r:n>o?o:n}},ke.wrap=function(t,e){return t<0?e- -t%e:t%e},ke.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2],n=t;return e>n&&(n=e),i>n&&(n=i),n}if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=r;return o>l&&(l=o),s>l&&(l=s),a>l&&(l=a),l}},ke.average=function(t,e){return(t+e)/2},ze.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(ke,ze);var Ge=function(t){this.str=t};Ge.prototype.append=function(t){this.str+=t},Ge.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},Ge.prototype.toString=function(t){return this.str};var Be=function(t){this.value=t};Be.prototype.intValue=function(){return this.value},Be.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},Be.isNaN=function(t){return Number.isNaN(t)};var Ue=function(){};Ue.isWhitespace=function(t){return t<=32&&t>=0||127===t},Ue.toUpperCase=function(t){return t.toUpperCase()};var Ve=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var i=arguments[0];this.init(i)}else if("string"==typeof arguments[0]){var n=arguments[0];t.call(this,t.parse(n))}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r,o)}},He={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Ve.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},Ve.prototype.extractSignificantDigits=function(t,e){var i=this.abs(),n=Ve.magnitude(i._hi),r=Ve.TEN.pow(n);(i=i.divide(r)).gt(Ve.TEN)?(i=i.divide(Ve.TEN),n+=1):i.lt(Ve.ONE)&&(i=i.multiply(Ve.TEN),n-=1);for(var o=n+1,s=new Ge,a=Ve.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===o&&s.append(".");var u=Math.trunc(i._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,s.append(h),i=i.subtract(Ve.valueOf(u)).multiply(Ve.TEN),c&&i.selfAdd(Ve.TEN);var p=!0,d=Ve.magnitude(i._hi);if(d<0&&Math.abs(d)>=a-l&&(p=!1),!p)break}return e[0]=n,s.toString()},Ve.prototype.sqr=function(){return this.multiply(this)},Ve.prototype.doubleValue=function(){return this._hi+this._lo},Ve.prototype.subtract=function(){if(arguments[0]instanceof Ve){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},Ve.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},Ve.prototype.isZero=function(){return 0===this._hi&&0===this._lo},Ve.prototype.selfSubtract=function(){if(arguments[0]instanceof Ve){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},Ve.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Ve.prototype.min=function(t){return this.le(t)?this:t},Ve.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof Ve){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1],r=null,o=null,s=null,a=null,l=null,u=null,c=null,h=null;return l=this._hi/i,h=(r=(u=Ve.SPLIT*l)-(r=u-l))*(s=(h=Ve.SPLIT*i)-(s=h-i))-(c=l*i)+r*(a=i-s)+(o=l-r)*s+o*a,h=l+(u=(this._hi-c-h+this._lo-l*n)/i),this._hi=h,this._lo=l-h+u,this}},Ve.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Ve.prototype.divide=function(){if(arguments[0]instanceof Ve){var t=arguments[0],e=null,i=null,n=null,r=null,o=null,s=null,a=null,l=null;i=(o=this._hi/t._hi)-(e=(s=Ve.SPLIT*o)-(e=s-o)),l=e*(n=(l=Ve.SPLIT*t._hi)-(n=l-t._hi))-(a=o*t._hi)+e*(r=t._hi-n)+i*n+i*r;var u=l=o+(s=(this._hi-a-l+this._lo-o*t._lo)/t._hi),c=o-l+s;return new Ve(u,c)}if("number"==typeof arguments[0]){var h=arguments[0];return Ee.isNaN(h)?Ve.createNaN():Ve.copy(this).selfDivide(h,0)}},Ve.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},Ve.prototype.pow=function(t){if(0===t)return Ve.valueOf(1);var e=new Ve(this),i=Ve.valueOf(1),n=Math.abs(t);if(n>1)for(;n>0;)n%2==1&&i.selfMultiply(e),(n/=2)>0&&(e=e.sqr());else i=e;return t<0?i.reciprocal():i},Ve.prototype.ceil=function(){if(this.isNaN())return Ve.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new Ve(t,e)},Ve.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},Ve.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Ve.prototype.setValue=function(){if(arguments[0]instanceof Ve){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},Ve.prototype.max=function(t){return this.ge(t)?this:t},Ve.prototype.sqrt=function(){if(this.isZero())return Ve.valueOf(0);if(this.isNegative())return Ve.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,i=Ve.valueOf(e),n=this.subtract(i.sqr())._hi*(.5*t);return i.add(n)},Ve.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof Ve){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],i=null,n=null,r=null,o=null,s=null,a=null;return o=(r=this._hi+e)-(s=r-this._hi),n=(a=(o=e-s+(this._hi-o))+this._lo)+(r-(i=r+a)),this._hi=i+n,this._lo=n+(i-this._hi),this}}else if(2===arguments.length){var l=arguments[0],u=arguments[1],c=null,h=null,p=null,d=null,f=null,g=null,m=null;d=this._hi+l,h=this._lo+u,f=d-(g=d-this._hi),p=h-(m=h-this._lo);var _=(c=d+(g=(f=l-g+(this._hi-f))+h))+(g=(p=u-m+(this._lo-p))+(g+(d-c))),y=g+(c-_);return this._hi=_,this._lo=y,this}},Ve.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof Ve){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1],r=null,o=null,s=null,a=null,l=null,u=null;r=(l=Ve.SPLIT*this._hi)-this._hi,u=Ve.SPLIT*i,r=l-r,o=this._hi-r,s=u-i;var c=(l=this._hi*i)+(u=r*(s=u-s)-l+r*(a=i-s)+o*s+o*a+(this._hi*n+this._lo*i)),h=u+(r=l-c);return this._hi=c,this._lo=h,this}},Ve.prototype.selfSqr=function(){return this.selfMultiply(this)},Ve.prototype.floor=function(){if(this.isNaN())return Ve.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new Ve(t,e)},Ve.prototype.negate=function(){return this.isNaN()?this:new Ve(-this._hi,-this._lo)},Ve.prototype.clone=function(){},Ve.prototype.multiply=function(){if(arguments[0]instanceof Ve){var t=arguments[0];return t.isNaN()?Ve.createNaN():Ve.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return Ee.isNaN(e)?Ve.createNaN():Ve.copy(this).selfMultiply(e,0)}},Ve.prototype.isNaN=function(){return Ee.isNaN(this._hi)},Ve.prototype.intValue=function(){return Math.trunc(this._hi)},Ve.prototype.toString=function(){var t=Ve.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},Ve.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!0,e),n=e[0]+1,r=i;if("."===i.charAt(0))r="0"+i;else if(n<0)r="0."+Ve.stringOfChar("0",-n)+i;else if(-1===i.indexOf(".")){var o=n-i.length;r=i+Ve.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},Ve.prototype.reciprocal=function(){var t,e,i,n,r=null,o=null,s=null,a=null;t=(i=1/this._hi)-(r=(s=Ve.SPLIT*i)-(r=s-i)),o=(a=Ve.SPLIT*this._hi)-this._hi;var l=i+(s=(1-(n=i*this._hi)-(a=r*(o=a-o)-n+r*(e=this._hi-o)+t*o+t*e)-i*this._lo)/this._hi);return new Ve(l,i-l+s)},Ve.prototype.toSciNotation=function(){if(this.isZero())return Ve.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!1,e),n=Ve.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===i.charAt(0))throw new Error("Found leading zero: "+i);var r="";i.length>1&&(r=i.substring(1));var o=i.charAt(0)+"."+r;return this.isNegative()?"-"+o+n:o+n},Ve.prototype.abs=function(){return this.isNaN()?Ve.NaN:this.isNegative()?this.negate():new Ve(this)},Ve.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},Ve.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},Ve.prototype.add=function(){if(arguments[0]instanceof Ve){var t=arguments[0];return Ve.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return Ve.copy(this).selfAdd(e)}},Ve.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof Ve){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this._hi=i,this._lo=n}},Ve.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},Ve.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},Ve.prototype.trunc=function(){return this.isNaN()?Ve.NaN:this.isPositive()?this.floor():this.ceil()},Ve.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Ve.prototype.interfaces_=function(){return[Ie,Te,Pe]},Ve.prototype.getClass=function(){return Ve},Ve.sqr=function(t){return Ve.valueOf(t).selfMultiply(t)},Ve.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return Ve.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new Ve(e)}},Ve.sqrt=function(t){return Ve.valueOf(t).sqrt()},Ve.parse=function(t){for(var e=0,i=t.length;Ue.isWhitespace(t.charAt(e));)e++;var n=!1;if(e<i){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(n=!0))}for(var o=new Ve,s=0,a=0,l=0;!(e>=i);){var u=t.charAt(e);if(e++,Ue.isDigit(u)){var c=u-"0";o.selfMultiply(Ve.TEN),o.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=Be.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var p=o,d=s-a-l;if(0===d)p=o;else if(d>0){var f=Ve.TEN.pow(d);p=o.divide(f)}else if(d<0){var g=Ve.TEN.pow(-d);p=o.multiply(g)}return n?p.negate():p},Ve.createNaN=function(){return new Ve(Ee.NaN,Ee.NaN)},Ve.copy=function(t){return new Ve(t)},Ve.magnitude=function(t){var e=Math.abs(t),i=Math.log(e)/Math.log(10),n=Math.trunc(Math.floor(i));return 10*Math.pow(10,n)<=e&&(n+=1),n},Ve.stringOfChar=function(t,e){for(var i=new Ge,n=0;n<e;n++)i.append(t);return i.toString()},He.PI.get=function(){return new Ve(3.141592653589793,12246467991473532e-32)},He.TWO_PI.get=function(){return new Ve(6.283185307179586,24492935982947064e-32)},He.PI_2.get=function(){return new Ve(1.5707963267948966,6123233995736766e-32)},He.E.get=function(){return new Ve(2.718281828459045,14456468917292502e-32)},He.NaN.get=function(){return new Ve(Ee.NaN,Ee.NaN)},He.EPS.get=function(){return 123259516440783e-46},He.SPLIT.get=function(){return 134217729},He.MAX_PRINT_DIGITS.get=function(){return 32},He.TEN.get=function(){return Ve.valueOf(10)},He.ONE.get=function(){return Ve.valueOf(1)},He.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},He.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Ve,He);var We=function(){},je={DP_SAFE_EPSILON:{configurable:!0}};We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We},We.orientationIndex=function(t,e,i){var n=We.orientationIndexFilter(t,e,i);if(n<=1)return n;var r=Ve.valueOf(e.x).selfAdd(-t.x),o=Ve.valueOf(e.y).selfAdd(-t.y),s=Ve.valueOf(i.x).selfAdd(-e.x),a=Ve.valueOf(i.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},We.signOfDet2x2=function(t,e,i,n){return t.multiply(n).selfSubtract(e.multiply(i)).signum()},We.intersection=function(t,e,i,n){var r=Ve.valueOf(n.y).selfSubtract(i.y).selfMultiply(Ve.valueOf(e.x).selfSubtract(t.x)),o=Ve.valueOf(n.x).selfSubtract(i.x).selfMultiply(Ve.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=Ve.valueOf(n.x).selfSubtract(i.x).selfMultiply(Ve.valueOf(t.y).selfSubtract(i.y)),l=Ve.valueOf(n.y).selfSubtract(i.y).selfMultiply(Ve.valueOf(t.x).selfSubtract(i.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=Ve.valueOf(t.x).selfAdd(Ve.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=Ve.valueOf(e.x).selfSubtract(t.x).selfMultiply(Ve.valueOf(t.y).selfSubtract(i.y)),p=Ve.valueOf(e.y).selfSubtract(t.y).selfMultiply(Ve.valueOf(t.x).selfSubtract(i.x)),d=h.subtract(p).selfDivide(s).doubleValue(),f=Ve.valueOf(i.y).selfAdd(Ve.valueOf(n.y).selfSubtract(i.y).selfMultiply(d)).doubleValue();return new Le(c,f)},We.orientationIndexFilter=function(t,e,i){var n=null,r=(t.x-i.x)*(e.y-i.y),o=(t.y-i.y)*(e.x-i.x),s=r-o;if(r>0){if(o<=0)return We.signum(s);n=r+o}else{if(!(r<0))return We.signum(s);if(o>=0)return We.signum(s);n=-r-o}var a=We.DP_SAFE_EPSILON*n;return s>=a||-s>=a?We.signum(s):2},We.signum=function(t){return t>0?1:t<0?-1:0},je.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(We,je);var qe=function(){},Ye={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Ye.X.get=function(){return 0},Ye.Y.get=function(){return 1},Ye.Z.get=function(){return 2},Ye.M.get=function(){return 3},qe.prototype.setOrdinate=function(t,e,i){},qe.prototype.size=function(){},qe.prototype.getOrdinate=function(t,e){},qe.prototype.getCoordinate=function(){},qe.prototype.getCoordinateCopy=function(t){},qe.prototype.getDimension=function(){},qe.prototype.getX=function(t){},qe.prototype.clone=function(){},qe.prototype.expandEnvelope=function(t){},qe.prototype.copy=function(){},qe.prototype.getY=function(t){},qe.prototype.toCoordinateArray=function(){},qe.prototype.interfaces_=function(){return[Pe]},qe.prototype.getClass=function(){return qe},Object.defineProperties(qe,Ye);var Xe=function(){},$e=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Xe),Je=function(){};Je.arraycopy=function(t,e,i,n,r){for(var o=0,s=e;s<e+r;s++)i[n+o]=t[s],o++},Je.getProperty=function(t){return{"line.separator":"\n"}[t]};var Qe=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var i=arguments[0],n=arguments[1];this.x=i,this.y=n,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof Le&&arguments[1]instanceof Le){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var h=arguments[0],p=arguments[1],d=arguments[2],f=arguments[3],g=h.y-p.y,m=p.x-h.x,_=h.x*p.y-p.x*h.y,y=d.y-f.y,v=f.x-d.x,C=d.x*f.y-f.x*d.y;this.x=m*C-v*_,this.y=y*_-g*C,this.w=g*v-y*m}};Qe.prototype.getY=function(){var t=this.y/this.w;if(Ee.isNaN(t)||Ee.isInfinite(t))throw new $e;return t},Qe.prototype.getX=function(){var t=this.x/this.w;if(Ee.isNaN(t)||Ee.isInfinite(t))throw new $e;return t},Qe.prototype.getCoordinate=function(){var t=new Le;return t.x=this.getX(),t.y=this.getY(),t},Qe.prototype.interfaces_=function(){return[]},Qe.prototype.getClass=function(){return Qe},Qe.intersection=function(t,e,i,n){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=i.y-n.y,l=n.x-i.x,u=i.x*n.y-n.x*i.y,c=r*l-a*o,h=(o*u-l*s)/c,p=(a*s-r*u)/c;if(Ee.isNaN(h)||Ee.isInfinite(h)||Ee.isNaN(p)||Ee.isInfinite(p))throw new $e;return new Le(h,p)};var Ze=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof Le){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var i=arguments[0];this.init(i)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this.init(o,s,a,l)}},Ke={serialVersionUID:{configurable:!0}};Ze.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Ze.prototype.equals=function(t){if(!(t instanceof Ze))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},Ze.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Ze;var e=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny,n=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new Ze(e,n,i,r)},Ze.prototype.isNull=function(){return this._maxx<this._minx},Ze.prototype.getMaxX=function(){return this._maxx},Ze.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof Le){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof Ze){var e=arguments[0];return!this.isNull()&&!e.isNull()&&(e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return!this.isNull()&&(i>=this._minx&&i<=this._maxx&&n>=this._miny&&n<=this._maxy)}},Ze.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Ze){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof Le){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return!this.isNull()&&!(i>this._maxx||i<this._minx||n>this._maxy||n<this._miny)}},Ze.prototype.getMinY=function(){return this._miny},Ze.prototype.getMinX=function(){return this._minx},Ze.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof Le){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Ze){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=n,this._maxy=n):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),n<this._miny&&(this._miny=n),n>this._maxy&&(this._maxy=n))}},Ze.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},Ze.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Ze.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},Ze.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},Ze.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Ze.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Ze.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Ze.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},Ze.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=i,this._maxy+=i,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Ze.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Ze){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof Le){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return this.covers(i,n)}},Ze.prototype.centre=function(){return this.isNull()?null:new Le((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Ze.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof Le){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Ze){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.init(i.x,n.x,i.y,n.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},Ze.prototype.getMaxY=function(){return this._maxy},Ze.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var i=0;return this._maxy<t._miny?i=t._miny-this._maxy:this._miny>t._maxy&&(i=this._miny-t._maxy),0===e?i:0===i?e:Math.sqrt(e*e+i*i)},Ze.prototype.hashCode=function(){var t=17;return t=37*(t=37*(t=37*(t=37*t+Le.hashCode(this._minx))+Le.hashCode(this._maxx))+Le.hashCode(this._miny))+Le.hashCode(this._maxy)},Ze.prototype.interfaces_=function(){return[Te,Ie]},Ze.prototype.getClass=function(){return Ze},Ze.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2];return i.x>=(t.x<e.x?t.x:e.x)&&i.x<=(t.x>e.x?t.x:e.x)&&i.y>=(t.y<e.y?t.y:e.y)&&i.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),l=Math.max(o.x,s.x),u=Math.min(n.x,r.x),c=Math.max(n.x,r.x);return!(u>l)&&(!(c<a)&&(a=Math.min(o.y,s.y),l=Math.max(o.y,s.y),u=Math.min(n.y,r.y),c=Math.max(n.y,r.y),!(u>l)&&!(c<a)))}},Ke.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Ze,Ke);var ti={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},ei=function(t){this.geometryFactory=t||new Un};ei.prototype.read=function(t){var e,i,n;t=t.replace(/[\n\r]/g," ");var r=ti.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=ti.emptyTypeStr.exec(t))[2]=void 0),r&&(i=r[1].toLowerCase(),n=r[2],ni[i]&&(e=ni[i].apply(this,[n]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},ei.prototype.write=function(t){return this.extractGeometry(t)},ei.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!ii[e])return null;var i=e.toUpperCase();return t.isEmpty()?i+" EMPTY":i+"("+ii[e].apply(this,[t])+")"};var ii={coordinate:function(t){return t.x+" "+t.y},point:function(t){return ii.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+ii.point.apply(this,[t._geometries[i]])+")");return e.join(",")},linestring:function(t){for(var e=[],i=0,n=t._points._coordinates.length;i<n;++i)e.push(ii.coordinate.apply(this,[t._points._coordinates[i]]));return e.join(",")},linearring:function(t){for(var e=[],i=0,n=t._points._coordinates.length;i<n;++i)e.push(ii.coordinate.apply(this,[t._points._coordinates[i]]));return e.join(",")},multilinestring:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+ii.linestring.apply(this,[t._geometries[i]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+ii.linestring.apply(this,[t._shell])+")");for(var i=0,n=t._holes.length;i<n;++i)e.push("("+ii.linestring.apply(this,[t._holes[i]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+ii.polygon.apply(this,[t._geometries[i]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push(this.extractGeometry(t._geometries[i]));return e.join(",")}},ni={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(ti.spaces);return this.geometryFactory.createPoint(new Le(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPoint();for(var i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(ti.trimParens,"$1"),n.push(ni.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(n)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].trim().split(ti.spaces),n.push(new Le(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(n)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].trim().split(ti.spaces),n.push(new Le(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(n)},multilinestring:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiLineString();for(var i=t.trim().split(ti.parenComma),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(ti.trimParens,"$1"),n.push(ni.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(n)},polygon:function(t){var e,i,n;if(void 0===t)return this.geometryFactory.createPolygon();for(var r,o=t.trim().split(ti.parenComma),s=[],a=0,l=o.length;a<l;++a)e=o[a].replace(ti.trimParens,"$1"),i=ni.linestring.apply(this,[e]),n=this.geometryFactory.createLinearRing(i._points),0===a?r=n:s.push(n);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var i=t.trim().split(ti.doubleParenComma),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(ti.trimParens,"$1"),n.push(ni.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(n)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),i=[],n=0,r=e.length;n<r;++n)i.push(this.read(e[n]));return this.geometryFactory.createGeometryCollection(i)}},ri=function(t){this.parser=new ei(t)};ri.prototype.write=function(t){return this.parser.write(t)},ri.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var oi=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),si=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(oi),ai=function(){};ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},ai.shouldNeverReachHere=function(){if(0===arguments.length)ai.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new si("Should never reach here"+(null!==t?": "+t:""))}},ai.isTrue=function(){var t;if(1===arguments.length)ai.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new si:new si(t)},ai.equals=function(){var t,e,i;if(2===arguments.length)ai.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],i=arguments[2],!(e=arguments[1]).equals(t)))throw new si("Expected "+t+" but encountered "+e+(null!==i?": "+i:""))};var li=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Le,this._intPt[1]=new Le,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ui={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};li.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},li.prototype.getTopologySummary=function(){var t=new Ge;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},li.prototype.computeIntersection=function(t,e,i,n){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=i,this._inputLines[1][1]=n,this._result=this.computeIntersect(t,e,i,n)},li.prototype.getIntersectionNum=function(){return this._result},li.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0],e=this.getEdgeDistance(t,0),i=this.getEdgeDistance(t,1);e>i?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},li.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},li.prototype.setPrecisionModel=function(t){this._precisionModel=t},li.prototype.isInteriorIntersection=function(){var t=this;if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var e=arguments[0],i=0;i<this._result;i++)if(!t._intPt[i].equals2D(t._inputLines[e][0])&&!t._intPt[i].equals2D(t._inputLines[e][1]))return!0;return!1}},li.prototype.getIntersection=function(t){return this._intPt[t]},li.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},li.prototype.hasIntersection=function(){return this._result!==li.NO_INTERSECTION},li.prototype.getEdgeDistance=function(t,e){return li.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},li.prototype.isCollinear=function(){return this._result===li.COLLINEAR_INTERSECTION},li.prototype.toString=function(){return ri.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+ri.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},li.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},li.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},li.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li},li.computeEdgeDistance=function(t,e,i){var n=Math.abs(i.x-e.x),r=Math.abs(i.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(i))o=n>r?n:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=n>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return ai.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},li.nonRobustComputeEdgeDistance=function(t,e,i){var n=t.x-e.x,r=t.y-e.y,o=Math.sqrt(n*n+r*r);return ai.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},ui.DONT_INTERSECT.get=function(){return 0},ui.DO_INTERSECT.get=function(){return 1},ui.COLLINEAR.get=function(){return 2},ui.NO_INTERSECTION.get=function(){return 0},ui.POINT_INTERSECTION.get=function(){return 1},ui.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(li,ui);var ci=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new Ze(this._inputLines[0][0],this._inputLines[0][1]),i=new Ze(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&i.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],i=arguments[1],n=arguments[2];if(this._isProper=!1,Ze.intersects(i,n,e)&&0===di.orientationIndex(i,n,e)&&0===di.orientationIndex(n,i,e))return this._isProper=!0,(e.equals(i)||e.equals(n))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,i,n,r){r.x=this.smallestInAbsValue(t.x,e.x,i.x,n.x),r.y=this.smallestInAbsValue(t.y,e.y,i.y,n.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,i.x-=r.x,i.y-=r.y,n.x-=r.x,n.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,i,n,r){var o=null;try{o=Qe.intersection(t,i,n,r)}catch(s){if(!(s instanceof $e))throw s;o=e.nearestEndpoint(t,i,n,r)}return o},e.prototype.intersection=function(t,i,n,r){var o=this.intersectionWithNormalization(t,i,n,r);return this.isInSegmentEnvelopes(o)||(o=new Le(e.nearestEndpoint(t,i,n,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,i,n){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(i)<o&&(r=i,o=Math.abs(i)),Math.abs(n)<o&&(r=n),r},e.prototype.checkDD=function(t,e,i,n,r){var o=We.intersection(t,e,i,n),s=this.isInSegmentEnvelopes(o);Je.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&Je.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,i,n){var r=new Le(t),o=new Le(e),s=new Le(i),a=new Le(n),l=new Le;this.normalizeToEnvCentre(r,o,s,a,l);var u=this.safeHCoordinateIntersection(r,o,s,a);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,i,n,r){var o=Ze.intersects(e,i,n),s=Ze.intersects(e,i,r),a=Ze.intersects(n,r,e),l=Ze.intersects(n,r,i);return o&&s?(this._intPt[0]=n,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&l?(this._intPt[0]=e,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||s||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&l?(this._intPt[0]=n,this._intPt[1]=i,!n.equals(i)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&l?(this._intPt[0]=r,this._intPt[1]=i,!r.equals(i)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,i,n,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=i.x<n.x?i.x:n.x,c=i.y<n.y?i.y:n.y,h=i.x>n.x?i.x:n.x,p=i.y>n.y?i.y:n.y,d=((o>u?o:u)+(a<h?a:h))/2,f=((s>c?s:c)+(l<p?l:p))/2;r.x=d,r.y=f,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,i.x-=r.x,i.y-=r.y,n.x-=r.x,n.y-=r.y},e.prototype.computeIntersect=function(e,i,n,r){if(this._isProper=!1,!Ze.intersects(e,i,n,r))return t.NO_INTERSECTION;var o=di.orientationIndex(e,i,n),s=di.orientationIndex(e,i,r);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=di.orientationIndex(n,r,e),l=di.orientationIndex(n,r,i);return a>0&&l>0||a<0&&l<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===l?this.computeCollinearIntersection(e,i,n,r):(0===o||0===s||0===a||0===l?(this._isProper=!1,e.equals2D(n)||e.equals2D(r)?this._intPt[0]=e:i.equals2D(n)||i.equals2D(r)?this._intPt[0]=i:0===o?this._intPt[0]=new Le(n):0===s?this._intPt[0]=new Le(r):0===a?this._intPt[0]=new Le(e):0===l&&(this._intPt[0]=new Le(i))):(this._isProper=!0,this._intPt[0]=this.intersection(e,i,n,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,i,n){var r=t,o=di.distancePointLine(t,i,n),s=di.distancePointLine(e,i,n);return s<o&&(o=s,r=e),(s=di.distancePointLine(i,t,e))<o&&(o=s,r=i),(s=di.distancePointLine(n,t,e))<o&&(o=s,r=n),r},e}(li),hi=function(){};hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi},hi.orientationIndex=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,o=i.x-e.x,s=i.y-e.y;return hi.signOfDet2x2(n,r,o,s)},hi.signOfDet2x2=function(t,e,i,n){var r=null,o=null,s=null;if(r=1,0===t||0===n)return 0===e||0===i?0:e>0?i>0?-r:r:i>0?r:-r;if(0===e||0===i)return n>0?t>0?r:-r:t>0?-r:r;if(e>0?n>0?e<=n||(r=-r,o=t,t=i,i=o,o=e,e=n,n=o):e<=-n?(r=-r,i=-i,n=-n):(o=t,t=-i,i=o,o=e,e=-n,n=o):n>0?-e<=n?(r=-r,t=-t,e=-e):(o=-t,t=i,i=o,o=-e,e=n,n=o):e>=n?(t=-t,e=-e,i=-i,n=-n):(r=-r,o=-t,t=-i,i=o,o=-e,e=-n,n=o),t>0){if(!(i>0))return r;if(!(t<=i))return r}else{if(i>0)return-r;if(!(t>=i))return-r;r=-r,t=-t,i=-i}for(;;){if((n-=(s=Math.floor(i/t))*e)<0)return-r;if(n>e)return r;if(t>(i-=s*t)+i){if(e<n+n)return r}else{if(e>n+n)return-r;i=t-i,n=e-n,r=-r}if(0===n)return 0===i?0:-r;if(0===i)return r;if((e-=(s=Math.floor(t/i))*n)<0)return r;if(e>n)return-r;if(i>(t-=s*i)+t){if(n<e+e)return-r}else{if(n>e+e)return r;t=i-t,e=n-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var pi=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};pi.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var i=t.x,n=e.x;return i>n&&(i=e.x,n=t.x),this._p.x>=i&&this._p.x<=n&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,l=hi.signOfDet2x2(r,o,s,a);if(0===l)return this._isPointOnSegment=!0,null;a<o&&(l=-l),l>0&&this._crossingCount++}},pi.prototype.isPointInPolygon=function(){return this.getLocation()!==Re.EXTERIOR},pi.prototype.getLocation=function(){return this._isPointOnSegment?Re.BOUNDARY:this._crossingCount%2==1?Re.INTERIOR:Re.EXTERIOR},pi.prototype.isOnSegment=function(){return this._isPointOnSegment},pi.prototype.interfaces_=function(){return[]},pi.prototype.getClass=function(){return pi},pi.locatePointInRing=function(){if(arguments[0]instanceof Le&&Fe(arguments[1],qe)){for(var t=arguments[0],e=arguments[1],i=new pi(t),n=new Le,r=new Le,o=1;o<e.size();o++)if(e.getCoordinate(o,n),e.getCoordinate(o-1,r),i.countSegment(n,r),i.isOnSegment())return i.getLocation();return i.getLocation()}if(arguments[0]instanceof Le&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],l=new pi(s),u=1;u<a.length;u++){var c=a[u],h=a[u-1];if(l.countSegment(c,h),l.isOnSegment())return l.getLocation()}return l.getLocation()}};var di=function(){},fi={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};di.prototype.interfaces_=function(){return[]},di.prototype.getClass=function(){return di},di.orientationIndex=function(t,e,i){return We.orientationIndex(t,e,i)},di.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,i=t[0].x,n=1;n<t.length-1;n++){var r=t[n].x-i,o=t[n+1].y,s=t[n-1].y;e+=r*(s-o)}return e/2}if(Fe(arguments[0],qe)){var a=arguments[0],l=a.size();if(l<3)return 0;var u=new Le,c=new Le,h=new Le;a.getCoordinate(0,c),a.getCoordinate(1,h);var p=c.x;h.x-=p;for(var d=0,f=1;f<l-1;f++)u.y=c.y,c.x=h.x,c.y=h.y,a.getCoordinate(f+1,h),h.x-=p,d+=c.x*(u.y-h.y);return d/2}},di.distanceLineLine=function(t,e,i,n){if(t.equals(e))return di.distancePointLine(t,i,n);if(i.equals(n))return di.distancePointLine(n,t,e);var r=!1;if(Ze.intersects(t,e,i,n)){var o=(e.x-t.x)*(n.y-i.y)-(e.y-t.y)*(n.x-i.x);if(0===o)r=!0;else{var s=(t.y-i.y)*(n.x-i.x)-(t.x-i.x)*(n.y-i.y),a=((t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y))/o,l=s/o;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?ke.min(di.distancePointLine(t,i,n),di.distancePointLine(e,i,n),di.distancePointLine(i,t,e),di.distancePointLine(n,t,e)):0},di.isPointInRing=function(t,e){return di.locatePointInRing(t,e)!==Re.EXTERIOR},di.computeLength=function(t){var e=t.size();if(e<=1)return 0;var i=0,n=new Le;t.getCoordinate(0,n);for(var r=n.x,o=n.y,s=1;s<e;s++){t.getCoordinate(s,n);var a=n.x,l=n.y,u=a-r,c=l-o;i+=Math.sqrt(u*u+c*c),r=a,o=l}return i},di.isCCW=function(t){var e=t.length-1;if(e<3)throw new be("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=t[0],n=0,r=1;r<=e;r++){var o=t[r];o.y>i.y&&(i=o,n=r)}var s=n;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(i)&&s!==n);var a=n;do{a=(a+1)%e}while(t[a].equals2D(i)&&a!==n);var l=t[s],u=t[a];if(l.equals2D(i)||u.equals2D(i)||l.equals2D(u))return!1;var c=di.computeOrientation(l,i,u),h=!1;return h=0===c?l.x>u.x:c>0,h},di.locatePointInRing=function(t,e){return pi.locatePointInRing(t,e)},di.distancePointLinePerpendicular=function(t,e,i){var n=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),r=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/n;return Math.abs(r)*Math.sqrt(n)},di.computeOrientation=function(t,e,i){return di.orientationIndex(t,e,i)},di.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new be("Line array must contain at least one vertex");for(var i=t.distance(e[0]),n=0;n<e.length-1;n++){var r=di.distancePointLine(t,e[n],e[n+1]);r<i&&(i=r)}return i}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var l=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),u=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/l;if(u<=0)return o.distance(s);if(u>=1)return o.distance(a);var c=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/l;return Math.abs(c)*Math.sqrt(l)}},di.isOnLine=function(t,e){for(var i=new ci,n=1;n<e.length;n++){var r=e[n-1],o=e[n];if(i.computeIntersection(t,r,o),i.hasIntersection())return!0}return!1},fi.CLOCKWISE.get=function(){return-1},fi.RIGHT.get=function(){return di.CLOCKWISE},fi.COUNTERCLOCKWISE.get=function(){return 1},fi.LEFT.get=function(){return di.COUNTERCLOCKWISE},fi.COLLINEAR.get=function(){return 0},fi.STRAIGHT.get=function(){return di.COLLINEAR},Object.defineProperties(di,fi);var gi=function(){};gi.prototype.filter=function(t){},gi.prototype.interfaces_=function(){return[]},gi.prototype.getClass=function(){return gi};var mi=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},_i={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};mi.prototype.isGeometryCollection=function(){return this.getSortIndex()===mi.SORTINDEX_GEOMETRYCOLLECTION},mi.prototype.getFactory=function(){return this._factory},mi.prototype.getGeometryN=function(t){return this},mi.prototype.getArea=function(){return 0},mi.prototype.isRectangle=function(){return!1},mi.prototype.equals=function(){if(arguments[0]instanceof mi){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof mi))return!1;var i=e;return this.equalsExact(i)}},mi.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},mi.prototype.geometryChanged=function(){this.apply(mi.geometryChangedFilter)},mi.prototype.geometryChangedAction=function(){this._envelope=null},mi.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},mi.prototype.getLength=function(){return 0},mi.prototype.getNumGeometries=function(){return 1},mi.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var i=arguments[0],n=arguments[1];return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(i,n)}},mi.prototype.getUserData=function(){return this._userData},mi.prototype.getSRID=function(){return this._SRID},mi.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},mi.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===mi.SORTINDEX_GEOMETRYCOLLECTION)throw new be("This method does not support GeometryCollection arguments")},mi.prototype.equal=function(t,e,i){return 0===i?t.equals(e):t.distance(e)<=i},mi.prototype.norm=function(){var t=this.copy();return t.normalize(),t},mi.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},mi.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Ze(this._envelope)},mi.prototype.setSRID=function(t){this._SRID=t},mi.prototype.setUserData=function(t){this._userData=t},mi.prototype.compare=function(t,e){for(var i=t.iterator(),n=e.iterator();i.hasNext()&&n.hasNext();){var r=i.next(),o=n.next(),s=r.compareTo(o);if(0!==s)return s}return i.hasNext()?1:n.hasNext()?-1:0},mi.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},mi.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===mi.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===mi.SORTINDEX_MULTIPOINT||this.getSortIndex()===mi.SORTINDEX_MULTILINESTRING||this.getSortIndex()===mi.SORTINDEX_MULTIPOLYGON},mi.prototype.interfaces_=function(){return[Pe,Te,Ie]},mi.prototype.getClass=function(){return mi},mi.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},mi.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},_i.serialVersionUID.get=function(){return 0x799ea46522854c00},_i.SORTINDEX_POINT.get=function(){return 0},_i.SORTINDEX_MULTIPOINT.get=function(){return 1},_i.SORTINDEX_LINESTRING.get=function(){return 2},_i.SORTINDEX_LINEARRING.get=function(){return 3},_i.SORTINDEX_MULTILINESTRING.get=function(){return 4},_i.SORTINDEX_POLYGON.get=function(){return 5},_i.SORTINDEX_MULTIPOLYGON.get=function(){return 6},_i.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},_i.geometryChangedFilter.get=function(){return yi},Object.defineProperties(mi,_i);var yi=function(){};yi.interfaces_=function(){return[gi]},yi.filter=function(t){t.geometryChangedAction()};var vi=function(){};vi.prototype.filter=function(t){},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi};var Ci=function(){},xi={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Ci.prototype.isInBoundary=function(t){},Ci.prototype.interfaces_=function(){return[]},Ci.prototype.getClass=function(){return Ci},xi.Mod2BoundaryNodeRule.get=function(){return wi},xi.EndPointBoundaryNodeRule.get=function(){return bi},xi.MultiValentEndPointBoundaryNodeRule.get=function(){return Ei},xi.MonoValentEndPointBoundaryNodeRule.get=function(){return Si},xi.MOD2_BOUNDARY_RULE.get=function(){return new wi},xi.ENDPOINT_BOUNDARY_RULE.get=function(){return new bi},xi.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Ei},xi.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Si},xi.OGC_SFS_BOUNDARY_RULE.get=function(){return Ci.MOD2_BOUNDARY_RULE},Object.defineProperties(Ci,xi);var wi=function(){};wi.prototype.isInBoundary=function(t){return t%2==1},wi.prototype.interfaces_=function(){return[Ci]},wi.prototype.getClass=function(){return wi};var bi=function(){};bi.prototype.isInBoundary=function(t){return t>0},bi.prototype.interfaces_=function(){return[Ci]},bi.prototype.getClass=function(){return bi};var Ei=function(){};Ei.prototype.isInBoundary=function(t){return t>1},Ei.prototype.interfaces_=function(){return[Ci]},Ei.prototype.getClass=function(){return Ei};var Si=function(){};Si.prototype.isInBoundary=function(t){return 1===t},Si.prototype.interfaces_=function(){return[Ci]},Si.prototype.getClass=function(){return Si};var Ti=function(){};function Pi(t){this.message=t||""}Ti.prototype.add=function(){},Ti.prototype.addAll=function(){},Ti.prototype.isEmpty=function(){},Ti.prototype.iterator=function(){},Ti.prototype.size=function(){},Ti.prototype.toArray=function(){},Ti.prototype.remove=function(){},Pi.prototype=new Error,Pi.prototype.name="IndexOutOfBoundsException";var Ai=function(){};Ai.prototype.hasNext=function(){},Ai.prototype.next=function(){},Ai.prototype.remove=function(){};var Ii=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Ti);function Li(t){this.message=t||""}Li.prototype=new Error,Li.prototype.name="NoSuchElementException";var Ni=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ti&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Ti]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var i=this.array_[t];return this.array_[t]=e,i},e.prototype.iterator=function(){return new Mi(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new Pi;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,i=0,n=this.array_.length;i<n;i++)if(this.array_[i]===t){this.array_.splice(i,1),e=!0;break}return e},e}(Ii),Mi=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Li;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(Ai),Di=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.ensureCapacity(i.length),this.add(i,n)}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={coordArrayType:{configurable:!0}};return i.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){var e=this;if(2===arguments.length){for(var i=arguments[0],n=arguments[1],r=!1,o=i.iterator();o.hasNext();)e.add(o.next(),n),r=!0;return r}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),i=0;i<this.size();i++)e.add(i,this.get(i).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){var e=this;if(1===arguments.length){var i=arguments[0];t.prototype.add.call(this,i)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],r=arguments[1];return this.add(n,r,!0),!0}if(arguments[0]instanceof Le&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];if(!s&&this.size()>=1){var a=this.get(this.size()-1);if(a.equals2D(o))return null}t.prototype.add.call(this,o)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var l=arguments[0],u=arguments[1];return this.add(l,u),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var c=arguments[0],h=arguments[1],p=arguments[2];if(p)for(var d=0;d<c.length;d++)e.add(c[d],h);else for(var f=c.length-1;f>=0;f--)e.add(c[f],h);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof Le){var g=arguments[0],m=arguments[1],_=arguments[2];if(!_){var y=this.size();if(y>0){if(g>0){var v=this.get(g-1);if(v.equals2D(m))return null}if(g<y){var C=this.get(g);if(C.equals2D(m))return null}}}t.prototype.add.call(this,g,m)}}else if(4===arguments.length){var x=arguments[0],w=arguments[1],b=arguments[2],E=arguments[3],S=1;b>E&&(S=-1);for(var T=b;T!==E;T+=S)e.add(x[T],w);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new Le(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,i),e}(Ni),Ri=function(){},Oi={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Oi.ForwardComparator.get=function(){return Fi},Oi.BidirectionalComparator.get=function(){return ki},Oi.coordArrayType.get=function(){return new Array(0).fill(null)},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri},Ri.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},Ri.ptNotInList=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(Ri.indexOf(n,e)<0)return n}return null},Ri.scroll=function(t,e){var i=Ri.indexOf(e,t);if(i<0)return null;var n=new Array(t.length).fill(null);Je.arraycopy(t,i,n,0,t.length-i),Je.arraycopy(t,0,n,t.length-i,i),Je.arraycopy(n,0,t,0,t.length)},Ri.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].equals(e[i]))return!1;return!0}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];if(n===r)return!0;if(null===n||null===r)return!1;if(n.length!==r.length)return!1;for(var s=0;s<n.length;s++)if(0!==o.compare(n[s],r[s]))return!1;return!0}},Ri.intersection=function(t,e){for(var i=new Di,n=0;n<t.length;n++)e.intersects(t[n])&&i.add(t[n],!0);return i.toCoordinateArray()},Ri.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Ri.removeRepeatedPoints=function(t){return Ri.hasRepeatedPoints(t)?new Di(t,!1).toCoordinateArray():t},Ri.reverse=function(t){for(var e=t.length-1,i=Math.trunc(e/2),n=0;n<=i;n++){var r=t[n];t[n]=t[e-n],t[e-n]=r}},Ri.removeNull=function(t){for(var e=0,i=0;i<t.length;i++)null!==t[i]&&e++;var n=new Array(e).fill(null);if(0===e)return n;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(n[r++]=t[o]);return n},Ri.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),i=0;i<t.length;i++)e[i]=new Le(t[i]);return e}if(5===arguments.length)for(var n=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],l=0;l<a;l++)o[s+l]=new Le(n[r+l])},Ri.isEqualReversed=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=e[t.length-i-1];if(0!==n.compareTo(r))return!1}return!0},Ri.envelope=function(t){for(var e=new Ze,i=0;i<t.length;i++)e.expandToInclude(t[i]);return e},Ri.toCoordinateArray=function(t){return t.toArray(Ri.coordArrayType)},Ri.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Ri.indexOf=function(t,e){for(var i=0;i<e.length;i++)if(t.equals(e[i]))return i;return-1},Ri.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var i=t.length-1-e,n=t[e].compareTo(t[i]);if(0!==n)return n}return 1},Ri.compare=function(t,e){for(var i=0;i<t.length&&i<e.length;){var n=t[i].compareTo(e[i]);if(0!==n)return n;i++}return i<e.length?-1:i<t.length?1:0},Ri.minCoordinate=function(t){for(var e=null,i=0;i<t.length;i++)(null===e||e.compareTo(t[i])>0)&&(e=t[i]);return e},Ri.extract=function(t,e,i){e=ke.clamp(e,0,t.length);var n=(i=ke.clamp(i,-1,t.length))-e+1;i<0&&(n=0),e>=t.length&&(n=0),i<e&&(n=0);var r=new Array(n).fill(null);if(0===n)return r;for(var o=0,s=e;s<=i;s++)r[o++]=t[s];return r},Object.defineProperties(Ri,Oi);var Fi=function(){};Fi.prototype.compare=function(t,e){return Ri.compare(t,e)},Fi.prototype.interfaces_=function(){return[Ae]},Fi.prototype.getClass=function(){return Fi};var ki=function(){};ki.prototype.compare=function(t,e){var i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;var r=Ri.compare(i,n);return Ri.isEqualReversed(i,n)?0:r},ki.prototype.OLDcompare=function(t,e){var i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;for(var r=Ri.increasingDirection(i),o=Ri.increasingDirection(n),s=r>0?0:i.length-1,a=o>0?0:i.length-1,l=0;l<i.length;l++){var u=i[s].compareTo(n[a]);if(0!==u)return u;s+=r,a+=o}return 0},ki.prototype.interfaces_=function(){return[Ae]},ki.prototype.getClass=function(){return ki};var zi=function(){};zi.prototype.get=function(){},zi.prototype.put=function(){},zi.prototype.size=function(){},zi.prototype.values=function(){},zi.prototype.entrySet=function(){};var Gi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(zi);function Bi(t){this.message=t||""}function Ui(){}Bi.prototype=new Error,Bi.prototype.name="OperationNotSupported",Ui.prototype=new Ti,Ui.prototype.contains=function(){};var Vi=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ti&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,i=this.array_.length;e<i;e++){if(this.array_[e]===t)return!0}return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Hi(this)},e}(Ui),Hi=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Li;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new Bi},e}(Ai);function Wi(t){return null===t?0:t.color}function ji(t){return null===t?null:t.parent}function qi(t,e){null!==t&&(t.color=e)}function Yi(t){return null===t?null:t.left}function Xi(t){return null===t?null:t.right}function $i(){this.root_=null,this.size_=0}$i.prototype=new Gi,$i.prototype.get=function(t){for(var e=this.root_;null!==e;){var i=t.compareTo(e.key);if(i<0)e=e.left;else{if(!(i>0))return e.value;e=e.right}}return null},$i.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var i,n,r=this.root_;do{if(i=r,(n=t.compareTo(r.key))<0)r=r.left;else{if(!(n>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:i,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return n<0?i.left=s:i.right=s,this.fixAfterInsertion(s),this.size_++,null},$i.prototype.fixAfterInsertion=function(t){var e=this;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(ji(t)===Yi(ji(ji(t)))){var i=Xi(ji(ji(t)));1===Wi(i)?(qi(ji(t),0),qi(i,0),qi(ji(ji(t)),1),t=ji(ji(t))):(t===Xi(ji(t))&&(t=ji(t),e.rotateLeft(t)),qi(ji(t),0),qi(ji(ji(t)),1),e.rotateRight(ji(ji(t))))}else{var n=Yi(ji(ji(t)));1===Wi(n)?(qi(ji(t),0),qi(n,0),qi(ji(ji(t)),1),t=ji(ji(t))):(t===Yi(ji(t))&&(t=ji(t),e.rotateRight(t)),qi(ji(t),0),qi(ji(ji(t)),1),e.rotateLeft(ji(ji(t))))}this.root_.color=0},$i.prototype.values=function(){var t=new Ni,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=$i.successor(e));)t.add(e.value);return t},$i.prototype.entrySet=function(){var t=new Vi,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=$i.successor(e));)t.add(e);return t},$i.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},$i.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},$i.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},$i.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var i=t.parent,n=t;null!==i&&n===i.right;)n=i,i=i.parent;return i},$i.prototype.size=function(){return this.size_};var Ji=function(){};function Qi(){}function Zi(){this.array_=[],arguments[0]instanceof Ti&&this.addAll(arguments[0])}Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji},Qi.prototype=new Ui,Zi.prototype=new Qi,Zi.prototype.contains=function(t){for(var e=0,i=this.array_.length;e<i;e++){if(0===this.array_[e].compareTo(t))return!0}return!1},Zi.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,i=this.array_.length;e<i;e++){if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0}return this.array_.push(t),!0},Zi.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Zi.prototype.remove=function(t){throw new Bi},Zi.prototype.size=function(){return this.array_.length},Zi.prototype.isEmpty=function(){return 0===this.array_.length},Zi.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},Zi.prototype.iterator=function(){return new Ki(this)};var Ki=function(t){this.treeSet_=t,this.position_=0};Ki.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Li;return this.treeSet_.array_[this.position_++]},Ki.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Ki.prototype.remove=function(){throw new Bi};var tn=function(){};tn.sort=function(){var t,e,i,n,r=arguments[0];if(1===arguments.length)n=function(t,e){return t.compareTo(e)},r.sort(n);else if(2===arguments.length)i=arguments[1],n=function(t,e){return i.compare(t,e)},r.sort(n);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),i=arguments[3],n=function(t,e){return i.compare(t,e)},e.sort(n),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},tn.asList=function(t){for(var e=new Ni,i=0,n=t.length;i<n;i++)e.add(t[i]);return e};var en=function(){},nn={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};nn.P.get=function(){return 0},nn.L.get=function(){return 1},nn.A.get=function(){return 2},nn.FALSE.get=function(){return-1},nn.TRUE.get=function(){return-2},nn.DONTCARE.get=function(){return-3},nn.SYM_FALSE.get=function(){return"F"},nn.SYM_TRUE.get=function(){return"T"},nn.SYM_DONTCARE.get=function(){return"*"},nn.SYM_P.get=function(){return"0"},nn.SYM_L.get=function(){return"1"},nn.SYM_A.get=function(){return"2"},en.prototype.interfaces_=function(){return[]},en.prototype.getClass=function(){return en},en.toDimensionSymbol=function(t){switch(t){case en.FALSE:return en.SYM_FALSE;case en.TRUE:return en.SYM_TRUE;case en.DONTCARE:return en.SYM_DONTCARE;case en.P:return en.SYM_P;case en.L:return en.SYM_L;case en.A:return en.SYM_A}throw new be("Unknown dimension value: "+t)},en.toDimensionValue=function(t){switch(Ue.toUpperCase(t)){case en.SYM_FALSE:return en.FALSE;case en.SYM_TRUE:return en.TRUE;case en.SYM_DONTCARE:return en.DONTCARE;case en.SYM_P:return en.P;case en.SYM_L:return en.L;case en.SYM_A:return en.A}throw new be("Unknown dimension symbol: "+t)},Object.defineProperties(en,nn);var rn=function(){};rn.prototype.filter=function(t){},rn.prototype.interfaces_=function(){return[]},rn.prototype.getClass=function(){return rn};var on=function(){};on.prototype.filter=function(t,e){},on.prototype.isDone=function(){},on.prototype.isGeometryChanged=function(){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var sn=function(t){function e(e,i){if(t.call(this,i),this._geometries=e||[],t.hasNullElements(this._geometries))throw new be("geometries must not contain null elements")}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new Ze,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=0;i<this._geometries.length;i++)for(var n=this._geometries[i].getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var i=arguments[0],n=arguments[1];if(!this.isEquivalentClass(i))return!1;var r=i;if(this._geometries.length!==r._geometries.length)return!1;for(var o=0;o<this._geometries.length;o++)if(!e._geometries[o].equalsExact(r._geometries[o],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();tn.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=en.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=en.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){var e=arguments[0],i=new Zi(tn.asList(this._geometries)),n=new Zi(tn.asList(e._geometries));return this.compare(i,n)}if(2===arguments.length){for(var r=arguments[0],o=arguments[1],s=r,a=this.getNumGeometries(),l=s.getNumGeometries(),u=0;u<a&&u<l;){var c=t.getGeometryN(u),h=s.getGeometryN(u),p=c.compareToSameClass(h,o);if(0!==p)return p;u++}return u<a?1:u<l?-1:0}},e.prototype.apply=function(){var t=this;if(Fe(arguments[0],vi))for(var e=arguments[0],i=0;i<this._geometries.length;i++)t._geometries[i].apply(e);else if(Fe(arguments[0],on)){var n=arguments[0];if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(t._geometries[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(Fe(arguments[0],rn)){var o=arguments[0];o.filter(this);for(var s=0;s<this._geometries.length;s++)t._geometries[s].apply(o)}else if(Fe(arguments[0],gi)){var a=arguments[0];a.filter(this);for(var l=0;l<this._geometries.length;l++)t._geometries[l].apply(a)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),ai.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var i=0;i<this._geometries.length;i++)e._geometries[i]=this._geometries[i].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,i),e}(mi),an=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return mi.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?en.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[t-1-i]=this._geometries[i].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new ln(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Ji]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,i),e}(sn),ln=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=Ci.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=n}};ln.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},ln.prototype.getBoundary=function(){return this._geom instanceof vn?this.boundaryLineString(this._geom):this._geom instanceof an?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},ln.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},ln.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},ln.prototype.computeBoundaryCoordinates=function(t){var e=this,i=new Ni;this._endpointMap=new $i;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);0!==r.getNumPoints()&&(e.addEndpoint(r.getCoordinateN(0)),e.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var o=this._endpointMap.entrySet().iterator();o.hasNext();){var s=o.next(),a=s.getValue().count;e._bnRule.isInBoundary(a)&&i.add(s.getKey())}return Ri.toCoordinateArray(i)},ln.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new un,this._endpointMap.put(t,e)),e.count++},ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln},ln.getBoundary=function(){if(1===arguments.length){var t=arguments[0],e=new ln(t);return e.getBoundary()}if(2===arguments.length){var i=arguments[0],n=arguments[1],r=new ln(i,n);return r.getBoundary()}};var un=function(){this.count=null};function cn(){}function hn(){}un.prototype.interfaces_=function(){return[]},un.prototype.getClass=function(){return un};var pn=function(){};function dn(){}function fn(){}function gn(){}var mn=function(){},_n={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn},mn.chars=function(t,e){for(var i=new Array(e).fill(null),n=0;n<e;n++)i[n]=t;return String(i)},mn.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new dn,i=new cn;return t.printStackTrace(i),e.toString()}if(2===arguments.length){var n=arguments[0],r=arguments[1],o="";new hn(mn.getStackTrace(n));for(var s=new gn,a=0;a<r;a++)try{o+=s.readLine()+mn.NEWLINE}catch(t){if(!(t instanceof fn))throw t;ai.shouldNeverReachHere()}return o}},mn.split=function(t,e){for(var i=e.length,n=new Ni,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);n.add(s),o=(r=r.substring(o+i)).indexOf(e)}r.length>0&&n.add(r);for(var a=new Array(n.size()).fill(null),l=0;l<a.length;l++)a[l]=n.get(l);return a},mn.toString=function(){if(1===arguments.length){var t=arguments[0];return mn.SIMPLE_ORDINATE_FORMAT.format(t)}},mn.spaces=function(t){return mn.chars(" ",t)},_n.NEWLINE.get=function(){return Je.getProperty("line.separator")},_n.SIMPLE_ORDINATE_FORMAT.get=function(){return new pn},Object.defineProperties(mn,_n);var yn=function(){};yn.prototype.interfaces_=function(){return[]},yn.prototype.getClass=function(){return yn},yn.copyCoord=function(t,e,i,n){for(var r=Math.min(t.getDimension(),i.getDimension()),o=0;o<r;o++)i.setOrdinate(n,o,t.getOrdinate(e,o))},yn.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&(t.getOrdinate(0,qe.X)===t.getOrdinate(e-1,qe.X)&&t.getOrdinate(0,qe.Y)===t.getOrdinate(e-1,qe.Y))},yn.isEqual=function(t,e){var i=t.size();if(i!==e.size())return!1;for(var n=Math.min(t.getDimension(),e.getDimension()),r=0;r<i;r++)for(var o=0;o<n;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(t.getOrdinate(r,o)!==e.getOrdinate(r,o)&&(!Ee.isNaN(s)||!Ee.isNaN(a)))return!1}return!0},yn.extend=function(t,e,i){var n=t.create(i,e.getDimension()),r=e.size();if(yn.copy(e,0,n,0,r),r>0)for(var o=r;o<i;o++)yn.copy(e,r-1,n,o,1);return n},yn.reverse=function(t){for(var e=t.size()-1,i=Math.trunc(e/2),n=0;n<=i;n++)yn.swap(t,n,e-n)},yn.swap=function(t,e,i){if(e===i)return null;for(var n=0;n<t.getDimension();n++){var r=t.getOrdinate(e,n);t.setOrdinate(e,n,t.getOrdinate(i,n)),t.setOrdinate(i,n,r)}},yn.copy=function(t,e,i,n,r){for(var o=0;o<r;o++)yn.copyCoord(t,e+o,i,n+o)},yn.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var i=t.getDimension(),n=new Ge;n.append("(");for(var r=0;r<e;r++){r>0&&n.append(" ");for(var o=0;o<i;o++)o>0&&n.append(","),n.append(mn.toString(t.getOrdinate(r,o)))}return n.append(")"),n.toString()}},yn.ensureValidRing=function(t,e){var i=e.size();return 0===i?e:i<=3?yn.createClosedRing(t,e,4):e.getOrdinate(0,qe.X)===e.getOrdinate(i-1,qe.X)&&e.getOrdinate(0,qe.Y)===e.getOrdinate(i-1,qe.Y)?e:yn.createClosedRing(t,e,i+1)},yn.createClosedRing=function(t,e,i){var n=t.create(i,e.getDimension()),r=e.size();yn.copy(e,0,n,0,r);for(var o=r;o<i;o++)yn.copy(e,0,n,o,1);return n};var vn=function(t){function e(e,i){t.call(this,i),this._points=null,this.init(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Ze:this._points.expandEnvelope(new Ze)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var i=arguments[0],n=arguments[1];if(!this.isEquivalentClass(i))return!1;var r=i;if(this._points.size()!==r._points.size())return!1;for(var o=0;o<this._points.size();o++)if(!e.equal(e._points.getCoordinate(o),r._points.getCoordinate(o),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=this,e=0;e<Math.trunc(this._points.size()/2);e++){var i=t._points.size()-1-e;if(!t._points.getCoordinate(e).equals(t._points.getCoordinate(i)))return t._points.getCoordinate(e).compareTo(t._points.getCoordinate(i))>0&&yn.reverse(t._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?en.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return di.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return yn.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],i=e,n=0,r=0;n<this._points.size()&&r<i._points.size();){var o=t._points.getCoordinate(n).compareTo(i._points.getCoordinate(r));if(0!==o)return o;n++,r++}return n<this._points.size()?1:r<i._points.size()?-1:0}if(2===arguments.length){var s=arguments[0],a=arguments[1],l=s;return a.compare(this._points,l._points)}},e.prototype.apply=function(){var t=this;if(Fe(arguments[0],vi))for(var e=arguments[0],i=0;i<this._points.size();i++)e.filter(t._points.getCoordinate(i));else if(Fe(arguments[0],on)){var n=arguments[0];if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(n.filter(t._points,r),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(Fe(arguments[0],rn)){var o=arguments[0];o.filter(this)}else if(Fe(arguments[0],gi)){var s=arguments[0];s.filter(this)}},e.prototype.getBoundary=function(){return new ln(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new be("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Ji]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,i),e}(mi),Cn=function(){};Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn};var xn=function(t){function e(e,i){t.call(this,i),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Ze;var t=new Ze;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),i))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return en.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getCoordinate().compareTo(e.getCoordinate())}if(2===arguments.length){var i=arguments[0],n=arguments[1],r=i;return n.compare(this._coordinates,r._coordinates)}},e.prototype.apply=function(){if(Fe(arguments[0],vi)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(Fe(arguments[0],on)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else if(Fe(arguments[0],rn)){var i=arguments[0];i.filter(this)}else if(Fe(arguments[0],gi)){var n=arguments[0];n.filter(this)}},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),ai.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Cn]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,i),e}(mi),wn=function(){};wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn};var bn=function(t){function e(e,i,n){if(t.call(this,n),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===i&&(i=[]),t.hasNullElements(i))throw new be("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(i))throw new be("shell is empty but holes are not");this._shell=e,this._holes=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=this._shell.getCoordinates(),n=0;n<i.length;n++)t[++e]=i[n];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(di.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(di.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),i=0;i<5;i++){var n=t.getX(i);if(n!==e.getMinX()&&n!==e.getMaxX())return!1;var r=t.getY(i);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),u=t.getY(a);if(l!==o===(u!==s))return!1;o=l,s=u}return!0},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var i=arguments[0],n=arguments[1];if(!this.isEquivalentClass(i))return!1;var r=i,o=this._shell,s=r._shell;if(!o.equalsExact(s,n))return!1;if(this._holes.length!==r._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!e._holes[a].equalsExact(r._holes[a],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){var t=this;if(0===arguments.length){this.normalize(this._shell,!0);for(var e=0;e<this._holes.length;e++)t.normalize(t._holes[e],!1);tn.sort(this._holes)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];if(i.isEmpty())return null;var r=new Array(i.getCoordinates().length-1).fill(null);Je.arraycopy(i.getCoordinates(),0,r,0,r.length);var o=Ri.minCoordinate(i.getCoordinates());Ri.scroll(r,o),Je.arraycopy(r,0,i.getCoordinates(),0,r.length),i.getCoordinates()[r.length]=r[0],di.isCCW(i.getCoordinates())===n&&Ri.reverse(i.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){var e=arguments[0],i=this._shell,n=e._shell;return i.compareToSameClass(n)}if(2===arguments.length){var r=arguments[0],o=arguments[1],s=r,a=this._shell,l=s._shell,u=a.compareToSameClass(l,o);if(0!==u)return u;for(var c=this.getNumInteriorRing(),h=s.getNumInteriorRing(),p=0;p<c&&p<h;){var d=t.getInteriorRingN(p),f=s.getInteriorRingN(p),g=d.compareToSameClass(f,o);if(0!==g)return g;p++}return p<c?1:p<h?-1:0}},e.prototype.apply=function(t){var e=this;if(Fe(t,vi)){this._shell.apply(t);for(var i=0;i<this._holes.length;i++)e._holes[i].apply(t)}else if(Fe(t,on)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(e._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(Fe(t,rn))t.filter(this);else if(Fe(t,gi)){t.filter(this),this._shell.apply(t);for(var r=0;r<this._holes.length;r++)e._holes[r].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var i=0;i<this._holes.length;i++)e._holes[i]=this._holes[i].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),i=new Array(this._holes.length).fill(null),n=0;n<i.length;n++)i[n]=this._holes[n].copy();return new e(t,i,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[wn]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,i),e}(mi),En=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return mi.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return en.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Cn]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,i),e}(sn),Sn=function(t){function e(e,i){e instanceof Le&&i instanceof Un&&(e=i.getCoordinateSequenceFactory().create(e)),t.call(this,e,i),this.validateConstruction()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return mi.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return en.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return yn.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new be("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new be("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.MINIMUM_VALID_SIZE.get=function(){return 4},i.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,i),e}(vn),Tn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return mi.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Ni,e=0;e<this._geometries.length;e++)for(var i=this._geometries[e].getBoundary(),n=0;n<i.getNumGeometries();n++)t.add(i.getGeometryN(n));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[wn]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,i),e}(sn),Pn=function(t){this._factory=t||null,this._isUserDataCopied=!1},An={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Pn.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},Pn.prototype.edit=function(t,e){if(null===t)return null;var i=this.editInternal(t,e);return this._isUserDataCopied&&i.setUserData(t.getUserData()),i},Pn.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof sn?this.editGeometryCollection(t,e):t instanceof bn?this.editPolygon(t,e):t instanceof xn||t instanceof vn?e.edit(t,this._factory):(ai.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},Pn.prototype.editGeometryCollection=function(t,e){for(var i=e.edit(t,this._factory),n=new Ni,r=0;r<i.getNumGeometries();r++){var o=this.edit(i.getGeometryN(r),e);null===o||o.isEmpty()||n.add(o)}return i.getClass()===En?this._factory.createMultiPoint(n.toArray([])):i.getClass()===an?this._factory.createMultiLineString(n.toArray([])):i.getClass()===Tn?this._factory.createMultiPolygon(n.toArray([])):this._factory.createGeometryCollection(n.toArray([]))},Pn.prototype.editPolygon=function(t,e){var i=e.edit(t,this._factory);if(null===i&&(i=this._factory.createPolygon(null)),i.isEmpty())return i;var n=this.edit(i.getExteriorRing(),e);if(null===n||n.isEmpty())return this._factory.createPolygon();for(var r=new Ni,o=0;o<i.getNumInteriorRing();o++){var s=this.edit(i.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(n,r.toArray([]))},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn},Pn.GeometryEditorOperation=function(){},An.NoOpGeometryOperation.get=function(){return In},An.CoordinateOperation.get=function(){return Ln},An.CoordinateSequenceOperation.get=function(){return Nn},Object.defineProperties(Pn,An);var In=function(){};In.prototype.edit=function(t,e){return t},In.prototype.interfaces_=function(){return[Pn.GeometryEditorOperation]},In.prototype.getClass=function(){return In};var Ln=function(){};Ln.prototype.edit=function(t,e){var i=this.editCoordinates(t.getCoordinates(),t);return null===i?t:t instanceof Sn?e.createLinearRing(i):t instanceof vn?e.createLineString(i):t instanceof xn?i.length>0?e.createPoint(i[0]):e.createPoint():t},Ln.prototype.interfaces_=function(){return[Pn.GeometryEditorOperation]},Ln.prototype.getClass=function(){return Ln};var Nn=function(){};Nn.prototype.edit=function(t,e){return t instanceof Sn?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof vn?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof xn?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},Nn.prototype.interfaces_=function(){return[Pn.GeometryEditorOperation]},Nn.prototype.getClass=function(){return Nn};var Mn=function(){var t=this;if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var i=0;i<e;i++)t._coordinates[i]=new Le}else if(Fe(arguments[0],qe)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)t._coordinates[r]=n.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var o=arguments[0],s=arguments[1];this._coordinates=o,this._dimension=s,null===o&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],l=arguments[1];this._coordinates=new Array(a).fill(null),this._dimension=l;for(var u=0;u<a;u++)t._coordinates[u]=new Le}},Dn={serialVersionUID:{configurable:!0}};Mn.prototype.setOrdinate=function(t,e,i){switch(e){case qe.X:this._coordinates[t].x=i;break;case qe.Y:this._coordinates[t].y=i;break;case qe.Z:this._coordinates[t].z=i;break;default:throw new be("invalid ordinateIndex")}},Mn.prototype.size=function(){return this._coordinates.length},Mn.prototype.getOrdinate=function(t,e){switch(e){case qe.X:return this._coordinates[t].x;case qe.Y:return this._coordinates[t].y;case qe.Z:return this._coordinates[t].z}return Ee.NaN},Mn.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],i=arguments[1];i.x=this._coordinates[e].x,i.y=this._coordinates[e].y,i.z=this._coordinates[e].z}},Mn.prototype.getCoordinateCopy=function(t){return new Le(this._coordinates[t])},Mn.prototype.getDimension=function(){return this._dimension},Mn.prototype.getX=function(t){return this._coordinates[t].x},Mn.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Mn(t,this._dimension)},Mn.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Mn.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Mn(t,this._dimension)},Mn.prototype.toString=function(){if(this._coordinates.length>0){var t=new Ge(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Mn.prototype.getY=function(t){return this._coordinates[t].y},Mn.prototype.toCoordinateArray=function(){return this._coordinates},Mn.prototype.interfaces_=function(){return[qe,Ie]},Mn.prototype.getClass=function(){return Mn},Dn.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Mn,Dn);var Rn=function(){},On={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Rn.prototype.readResolve=function(){return Rn.instance()},Rn.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new Mn(t)}if(Fe(arguments[0],qe)){var e=arguments[0];return new Mn(e)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return n>3&&(n=3),n<2?new Mn(i):new Mn(i,n)}},Rn.prototype.interfaces_=function(){return[De,Ie]},Rn.prototype.getClass=function(){return Rn},Rn.instance=function(){return Rn.instanceObject},On.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},On.instanceObject.get=function(){return new Rn},Object.defineProperties(Rn,On);var Fn=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new Ni,e=this.map_.values(),i=e.next();!i.done;)t.add(i.value),i=e.next();return t},e.prototype.entrySet=function(){var t=new Vi;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(zi),kn=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Gn){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var i=arguments[0];this._modelType=t.FIXED,this.setScale(i)}else if(arguments[0]instanceof t){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}},zn={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};kn.prototype.equals=function(t){if(!(t instanceof kn))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},kn.prototype.compareTo=function(t){var e=t,i=this.getMaximumSignificantDigits(),n=e.getMaximumSignificantDigits();return new Be(i).compareTo(new Be(n))},kn.prototype.getScale=function(){return this._scale},kn.prototype.isFloating=function(){return this._modelType===kn.FLOATING||this._modelType===kn.FLOATING_SINGLE},kn.prototype.getType=function(){return this._modelType},kn.prototype.toString=function(){var t="UNKNOWN";return this._modelType===kn.FLOATING?t="Floating":this._modelType===kn.FLOATING_SINGLE?t="Floating-Single":this._modelType===kn.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},kn.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];if(Ee.isNaN(t))return t;if(this._modelType===kn.FLOATING_SINGLE){return t}return this._modelType===kn.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof Le){var e=arguments[0];if(this._modelType===kn.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},kn.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===kn.FLOATING?t=16:this._modelType===kn.FLOATING_SINGLE?t=6:this._modelType===kn.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},kn.prototype.setScale=function(t){this._scale=Math.abs(t)},kn.prototype.interfaces_=function(){return[Ie,Te]},kn.prototype.getClass=function(){return kn},kn.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},zn.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},zn.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(kn,zn);var Gn=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},Bn={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Gn.prototype.readResolve=function(){return Gn.nameToTypeMap.get(this._name)},Gn.prototype.toString=function(){return this._name},Gn.prototype.interfaces_=function(){return[Ie]},Gn.prototype.getClass=function(){return Gn},Bn.serialVersionUID.get=function(){return-552860263173159e4},Bn.nameToTypeMap.get=function(){return new Fn},Object.defineProperties(Gn,Bn),kn.Type=Gn,kn.FIXED=new Gn("FIXED"),kn.FLOATING=new Gn("FLOATING"),kn.FLOATING_SINGLE=new Gn("FLOATING SINGLE");var Un=function t(){this._precisionModel=new kn,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Fe(arguments[0],De)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof kn&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Vn={serialVersionUID:{configurable:!0}};Un.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new Le(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new Le(t.getMinX(),t.getMinY()),new Le(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new Le(t.getMinX(),t.getMinY()),new Le(t.getMinX(),t.getMaxY()),new Le(t.getMaxX(),t.getMaxY()),new Le(t.getMaxX(),t.getMinY()),new Le(t.getMinX(),t.getMinY())]),null)},Un.prototype.createLineString=function(t){return t?t instanceof Array?new vn(this.getCoordinateSequenceFactory().create(t),this):Fe(t,qe)?new vn(t,this):void 0:new vn(this.getCoordinateSequenceFactory().create([]),this)},Un.prototype.createMultiLineString=function(){if(0===arguments.length)return new an(null,this);if(1===arguments.length){var t=arguments[0];return new an(t,this)}},Un.prototype.buildGeometry=function(t){for(var e=null,i=!1,n=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(i=!0),o.isGeometryCollectionOrDerived()&&(n=!0)}if(null===e)return this.createGeometryCollection();if(i||n)return this.createGeometryCollection(Un.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof bn)return this.createMultiPolygon(Un.toPolygonArray(t));if(a instanceof vn)return this.createMultiLineString(Un.toLineStringArray(t));if(a instanceof xn)return this.createMultiPoint(Un.toPointArray(t));ai.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},Un.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},Un.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Le){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(Fe(arguments[0],qe)){var e=arguments[0];return new xn(e,this)}}},Un.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Un.prototype.createPolygon=function(){if(0===arguments.length)return new bn(null,null,this);if(1===arguments.length){if(Fe(arguments[0],qe)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Sn){var i=arguments[0];return this.createPolygon(i,null)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return new bn(n,r,this)}},Un.prototype.getSRID=function(){return this._SRID},Un.prototype.createGeometryCollection=function(){if(0===arguments.length)return new sn(null,this);if(1===arguments.length){var t=arguments[0];return new sn(t,this)}},Un.prototype.createGeometry=function(t){return new Pn(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},Un.prototype.getPrecisionModel=function(){return this._precisionModel},Un.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(Fe(arguments[0],qe)){var e=arguments[0];return new Sn(e,this)}}},Un.prototype.createMultiPolygon=function(){if(0===arguments.length)return new Tn(null,this);if(1===arguments.length){var t=arguments[0];return new Tn(t,this)}},Un.prototype.createMultiPoint=function(){var t=this;if(0===arguments.length)return new En(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return new En(e,this)}if(arguments[0]instanceof Array){var i=arguments[0];return this.createMultiPoint(null!==i?this.getCoordinateSequenceFactory().create(i):null)}if(Fe(arguments[0],qe)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var r=new Array(n.size()).fill(null),o=0;o<n.size();o++){var s=t.getCoordinateSequenceFactory().create(1,n.getDimension());yn.copy(n,o,s,0,1),r[o]=t.createPoint(s)}return this.createMultiPoint(r)}}},Un.prototype.interfaces_=function(){return[Ie]},Un.prototype.getClass=function(){return Un},Un.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Un.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},Un.getDefaultCoordinateSequenceFactory=function(){return Rn.instance()},Un.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Un.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Un.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Un.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Un.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Un.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Un.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},Vn.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(Un,Vn);var Hn=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Wn=function(t){this.geometryFactory=t||new Un};Wn.prototype.read=function(t){var e,i=(e="string"==typeof t?JSON.parse(t):t).type;if(!jn[i])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Hn.indexOf(i)?jn[i].apply(this,[e.coordinates]):"GeometryCollection"===i?jn[i].apply(this,[e.geometries]):jn[i].apply(this,[e])},Wn.prototype.write=function(t){var e=t.getGeometryType();if(!qn[e])throw new Error("Geometry is not supported");return qn[e].apply(this,[t])};var jn={Feature:function(t){var e={};for(var i in t)e[i]=t[i];if(t.geometry){var n=t.geometry.type;if(!jn[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=jn.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var i=0;i<t.features.length;++i)e.features.push(this.read(t.features[i]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(new Le(n[0],n[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new Le(t[0],t[1]),new Le(t[2],t[1]),new Le(t[2],t[3]),new Le(t[0],t[3]),new Le(t[0],t[1])])},Point:function(t){var e=new Le(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],i=0;i<t.length;++i)e.push(jn.Point.apply(this,[t[i]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=jn.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],i=0;i<t.length;++i)e.push(jn.LineString.apply(this,[t[i]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=jn.coordinates.apply(this,[t[0]]),i=this.geometryFactory.createLinearRing(e),n=[],r=1;r<t.length;++r){var o=t[r],s=jn.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);n.push(a)}return this.geometryFactory.createPolygon(i,n)},MultiPolygon:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(jn.Polygon.apply(this,[n]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},qn={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:qn.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=qn.Point.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],i=t.getCoordinates(),n=0;n<i.length;++n){var r=i[n];e.push(qn.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=qn.LineString.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],i=qn.LineString.apply(this,[t._shell]);e.push(i.coordinates);for(var n=0;n<t._holes.length;++n){var r=t._holes[n],o=qn.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=qn.Polygon.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=n.getGeometryType();e.push(qn[r].apply(this,[n]))}return{type:"GeometryCollection",geometries:e}}},Yn=function(t){this.geometryFactory=t||new Un,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Wn(this.geometryFactory)};Yn.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===kn.FIXED&&this.reducePrecision(e),e},Yn.prototype.reducePrecision=function(t){var e,i;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,i=t.points.length;e<i;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,i=t.geometries.length;e<i;e++)this.reducePrecision(t.geometries[e])};var Xn=function(){this.parser=new Wn(this.geometryFactory)};Xn.prototype.write=function(t){return this.parser.write(t)};var $n=function(){},Jn={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};function Qn(t){this.message=t||""}function Zn(){this.array_=[]}$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},$n.opposite=function(t){return t===$n.LEFT?$n.RIGHT:t===$n.RIGHT?$n.LEFT:t},Jn.ON.get=function(){return 0},Jn.LEFT.get=function(){return 1},Jn.RIGHT.get=function(){return 2},Object.defineProperties($n,Jn),Qn.prototype=new Error,Qn.prototype.name="EmptyStackException",Zn.prototype=new Ii,Zn.prototype.add=function(t){return this.array_.push(t),!0},Zn.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},Zn.prototype.push=function(t){return this.array_.push(t),t},Zn.prototype.pop=function(t){if(0===this.array_.length)throw new Qn;return this.array_.pop()},Zn.prototype.peek=function(){if(0===this.array_.length)throw new Qn;return this.array_[this.array_.length-1]},Zn.prototype.empty=function(){return 0===this.array_.length},Zn.prototype.isEmpty=function(){return this.empty()},Zn.prototype.search=function(t){return this.array_.indexOf(t)},Zn.prototype.size=function(){return this.array_.length},Zn.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t};var Kn=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Kn.prototype.getCoordinate=function(){return this._minCoord},Kn.prototype.getRightmostSide=function(t,e){var i=this.getRightmostSideOfSegment(t,e);return i<0&&(i=this.getRightmostSideOfSegment(t,e-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),i},Kn.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();ai.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],i=t[this._minIndex+1],n=di.computeOrientation(this._minCoord,i,e),r=!1;(e.y<this._minCoord.y&&i.y<this._minCoord.y&&n===di.COUNTERCLOCKWISE||e.y>this._minCoord.y&&i.y>this._minCoord.y&&n===di.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Kn.prototype.getRightmostSideOfSegment=function(t,e){var i=t.getEdge().getCoordinates();if(e<0||e+1>=i.length)return-1;if(i[e].y===i[e+1].y)return-1;var n=$n.LEFT;return i[e].y<i[e+1].y&&(n=$n.RIGHT),n},Kn.prototype.getEdge=function(){return this._orientedDe},Kn.prototype.checkForRightmostCoordinate=function(t){for(var e=this,i=t.getEdge().getCoordinates(),n=0;n<i.length-1;n++)(null===e._minCoord||i[n].x>e._minCoord.x)&&(e._minDe=t,e._minIndex=n,e._minCoord=i[n])},Kn.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Kn.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();i.isForward()&&this.checkForRightmostCoordinate(i)}ai.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===$n.LEFT&&(this._orientedDe=this._minDe.getSym())},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn};var tr=function(t){function e(i,n){t.call(this,e.msgWithCoord(i,n)),this.pt=n?new Le(n):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(oi),er=function(){this.array_=[]};er.prototype.addLast=function(t){this.array_.push(t)},er.prototype.removeFirst=function(){return this.array_.shift()},er.prototype.isEmpty=function(){return 0===this.array_.length};var ir=function(){this._finder=null,this._dirEdgeList=new Ni,this._nodes=new Ni,this._rightMostCoord=null,this._env=null,this._finder=new Kn};ir.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}},ir.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},ir.prototype.computeNodeDepth=function(t){for(var e=null,i=t.getEdges().iterator();i.hasNext();){var n=i.next();if(n.isVisited()||n.getSym().isVisited()){e=n;break}}if(null===e)throw new tr("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},ir.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths($n.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},ir.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},ir.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth($n.RIGHT)>=1&&e.getDepth($n.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},ir.prototype.computeDepths=function(t){var e=new Vi,i=new er,n=t.getNode();for(i.addLast(n),e.add(n),t.setVisited(!0);!i.isEmpty();){var r=i.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(i.addLast(a),e.add(a))}}}},ir.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},ir.prototype.getEnvelope=function(){if(null===this._env){for(var t=new Ze,e=this._dirEdgeList.iterator();e.hasNext();)for(var i=e.next().getEdge().getCoordinates(),n=0;n<i.length-1;n++)t.expandToInclude(i[n]);this._env=t}return this._env},ir.prototype.addReachable=function(t){var e=new Zn;for(e.add(t);!e.empty();){var i=e.pop();this.add(i,e)}},ir.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth($n.LEFT,t.getDepth($n.RIGHT)),e.setDepth($n.RIGHT,t.getDepth($n.LEFT))},ir.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var i=t.getEdges().iterator();i.hasNext();){var n=i.next();this._dirEdgeList.add(n);var r=n.getSym().getNode();r.isVisited()||e.push(r)}},ir.prototype.getNodes=function(){return this._nodes},ir.prototype.getDirectedEdges=function(){return this._dirEdgeList},ir.prototype.interfaces_=function(){return[Te]},ir.prototype.getClass=function(){return ir};var nr=function t(){var e=this;if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var i=arguments[0];this.init(i.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[$n.ON]=n}else if(arguments[0]instanceof t){var r=arguments[0];if(this.init(r.location.length),null!==r)for(var o=0;o<this.location.length;o++)e.location[o]=r.location[o]}}else if(3===arguments.length){var s=arguments[0],a=arguments[1],l=arguments[2];this.init(3),this.location[$n.ON]=s,this.location[$n.LEFT]=a,this.location[$n.RIGHT]=l}};nr.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},nr.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==Re.NONE)return!1;return!0},nr.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===Re.NONE&&(this.location[e]=t)},nr.prototype.isLine=function(){return 1===this.location.length},nr.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[$n.ON]=this.location[$n.ON],e[$n.LEFT]=Re.NONE,e[$n.RIGHT]=Re.NONE,this.location=e}for(var i=0;i<this.location.length;i++)this.location[i]===Re.NONE&&i<t.location.length&&(this.location[i]=t.location[i])},nr.prototype.getLocations=function(){return this.location},nr.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[$n.LEFT];this.location[$n.LEFT]=this.location[$n.RIGHT],this.location[$n.RIGHT]=t},nr.prototype.toString=function(){var t=new Ge;return this.location.length>1&&t.append(Re.toLocationSymbol(this.location[$n.LEFT])),t.append(Re.toLocationSymbol(this.location[$n.ON])),this.location.length>1&&t.append(Re.toLocationSymbol(this.location[$n.RIGHT])),t.toString()},nr.prototype.setLocations=function(t,e,i){this.location[$n.ON]=t,this.location[$n.LEFT]=e,this.location[$n.RIGHT]=i},nr.prototype.get=function(t){return t<this.location.length?this.location[t]:Re.NONE},nr.prototype.isArea=function(){return this.location.length>1},nr.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===Re.NONE)return!0;return!1},nr.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation($n.ON,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.location[e]=i}},nr.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(Re.NONE)},nr.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},nr.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},nr.prototype.interfaces_=function(){return[]},nr.prototype.getClass=function(){return nr};var rr=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new nr(e),this.elt[1]=new nr(e)}else if(arguments[0]instanceof t){var i=arguments[0];this.elt[0]=new nr(i.elt[0]),this.elt[1]=new nr(i.elt[1])}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.elt[0]=new nr(Re.NONE),this.elt[1]=new nr(Re.NONE),this.elt[n].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new nr(o,s,a),this.elt[1]=new nr(o,s,a)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new nr(Re.NONE,Re.NONE,Re.NONE),this.elt[1]=new nr(Re.NONE,Re.NONE,Re.NONE),this.elt[l].setLocations(u,c,h)}};rr.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},rr.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},rr.prototype.isNull=function(t){return this.elt[t].isNull()},rr.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.elt[e].setAllLocationsIfNull(i)}},rr.prototype.isLine=function(t){return this.elt[t].isLine()},rr.prototype.merge=function(t){for(var e=this,i=0;i<2;i++)null===e.elt[i]&&null!==t.elt[i]?e.elt[i]=new nr(t.elt[i]):e.elt[i].merge(t.elt[i])},rr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},rr.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get($n.ON)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return this.elt[e].get(i)}},rr.prototype.toString=function(){var t=new Ge;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},rr.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},rr.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},rr.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation($n.ON,e)}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this.elt[i].setLocation(n,r)}},rr.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},rr.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},rr.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new nr(this.elt[t].location[0]))},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.toLineLabel=function(t){for(var e=new rr(Re.NONE),i=0;i<2;i++)e.setLocation(i,t.getLocation(i));return e};var or=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Ni,this._pts=new Ni,this._label=new rr(Re.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Ni,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};or.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=di.isCCW(this._ring.getCoordinates())},or.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},or.prototype.computePoints=function(t){var e=this;this._startDe=t;var i=t,n=!0;do{if(null===i)throw new tr("Found null DirectedEdge");if(i.getEdgeRing()===e)throw new tr("Directed Edge visited twice during ring-building at "+i.getCoordinate());e._edges.add(i);var r=i.getLabel();ai.isTrue(r.isArea()),e.mergeLabel(r),e.addPoints(i.getEdge(),i.isForward(),n),n=!1,e.setEdgeRing(i,e),i=e.getNext(i)}while(i!==this._startDe)},or.prototype.getLinearRing=function(){return this._ring},or.prototype.getCoordinate=function(t){return this._pts.get(t)},or.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var e=this._startDe;do{var i=e.getNode().getEdges().getOutgoingDegree(t);i>t._maxNodeDegree&&(t._maxNodeDegree=i),e=t.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2},or.prototype.addPoints=function(t,e,i){var n=t.getCoordinates();if(e){var r=1;i&&(r=0);for(var o=r;o<n.length;o++)this._pts.add(n[o])}else{var s=n.length-2;i&&(s=n.length-1);for(var a=s;a>=0;a--)this._pts.add(n[a])}},or.prototype.isHole=function(){return this._isHole},or.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},or.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!di.isPointInRing(t,e.getCoordinates()))return!1;for(var i=this._holes.iterator();i.hasNext();){if(i.next().containsPoint(t))return!1}return!0},or.prototype.addHole=function(t){this._holes.add(t)},or.prototype.isShell=function(){return null===this._shell},or.prototype.getLabel=function(){return this._label},or.prototype.getEdges=function(){return this._edges},or.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},or.prototype.getShell=function(){return this._shell},or.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],i=arguments[1],n=e.getLocation(i,$n.RIGHT);if(n===Re.NONE)return null;if(this._label.getLocation(i)===Re.NONE)return this._label.setLocation(i,n),null}},or.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},or.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),i=0;i<this._holes.size();i++)e[i]=this._holes.get(i).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or};var sr=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(or),ar=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new Ni,e=this._startDe;do{if(null===e.getMinEdgeRing()){var i=new sr(e,this._geometryFactory);t.add(i)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(or),lr=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};lr.prototype.setVisited=function(t){this._isVisited=t},lr.prototype.setInResult=function(t){this._isInResult=t},lr.prototype.isCovered=function(){return this._isCovered},lr.prototype.isCoveredSet=function(){return this._isCoveredSet},lr.prototype.setLabel=function(t){this._label=t},lr.prototype.getLabel=function(){return this._label},lr.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},lr.prototype.updateIM=function(t){ai.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},lr.prototype.isInResult=function(){return this._isInResult},lr.prototype.isVisited=function(){return this._isVisited},lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr};var ur=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],i=arguments[1];this._coord=e,this._edges=i,this._label=new rr(0,Re.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var i=Re.NONE;if(i=this._label.getLocation(e),!t.isNull(e)){var n=t.getLocation(e);i!==Re.BOUNDARY&&(i=n)}return i},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],i=arguments[1];null===this._label?this._label=new rr(e,i):this._label.setLocation(e,i)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){var t=this;if(arguments[0]instanceof e){var i=arguments[0];this.mergeLabel(i._label)}else if(arguments[0]instanceof rr)for(var n=arguments[0],r=0;r<2;r++){var o=t.computeMergedLocation(n,r),s=t._label.getLocation(r);s===Re.NONE&&t._label.setLocation(r,o)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=Re.NONE;null!==this._label&&(e=this._label.getLocation(t));var i=null;if(e===Re.BOUNDARY)i=Re.INTERIOR;else i=Re.BOUNDARY;this._label.setLocation(t,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(lr),cr=function(){this.nodeMap=new $i,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};cr.prototype.find=function(t){return this.nodeMap.get(t)},cr.prototype.addNode=function(){if(arguments[0]instanceof Le){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof ur){var i=arguments[0],n=this.nodeMap.get(i.getCoordinate());return null===n?(this.nodeMap.put(i.getCoordinate(),i),i):(n.mergeLabel(i),n)}},cr.prototype.print=function(t){for(var e=this.iterator();e.hasNext();){e.next().print(t)}},cr.prototype.iterator=function(){return this.nodeMap.values().iterator()},cr.prototype.values=function(){return this.nodeMap.values()},cr.prototype.getBoundaryNodes=function(t){for(var e=new Ni,i=this.iterator();i.hasNext();){var n=i.next();n.getLabel().getLocation(t)===Re.BOUNDARY&&e.add(n)}return e},cr.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr};var hr=function(){},pr={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr},hr.isNorthern=function(t){return t===hr.NE||t===hr.NW},hr.isOpposite=function(t,e){return t!==e&&2===(t-e+4)%4},hr.commonHalfPlane=function(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;var i=t<e?t:e;return 0===i&&3===(t>e?t:e)?3:i},hr.isInHalfPlane=function(t,e){return e===hr.SE?t===hr.SE||t===hr.SW:t===e||t===e+1},hr.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new be("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?hr.NE:hr.SE:e>=0?hr.NW:hr.SW}if(arguments[0]instanceof Le&&arguments[1]instanceof Le){var i=arguments[0],n=arguments[1];if(n.x===i.x&&n.y===i.y)throw new be("Cannot compute the quadrant for two identical points "+i);return n.x>=i.x?n.y>=i.y?hr.NE:hr.SE:n.y>=i.y?hr.NW:hr.SW}},pr.NE.get=function(){return 0},pr.NW.get=function(){return 1},pr.SW.get=function(){return 2},pr.SE.get=function(){return 3},Object.defineProperties(hr,pr);var dr=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=null;this._edge=e,this.init(i,n),this._label=r}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this._edge=o,this.init(s,a),this._label=l}};dr.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:di.computeOrientation(t._p0,t._p1,this._p1)},dr.prototype.getDy=function(){return this._dy},dr.prototype.getCoordinate=function(){return this._p0},dr.prototype.setNode=function(t){this._node=t},dr.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),n=i.lastIndexOf("."),r=i.substring(n+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},dr.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},dr.prototype.getDirectedCoordinate=function(){return this._p1},dr.prototype.getDx=function(){return this._dx},dr.prototype.getLabel=function(){return this._label},dr.prototype.getEdge=function(){return this._edge},dr.prototype.getQuadrant=function(){return this._quadrant},dr.prototype.getNode=function(){return this._node},dr.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),i=e.lastIndexOf(".");return"  "+e.substring(i+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},dr.prototype.computeLabel=function(t){},dr.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=hr.quadrant(this._dx,this._dy),ai.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},dr.prototype.interfaces_=function(){return[Te]},dr.prototype.getClass=function(){return dr};var fr=function(t){function e(){var e=arguments[0],i=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=i,i)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var n=e.getNumPoints()-1;this.init(e.getCoordinate(n),e.getCoordinate(n-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new rr(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new tr("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=this,e=!0,i=0;i<2;i++)t._label.isArea(i)&&t._label.getLocation(i,$n.LEFT)===Re.INTERIOR&&t._label.getLocation(i,$n.RIGHT)===Re.INTERIOR||(e=!1);return e},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[$n.LEFT]+"/"+this._depth[$n.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,Re.EXTERIOR),i=!this._label.isArea(1)||this._label.allPositionsEqual(1,Re.EXTERIOR);return t&&e&&i},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var i=this.getEdge().getDepthDelta();this._isForward||(i=-i);var n=1;t===$n.LEFT&&(n=-1);var r=$n.opposite(t),o=e+i*n;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===Re.EXTERIOR&&e===Re.INTERIOR?1:t===Re.INTERIOR&&e===Re.EXTERIOR?-1:0},e}(dr),gr=function(){};gr.prototype.createNode=function(t){return new ur(t,null)},gr.prototype.interfaces_=function(){return[]},gr.prototype.getClass=function(){return gr};var mr=function(){if(this._edges=new Ni,this._nodes=null,this._edgeEndList=new Ni,0===arguments.length)this._nodes=new cr(new gr);else if(1===arguments.length){var t=arguments[0];this._nodes=new cr(t)}};mr.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var i=this._edges.get(e);i.print(t),i.eiList.print(t)}},mr.prototype.find=function(t){return this._nodes.find(t)},mr.prototype.addNode=function(){if(arguments[0]instanceof ur){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof Le){var e=arguments[0];return this._nodes.addNode(e)}},mr.prototype.getNodeIterator=function(){return this._nodes.iterator()},mr.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}},mr.prototype.debugPrintln=function(t){Je.out.println(t)},mr.prototype.isBoundaryNode=function(t,e){var i=this._nodes.find(e);if(null===i)return!1;var n=i.getLabel();return null!==n&&n.getLocation(t)===Re.BOUNDARY},mr.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}},mr.prototype.matchInSameDirection=function(t,e,i,n){return!!t.equals(i)&&(di.computeOrientation(t,e,n)===di.COLLINEAR&&hr.quadrant(t,e)===hr.quadrant(i,n))},mr.prototype.getEdgeEnds=function(){return this._edgeEndList},mr.prototype.debugPrint=function(t){Je.out.print(t)},mr.prototype.getEdgeIterator=function(){return this._edges.iterator()},mr.prototype.findEdgeInSameDirection=function(t,e){for(var i=this,n=0;n<this._edges.size();n++){var r=i._edges.get(n),o=r.getCoordinates();if(i.matchInSameDirection(t,e,o[0],o[1]))return r;if(i.matchInSameDirection(t,e,o[o.length-1],o[o.length-2]))return r}return null},mr.prototype.insertEdge=function(t){this._edges.add(t)},mr.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var i=e.next();if(i.getEdge()===t)return i}return null},mr.prototype.addEdges=function(t){for(var e=this,i=t.iterator();i.hasNext();){var n=i.next();e._edges.add(n);var r=new fr(n,!0),o=new fr(n,!1);r.setSym(o),o.setSym(r),e.add(r),e.add(o)}},mr.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},mr.prototype.getNodes=function(){return this._nodes.values()},mr.prototype.findEdge=function(t,e){for(var i=0;i<this._edges.size();i++){var n=this._edges.get(i),r=n.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return n}return null},mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr},mr.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}};var _r=function(){this._geometryFactory=null,this._shellList=new Ni;var t=arguments[0];this._geometryFactory=t};_r.prototype.sortShellsAndHoles=function(t,e,i){for(var n=t.iterator();n.hasNext();){var r=n.next();r.isHole()?i.add(r):e.add(r)}},_r.prototype.computePolygons=function(t){for(var e=new Ni,i=t.iterator();i.hasNext();){var n=i.next().toPolygon(this._geometryFactory);e.add(n)}return e},_r.prototype.placeFreeHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();if(null===n.getShell()){var r=this.findEdgeRingContaining(n,t);if(null===r)throw new tr("unable to assign hole to a shell",n.getCoordinate(0));n.setShell(r)}}},_r.prototype.buildMinimalEdgeRings=function(t,e,i){for(var n=new Ni,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):i.addAll(s)}else n.add(o)}return n},_r.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();){if(e.next().containsPoint(t))return!0}return!1},_r.prototype.buildMaximalEdgeRings=function(t){for(var e=new Ni,i=t.iterator();i.hasNext();){var n=i.next();if(n.isInResult()&&n.getLabel().isArea()&&null===n.getEdgeRing()){var r=new ar(n,this._geometryFactory);e.add(r),r.setInResult()}}return e},_r.prototype.placePolygonHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();n.isHole()&&n.setShell(t)}},_r.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},_r.prototype.findEdgeRingContaining=function(t,e){for(var i=t.getLinearRing(),n=i.getEnvelopeInternal(),r=i.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(n)&&di.isPointInRing(r,u.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(o=l)}return o},_r.prototype.findShell=function(t){for(var e=0,i=null,n=t.iterator();n.hasNext();){var r=n.next();r.isHole()||(i=r,e++)}return ai.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),i},_r.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],i=arguments[1];mr.linkResultDirectedEdges(i);var n=this.buildMaximalEdgeRings(e),r=new Ni,o=this.buildMinimalEdgeRings(n,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r};var yr=function(){};yr.prototype.getBounds=function(){},yr.prototype.interfaces_=function(){return[]},yr.prototype.getClass=function(){return yr};var vr=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};vr.prototype.getItem=function(){return this._item},vr.prototype.getBounds=function(){return this._bounds},vr.prototype.interfaces_=function(){return[yr,Ie]},vr.prototype.getClass=function(){return vr};var Cr=function(){this._size=null,this._items=null,this._size=0,this._items=new Ni,this._items.add(null)};Cr.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Cr.prototype.size=function(){return this._size},Cr.prototype.reorder=function(t){for(var e=this,i=null,n=this._items.get(t);2*t<=this._size&&((i=2*t)!==e._size&&e._items.get(i+1).compareTo(e._items.get(i))<0&&i++,e._items.get(i).compareTo(n)<0);t=i)e._items.set(t,e._items.get(i));this._items.set(t,n)},Cr.prototype.clear=function(){this._size=0,this._items.clear()},Cr.prototype.isEmpty=function(){return 0===this._size},Cr.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr};var xr=function(){};xr.prototype.visitItem=function(t){},xr.prototype.interfaces_=function(){return[]},xr.prototype.getClass=function(){return xr};var wr=function(){};wr.prototype.insert=function(t,e){},wr.prototype.remove=function(t,e){},wr.prototype.query=function(){},wr.prototype.interfaces_=function(){return[]},wr.prototype.getClass=function(){return wr};var br=function(){if(this._childBoundables=new Ni,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Er={serialVersionUID:{configurable:!0}};br.prototype.getLevel=function(){return this._level},br.prototype.size=function(){return this._childBoundables.size()},br.prototype.getChildBoundables=function(){return this._childBoundables},br.prototype.addChildBoundable=function(t){ai.isTrue(null===this._bounds),this._childBoundables.add(t)},br.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},br.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},br.prototype.interfaces_=function(){return[yr,Ie]},br.prototype.getClass=function(){return br},Er.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(br,Er);var Sr=function(){};Sr.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Sr.min=function(t){return Sr.sort(t),t.get(0)},Sr.sort=function(t,e){var i=t.toArray();e?tn.sort(i,e):tn.sort(i);for(var n=t.iterator(),r=0,o=i.length;r<o;r++)n.next(),n.set(i[r])},Sr.singletonList=function(t){var e=new Ni;return e.add(t),e};var Tr=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],i=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=i,this._distance=this.distance()};Tr.prototype.expandToQueue=function(t,e){var i=Tr.isComposite(this._boundable1),n=Tr.isComposite(this._boundable2);if(i&&n)return Tr.area(this._boundable1)>Tr.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(i)return this.expand(this._boundable1,this._boundable2,t,e),null;if(n)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new be("neither boundable is composite")},Tr.prototype.isLeaves=function(){return!(Tr.isComposite(this._boundable1)||Tr.isComposite(this._boundable2))},Tr.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},Tr.prototype.expand=function(t,e,i,n){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new Tr(o,e,this._itemDistance);s.getDistance()<n&&i.add(s)}},Tr.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},Tr.prototype.getDistance=function(){return this._distance},Tr.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Tr.prototype.interfaces_=function(){return[Te]},Tr.prototype.getClass=function(){return Tr},Tr.area=function(t){return t.getBounds().getArea()},Tr.isComposite=function(t){return t instanceof br};var Pr=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new Ni,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var i=arguments[0];ai.isTrue(i>1,"Node capacity must be greater than 1"),this._nodeCapacity=i}},Ar={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Pr.prototype.getNodeCapacity=function(){return this._nodeCapacity},Pr.prototype.lastNode=function(t){return t.get(t.size()-1)},Pr.prototype.size=function(){var t=this;if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var e=arguments[0],i=0,n=e.getChildBoundables().iterator();n.hasNext();){var r=n.next();r instanceof br?i+=t.size(r):r instanceof vr&&(i+=1)}return i}},Pr.prototype.removeItem=function(t,e){for(var i=null,n=t.getChildBoundables().iterator();n.hasNext();){var r=n.next();r instanceof vr&&r.getItem()===e&&(i=r)}return null!==i&&(t.getChildBoundables().remove(i),!0)},Pr.prototype.itemsTree=function(){var t=this;if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new Ni:e}if(1===arguments.length){for(var i=arguments[0],n=new Ni,r=i.getChildBoundables().iterator();r.hasNext();){var o=r.next();if(o instanceof br){var s=t.itemsTree(o);null!==s&&n.add(s)}else o instanceof vr?n.add(o.getItem()):ai.shouldNeverReachHere()}return n.size()<=0?null:n}},Pr.prototype.insert=function(t,e){ai.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new vr(t,e))},Pr.prototype.boundablesAtLevel=function(){var t=this;if(1===arguments.length){var e=arguments[0],i=new Ni;return this.boundablesAtLevel(e,this._root,i),i}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];if(ai.isTrue(n>-2),r.getLevel()===n)return o.add(r),null;for(var s=r.getChildBoundables().iterator();s.hasNext();){var a=s.next();a instanceof br?t.boundablesAtLevel(n,a,o):(ai.isTrue(a instanceof vr),-1===n&&o.add(a))}return null}},Pr.prototype.query=function(){var t=this;if(1===arguments.length){var e=arguments[0];this.build();var i=new Ni;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,i),i}if(2===arguments.length){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r)}else if(3===arguments.length)if(Fe(arguments[2],xr)&&arguments[0]instanceof Object&&arguments[1]instanceof br)for(var o=arguments[0],s=arguments[1],a=arguments[2],l=s.getChildBoundables(),u=0;u<l.size();u++){var c=l.get(u);t.getIntersectsOp().intersects(c.getBounds(),o)&&(c instanceof br?t.query(o,c,a):c instanceof vr?a.visitItem(c.getItem()):ai.shouldNeverReachHere())}else if(Fe(arguments[2],Ii)&&arguments[0]instanceof Object&&arguments[1]instanceof br)for(var h=arguments[0],p=arguments[1],d=arguments[2],f=p.getChildBoundables(),g=0;g<f.size();g++){var m=f.get(g);t.getIntersectsOp().intersects(m.getBounds(),h)&&(m instanceof br?t.query(h,m,d):m instanceof vr?d.add(m.getItem()):ai.shouldNeverReachHere())}},Pr.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Pr.prototype.getRoot=function(){return this.build(),this._root},Pr.prototype.remove=function(){var t=this;if(2===arguments.length){var e=arguments[0],i=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,i)}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=this.removeItem(r,o);if(s)return!0;for(var a=null,l=r.getChildBoundables().iterator();l.hasNext();){var u=l.next();if(t.getIntersectsOp().intersects(u.getBounds(),n)&&(u instanceof br&&(s=t.remove(n,u,o)))){a=u;break}}return null!==a&&a.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(a),s}},Pr.prototype.createHigherLevels=function(t,e){ai.isTrue(!t.isEmpty());var i=this.createParentBoundables(t,e+1);return 1===i.size()?i.get(0):this.createHigherLevels(i,e+1)},Pr.prototype.depth=function(){var t=this;if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=arguments[0],i=0,n=e.getChildBoundables().iterator();n.hasNext();){var r=n.next();if(r instanceof br){var o=t.depth(r);o>i&&(i=o)}}return i+1}},Pr.prototype.createParentBoundables=function(t,e){var i=this;ai.isTrue(!t.isEmpty());var n=new Ni;n.add(this.createNode(e));var r=new Ni(t);Sr.sort(r,this.getComparator());for(var o=r.iterator();o.hasNext();){var s=o.next();i.lastNode(n).getChildBoundables().size()===i.getNodeCapacity()&&n.add(i.createNode(e)),i.lastNode(n).addChildBoundable(s)}return n},Pr.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},Pr.prototype.interfaces_=function(){return[Ie]},Pr.prototype.getClass=function(){return Pr},Pr.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},Ar.IntersectsOp.get=function(){return Ir},Ar.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},Ar.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Pr,Ar);var Ir=function(){},Lr=function(){};Lr.prototype.distance=function(t,e){},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr};var Nr=function(t){function e(i){i=i||e.DEFAULT_NODE_CAPACITY,t.call(this,i)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(t,e){ai.isTrue(t.length>0);for(var i=new Ni,n=0;n<t.length;n++)i.addAll(this.createParentBoundablesFromVerticalSlice(t[n],e));return i},e.prototype.createNode=function(t){return new Mr(t)},e.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],i=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,i)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(t,e){for(var i=Math.trunc(Math.ceil(t.size()/e)),n=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){n[o]=new Ni;for(var s=0;r.hasNext()&&s<i;){var a=r.next();n[o].add(a),s++}}return n},e.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var i=arguments[0],n=arguments[1];t.prototype.query.call(this,i,n)}else if(3===arguments.length)if(Fe(arguments[2],xr)&&arguments[0]instanceof Object&&arguments[1]instanceof br){var r=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,r,o,s)}else if(Fe(arguments[2],Ii)&&arguments[0]instanceof Object&&arguments[1]instanceof br){var a=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,a,l,u)}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(e,i){return t.prototype.createParentBoundables.call(this,e,i)},e.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return t.prototype.remove.call(this,e,i)}return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(t,i){ai.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new Ni(t);Sr.sort(r,e.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(o,i)},e.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Fe(arguments[0],Lr)){var t=arguments[0],i=new Tr(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(i)}if(arguments[0]instanceof Tr){var n=arguments[0];return this.nearestNeighbour(n,Ee.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof e&&Fe(arguments[1],Lr)){var r=arguments[0],o=arguments[1],s=new Tr(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof Tr&&"number"==typeof arguments[1]){var a=arguments[0],l=arguments[1],u=l,c=null,h=new Cr;for(h.add(a);!h.isEmpty()&&u>0;){var p=h.poll(),d=p.getDistance();if(d>=u)break;p.isLeaves()?(u=d,c=p):p.expandToQueue(h,u)}return[c.getBoundable(0).getItem(),c.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[0],g=arguments[1],m=arguments[2],_=new vr(f,g),y=new Tr(this.getRoot(),_,m);return this.nearestNeighbour(y)[0]}},e.prototype.interfaces_=function(){return[wr,Ie]},e.prototype.getClass=function(){return e},e.centreX=function(t){return e.avg(t.getMinX(),t.getMaxX())},e.avg=function(t,e){return(t+e)/2},e.centreY=function(t){return e.avg(t.getMinY(),t.getMaxY())},i.STRtreeNode.get=function(){return Mr},i.serialVersionUID.get=function(){return 0x39920f7d5f261e0},i.xComparator.get=function(){return{interfaces_:function(){return[Ae]},compare:function(i,n){return t.compareDoubles(e.centreX(i.getBounds()),e.centreX(n.getBounds()))}}},i.yComparator.get=function(){return{interfaces_:function(){return[Ae]},compare:function(i,n){return t.compareDoubles(e.centreY(i.getBounds()),e.centreY(n.getBounds()))}}},i.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},i.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,i),e}(Pr),Mr=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var i=e.next();null===t?t=new Ze(i.getBounds()):t.expandToInclude(i.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(br),Dr=function(){};Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr},Dr.relativeSign=function(t,e){return t<e?-1:t>e?1:0},Dr.compare=function(t,e,i){if(e.equals2D(i))return 0;var n=Dr.relativeSign(e.x,i.x),r=Dr.relativeSign(e.y,i.y);switch(t){case 0:return Dr.compareValue(n,r);case 1:return Dr.compareValue(r,n);case 2:return Dr.compareValue(r,-n);case 3:return Dr.compareValue(-n,r);case 4:return Dr.compareValue(-n,-r);case 5:return Dr.compareValue(-r,-n);case 6:return Dr.compareValue(-r,n);case 7:return Dr.compareValue(n,-r)}return ai.shouldNeverReachHere("invalid octant value"),0},Dr.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var Rr=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._segString=t,this.coord=new Le(e),this.segmentIndex=i,this._segmentOctant=n,this._isInterior=!e.equals2D(t.getCoordinate(i))};Rr.prototype.getCoordinate=function(){return this.coord},Rr.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},Rr.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Dr.compare(this._segmentOctant,this.coord,e.coord)},Rr.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},Rr.prototype.isInterior=function(){return this._isInterior},Rr.prototype.interfaces_=function(){return[Te]},Rr.prototype.getClass=function(){return Rr};var Or=function(){this._nodeMap=new $i,this._edge=null;var t=arguments[0];this._edge=t};Or.prototype.getSplitCoordinates=function(){var t=new Di;this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next();this.addEdgeCoordinates(i,n,t),i=n}return t.toCoordinateArray()},Or.prototype.addCollapsedNodes=function(){var t=new Ni;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var i=e.next().intValue();this.add(this._edge.getCoordinate(i),i)}},Or.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},Or.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var i=this._edge.getCoordinate(e),n=this._edge.getCoordinate(e+2);i.equals2D(n)&&t.add(new Be(e+1))}},Or.prototype.addEdgeCoordinates=function(t,e,i){var n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);i.add(new Le(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)i.add(this._edge.getCoordinate(o));r&&i.add(new Le(e.coord))},Or.prototype.iterator=function(){return this._nodeMap.values().iterator()},Or.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}},Or.prototype.findCollapseIndex=function(t,e,i){if(!t.coord.equals2D(e.coord))return!1;var n=e.segmentIndex-t.segmentIndex;return e.isInterior()||n--,1===n&&(i[0]=t.segmentIndex+1,!0)},Or.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),i=this.iterator(),n=i.next();i.hasNext();){var r=i.next();this.findCollapseIndex(n,r,e)&&t.add(new Be(e[0])),n=r}},Or.prototype.getEdge=function(){return this._edge},Or.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},Or.prototype.createSplitEdge=function(t,e){var i=e.segmentIndex-t.segmentIndex+2,n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);r||i--;var o=new Array(i).fill(null),s=0;o[s++]=new Le(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new Le(e.coord)),new Gr(o,this._edge.getData())},Or.prototype.add=function(t,e){var i=new Rr(this._edge,t,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(i);return null!==n?(ai.isTrue(n.coord.equals2D(t),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(i,i),i)},Or.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),i=t.get(0).getCoordinate(0);if(!i.equals2D(e[0]))throw new oi("bad split edge start point at "+i);var n=t.get(t.size()-1).getCoordinates(),r=n[n.length-1];if(!r.equals2D(e[e.length-1]))throw new oi("bad split edge end point at "+r)},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or};var Fr=function(){};Fr.prototype.interfaces_=function(){return[]},Fr.prototype.getClass=function(){return Fr},Fr.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new be("Cannot compute the octant for point ( "+t+", "+e+" )");var i=Math.abs(t),n=Math.abs(e);return t>=0?e>=0?i>=n?0:1:i>=n?7:6:e>=0?i>=n?3:2:i>=n?4:5}if(arguments[0]instanceof Le&&arguments[1]instanceof Le){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new be("Cannot compute the octant for two identical points "+r);return Fr.octant(s,a)}};var kr=function(){};kr.prototype.getCoordinates=function(){},kr.prototype.size=function(){},kr.prototype.getCoordinate=function(t){},kr.prototype.isClosed=function(){},kr.prototype.setData=function(t){},kr.prototype.getData=function(){},kr.prototype.interfaces_=function(){return[]},kr.prototype.getClass=function(){return kr};var zr=function(){};zr.prototype.addIntersection=function(t,e){},zr.prototype.interfaces_=function(){return[kr]},zr.prototype.getClass=function(){return zr};var Gr=function(){this._nodeList=new Or(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Gr.prototype.getCoordinates=function(){return this._pts},Gr.prototype.size=function(){return this._pts.length},Gr.prototype.getCoordinate=function(t){return this._pts[t]},Gr.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Gr.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},Gr.prototype.setData=function(t){this._data=t},Gr.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:Fr.octant(t,e)},Gr.prototype.getData=function(){return this._data},Gr.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[3],o=new Le(i.getIntersection(r));this.addIntersection(o,n)}},Gr.prototype.toString=function(){return ri.toLineString(new Mn(this._pts))},Gr.prototype.getNodeList=function(){return this._nodeList},Gr.prototype.addIntersectionNode=function(t,e){var i=e,n=i+1;if(n<this._pts.length){var r=this._pts[n];t.equals2D(r)&&(i=n)}return this._nodeList.add(t,i)},Gr.prototype.addIntersections=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)},Gr.prototype.interfaces_=function(){return[zr]},Gr.prototype.getClass=function(){return Gr},Gr.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new Ni;return Gr.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var i=arguments[0],n=arguments[1],r=i.iterator();r.hasNext();){var o=r.next();o.getNodeList().addSplitEdges(n)}};var Br=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new Le,this.p1=new Le;else if(1===arguments.length){var t=arguments[0];this.p0=new Le(t.p0),this.p1=new Le(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=arguments[3];this.p0=new Le(e,i),this.p1=new Le(n,r)}},Ur={serialVersionUID:{configurable:!0}};Br.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Br.prototype.orientationIndex=function(){if(arguments[0]instanceof Br){var t=arguments[0],e=di.orientationIndex(this.p0,this.p1,t.p0),i=di.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&i>=0||e<=0&&i<=0?Math.max(e,i):0}if(arguments[0]instanceof Le){var n=arguments[0];return di.orientationIndex(this.p0,this.p1,n)}},Br.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},Br.prototype.isVertical=function(){return this.p0.x===this.p1.x},Br.prototype.equals=function(t){if(!(t instanceof Br))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},Br.prototype.intersection=function(t){var e=new ci;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},Br.prototype.project=function(){if(arguments[0]instanceof Le){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new Le(t);var e=this.projectionFactor(t),i=new Le;return i.x=this.p0.x+e*(this.p1.x-this.p0.x),i.y=this.p0.y+e*(this.p1.y-this.p0.y),i}if(arguments[0]instanceof Br){var n=arguments[0],r=this.projectionFactor(n.p0),o=this.projectionFactor(n.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var s=this.project(n.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(n.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new Br(s,a)}},Br.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Br.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Br.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},Br.prototype.distancePerpendicular=function(t){return di.distancePointLinePerpendicular(t,this.p0,this.p1)},Br.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Br.prototype.midPoint=function(){return Br.midPoint(this.p0,this.p1)},Br.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,n=e*e+i*i;return n<=0?Ee.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*i)/n},Br.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var i=new Array(2).fill(null),n=Ee.MAX_VALUE,r=null,o=this.closestPoint(t.p0);n=o.distance(t.p0),i[0]=o,i[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<n&&(n=r,i[0]=s,i[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<n&&(n=r,i[0]=this.p0,i[1]=a);var l=t.closestPoint(this.p1);return(r=l.distance(this.p1))<n&&(n=r,i[0]=this.p1,i[1]=l),i},Br.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},Br.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Br.prototype.getLength=function(){return this.p0.distance(this.p1)},Br.prototype.compareTo=function(t){var e=t,i=this.p0.compareTo(e.p0);return 0!==i?i:this.p1.compareTo(e.p1)},Br.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},Br.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},Br.prototype.lineIntersection=function(t){try{return Qe.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof $e))throw t}return null},Br.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Br.prototype.pointAlongOffset=function(t,e){var i=this.p0.x+t*(this.p1.x-this.p0.x),n=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,l=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,l=e*o/s}return new Le(i-l,n+a)},Br.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=i.x,this.p1.y=i.y}},Br.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||Ee.isNaN(e))&&(e=1),e},Br.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Br.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Br.prototype.distance=function(){if(arguments[0]instanceof Br){var t=arguments[0];return di.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof Le){var e=arguments[0];return di.distancePointLine(e,this.p0,this.p1)}},Br.prototype.pointAlong=function(t){var e=new Le;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},Br.prototype.hashCode=function(){var t=Ee.doubleToLongBits(this.p0.x);t^=31*Ee.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),i=Ee.doubleToLongBits(this.p1.x);return i^=31*Ee.doubleToLongBits(this.p1.y),e^(Math.trunc(i)^Math.trunc(i>>32))},Br.prototype.interfaces_=function(){return[Te,Ie]},Br.prototype.getClass=function(){return Br},Br.midPoint=function(t,e){return new Le((t.x+e.x)/2,(t.y+e.y)/2)},Ur.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Br,Ur);var Vr=function(){this.tempEnv1=new Ze,this.tempEnv2=new Ze,this._overlapSeg1=new Br,this._overlapSeg2=new Br};Vr.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];t.getLineSegment(e,this._overlapSeg1),i.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Vr.prototype.interfaces_=function(){return[]},Vr.prototype.getClass=function(){return Vr};var Hr=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._pts=t,this._start=e,this._end=i,this._context=n};Hr.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},Hr.prototype.computeSelect=function(t,e,i,n){var r=this._pts[e],o=this._pts[i];if(n.tempEnv1.init(r,o),i-e==1)return n.select(this,e),null;if(!t.intersects(n.tempEnv1))return null;var s=Math.trunc((e+i)/2);e<s&&this.computeSelect(t,e,s,n),s<i&&this.computeSelect(t,s,i,n)},Hr.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,i=this._start;i<=this._end;i++)t[e++]=this._pts[i];return t},Hr.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},Hr.prototype.setId=function(t){this._id=t},Hr.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},Hr.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Ze(t,e)}return this._env},Hr.prototype.getEndIndex=function(){return this._end},Hr.prototype.getStartIndex=function(){return this._start},Hr.prototype.getContext=function(){return this._context},Hr.prototype.getId=function(){return this._id},Hr.prototype.computeOverlapsInternal=function(t,e,i,n,r,o){var s=this._pts[t],a=this._pts[e],l=i._pts[n],u=i._pts[r];if(e-t==1&&r-n==1)return o.overlap(this,t,i,n),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(l,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((n+r)/2);t<c&&(n<h&&this.computeOverlapsInternal(t,c,i,n,h,o),h<r&&this.computeOverlapsInternal(t,c,i,h,r,o)),c<e&&(n<h&&this.computeOverlapsInternal(c,e,i,n,h,o),h<r&&this.computeOverlapsInternal(c,e,i,h,r,o))},Hr.prototype.interfaces_=function(){return[]},Hr.prototype.getClass=function(){return Hr};var Wr=function(){};Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr},Wr.getChainStartIndices=function(t){var e=0,i=new Ni;i.add(new Be(e));do{var n=Wr.findChainEnd(t,e);i.add(new Be(n)),e=n}while(e<t.length-1);return Wr.toIntArray(i)},Wr.findChainEnd=function(t,e){for(var i=e;i<t.length-1&&t[i].equals2D(t[i+1]);)i++;if(i>=t.length-1)return t.length-1;for(var n=hr.quadrant(t[i],t[i+1]),r=e+1;r<t.length;){if(!t[r-1].equals2D(t[r]))if(hr.quadrant(t[r-1],t[r])!==n)break;r++}return r-1},Wr.getChains=function(){if(1===arguments.length){var t=arguments[0];return Wr.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],i=arguments[1],n=new Ni,r=Wr.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new Hr(e,r[o],r[o+1],i);n.add(s)}return n}},Wr.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var jr=function(){};jr.prototype.computeNodes=function(t){},jr.prototype.getNodedSubstrings=function(){},jr.prototype.interfaces_=function(){return[]},jr.prototype.getClass=function(){return jr};var qr=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};qr.prototype.setSegmentIntersector=function(t){this._segInt=t},qr.prototype.interfaces_=function(){return[jr]},qr.prototype.getClass=function(){return qr};var Yr=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new Ni,this._index=new Nr,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return Gr.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=this,i=Wr.getChains(t.getCoordinates(),t).iterator();i.hasNext();){var n=i.next();n.setId(e._idCounter++),e._index.insert(n.getEnvelope(),n),e._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=this,e=new Xr(this._segInt),i=this._monoChains.iterator();i.hasNext();)for(var n=i.next(),r=t._index.query(n.getEnvelope()).iterator();r.hasNext();){var o=r.next();if(o.getId()>n.getId()&&(n.computeOverlaps(o,e),t._nOverlaps++),t._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.SegmentOverlapAction.get=function(){return Xr},Object.defineProperties(e,i),e}(qr),Xr=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[0],i=arguments[1],n=arguments[2],r=arguments[3],o=e.getContext(),s=n.getContext();this._si.processIntersections(o,i,s,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Vr),$r=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.setQuadrantSegments(i),this.setEndCapStyle(n)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},Jr={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};$r.prototype.getEndCapStyle=function(){return this._endCapStyle},$r.prototype.isSingleSided=function(){return this._isSingleSided},$r.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=$r.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=$r.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==$r.JOIN_ROUND&&(this._quadrantSegments=$r.DEFAULT_QUADRANT_SEGMENTS)},$r.prototype.getJoinStyle=function(){return this._joinStyle},$r.prototype.setJoinStyle=function(t){this._joinStyle=t},$r.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},$r.prototype.getSimplifyFactor=function(){return this._simplifyFactor},$r.prototype.getQuadrantSegments=function(){return this._quadrantSegments},$r.prototype.setEndCapStyle=function(t){this._endCapStyle=t},$r.prototype.getMitreLimit=function(){return this._mitreLimit},$r.prototype.setMitreLimit=function(t){this._mitreLimit=t},$r.prototype.setSingleSided=function(t){this._isSingleSided=t},$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Jr.CAP_ROUND.get=function(){return 1},Jr.CAP_FLAT.get=function(){return 2},Jr.CAP_SQUARE.get=function(){return 3},Jr.JOIN_ROUND.get=function(){return 1},Jr.JOIN_MITRE.get=function(){return 2},Jr.JOIN_BEVEL.get=function(){return 3},Jr.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Jr.DEFAULT_MITRE_LIMIT.get=function(){return 5},Jr.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties($r,Jr);var Qr=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=di.COUNTERCLOCKWISE,this._inputLine=t||null},Zr={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Qr.prototype.isDeletable=function(t,e,i,n){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[i];return!!this.isConcave(r,o,s)&&(!!this.isShallow(r,o,s,n)&&this.isShallowSampled(r,o,t,i,n))},Qr.prototype.deleteShallowConcavities=function(){for(var t=this,e=1,i=this.findNextNonDeletedIndex(e),n=this.findNextNonDeletedIndex(i),r=!1;n<this._inputLine.length;){var o=!1;t.isDeletable(e,i,n,t._distanceTol)&&(t._isDeleted[i]=Qr.DELETE,o=!0,r=!0),e=o?n:i,i=t.findNextNonDeletedIndex(e),n=t.findNextNonDeletedIndex(i)}return r},Qr.prototype.isShallowConcavity=function(t,e,i,n){return di.computeOrientation(t,e,i)===this._angleOrientation&&di.distancePointLine(e,t,i)<n},Qr.prototype.isShallowSampled=function(t,e,i,n,r){var o=Math.trunc((n-i)/Qr.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=i;s<n;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Qr.prototype.isConcave=function(t,e,i){var n=di.computeOrientation(t,e,i)===this._angleOrientation;return n},Qr.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=di.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Qr.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Qr.DELETE;)e++;return e},Qr.prototype.isShallow=function(t,e,i,n){return di.distancePointLine(e,t,i)<n},Qr.prototype.collapseLine=function(){for(var t=new Di,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Qr.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Qr.prototype.interfaces_=function(){return[]},Qr.prototype.getClass=function(){return Qr},Qr.simplify=function(t,e){return new Qr(t).simplify(e)},Zr.INIT.get=function(){return 0},Zr.DELETE.get=function(){return 1},Zr.KEEP.get=function(){return 1},Zr.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Qr,Zr);var Kr=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Ni},to={COORDINATE_ARRAY_TYPE:{configurable:!0}};Kr.prototype.getCoordinates=function(){return this._ptList.toArray(Kr.COORDINATE_ARRAY_TYPE)},Kr.prototype.setPrecisionModel=function(t){this._precisionModel=t},Kr.prototype.addPt=function(t){var e=new Le(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Kr.prototype.revere=function(){},Kr.prototype.addPts=function(t,e){if(e)for(var i=0;i<t.length;i++)this.addPt(t[i]);else for(var n=t.length-1;n>=0;n--)this.addPt(t[n])},Kr.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Kr.prototype.toString=function(){return(new Un).createLineString(this.getCoordinates()).toString()},Kr.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new Le(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Kr.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Kr.prototype.interfaces_=function(){return[]},Kr.prototype.getClass=function(){return Kr},to.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Kr,to);var eo=function(){},io={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};eo.prototype.interfaces_=function(){return[]},eo.prototype.getClass=function(){return eo},eo.toDegrees=function(t){return 180*t/Math.PI},eo.normalize=function(t){for(;t>Math.PI;)t-=eo.PI_TIMES_2;for(;t<=-Math.PI;)t+=eo.PI_TIMES_2;return t},eo.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],i=arguments[1],n=i.x-e.x,r=i.y-e.y;return Math.atan2(r,n)}},eo.isAcute=function(t,e,i){var n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)>0},eo.isObtuse=function(t,e,i){var n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)<0},eo.interiorAngle=function(t,e,i){var n=eo.angle(e,t),r=eo.angle(e,i);return Math.abs(r-n)},eo.normalizePositive=function(t){if(t<0){for(;t<0;)t+=eo.PI_TIMES_2;t>=eo.PI_TIMES_2&&(t=0)}else{for(;t>=eo.PI_TIMES_2;)t-=eo.PI_TIMES_2;t<0&&(t=0)}return t},eo.angleBetween=function(t,e,i){var n=eo.angle(e,t),r=eo.angle(e,i);return eo.diff(n,r)},eo.diff=function(t,e){var i=null;return(i=t<e?e-t:t-e)>Math.PI&&(i=2*Math.PI-i),i},eo.toRadians=function(t){return t*Math.PI/180},eo.getTurn=function(t,e){var i=Math.sin(e-t);return i>0?eo.COUNTERCLOCKWISE:i<0?eo.CLOCKWISE:eo.NONE},eo.angleBetweenOriented=function(t,e,i){var n=eo.angle(e,t),r=eo.angle(e,i)-n;return r<=-Math.PI?r+eo.PI_TIMES_2:r>Math.PI?r-eo.PI_TIMES_2:r},io.PI_TIMES_2.get=function(){return 2*Math.PI},io.PI_OVER_2.get=function(){return Math.PI/2},io.PI_OVER_4.get=function(){return Math.PI/4},io.COUNTERCLOCKWISE.get=function(){return di.COUNTERCLOCKWISE},io.CLOCKWISE.get=function(){return di.CLOCKWISE},io.NONE.get=function(){return di.COLLINEAR},Object.defineProperties(eo,io);var no=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Br,this._seg1=new Br,this._offset0=new Br,this._offset1=new Br,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],i=arguments[1],n=arguments[2];this._precisionModel=e,this._bufParams=i,this._li=new ci,this._filletAngleQuantum=Math.PI/2/i.getQuadrantSegments(),i.getQuadrantSegments()>=8&&i.getJoinStyle()===$r.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)},ro={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};no.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var i=di.computeOrientation(this._s0,this._s1,this._s2),n=i===di.CLOCKWISE&&this._side===$n.LEFT||i===di.COUNTERCLOCKWISE&&this._side===$n.RIGHT;0===i?this.addCollinear(e):n?this.addOutsideTurn(i,e):this.addInsideTurn(i,e)},no.prototype.addLineEndCap=function(t,e){var i=new Br(t,e),n=new Br;this.computeOffsetSegment(i,$n.LEFT,this._distance,n);var r=new Br;this.computeOffsetSegment(i,$n.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case $r.CAP_ROUND:this._segList.addPt(n.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,di.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case $r.CAP_FLAT:this._segList.addPt(n.p1),this._segList.addPt(r.p1);break;case $r.CAP_SQUARE:var l=new Le;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new Le(n.p1.x+l.x,n.p1.y+l.y),c=new Le(r.p1.x+l.x,r.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},no.prototype.getCoordinates=function(){return this._segList.getCoordinates()},no.prototype.addMitreJoin=function(t,e,i,n){var r=!0,o=null;try{o=Qe.intersection(e.p0,e.p1,i.p0,i.p1),(n<=0?1:o.distance(t)/Math.abs(n))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof $e))throw t;o=new Le(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,i,n,this._bufParams.getMitreLimit())},no.prototype.addFilletCorner=function(t,e,i,n,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),l=i.x-t.x,u=i.y-t.y,c=Math.atan2(u,l);n===di.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,n,r),this._segList.addPt(i)},no.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*no.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===$r.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===$r.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},no.prototype.createSquare=function(t){this._segList.addPt(new Le(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new Le(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new Le(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new Le(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},no.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},no.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},no.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},no.prototype.initSideSegments=function(t,e,i){this._s1=t,this._s2=e,this._side=i,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)},no.prototype.addLimitedMitreJoin=function(t,e,i,n){var r=this._seg0.p1,o=eo.angle(r,this._seg0.p0),s=eo.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=eo.normalize(o+s),l=eo.normalize(a+Math.PI),u=n*i,c=i-u*Math.abs(Math.sin(s)),h=r.x+u*Math.cos(l),p=r.y+u*Math.sin(l),d=new Le(h,p),f=new Br(r,d),g=f.pointAlongOffset(1,c),m=f.pointAlongOffset(1,-c);this._side===$n.LEFT?(this._segList.addPt(g),this._segList.addPt(m)):(this._segList.addPt(m),this._segList.addPt(g))},no.prototype.computeOffsetSegment=function(t,e,i,n){var r=e===$n.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),l=r*i*o/a,u=r*i*s/a;n.p0.x=t.p0.x-u,n.p0.y=t.p0.y+l,n.p1.x=t.p1.x-u,n.p1.y=t.p1.y+l},no.prototype.addFilletArc=function(t,e,i,n,r){var o=n===di.CLOCKWISE?-1:1,s=Math.abs(e-i),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=s/a,u=0,c=new Le;u<s;){var h=e+o*u;c.x=t.x+r*Math.cos(h),c.y=t.y+r*Math.sin(h),this._segList.addPt(c),u+=l}},no.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*no.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new Le((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var n=new Le((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},no.prototype.createCircle=function(t){var e=new Le(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},no.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},no.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Kr,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*no.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},no.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===$r.JOIN_BEVEL||this._bufParams.getJoinStyle()===$r.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,di.CLOCKWISE,this._distance))},no.prototype.closeRing=function(){this._segList.closeRing()},no.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},no.prototype.interfaces_=function(){return[]},no.prototype.getClass=function(){return no},ro.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},ro.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},ro.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},ro.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(no,ro);var oo=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};oo.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var i=e<0,n=Math.abs(e),r=this.getSegGen(n);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,i,r);var o=r.getCoordinates();return i&&Ri.reverse(o),o},oo.prototype.computeSingleSidedBufferCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);if(e){i.addSegments(t,!0);var r=Qr.simplify(t,-n),o=r.length-1;i.initSideSegments(r[o],r[o-1],$n.LEFT),i.addFirstSegment();for(var s=o-2;s>=0;s--)i.addNextSegment(r[s],!0)}else{i.addSegments(t,!1);var a=Qr.simplify(t,n),l=a.length-1;i.initSideSegments(a[0],a[1],$n.LEFT),i.addFirstSegment();for(var u=2;u<=l;u++)i.addNextSegment(a[u],!0)}i.addLastSegment(),i.closeRing()},oo.prototype.computeRingBufferCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);e===$n.RIGHT&&(n=-n);var r=Qr.simplify(t,n),o=r.length-1;i.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;i.addNextSegment(r[s],a)}i.closeRing()},oo.prototype.computeLineBufferCurve=function(t,e){var i=this.simplifyTolerance(this._distance),n=Qr.simplify(t,i),r=n.length-1;e.initSideSegments(n[0],n[1],$n.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(n[o],!0);e.addLastSegment(),e.addLineEndCap(n[r-1],n[r]);var s=Qr.simplify(t,-i),a=s.length-1;e.initSideSegments(s[a],s[a-1],$n.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(s[l],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},oo.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case $r.CAP_ROUND:e.createCircle(t);break;case $r.CAP_SQUARE:e.createSquare(t)}},oo.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var i=Math.abs(e),n=this.getSegGen(i);if(t.length<=1)this.computePointCurve(t[0],n);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,n)}else this.computeLineBufferCurve(t,n);return n.getCoordinates()},oo.prototype.getBufferParameters=function(){return this._bufParams},oo.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},oo.prototype.getRingCurve=function(t,e,i){if(this._distance=i,t.length<=2)return this.getLineCurve(t,i);if(0===i)return oo.copyCoordinates(t);var n=this.getSegGen(i);return this.computeRingBufferCurve(t,e,n),n.getCoordinates()},oo.prototype.computeOffsetCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);if(e){var r=Qr.simplify(t,-n),o=r.length-1;i.initSideSegments(r[o],r[o-1],$n.LEFT),i.addFirstSegment();for(var s=o-2;s>=0;s--)i.addNextSegment(r[s],!0)}else{var a=Qr.simplify(t,n),l=a.length-1;i.initSideSegments(a[0],a[1],$n.LEFT),i.addFirstSegment();for(var u=2;u<=l;u++)i.addNextSegment(a[u],!0)}i.addLastSegment()},oo.prototype.getSegGen=function(t){return new no(this._precisionModel,this._bufParams,t)},oo.prototype.interfaces_=function(){return[]},oo.prototype.getClass=function(){return oo},oo.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),i=0;i<e.length;i++)e[i]=new Le(t[i]);return e};var so=function(){this._subgraphs=null,this._seg=new Br,this._cga=new di;var t=arguments[0];this._subgraphs=t},ao={DepthSegment:{configurable:!0}};so.prototype.findStabbedSegments=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],i=new Ni,n=this._subgraphs.iterator();n.hasNext();){var r=n.next(),o=r.getEnvelope();e.y<o.getMinY()||e.y>o.getMaxY()||t.findStabbedSegments(e,r.getDirectedEdges(),i)}return i}if(3===arguments.length)if(Fe(arguments[2],Ii)&&arguments[0]instanceof Le&&arguments[1]instanceof fr)for(var s=arguments[0],a=arguments[1],l=arguments[2],u=a.getEdge().getCoordinates(),c=0;c<u.length-1;c++){t._seg.p0=u[c],t._seg.p1=u[c+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var h=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(h<s.x)&&!(t._seg.isHorizontal()||s.y<t._seg.p0.y||s.y>t._seg.p1.y||di.computeOrientation(t._seg.p0,t._seg.p1,s)===di.RIGHT)){var p=a.getDepth($n.LEFT);t._seg.p0.equals(u[c])||(p=a.getDepth($n.RIGHT));var d=new lo(t._seg,p);l.add(d)}}else if(Fe(arguments[2],Ii)&&arguments[0]instanceof Le&&Fe(arguments[1],Ii))for(var f=arguments[0],g=arguments[1],m=arguments[2],_=g.iterator();_.hasNext();){var y=_.next();y.isForward()&&t.findStabbedSegments(f,y,m)}},so.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Sr.min(e)._leftDepth},so.prototype.interfaces_=function(){return[]},so.prototype.getClass=function(){return so},ao.DepthSegment.get=function(){return lo},Object.defineProperties(so,ao);var lo=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new Br(t),this._leftDepth=e};lo.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var i=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==i||0!==(i=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?i:this._upwardSeg.compareTo(e._upwardSeg)},lo.prototype.compareX=function(t,e){var i=t.p0.compareTo(e.p0);return 0!==i?i:t.p1.compareTo(e.p1)},lo.prototype.toString=function(){return this._upwardSeg.toString()},lo.prototype.interfaces_=function(){return[Te]},lo.prototype.getClass=function(){return lo};var uo=function(t,e,i){this.p0=t||null,this.p1=e||null,this.p2=i||null};uo.prototype.area=function(){return uo.area(this.p0,this.p1,this.p2)},uo.prototype.signedArea=function(){return uo.signedArea(this.p0,this.p1,this.p2)},uo.prototype.interpolateZ=function(t){if(null===t)throw new be("Supplied point is null.");return uo.interpolateZ(t,this.p0,this.p1,this.p2)},uo.prototype.longestSideLength=function(){return uo.longestSideLength(this.p0,this.p1,this.p2)},uo.prototype.isAcute=function(){return uo.isAcute(this.p0,this.p1,this.p2)},uo.prototype.circumcentre=function(){return uo.circumcentre(this.p0,this.p1,this.p2)},uo.prototype.area3D=function(){return uo.area3D(this.p0,this.p1,this.p2)},uo.prototype.centroid=function(){return uo.centroid(this.p0,this.p1,this.p2)},uo.prototype.inCentre=function(){return uo.inCentre(this.p0,this.p1,this.p2)},uo.prototype.interfaces_=function(){return[]},uo.prototype.getClass=function(){return uo},uo.area=function(t,e,i){return Math.abs(((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2)},uo.signedArea=function(t,e,i){return((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2},uo.det=function(t,e,i,n){return t*n-e*i},uo.interpolateZ=function(t,e,i,n){var r=e.x,o=e.y,s=i.x-r,a=n.x-r,l=i.y-o,u=n.y-o,c=s*u-a*l,h=t.x-r,p=t.y-o,d=(u*h-a*p)/c,f=(-l*h+s*p)/c;return e.z+d*(i.z-e.z)+f*(n.z-e.z)},uo.longestSideLength=function(t,e,i){var n=t.distance(e),r=e.distance(i),o=i.distance(t),s=n;return r>s&&(s=r),o>s&&(s=o),s},uo.isAcute=function(t,e,i){return!!eo.isAcute(t,e,i)&&(!!eo.isAcute(e,i,t)&&!!eo.isAcute(i,t,e))},uo.circumcentre=function(t,e,i){var n=i.x,r=i.y,o=t.x-n,s=t.y-r,a=e.x-n,l=e.y-r,u=2*uo.det(o,s,a,l),c=uo.det(s,o*o+s*s,l,a*a+l*l),h=uo.det(o,o*o+s*s,a,a*a+l*l);return new Le(n-c/u,r+h/u)},uo.perpendicularBisector=function(t,e){var i=e.x-t.x,n=e.y-t.y,r=new Qe(t.x+i/2,t.y+n/2,1),o=new Qe(t.x-n+i/2,t.y+i+n/2,1);return new Qe(r,o)},uo.angleBisector=function(t,e,i){var n=e.distance(t),r=n/(n+e.distance(i)),o=i.x-t.x,s=i.y-t.y;return new Le(t.x+r*o,t.y+r*s)},uo.area3D=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=i.x-t.x,a=i.y-t.y,l=i.z-t.z,u=r*l-o*a,c=o*s-n*l,h=n*a-r*s,p=u*u+c*c+h*h,d=Math.sqrt(p)/2;return d},uo.centroid=function(t,e,i){var n=(t.x+e.x+i.x)/3,r=(t.y+e.y+i.y)/3;return new Le(n,r)},uo.inCentre=function(t,e,i){var n=e.distance(i),r=t.distance(i),o=t.distance(e),s=n+r+o,a=(n*t.x+r*e.x+o*i.x)/s,l=(n*t.y+r*e.y+o*i.y)/s;return new Le(a,l)};var co=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Ni;var t=arguments[0],e=arguments[1],i=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=i};co.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,Re.EXTERIOR,Re.INTERIOR)},co.prototype.addPolygon=function(t){var e=this,i=this._distance,n=$n.LEFT;this._distance<0&&(i=-this._distance,n=$n.RIGHT);var r=t.getExteriorRing(),o=Ri.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&o.length<3)return null;this.addPolygonRing(o,i,n,Re.EXTERIOR,Re.INTERIOR);for(var s=0;s<t.getNumInteriorRing();s++){var a=t.getInteriorRingN(s),l=Ri.removeRepeatedPoints(a.getCoordinates());e._distance>0&&e.isErodedCompletely(a,-e._distance)||e.addPolygonRing(l,i,$n.opposite(n),Re.INTERIOR,Re.EXTERIOR)}},co.prototype.isTriangleErodedCompletely=function(t,e){var i=new uo(t[0],t[1],t[2]),n=i.inCentre();return di.distancePointLine(n,i.p0,i.p1)<Math.abs(e)},co.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Ri.removeRepeatedPoints(t.getCoordinates()),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,Re.EXTERIOR,Re.INTERIOR)},co.prototype.addCurve=function(t,e,i){if(null===t||t.length<2)return null;var n=new Gr(t,new rr(0,Re.BOUNDARY,e,i));this._curveList.add(n)},co.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},co.prototype.addPolygonRing=function(t,e,i,n,r){if(0===e&&t.length<Sn.MINIMUM_VALID_SIZE)return null;var o=n,s=r;t.length>=Sn.MINIMUM_VALID_SIZE&&di.isCCW(t)&&(o=r,s=n,i=$n.opposite(i));var a=this._curveBuilder.getRingCurve(t,i,e);this.addCurve(a,o,s)},co.prototype.add=function(t){if(t.isEmpty())return null;t instanceof bn?this.addPolygon(t):t instanceof vn?this.addLineString(t):t instanceof xn?this.addPoint(t):(t instanceof En||t instanceof an||t instanceof Tn||t instanceof sn)&&this.addCollection(t)},co.prototype.isErodedCompletely=function(t,e){var i=t.getCoordinates();if(i.length<4)return e<0;if(4===i.length)return this.isTriangleErodedCompletely(i,e);var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>r},co.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}},co.prototype.interfaces_=function(){return[]},co.prototype.getClass=function(){return co};var ho=function(){};ho.prototype.locate=function(t){},ho.prototype.interfaces_=function(){return[]},ho.prototype.getClass=function(){return ho};var po=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};po.prototype.next=function(){if(this._atStart)return this._atStart=!1,po.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Li;var t=this._parent.getGeometryN(this._index++);return t instanceof sn?(this._subcollectionIterator=new po(t),this._subcollectionIterator.next()):t},po.prototype.remove=function(){throw new Error(this.getClass().getName())},po.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},po.prototype.interfaces_=function(){return[Ai]},po.prototype.getClass=function(){return po},po.isAtomic=function(t){return!(t instanceof sn)};var fo=function(){this._geom=null;var t=arguments[0];this._geom=t};fo.prototype.locate=function(t){return fo.locate(t,this._geom)},fo.prototype.interfaces_=function(){return[ho]},fo.prototype.getClass=function(){return fo},fo.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&di.isPointInRing(t,e.getCoordinates())},fo.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var i=e.getExteriorRing();if(!fo.isPointInRing(t,i))return!1;for(var n=0;n<e.getNumInteriorRing();n++){var r=e.getInteriorRingN(n);if(fo.isPointInRing(t,r))return!1}return!0},fo.containsPoint=function(t,e){if(e instanceof bn)return fo.containsPointInPolygon(t,e);if(e instanceof sn)for(var i=new po(e);i.hasNext();){var n=i.next();if(n!==e&&fo.containsPoint(t,n))return!0}return!1},fo.locate=function(t,e){return e.isEmpty()?Re.EXTERIOR:fo.containsPoint(t,e)?Re.INTERIOR:Re.EXTERIOR};var go=function(){this._edgeMap=new $i,this._edgeList=null,this._ptInAreaLocation=[Re.NONE,Re.NONE]};go.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),i=e-1;return 0===e&&(i=this._edgeList.size()-1),this._edgeList.get(i)},go.prototype.propagateSideLabels=function(t){for(var e=Re.NONE,i=this.iterator();i.hasNext();){var n=i.next().getLabel();n.isArea(t)&&n.getLocation(t,$n.LEFT)!==Re.NONE&&(e=n.getLocation(t,$n.LEFT))}if(e===Re.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,$n.ON)===Re.NONE&&a.setLocation(t,$n.ON,r),a.isArea(t)){var l=a.getLocation(t,$n.LEFT),u=a.getLocation(t,$n.RIGHT);if(u!==Re.NONE){if(u!==r)throw new tr("side location conflict",s.getCoordinate());l===Re.NONE&&ai.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=l}else ai.isTrue(a.getLocation(t,$n.LEFT)===Re.NONE,"found single null side"),a.setLocation(t,$n.RIGHT,r),a.setLocation(t,$n.LEFT,r)}}},go.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},go.prototype.print=function(t){Je.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){e.next().print(t)}},go.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},go.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var i=e.size()-1,n=e.get(i).getLabel().getLocation(t,$n.LEFT);ai.isTrue(n!==Re.NONE,"Found unlabelled area edge");for(var r=n,o=this.iterator();o.hasNext();){var s=o.next().getLabel();ai.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,$n.LEFT),l=s.getLocation(t,$n.RIGHT);if(a===l)return!1;if(l!==r)return!1;r=a}return!0},go.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++){if(this._edgeList.get(e)===t)return e}return-1},go.prototype.iterator=function(){return this.getEdges().iterator()},go.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Ni(this._edgeMap.values())),this._edgeList},go.prototype.getLocation=function(t,e,i){return this._ptInAreaLocation[t]===Re.NONE&&(this._ptInAreaLocation[t]=fo.locate(e,i[t].getGeometry())),this._ptInAreaLocation[t]},go.prototype.toString=function(){var t=new Ge;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var i=e.next();t.append(i),t.append("\n")}return t.toString()},go.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();){e.next().computeLabel(t)}},go.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],i=this.iterator();i.hasNext();)for(var n=i.next().getLabel(),r=0;r<2;r++)n.isLine(r)&&n.getLocation(r)===Re.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var u=Re.NONE;if(e[l])u=Re.EXTERIOR;else{var c=s.getCoordinate();u=this.getLocation(l,c,t)}a.setAllLocationsIfNull(l,u)}},go.prototype.getDegree=function(){return this._edgeMap.size()},go.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},go.prototype.interfaces_=function(){return[]},go.prototype.getClass=function(){return go};var mo=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){var t=this;this.getResultAreaEdges();for(var e=null,i=null,n=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var o=t._resultAreaEdgeList.get(r),s=o.getSym();if(o.getLabel().isArea())switch(null===e&&o.isInResult()&&(e=o),n){case t._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;i=s,n=t._LINKING_TO_OUTGOING;break;case t._LINKING_TO_OUTGOING:if(!o.isInResult())continue;i.setNext(o),n=t._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===e)throw new tr("no outgoing dirEdge found",this.getCoordinate());ai.isTrue(e.isInResult(),"unable to link last incoming dirEdge"),i.setNext(e)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var i=t.get(0);if(1===e)return i;var n=t.get(e-1),r=i.getQuadrant(),o=n.getQuadrant();return hr.isNorthern(r)&&hr.isNorthern(o)?i:hr.isNorthern(r)||hr.isNorthern(o)?0!==i.getDy()?i:0!==n.getDy()?n:(ai.shouldNeverReachHere("found two horizontal edges incident on node"),null):n},e.prototype.print=function(t){Je.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var i=e.next();t.print("out "),i.print(t),t.println(),t.print("in "),i.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Ni;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var i=e.next().getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,i=this._edgeList.size()-1;i>=0;i--){var n=this._edgeList.get(i),r=n.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=n}e.setNext(t)},e.prototype.computeDepths=function(){var t=this;if(1===arguments.length){var e=arguments[0],i=this.findIndex(e),n=e.getDepth($n.LEFT),r=e.getDepth($n.RIGHT),o=this.computeDepths(i+1,this._edgeList.size(),n),s=this.computeDepths(0,i,o);if(s!==r)throw new tr("depth mismatch at "+e.getCoordinate())}else if(3===arguments.length){for(var a=arguments[0],l=arguments[1],u=arguments[2],c=u,h=a;h<l;h++){var p=t._edgeList.get(h);p.setEdgeDepths($n.RIGHT,c),c=p.getDepth($n.LEFT)}return c}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=this,i=null,n=null,r=this._SCANNING_FOR_INCOMING,o=this._resultAreaEdgeList.size()-1;o>=0;o--){var s=e._resultAreaEdgeList.get(o),a=s.getSym();switch(null===i&&s.getEdgeRing()===t&&(i=s),r){case e._SCANNING_FOR_INCOMING:if(a.getEdgeRing()!==t)continue;n=a,r=e._LINKING_TO_OUTGOING;break;case e._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;n.setNextMin(s),r=e._SCANNING_FOR_INCOMING}}r===this._LINKING_TO_OUTGOING&&(ai.isTrue(null!==i,"found null for first outgoing dirEdge"),ai.isTrue(i.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(i))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();){var i=e.next();i.isInResult()&&t++}return t}if(1===arguments.length){for(var n=arguments[0],r=0,o=this.iterator();o.hasNext();){var s=o.next();s.getEdgeRing()===n&&r++}return r}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=Re.NONE,e=this.iterator();e.hasNext();){var i=e.next(),n=i.getSym();if(!i.isLineEdge()){if(i.isInResult()){t=Re.INTERIOR;break}if(n.isInResult()){t=Re.EXTERIOR;break}}}if(t===Re.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===Re.INTERIOR):(s.isInResult()&&(r=Re.EXTERIOR),a.isInResult()&&(r=Re.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new rr(Re.NONE);for(var i=this.iterator();i.hasNext();)for(var n=i.next().getEdge().getLabel(),r=0;r<2;r++){var o=n.getLocation(r);o!==Re.INTERIOR&&o!==Re.BOUNDARY||this._label.setLocation(r,Re.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(go),_o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new ur(t,new mo)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(gr),yo=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};yo.prototype.compareTo=function(t){var e=t;return yo.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},yo.prototype.interfaces_=function(){return[Te]},yo.prototype.getClass=function(){return yo},yo.orientation=function(t){return 1===Ri.increasingDirection(t)},yo.compareOriented=function(t,e,i,n){for(var r=e?1:-1,o=n?1:-1,s=e?t.length:-1,a=n?i.length:-1,l=e?0:t.length-1,u=n?0:i.length-1;;){var c=t[l].compareTo(i[u]);if(0!==c)return c;var h=(l+=r)===s,p=(u+=o)===a;if(h&&!p)return-1;if(!h&&p)return 1;if(h&&p)return 0}};var vo=function(){this._edges=new Ni,this._ocaMap=new $i};vo.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var i=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var n=i.getCoordinates(),r=0;r<n.length;r++)r>0&&t.print(","),t.print(n[r].x+" "+n[r].y);t.println(")")}t.print(")  ")},vo.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},vo.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},vo.prototype.iterator=function(){return this._edges.iterator()},vo.prototype.getEdges=function(){return this._edges},vo.prototype.get=function(t){return this._edges.get(t)},vo.prototype.findEqualEdge=function(t){var e=new yo(t.getCoordinates());return this._ocaMap.get(e)},vo.prototype.add=function(t){this._edges.add(t);var e=new yo(t.getCoordinates());this._ocaMap.put(e,t)},vo.prototype.interfaces_=function(){return[]},vo.prototype.getClass=function(){return vo};var Co=function(){};Co.prototype.processIntersections=function(t,e,i,n){},Co.prototype.isDone=function(){},Co.prototype.interfaces_=function(){return[]},Co.prototype.getClass=function(){return Co};var xo=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};xo.prototype.isTrivialIntersection=function(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(xo.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&n===r||0===n&&e===r)return!0}}return!1},xo.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},xo.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},xo.prototype.getLineIntersector=function(){return this._li},xo.prototype.hasProperIntersection=function(){return this._hasProper},xo.prototype.processIntersections=function(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},xo.prototype.hasIntersection=function(){return this._hasIntersection},xo.prototype.isDone=function(){return!1},xo.prototype.hasInteriorIntersection=function(){return this._hasInterior},xo.prototype.interfaces_=function(){return[Co]},xo.prototype.getClass=function(){return xo},xo.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var wo=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],i=arguments[2];this.coord=new Le(t),this.segmentIndex=e,this.dist=i};wo.prototype.getSegmentIndex=function(){return this.segmentIndex},wo.prototype.getCoordinate=function(){return this.coord},wo.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},wo.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},wo.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},wo.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},wo.prototype.getDistance=function(){return this.dist},wo.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},wo.prototype.interfaces_=function(){return[Te]},wo.prototype.getClass=function(){return wo};var bo=function(){this._nodeMap=new $i,this.edge=null;var t=arguments[0];this.edge=t};bo.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},bo.prototype.iterator=function(){return this._nodeMap.values().iterator()},bo.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}},bo.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},bo.prototype.createSplitEdge=function(t,e){var i=e.segmentIndex-t.segmentIndex+2,n=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(n);r||i--;var o=new Array(i).fill(null),s=0;o[s++]=new Le(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new Ao(o,new rr(this.edge._label))},bo.prototype.add=function(t,e,i){var n=new wo(t,e,i),r=this._nodeMap.get(n);return null!==r?r:(this._nodeMap.put(n,n),n)},bo.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1},bo.prototype.interfaces_=function(){return[]},bo.prototype.getClass=function(){return bo};var Eo=function(){};Eo.prototype.getChainStartIndices=function(t){var e=0,i=new Ni;i.add(new Be(e));do{var n=this.findChainEnd(t,e);i.add(new Be(n)),e=n}while(e<t.length-1);return Eo.toIntArray(i)},Eo.prototype.findChainEnd=function(t,e){for(var i=hr.quadrant(t[e],t[e+1]),n=e+1;n<t.length;){if(hr.quadrant(t[n-1],t[n])!==i)break;n++}return n-1},Eo.prototype.interfaces_=function(){return[]},Eo.prototype.getClass=function(){return Eo},Eo.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var So=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Ze,this.env2=new Ze;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Eo;this.startIndex=e.getChainStartIndices(this.pts)};So.prototype.getCoordinates=function(){return this.pts},So.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e>i?e:i},So.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e<i?e:i},So.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[i],e.startIndex[i+1],n)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[r],h=this.pts[o],p=s.pts[a],d=s.pts[l];if(o-r==1&&l-a==1)return u.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(c,h),this.env2.init(p,d),!this.env1.intersects(this.env2))return null;var f=Math.trunc((r+o)/2),g=Math.trunc((a+l)/2);r<f&&(a<g&&this.computeIntersectsForChain(r,f,s,a,g,u),g<l&&this.computeIntersectsForChain(r,f,s,g,l,u)),f<o&&(a<g&&this.computeIntersectsForChain(f,o,s,a,g,u),g<l&&this.computeIntersectsForChain(f,o,s,g,l,u))}},So.prototype.getStartIndexes=function(){return this.startIndex},So.prototype.computeIntersects=function(t,e){for(var i=0;i<this.startIndex.length-1;i++)for(var n=0;n<t.startIndex.length-1;n++)this.computeIntersectsForChain(i,t,n,e)},So.prototype.interfaces_=function(){return[]},So.prototype.getClass=function(){return So};var To=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var i=0;i<3;i++)this._depth[e][i]=t.NULL_VALUE},Po={NULL_VALUE:{configurable:!0}};To.prototype.getDepth=function(t,e){return this._depth[t][e]},To.prototype.setDepth=function(t,e,i){this._depth[t][e]=i},To.prototype.isNull=function(){var t=this;if(0===arguments.length){for(var e=0;e<2;e++)for(var i=0;i<3;i++)if(t._depth[e][i]!==To.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===To.NULL_VALUE}if(2===arguments.length){var r=arguments[0],o=arguments[1];return this._depth[r][o]===To.NULL_VALUE}},To.prototype.normalize=function(){for(var t=this,e=0;e<2;e++)if(!t.isNull(e)){var i=t._depth[e][1];t._depth[e][2]<i&&(i=t._depth[e][2]),i<0&&(i=0);for(var n=1;n<3;n++){var r=0;t._depth[e][n]>i&&(r=1),t._depth[e][n]=r}}},To.prototype.getDelta=function(t){return this._depth[t][$n.RIGHT]-this._depth[t][$n.LEFT]},To.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?Re.EXTERIOR:Re.INTERIOR},To.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},To.prototype.add=function(){var t=this;if(1===arguments.length)for(var e=arguments[0],i=0;i<2;i++)for(var n=1;n<3;n++){var r=e.getLocation(i,n);r!==Re.EXTERIOR&&r!==Re.INTERIOR||(t.isNull(i,n)?t._depth[i][n]=To.depthAtLocation(r):t._depth[i][n]+=To.depthAtLocation(r))}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];a===Re.INTERIOR&&this._depth[o][s]++}},To.prototype.interfaces_=function(){return[]},To.prototype.getClass=function(){return To},To.depthAtLocation=function(t){return t===Re.EXTERIOR?0:t===Re.INTERIOR?1:To.NULL_VALUE},Po.NULL_VALUE.get=function(){return-1},Object.defineProperties(To,Po);var Ao=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new bo(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new To,this._depthDelta=0,1===arguments.length){var i=arguments[0];e.call(this,i,null)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.pts=n,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,rr.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var i=t;if(this.pts.length!==i.pts.length)return!1;for(var n=!0,r=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(i.pts[s])||(n=!1),this.pts[s].equals2D(i.pts[--o])||(r=!1),!n&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new So(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new Ze;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,i,n){var r=new Le(t.getIntersection(n)),o=e,s=t.getEdgeDistance(i,n),a=o+1;if(a<this.pts.length){var l=this.pts[a];r.equals2D(l)&&(o=a,s=0)}this.eiList.add(r,o,s)},e.prototype.toString=function(){var t=new Ge;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],i=arguments[1];i.setAtLeastIfValid(e.getLocation(0,$n.ON),e.getLocation(1,$n.ON),1),e.isArea()&&(i.setAtLeastIfValid(e.getLocation(0,$n.LEFT),e.getLocation(1,$n.LEFT),2),i.setAtLeastIfValid(e.getLocation(0,$n.RIGHT),e.getLocation(1,$n.RIGHT),2))},e}(lr),Io=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new vo,this._bufParams=t||null};Io.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},Io.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new rr(t.getLabel())).flip(),i.merge(n);var r=Io.depthDelta(n),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(Io.depthDelta(t.getLabel()))},Io.prototype.buildSubgraphs=function(t,e){for(var i=new Ni,n=t.iterator();n.hasNext();){var r=n.next(),o=r.getRightmostCoordinate(),s=new so(i).getDepth(o);r.computeDepth(s),r.findResultEdges(),i.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},Io.prototype.createSubgraphs=function(t){for(var e=new Ni,i=t.getNodes().iterator();i.hasNext();){var n=i.next();if(!n.isVisited()){var r=new ir;r.create(n),e.add(r)}}return Sr.sort(e,Sr.reverseOrder()),e},Io.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Io.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new Yr,i=new ci;return i.setPrecisionModel(t),e.setSegmentIntersector(new xo(i)),e},Io.prototype.buffer=function(t,e){var i=this._workingPrecisionModel;null===i&&(i=t.getPrecisionModel()),this._geomFact=t.getFactory();var n=new oo(i,this._bufParams),r=new co(t,e,n).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,i),this._graph=new mr(new _o),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new _r(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},Io.prototype.computeNodedEdges=function(t,e){var i=this.getNoder(e);i.computeNodes(t);for(var n=i.getNodedSubstrings().iterator();n.hasNext();){var r=n.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new Ao(r.getCoordinates(),new rr(s));this.insertUniqueEdge(a)}}},Io.prototype.setNoder=function(t){this._workingNoder=t},Io.prototype.interfaces_=function(){return[]},Io.prototype.getClass=function(){return Io},Io.depthDelta=function(t){var e=t.getLocation(0,$n.LEFT),i=t.getLocation(0,$n.RIGHT);return e===Re.INTERIOR&&i===Re.EXTERIOR?1:e===Re.EXTERIOR&&i===Re.INTERIOR?-1:0},Io.convertSegStrings=function(t){for(var e=new Un,i=new Ni;t.hasNext();){var n=t.next(),r=e.createLineString(n.getCoordinates());i.add(r)}return e.buildGeometry(i)};var Lo=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._noder=i,this._scaleFactor=n,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};Lo.prototype.rescale=function(){var t=this;if(Fe(arguments[0],Ti))for(var e=arguments[0],i=e.iterator();i.hasNext();){var n=i.next();t.rescale(n.getCoordinates())}else if(arguments[0]instanceof Array){for(var r=arguments[0],o=0;o<r.length;o++)r[o].x=r[o].x/t._scaleFactor+t._offsetX,r[o].y=r[o].y/t._scaleFactor+t._offsetY;2===r.length&&r[0].equals2D(r[1])&&Je.out.println(r)}},Lo.prototype.scale=function(){var t=this;if(Fe(arguments[0],Ti)){for(var e=arguments[0],i=new Ni,n=e.iterator();n.hasNext();){var r=n.next();i.add(new Gr(t.scale(r.getCoordinates()),r.getData()))}return i}if(arguments[0]instanceof Array){for(var o=arguments[0],s=new Array(o.length).fill(null),a=0;a<o.length;a++)s[a]=new Le(Math.round((o[a].x-t._offsetX)*t._scaleFactor),Math.round((o[a].y-t._offsetY)*t._scaleFactor),o[a].z);var l=Ri.removeRepeatedPoints(s);return l}},Lo.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Lo.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},Lo.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},Lo.prototype.interfaces_=function(){return[jr]},Lo.prototype.getClass=function(){return Lo};var No=function(){this._li=new ci,this._segStrings=null;var t=arguments[0];this._segStrings=t},Mo={fact:{configurable:!0}};No.prototype.checkEndPtVertexIntersections=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next(),n=i.getCoordinates();t.checkEndPtVertexIntersections(n[0],t._segStrings),t.checkEndPtVertexIntersections(n[n.length-1],t._segStrings)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=o.iterator();s.hasNext();)for(var a=s.next(),l=a.getCoordinates(),u=1;u<l.length-1;u++)if(l[u].equals(r))throw new oi("found endpt/interior pt intersection at index "+u+" :pt "+r)},No.prototype.checkInteriorIntersections=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();)for(var i=e.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();t.checkInteriorIntersections(i,r)}else if(2===arguments.length)for(var o=arguments[0],s=arguments[1],a=o.getCoordinates(),l=s.getCoordinates(),u=0;u<a.length-1;u++)for(var c=0;c<l.length-1;c++)t.checkInteriorIntersections(o,u,s,c);else if(4===arguments.length){var h=arguments[0],p=arguments[1],d=arguments[2],f=arguments[3];if(h===d&&p===f)return null;var g=h.getCoordinates()[p],m=h.getCoordinates()[p+1],_=d.getCoordinates()[f],y=d.getCoordinates()[f+1];if(this._li.computeIntersection(g,m,_,y),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,g,m)||this.hasInteriorIntersection(this._li,_,y)))throw new oi("found non-noded intersection at "+g+"-"+m+" and "+_+"-"+y)}},No.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},No.prototype.checkCollapses=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next();t.checkCollapses(i)}else if(1===arguments.length)for(var n=arguments[0],r=n.getCoordinates(),o=0;o<r.length-2;o++)t.checkCollapse(r[o],r[o+1],r[o+2])},No.prototype.hasInteriorIntersection=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++){var r=t.getIntersection(n);if(!r.equals(e)&&!r.equals(i))return!0}return!1},No.prototype.checkCollapse=function(t,e,i){if(t.equals(i))throw new oi("found non-noded collapse at "+No.fact.createLineString([t,e,i]))},No.prototype.interfaces_=function(){return[]},No.prototype.getClass=function(){return No},Mo.fact.get=function(){return new Un},Object.defineProperties(No,Mo);var Do=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=i,e<=0)throw new be("Scale factor must be non-zero");1!==e&&(this._pt=new Le(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new Le,this._p1Scaled=new Le),this.initCorners(this._pt)},Ro={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Do.prototype.intersectsScaled=function(t,e){var i=Math.min(t.x,e.x),n=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<i||this._minx>n||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return ai.isTrue(!(s&&a),"Found bad envelope test"),a},Do.prototype.initCorners=function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new Le(this._maxx,this._maxy),this._corner[1]=new Le(this._minx,this._maxy),this._corner[2]=new Le(this._minx,this._miny),this._corner[3]=new Le(this._maxx,this._miny)},Do.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Do.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},Do.prototype.getCoordinate=function(){return this._originalPt},Do.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},Do.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=Do.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ze(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},Do.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},Do.prototype.intersectsToleranceSquare=function(t,e){var i=!1,n=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||(!(!i||!n)||(!!t.equals(this._pt)||!!e.equals(this._pt))))))},Do.prototype.addSnappedNode=function(t,e){var i=t.getCoordinate(e),n=t.getCoordinate(e+1);return!!this.intersects(i,n)&&(t.addIntersection(this.getCoordinate(),e),!0)},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do},Ro.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Do,Ro);var Oo=function(){this.tempEnv1=new Ze,this.selectedSegment=new Br};Oo.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},Oo.prototype.interfaces_=function(){return[]},Oo.prototype.getClass=function(){return Oo};var Fo=function(){this._index=null;var t=arguments[0];this._index=t},ko={HotPixelSnapAction:{configurable:!0}};Fo.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=e.getSafeEnvelope(),o=new zo(e,i,n);return this._index.query(r,{interfaces_:function(){return[xr]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},Fo.prototype.interfaces_=function(){return[]},Fo.prototype.getClass=function(){return Fo},ko.HotPixelSnapAction.get=function(){return zo},Object.defineProperties(Fo,ko);var zo=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],i=arguments[1],n=arguments[2];this._hotPixel=e,this._parentEdge=i,this._hotPixelVertexIndex=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[0],i=arguments[1],n=e.getContext();if(null!==this._parentEdge&&n===this._parentEdge&&i===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Oo),Go=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Ni};Go.prototype.processIntersections=function(t,e,i,n){if(t===i&&e===n)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1)}},Go.prototype.isDone=function(){return!1},Go.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Go.prototype.interfaces_=function(){return[Co]},Go.prototype.getClass=function(){return Go};var Bo=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new ci,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};Bo.prototype.checkCorrectness=function(t){var e=Gr.getNodedSubstrings(t),i=new No(e);try{i.checkValid()}catch(t){if(!(t instanceof Xe))throw t;t.printStackTrace()}},Bo.prototype.getNodedSubstrings=function(){return Gr.getNodedSubstrings(this._nodedSegStrings)},Bo.prototype.snapRound=function(t,e){var i=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(i),this.computeVertexSnaps(t)},Bo.prototype.findInteriorIntersections=function(t,e){var i=new Go(e);return this._noder.setSegmentIntersector(i),this._noder.computeNodes(t),i.getInteriorIntersections()},Bo.prototype.computeVertexSnaps=function(){var t=this;if(Fe(arguments[0],Ti))for(var e=arguments[0],i=e.iterator();i.hasNext();){var n=i.next();t.computeVertexSnaps(n)}else if(arguments[0]instanceof Gr)for(var r=arguments[0],o=r.getCoordinates(),s=0;s<o.length;s++){var a=new Do(o[s],t._scaleFactor,t._li),l=t._pointSnapper.snap(a,r,s);l&&r.addIntersection(o[s],s)}},Bo.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new Yr,this._pointSnapper=new Fo(this._noder.getIndex()),this.snapRound(t,this._li)},Bo.prototype.computeIntersectionSnaps=function(t){for(var e=this,i=t.iterator();i.hasNext();){var n=i.next(),r=new Do(n,e._scaleFactor,e._li);e._pointSnapper.snap(r)}},Bo.prototype.interfaces_=function(){return[jr]},Bo.prototype.getClass=function(){return Bo};var Uo=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new $r,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._argGeom=e,this._bufParams=i}},Vo={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Uo.prototype.bufferFixedPrecision=function(t){var e=new Lo(new Bo(new kn(1)),t.getScale()),i=new Io(this._bufParams);i.setWorkingPrecisionModel(t),i.setNoder(e),this._resultGeometry=i.buffer(this._argGeom,this._distance)},Uo.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=Uo.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof tr))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var i=arguments[0],n=Uo.precisionScaleFactor(this._argGeom,this._distance,i),r=new kn(n);this.bufferFixedPrecision(r)}},Uo.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===kn.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},Uo.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},Uo.prototype.bufferOriginalPrecision=function(){try{var t=new Io(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof oi))throw t;this._saveException=t}},Uo.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},Uo.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},Uo.prototype.interfaces_=function(){return[]},Uo.prototype.getClass=function(){return Uo},Uo.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new Uo(t),n=i.getResultGeometry(e);return n}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof mi&&"number"==typeof arguments[1]){var r=arguments[0],o=arguments[1],s=arguments[2],a=new Uo(r);a.setQuadrantSegments(s);var l=a.getResultGeometry(o);return l}if(arguments[2]instanceof $r&&arguments[0]instanceof mi&&"number"==typeof arguments[1]){var u=arguments[0],c=arguments[1],h=arguments[2],p=new Uo(u,h),d=p.getResultGeometry(c);return d}}else if(4===arguments.length){var f=arguments[0],g=arguments[1],m=arguments[2],_=arguments[3],y=new Uo(f);y.setQuadrantSegments(m),y.setEndCapStyle(_);var v=y.getResultGeometry(g);return v}},Uo.precisionScaleFactor=function(t,e,i){var n=t.getEnvelopeInternal(),r=ke.max(Math.abs(n.getMaxX()),Math.abs(n.getMaxY()),Math.abs(n.getMinX()),Math.abs(n.getMinY()))+2*(e>0?e:0),o=i-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},Vo.CAP_ROUND.get=function(){return $r.CAP_ROUND},Vo.CAP_BUTT.get=function(){return $r.CAP_FLAT},Vo.CAP_FLAT.get=function(){return $r.CAP_FLAT},Vo.CAP_SQUARE.get=function(){return $r.CAP_SQUARE},Vo.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Uo,Vo);var Ho=function(){this._pt=[new Le,new Le],this._distance=Ee.NaN,this._isNull=!0};Ho.prototype.getCoordinates=function(){return this._pt},Ho.prototype.getCoordinate=function(t){return this._pt[t]},Ho.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n<this._distance&&this.initialize(e,i,n)}},Ho.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(n),this._distance=r,this._isNull=!1}},Ho.prototype.getDistance=function(){return this._distance},Ho.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n>this._distance&&this.initialize(e,i,n)}},Ho.prototype.interfaces_=function(){return[]},Ho.prototype.getClass=function(){return Ho};var Wo=function(){};Wo.prototype.interfaces_=function(){return[]},Wo.prototype.getClass=function(){return Wo},Wo.computeDistance=function(){if(arguments[2]instanceof Ho&&arguments[0]instanceof vn&&arguments[1]instanceof Le)for(var t=arguments[0],e=arguments[1],i=arguments[2],n=t.getCoordinates(),r=new Br,o=0;o<n.length-1;o++){r.setCoordinates(n[o],n[o+1]);var s=r.closestPoint(e);i.setMinimum(s,e)}else if(arguments[2]instanceof Ho&&arguments[0]instanceof bn&&arguments[1]instanceof Le){var a=arguments[0],l=arguments[1],u=arguments[2];Wo.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)Wo.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Ho&&arguments[0]instanceof mi&&arguments[1]instanceof Le){var h=arguments[0],p=arguments[1],d=arguments[2];if(h instanceof vn)Wo.computeDistance(h,p,d);else if(h instanceof bn)Wo.computeDistance(h,p,d);else if(h instanceof sn)for(var f=h,g=0;g<f.getNumGeometries();g++){var m=f.getGeometryN(g);Wo.computeDistance(m,p,d)}else d.setMinimum(h.getCoordinate(),p)}else if(arguments[2]instanceof Ho&&arguments[0]instanceof Br&&arguments[1]instanceof Le){var _=arguments[0],y=arguments[1],v=arguments[2],C=_.closestPoint(y);v.setMinimum(C,y)}};var jo=function(t){this._maxPtDist=new Ho,this._inputGeom=t||null},qo={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};jo.prototype.computeMaxMidpointDistance=function(t){var e=new Xo(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},jo.prototype.computeMaxVertexDistance=function(t){var e=new Yo(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},jo.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},jo.prototype.getDistancePoints=function(){return this._maxPtDist},jo.prototype.interfaces_=function(){return[]},jo.prototype.getClass=function(){return jo},qo.MaxPointDistanceFilter.get=function(){return Yo},qo.MaxMidpointDistanceFilter.get=function(){return Xo},Object.defineProperties(jo,qo);var Yo=function(t){this._maxPtDist=new Ho,this._minPtDist=new Ho,this._geom=t||null};Yo.prototype.filter=function(t){this._minPtDist.initialize(),Wo.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Yo.prototype.getMaxPointDistance=function(){return this._maxPtDist},Yo.prototype.interfaces_=function(){return[vi]},Yo.prototype.getClass=function(){return Yo};var Xo=function(t){this._maxPtDist=new Ho,this._minPtDist=new Ho,this._geom=t||null};Xo.prototype.filter=function(t,e){if(0===e)return null;var i=t.getCoordinate(e-1),n=t.getCoordinate(e),r=new Le((i.x+n.x)/2,(i.y+n.y)/2);this._minPtDist.initialize(),Wo.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Xo.prototype.isDone=function(){return!1},Xo.prototype.isGeometryChanged=function(){return!1},Xo.prototype.getMaxPointDistance=function(){return this._maxPtDist},Xo.prototype.interfaces_=function(){return[on]},Xo.prototype.getClass=function(){return Xo};var $o=function(t){this._comps=t||null};$o.prototype.filter=function(t){t instanceof bn&&this._comps.add(t)},$o.prototype.interfaces_=function(){return[rn]},$o.prototype.getClass=function(){return $o},$o.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return $o.getPolygons(t,new Ni)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e instanceof bn?i.add(e):e instanceof sn&&e.apply(new $o(i)),i}};var Jo=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._lines=e,this._isForcedToLineString=i}};Jo.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof Sn){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof vn&&this._lines.add(t)},Jo.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Jo.prototype.interfaces_=function(){return[gi]},Jo.prototype.getClass=function(){return Jo},Jo.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Jo.getLines(t))}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e.getFactory().buildGeometry(Jo.getLines(e,i))}},Jo.getLines=function(){if(1===arguments.length){var t=arguments[0];return Jo.getLines(t,!1)}if(2===arguments.length){if(Fe(arguments[0],Ti)&&Fe(arguments[1],Ti)){for(var e=arguments[0],i=arguments[1],n=e.iterator();n.hasNext();){var r=n.next();Jo.getLines(r,i)}return i}if(arguments[0]instanceof mi&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new Ni;return o.apply(new Jo(a,s)),a}if(arguments[0]instanceof mi&&Fe(arguments[1],Ti)){var l=arguments[0],u=arguments[1];return l instanceof vn?u.add(l):l.apply(new Jo(u)),u}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Fe(arguments[0],Ti)&&Fe(arguments[1],Ti)){for(var c=arguments[0],h=arguments[1],p=arguments[2],d=c.iterator();d.hasNext();){var f=d.next();Jo.getLines(f,h,p)}return h}if("boolean"==typeof arguments[2]&&arguments[0]instanceof mi&&Fe(arguments[1],Ti)){var g=arguments[0],m=arguments[1],_=arguments[2];return g.apply(new Jo(m,_)),m}}};var Qo=function(){if(this._boundaryRule=Ci.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new be("Rule must be non-null");this._boundaryRule=t}};Qo.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof Le&&arguments[1]instanceof bn){var e=arguments[0],i=arguments[1];if(i.isEmpty())return Re.EXTERIOR;var n=i.getExteriorRing(),r=this.locateInPolygonRing(e,n);if(r===Re.EXTERIOR)return Re.EXTERIOR;if(r===Re.BOUNDARY)return Re.BOUNDARY;for(var o=0;o<i.getNumInteriorRing();o++){var s=i.getInteriorRingN(o),a=t.locateInPolygonRing(e,s);if(a===Re.INTERIOR)return Re.EXTERIOR;if(a===Re.BOUNDARY)return Re.BOUNDARY}return Re.INTERIOR}if(arguments[0]instanceof Le&&arguments[1]instanceof vn){var l=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(l))return Re.EXTERIOR;var c=u.getCoordinates();return u.isClosed()||!l.equals(c[0])&&!l.equals(c[c.length-1])?di.isOnLine(l,c)?Re.INTERIOR:Re.EXTERIOR:Re.BOUNDARY}if(arguments[0]instanceof Le&&arguments[1]instanceof xn){var h=arguments[0],p=arguments[1],d=p.getCoordinate();return d.equals2D(h)?Re.INTERIOR:Re.EXTERIOR}},Qo.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?di.locatePointInRing(t,e.getCoordinates()):Re.EXTERIOR},Qo.prototype.intersects=function(t,e){return this.locate(t,e)!==Re.EXTERIOR},Qo.prototype.updateLocationInfo=function(t){t===Re.INTERIOR&&(this._isIn=!0),t===Re.BOUNDARY&&this._numBoundaries++},Qo.prototype.computeLocation=function(t,e){var i=this;if(e instanceof xn&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof vn)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof bn)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof an)for(var n=e,r=0;r<n.getNumGeometries();r++){var o=n.getGeometryN(r);i.updateLocationInfo(i.locateInternal(t,o))}else if(e instanceof Tn)for(var s=e,a=0;a<s.getNumGeometries();a++){var l=s.getGeometryN(a);i.updateLocationInfo(i.locateInternal(t,l))}else if(e instanceof sn)for(var u=new po(e);u.hasNext();){var c=u.next();c!==e&&i.computeLocation(t,c)}},Qo.prototype.locate=function(t,e){return e.isEmpty()?Re.EXTERIOR:e instanceof vn||e instanceof bn?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?Re.BOUNDARY:this._numBoundaries>0||this._isIn?Re.INTERIOR:Re.EXTERIOR)},Qo.prototype.interfaces_=function(){return[]},Qo.prototype.getClass=function(){return Qo};var Zo=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],i=arguments[1];t.call(this,e,t.INSIDE_AREA,i)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._component=n,this._segIndex=r,this._pt=o}},Ko={INSIDE_AREA:{configurable:!0}};Zo.prototype.isInsideArea=function(){return this._segIndex===Zo.INSIDE_AREA},Zo.prototype.getCoordinate=function(){return this._pt},Zo.prototype.getGeometryComponent=function(){return this._component},Zo.prototype.getSegmentIndex=function(){return this._segIndex},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo},Ko.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Zo,Ko);var ts=function(t){this._pts=t||null};ts.prototype.filter=function(t){t instanceof xn&&this._pts.add(t)},ts.prototype.interfaces_=function(){return[rn]},ts.prototype.getClass=function(){return ts},ts.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof xn?Sr.singletonList(t):ts.getPoints(t,new Ni)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e instanceof xn?i.add(e):e instanceof sn&&e.apply(new ts(i)),i}};var es=function(){this._locations=null;var t=arguments[0];this._locations=t};es.prototype.filter=function(t){(t instanceof xn||t instanceof vn||t instanceof bn)&&this._locations.add(new Zo(t,0,t.getCoordinate()))},es.prototype.interfaces_=function(){return[rn]},es.prototype.getClass=function(){return es},es.getLocations=function(t){var e=new Ni;return t.apply(new es(e)),e};var is=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Qo,this._minDistanceLocation=null,this._minDistance=Ee.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=n,this._terminateDistance=r}};is.prototype.computeContainmentDistance=function(){var t=this;if(0===arguments.length){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(2===arguments.length){var i=arguments[0],n=arguments[1],r=1-i,o=$o.getPolygons(this._geom[i]);if(o.size()>0){var s=es.getLocations(this._geom[r]);if(this.computeContainmentDistance(s,o,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[r]=n[0],this._minDistanceLocation[i]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Fe(arguments[0],Ii)&&Fe(arguments[1],Ii)){for(var a=arguments[0],l=arguments[1],u=arguments[2],c=0;c<a.size();c++)for(var h=a.get(c),p=0;p<l.size();p++)if(t.computeContainmentDistance(h,l.get(p),u),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Zo&&arguments[1]instanceof bn){var d=arguments[0],f=arguments[1],g=arguments[2],m=d.getCoordinate();if(Re.EXTERIOR!==this._ptLocator.locate(m,f))return this._minDistance=0,g[0]=d,g[1]=new Zo(f,m),null}},is.prototype.computeMinDistanceLinesPoints=function(t,e,i){for(var n=this,r=0;r<t.size();r++)for(var o=t.get(r),s=0;s<e.size();s++){var a=e.get(s);if(n.computeMinDistance(o,a,i),n._minDistance<=n._terminateDistance)return null}},is.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Jo.getLines(this._geom[0]),i=Jo.getLines(this._geom[1]),n=ts.getPoints(this._geom[0]),r=ts.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(i,n,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(n,r,t),void this.updateMinDistance(t,!1))))},is.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},is.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},is.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},is.prototype.computeMinDistance=function(){var t=this;if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof vn&&arguments[1]instanceof xn){var e=arguments[0],i=arguments[1],n=arguments[2];if(e.getEnvelopeInternal().distance(i.getEnvelopeInternal())>this._minDistance)return null;for(var r=e.getCoordinates(),o=i.getCoordinate(),s=0;s<r.length-1;s++){var a=di.distancePointLine(o,r[s],r[s+1]);if(a<t._minDistance){t._minDistance=a;var l=new Br(r[s],r[s+1]),u=l.closestPoint(o);n[0]=new Zo(e,s,u),n[1]=new Zo(i,0,o)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof vn&&arguments[1]instanceof vn){var c=arguments[0],h=arguments[1],p=arguments[2];if(c.getEnvelopeInternal().distance(h.getEnvelopeInternal())>this._minDistance)return null;for(var d=c.getCoordinates(),f=h.getCoordinates(),g=0;g<d.length-1;g++)for(var m=0;m<f.length-1;m++){var _=di.distanceLineLine(d[g],d[g+1],f[m],f[m+1]);if(_<t._minDistance){t._minDistance=_;var y=new Br(d[g],d[g+1]),v=new Br(f[m],f[m+1]),C=y.closestPoints(v);p[0]=new Zo(c,g,C[0]),p[1]=new Zo(h,m,C[1])}if(t._minDistance<=t._terminateDistance)return null}}},is.prototype.computeMinDistancePoints=function(t,e,i){for(var n=this,r=0;r<t.size();r++)for(var o=t.get(r),s=0;s<e.size();s++){var a=e.get(s),l=o.getCoordinate().distance(a.getCoordinate());if(l<n._minDistance&&(n._minDistance=l,i[0]=new Zo(o,0,o.getCoordinate()),i[1]=new Zo(a,0,a.getCoordinate())),n._minDistance<=n._terminateDistance)return null}},is.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new be("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},is.prototype.computeMinDistanceLines=function(t,e,i){for(var n=this,r=0;r<t.size();r++)for(var o=t.get(r),s=0;s<e.size();s++){var a=e.get(s);if(n.computeMinDistance(o,a,i),n._minDistance<=n._terminateDistance)return null}},is.prototype.interfaces_=function(){return[]},is.prototype.getClass=function(){return is},is.distance=function(t,e){return new is(t,e).distance()},is.isWithinDistance=function(t,e,i){return new is(t,e,i).distance()<=i},is.nearestPoints=function(t,e){return new is(t,e).nearestPoints()};var ns=function(){this._pt=[new Le,new Le],this._distance=Ee.NaN,this._isNull=!0};ns.prototype.getCoordinates=function(){return this._pt},ns.prototype.getCoordinate=function(t){return this._pt[t]},ns.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n<this._distance&&this.initialize(e,i,n)}},ns.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(n),this._distance=r,this._isNull=!1}},ns.prototype.toString=function(){return ri.toLineString(this._pt[0],this._pt[1])},ns.prototype.getDistance=function(){return this._distance},ns.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n>this._distance&&this.initialize(e,i,n)}},ns.prototype.interfaces_=function(){return[]},ns.prototype.getClass=function(){return ns};var rs=function(){};rs.prototype.interfaces_=function(){return[]},rs.prototype.getClass=function(){return rs},rs.computeDistance=function(){if(arguments[2]instanceof ns&&arguments[0]instanceof vn&&arguments[1]instanceof Le)for(var t=arguments[0],e=arguments[1],i=arguments[2],n=new Br,r=t.getCoordinates(),o=0;o<r.length-1;o++){n.setCoordinates(r[o],r[o+1]);var s=n.closestPoint(e);i.setMinimum(s,e)}else if(arguments[2]instanceof ns&&arguments[0]instanceof bn&&arguments[1]instanceof Le){var a=arguments[0],l=arguments[1],u=arguments[2];rs.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)rs.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof ns&&arguments[0]instanceof mi&&arguments[1]instanceof Le){var h=arguments[0],p=arguments[1],d=arguments[2];if(h instanceof vn)rs.computeDistance(h,p,d);else if(h instanceof bn)rs.computeDistance(h,p,d);else if(h instanceof sn)for(var f=h,g=0;g<f.getNumGeometries();g++){var m=f.getGeometryN(g);rs.computeDistance(m,p,d)}else d.setMinimum(h.getCoordinate(),p)}else if(arguments[2]instanceof ns&&arguments[0]instanceof Br&&arguments[1]instanceof Le){var _=arguments[0],y=arguments[1],v=arguments[2],C=_.closestPoint(y);v.setMinimum(C,y)}};var os=function(){this._g0=null,this._g1=null,this._ptDist=new ns,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},ss={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};os.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},os.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new be("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},os.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},os.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},os.prototype.computeOrientedDistance=function(t,e,i){var n=new as(e);if(t.apply(n),i.setMaximum(n.getMaxPointDistance()),this._densifyFrac>0){var r=new ls(e,this._densifyFrac);t.apply(r),i.setMaximum(r.getMaxPointDistance())}},os.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},os.prototype.interfaces_=function(){return[]},os.prototype.getClass=function(){return os},os.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new os(t,e);return i.distance()}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=new os(n,r);return s.setDensifyFraction(o),s.distance()}},ss.MaxPointDistanceFilter.get=function(){return as},ss.MaxDensifiedByFractionDistanceFilter.get=function(){return ls},Object.defineProperties(os,ss);var as=function(){this._maxPtDist=new ns,this._minPtDist=new ns,this._euclideanDist=new rs,this._geom=null;var t=arguments[0];this._geom=t};as.prototype.filter=function(t){this._minPtDist.initialize(),rs.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},as.prototype.getMaxPointDistance=function(){return this._maxPtDist},as.prototype.interfaces_=function(){return[vi]},as.prototype.getClass=function(){return as};var ls=function(){this._maxPtDist=new ns,this._minPtDist=new ns,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};ls.prototype.filter=function(t,e){var i=this;if(0===e)return null;for(var n=t.getCoordinate(e-1),r=t.getCoordinate(e),o=(r.x-n.x)/this._numSubSegs,s=(r.y-n.y)/this._numSubSegs,a=0;a<this._numSubSegs;a++){var l=n.x+a*o,u=n.y+a*s,c=new Le(l,u);i._minPtDist.initialize(),rs.computeDistance(i._geom,c,i._minPtDist),i._maxPtDist.setMaximum(i._minPtDist)}},ls.prototype.isDone=function(){return!1},ls.prototype.isGeometryChanged=function(){return!1},ls.prototype.getMaxPointDistance=function(){return this._maxPtDist},ls.prototype.interfaces_=function(){return[on]},ls.prototype.getClass=function(){return ls};var us=function(t,e,i){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=i||null},cs={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};us.prototype.checkMaximumDistance=function(t,e,i){var n=new os(e,t);if(n.setDensifyFraction(.25),this._maxDistanceFound=n.orientedDistance(),this._maxDistanceFound>i){this._isValid=!1;var r=n.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+ri.toLineString(r[0],r[1])+")"}},us.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=us.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),us.VERBOSE&&Je.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},us.prototype.checkNegativeValid=function(){if(!(this._input instanceof bn||this._input instanceof Tn||this._input instanceof sn))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},us.prototype.getErrorIndicator=function(){return this._errorIndicator},us.prototype.checkMinimumDistance=function(t,e,i){var n=new is(t,e,i);if(this._minDistanceFound=n.distance(),this._minDistanceFound<i){this._isValid=!1;var r=n.nearestPoints();this._errorLocation=n.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+ri.toLineString(r[0],r[1])+" )"}},us.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},us.prototype.getErrorLocation=function(){return this._errorLocation},us.prototype.getPolygonLines=function(t){for(var e=new Ni,i=new Jo(e),n=$o.getPolygons(t).iterator();n.hasNext();){n.next().apply(i)}return t.getFactory().buildGeometry(e)},us.prototype.getErrorMessage=function(){return this._errMsg},us.prototype.interfaces_=function(){return[]},us.prototype.getClass=function(){return us},cs.VERBOSE.get=function(){return!1},cs.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(us,cs);var hs=function(t,e,i){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=i||null},ps={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};hs.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},hs.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*hs.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new Ze(this._input.getEnvelopeInternal());e.expandBy(this._distance);var i=new Ze(this._result.getEnvelopeInternal());i.expandBy(t),i.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(i)),this.report("Envelope")},hs.prototype.checkDistance=function(){var t=new us(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},hs.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},hs.prototype.checkPolygonal=function(){this._result instanceof bn||this._result instanceof Tn||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},hs.prototype.getErrorIndicator=function(){return this._errorIndicator},hs.prototype.getErrorLocation=function(){return this._errorLocation},hs.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},hs.prototype.report=function(t){if(!hs.VERBOSE)return null;Je.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},hs.prototype.getErrorMessage=function(){return this._errorMsg},hs.prototype.interfaces_=function(){return[]},hs.prototype.getClass=function(){return hs},hs.isValidMsg=function(t,e,i){var n=new hs(t,e,i);return n.isValid()?null:n.getErrorMessage()},hs.isValid=function(t,e,i){return!!new hs(t,e,i).isValid()},ps.VERBOSE.get=function(){return!1},ps.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(hs,ps);var ds=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};ds.prototype.getCoordinates=function(){return this._pts},ds.prototype.size=function(){return this._pts.length},ds.prototype.getCoordinate=function(t){return this._pts[t]},ds.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},ds.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:Fr.octant(this.getCoordinate(t),this.getCoordinate(t+1))},ds.prototype.setData=function(t){this._data=t},ds.prototype.getData=function(){return this._data},ds.prototype.toString=function(){return ri.toLineString(new Mn(this._pts))},ds.prototype.interfaces_=function(){return[kr]},ds.prototype.getClass=function(){return ds};var fs=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Ni,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};fs.prototype.getInteriorIntersection=function(){return this._interiorIntersection},fs.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},fs.prototype.getIntersectionSegments=function(){return this._intSegments},fs.prototype.count=function(){return this._intersectionCount},fs.prototype.getIntersections=function(){return this._intersections},fs.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},fs.prototype.setKeepIntersections=function(t){this._keepIntersections=t},fs.prototype.processIntersections=function(t,e,i,n){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===i&&e===n)return null;if(this._isCheckEndSegmentsOnly&&!(this.isEndSegment(t,e)||this.isEndSegment(i,n)))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},fs.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},fs.prototype.hasIntersection=function(){return null!==this._interiorIntersection},fs.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},fs.prototype.interfaces_=function(){return[Co]},fs.prototype.getClass=function(){return fs},fs.createAllIntersectionsFinder=function(t){var e=new fs(t);return e.setFindAllIntersections(!0),e},fs.createAnyIntersectionFinder=function(t){return new fs(t)},fs.createIntersectionCounter=function(t){var e=new fs(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var gs=function(){this._li=new ci,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};gs.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},gs.prototype.getIntersections=function(){return this._segInt.getIntersections()},gs.prototype.isValid=function(){return this.execute(),this._isValid},gs.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},gs.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new fs(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new Yr;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},gs.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new tr(this.getErrorMessage(),this._segInt.getInteriorIntersection())},gs.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+ri.toLineString(t[0],t[1])+" and "+ri.toLineString(t[2],t[3])},gs.prototype.interfaces_=function(){return[]},gs.prototype.getClass=function(){return gs},gs.computeIntersections=function(t){var e=new gs(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var ms=function t(){this._nv=null;var e=arguments[0];this._nv=new gs(t.toSegmentStrings(e))};ms.prototype.checkValid=function(){this._nv.checkValid()},ms.prototype.interfaces_=function(){return[]},ms.prototype.getClass=function(){return ms},ms.toSegmentStrings=function(t){for(var e=new Ni,i=t.iterator();i.hasNext();){var n=i.next();e.add(new ds(n.getCoordinates(),n))}return e},ms.checkValid=function(t){new ms(t).checkValid()};var _s=function(t){this._mapOp=t};_s.prototype.map=function(t){for(var e=new Ni,i=0;i<t.getNumGeometries();i++){var n=this._mapOp.map(t.getGeometryN(i));n.isEmpty()||e.add(n)}return t.getFactory().createGeometryCollection(Un.toGeometryArray(e))},_s.prototype.interfaces_=function(){return[]},_s.prototype.getClass=function(){return _s},_s.map=function(t,e){return new _s(e).map(t)};var ys=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Ni,this._resultLineList=new Ni;var t=arguments[0],e=arguments[1],i=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=i};ys.prototype.collectLines=function(t){for(var e=this,i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var n=i.next();e.collectLineEdge(n,t,e._lineEdgesList),e.collectBoundaryTouchEdge(n,t,e._lineEdgesList)}},ys.prototype.labelIsolatedLine=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,i)},ys.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},ys.prototype.collectLineEdge=function(t,e,i){var n=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Zs.isResultOfOp(n,e)||r.isCovered()||(i.add(r),t.setVisitedEdge(!0)))},ys.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var i=e.next(),n=i.getEdge();if(i.isLineEdge()&&!n.isCoveredSet()){var r=this._op.isCoveredByA(i.getCoordinate());n.setCovered(r)}}},ys.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),n=i.getLabel();i.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(i,0):this.labelIsolatedLine(i,1))}},ys.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var i=e.next(),n=this._geometryFactory.createLineString(i.getCoordinates());this._resultLineList.add(n),i.setInResult(!0)}},ys.prototype.collectBoundaryTouchEdge=function(t,e,i){var n=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(ai.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Zs.isResultOfOp(n,e)&&e===Zs.INTERSECTION&&(i.add(t.getEdge()),t.setVisitedEdge(!0))))},ys.prototype.interfaces_=function(){return[]},ys.prototype.getClass=function(){return ys};var vs=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Ni;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};vs.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var i=this._geometryFactory.createPoint(e);this._resultPointList.add(i)}},vs.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var i=e.next();if(!i.isInResult()&&(!i.isIncidentEdgeInResult()&&(0===i.getEdges().getDegree()||t===Zs.INTERSECTION))){var n=i.getLabel();Zs.isResultOfOp(n,t)&&this.filterCoveredNodeToPoint(i)}}},vs.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},vs.prototype.interfaces_=function(){return[]},vs.prototype.getClass=function(){return vs};var Cs=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Cs.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Cs.prototype.transformPolygon=function(t,e){var i=!0,n=this.transformLinearRing(t.getExteriorRing(),t);null!==n&&n instanceof Sn&&!n.isEmpty()||(i=!1);for(var r=new Ni,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof Sn||(i=!1),r.add(s))}if(i)return this._factory.createPolygon(n,r.toArray([]));var a=new Ni;return null!==n&&a.add(n),a.addAll(r),this._factory.buildGeometry(a)},Cs.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Cs.prototype.getInputGeometry=function(){return this._inputGeom},Cs.prototype.transformMultiLineString=function(t,e){for(var i=new Ni,n=0;n<t.getNumGeometries();n++){var r=this.transformLineString(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Cs.prototype.transformCoordinates=function(t,e){return this.copy(t)},Cs.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Cs.prototype.transformMultiPoint=function(t,e){for(var i=new Ni,n=0;n<t.getNumGeometries();n++){var r=this.transformPoint(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Cs.prototype.transformMultiPolygon=function(t,e){for(var i=new Ni,n=0;n<t.getNumGeometries();n++){var r=this.transformPolygon(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Cs.prototype.copy=function(t){return t.copy()},Cs.prototype.transformGeometryCollection=function(t,e){for(var i=new Ni,n=0;n<t.getNumGeometries();n++){var r=this.transform(t.getGeometryN(n));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||i.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Un.toGeometryArray(i)):this._factory.buildGeometry(i)},Cs.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof xn)return this.transformPoint(t,null);if(t instanceof En)return this.transformMultiPoint(t,null);if(t instanceof Sn)return this.transformLinearRing(t,null);if(t instanceof vn)return this.transformLineString(t,null);if(t instanceof an)return this.transformMultiLineString(t,null);if(t instanceof bn)return this.transformPolygon(t,null);if(t instanceof Tn)return this.transformMultiPolygon(t,null);if(t instanceof sn)return this.transformGeometryCollection(t,null);throw new be("Unknown Geometry subtype: "+t.getClass().getName())},Cs.prototype.transformLinearRing=function(t,e){var i=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===i)return this._factory.createLinearRing(null);var n=i.size();return n>0&&n<4&&!this._preserveType?this._factory.createLineString(i):this._factory.createLinearRing(i)},Cs.prototype.interfaces_=function(){return[]},Cs.prototype.getClass=function(){return Cs};var xs=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Br,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof vn&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1];t.call(this,e.getCoordinates(),i)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this._srcPts=n,this._isClosed=t.isClosed(n),this._snapTolerance=r}};xs.prototype.snapVertices=function(t,e){for(var i=this._isClosed?t.size()-1:t.size(),n=0;n<i;n++){var r=t.get(n),o=this.findSnapForVertex(r,e);null!==o&&(t.set(n,new Le(o)),0===n&&this._isClosed&&t.set(t.size()-1,new Le(o)))}},xs.prototype.findSnapForVertex=function(t,e){for(var i=0;i<e.length;i++){if(t.equals2D(e[i]))return null;if(t.distance(e[i])<this._snapTolerance)return e[i]}return null},xs.prototype.snapTo=function(t){var e=new Di(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},xs.prototype.snapSegments=function(t,e){if(0===e.length)return null;var i=e.length;e[0].equals2D(e[e.length-1])&&(i=e.length-1);for(var n=0;n<i;n++){var r=e[n],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new Le(r),!1)}},xs.prototype.findSegmentIndexToSnap=function(t,e){for(var i=this,n=Ee.MAX_VALUE,r=-1,o=0;o<e.size()-1;o++){if(i._seg.p0=e.get(o),i._seg.p1=e.get(o+1),i._seg.p0.equals2D(t)||i._seg.p1.equals2D(t)){if(i._allowSnappingToSourceVertices)continue;return-1}var s=i._seg.distance(t);s<i._snapTolerance&&s<n&&(n=s,r=o)}return r},xs.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},xs.prototype.interfaces_=function(){return[]},xs.prototype.getClass=function(){return xs},xs.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var ws=function(t){this._srcGeom=t||null},bs={SNAP_PRECISION_FACTOR:{configurable:!0}};ws.prototype.snapTo=function(t,e){var i=this.extractTargetCoordinates(t);return new Es(e,i).transform(this._srcGeom)},ws.prototype.snapToSelf=function(t,e){var i=this.extractTargetCoordinates(this._srcGeom),n=new Es(t,i,!0).transform(this._srcGeom),r=n;return e&&Fe(r,wn)&&(r=n.buffer(0)),r},ws.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},ws.prototype.extractTargetCoordinates=function(t){for(var e=new Zi,i=t.getCoordinates(),n=0;n<i.length;n++)e.add(i[n]);return e.toArray(new Array(0).fill(null))},ws.prototype.computeMinimumSegmentLength=function(t){for(var e=Ee.MAX_VALUE,i=0;i<t.length-1;i++){var n=t[i].distance(t[i+1]);n<e&&(e=n)}return e},ws.prototype.interfaces_=function(){return[]},ws.prototype.getClass=function(){return ws},ws.snap=function(t,e,i){var n=new Array(2).fill(null),r=new ws(t);n[0]=r.snapTo(e,i);var o=new ws(e);return n[1]=o.snapTo(n[0],i),n},ws.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=ws.computeSizeBasedSnapTolerance(t),i=t.getPrecisionModel();if(i.getType()===kn.FIXED){var n=1/i.getScale()*2/1.415;n>e&&(e=n)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(ws.computeOverlaySnapTolerance(r),ws.computeOverlaySnapTolerance(o))}},ws.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*ws.SNAP_PRECISION_FACTOR},ws.snapToSelf=function(t,e,i){return new ws(t).snapToSelf(e,i)},bs.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(ws,bs);var Es=function(t){function e(e,i,n){t.call(this),this._snapTolerance=e||null,this._snapPts=i||null,this._isSelfSnap=void 0!==n&&n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var i=new xs(t,this._snapTolerance);return i.setAllowSnappingToSourceVertices(this._isSelfSnap),i.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var i=t.toCoordinateArray(),n=this.snapLine(i,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Cs),Ss=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Ss.prototype.getCommon=function(){return Ee.longBitsToDouble(this._commonBits)},Ss.prototype.add=function(t){var e=Ee.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Ss.signExpBits(this._commonBits),this._isFirst=!1,null):Ss.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Ss.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Ss.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Ss.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=Ee.longBitsToDouble(t),i=Ee.toBinaryString(t),n="0000000000000000000000000000000000000000000000000000000000000000"+i,r=n.substring(n.length-64),o=r.substring(0,1)+"  "+r.substring(1,12)+"(exp) "+r.substring(12)+" [ "+e+" ]";return o}},Ss.prototype.interfaces_=function(){return[]},Ss.prototype.getClass=function(){return Ss},Ss.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Ss.signExpBits=function(t){return t>>52},Ss.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Ss.numCommonMostSigMantissaBits=function(t,e){for(var i=0,n=52;n>=0;n--){if(Ss.getBit(t,n)!==Ss.getBit(e,n))return i;i++}return 52};var Ts=function(){this._commonCoord=null,this._ccFilter=new As},Ps={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Ts.prototype.addCommonBits=function(t){var e=new Is(this._commonCoord);t.apply(e),t.geometryChanged()},Ts.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new Le(this._commonCoord);e.x=-e.x,e.y=-e.y;var i=new Is(e);return t.apply(i),t.geometryChanged(),t},Ts.prototype.getCommonCoordinate=function(){return this._commonCoord},Ts.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Ts.prototype.interfaces_=function(){return[]},Ts.prototype.getClass=function(){return Ts},Ps.CommonCoordinateFilter.get=function(){return As},Ps.Translater.get=function(){return Is},Object.defineProperties(Ts,Ps);var As=function(){this._commonBitsX=new Ss,this._commonBitsY=new Ss};As.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},As.prototype.getCommonCoordinate=function(){return new Le(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},As.prototype.interfaces_=function(){return[vi]},As.prototype.getClass=function(){return As};var Is=function(){this.trans=null;var t=arguments[0];this.trans=t};Is.prototype.filter=function(t,e){var i=t.getOrdinate(e,0)+this.trans.x,n=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,i),t.setOrdinate(e,1,n)},Is.prototype.isDone=function(){return!1},Is.prototype.isGeometryChanged=function(){return!0},Is.prototype.interfaces_=function(){return[on]},Is.prototype.getClass=function(){return Is};var Ls=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};Ls.prototype.selfSnap=function(t){return new ws(t).snapTo(t,this._snapTolerance)},Ls.prototype.removeCommonBits=function(t){this._cbr=new Ts,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},Ls.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},Ls.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),i=Zs.overlayOp(e[0],e[1],t);return this.prepareResult(i)},Ls.prototype.checkValid=function(t){t.isValid()||Je.out.println("Snapped geometry is invalid")},Ls.prototype.computeSnapTolerance=function(){this._snapTolerance=ws.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Ls.prototype.snap=function(t){var e=this.removeCommonBits(t);return ws.snap(e[0],e[1],this._snapTolerance)},Ls.prototype.interfaces_=function(){return[]},Ls.prototype.getClass=function(){return Ls},Ls.overlayOp=function(t,e,i){return new Ls(t,e).getResultGeometry(i)},Ls.union=function(t,e){return Ls.overlayOp(t,e,Zs.UNION)},Ls.intersection=function(t,e){return Ls.overlayOp(t,e,Zs.INTERSECTION)},Ls.symDifference=function(t,e){return Ls.overlayOp(t,e,Zs.SYMDIFFERENCE)},Ls.difference=function(t,e){return Ls.overlayOp(t,e,Zs.DIFFERENCE)};var Ns=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};Ns.prototype.getResultGeometry=function(t){var e=null,i=!1,n=null;try{e=Zs.overlayOp(this._geom[0],this._geom[1],t);i=!0}catch(t){if(!(t instanceof oi))throw t;n=t}if(!i)try{e=Ls.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof oi?n:t}return e},Ns.prototype.interfaces_=function(){return[]},Ns.prototype.getClass=function(){return Ns},Ns.overlayOp=function(t,e,i){return new Ns(t,e).getResultGeometry(i)},Ns.union=function(t,e){return Ns.overlayOp(t,e,Zs.UNION)},Ns.intersection=function(t,e){return Ns.overlayOp(t,e,Zs.INTERSECTION)},Ns.symDifference=function(t,e){return Ns.overlayOp(t,e,Zs.SYMDIFFERENCE)},Ns.difference=function(t,e){return Ns.overlayOp(t,e,Zs.DIFFERENCE)};var Ms=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};Ms.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},Ms.prototype.interfaces_=function(){return[]},Ms.prototype.getClass=function(){return Ms};var Ds=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],i=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=i}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=n,this._xValue=r,this._obj=o}},Rs={INSERT:{configurable:!0},DELETE:{configurable:!0}};Ds.prototype.isDelete=function(){return this._eventType===Ds.DELETE},Ds.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},Ds.prototype.getObject=function(){return this._obj},Ds.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},Ds.prototype.getInsertEvent=function(){return this._insertEvent},Ds.prototype.isInsert=function(){return this._eventType===Ds.INSERT},Ds.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},Ds.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Ds.prototype.interfaces_=function(){return[Te]},Ds.prototype.getClass=function(){return Ds},Rs.INSERT.get=function(){return 1},Rs.DELETE.get=function(){return 2},Object.defineProperties(Ds,Rs);var Os=function(){};Os.prototype.interfaces_=function(){return[]},Os.prototype.getClass=function(){return Os};var Fs=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],i=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=i};Fs.prototype.isTrivialIntersection=function(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(Fs.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&n===r||0===n&&e===r)return!0}}return!1},Fs.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Fs.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},Fs.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Fs.prototype.isBoundaryPointInternal=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next().getCoordinate();if(t.isIntersection(n))return!0}return!1},Fs.prototype.hasProperIntersection=function(){return this._hasProper},Fs.prototype.hasIntersection=function(){return this._hasIntersection},Fs.prototype.isDone=function(){return this._isDone},Fs.prototype.isBoundaryPoint=function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},Fs.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},Fs.prototype.addIntersections=function(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),i.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Fs.prototype.interfaces_=function(){return[]},Fs.prototype.getClass=function(){return Fs},Fs.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var ks=function(t){function e(){t.call(this),this.events=new Ni,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Sr.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){var t=this;if(1===arguments.length){var e=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var i=0;i<this.events.size();i++){var n=t.events.get(i);if(n.isInsert()&&t.processOverlaps(i,n.getDeleteEventIndex(),n,e),e.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof Fs&&Fe(arguments[0],Ii)&&Fe(arguments[1],Ii)){var r=arguments[0],o=arguments[1],s=arguments[2];this.addEdges(r,r),this.addEdges(o,o),this.computeIntersections(s)}else if("boolean"==typeof arguments[2]&&Fe(arguments[0],Ii)&&arguments[1]instanceof Fs){var a=arguments[0],l=arguments[1],u=arguments[2];u?this.addEdges(a,null):this.addEdges(a),this.computeIntersections(l)}},e.prototype.addEdge=function(t,e){for(var i=t.getMonotoneChainEdge(),n=i.getStartIndexes(),r=0;r<n.length-1;r++){var o=new Ms(i,r),s=new Ds(e,i.getMinX(r),o);this.events.add(s),this.events.add(new Ds(i.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,i,n){for(var r=i.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();i.isSameLabel(s)||(r.computeIntersections(a,n),this.nOverlaps++)}}},e.prototype.addEdges=function(){var t=this;if(1===arguments.length)for(var e=arguments[0],i=e.iterator();i.hasNext();){var n=i.next();t.addEdge(n,n)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.iterator();s.hasNext();){var a=s.next();t.addEdge(a,o)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Os),zs=function(){this._min=Ee.POSITIVE_INFINITY,this._max=Ee.NEGATIVE_INFINITY},Gs={NodeComparator:{configurable:!0}};zs.prototype.getMin=function(){return this._min},zs.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},zs.prototype.getMax=function(){return this._max},zs.prototype.toString=function(){return ri.toLineString(new Le(this._min,0),new Le(this._max,0))},zs.prototype.interfaces_=function(){return[]},zs.prototype.getClass=function(){return zs},Gs.NodeComparator.get=function(){return Bs},Object.defineProperties(zs,Gs);var Bs=function(){};Bs.prototype.compare=function(t,e){var i=t,n=e,r=(i._min+i._max)/2,o=(n._min+n._max)/2;return r<o?-1:r>o?1:0},Bs.prototype.interfaces_=function(){return[Ae]},Bs.prototype.getClass=function(){return Bs};var Us=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],i=arguments[1],n=arguments[2];this._min=e,this._max=i,this._item=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,i){if(!this.intersects(t,e))return null;i.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(zs),Vs=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],i=arguments[1];this._node1=e,this._node2=i,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,i){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,i),null!==this._node2&&this._node2.query(t,e,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(zs),Hs=function(){this._leaves=new Ni,this._root=null,this._level=0};Hs.prototype.buildTree=function(){Sr.sort(this._leaves,new zs.NodeComparator);for(var t=this._leaves,e=null,i=new Ni;;){if(this.buildLevel(t,i),1===i.size())return i.get(0);e=t,t=i,i=e}},Hs.prototype.insert=function(t,e,i){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Us(t,e,i))},Hs.prototype.query=function(t,e,i){this.init(),this._root.query(t,e,i)},Hs.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},Hs.prototype.printNode=function(t){Je.out.println(ri.toLineString(new Le(t._min,this._level),new Le(t._max,this._level)))},Hs.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},Hs.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var i=0;i<t.size();i+=2){var n=t.get(i);if(null===(i+1<t.size()?t.get(i):null))e.add(n);else{var r=new Vs(t.get(i),t.get(i+1));e.add(r)}}},Hs.prototype.interfaces_=function(){return[]},Hs.prototype.getClass=function(){return Hs};var Ws=function(){this._items=new Ni};Ws.prototype.visitItem=function(t){this._items.add(t)},Ws.prototype.getItems=function(){return this._items},Ws.prototype.interfaces_=function(){return[xr]},Ws.prototype.getClass=function(){return Ws};var js=function(){this._index=null;var t=arguments[0];if(!Fe(t,wn))throw new be("Argument must be Polygonal");this._index=new Xs(t)},qs={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};js.prototype.locate=function(t){var e=new pi(t),i=new Ys(e);return this._index.query(t.y,t.y,i),e.getLocation()},js.prototype.interfaces_=function(){return[ho]},js.prototype.getClass=function(){return js},qs.SegmentVisitor.get=function(){return Ys},qs.IntervalIndexedGeometry.get=function(){return Xs},Object.defineProperties(js,qs);var Ys=function(){this._counter=null;var t=arguments[0];this._counter=t};Ys.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},Ys.prototype.interfaces_=function(){return[xr]},Ys.prototype.getClass=function(){return Ys};var Xs=function(){this._index=new Hs;var t=arguments[0];this.init(t)};Xs.prototype.init=function(t){for(var e=Jo.getLines(t).iterator();e.hasNext();){var i=e.next().getCoordinates();this.addLine(i)}},Xs.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var i=new Br(t[e-1],t[e]),n=Math.min(i.p0.y,i.p1.y),r=Math.max(i.p0.y,i.p1.y);this._index.insert(n,r,i)}},Xs.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new Ws;return this._index.query(t,e,i),i.getItems()}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._index.query(n,r,o)}},Xs.prototype.interfaces_=function(){return[]},Xs.prototype.getClass=function(){return Xs};var $s=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new Fn,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Qo,2===arguments.length){var e=arguments[0],i=arguments[1],n=Ci.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=i,this._boundaryNodeRule=n,null!==i&&this.add(i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,i){var n=this._nodes.addNode(i).getLabel(),r=1;n.getLocation(t,$n.ON)===Re.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);n.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],o=new Fs(i,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this._parentGeom instanceof Sn||this._parentGeom instanceof bn||this._parentGeom instanceof Tn,l=n||!a;return s.computeIntersections(this._edges,o,l),this.addSelfIntersectionNodes(this._argIndex),o}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}},e.prototype.computeEdgeIntersections=function(t,e,i){var n=new Fs(e,i,!0);return n.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,n),n},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof xn){var t=arguments[0],e=t.getCoordinate();this.insertPoint(this._argIndex,e,Re.INTERIOR)}else if(arguments[0]instanceof Le){var i=arguments[0];this.insertPoint(this._argIndex,i,Re.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),Re.EXTERIOR,Re.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var i=t.getInteriorRingN(e);this.addPolygonRing(i,Re.INTERIOR,Re.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],Re.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],Re.BOUNDARY)},e.prototype.addLineString=function(t){var e=Ri.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var i=new Ao(e,new rr(this._argIndex,Re.INTERIOR));this._lineEdgeMap.put(t,i),this.insertEdge(i),ai.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),i=0,n=t.iterator();n.hasNext();){var r=n.next();e[i++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,i){if(this.isBoundaryNode(t,e))return null;i===Re.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,i)},e.prototype.addPolygonRing=function(t,e,i){if(t.isEmpty())return null;var n=Ri.removeRepeatedPoints(t.getCoordinates());if(n.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=n[0],null;var r=e,o=i;di.isCCW(n)&&(r=i,o=e);var s=new Ao(n,new rr(this._argIndex,Re.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,n[0],Re.BOUNDARY)},e.prototype.insertPoint=function(t,e,i){var n=this._nodes.addNode(e),r=n.getLabel();null===r?n._label=new rr(t,i):r.setLocation(t,i)},e.prototype.createEdgeSetIntersector=function(){return new ks},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var i=e.next(),n=i.getLabel().getLocation(t),r=i.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,n)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof Tn&&(this._useBoundaryDeterminationRule=!1),e instanceof bn)this.addPolygon(e);else if(e instanceof vn)this.addLineString(e);else if(e instanceof xn)this.addPoint(e);else if(e instanceof En)this.addCollection(e);else if(e instanceof an)this.addCollection(e);else if(e instanceof Tn)this.addCollection(e);else{if(!(e instanceof sn))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}},e.prototype.locate=function(t){return Fe(this._parentGeom,wn)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new js(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?Re.BOUNDARY:Re.INTERIOR},e}(mr),Js=function(){if(this._li=new ci,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new $s(0,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1],n=Ci.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new $s(0,e,n),this._arg[1]=new $s(1,i,n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new $s(0,r,s),this._arg[1]=new $s(1,o,s)}};Js.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Js.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Js.prototype.interfaces_=function(){return[]},Js.prototype.getClass=function(){return Js};var Qs=function(){};Qs.prototype.interfaces_=function(){return[]},Qs.prototype.getClass=function(){return Qs},Qs.map=function(){if(arguments[0]instanceof mi&&Fe(arguments[1],Qs.MapOp)){for(var t=arguments[0],e=arguments[1],i=new Ni,n=0;n<t.getNumGeometries();n++){var r=e.map(t.getGeometryN(n));null!==r&&i.add(r)}return t.getFactory().buildGeometry(i)}if(Fe(arguments[0],Ti)&&Fe(arguments[1],Qs.MapOp)){for(var o=arguments[0],s=arguments[1],a=new Ni,l=o.iterator();l.hasNext();){var u=l.next(),c=s.map(u);null!==c&&a.add(c)}return a}},Qs.MapOp=function(){};var Zs=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i),this._ptLocator=new Qo,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new vo,this._resultPolyList=new Ni,this._resultLineList=new Ni,this._resultPointList=new Ni,this._graph=new mr(new _o),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new rr(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(i),r.add(n),i.merge(n)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),i=e.getSym();e.isInResult()&&i.isInResult()&&(e.setInResult(!1),i.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,i,n,r){var o=new Ni;return o.addAll(t),o.addAll(i),o.addAll(n),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){t.next().getEdges().mergeSymLabels()}},e.prototype.isCovered=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();if(this._ptLocator.locate(t,n)!==Re.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new Ni,e=this._edgeList.iterator();e.hasNext();){var i=e.next();i.isCollapsed()&&(e.remove(),t.add(i.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getEdges().getLabel();e.getLabel().merge(i)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this.insertUniqueEdge(i)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new Ni;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),ms.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var i=new _r(this._geomFact);i.add(this._graph),this._resultPolyList=i.getPolygons();var n=new ys(this,this._geomFact,this._ptLocator);this._resultLineList=n.build(t);var r=new vs(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,i)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var i=e.next();this._graph.addNode(i.getCoordinate()).setLabel(t,i.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var n=i.next(),r=n.getLabel();r.isArea()&&!n.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,$n.RIGHT),r.getLocation(1,$n.RIGHT),t)&&n.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),i=e.getLabel(),n=e.getDepth();if(!n.isNull()){n.normalize();for(var r=0;r<2;r++)i.isNull(r)||!i.isArea()||n.isNull(r)||(0===n.getDelta(r)?i.toLine(r):(ai.isTrue(!n.isNull(r,$n.LEFT),"depth of LEFT side has not been initialized"),i.setLocation(r,$n.LEFT,n.getLocation(r,$n.LEFT)),ai.isTrue(!n.isNull(r,$n.RIGHT),"depth of RIGHT side has not been initialized"),i.setLocation(r,$n.RIGHT,n.getLocation(r,$n.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){t.next().getEdges().computeLabelling(this._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getLabel();e.isIsolated()&&(i.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(i)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Js);Zs.overlayOp=function(t,e,i){return new Zs(t,e).getResultGeometry(i)},Zs.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Zs.createEmptyResult(Zs.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var i=e;return _s.map(t,{interfaces_:function(){return[Qs.MapOp]},map:function(t){return t.intersection(i)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Ns.overlayOp(t,e,Zs.INTERSECTION)},Zs.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Zs.createEmptyResult(Zs.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Ns.overlayOp(t,e,Zs.SYMDIFFERENCE)},Zs.resultDimension=function(t,e,i){var n=e.getDimension(),r=i.getDimension(),o=-1;switch(t){case Zs.INTERSECTION:o=Math.min(n,r);break;case Zs.UNION:o=Math.max(n,r);break;case Zs.DIFFERENCE:o=n;break;case Zs.SYMDIFFERENCE:o=Math.max(n,r)}return o},Zs.createEmptyResult=function(t,e,i,n){var r=null;switch(Zs.resultDimension(t,e,i)){case-1:r=n.createGeometryCollection(new Array(0).fill(null));break;case 0:r=n.createPoint();break;case 1:r=n.createLineString();break;case 2:r=n.createPolygon()}return r},Zs.difference=function(t,e){return t.isEmpty()?Zs.createEmptyResult(Zs.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Ns.overlayOp(t,e,Zs.DIFFERENCE))},Zs.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=t.getLocation(0),n=t.getLocation(1);return Zs.isResultOfOp(i,n,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===Re.BOUNDARY&&(r=Re.INTERIOR),o===Re.BOUNDARY&&(o=Re.INTERIOR),s){case Zs.INTERSECTION:return r===Re.INTERIOR&&o===Re.INTERIOR;case Zs.UNION:return r===Re.INTERIOR||o===Re.INTERIOR;case Zs.DIFFERENCE:return r===Re.INTERIOR&&o!==Re.INTERIOR;case Zs.SYMDIFFERENCE:return r===Re.INTERIOR&&o!==Re.INTERIOR||r!==Re.INTERIOR&&o===Re.INTERIOR}return!1}},Zs.INTERSECTION=1,Zs.UNION=2,Zs.DIFFERENCE=3,Zs.SYMDIFFERENCE=4;var Ks=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Qo,this._seg=new Br;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Ks.prototype.isWithinToleranceOfBoundary=function(t){for(var e=this,i=0;i<this._linework.getNumGeometries();i++)for(var n=e._linework.getGeometryN(i).getCoordinateSequence(),r=0;r<n.size()-1;r++){if(n.getCoordinate(r,e._seg.p0),n.getCoordinate(r+1,e._seg.p1),e._seg.distance(t)<=e._boundaryDistanceTolerance)return!0}return!1},Ks.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?Re.BOUNDARY:this._ptLocator.locate(t,this._g)},Ks.prototype.extractLinework=function(t){var e=new ta;t.apply(e);var i=e.getLinework(),n=Un.toLineStringArray(i);return t.getFactory().createMultiLineString(n)},Ks.prototype.interfaces_=function(){return[]},Ks.prototype.getClass=function(){return Ks};var ta=function(){this._linework=null,this._linework=new Ni};ta.prototype.getLinework=function(){return this._linework},ta.prototype.filter=function(t){if(t instanceof bn){var e=t;this._linework.add(e.getExteriorRing());for(var i=0;i<e.getNumInteriorRing();i++)this._linework.add(e.getInteriorRingN(i))}},ta.prototype.interfaces_=function(){return[rn]},ta.prototype.getClass=function(){return ta};var ea=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};ea.prototype.extractPoints=function(t,e,i){for(var n=t.getCoordinates(),r=0;r<n.length-1;r++)this.computeOffsetPoints(n[r],n[r+1],e,i)},ea.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},ea.prototype.getPoints=function(t){for(var e=new Ni,i=Jo.getLines(this._g).iterator();i.hasNext();){var n=i.next();this.extractPoints(n,t,e)}return e},ea.prototype.computeOffsetPoints=function(t,e,i,n){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=i*r/s,l=i*o/s,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var h=new Le(u-l,c+a);n.add(h)}if(this._doRight){var p=new Le(u+l,c-a);n.add(p)}},ea.prototype.interfaces_=function(){return[]},ea.prototype.getClass=function(){return ea};var ia=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new Ni;var e=arguments[0],i=arguments[1],n=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,i),this._geom=[e,i,n],this._locFinder=[new Ks(this._geom[0],this._boundaryDistanceTolerance),new Ks(this._geom[1],this._boundaryDistanceTolerance),new Ks(this._geom[2],this._boundaryDistanceTolerance)]},na={TOLERANCE:{configurable:!0}};ia.prototype.reportResult=function(t,e,i){Je.out.println("Overlay result invalid - A:"+Re.toLocationSymbol(e[0])+" B:"+Re.toLocationSymbol(e[1])+" expected:"+(i?"i":"e")+" actual:"+Re.toLocationSymbol(e[2]))},ia.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var e=this.checkValid(t);return e},ia.prototype.checkValid=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],i=0;i<this._testCoords.size();i++){var n=t._testCoords.get(i);if(!t.checkValid(e,n))return t._invalidLocation=n,!1}return!0}if(2===arguments.length){var r=arguments[0],o=arguments[1];return this._location[0]=this._locFinder[0].getLocation(o),this._location[1]=this._locFinder[1].getLocation(o),this._location[2]=this._locFinder[2].getLocation(o),!!ia.hasLocation(this._location,Re.BOUNDARY)||this.isValidResult(r,this._location)}},ia.prototype.addTestPts=function(t){var e=new ea(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},ia.prototype.isValidResult=function(t,e){var i=Zs.isResultOfOp(e[0],e[1],t),n=!(i^e[2]===Re.INTERIOR);return n||this.reportResult(t,e,i),n},ia.prototype.getInvalidLocation=function(){return this._invalidLocation},ia.prototype.interfaces_=function(){return[]},ia.prototype.getClass=function(){return ia},ia.hasLocation=function(t,e){for(var i=0;i<3;i++)if(t[i]===e)return!0;return!1},ia.computeBoundaryDistanceTolerance=function(t,e){return Math.min(ws.computeSizeBasedSnapTolerance(t),ws.computeSizeBasedSnapTolerance(e))},ia.isValid=function(t,e,i,n){return new ia(t,e,n).isValid(i)},na.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(ia,na);var ra=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};ra.prototype.extractElements=function(t,e){if(null===t)return null;for(var i=0;i<t.getNumGeometries();i++){var n=t.getGeometryN(i);this._skipEmpty&&n.isEmpty()||e.add(n)}},ra.prototype.combine=function(){for(var t=new Ni,e=this._inputGeoms.iterator();e.hasNext();){var i=e.next();this.extractElements(i,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},ra.prototype.interfaces_=function(){return[]},ra.prototype.getClass=function(){return ra},ra.combine=function(){if(1===arguments.length){var t=arguments[0],e=new ra(t);return e.combine()}if(2===arguments.length){var i=arguments[0],n=arguments[1],r=new ra(ra.createList(i,n));return r.combine()}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=new ra(ra.createList(o,s,a));return l.combine()}},ra.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},ra.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new Ni;return i.add(t),i.add(e),i}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=new Ni;return s.add(n),s.add(r),s.add(o),s}};var oa=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new Ni)},sa={STRTREE_NODE_CAPACITY:{configurable:!0}};oa.prototype.reduceToGeometries=function(t){for(var e=new Ni,i=t.iterator();i.hasNext();){var n=i.next(),r=null;Fe(n,Ii)?r=this.unionTree(n):n instanceof mi&&(r=n),e.add(r)}return e},oa.prototype.extractByEnvelope=function(t,e,i){for(var n=new Ni,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?n.add(o):i.add(o)}return this._geomFactory.buildGeometry(n)},oa.prototype.unionOptimized=function(t,e){var i=t.getEnvelopeInternal(),n=e.getEnvelopeInternal();if(!i.intersects(n))return ra.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=i.intersection(n);return this.unionUsingEnvelopeIntersection(t,e,r)},oa.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new Nr(oa.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var i=e.next();t.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var n=t.itemsTree();return this.unionTree(n)},oa.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2];if(n-i<=1){var r=oa.getGeometry(e,i);return this.unionSafe(r,null)}if(n-i==2)return this.unionSafe(oa.getGeometry(e,i),oa.getGeometry(e,i+1));var o=Math.trunc((n+i)/2),s=this.binaryUnion(e,i,o),a=this.binaryUnion(e,o,n);return this.unionSafe(s,a)}},oa.prototype.repeatedUnion=function(t){for(var e=null,i=t.iterator();i.hasNext();){var n=i.next();e=null===e?n.copy():e.union(n)}return e},oa.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},oa.prototype.unionActual=function(t,e){return oa.restrictToPolygons(t.union(e))},oa.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},oa.prototype.unionUsingEnvelopeIntersection=function(t,e,i){var n=new Ni,r=this.extractByEnvelope(i,t,n),o=this.extractByEnvelope(i,e,n),s=this.unionActual(r,o);return n.add(s),ra.combine(n)},oa.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0],e=t.get(0).getFactory(),i=e.buildGeometry(t),n=i.buffer(0);return n}if(2===arguments.length){var r=arguments[0],o=arguments[1],s=r.getFactory(),a=s.createGeometryCollection([r,o]),l=a.buffer(0);return l}},oa.prototype.interfaces_=function(){return[]},oa.prototype.getClass=function(){return oa},oa.restrictToPolygons=function(t){if(Fe(t,wn))return t;var e=$o.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(Un.toPolygonArray(e))},oa.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},oa.union=function(t){return new oa(t).union()},sa.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(oa,sa);var aa=function(){};function la(){return new ua}function ua(){this.reset()}aa.prototype.interfaces_=function(){return[]},aa.prototype.getClass=function(){return aa},aa.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Zs.createEmptyResult(Zs.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Ns.overlayOp(t,e,Zs.UNION)},ua.prototype={constructor:ua,reset:function(){this.s=this.t=0},add:function(t){ha(ca,t,this.t),ha(this,ca.s,this.s),this.s?this.t+=ca.t:this.s=ca.t},valueOf:function(){return this.s}};var ca=new ua;function ha(t,e,i){var n=t.s=e+i,r=n-e,o=n-r;t.t=e-o+(i-r)}var pa=1e-6,da=Math.PI,fa=da/2,ga=da/4,ma=2*da,_a=180/da,ya=da/180,va=Math.abs,Ca=Math.atan,xa=Math.atan2,wa=Math.cos,ba=Math.sin,Ea=Math.sqrt;function Sa(t){return t>1?0:t<-1?da:Math.acos(t)}function Ta(t){return t>1?fa:t<-1?-fa:Math.asin(t)}function Pa(){}function Aa(t,e){t&&Ma.hasOwnProperty(t.type)&&Ma[t.type](t,e)}var Ia,La,Na={Feature:function(t,e){Aa(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)Aa(i[n].geometry,e)}},Ma={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Da(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Da(i[n],e,0)},Polygon:function(t,e){Ra(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Ra(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)Aa(i[n],e)}};function Da(t,e,i){var n,r=-1,o=t.length-i;for(e.lineStart();++r<o;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function Ra(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)Da(t[i],e,1);e.polygonEnd()}function Oa(t){return[xa(t[1],t[0]),Ta(t[2])]}function Fa(t){var e=t[0],i=t[1],n=wa(i);return[n*wa(e),n*ba(e),ba(i)]}function ka(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function za(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ga(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ba(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Ua(t){var e=Ea(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Va(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i}function Ha(t,e){return[t>da?t-ma:t<-da?t+ma:t,e]}function Wa(t){return function(e,i){return[(e+=t)>da?e-ma:e<-da?e+ma:e,i]}}function ja(t){var e=Wa(t);return e.invert=Wa(-t),e}function qa(t,e){var i=wa(t),n=ba(t),r=wa(e),o=ba(e);function s(t,e){var s=wa(e),a=wa(t)*s,l=ba(t)*s,u=ba(e),c=u*i+a*n;return[xa(l*r-c*o,a*i-u*n),Ta(c*r+l*o)]}return s.invert=function(t,e){var s=wa(e),a=wa(t)*s,l=ba(t)*s,u=ba(e),c=u*r-l*o;return[xa(l*r+u*o,a*i+c*n),Ta(c*i-a*n)]},s}function Ya(t,e){(e=Fa(e))[0]-=t,Ua(e);var i=Sa(-e[1]);return((-e[2]<0?-i:i)+ma-pa)%ma}function Xa(){var t,e=[];return{point:function(e,i){t.push([e,i])},lineStart:function(){e.push(t=[])},lineEnd:Pa,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function $a(t,e){return va(t[0]-e[0])<pa&&va(t[1]-e[1])<pa}function Ja(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function Qa(t,e,i,n,r){var o,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,n=t[0],s=t[e];if($a(n,s)){for(r.lineStart(),o=0;o<e;++o)r.point((n=t[o])[0],n[1]);r.lineEnd()}else a.push(i=new Ja(n,t,null,!0)),l.push(i.o=new Ja(n,null,i,!1)),a.push(i=new Ja(s,t,null,!1)),l.push(i.o=new Ja(s,null,i,!0))}})),a.length){for(l.sort(e),Za(a),Za(l),o=0,s=l.length;o<s;++o)l[o].e=i=!i;for(var u,c,h=a[0];;){for(var p=h,d=!0;p.v;)if((p=p.n)===h)return;u=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(d)for(o=0,s=u.length;o<s;++o)r.point((c=u[o])[0],c[1]);else n(p.x,p.n.x,1,r);p=p.n}else{if(d)for(u=p.p.z,o=u.length-1;o>=0;--o)r.point((c=u[o])[0],c[1]);else n(p.x,p.p.x,-1,r);p=p.p}u=(p=p.o).z,d=!d}while(!p.v);r.lineEnd()}}}function Za(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function Ka(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function tl(t){for(var e,i,n,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(i=new Array(s);--r>=0;)for(e=(n=t[r]).length;--e>=0;)i[--s]=n[e];return i}la(),la(),la(),Ha.invert=Ha,1===(Ia=Ka).length&&(La=Ia,Ia=function(t,e){return Ka(La(t),e)});var el=1e9,il=-el;function nl(t,e,i,n){function r(r,o){return t<=r&&r<=i&&e<=o&&o<=n}function o(r,o,a,u){var c=0,h=0;if(null==r||(c=s(r,a))!==(h=s(o,a))||l(r,o)<0^a>0)do{u.point(0===c||3===c?t:i,c>1?n:e)}while((c=(c+a+4)%4)!==h);else u.point(o[0],o[1])}function s(n,r){return va(n[0]-t)<pa?r>0?0:3:va(n[0]-i)<pa?r>0?2:1:va(n[1]-e)<pa?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var i=s(t,1),n=s(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(s){var l,u,c,h,p,d,f,g,m,_,y,v=s,C=Xa(),x={point:w,lineStart:function(){x.point=b,u&&u.push(c=[]);_=!0,m=!1,f=g=NaN},lineEnd:function(){l&&(b(h,p),d&&m&&C.rejoin(),l.push(C.result()));x.point=w,m&&v.lineEnd()},polygonStart:function(){v=C,l=[],u=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,r=u.length;i<r;++i)for(var o,s,a=u[i],l=1,c=a.length,h=a[0],p=h[0],d=h[1];l<c;++l)o=p,s=d,p=(h=a[l])[0],d=h[1],s<=n?d>n&&(p-o)*(n-s)>(d-s)*(t-o)&&++e:d<=n&&(p-o)*(n-s)<(d-s)*(t-o)&&--e;return e}(),i=y&&e,r=(l=tl(l)).length;(i||r)&&(s.polygonStart(),i&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&Qa(l,a,e,o,s),s.polygonEnd());v=s,l=u=c=null}};function w(t,e){r(t,e)&&v.point(t,e)}function b(o,s){var a=r(o,s);if(u&&c.push([o,s]),_)h=o,p=s,d=a,_=!1,a&&(v.lineStart(),v.point(o,s));else if(a&&m)v.point(o,s);else{var l=[f=Math.max(il,Math.min(el,f)),g=Math.max(il,Math.min(el,g))],C=[o=Math.max(il,Math.min(el,o)),s=Math.max(il,Math.min(el,s))];!function(t,e,i,n,r,o){var s,a=t[0],l=t[1],u=0,c=1,h=e[0]-a,p=e[1]-l;if(s=i-a,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>u&&(u=s)}if(s=r-a,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<c&&(c=s)}if(s=n-l,p||!(s>0)){if(s/=p,p<0){if(s<u)return;s<c&&(c=s)}else if(p>0){if(s>c)return;s>u&&(u=s)}if(s=o-l,p||!(s<0)){if(s/=p,p<0){if(s>c)return;s>u&&(u=s)}else if(p>0){if(s<u)return;s<c&&(c=s)}return u>0&&(t[0]=a+u*h,t[1]=l+u*p),c<1&&(e[0]=a+c*h,e[1]=l+c*p),!0}}}}}(l,C,t,e,i,n)?a&&(v.lineStart(),v.point(o,s),y=!1):(m||(v.lineStart(),v.point(l[0],l[1])),v.point(C[0],C[1]),a||v.lineEnd(),y=!1)}f=o,g=s,m=a}return x}}var rl=la();function ol(t){return t}la(),la(),la();var sl=1/0,al=sl,ll=-sl,ul=ll,cl={point:function(t,e){t<sl&&(sl=t);t>ll&&(ll=t);e<al&&(al=e);e>ul&&(ul=e)},lineStart:Pa,lineEnd:Pa,polygonStart:Pa,polygonEnd:Pa,result:function(){var t=[[sl,al],[ll,ul]];return ll=ul=-(al=sl=1/0),t}};function hl(t,e,i,n){return function(r,o){var s,a,l,u=e(o),c=r.invert(n[0],n[1]),h=Xa(),p=e(h),d=!1,f={point:g,lineStart:_,lineEnd:y,polygonStart:function(){f.point=v,f.lineStart=C,f.lineEnd=x,a=[],s=[]},polygonEnd:function(){f.point=g,f.lineStart=_,f.lineEnd=y,a=tl(a);var t=function(t,e){var i=e[0],n=e[1],r=[ba(i),-wa(i),0],o=0,s=0;rl.reset();for(var a=0,l=t.length;a<l;++a)if(c=(u=t[a]).length)for(var u,c,h=u[c-1],p=h[0],d=h[1]/2+ga,f=ba(d),g=wa(d),m=0;m<c;++m,p=y,f=C,g=x,h=_){var _=u[m],y=_[0],v=_[1]/2+ga,C=ba(v),x=wa(v),w=y-p,b=w>=0?1:-1,E=b*w,S=E>da,T=f*C;if(rl.add(xa(T*b*ba(E),g*x+T*wa(E))),o+=S?w+b*ma:w,S^p>=i^y>=i){var P=za(Fa(h),Fa(_));Ua(P);var A=za(r,P);Ua(A);var I=(S^w>=0?-1:1)*Ta(A[2]);(n>I||n===I&&(P[0]||P[1]))&&(s+=S^w>=0?1:-1)}}return(o<-pa||o<pa&&rl<-pa)^1&s}(s,c);a.length?(d||(o.polygonStart(),d=!0),Qa(a,dl,t,i,o)):t&&(d||(o.polygonStart(),d=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),d&&(o.polygonEnd(),d=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function g(e,i){var n=r(e,i);t(e=n[0],i=n[1])&&o.point(e,i)}function m(t,e){var i=r(t,e);u.point(i[0],i[1])}function _(){f.point=m,u.lineStart()}function y(){f.point=g,u.lineEnd()}function v(t,e){l.push([t,e]);var i=r(t,e);p.point(i[0],i[1])}function C(){p.lineStart(),l=[]}function x(){v(l[0][0],l[0][1]),p.lineEnd();var t,e,i,n,r=p.clean(),u=h.result(),c=u.length;if(l.pop(),s.push(l),l=null,c)if(1&r){if((e=(i=u[0]).length-1)>0){for(d||(o.polygonStart(),d=!0),o.lineStart(),t=0;t<e;++t)o.point((n=i[t])[0],n[1]);o.lineEnd()}}else c>1&&2&r&&u.push(u.pop().concat(u.shift())),a.push(u.filter(pl))}return f}}function pl(t){return t.length>1}function dl(t,e){return((t=t.x)[0]<0?t[1]-fa-pa:fa-t[1])-((e=e.x)[0]<0?e[1]-fa-pa:fa-e[1])}la();var fl=hl((function(){return!0}),(function(t){var e,i=NaN,n=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?da:-da,l=va(o-i);va(l-da)<pa?(t.point(i,n=(n+s)/2>0?fa:-fa),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(o,n),e=0):r!==a&&l>=da&&(va(i-r)<pa&&(i-=r*pa),va(o-a)<pa&&(o-=a*pa),n=function(t,e,i,n){var r,o,s=ba(t-i);return va(s)>pa?Ca((ba(e)*(o=wa(n))*ba(i)-ba(n)*(r=wa(e))*ba(t))/(r*o*s)):(e+n)/2}(i,n,o,s),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),e=0),t.point(i=o,n=s),r=a},lineEnd:function(){t.lineEnd(),i=n=NaN},clean:function(){return 2-e}}}),(function(t,e,i,n){var r;if(null==t)r=i*fa,n.point(-da,r),n.point(0,r),n.point(da,r),n.point(da,0),n.point(da,-r),n.point(0,-r),n.point(-da,-r),n.point(-da,0),n.point(-da,r);else if(va(t[0]-e[0])>pa){var o=t[0]<e[0]?da:-da;r=i*o/2,n.point(-o,r),n.point(0,r),n.point(o,r)}else n.point(e[0],e[1])}),[-da,-fa]);function gl(t,e){var i=wa(t),n=i>0,r=va(i)>pa;function o(t,e){return wa(t)*wa(e)>i}function s(t,e,n){var r=[1,0,0],o=za(Fa(t),Fa(e)),s=ka(o,o),a=o[0],l=s-a*a;if(!l)return!n&&t;var u=i*s/l,c=-i*a/l,h=za(r,o),p=Ba(r,u);Ga(p,Ba(o,c));var d=h,f=ka(p,d),g=ka(d,d),m=f*f-g*(ka(p,p)-1);if(!(m<0)){var _=Ea(m),y=Ba(d,(-f-_)/g);if(Ga(y,p),y=Oa(y),!n)return y;var v,C=t[0],x=e[0],w=t[1],b=e[1];x<C&&(v=C,C=x,x=v);var E=x-C,S=va(E-da)<pa;if(!S&&b<w&&(v=w,w=b,b=v),S||E<pa?S?w+b>0^y[1]<(va(y[0]-C)<pa?w:b):w<=y[1]&&y[1]<=b:E>da^(C<=y[0]&&y[0]<=x)){var T=Ba(d,(-f+_)/g);return Ga(T,p),[y,Oa(T)]}}}function a(e,i){var r=n?t:da-t,o=0;return e<-r?o|=1:e>r&&(o|=2),i<-r?o|=4:i>r&&(o|=8),o}return hl(o,(function(t){var e,i,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,p){var d,f=[h,p],g=o(h,p),m=n?g?0:a(h,p):g?a(h+(h<0?da:-da),p):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(!(d=s(e,f))||$a(e,d)||$a(f,d))&&(f[0]+=pa,f[1]+=pa,g=o(f[0],f[1])),g!==l)c=0,g?(t.lineStart(),d=s(f,e),t.point(d[0],d[1])):(d=s(e,f),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(r&&e&&n^g){var _;m&i||!(_=s(f,e,!0))||(c=0,n?(t.lineStart(),t.point(_[0][0],_[0][1]),t.point(_[1][0],_[1][1]),t.lineEnd()):(t.point(_[1][0],_[1][1]),t.lineEnd(),t.lineStart(),t.point(_[0][0],_[0][1])))}!g||e&&$a(e,f)||t.point(f[0],f[1]),e=f,l=g,i=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(i,n,r,o){!function(t,e,i,n,r,o){if(i){var s=wa(e),a=ba(e),l=n*i;null==r?(r=e+n*ma,o=e-l/2):(r=Ya(s,r),o=Ya(s,o),(n>0?r<o:r>o)&&(r+=n*ma));for(var u,c=r;n>0?c>o:c<o;c-=l)u=Oa([s,-a*wa(c),-a*ba(c)]),t.point(u[0],u[1])}}(o,t,e,r,i,n)}),n?[0,-t]:[-da,t-da])}function ml(t){return function(e){var i=new _l;for(var n in t)i[n]=t[n];return i.stream=e,i}}function _l(){}function yl(t,e,i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),function(t,e){t&&Na.hasOwnProperty(t.type)?Na[t.type](t,e):Aa(t,e)}(i,t.stream(cl));var s=cl.result(),a=Math.min(n/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),l=+e[0][0]+(n-a*(s[1][0]+s[0][0]))/2,u=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([l,u])}_l.prototype={constructor:_l,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var vl=wa(30*ya);function Cl(t,e){return+e?function(t,e){function i(n,r,o,s,a,l,u,c,h,p,d,f,g,m){var _=u-n,y=c-r,v=_*_+y*y;if(v>4*e&&g--){var C=s+p,x=a+d,w=l+f,b=Ea(C*C+x*x+w*w),E=Ta(w/=b),S=va(va(w)-1)<pa||va(o-h)<pa?(o+h)/2:xa(x,C),T=t(S,E),P=T[0],A=T[1],I=P-n,L=A-r,N=y*I-_*L;(N*N/v>e||va((_*I+y*L)/v-.5)>.3||s*p+a*d+l*f<vl)&&(i(n,r,o,s,a,l,P,A,S,C/=b,x/=b,w,g,m),m.point(P,A),i(P,A,S,C,x,w,u,c,h,p,d,f,g,m))}}return function(e){var n,r,o,s,a,l,u,c,h,p,d,f,g={point:m,lineStart:_,lineEnd:v,polygonStart:function(){e.polygonStart(),g.lineStart=C},polygonEnd:function(){e.polygonEnd(),g.lineStart=_}};function m(i,n){i=t(i,n),e.point(i[0],i[1])}function _(){c=NaN,g.point=y,e.lineStart()}function y(n,r){var o=Fa([n,r]),s=t(n,r);i(c,h,u,p,d,f,c=s[0],h=s[1],u=n,p=o[0],d=o[1],f=o[2],16,e),e.point(c,h)}function v(){g.point=m,e.lineEnd()}function C(){_(),g.point=x,g.lineEnd=w}function x(t,e){y(n=t,e),r=c,o=h,s=p,a=d,l=f,g.point=y}function w(){i(c,h,u,p,d,f,r,o,n,s,a,l,16,e),g.lineEnd=v,v()}return g}}(t,e):function(t){return ml({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var xl=ml({point:function(t,e){this.stream.point(t*ya,e*ya)}});function wl(t){return function(t){var e,i,n,r,o,s,a,l,u,c,h=150,p=480,d=250,f=0,g=0,m=0,_=0,y=0,v=null,C=fl,x=null,w=ol,b=.5,E=Cl(P,b);function S(t){return[(t=o(t[0]*ya,t[1]*ya))[0]*h+i,n-t[1]*h]}function T(t){return(t=o.invert((t[0]-i)/h,(n-t[1])/h))&&[t[0]*_a,t[1]*_a]}function P(t,r){return[(t=e(t,r))[0]*h+i,n-t[1]*h]}function A(){o=Va(r=function(t,e,i){return(t%=ma)?e||i?Va(ja(t),qa(e,i)):ja(t):e||i?qa(e,i):Ha}(m,_,y),e);var t=e(f,g);return i=p-t[0]*h,n=d+t[1]*h,I()}function I(){return u=c=null,S}return S.stream=function(t){return u&&c===t?u:u=xl(C(r,E(w(c=t))))},S.clipAngle=function(t){return arguments.length?(C=+t?gl(v=t*ya,6*ya):(v=null,fl),I()):v*_a},S.clipExtent=function(t){return arguments.length?(w=null==t?(x=s=a=l=null,ol):nl(x=+t[0][0],s=+t[0][1],a=+t[1][0],l=+t[1][1]),I()):null==x?null:[[x,s],[a,l]]},S.scale=function(t){return arguments.length?(h=+t,A()):h},S.translate=function(t){return arguments.length?(p=+t[0],d=+t[1],A()):[p,d]},S.center=function(t){return arguments.length?(f=t[0]%360*ya,g=t[1]%360*ya,A()):[f*_a,g*_a]},S.rotate=function(t){return arguments.length?(m=t[0]%360*ya,_=t[1]%360*ya,y=t.length>2?t[2]%360*ya:0,A()):[m*_a,_*_a,y*_a]},S.precision=function(t){return arguments.length?(E=Cl(P,b=t*t),I()):Ea(b)},S.fitExtent=function(t,e){return yl(S,t,e)},S.fitSize=function(t,e){return function(t,e,i){return yl(t,[[0,0],e],i)}(S,t,e)},function(){return e=t.apply(this,arguments),S.invert=e.invert&&T,A()}}((function(){return t}))()}function bl(t){return function(e,i){var n=wa(e),r=wa(i),o=t(n*r);return[o*r*ba(e),o*ba(i)]}}function El(t){return function(e,i){var n=Ea(e*e+i*i),r=t(n),o=ba(r),s=wa(r);return[xa(e*o,n*s),Ta(n&&i*o/n)]}}bl((function(t){return Ea(2/(1+t))})).invert=El((function(t){return 2*Ta(t/2)}));var Sl=bl((function(t){return(t=Sa(t))&&t/ba(t)}));function Tl(){return wl(Sl).scale(79.4188).clipAngle(179.999)}function Pl(t,e){return[t,e]}function Al(t,e,i){var n=(i=i||{}).units||"kilometers",r=i.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof i)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");var o=[];switch(t.type){case"GeometryCollection":return C(t,(function(t){var i=Il(t,e,n,r);i&&o.push(i)})),a(o);case"FeatureCollection":return v(t,(function(t){var i=Il(t,e,n,r);i&&v(i,(function(t){t&&o.push(t)}))})),a(o)}return Il(t,e,n,r)}function Il(t,i,o,s){var l=t.properties||{},h="Feature"===t.type?t.geometry:t;if("GeometryCollection"===h.type){var p=[];return C(t,(function(t){var e=Il(t,i,o,s);e&&p.push(e)})),a(p)}var d=function(t){var i=function(t,e){void 0===e&&(e={});var i=P(t);return r([(i[0]+i[2])/2,(i[1]+i[3])/2],e.properties,e)}(t).geometry.coordinates,n=[-i[0],-i[1]];return Tl().rotate(n).scale(e)}(h),f={type:h.type,coordinates:Nl(h.coordinates,d)},g=(new Yn).read(f),m=u(c(i,o),"meters"),_=Uo.bufferOp(g,m,s);if(!Ll((_=(new Xn).write(_)).coordinates))return n({type:_.type,coordinates:Ml(_.coordinates,d)},l)}function Ll(t){return Array.isArray(t[0])?Ll(t[0]):isNaN(t[0])}function Nl(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return Nl(t,e)}))}function Ml(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return Ml(t,e)}))}function Dl(t,e,i){void 0===i&&(i={});var n=m(t),r=m(e),s=xe.union(n.coordinates,r.coordinates);return 0===s.length?null:1===s.length?o(s[0],i.properties):l(s,i.properties)}function Rl(t,e,i){void 0===i&&(i={});var n=m(t),r=m(e),s=xe.intersection(n.coordinates,r.coordinates);return 0===s.length?null:1===s.length?o(s[0],i.properties):l(s,i.properties)}Sl.invert=El((function(t){return t})),Pl.invert=Pl;let Ol=class extends Error{constructor(t){super(t),this.name="CesiumProError"}};function Fl(t,e){return null!=t?t:e}function kl(t){return null!=t}Ol.throwInstantiationError=function(){throw new DeveloperError("This function defines an interface and should not be called directly.")},Ol.throwNoInstance=function(){throw new Ol("它的定义了一个接口，不能被以直接调用.")};class zl{constructor(t,e,i){if(!kl(t))throw new Ol("longitude is required.");if(!kl(e))throw new Ol("latitude is required.");this.lon=t,this.lat=e,this.alt=Fl(i,0)}get height(){return this.alt}toPixel(t){return zl.toPixel(this,t)}toCartesian(){return zl.toCartesian(this)}toCartographic(){return zl.toCartographic(this)}getRadias(){return{lon:Cesium.Math.toRadians(this.lon),lat:Cesium.Math.toRadians(this.lat),alt:alt}}isVisible(t){return zl.isVisible(this,t)}toString(){return`{lon: ${this.lon}, lat: ${this.lat}, alt: ${this.alt}}`}toJson(){return{lon:this.lon,lat:this.lat,alt:this.alt}}toArray(){return[this.lon,this.lat,this.alt]}static isVisible(t,e){if(e instanceof Cesium.Viewer==!1)throw new Ol("viewer不是一个有效的Cesium.Viewer对象");if(!kl(t))return!1;const i=zl.toCartesian(t);if(!i)return!1;if(e.scene.mode===Cesium.SceneMode.SCENE3D){if(!new Cesium.EllipsoidalOccluder(Cesium.Ellipsoid.WGS84,e.camera.position).isPointVisible(i))return!1;const n=zl.toPixel(t,e.scene);if(!kl(n))return!1;const r=e.canvas.width||e.canvas.clientWidth,o=e.canvas.height||e.canvas.clientHeight;return n.x>0&&n.x<r&&n.y>0&&n.y<o}if(e.scene.mode===Cesium.SceneMode.SCENE2D){const t=e.scene.camera.frustum,{positionWC:n,directionWC:r,upWC:o}=e.scene.camera,s=t.computeCullingVolume(n,r,o),a=Cesium.BoundingSphere.projectTo2D(new BoundingSphere(i,1)),l=s.computeVisibility(a);return l===Cesium.Intersect.INSIDE||l===Cesium.Intersect.INERSECTING}}static toPixel(t,e){if(!kl(e))throw new Ol("scene未定义。");if(!kl(t))return;const i=zl.toCartesian(t);return kl(i)?Cesium.SceneTransforms.wgs84ToWindowCoordinates(e,i):void 0}static toCartographic(t,e){if(!kl(t))throw new Ol("point is not defined.");if(t instanceof zl)return Cesium.Cartographic.fromDegrees(t.lon,t.lat,t.alt);if(t instanceof Cesium.Cartesian3)return Cesium.Cartographic.fromCartesian(t);if(t instanceof Cesium.Cartographic)return t;if(t instanceof Cesium.Cartesian2){const i=zl.toCartesian(t,e);return zl.toCartographic(i)}}static toCartesian(t,e){if(kl(t)){if(t instanceof Cesium.Cartesian3)return t;if(t instanceof Cesium.Cartographic)return Cesium.Cartographic.toCartesian(t);if(t instanceof zl)return Cesium.Cartesian3.fromDegrees(t.lon,t.lat,t.alt);if(t instanceof Cesium.Cartesian2){if(!e)return;const i=e.scene.camera.getPickRay(t);return e.scene.globe.pick(i,e.scene)}}}static fromCartesian(t){if(!kl(t))return;const e=Cesium.Cartographic.fromCartesian(t);return kl(e)?zl.fromCartographic(e):void 0}static fromCartographic(t){if(!kl(t))throw new Ol("cartographic is not defined.");return new zl(Cesium.Math.toDegrees(t.longitude),Cesium.Math.toDegrees(t.latitude),t.height)}static fromPixel(t,e){if(!e.scene.globe)return;if(!kl(t))throw new Ol("pixel is not defined.");if(e instanceof Cesium.Viewer==!1)throw new Ol("viewer不是一个有效的Cesium.Viewer对象");const i=e.scene.camera.getPickRay(t),n=e.scene.globe.pick(i,e.scene);return kl(n)?zl.fromCartesian(n):void 0}static fromDegrees(t,e,i){return new zl(t,e,i)}static fromDegreesArray(t){const e=[];for(let i=0,n=t.length;i<n;i+=2)e.push(new zl(t[i],t[i+1]));return e}static fromDegreesArrayHeights(t){const e=[];for(let i=0,n=t.length;i<n;i+=3)e.push(new zl(t[i],t[i+1],t[i+2]));return e}static fromRadians(t,e,i){return new zl(Cesium.Math.toDegrees(t),Cesium.Math.toDegrees(e),i)}static inChina(...t){if(1!==t.length){const e=+t[0],i=+t[1];return e>73.66&&e<135.05&&i>3.86&&i<53.55}{const e=t[0];if(t[0]instanceof zl)return zl.inChina(e.lon,e.lat)}}static fromArray(t){return new zl(...t)}static fromJson(t){return new zl(t.lon,t.lat,t.alt)}static isValid(t){return t instanceof zl?!!kl(t.lon)&&(!!kl(t.lat)&&!!kl(t.alt)):t instanceof Cesium.Cartesian3&&(!!kl(t.x)&&(!!kl(t.y)&&!!kl(t.z)))}}const{Cartographic:Gl,Cartesian3:Bl}=Cesium;function Ul(t){if(t.length<2)return t;const e=t[0],i=t[t.length-1];return e.lon==i.lon&&e.lat==i.lat||t.push(e),t}const Vl={};function Hl(t){if(!(t&&t instanceof Cesium.Viewer)){throw new Ol(`Expected viewer to be typeof Viewer, actual typeof was ${typeof t}`)}}function Wl(t,e){return e-t}Vl.lineChunk=function(t,e,i={}){try{return T(s(t.map((t=>[t.lon,t.lat]))),e,i)}catch(t){throw new Ol("计算错误",t)}},Vl.polygonToGrid=function(t,e,i={}){const n=o([(t=Ul(t)).map((t=>[t.lon,t.lat]))]),r=P(n);return i.mask=n,W(r,e,i)},Vl.polygonToVoronoi=function(t,e,i={}){const n=o([(t=Ul(t)).map((t=>[t.lon,t.lat]))]),r=P(n);i.mask=n;return Lt(W(r,e,i),{bbox:r})},Vl.triangleGrid=function(t,e,i={}){const n=o([(t=Ul(t)).map((t=>[t.lon,t.lat]))]),r=P(n);return i.mask=n,function(t,e,i){void 0===i&&(i={});for(var n=[],r=e/_([t[0],t[1]],[t[2],t[1]],i)*(t[2]-t[0]),s=e/_([t[0],t[1]],[t[0],t[3]],i)*(t[3]-t[1]),l=0,u=t[0];u<=t[2];){for(var c=0,h=t[1];h<=t[3];){var p=null,d=null;l%2==0&&c%2==0?(p=o([[[u,h],[u,h+s],[u+r,h],[u,h]]],i.properties),d=o([[[u,h+s],[u+r,h+s],[u+r,h],[u,h+s]]],i.properties)):l%2==0&&c%2==1?(p=o([[[u,h],[u+r,h+s],[u+r,h],[u,h]]],i.properties),d=o([[[u,h],[u,h+s],[u+r,h+s],[u,h]]],i.properties)):c%2==0&&l%2==1?(p=o([[[u,h],[u,h+s],[u+r,h+s],[u,h]]],i.properties),d=o([[[u,h],[u+r,h+s],[u+r,h],[u,h]]],i.properties)):c%2==1&&l%2==1&&(p=o([[[u,h],[u,h+s],[u+r,h],[u,h]]],i.properties),d=o([[[u,h+s],[u+r,h+s],[u+r,h],[u,h+s]]],i.properties)),i.mask?(Rl(i.mask,p)&&n.push(p),Rl(i.mask,d)&&n.push(d)):(n.push(p),n.push(d)),h+=s,c++}l++,u+=r}return a(n)}(r,e,i)},Vl.getCartesians=function(t){if(!t)return;const e=t[0];return e instanceof zl?t.map((t=>t.toCartesian())):e instanceof Bl?t:e instanceof Gl?t.map((t=>Gl.toCartesian(t))):"number"==typeof e?Bl.fromDegreesArray(t):t},Vl.getLonLats=function(t){const e=t[0];return e instanceof zl?t:e instanceof Bl?t.map((t=>zl.fromCartesian(t))):e instanceof Gl?t.map((t=>zl.fromCartographic(t))):"number"==typeof e?zl.fromDegreesArray(t):t},Vl.getArea=function(t){return R(o([t]))},Vl.intersect=function(t,e){return Rl(t,e)},Vl.bbox=function(t){return function(t,e){void 0===e&&(e={});var i=Number(t[0]),n=Number(t[1]),r=Number(t[2]),s=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[i,n];return o([[a,[r,n],[r,s],[i,s],a]],e.properties,{bbox:t,id:e.id})}(P(o([(t=Ul(t)).map((t=>[t.lon,t.lat]))])))};let jl=class{constructor(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}get numberOfListeners(){return this._listeners.length-this._toRemove.length}addEventListener(t,e){if("function"!=typeof t)throw new Ol("侦听器应该是一个函数");this._listeners.push(t),this._scopes.push(e);const i=this;return function(){i.removeEventListener(t,e)}}removeEventListener(t,e){if("function"!=typeof t)throw new Ol("侦听器应该是一个函数");const i=this._listeners,n=this._scopes;let r=-1;for(let o=0;o<i.length;o++)if(i[o]===t&&n[o]===e){r=o;break}return-1!==r&&(this._insideRaiseEvent?(this._toRemove.push(r),i[r]=void 0,n[r]=void 0):(i.splice(r,1),n.splice(r,1)),!0)}raise(){let t;this._insideRaiseEvent=!0;const e=this._listeners,i=this._scopes;let{length:n}=e;for(t=0;t<n;t++){const n=e[t];Cesium.defined(n)&&e[t].apply(i[t],arguments)}const r=this._toRemove;if(n=r.length,n>0){for(r.sort(Wl),t=0;t<n;t++){const n=r[t];e.splice(n,1),i.splice(n,1)}r.length=0}this._insideRaiseEvent=!1}raiseEvent(){this.raise(...arguments)}};function ql(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=Math.floor(16*Math.random());return("x"===t?e:3&e|8).toString(16)}))}class Yl{constructor(t,e={}){Hl(t),this._id=Fl(e.id,ql()),this.options=e,this._viewer=t,this.preAnalysis=new jl,this.preDo=this.preAnalysis,this.postAnalysis=new jl,this.postDo=this.postAnalysis}get type(){return this._type}do(t){if(this._doing)throw new Ol("当前有正在分析的任务，请稍候再试")}isDestroyed(){return!1}clear(){}destroy(){this.clear(),destroyObject(this)}}class Xl{constructor(t,e,i){this.geometry={type:t,coordinates:e},this.type="Feature",this.properties=i}toEntity(t={}){const e=this.geometry,i=this.properties,{type:n,coordinates:r}=e;return"Point"===n?new Cesium.Entity({position:Cesium.Cartesian3.fromDegrees(...r),point:t,properties:i}):"LineString"===n?(t.positions=Cesium.Cartesian3.fromDegreesArray(r.flat()),new Cesium.Entity({properties:i,polyline:t})):"Polygon"===n?(t.hierarchy=this.points.map((t=>Cesium.Cartesian3.fromDegrees(t.x,t.y))),new Cesium.Entity({properties:this.properties,polygon:t})):void 0}static fromEntity(t){const e={};if(t.properties){const i=t.properties._propertyNames;for(let n of i)e[n]=t.properties[n].getValue()}return e}}class $l extends Xl{constructor(t,e,i){super("Point",[t,e],i),this.x=t,this.y=e}static fromArray(t){return new $l(t[0],t[1])}toEntity(t={}){return new Cesium.Entity({position:Cesium.Cartesian3.fromDegrees(this.x,this.y),point:t,properties:this.properties})}static fromEntity(t){if(t instanceof Cesium.Entity==!1)throw new CesiumProError("entity must be a Cesium.Entity");const e=Cesium.JulianDate.now();let i=Xl.fromEntity(t);if(t.position){const n=t.position.getValue(e),r=zl.fromCartesian(n);return new $l(r.lon,r.lat,i)}}}class Jl extends Xl{constructor(t,e){if(t.length<2)throw new Ol("Polyline feature positions must have at least 2 point");const i=[];for(const e of t)i.push([e.x,e.y]);super("LineString",i,e),this.points=t}static fromArray(t){const e=[];for(let i=0,n=t.length;i<n;i+=2){const n=new $l(t[i],t[i+1]);e.push(n)}return new Jl(e)}toEntity(t={}){return t.positions=this.points.map((t=>Cesium.Cartesian3.fromDegrees(t.x,t.y))),new Cesium.Entity({properties:this.properties,polyline:t})}static fromEntity(t){if(t instanceof Cesium.Entity==!1)throw new Ol("entity must be a Cesium.Entity");const e=Cesium.JulianDate.now();let i=Xl.fromEntity(t);if(t.polyline&&t.polyline.positions){let n=t.polyline.positions;n=n.getValue(e);const r=[];for(let t of n){const e=zl.fromCartesian(t);r.push(new $l(e.lon,e.lat))}return new Jl(r,i)}}}class Ql extends Xl{constructor(t,e){if(t.length<3)throw new Ol("Polygon feature positions must have at least 3 point");const i=[];for(const e of t)i.push([e.x,e.y]);i.push(i[0]),super("Polygon",[i],e),this.points=t}static fromArray(t){const e=[];for(let i=0,n=t.length;i<n;i+=2){const n=new $l(t[i],t[i+1]);e.push(n)}return new Ql(e)}toEntity(t={}){return t.hierarchy=this.points.map((t=>Cesium.Cartesian3.fromDegrees(t.x,t.y))),new Cesium.Entity({properties:this.properties,polygon:t})}static fromEntity(t){if(t instanceof Cesium.Entity==!1)throw new Ol("entity must be a Cesium.Entity");const e=Cesium.JulianDate.now();let i=Xl.fromEntity(t);if(t.polygon&&t.polygon.hierarchy){const n=t.polygon.hierarchy.getValue(e).positions,r=[];for(let t of n){const e=zl.fromCartesian(t);r.push(new $l(e.lon,e.lat))}return new Ql(r,i)}}static toEntity(t){if(!kl(t))return;let e;if("POLYGON"===t.geometry.type.toUpperCase())e=[t.geometry.coordinates];else{if("MULTIPOLYGON"!==t.geometry.type.toUpperCase())throw new Ol("Unknown feature type.");e=t.geometry.coordinates}const i=[];for(let t of e){let e=[];if(!kl(t)||!Array.isArray(t))return;for(let i of t){if(!Array.isArray(i))return;for(let t of i){const i=Cesium.Cartesian3.fromDegrees(t[0],t[1]);if(!kl(i))return;e.push(i)}}const n=new Cesium.Entity({polygon:{material:Cesium.Color.fromCssColorString("rgba(247,224,32,0.5)"),outlineColor:Cesium.Color.RED,perPositionHeight:!1,hierarchy:e}});i.push(n)}return i}}const{DataSource:Zl,EntityCluster:Kl,EntityCollection:tu}=Cesium;function eu(t){this._name=t,this._clock=void 0,this._changed=new jl,this._error=new jl,this._isLoading=!1,this._loading=new jl,this._entityCollection=new tu(this),this._entityCluster=new Kl}Object.defineProperties(eu.prototype,{name:{get:function(){return this._name},set:function(t){this._name!==t&&(this._name=t,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock},set:function(t){this._clock!==t&&(this._clock=t,this._changed.raiseEvent(this))}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(t){Zl.setLoading(this,t)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(t){this._entityCollection.show=t}},clustering:{get:function(){return this._entityCluster},set:function(t){this._entityCluster=t}}}),eu.prototype.update=function(t){return!0},eu.prototype.add=function(t){return this.entities.add(t)},eu.prototype.removeAll=function(){return this.entities.removeAll()};const iu={surfaceDistance:function(t){let e=0;for(let i=0;i<t.length-1;i+=1){const n=Cesium.Cartographic.fromCartesian(t[i]),r=Cesium.Cartographic.fromCartesian(t[i+1]),o=new Cesium.EllipsoidGeodesic;o.setEndPoints(n,r);e+=o.surfaceDistance}return e},spaceDistance:function(t){let e=0;for(let i=1;i<t.length;i++){const n=t[i-1],r=t[i];e+=Cesium.Cartesian3.distance(n,r)}return e},angle:function(t,e,i){let n=0;try{const r=Cesium.Transforms.eastNorthUpToFixedFrame(t),o=Cesium.Matrix4.inverseTransformation(r,new Cesium.Matrix4),s=Cesium.Matrix4.multiplyByPoint(o,e,new Cesium.Cartesian3),a=Cesium.Matrix4.multiplyByPoint(o,i,new Cesium.Cartesian3),l=Cesium.Cartesian3.normalize(s,new Cesium.Cartesian3),u=Cesium.Cartesian3.normalize(a,new Cesium.Cartesian3),c=Cesium.Cartesian3.dot(l,u);n=Cesium.Math.acosClamped(c)}catch(t){console.log(t),n=0}return Cesium.Math.toDegrees(n)},angleBetweenNorth:function(t,e){const i=Cesium.Transforms.eastNorthUpToFixedFrame(t),n=Cesium.Matrix4.inverseTransformation(i,new Cesium.Matrix4),r=Cesium.Matrix4.multiplyByPoint(n,e,new Cesium.Cartesian3),o=Cesium.Cartesian3.normalize(r,new Cesium.Cartesian3),s=new Cesium.Cartesian3(0,1,0),a=Cesium.Cartesian3.dot(o,s);let l=Cesium.Math.acosClamped(a);l=Cesium.Math.toDegrees(l);const u=new Cesium.Cartesian3(1,0,0);return Cesium.Cartesian3.dot(u,o)<0&&(l=360-l),l},surfaceArea:function(t){let e=0;for(let i=0;i<t.length-2;i+=1){const n=(i+1)%t.length,r=(i+2)%t.length,o=iu.angle(t[i],t[n],t[r]);e+=iu.spaceDistance([t[i],t[n]])*iu.spaceDistance([t[n],t[r]])*Math.abs(Math.sin(Cesium.Math.toRadians(o)))}return e},spaceArea:function(t){const e=[];for(let i of t){const t=zl.fromCartesian(i);e.push([t.lon,t.lat])}e.push(e[0]);return R(o([e]))},heightFromCartesianArray:function(t){if(t.length<2)return 0;const e=[];for(let i=1;i<t.length;i++){const n=Cesium.Cartographic.fromCartesian(t[i-1]),r=Cesium.Cartographic.fromCartesian(t[i]);n&&r?e.push(r.height-n.height):e.push("NaN")}return e}},{Color:nu,Cartesian3:ru,Cartographic:ou,PrimitiveCollection:su,PolygonGeometry:au,PolygonHierarchy:lu,GeometryInstance:uu,Primitive:cu,GroundPrimitive:hu,PerInstanceColorAppearance:pu}=Cesium;function du(t,e,i=[]){const n=[];let r=0;const o=Vl.getArea(e);for(let o=0;o<3;o++){const s=e[o],a=ou.fromDegrees(...s),l=t.scene.sampleHeight(a,i);r+=l;const u=ru.fromDegrees(s[0],s[1],l);n.push(u)}return{positions:n,height:r/3,area:o}}class fu extends Yl{constructor(t,e={}){super(t,e);const i=Vl.getCartesians(e.mask);i&&(this._mask=[...i,i[0]]),this._mask instanceof ru&&(this._mask=this._mask.map((t=>zl.fromCartesian(t)))),this.excavatedColor=Fl(e.excavatedColor,nu.RED.withAlpha(.5)),this.fillColor=Fl(e.fillColor,nu.GREEN.withAlpha(.5)),this._type="excavation-analysis",this._height=Fl(e.height,0),this._samplerSize=e.samplerSize,this._excludeObject=Fl(e.excludeObject,[]),this._renderToViewer=Fl(e.renderToViewer,!0),this._doing=!1}setMask(t){if(!Array.isArray(t))throw new Ol("mask must be an array");const e=Vl.getCartesians(options.mask);this._mask=[...e,e[0]],this._mask instanceof ru&&(this._mask=this._mask.map((t=>zl.fromCartesian(t))))}static suggestGridCount=300;do(){if(super.do(),!this._mask&&!Array.isArray(mask))throw new Ol("请通过setMask方法指定分析范围");if(this._doing)throw new Ol("上一次分析正在进行，请稍候...");if(!this._mask)return;this.clear(),this._doing=!0,this.preDo.raise({samplerSize:this._samplerSize,id:this._id});const t=iu.surfaceArea(this._mask),e=this._samplerSize||Math.sqrt(t/1e6/fu.suggestGridCount),i=Vl.getLonLats(this._mask),n=Vl.triangleGrid(i,e),r=new su;this._root=r,r.name=this.type,this._renderToViewer&&this._viewer.scene.primitives.add(r);const o=n.features.map((t=>t.geometry.coordinates[0])),s=[];let a=0,l=0;for(let t of o){const{height:e,positions:i,area:n}=du(this._viewer,t,this._excludeObject),r=n*(e-this._height);r>0?l+=r:a+=Math.abs(r),s.push({height:e,positions:i,volume:r}),this._render(i,e)}const u={samplerSize:e,id:this._id,grid:n,result:s,fillVolume:a,excavaVolume:l,graphicCollection:this._root};return this.postAnalysis.raise(u),this._doing=!1,u}_render(t,e){const i=e<this._height?this.excavatedColor:this.fillColor,n=e>this._height,r=function(t,e,i,n){const r=new au({polygonHierarchy:new lu(t),perPositionHeight:!0,extrudedHeight:i}),o=new uu({geometry:r,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(e)}});return new(n?hu:cu)({geometryInstances:[o],appearance:new pu})}(t,i,this._height,n);this._root.add(r)}clear(){this._root&&this._viewer.scene.primitives.remove(this._root)}}const{Cartesian3:gu,RenderState:mu,Cartesian4:_u,Matrix4:yu,Texture:vu,PixelFormat:Cu,PixelDatatype:xu,Framebuffer:wu,DrawCommand:bu,Pass:Eu,ShaderProgram:Su,BoundingSphere:Tu,VertexArray:Pu,PolygonHierarchy:Au,PolygonGeometry:Iu,BoundingRectangle:Lu,Transforms:Nu,ClearCommand:Mu,Color:Du,PassState:Ru,OrthographicOffCenterFrustum:Ou,Cartographic:Fu,defined:ku,destroyObject:zu,BufferUsage:Gu,WebGLConstants:Bu,PrimitiveType:Uu}=Cesium;class Vu{constructor(t){if(!Array.isArray(t))throw Ol("positions must be a cartesian3 array.");this.positions=t.filter((t=>t instanceof gu)),this._colorTexture=void 0,this._depthStenclilTexture=void 0,this.frameBuffer=void 0,this._viewport=new Lu,this._rs=void 0,this._clearColorCommand=new Mu({depth:1,coloe:new Du(0,0,0,1)}),this._useScissorTest=!1,this._scissorRectangle=!1,this._command=void 0,this._camera=new class{constructor(){this.viewMatrix=yu.IDENTITY,this.inverseViewMatrix=yu.IDENTITY,this.frustum=new Ou,this.positionCartographic=new Fu,this.upWC=gu.clone(gu.UNIT_Y),this.rightWC=gu.clone(gu.UNIT_X),this.directionWC=gu.clone(gu.UNIT_Z),this.viewPorjectionMatrix=yu.IDENTITY}clone(t){yu.clone(t.viewMatrix,this.viewMatrix),yu.clone(t.inverseViewMatrix,this.inverseViewMatrix),this.frustum=t.frustum.clone(this.frustum),Fu.clone(t.positionCartographic,this.positionCartographic),gu.clone(t.upWC,this.upWC),gu.clone(t.rigtWC,this.rightWC),gu.clone(t.directionWC,this.directionWC)}},this._passState=void 0,this._clearPassState=void 0,this._positions=[],this._delta=0,this._localModel=void 0,this._inverseLocalModel=void 0,this._uniforms={},this._initShaderSource=!1,this._colorTexture=void 0,this._enabled=!0;let e=Tu.fromPoints(this.positions).center;const i=Fu.fromCartesian(e);e=gu.fromRadians(i.longitude,i.latitude,0),this._localModel=Nu.eastNorthUpToFixedFrame(e),this._inverseLocalModel=yu.inverse(this._localModel,{});const n=t.map((t=>yu.multiplyByPoint(this._inverseLocalModel,t,{}))),r=Lu.fromPoints(n);this.boundingRect=new _u(r.x,r.y,r.x+r.width,r.y+r.height);const o=this._camera.frustum;o.left=r.x,o.top=r.y+r.height,o.right=r.x+r.width,o.bottom=r.y,this.normal=gu.normalize(this.positions[0],{}),this._width=256,this._height=256,this._id=ql()}get enabled(){return this._enabled}set enabled(t){this._enabled=t}_createVertexArray(t){const e=new Iu({polygonHierarchy:new Au(this.positions)}),i=Iu.createGeometry(e);return Pu.fromGeometry({context:t.context,geometry:i,attributeLocations:{position:0},bufferUsage:Gu.STREAM_DRAW,interleave:!0})}_createDrawcommand(t){this._passState=new Ru(t.context),this._passState.viewport=new Lu(100,100,this._width,this._height),this._clearPassState=new Ru(t.context);const e=this._createVertexArray(t),i=Su.fromCache({context:t.context,vertexShaderSource:"\nattribute vec3 position;\nvarying float depth;\nuniform mat4 u_inverseMatrix;\nvoid main() {\n  vec4 pos = vec4(position, 1.0);  \n  vec4 positionLC = u_inverseMatrix * pos;\n  depth = positionLC.z;\n  gl_Position = czm_projection * vec4(positionLC.xy, 0.0, 1.0); \n}\n",fragmentShaderSource:"\nvarying float depth;\nvoid main() {\n  float fDepth = depth / 1024.0; \n  gl_FragColor = czm_packDepth(fDepth);\n}\n"}),n=mu.fromCache({viewport:new Lu(0,0,this._width,this._height),depthTest:{enabled:!0},cull:{enabled:!0,face:Bu.BACK},depthMask:!0}),r=new bu({primitiveType:Uu.TRIANGLES,vertexArray:e,shaderProgram:i,uniformMap:{u_inverseMatrix:()=>this._inverseLocalModel},renderState:n,pass:Eu.OPAQUE});this._command=r}_updateFramebuffer(t){const e=this._colorTexture,i=ku(e)&&e.width!==this._width&&e.height!==this._height;ku(this.frameBuffer)||i||(e&&!e.isDestroyed()&&e.destroy(),this._depthStenclilTexture&&!this._depthStenclilTexture.isDestroyed()&&this._depthStenclilTexture.destroy(),this.frameBuffer&&!this.frameBuffer.isDestroyed()&&this.frameBuffer.destroy(),this._colorTexture=new vu({context:t.context,width:this._width,height:this._height,pixelFormat:Cu.RGBA,pixelDatatype:xu.UNSIGNED_BYTE}),this._depthStenclilTexture=new vu({context:t.context,width:this._width,height:this._height,pixelFormat:Cu.DEPTH_STENCIL,pixelDatatype:xu.UNSIGNED_INT_24_8}),this.frameBuffer=new wu({context:t.context,colorTextures:[this._colorTexture],depthStencilTexture:this._depthStenclilTexture,destroyAttachments:!1}))}update(t){if(!this._enabled)return;this._command||this._createDrawcommand(t),this._updateFramebuffer(t);const e=t.context.uniformState;e.updateCamera(this._camera),this._clear(t),e.updatePass(this._command.pass),this._command.framebuffer=this.frameBuffer,this._command.execute(t.context,this._passState)}_clear(t){this._clearColorCommand&&(this._clearColorCommand.framebuffer=this.frameBuffer,this._clearColorCommand.execute(t.context,this._clearPassState))}isDestroyed(){return!1}destroy(){this._colorTexture&&!this._colorTexture.isDestroyed()&&this._colorTexture.destroy(),this._depthStenclilTexture&&!this._depthStenclilTexture.isDestroyed()&&this._depthStenclilTexture.destroy(),this.frameBuffer&&!this.frameBuffer.isDestroyed()&&this.frameBuffer.destroy(),zu(this)}}function Hu(){return!0}function Wu(t,e){function i(){}const n=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertyNames(Object.getPrototypeOf(t))];for(var r of n)"function"==typeof t[r]&&(t[r]=i);t.isDestroyed=Hu}const ju="\nuniform float height;\nuniform vec4 color;\n\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    if (materialInput.height < height) {\n      material.alpha = color.a;\n    } else {\n      material.alpha = 0.0;\n    }\n    material.diffuse = color.rgb;\n    return material;\n}\n",{Cartographic:qu}=Cesium;class Yu extends Yl{constructor(t,e={}){super(t),this._samplerSize=e.samplerSize?e.samplerSize/1e3:void 0,this.autoDepthTest=Fl(e.autoDepthTest,!0);const i=Vl.getCartesians(e.mask);this._mask=[],i&&i.length&&(this._mask=[...i,i[0]]),this._type="height-analysis"}get samplerSize(){return 1e3*this._samplerSize}set samplerSize(t){"number"==typeof(t=parseFloat(t))&&(this._samplerSize=t/1e3)}get mask(){return this._mask.slice(0,this._mask.length-1)}set mask(t){const e=Vl.getCartesians(t);e&&e.length&&(this._mask=[...e,e[0]])}static suggestGridCount=300;do(t=[]){if(!this._mask.length)return{};this.preDo.raise({id:this._id,mask:this._mask});const e=viewer.scene.globe.depthTestAgainstTerrain;!1===e&&this.autoDepthTest&&(viewer.scene.globe.depthTestAgainstTerrain=!0);const i=iu.surfaceArea(this._mask),n=Math.sqrt(i/1e6/Yu.suggestGridCount),r=Vl.getLonLats(this._mask),o=this._samplerSize||n,s=Vl.polygonToGrid(r,o).features.map((t=>qu.fromDegrees(...t.geometry.coordinates))),{max:a,min:l,avg:u}=function(t,e,i=[]){let n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,o=0;return t.map((t=>{let s;try{s=e.scene.globe.depthTestAgainstTerrain?e.scene.sampleHeight(t,i):e.scene.globe.getHeight(position)}catch(t){s=e.scene.globe.getHeight(position)}isNaN(s)||(s>n&&(n=s),s<r&&(r=s),o+=s)})),{max:n,min:r,avg:o/t.length}}(s,this._viewer,t);return this.postAnalysis.raise({id:this._id,mask:this._mask,samplerSize:1e3*o}),!1===e&&this.autoDepthTest&&(viewer.scene.globe.depthTestAgainstTerrain=e),{max:a,min:l,avg:u,samplerSize:o}}}const{Material:Xu,Color:$u,JulianDate:Ju,Clock:Qu}=Cesium;Xu.FloodMaterial="FloodMaterial",Xu._materialCache.addMaterial(Xu.FloodMaterial,{fabric:{type:Xu.FloodMaterial,uniforms:{color:$u.fromCssColorString("rgba(0, 123, 230, 0.5)"),height:0},source:ju}});class Zu{constructor(t){if(!kl(t))throw new Ol("parameter shadowMap is required.");this._shadowMap=t}get show(){return this._show}set show(t){this._show=t}update(t){t.shadowMaps.push(this._shadowMap)}destroy(){this._shadowMap&&!this._shadowMap.isDestroyed()&&this._shadowMap.destroy(),Wu(this)}}const Ku=Cesium.BoundingRectangle,tc=Cesium.BoundingSphere,ec=Cesium.BoxOutlineGeometry,ic=Cesium.Cartesian2,nc=Cesium.Cartesian3,rc=Cesium.Cartesian4,oc=Cesium.Cartographic,sc=Cesium.Color,ac=Cesium.ColorGeometryInstanceAttribute,lc=Cesium.combine,uc=Cesium.CullingVolume,cc=Cesium.defaultValue,hc=Cesium.defined,pc=Object.defineProperties,dc=Cesium.destroyObject;Cesium.DeveloperError;const fc=Cesium.FeatureDetection,gc=Cesium.GeometryInstance,mc=Cesium.Intersect,_c=Cesium.Math,yc=Cesium.Matrix4,vc=Cesium.OrthographicOffCenterFrustum,Cc=Cesium.PerspectiveFrustum,xc=Cesium.PixelFormat,wc=Cesium.Quaternion,bc=Cesium.SphereOutlineGeometry,Ec=Cesium.WebGLConstants,Sc=Cesium.ClearCommand,Tc=Cesium.ContextLimits,Pc=Cesium.CubeMap,Ac=Cesium.DrawCommand,Ic=Cesium.Framebuffer,Lc=Cesium.Pass,Nc=Cesium.PassState,Mc=Cesium.PixelDatatype,Dc=Cesium.Renderbuffer,Rc=Cesium.RenderbufferFormat,Oc=Cesium.RenderState,Fc=Cesium.Sampler,kc=Cesium.Texture,zc=Cesium.TextureMagnificationFilter,Gc=Cesium.TextureMinificationFilter,Bc=Cesium.TextureWrap,Uc=Cesium.Camera,Vc=Cesium.CullFace,Hc=Cesium.DebugCameraPrimitive,Wc=Cesium.PerInstanceColorAppearance,jc=Cesium.Primitive,qc=Cesium.ShadowMapShader,Yc=Cesium.ShaderSource;function Xc(t){var e=(t=cc(t,cc.EMPTY_OBJECT)).context;this._enabled=cc(t.enabled,!0),this._softShadows=cc(t.softShadows,!1),this._normalOffset=cc(t.normalOffset,!0),this.dirty=!0,this.fromLightSource=cc(t.fromLightSource,!0),this.darkness=0,this._darkness=this.darkness,this.maximumDistance=cc(t.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;var i,n=!0;(fc.isInternetExplorer()||fc.isEdge()||(fc.isChrome()||fc.isFirefox())&&fc.isWindows()&&!e.depthTexture)&&(n=!1),this._polygonOffsetSupported=n,this._terrainBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new yc,this._shadowMapTexture=void 0,this._lightDirectionEC=new nc,this._lightPositionEC=new rc,this._distance=0,this._lightCamera=t.lightCamera,this._shadowMapCamera=new ph,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=cc(t.boundingSphere,new tc),this._isPointLight=cc(t.isPointLight,!1),this._pointLightRadius=cc(t.pointLightRadius,100),this._cascadesEnabled=!1,this._numberOfCascades=this._cascadesEnabled?cc(t.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new ic,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new vc:hc(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new rc,new rc],this._cascadeMatrices=[new yc,new yc,new yc,new yc],this._cascadeDistances=new rc,i=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(i);for(var r=0;r<i;++r)this._passes[r]=new $c(e);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=e.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,Qc(this),this._clearCommand=new Sc({depth:1,color:new sc}),this._clearPassState=new Nc(e),this._size=cc(t.size,2048),this.size=this._size}function $c(t){this.camera=new ph,this.passState=new Nc(t),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function Jc(t,e){return Oc.fromCache({cull:{enabled:!0,face:Vc.BACK},depthTest:{enabled:!0},colorMask:{red:t,green:t,blue:t,alpha:t},depthMask:!0,polygonOffset:{enabled:e.polygonOffset,factor:e.polygonOffsetFactor,units:e.polygonOffsetUnits}})}function Qc(t){var e=!t._usesDepthTexture;t._primitiveRenderState=Jc(e,t._primitiveBias),t._terrainRenderState=Jc(e,t._terrainBias),t._pointRenderState=Jc(e,t._pointBias)}function Zc(t){for(var e=t._passes.length,i=0;i<e;++i){var n=t._passes[i],r=n.framebuffer;hc(r)&&!r.isDestroyed()&&r.destroy(),n.framebuffer=void 0}t._depthAttachment=t._depthAttachment&&t._depthAttachment.destroy(),t._colorAttachment=t._colorAttachment&&t._colorAttachment.destroy()}function Kc(){return new Fc({wrapS:Bc.CLAMP_TO_EDGE,wrapT:Bc.CLAMP_TO_EDGE,minificationFilter:Gc.NEAREST,magnificationFilter:zc.NEAREST})}function th(t,e){t._isPointLight?function(t,e){for(var i=new Dc({context:e,width:t._textureSize.x,height:t._textureSize.y,format:Rc.DEPTH_COMPONENT16}),n=new Pc({context:e,width:t._textureSize.x,height:t._textureSize.y,pixelFormat:xc.RGBA,pixelDatatype:Mc.UNSIGNED_BYTE,sampler:Kc()}),r=[n.negativeX,n.negativeY,n.negativeZ,n.positiveX,n.positiveY,n.positiveZ],o=0;o<6;++o){var s=new Ic({context:e,depthRenderbuffer:i,colorTextures:[r[o]],destroyAttachments:!1}),a=t._passes[o];a.framebuffer=s,a.passState.framebuffer=s}t._shadowMapTexture=n,t._depthAttachment=i,t._colorAttachment=n}(t,e):t._usesDepthTexture?function(t,e){for(var i=new kc({context:e,width:t._textureSize.x,height:t._textureSize.y,pixelFormat:xc.DEPTH_STENCIL,pixelDatatype:Mc.UNSIGNED_INT_24_8,sampler:Kc()}),n=new Ic({context:e,depthStencilTexture:i,destroyAttachments:!1}),r=t._passes.length,o=0;o<r;++o){var s=t._passes[o];s.framebuffer=n,s.passState.framebuffer=n}t._shadowMapTexture=i,t._depthAttachment=i}(t,e):function(t,e){for(var i=new Dc({context:e,width:t._textureSize.x,height:t._textureSize.y,format:Rc.DEPTH_COMPONENT16}),n=new kc({context:e,width:t._textureSize.x,height:t._textureSize.y,pixelFormat:xc.RGBA,pixelDatatype:Mc.UNSIGNED_BYTE,sampler:Kc()}),r=new Ic({context:e,depthRenderbuffer:i,colorTextures:[n],destroyAttachments:!1}),o=t._passes.length,s=0;s<o;++s){var a=t._passes[s];a.framebuffer=r,a.passState.framebuffer=r}t._shadowMapTexture=n,t._depthAttachment=i,t._colorAttachment=n}(t,e)}function eh(t,e){hc(t._passes[0].framebuffer)&&t._shadowMapTexture.width===t._textureSize.x||(Zc(t),th(t,e),function(t,e){t._usesDepthTexture&&t._passes[0].framebuffer.status!==Ec.FRAMEBUFFER_COMPLETE&&(t._usesDepthTexture=!1,Qc(t),Zc(t),th(t,e))}(t,e),ih(t,e))}function ih(t,e,i){i=cc(i,0),(t._isPointLight||0===i)&&(t._clearCommand.framebuffer=t._passes[i].framebuffer,t._clearCommand.execute(e,t._clearPassState))}Xc.MAXIMUM_DISTANCE=2e4,Xc.prototype.debugCreateRenderStates=function(){Qc(this)},pc(Xc.prototype,{enabled:{get:function(){return this._enabled},set:function(t){this.dirty=this._enabled!==t,this._enabled=t}},isViewShed:{get:function(){return!0}},normalOffset:{get:function(){return this._normalOffset},set:function(t){this.dirty=this._normalOffset!==t,this._normalOffset=t,this._terrainBias.normalOffset=t,this._primitiveBias.normalOffset=t,this._pointBias.normalOffset=t}},softShadows:{get:function(){return this._softShadows},set:function(t){this.dirty=this._softShadows!==t,this._softShadows=t}},size:{get:function(){return this._size},set:function(t){!function(t,e){t._size=e;var i=t._passes,n=i.length,r=t._textureSize;if(t._isPointLight){e=Tc.maximumCubeMapSize>=e?e:Tc.maximumCubeMapSize,r.x=e,r.y=e;var o=new Ku(0,0,e,e);i[0].passState.viewport=o,i[1].passState.viewport=o,i[2].passState.viewport=o,i[3].passState.viewport=o,i[4].passState.viewport=o,i[5].passState.viewport=o}else 1===n?(e=Tc.maximumTextureSize>=e?e:Tc.maximumTextureSize,r.x=e,r.y=e,i[0].passState.viewport=new Ku(0,0,e,e)):4===n&&(e=Tc.maximumTextureSize>=2*e?e:Tc.maximumTextureSize/2,r.x=2*e,r.y=2*e,i[0].passState.viewport=new Ku(0,0,e,e),i[1].passState.viewport=new Ku(e,0,e,e),i[2].passState.viewport=new Ku(0,e,e,e),i[3].passState.viewport=new Ku(e,e,e,e));t._clearPassState.viewport=new Ku(0,0,r.x,r.y);for(var s=0;s<n;++s){var a=i[s],l=a.passState.viewport,u=l.x/r.x,c=l.y/r.y,h=l.width/r.x,p=l.height/r.y;a.textureOffsets=new yc(h,0,0,u,0,p,0,c,0,0,1,0,0,0,0,1)}}(this,t)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(t){this.dirty=this._debugCascadeColors!==t,this._debugCascadeColors=t}}});var nh=new Ku;function rh(t,e){var i=e.context,n=e.context.drawingBufferWidth,r=e.context.drawingBufferHeight,o=.3*Math.min(n,r),s=nh;s.x=n-o,s.y=0,s.width=o,s.height=o;var a=t._debugShadowViewCommand;hc(a)||(a=function(t,e){var i;i=t._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(t._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n";var n=e.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return t._shadowMapTexture},shadowMap_textureCube:function(){return t._shadowMapTexture}}});return n.pass=Lc.OVERLAY,n}(t,i),t._debugShadowViewCommand=a),hc(a.renderState)&&Ku.equals(a.renderState.viewport,s)||(a.renderState=Oc.fromCache({viewport:Ku.clone(s)})),e.commandList.push(t._debugShadowViewCommand)}var oh=new Array(8);oh[0]=new rc(-1,-1,-1,1),oh[1]=new rc(1,-1,-1,1),oh[2]=new rc(1,1,-1,1),oh[3]=new rc(-1,1,-1,1),oh[4]=new rc(-1,-1,1,1),oh[5]=new rc(1,-1,1,1),oh[6]=new rc(1,1,1,1),oh[7]=new rc(-1,1,1,1);for(var sh=new yc,ah=new Array(8),lh=0;lh<8;++lh)ah[lh]=new rc;var uh=[sc.RED,sc.GREEN,sc.BLUE,sc.MAGENTA],ch=new nc;function hh(t,e){rh(t,e);var i=t.debugFreezeFrame&&!t._debugFreezeFrame;if(t._debugFreezeFrame=t.debugFreezeFrame,t.debugFreezeFrame&&(i&&(t._debugCameraFrustum=t._debugCameraFrustum&&t._debugCameraFrustum.destroy(),t._debugCameraFrustum=new Hc({camera:t._sceneCamera,color:sc.CYAN,updateOnChange:!1})),t._debugCameraFrustum.update(e)),t._cascadesEnabled){if(t.debugFreezeFrame){i&&(t._debugLightFrustum=t._debugLightFrustum&&t._debugLightFrustum.destroy(),t._debugLightFrustum=new Hc({camera:t._shadowMapCamera,color:sc.YELLOW,updateOnChange:!1})),t._debugLightFrustum.update(e);for(var n=0;n<t._numberOfCascades;++n)i&&(t._debugCascadeFrustums[n]=t._debugCascadeFrustums[n]&&t._debugCascadeFrustums[n].destroy(),t._debugCascadeFrustums[n]=new Hc({camera:t._passes[n].camera,color:uh[n],updateOnChange:!1})),t._debugCascadeFrustums[n].update(e)}}else if(t._isPointLight){if(!hc(t._debugLightFrustum)||t._needsUpdate){var r=t._shadowMapCamera.positionWC,o=wc.IDENTITY,s=2*t._pointLightRadius,a=nc.fromElements(s,s,s,ch),l=yc.fromTranslationQuaternionRotationScale(r,o,a,sh);t._debugLightFrustum=t._debugLightFrustum&&t._debugLightFrustum.destroy(),t._debugLightFrustum=function(t,e){var i=new gc({geometry:new ec({minimum:new nc(-.5,-.5,-.5),maximum:new nc(.5,.5,.5)}),attributes:{color:ac.fromColor(e)}}),n=new gc({geometry:new bc({radius:.5}),attributes:{color:ac.fromColor(e)}});return new jc({geometryInstances:[i,n],appearance:new Wc({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:t})}(l,sc.YELLOW)}t._debugLightFrustum.update(e)}else hc(t._debugLightFrustum)&&!t._needsUpdate||(t._debugLightFrustum=new Hc({camera:t._shadowMapCamera,color:sc.YELLOW,updateOnChange:!1})),t._debugLightFrustum.update(e)}function ph(){this.viewMatrix=new yc,this.inverseViewMatrix=new yc,this.frustum=void 0,this.positionCartographic=new oc,this.positionWC=new nc,this.directionWC=nc.clone(nc.UNIT_Z),this.upWC=nc.clone(nc.UNIT_Y),this.rightWC=nc.clone(nc.UNIT_X),this.viewProjectionMatrix=new yc}ph.prototype.clone=function(t){yc.clone(t.viewMatrix,this.viewMatrix),yc.clone(t.inverseViewMatrix,this.inverseViewMatrix),this.frustum=t.frustum.clone(this.frustum),oc.clone(t.positionCartographic,this.positionCartographic),nc.clone(t.positionWC,this.positionWC),nc.clone(t.directionWC,this.directionWC),nc.clone(t.upWC,this.upWC),nc.clone(t.rightWC,this.rightWC)};var dh=new yc(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);ph.prototype.getViewProjection=function(){var t=this.viewMatrix,e=this.frustum.projectionMatrix;return yc.multiply(e,t,this.viewProjectionMatrix),yc.multiply(dh,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var fh=new Array(5),gh=new Cc,mh=new Array(4),_h=new nc,yh=new nc;var vh=new yc,Ch=new nc,xh=new nc,wh=new nc;var bh=[new nc(-1,0,0),new nc(0,-1,0),new nc(0,0,-1),new nc(1,0,0),new nc(0,1,0),new nc(0,0,1)],Eh=[new nc(0,-1,0),new nc(0,0,-1),new nc(0,-1,0),new nc(0,-1,0),new nc(0,0,1),new nc(0,-1,0)],Sh=[new nc(0,0,1),new nc(1,0,0),new nc(-1,0,0),new nc(0,0,-1),new nc(1,0,0),new nc(1,0,0)];var Th=new nc,Ph=new nc,Ah=new tc,Ih=Ah.center;function Lh(t,e){var i=e.camera,n=t._lightCamera,r=t._sceneCamera,o=t._shadowMapCamera;t._cascadesEnabled?nc.clone(n.directionWC,o.directionWC):t._isPointLight?nc.clone(n.positionWC,o.positionWC):o.clone(n);var s,a,l=t._lightDirectionEC;yc.multiplyByPointAsVector(i.viewMatrix,o.directionWC,l),nc.normalize(l,l),nc.negate(l,l),yc.multiplyByPoint(i.viewMatrix,o.positionWC,t._lightPositionEC),t._lightPositionEC.w=t._pointLightRadius,t.isViewShed?(s=n.frustum.near,a=n.frustum.far):t._fitNearFar?(s=Math.min(e.shadowState.nearPlane,t.maximumDistance),a=Math.min(e.shadowState.farPlane,t.maximumDistance+1)):(s=i.frustum.near,a=t.maximumDistance),t._sceneCamera=Uc.clone(i,r),i.frustum.clone(t._sceneCamera.frustum),t._sceneCamera.frustum.near=s,t._sceneCamera.frustum.far=a,t._distance=a-s,function(t,e){var i=t._sceneCamera,n=t._shadowMapCamera,r=Ah;if(t._cascadesEnabled){if(i.frustum.near>=t.maximumDistance)return t._outOfView=!0,void(t._needsUpdate=!1);var o=e.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,Th),s=nc.negate(n.directionWC,Ph),a=nc.dot(o,s),l=_c.clamp(a/.1,0,1);if(t._darkness=_c.lerp(1,t.darkness,l),a<0)return t._outOfView=!0,void(t._needsUpdate=!1);t._needsUpdate=!0,t._outOfView=!1}else if(t._isPointLight)r.center=n.positionWC,r.radius=t._pointLightRadius,t._outOfView=e.cullingVolume.computeVisibility(r)===mc.OUTSIDE,t._needsUpdate=!t._outOfView&&!t._boundingSphere.equals(r),tc.clone(r,t._boundingSphere);else{var u=n.frustum.far/2,c=nc.add(n.positionWC,nc.multiplyByScalar(n.directionWC,u,Ih),Ih);r.center=c,r.radius=u,t._outOfView=e.cullingVolume.computeVisibility(r)===mc.OUTSIDE,t._needsUpdate=!t._outOfView&&!t._boundingSphere.equals(r),tc.clone(r,t._boundingSphere)}}(t,e),!t._outOfViewPrevious&&t._outOfView&&(t._needsUpdate=!0),t._outOfViewPrevious=t._outOfView}Xc.prototype.update=function(t){if(Lh(this,t),this._needsUpdate)if(eh(this,t.context),this._isPointLight&&function(t,e){var i=new Cc;i.fov=_c.PI_OVER_TWO,i.near=1,i.far=t._pointLightRadius,i.aspectRatio=1;for(var n=0;n<6;++n){var r=t._passes[n].camera;r.positionWC=t._shadowMapCamera.positionWC,r.positionCartographic=e.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),r.directionWC=bh[n],r.upWC=Eh[n],r.rightWC=Sh[n],yc.computeView(r.positionWC,r.directionWC,r.upWC,r.rightWC,r.viewMatrix),yc.inverse(r.viewMatrix,r.inverseViewMatrix),r.frustum=i}}(this,t),this._cascadesEnabled&&(function(t,e){var i=t._shadowMapCamera,n=t._sceneCamera,r=yc.multiply(n.frustum.projectionMatrix,n.viewMatrix,sh),o=yc.inverse(r,sh),s=i.directionWC,a=n.directionWC,l=nc.cross(s,a,Ch);a=nc.cross(l,s,xh),nc.normalize(a,a),nc.normalize(l,l);for(var u=nc.fromElements(0,0,0,wh),c=yc.computeView(u,s,a,l,vh),h=yc.multiply(c,o,sh),p=nc.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,_h),d=nc.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,yh),f=0;f<8;++f){var g=rc.clone(oh[f],ah[f]);yc.multiplyByVector(h,g,g),nc.divideByScalar(g,g.w,g),nc.minimumByComponent(g,p,p),nc.maximumByComponent(g,d,d)}d.z+=1e3,p.z-=10;var m=wh;m.x=-.5*(p.x+d.x),m.y=-.5*(p.y+d.y),m.z=-d.z;var _=yc.fromTranslation(m,sh);c=yc.multiply(_,c,c);var y=.5*(d.x-p.x),v=.5*(d.y-p.y),C=d.z-p.z,x=i.frustum;x.left=-y,x.right=y,x.bottom=-v,x.top=v,x.near=.01,x.far=C,yc.clone(c,i.viewMatrix),yc.inverse(c,i.inverseViewMatrix),yc.getTranslation(i.inverseViewMatrix,i.positionWC),e.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),nc.clone(s,i.directionWC),nc.clone(a,i.upWC),nc.clone(l,i.rightWC)}(this,t),this._numberOfCascades>1&&function(t,e){var i,n=t._shadowMapCamera,r=t._sceneCamera,o=r.frustum.near,s=r.frustum.far,a=t._numberOfCascades,l=s-o,u=s/o,c=.9,h=!1;e.shadowState.closestObjectSize<200&&(h=!0,c=.9);var p=mh,d=fh;for(d[0]=o,d[a]=s,i=0;i<a;++i){var f=(i+1)/a,g=o*Math.pow(u,f),m=o+l*f,_=_c.lerp(m,g,c);d[i+1]=_,p[i]=_-d[i]}if(h){for(i=0;i<a;++i)p[i]=Math.min(p[i],t._maximumCascadeDistances[i]);var y=d[0];for(i=0;i<a-1;++i)y+=p[i],d[i+1]=y}rc.unpack(d,0,t._cascadeSplits[0]),rc.unpack(d,1,t._cascadeSplits[1]),rc.unpack(p,0,t._cascadeDistances);var v=n.frustum,C=v.left,x=v.right,w=v.bottom,b=v.top,E=v.near,S=v.far,T=n.positionWC,P=n.directionWC,A=n.upWC,I=r.frustum.clone(gh),L=n.getViewProjection();for(i=0;i<a;++i){I.near=d[i],I.far=d[i+1];for(var N=yc.multiply(I.projectionMatrix,r.viewMatrix,sh),M=yc.inverse(N,sh),D=yc.multiply(L,M,sh),R=nc.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,_h),O=nc.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,yh),F=0;F<8;++F){var k=rc.clone(oh[F],ah[F]);yc.multiplyByVector(D,k,k),nc.divideByScalar(k,k.w,k),nc.minimumByComponent(k,R,R),nc.maximumByComponent(k,O,O)}R.x=Math.max(R.x,0),R.y=Math.max(R.y,0),R.z=0,O.x=Math.min(O.x,1),O.y=Math.min(O.y,1),O.z=Math.min(O.z,1);var z=t._passes[i],G=z.camera;G.clone(n);var B=G.frustum;B.left=C+R.x*(x-C),B.right=C+O.x*(x-C),B.bottom=w+R.y*(b-w),B.top=w+O.y*(b-w),B.near=E+R.z*(S-E),B.far=E+O.z*(S-E),z.cullingVolume=G.frustum.computeCullingVolume(T,P,A);var U=t._cascadeMatrices[i];yc.multiply(G.getViewProjection(),r.inverseViewMatrix,U),yc.multiply(z.textureOffsets,U,U)}}(this,t)),this._isPointLight)this._shadowMapCullingVolume=uc.fromBoundingSphere(this._boundingSphere);else{var e=this._shadowMapCamera,i=e.positionWC,n=e.directionWC,r=e.upWC;this._shadowMapCullingVolume=e.frustum.computeCullingVolume(i,n,r),1===this._passes.length&&this._passes[0].camera.clone(e)}if(1===this._passes.length){var o=this._sceneCamera.inverseViewMatrix;yc.multiply(this._shadowMapCamera.getViewProjection(),o,this._shadowMapMatrix)}this.debugShow&&hh(this,t)},Xc.prototype.updatePass=function(t,e){ih(this,t,e)};var Nh=new ic;Cesium.ShadowMap.createReceiveDerivedCommand=function(t,e,i,n,r){hc(r)||(r={});var o=t.length>0,s=e.shaderProgram,a=s.vertexShaderSource,l=s.fragmentShaderSource,u=e.pass===Lc.GLOBE,c=!1;if(u&&(c=e.owner.data.renderedMesh.encoding.hasVertexNormals),e.receiveShadows&&o){var h,p;hc(r.receiveCommand)&&(h=r.receiveCommand.shaderProgram,p=r.receiveCommand.uniformMap),r.receiveCommand=Ac.shallowClone(e,r.receiveCommand),r.castShadows=!1,r.receiveShadows=!0;var d=r.receiveShaderCastShadows!==e.castShadows,f=r.receiveShaderProgramId!==e.shaderProgram.id;if(!hc(h)||f||i||d){var g;if(g=t[0].isViewShed?function(t,e,i,n){return"view receiveShadow "+t._usesDepthTexture+t._polygonOffsetSupported+t._isPointLight+t._isSpotLight+(t._numberOfCascades>1)+t.debugCascadeColors+t.softShadows+e+i+n}(t[0],e.castShadows,u,c):qc.getShadowReceiveShaderKeyword(t[0],e.castShadows,u,c),h=n.shaderCache.getDerivedShaderProgram(s,g),!hc(h)){var m,_=qc.createShadowReceiveVertexShader(a,u,c);m=t[0].isViewShed?function(t,e,i,n,r){for(var o=Yc.findNormalVarying(t),s=!n&&hc(o)||n&&r,a=Yc.findPositionVarying(t),l=hc(a),u=e._usesDepthTexture,c=e._polygonOffsetSupported,h=e._isPointLight,p=e._isSpotLight,d=e._numberOfCascades>1,f=e.debugCascadeColors,g=e.softShadows,m=h?e._pointBias:n?e._terrainBias:e._primitiveBias,_=t.defines.slice(0),y=t.sources.slice(0),v=y.length,C=0;C<v;++C)y[C]=Yc.replaceMain(y[C],"czm_shadow_receive_main");h?_.push("USE_CUBE_MAP_SHADOW"):u&&_.push("USE_SHADOW_DEPTH_TEXTURE"),g&&!h&&_.push("USE_SOFT_SHADOWS"),d&&i&&n&&(s?_.push("ENABLE_VERTEX_LIGHTING"):_.push("ENABLE_DAYNIGHT_SHADING")),i&&m.normalShading&&s&&(_.push("USE_NORMAL_SHADING"),m.normalShadingSmooth>0&&_.push("USE_NORMAL_SHADING_SMOOTH"));var x="";return x+=h?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",x+="uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nvarying vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n"+(l?"    return vec4("+a+", 1.0); \n":"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n")+"} \nvec3 getNormalEC() \n{ \n"+(s?"    return normalize("+o+"); \n":"    return vec3(1.0); \n")+"} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n"+(m.normalOffset&&s?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":"")+"} \n",x+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",x+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",n?x+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":c||(x+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),x+=h?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":p?"    vec3 directionEC1 = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC1); \n    if (distance > shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.y) \n    { \n        return; \n    } \n    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":d?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(f?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",x+="   if(visibility==0.0) \n   {\n        gl_FragColor.rgb *= vec3(0.8,0.0,0.0);\n   }else{\n        gl_FragColor.rgb *= vec3(0.0,0.8,0.0) * visibility;\n   } \n } \n ",y.push(x),new Yc({defines:_,sources:y})}(l,t[0],e.castShadows,u,c):qc.createShadowReceiveFragmentShader(l,t[0],e.castShadows,u,c),h=n.shaderCache.createDerivedShaderProgram(s,g,{vertexShaderSource:_,fragmentShaderSource:m,attributeLocations:s._attributeLocations})}p=function(t,e,i){var n=t._isPointLight?t._pointBias:i?t._terrainBias:t._primitiveBias,r={shadowMap_texture:function(){return t._shadowMapTexture},shadowMap_textureCube:function(){return t._shadowMapTexture},shadowMap_matrix:function(){return t._shadowMapMatrix},shadowMap_cascadeSplits:function(){return t._cascadeSplits},shadowMap_cascadeMatrices:function(){return t._cascadeMatrices},shadowMap_lightDirectionEC:function(){return t._lightDirectionEC},shadowMap_lightPositionEC:function(){return t._lightPositionEC},shadowMap_cascadeDistances:function(){return t._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var e=Nh;return e.x=1/t._textureSize.x,e.y=1/t._textureSize.y,rc.fromElements(e.x,e.y,n.depthBias,n.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return rc.fromElements(n.normalOffsetScale,t._distance,t.maximumDistance,t._darkness,this.combinedUniforms2)},combinedUniforms1:new rc,combinedUniforms2:new rc};return lc(e,r,!1)}(t[0],e.uniformMap,u)}r.receiveCommand.shaderProgram=h,r.receiveCommand.uniformMap=p,r.receiveShaderProgramId=e.shaderProgram.id,r.receiveShaderCastShadows=e.castShadows}return r},Xc.prototype.isDestroyed=function(){return!1},Xc.prototype.destroy=function(){Zc(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var t=0;t<this._numberOfCascades;++t)this._debugCascadeFrustums[t]=this._debugCascadeFrustums[t]&&this._debugCascadeFrustums[t].destroy();return dc(this)};var Mh='#ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform bool u_showIntersection;\nuniform bool u_showThroughEllipsoid;\n\nuniform float u_radius;\nuniform float u_xHalfAngle;\nuniform float u_yHalfAngle;\nuniform float u_normalDirection;\nuniform vec4 u_color;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvec4 getColor(float sensorRadius, vec3 pointEC)\n{\n  czm_materialInput materialInput;\n\n  vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\n  materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\n  materialInput.str = pointMC / sensorRadius;\n\n  vec3 positionToEyeEC = -v_positionEC;\n  materialInput.positionToEyeEC = positionToEyeEC;\n\n  vec3 normalEC = normalize(v_normalEC);\n  materialInput.normalEC = u_normalDirection * normalEC;\n\n  czm_material material = czm_getMaterial(materialInput);\n\n  material.diffuse = u_color.rgb;\n  material.alpha = u_color.a;\n\n  return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);\n\n}\n\nbool isOnBoundary(float value, float epsilon)\n{\n  float width = getIntersectionWidth();\n  float tolerance = width * epsilon;\n\n#ifdef GL_OES_standard_derivatives\n  float delta = max(abs(dFdx(value)), abs(dFdy(value)));\n  float pixels = width * delta;\n  float temp = abs(value);\n  // There are a couple things going on here.\n  // First we test the value at the current fragment to see if it is within the tolerance.\n  // We also want to check if the value of an adjacent pixel is within the tolerance,\n  // but we don\'t want to admit points that are obviously not on the surface.\n  // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\n  // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\n  // the points is close to zero.\n  return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\n#else\n  return abs(value) < tolerance;\n#endif\n}\n\nvec4 shade(bool isOnBoundary)\n{\n  if (u_showIntersection && isOnBoundary)\n  {\n      return getIntersectionColor();\n  }\n  return getColor(u_radius, v_positionEC);\n}\n\nfloat ellipsoidSurfaceFunction(czm_ellipsoid ellipsoid, vec3 point)\n{\n  vec3 scaled = ellipsoid.inverseRadii * point;\n  return dot(scaled, scaled) - 1.0;\n}\n\nvoid main()\n{\n  vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\n  vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\n\n  //vec3 pixDir = normalize(v_position);\n  float positionX = v_position.x;\n  float positionY = v_position.y;\n  float positionZ = v_position.z;\n\n  vec3 zDir = vec3(0.0, 0.0, 1.0);\n  vec3 lineX = vec3(positionX, 0 ,positionZ);\n  vec3 lineY = vec3(0, positionY, positionZ);\n  float resX = dot(normalize(lineX), zDir);\n  if(resX < cos(u_xHalfAngle) - 0.0001){\n      discard;\n  }\n  float resY = dot(normalize(lineY), zDir);\n  if(resY < cos(u_yHalfAngle)- 0.0001){\n      discard;\n  }\n\n\n  czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n  float ellipsoidValue = ellipsoidSurfaceFunction(ellipsoid, v_positionWC);\n\n  // Occluded by the ellipsoid?\nif (!u_showThroughEllipsoid)\n{\n    // Discard if in the ellipsoid\n    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\n    if (ellipsoidValue < 0.0)\n    {\n          discard;\n    }\n\n    // Discard if in the sensor\'s shadow\n    if (inSensorShadow(sensorVertexWC, ellipsoid, v_positionWC))\n    {\n        discard;\n    }\n  }\n\n  // Notes: Each surface functions should have an associated tolerance based on the floating point error.\n  bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\n  gl_FragColor = shade(isOnEllipsoid);\n\n}',Dh="\nuniform vec4 u_intersectionColor;\nuniform float u_intersectionWidth;\nuniform vec4 u_lineColor;\nbool inSensorShadow(vec3 coneVertexWC, czm_ellipsoid ellipsoidEC, vec3 pointWC)\n{\n  // Diagonal matrix from the unscaled ellipsoid space to the scaled space.\n  vec3 D = ellipsoidEC.inverseRadii;\n\n  // Sensor vertex in the scaled ellipsoid space\n  vec3 q = D * coneVertexWC;\n  float qMagnitudeSquared = dot(q, q);\n  float test = qMagnitudeSquared - 1.0;\n\n  // Sensor vertex to fragment vector in the ellipsoid's scaled space\n  vec3 temp = D * pointWC - q;\n  float d = dot(temp, q);\n\n  // Behind silhouette plane and inside silhouette cone\n  return (d < -test) && (d / length(temp) < -sqrt(test));\n}\n\n///////////////////////////////////////////////////////////////////////////////\n\nvec4 getLineColor()\n{\n  return u_lineColor;\n}\n\nvec4 getIntersectionColor()\n{\n  return u_intersectionColor;\n}\n\nfloat getIntersectionWidth()\n{\n  return u_intersectionWidth;\n}\n\nvec2 sensor2dTextureCoordinates(float sensorRadius, vec3 pointMC)\n{\n  // (s, t) both in the range [0, 1]\n  float t = pointMC.z / sensorRadius;\n  float s = 1.0 + (atan(pointMC.y, pointMC.x) / czm_twoPi);\n  s = s - floor(s);\n\n  return vec2(s, t);\n}",Rh='\n#ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform bool u_showIntersection;\nuniform bool u_showThroughEllipsoid;\n\nuniform float u_radius;\nuniform float u_xHalfAngle;\nuniform float u_yHalfAngle;\nuniform float u_normalDirection;\nuniform float u_type;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvec4 getColor(float sensorRadius, vec3 pointEC)\n{\n  czm_materialInput materialInput;\n\n  vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\n  materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\n  materialInput.str = pointMC / sensorRadius;\n\n  vec3 positionToEyeEC = -v_positionEC;\n  materialInput.positionToEyeEC = positionToEyeEC;\n\n  vec3 normalEC = normalize(v_normalEC);\n  materialInput.normalEC = u_normalDirection * normalEC;\n\n  czm_material material = czm_getMaterial(materialInput);\n\n  return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);\n\n}\n\nbool isOnBoundary(float value, float epsilon)\n{\n  float width = getIntersectionWidth();\n  float tolerance = width * epsilon;\n\n#ifdef GL_OES_standard_derivatives\n  float delta = max(abs(dFdx(value)), abs(dFdy(value)));\n  float pixels = width * delta;\n  float temp = abs(value);\n  // There are a couple things going on here.\n  // First we test the value at the current fragment to see if it is within the tolerance.\n  // We also want to check if the value of an adjacent pixel is within the tolerance,\n  // but we don\'t want to admit points that are obviously not on the surface.\n  // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\n  // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\n  // the points is close to zero.\n  return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\n#else\n  return abs(value) < tolerance;\n#endif\n}\n\nvec4 shade(bool isOnBoundary)\n{\n  if (u_showIntersection && isOnBoundary)\n  {\n      return getIntersectionColor();\n  }\n  if(u_type == 1.0){\n      return getLineColor();\n  }\n  return getColor(u_radius, v_positionEC);\n}\n\nfloat ellipsoidSurfaceFunction(czm_ellipsoid ellipsoid, vec3 point)\n{\n  vec3 scaled = ellipsoid.inverseRadii * point;\n  return dot(scaled, scaled) - 1.0;\n}\n\nvoid main()\n{\n  vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\n  vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\n\n  //vec3 pixDir = normalize(v_position);\n  float positionX = v_position.x;\n  float positionY = v_position.y;\n  float positionZ = v_position.z;\n\n  vec3 zDir = vec3(0.0, 0.0, 1.0);\n  vec3 lineX = vec3(positionX, 0 ,positionZ);\n  vec3 lineY = vec3(0, positionY, positionZ);\n  float resX = dot(normalize(lineX), zDir);\n  if(resX < cos(u_xHalfAngle)-0.00001){\n      discard;\n  }\n  float resY = dot(normalize(lineY), zDir);\n  if(resY < cos(u_yHalfAngle)-0.00001){\n      discard;\n  }\n\n\n  czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n  float ellipsoidValue = ellipsoidSurfaceFunction(ellipsoid, v_positionWC);\n\n  // Occluded by the ellipsoid?\nif (!u_showThroughEllipsoid)\n{\n    // Discard if in the ellipsoid\n    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\n    if (ellipsoidValue < 0.0)\n    {\n          discard;\n    }\n\n    // Discard if in the sensor\'s shadow\n    if (inSensorShadow(sensorVertexWC, ellipsoid, v_positionWC))\n    {\n        discard;\n    }\n  }\n\n  // Notes: Each surface functions should have an associated tolerance based on the floating point error.\n  bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\n  //isOnEllipsoid = false;\n  //if((resX >= 0.8 && resX <= 0.81)||(resY >= 0.8 && resY <= 0.81)){\n  /*if(false){\n      gl_FragColor = vec4(1.0,0.0,0.0,1.0);\n  }else{\n      gl_FragColor = shade(isOnEllipsoid);\n  }\n*/\n  gl_FragColor = shade(isOnEllipsoid);\n\n}',Oh="attribute vec4 position;\nattribute vec3 normal;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n  gl_Position = czm_modelViewProjection * position;\n  v_position = vec3(position);\n  v_positionWC = (czm_model * position).xyz;\n  v_positionEC = (czm_modelView * position).xyz;\n  v_normalEC = czm_normal * normal;\n}";const{Matrix4:Fh,Material:kh,Color:zh,JulianDate:Gh,BoundingSphere:Bh,DrawCommand:Uh,PrimitiveType:Vh,SceneMode:Hh,Matrix3:Wh,Buffer:jh,BufferUsage:qh,VertexArray:Yh,VertexFormat:Xh,ComponentDatatype:$h,RenderState:Jh,BlendingState:Qh,Pass:Zh,combine:Kh,CullFace:tp,Cartesian3:ep,EllipsoidGeometry:ip,EllipsoidOutlineGeometry:np,ShaderSource:rp,ShaderProgram:op}=Cesium,{cos:sp,sin:ap,tan:lp,atan:up}=Math,cp=Cesium.Math,hp={position:0,normal:1};class pp{constructor(t){t=Fl(t,Fl.EMPTY_OBJECT);const e=this;if(this._createVS=!0,this._createRS=!0,this._createSP=!0,this.show=Fl(t.show,!0),this.slice=Fl(t.slice,32),t.modelMatrix)this._modelMatrix=Fh.clone(t.modelMatrix,new Fh);else{if(!t.position)throw new Ol("parameter position or modelMatrix must be provided.");this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(zl.toCartesian(t.position))}this._computedModelMatrix=new Fh,this._computedScanPlaneModelMatrix=new Fh,this._radius=Fl(t.radius,Number.POSITIVE_INFINITY),this._xHalfAngle=cp.toRadians(Fl(t.xHalfAngle,0)),this._yHalfAngle=cp.toRadians(Fl(t.yHalfAngle,0)),this._color=Fl(t._color,zh.AQUA.withAlpha(.4)),this.lineColor=Fl(t.lineColor,zh.WHITE),this.showSectorLines=Fl(t.showSectorLines,!0),this.showSectorSegmentLines=Fl(t.showSectorSegmentLines,!0),this.showLateralSurfaces=Fl(t.showLateralSurfaces,!0),this._material=kl(t.material)?t.material:kh.fromType(kh.ColorType),this._material.uniforms.color=this._color,this._translucent=void 0,this.lateralSurfaceMaterial=kl(t.lateralSurfaceMaterial)?t.lateralSurfaceMaterial:kh.fromType(kh.ColorType),this._lateralSurfaceMaterial=void 0,this._lateralSurfaceTranslucent=void 0,this.showDomeSurfaces=Fl(t.showDomeSurfaces,!0),this.domeSurfaceMaterial=kl(t.domeSurfaceMaterial)?t.domeSurfaceMaterial:kh.fromType(kh.ColorType),this.showDomeLines=Fl(t.showDomeLines,!0),this.showIntersection=Fl(t.showIntersection,!1),this.intersectionColor=Fl(t.intersectionColor,zh.WHITE),this.intersectionWidth=Fl(t.intersectionWidth,5),this._showThroughEllipsoid=Fl(t.showThroughEllipsoid,!1),this.showScanPlane=Fl(t.showScanPlane,!0),this.scanPlaneColor=Fl(t.scanPlaneColor,zh.AQUA),this.scanPlaneMode=Fl(t.scanPlaneMode,"H"),this.speed=Fl(t.speed,10),this._scanePlaneXHalfAngle=0,this._scanePlaneYHalfAngle=0,this._time=Gh.now(),this._boundingSphere=new Bh,this._boundingSphereWC=new Bh,this._boundingSphere=new Bh(ep.ZERO,this._radius),Fh.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),Bh.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC),this._sectorFrontCommand=new Uh({owner:this,primitiveType:Vh.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorBackCommand=new Uh({owner:this,primitiveType:Vh.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorVA=void 0,this._sectorLineCommand=new Uh({owner:this,primitiveType:Vh.LINES,boundingVolume:this._boundingSphereWC}),this._sectorLineVA=void 0,this._sectorSegmentLineCommand=new Uh({owner:this,primitiveType:Vh.LINES,boundingVolume:this._boundingSphereWC}),this._sectorSegmentLineVA=void 0,this._domeFrontCommand=new Uh({owner:this,primitiveType:Vh.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeBackCommand=new Uh({owner:this,primitiveType:Vh.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeVA=void 0,this._domeLineCommand=new Uh({owner:this,primitiveType:Vh.LINES,boundingVolume:this._boundingSphereWC}),this._domeLineVA=void 0,this._scanPlaneFrontCommand=new Uh({owner:this,primitiveType:Vh.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanPlaneBackCommand=new Uh({owner:this,primitiveType:Vh.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanRadialCommand=void 0,this._colorCommands=[],this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._uniforms={u_type:function(){return 0},u_xHalfAngle:function(){return e._xHalfAngle},u_yHalfAngle:function(){return e._yHalfAngle},u_radius:function(){return e.radius},u_showThroughEllipsoid:function(){return e.showThroughEllipsoid},u_showIntersection:function(){return e.showIntersection},u_intersectionColor:function(){return e.intersectionColor},u_intersectionWidth:function(){return e.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return e.lineColor}},this._scanUniforms={u_xHalfAngle:function(){return e._scanePlaneXHalfAngle},u_yHalfAngle:function(){return e._scanePlaneYHalfAngle},u_radius:function(){return e.radius},u_color:function(){return e.scanPlaneColor},u_showThroughEllipsoid:function(){return e.showThroughEllipsoid},u_showIntersection:function(){return e.showIntersection},u_intersectionColor:function(){return e.intersectionColor},u_intersectionWidth:function(){return e.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return e.lineColor}}}get color(){return this._color}set color(t){this._color=t,this._material.uniforms.color=t}get boundingSphere(){return this._boundingSphere}get xHalfAngle(){return cp.toDegrees(this._xHalfAngle)}set xHalfAngle(t){this._xHalfAngle!==t&&(this._xHalfAngle=cp.toRadians(t),this._createVS=!0)}get yHalfAngle(){return cp.toDegrees(this._yHalfAngle)}set yHalfAngle(t){this._yHalfAngle!==t&&(this._yHalfAngle=cp.toRadians(t),this._createVS=!0)}get radius(){return this._radius}set radius(t){this._radius!==t&&(this._radius=t,this._boundingSphere=new Bh(ep.ZERO,t),Fh.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),Bh.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC))}get modelMatrix(){return this._modelMatrix}set modelMatrix(t){!Fh.equals(t,this._modelMatrix)&&(Fh.clone(t,this._modelMatrix),Fh.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),Bh.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC))}get showThroughEllipsoid(){return this._showThroughEllipsoid}set showThroughEllipsoid(t){this._showThroughEllipsoid!==t&&(this._showThroughEllipsoid=t,this._createRS=!0)}get material(){return this._material}set material(t){this._material=t,this._createRS=!0,this._createSP=!0}update(t){const e=t.mode;if(!this.show||e!==Hh.SCENE3D)return;const i=this._xHalfAngle,n=this._yHalfAngle;if(i<0||n<0)throw new Ol("halfAngle must be greater than or equal to zero.");if(0==i||0==n)return;if(this.radius<0)throw new Ol("this.radius must be greater than or equal to zero.");const r=this.showThroughEllipsoid,o=this.material,s=o.isTranslucent();if(this._translucent!==s&&(this._translucent=s,this._createRS=!0),this.showScanPlane){const e=t.time;let r,o,s=Gh.secondsDifference(e,this._time);if(s<0&&(this._time=Gh.clone(e,this._time)),this.speed<=0)r=0;else{const t=10/this.speed;r=Math.max(s%t/t,0)}const a=new Wh;if("H"==this.scanPlaneMode){o=2*n*r-n;const t=sp(o),e=lp(i),s=up(t*e);this._scanePlaneXHalfAngle=s,this._scanePlaneYHalfAngle=o,Wh.fromRotationX(this._scanePlaneYHalfAngle,a)}else{o=2*i*r-i;const t=lp(n),e=sp(o),s=up(e*t);this._scanePlaneXHalfAngle=o,this._scanePlaneYHalfAngle=s,Wh.fromRotationY(this._scanePlaneXHalfAngle,a)}Fh.multiplyByMatrix3(this.modelMatrix,a,this._computedScanPlaneModelMatrix),Fh.multiplyByUniformScale(this._computedScanPlaneModelMatrix,this.radius,this._computedScanPlaneModelMatrix)}this._createVS&&function(t,e){const i=e.context,n=fp(t,t._xHalfAngle,t._yHalfAngle),r=function(t,e){const i=t._xHalfAngle,n=t._yHalfAngle,r=e.zoy,o=e.zox,s=[],a=new Wh;let l=Wh.fromRotationY(i,a);return s.push(r.map((function(t){return Wh.multiplyByVector(l,t,new ep)}))),l=Wh.fromRotationX(-n,a),s.push(o.map((function(t){return Wh.multiplyByVector(l,t,new ep)})).reverse()),l=Wh.fromRotationY(-i,a),s.push(r.map((function(t){return Wh.multiplyByVector(l,t,new ep)})).reverse()),l=Wh.fromRotationX(n,a),s.push(o.map((function(t){return Wh.multiplyByVector(l,t,new ep)}))),s}(t,n);t.showLateralSurfaces&&(t._sectorVA=function(t,e){const i=Array.prototype.concat.apply([],e).length-e.length,n=new Float32Array(18*i);let r=0;for(let t=0,i=e.length;t<i;t++){const i=e[t],o=new ep,s=ep.normalize(ep.cross(i[0],i[i.length-1],o),o);for(let t=0,e=i.length-1;t<e;t++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z,n[r++]=i[t].x,n[r++]=i[t].y,n[r++]=i[t].z,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z,n[r++]=i[t+1].x,n[r++]=i[t+1].y,n[r++]=i[t+1].z,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z}const o=jh.createVertexBuffer({context:t,typedArray:n,usage:qh.STATIC_DRAW}),s=6*Float32Array.BYTES_PER_ELEMENT,a=[{index:hp.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:$h.FLOAT,offsetInBytes:0,strideInBytes:s},{index:hp.normal,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:$h.FLOAT,offsetInBytes:3*Float32Array.BYTES_PER_ELEMENT,strideInBytes:s}];return new Yh({context:t,attributes:a})}(i,r));t.showSectorLines&&(t._sectorLineVA=function(t,e){const i=e.length,n=new Float32Array(9*i);let r=0;for(let t=0,i=e.length;t<i;t++){const i=e[t];n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=i[0].x,n[r++]=i[0].y,n[r++]=i[0].z}const o=jh.createVertexBuffer({context:t,typedArray:n,usage:qh.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:hp.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:$h.FLOAT,offsetInBytes:0,strideInBytes:s}];return new Yh({context:t,attributes:a})}(i,r));t.showSectorSegmentLines&&(t._sectorSegmentLineVA=function(t,e){const i=Array.prototype.concat.apply([],e).length-e.length,n=new Float32Array(9*i);let r=0;for(let t=0,i=e.length;t<i;t++){const i=e[t];for(let t=0,e=i.length-1;t<e;t++)n[r++]=i[t].x,n[r++]=i[t].y,n[r++]=i[t].z,n[r++]=i[t+1].x,n[r++]=i[t+1].y,n[r++]=i[t+1].z}const o=jh.createVertexBuffer({context:t,typedArray:n,usage:qh.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:hp.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:$h.FLOAT,offsetInBytes:0,strideInBytes:s}];return new Yh({context:t,attributes:a})}(i,r));t.showDomeSurfaces&&(t._domeVA=function(t){const e=ip.createGeometry(new ip({vertexFormat:Xh.POSITION_ONLY,stackPartitions:32,slicePartitions:32}));return Yh.fromGeometry({context:t,geometry:e,attributeLocations:hp,bufferUsage:qh.STATIC_DRAW,interleave:!1})}(i));t.showDomeLines&&(t._domeLineVA=function(t){const e=np.createGeometry(new np({vertexFormat:Xh.POSITION_ONLY,stackPartitions:32,slicePartitions:32}));return Yh.fromGeometry({context:t,geometry:e,attributeLocations:hp,bufferUsage:qh.STATIC_DRAW,interleave:!1})}(i));if(t.showScanPlane)if("H"==t.scanPlaneMode){const e=fp(t,cp.PI_OVER_TWO,0);t._scanPlaneVA=gp(i,e.zox)}else{const e=fp(t,0,cp.PI_OVER_TWO);t._scanPlaneVA=gp(i,e.zoy)}}(this,t),this._createRS&&function(t,e,i){i?(t._frontFaceRS=Jh.fromCache({depthTest:{enabled:!e},depthMask:!1,blending:Qh.ALPHA_BLEND,cull:{enabled:!0,face:tp.BACK}}),t._backFaceRS=Jh.fromCache({depthTest:{enabled:!e},depthMask:!1,blending:Qh.ALPHA_BLEND,cull:{enabled:!0,face:tp.FRONT}}),t._pickRS=Jh.fromCache({depthTest:{enabled:!e},depthMask:!1,blending:Qh.ALPHA_BLEND})):(t._frontFaceRS=Jh.fromCache({depthTest:{enabled:!e},depthMask:!0}),t._pickRS=Jh.fromCache({depthTest:{enabled:!0},depthMask:!0}))}(this,r,s),this._createSP&&function(t,e,i){(function(t,e,i){const n=e.context,r=Oh,o=new rp({sources:[Dh,i.shaderSource,Rh]});t._sp=op.replaceCache({context:n,shaderProgram:t._sp,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:hp});const s=new rp({sources:[Dh,i.shaderSource,Rh],pickColorQualifier:"uniform"});t._pickSP=op.replaceCache({context:n,shaderProgram:t._pickSP,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:hp})})(t,e,i),t.showScanPlane&&function(t,e,i){const n=e.context,r=Oh,o=new rp({sources:[Dh,i.shaderSource,Mh]});t._scanePlaneSP=op.replaceCache({context:n,shaderProgram:t._scanePlaneSP,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:hp})}(t,e,i)}(this,t,o),(this._createRS||this._createSP)&&function(t,e){t._colorCommands.length=0;const i=e?Zh.TRANSLUCENT:Zh.OPAQUE;t.showLateralSurfaces&&dp(t,t._sectorFrontCommand,t._sectorBackCommand,t._frontFaceRS,t._backFaceRS,t._sp,t._sectorVA,t._uniforms,t._computedModelMatrix,e,i);t.showSectorLines&&dp(t,t._sectorLineCommand,void 0,t._frontFaceRS,t._backFaceRS,t._sp,t._sectorLineVA,t._uniforms,t._computedModelMatrix,e,i,!0);t.showSectorSegmentLines&&dp(t,t._sectorSegmentLineCommand,void 0,t._frontFaceRS,t._backFaceRS,t._sp,t._sectorSegmentLineVA,t._uniforms,t._computedModelMatrix,e,i,!0);t.showDomeSurfaces&&dp(t,t._domeFrontCommand,t._domeBackCommand,t._frontFaceRS,t._backFaceRS,t._sp,t._domeVA,t._uniforms,t._computedModelMatrix,e,i);t.showDomeLines&&dp(t,t._domeLineCommand,void 0,t._frontFaceRS,t._backFaceRS,t._sp,t._domeLineVA,t._uniforms,t._computedModelMatrix,e,i,!0);t.showScanPlane&&dp(t,t._scanPlaneFrontCommand,t._scanPlaneBackCommand,t._frontFaceRS,t._backFaceRS,t._scanePlaneSP,t._scanPlaneVA,t._scanUniforms,t._computedScanPlaneModelMatrix,e,i)}(this,s);const a=t.commandList,l=t.passes,u=this._colorCommands;if(l.render)for(let t=0,e=u.length;t<e;t++){const e=u[t];a.push(e)}}destroy(){this._pickSP.destroy(),this._sp=this._sp.destroy(),this._scanePlaneSP&&(this._scanePlaneSP=this._scanePlaneSP.destroy()),Wu(this)}}function dp(t,e,i,n,r,o,s,a,l,u,c,h){u&&i&&(i.vertexArray=s,i.renderState=r,i.shaderProgram=o,i.uniformMap=Kh(a,t._material._uniforms),i.uniformMap.u_normalDirection=function(){return-1},i.pass=c,i.modelMatrix=l,t._colorCommands.push(i)),e.vertexArray=s,e.renderState=n,e.shaderProgram=o,e.uniformMap=Kh(a,t._material._uniforms),h&&(e.uniformMap.u_type=function(){return 1}),e.pass=c,e.modelMatrix=l,t._colorCommands.push(e)}function fp(t,e,i){const n=t.slice,r=sp(i),o=lp(i),s=sp(e),a=lp(e),l=up(s*o),u=up(r*a),c=[];for(let t=0;t<n;t++){const e=2*l*t/(n-1)-l;c.push(new ep(0,ap(e),sp(e)))}const h=[];for(let t=0;t<n;t++){const e=2*u*t/(n-1)-u;h.push(new ep(ap(e),0,sp(e)))}return{zoy:c,zox:h}}function gp(t,e){const i=e.length-1,n=new Float32Array(9*i);let r=0;for(let t=0;t<i;t++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=e[t].x,n[r++]=e[t].y,n[r++]=e[t].z,n[r++]=e[t+1].x,n[r++]=e[t+1].y,n[r++]=e[t+1].z;const o=jh.createVertexBuffer({context:t,typedArray:n,usage:qh.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:hp.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:$h.FLOAT,offsetInBytes:0,strideInBytes:s}];return new Yh({context:t,attributes:a})}const mp=Cesium.Math;function _p(){throw new Ol("抽象方法无法被调用。")}const{WebGLConstants:yp}=Cesium,vp={};function Cp(t){this._size=t.size,this._datatype=t.datatype,this.getValue=t.getValue}vp[yp.FLOAT]="float",vp[yp.FLOAT_VEC2]="vec2",vp[yp.FLOAT_VEC3]="vec3",vp[yp.FLOAT_VEC4]="vec4",vp[yp.INT]="int",vp[yp.INT_VEC2]="ivec2",vp[yp.INT_VEC3]="ivec3",vp[yp.INT_VEC4]="ivec4",vp[yp.BOOL]="bool",vp[yp.BOOL_VEC2]="bvec2",vp[yp.BOOL_VEC3]="bvec3",vp[yp.BOOL_VEC4]="bvec4",vp[yp.FLOAT_MAT2]="mat2",vp[yp.FLOAT_MAT3]="mat3",vp[yp.FLOAT_MAT4]="mat4",vp[yp.SAMPLER_2D]="sampler2D",vp[yp.SAMPLER_CUBE]="samplerCube";const xp=Cesium.AutomaticUniforms,wp={czm_p_drawingBufferWidth:new Cp({size:1,datatype:yp.FLOAT,getValue:function(t){return t.frameState.context.drawingBufferWidth}}),czm_p_drawingBufferHeight:new Cp({size:1,datatype:yp.FLOAT,getValue:function(t){return t.frameState.context.drawingBufferHeight}}),czm_p_splitPosition:new Cp({size:1,datatype:yp.FLOAT,getValue:function(t){return t.frameState.splitPosition}})};function bp(t){const e=Object.assign({},wp),i=Object.keys(e);for(let t of i)xp[t]=e[t]}const{Cartesian3:Ep,Primitive:Sp,Material:Tp,Geometry:Pp,MaterialAppearance:Ap,GeometryAttribute:Ip,ComponentDatatype:Lp,PrimitiveType:Np,BoundingSphere:Mp,VertexFormat:Dp,defaultValue:Rp,GeometryAttributes:Op,Check:Fp}=Cesium,kp=new Dp,zp=new Ep;class Gp{constructor(t={}){this._normal=t.normal,this._radius=t.radius,this._center=t.center;const e=Rp(t.vertexFormat,Dp.DEFAULT);this._vertexFormat=e}static packedLength=Dp.packedLength+Ep.packedLength+1;static pack(t,e,i){return i=Rp(i,0),Dp.pack(t._vertexFormat,e,i),i+=Dp.packedLength,Ep.pack(t._normal,e,i),i+=Ep.packedLength,e[i++]=t._radius,e}static unpack(t,e,i){e=Rp(e,0);const n=Dp.unpack(t,e,kp);e+=Dp.packedLength;const r=Ep.unpack(t,e,zp),o=t[e+=Ep.packedLength];return defined(i)?(i._vertexFormat=Dp.clone(n,i._vertexFormat),i._normal=Ep.clone(r,i._normal),i._radius=o,i):new PlaneGeometry({vertexFormat:n,normal:r,radius:o})}static createGeometry(t){const e=Math.max(1,.02*t._radius),i=Math.max(.2*t._radius,2*e);let n=[],r=[];const{x:o,y:s,z:a}=t._center;let l;Ep.equals(t._normal,Ep.UNIT_X)?(n=[o,-e+s,e+a,o,-i+s,e+a,o,-i+s,i+a,o,-e+s,i+a],l=new Ep(o,-(e+i)/2+s,(e+i)/2+a),r=[1,0,0,1,0,0,1,0,0,1,0,0]):Ep.equals(t._normal,Ep.UNIT_Y)?(n=[e+o,s,e+a,i+o,s,e+a,i+o,s,i+a,e+o,s,i+a],l=new Ep((e+i)/2+o,s,(e+i)/2+a),r=[0,1,0,0,1,0,0,1,0,0,1,0]):Ep.equals(t._normal,Ep.UNIT_Z)&&(n=[e+o,-e+s,a,i+o,-e+s,a,i+o,-i+s,a,e+o,-i+s,a],l=new Ep((e+i)/2+o,-(e+i)/2+s,a),r=[0,0,1,0,0,1,0,0,1,0,0,1]),n=new Float32Array([...n]);const u=new Float32Array([0,0,1,0,1,1,0,1]),c=new Uint16Array([0,1,2,2,3,0]);return new Pp({attributes:new Op({position:new Ip({componentDatatype:Lp.DOUBLE,componentsPerAttribute:3,values:n}),normal:new Ip({componentDatatype:Lp.FLOAT,componentsPerAttribute:3,values:r}),st:new Ip({componentDatatype:Lp.FLOAT,componentsPerAttribute:2,values:u})}),indices:c,primitiveType:Np.TRIANGLES,boundingSphere:new Mp(l,(e+i)/2)})}}class Bp{constructor(t={}){this._center=t.center,this._modelMatrix=t.modelMatrix,this._color=t.color;const e=t.radius;this._normal=t.normal;const i=new Gp({normal:this._normal,radius:e,vertexFormat:Dp.DEFAULT,center:this._center}),n=new Cesium.GeometryInstance({geometry:Gp.createGeometry(i)}),r=new Sp({asynchronous:!1,geometryInstances:n,modelMatrix:this._modelMatrix,appearance:new Ap({material:Tp.fromType("Color",{color:this._color})})});return r.isAxisPlane=!0,r.normal=this._normal,r.axis=t.axis,r.color=this._color,r}}const Up={SURFACE_DISTANCE:1,SPACE_DISTANCE:2,SPACE_AREA:3,SURFACE_AREA:4,HEIGHT:5,ANGLE:6,validate:function(t){return t===Up.SURFACE_AREA||t===Up.SURFACE_DISTANCE||t===Up.SPACE_AREA||t===Up.SPACE_DISTANCE||t===Up.HEIGHT||t===Up.ANGLE},getKey:function(t){let e;switch(t){case 1:e="SURFACE_DISTANCE";break;case 2:e="SPACE_DISTANCE";break;case 3:e="SPACE_AREA";break;case 4:e="SURFACE_AREA";break;case 5:e="HEIGHT";break;case 6:e="ANGLE";break;default:e=void 0}return e},getValue:function(t){let e;switch(t){case 1:e="贴地距离";break;case 2:e="空间距离";break;case 3:e="空间面积";break;case 4:e="贴地面积";break;case 5:e="高度";break;case 6:e="方位角";break;default:e=void 0}return e}};var Vp=Object.freeze(Up);const{RequestState:Hp,AttributeCompression:Wp,BoundingSphere:jp,Cartesian3:qp,Credit:Yp,defaultValue:Xp,defined:$p,DeveloperError:Jp,GeographicTilingScheme:Qp,WebMercatorTilingScheme:Zp,getJsonFromTypedArray:Kp,HeightmapTerrainData:td,IndexDatatype:ed,OrientedBoundingBox:id,QuantizedMeshTerrainData:nd,Request:rd,RequestType:od,Resource:sd,RuntimeError:ad,TerrainProvider:ld,TileAvailability:ud,TileProviderError:cd}=Cesium;function hd(t){this.resource=t.resource,this.version=t.version,this.isHeightmap=t.isHeightmap,this.tileUrlTemplates=t.tileUrlTemplates,this.availability=t.availability,this.hasVertexNormals=t.hasVertexNormals,this.hasWaterMask=t.hasWaterMask,this.hasMetadata=t.hasMetadata,this.availabilityLevels=t.availabilityLevels,this.availabilityTilesLoaded=t.availabilityTilesLoaded,this.littleEndianExtensionSize=t.littleEndianExtensionSize,this.availabilityPromiseCache={}}function pd(t){this._heightmapWidth=65,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._ellipsoid=t.ellipsoid,this._requestVertexNormals=Xp(t.requestVertexNormals,!1),this._requestWaterMask=Xp(t.requestWaterMask,!1),this._requestMetadata=Xp(t.requestMetadata,!0),this._errorEvent=new jl;let e=t.credit;"string"==typeof e&&(e=new Yp(e)),this._credit=e,this._availability=void 0,this._ready=!1,this._tileCredits=void 0;const i=this;let n,r,o;const s=this._layers=[];let a="";const l=[];let u=0;function c(t){let e;if(!t.format)return e="The tile format is not specified in the layer.json file.",o=cd.reportError(o,i,i._errorEvent,e),o.retry?f():Promise.reject(new ad(e));if(!t.tiles||0===t.tiles.length)return e="The layer.json file does not specify any tile URL templates.",o=cd.reportError(o,i,i._errorEvent,e),o.retry?f():Promise.reject(new ad(e));let p=!1,d=!1,g=!1,m=!0,_=!1;if("heightmap-1.0"===t.format)_=!0,$p(i._heightmapStructure)||(i._heightmapStructure={heightScale:.2,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:65535}),d=!0,i._requestWaterMask=!0;else if(0!==t.format.indexOf("quantized-mesh-1."))return e=`The tile format "${t.format}" is invalid or not supported.`,o=cd.reportError(o,i,i._errorEvent,e),o.retry?f():Promise.reject(new ad(e));const y=t.tiles,v=t.maxzoom;if(u=Math.max(u,v),t.projection&&"EPSG:4326"!==t.projection){if("EPSG:3857"!==t.projection)return e=`The projection "${t.projection}" is invalid or not supported.`,o=cd.reportError(o,i,i._errorEvent,e),o.retry?f():Promise.reject(new ad(e));i._tilingScheme=new Zp({numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:i._ellipsoid})}else i._tilingScheme=new Qp({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:i._ellipsoid});if(i._levelZeroMaximumGeometricError=ld.getEstimatedLevelZeroGeometricErrorForAHeightmap(i._tilingScheme.ellipsoid,i._heightmapWidth,i._tilingScheme.getNumberOfXTilesAtLevel(0)),t.scheme&&"tms"!==t.scheme&&"slippyMap"!==t.scheme)return e=`The scheme "${t.scheme}" is invalid or not supported.`,o=cd.reportError(o,i,i._errorEvent,e),o.retry?f():Promise.reject(new ad(e));let C;i._scheme=t.scheme,$p(t.extensions)&&-1!==t.extensions.indexOf("octvertexnormals")?p=!0:$p(t.extensions)&&-1!==t.extensions.indexOf("vertexnormals")&&(p=!0,m=!1),$p(t.extensions)&&-1!==t.extensions.indexOf("watermask")&&(d=!0),$p(t.extensions)&&-1!==t.extensions.indexOf("metadata")&&(g=!0);const x=t.metadataAvailability,w=t.available;let b;if($p(w)&&!$p(x)){b=new ud(i._tilingScheme,w.length);for(let t=0;t<w.length;++t){const e=w[t],n=i._tilingScheme.getNumberOfYTilesAtLevel(t);$p(l[t])||(l[t]=[]);for(let i=0;i<e.length;++i){const r=e[i],o=n-r.endY-1,s=n-r.startY-1;l[t].push([r.startX,o,r.endX,s]),b.addAvailableTileRange(t,r.startX,o,r.endX,s)}}}else $p(x)&&(C=new ud(i._tilingScheme,v),b=new ud(i._tilingScheme,v),l[0]=[[0,0,1,0]],b.addAvailableTileRange(0,0,0,1,0));i._hasWaterMask=i._hasWaterMask||d,i._hasVertexNormals=i._hasVertexNormals||p,i._hasMetadata=i._hasMetadata||g,$p(t.attribution)&&(a.length>0&&(a+=" "),a+=t.attribution),s.push(new hd({resource:n,version:t.version,isHeightmap:_,tileUrlTemplates:y,availability:b,hasVertexNormals:p,hasWaterMask:d,hasMetadata:g,availabilityLevels:x,availabilityTilesLoaded:C,littleEndianExtensionSize:m}));const E=t.parentUrl;if($p(E)){if(!$p(b))return console.log("A layer.json can't have a parentUrl if it does't have an available array."),Promise.resolve(!0);n=n.getDerivedResource({url:E}),n.appendForwardSlash(),r=n.getDerivedResource({url:"layer.json"});const t=r.fetchJson();return Promise.resolve(t).then(c).catch(h)}return Promise.resolve(!0)}function h(t){const e=`An error occurred while accessing ${r.url}.`;return o=cd.reportError(o,i,i._errorEvent,e),o.retry?f():Promise.reject(new ad(e))}function p(t){return c(t).then((function(){if($p(o))return;const t=l.length;if(t>0){const e=i._availability=new ud(i._tilingScheme,u);for(let i=0;i<t;++i){const t=l[i];for(let n=0;n<t.length;++n){const r=t[n];e.addAvailableTileRange(i,r[0],r[1],r[2],r[3])}}}if(a.length>0){const t=new Yp(a);$p(i._tileCredits)?i._tileCredits.push(t):i._tileCredits=[t]}return i._ready=!0,Promise.resolve(!0)}))}function d(t){return $p(t)&&404===t.statusCode?p({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]}):h()}function f(){return Promise.resolve(r.fetchJson()).then(p).catch(d)}this._readyPromise=Promise.resolve(t.url).then((function(t){const e=sd.createIfNeeded(t);return e.appendForwardSlash(),n=e,r=n.getDerivedResource({url:"layer.json"}),i._tileCredits=e.credits,f()}))}const dd=1,fd=2,gd=4;function md(t){if(!$p(t)||0===t.length)return{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"};return{Accept:`application/vnd.quantized-mesh;extensions=${t.join("-")},application/octet-stream;q=0.9,*/*;q=0.01`}}function _d(t,e,i,n,r,o){if(!$p(r))return Promise.reject(new ad("Terrain tile doesn't exist"));const s=r.tileUrlTemplates;if(0===s.length)return;let a;if(t._scheme&&"tms"!==t._scheme)a=i;else{a=t._tilingScheme.getNumberOfYTilesAtLevel(n)-i-1}const l=[];let u,c;t._requestVertexNormals&&r.hasVertexNormals&&l.push(r.littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),t._requestWaterMask&&r.hasWaterMask&&l.push("watermask"),t._requestMetadata&&r.hasMetadata&&l.push("metadata");const h=s[(e+a+n)%s.length],p=r.resource;$p(p._ionEndpoint)&&!$p(p._ionEndpoint.externalType)?(0!==l.length&&(c={extensions:l.join("-")}),u=md(void 0)):u=md(l);const d=p.getDerivedResource({url:h,templateValues:{version:r.version,z:n,x:e,y:a},queryParameters:c,headers:u,request:o}).fetchArrayBuffer();return p.request.state!==Hp.ISSUED&&p.request.state!==Hp.ACTIVE&&$p(d)?d.then((function(o){return $p(o)?$p(t._heightmapStructure)?function(t,e,i,n,r){const o=new Uint16Array(e,0,t._heightmapWidth*t._heightmapWidth);return new td({buffer:o,childTileMask:new Uint8Array(e,o.byteLength,1)[0],waterMask:new Uint8Array(e,o.byteLength+1,e.byteLength-o.byteLength-1),width:t._heightmapWidth,height:t._heightmapWidth,structure:t._heightmapStructure,credits:t._tileCredits})}(t,o):function(t,e,i,n,r,o){const s=o.littleEndianExtensionSize;let a=0;const l=3*Float64Array.BYTES_PER_ELEMENT,u=4*Float64Array.BYTES_PER_ELEMENT,c=3*Uint16Array.BYTES_PER_ELEMENT;let h=Uint16Array.BYTES_PER_ELEMENT,p=3*h;const d=new DataView(e),f=new qp(d.getFloat64(a,!0),d.getFloat64(a+8,!0),d.getFloat64(a+16,!0));a+=l;const g=d.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;const m=d.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;const _=new jp(new qp(d.getFloat64(a,!0),d.getFloat64(a+8,!0),d.getFloat64(a+16,!0)),d.getFloat64(a+l,!0));a+=u;const y=new qp(d.getFloat64(a,!0),d.getFloat64(a+8,!0),d.getFloat64(a+16,!0));a+=l;const v=d.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const C=new Uint16Array(e,a,3*v);a+=v*c,v>65536&&(h=Uint32Array.BYTES_PER_ELEMENT,p=3*h);const x=C.subarray(0,v),w=C.subarray(v,2*v),b=C.subarray(2*v,3*v);Wp.zigZagDeltaDecode(x,w,b),a%h!=0&&(a+=h-a%h);const E=d.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const S=ed.createTypedArrayFromArrayBuffer(v,e,a,3*E);a+=E*p;let T=0;const P=S.length;for(let t=0;t<P;++t){const e=S[t];S[t]=T-e,0===e&&++T}const A=d.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const I=ed.createTypedArrayFromArrayBuffer(v,e,a,A);a+=A*h;const L=d.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const N=ed.createTypedArrayFromArrayBuffer(v,e,a,L);a+=L*h;const M=d.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const D=ed.createTypedArrayFromArrayBuffer(v,e,a,M);a+=M*h;const R=d.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const O=ed.createTypedArrayFromArrayBuffer(v,e,a,R);let F,k;for(a+=R*h;a<d.byteLength;){const l=d.getUint8(a,!0);a+=Uint8Array.BYTES_PER_ELEMENT;const u=d.getUint32(a,s);if(a+=Uint32Array.BYTES_PER_ELEMENT,l===dd&&t._requestVertexNormals)F=new Uint8Array(e,a,2*v);else if(l===fd&&t._requestWaterMask)k=new Uint8Array(e,a,u);else if(l===gd&&t._requestMetadata){const s=d.getUint32(a,!0);if(s>0){const n=Kp(new Uint8Array(e),a+Uint32Array.BYTES_PER_ELEMENT,s).available;if($p(n))for(let e=0;e<n.length;++e){const r=i+e+1,s=n[e],a=t._tilingScheme.getNumberOfYTilesAtLevel(r);for(let e=0;e<s.length;++e){const i=s[e],n=a-i.endY-1,l=a-i.startY-1;t.availability.addAvailableTileRange(r,i.startX,n,i.endX,l),o.availability.addAvailableTileRange(r,i.startX,n,i.endX,l)}}}o.availabilityTilesLoaded.addAvailableTileRange(i,n,r,n,r)}a+=u}const z=5*t.getLevelMaximumGeometricError(i),G=t._tilingScheme.tileXYToRectangle(n,r,i),B=id.fromRectangle(G,g,m,t._tilingScheme.ellipsoid);return new nd({center:f,minimumHeight:g,maximumHeight:m,boundingSphere:_,orientedBoundingBox:B,horizonOcclusionPoint:y,quantizedVertices:C,encodedNormals:F,indices:S,westIndices:I,southIndices:N,eastIndices:D,northIndices:O,westSkirtHeight:z,southSkirtHeight:z,eastSkirtHeight:z,northSkirtHeight:z,childTileMask:t.availability.computeChildMaskForTile(i,n,r),waterMask:k,credits:t._tileCredits})}(t,o,n,e,i,r):Promise.reject(new ad("Mesh buffer doesn't exist."))})):void 0}function yd(t,e,i,n){if(0===n)return;const r=t.availabilityLevels,o=n%r==0?n-r:(n/r|0)*r,s=1<<n-o;return{level:o,x:e/s|0,y:i/s|0}}function vd(t,e,i,n,r,o){if(!$p(r.availabilityLevels))return{result:!1};let s;const a=function(){delete r.availabilityPromiseCache[s]},l=r.availabilityTilesLoaded,u=r.availability;let c=yd(r,e,i,n);for(;$p(c);){if(u.isTileAvailable(c.level,c.x,c.y)&&!l.isTileAvailable(c.level,c.x,c.y)){let e;if(!o&&(s=`${c.level}-${c.x}-${c.y}`,e=r.availabilityPromiseCache[s],!$p(e))){const i=new rd({throttle:!1,throttleByServer:!0,type:od.TERRAIN});e=_d(t,c.x,c.y,c.level,r,i),$p(e)&&(r.availabilityPromiseCache[s]=e,e.then(a))}return{result:!0,promise:e}}c=yd(r,c.x,c.y,c.level)}return{result:!1}}pd.prototype.requestTileGeometry=function(t,e,i,n){const r=this._layers;let o;const s=r.length;if(1===s)o=r[0];else for(let n=0;n<s;++n){const s=r[n];if(!$p(s.availability)||s.availability.isTileAvailable(i,t,e)){o=s;break}}return _d(this,t,e,i,o,n)},Object.defineProperties(pd.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){return this._hasVertexNormals&&this._requestVertexNormals}},hasMetadata:{get:function(){return this._hasMetadata&&this._requestMetadata}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},requestMetadata:{get:function(){return this._requestMetadata}},availability:{get:function(){return this._availability}}}),pd.prototype.getLevelMaximumGeometricError=function(t){return this._levelZeroMaximumGeometricError/(1<<t)},pd.prototype.getTileDataAvailable=function(t,e,i){if(!$p(this._availability))return;if(i>this._availability._maximumLevel)return!1;if(this._availability.isTileAvailable(i,t,e))return!0;if(!this._hasMetadata)return!1;const n=this._layers,r=n.length;for(let o=0;o<r;++o){if(vd(this,t,e,i,n[o],0===o).result)return}return!1},pd.prototype.loadTileDataAvailability=function(t,e,i){if(!$p(this._availability)||i>this._availability._maximumLevel||this._availability.isTileAvailable(i,t,e)||!this._hasMetadata)return;const n=this._layers,r=n.length;for(let o=0;o<r;++o){const r=vd(this,t,e,i,n[o],0===o);if($p(r.promise))return r.promise}},pd._getAvailabilityTile=yd;const{AssociativeArray:Cd,AutomaticUniforms:xd,ShaderSource:wd,WebGLConstants:bd}=Cesium,Ed={};Ed[bd.FLOAT]="float",Ed[bd.FLOAT_VEC2]="vec2",Ed[bd.FLOAT_VEC3]="vec3",Ed[bd.FLOAT_VEC4]="vec4",Ed[bd.INT]="int",Ed[bd.INT_VEC2]="ivec2",Ed[bd.INT_VEC3]="ivec3",Ed[bd.INT_VEC4]="ivec4",Ed[bd.BOOL]="bool",Ed[bd.BOOL_VEC2]="bvec2",Ed[bd.BOOL_VEC3]="bvec3",Ed[bd.BOOL_VEC4]="bvec4",Ed[bd.FLOAT_MAT2]="mat2",Ed[bd.FLOAT_MAT3]="mat3",Ed[bd.FLOAT_MAT4]="mat4",Ed[bd.SAMPLER_2D]="sampler2D",Ed[bd.SAMPLER_CUBE]="samplerCube";class Sd{constructor(t){this._size=t.size,this._datatype=t.datatype,this.getValue=t.getValue,this._simpleType=Fl(t.simpleType,!1)}getDeclaration(t){let e=`uniform ${Ed[this._datatype]} ${t}`;const i=this._size;return this._simpleType?e+=";":e+=`[${i.toString()}];`,e}}class Td{constructor(){this._values=new Cd,this._enabled=!0,this._hasUpdated=!1}get enabled(){return this._enabled}set enabled(t){this._enabled=t}get count(){return this._hasUpdated?this._values._array.filter((t=>t.enabled)).filter((t=>t._colorTexture)).length:0}get boundingRect(){const t=[];for(let e of this._values._array)e.enabled&&t.push(e.boundingRect);return t}get inverseLocalModel(){const t=[];for(let e of this._values._array)e.enabled&&t.push(e._inverseLocalModel);return t}get depthTexture(){const t=[];for(let e of this._values._array)e.enabled&&e._colorTexture&&t.push(e._colorTexture);return t}get normal(){const t=[];for(let e of this._values._array)e.enabled&&e._colorTexture&&t.push(e.normal);return t}add(t){if(t instanceof Vu==!1)throw new Ol("parameter clipRegion must be a ClipRegion instance.");this._values.set(t._id,t),this._updateGlobeUniforms()}remove(t){let e=t;t instanceof Vu&&(e=t.id),this._values.remove(e),this._updateGlobeUniforms()}removeAll(){this._values.removeAll(),this._updateGlobeUniforms()}get(t){return this._values.get(t)}getByIndex(t){return this._values._array[t]}contains(t){return this._values.contains(t._id)}update(t){for(let e of this._values._array)e.enabled&&e.update(t);this._hasUpdated=!0,this._updateGlobeUniforms()}_updateGlobeUniforms(){const t=this.count,e={czm_p_clipEnabled:new Sd({size:1,simpleType:!0,datatype:bd.BOOL,getValue:function(t){return t.clipEnabled}}),czm_p_clipDepthTexture:new Sd({size:t,datatype:bd.SAMPLER_2D,getValue:function(t){return t.clipDepthTexture}}),czm_p_clipBoundingRect:new Sd({size:t,datatype:bd.FLOAT_VEC4,getValue:function(t){return t.clipBoundingRect}}),czm_p_clipNormal:new Sd({size:t,datatype:bd.FLOAT_VEC3,getValue:function(t){return t.clipNormal}}),czm_p_clipInverseLocalModel:new Sd({size:t,datatype:bd.FLOAT_MAT4,getValue:function(t){return t.clipInverseLocalModel}})};for(const t in e)if(xd[t]=e[t],xd.hasOwnProperty(t)){let e=xd[t];"function"==typeof e.getDeclaration&&(wd._czmBuiltinsAndUniforms[t]=e.getDeclaration(t))}}}function Pd(t,e){if(null===t||"object"!=typeof t)return t;e=Fl(e,!1);const i=new t.constructor;for(const n in t)if(t.hasOwnProperty(n)){let r=t[n];e&&(r=Pd(r,e)),i[n]=r}return i}const Ad=/((?:.*\/)|^)CesiumPro\.js(?:\?|#|$)/;let Id,Ld,Nd;function Md(t){return"undefined"==typeof document?t:(kl(Id)||(Id=document.createElement("a")),Id.href=t,Id.href=Id.href,Id.href)}function Dd(t){return Md(`../${t}`)}function Rd(){if(kl(Ld))return Ld;let t;if(t="undefined"!=typeof CESIUMPRO_BASE_URL?CESIUMPRO_BASE_URL:"object"==typeof window.define&&kl(window.define.amd)&&!window.define.amd.toUrlUndefined?Cesium.getAbsoluteUri("..","core/Url.js"):function(){const t=document.getElementsByTagName("script");for(let e=0,i=t.length;e<i;++e){const i=t[e].getAttribute("src"),n=Ad.exec(i);if(null!==n)return n[1]}}(),!kl(t))throw new Ol("Unable to determine CesiumPro base URL automatically, try defining a global variable called CESIUMPRO_BASE_URL.");return kl(t)||(t=""),Ld=new Cesium.Resource({url:Md(t)}),Ld.appendForwardSlash(),Ld}function Od(t){return Rd().getDerivedResource({url:t}).url}function Fd(t){kl(Nd)||(Nd="object"==typeof window.define&&kl(window.define.amd)&&!window.define.amd.toUrlUndefined?Dd:Od);return Nd(t)}const kd={join:function(...t){const e=[];for(let i of t)i.startsWith("/")&&(i=i.substring(1)),i.endsWith("/")&&(i=i.substring(0,i.length-1)),e.push(i);return e.join("/")},buildModuleUrl:function(t){return Fd(t)}};kd.getCesiumProBaseUrl=Rd;const{FeatureDetection:zd,isCrossOriginUrl:Gd}=Cesium;let Bd;function Ud(){return kl(Bd)||(Bd=function(t){let e=Cesium.buildModuleUrl(t);if(Gd(e)){const t='importScripts("'+e+'");';let i;try{i=new Blob([t],{type:"application/javascript"})}catch(e){let n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(t),i=n.getBlob("application/javascript")}e=(window.URL||window.webkitURL).createObjectURL(i)}return e}("Workers/cesiumWorkerBootstrapper.js")),Bd}function Vd(t){const e=new Worker(Ud());e.postMessage=Fl(e.webkitPostMessage,e.postMessage);const i={loaderConfig:{paths:{Workers:Fd("workers")},baseUrl:Rd().url},workerModule:t._workerPath};return e.postMessage(i),e.onmessage=function(e){!function(t,e){console.log(t,e,"------complete-----")}(t,e.data)},e.postMessage(t._options),e}const{kdbush:Hd,Cartesian3:Wd,Cartographic:jd,PointPrimitive:qd,BoundingRectangle:Yd,SceneMode:Xd,EllipsoidalOccluder:$d}=Cesium;function Jd(t){return t.__pixel.x}function Qd(t){return t.__pixel.y}function Zd(t,e){const i=new Yd;return qd.getScreenSpaceBoundingBox(t,e,i),function(t,e){t.x-=e,t.y-=e,t.width+=2*e,t.height+=2*e}(i,this.pixelRange),i}let Kd;function tf(t){if(!t.scene.globe)return;const e=Cesium.getTimestamp(),i=t.scene;if(kl(Kd)&&e-Kd<250)return;Kd=e;const n=i.canvas.clientWidth,r=i.canvas.clientHeight,o=i.camera.getPickRay(new Cesium.Cartesian2(n/2,r/2)),s=i.camera.getPickRay(new Cesium.Cartesian2(n/2+1,r/2)),a=i.globe.pick(o,i),l=i.globe.pick(s,i);if(!kl(a)||!kl(l))return;return new Cesium.EllipsoidGeodesic(i.globe.ellipsoid.cartesianToCartographic(a),i.globe.ellipsoid.cartesianToCartographic(l)).surfaceDistance}function ef(t){const e=t.canvas.getBoundingClientRect(),i=new Cesium.Cartesian2(e.width/2,e.height/2);return zl.fromPixel(i,t)}function nf(t){if(!t.scene.globe)return{};if(t.scene.mode===Cesium.SceneMode.SCENE3D){const e=t.camera.computeViewRectangle();if(!kl(e))return;return{west:Cesium.Math.toDegrees(e.west),south:Cesium.Math.toDegrees(e.south),east:Cesium.Math.toDegrees(e.east),north:Cesium.Math.toDegrees(e.north)}}const e=t.canvas.getBoundingClientRect(),i=zl.fromPixel(new Cesium.Cartesian2(0,e.height/2),t)||{lon:-180},n=zl.fromPixel(new Cesium.Cartesian2(e.width,e.height/2),t)||{lon:180},r=zl.fromPixel(new Cesium.Cartesian2(e.width/2,0),t)||{lat:90},o=zl.fromPixel(new Cesium.Cartesian2(e.width/2,e.height),t)||{lat:-90};return{west:i.lon,south:o.lat,east:n.lon,north:r.lat}}class rf{constructor(t,e){Hl(t),this._viewer=t,e=Fl(e,{});const i=Fl(e.items,[]);this._items=new Cesium.AssociativeArray,this._position=e.position,this._container=Fl(e.container,t.container),this._root=this.createMenu(),this.createItems(i),this._show=!0,this._activeSubMenu=void 0,this.parent=e.parent}get show(){return this._show}set show(t){this._show=t,this._root.style.display=t?"block":"none",this._menu.style.display=t?"block":"none"}get position(){return this._position}set position(t){if(this._position=t,this._root){const t=zl.toPixel(this._position,this._viewer.scene);this._root.style.left=t.x+"px",this._root.style.top=t.y+"px"}}get(t){return this._items.values[t]}getById(t){return this._items.get(t)}add(t){if(this._items.contains(t.id))return;const e=this.createItem(t);this._items.set(e.id,e),this._menu.appendChild(e.el)}remove(t){const e=t.el;try{return this._root.removeChild(e),this._items.remove(t.id),!0}catch(t){return!1}}removeAll(){for(let t of this._items.values)this.remove(t)}createMenu(){const t=document.createElement("div");t.className="context-root";const e=document.createElement("ul");if(e.className="context-menu context-ul",t.appendChild(e),this._container.appendChild(t),this._position){const e=zl.toPixel(this._position,this._viewer.scene);t.style.left=e.x+"px",t.style.top=e.y+"px"}return this._menu=e,t.oncontextmenu=function(){return!1},t}updateItemText(t,e){const i=document.getElementById(t.id+"-text");i&&(i.innerHTML=e)}updateItemDistabled(t,e){t&&t.a&&(t.disabled=e,t.a.className=e?"context-item-disabled":"context-item")}createItems(t){for(let e of t)this.add(e)}createItem(t={}){const e=document.createElement("li");e.className="context-menu";const i=document.createElement("a");i.className=t.disabled?"context-item-disabled":"context-item";const n=document.createElement("i");if(n.className=t.class,i.appendChild(n),i.innerHTML+=`<span id="${t.id}-text">${t.text}</span>`,e.appendChild(i),e.id=t.id,t.el=e,t.a=i,t.children){const n=document.createElement("i");n.className="fa fa-caret-right",i.appendChild(n);const r=new rf(this._viewer,{items:t.children,position:this._position,parent:this});e.appendChild(r._menu),r._menu.className+=" context-submenu",t.subMenu=r,r.container=t}return t.el.onmouseover=e=>{e.stopPropagation(),t.disabled||(this._activeSubMenu&&(this._activeSubMenu.show=!1),t.subMenu&&(t.subMenu.show=!0),this._activeSubMenu=t.subMenu)},t.el.onclick=e=>{e.stopPropagation(),t.disabled||(t.callback&&t.callback(t),this.show=!1,this.parent&&(this.parent.show=!1))},t}ContextMenuItem(t){}destroy(){}}function of(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}const{ShaderSource:sf}=Cesium;function af(t){const e="czm_p_inClipRegion";if(!t.globe)return sf._czmBuiltinsAndUniforms[e]="bool czm_p_inClipRegion(vec3 positionWC) {return !czm_p_clipEnabled;}";const i=t.globe.clipRegion.count;if(0===i)return sf._czmBuiltinsAndUniforms[e]="bool czm_p_inClipRegion(vec3 positionWC) {return !czm_p_clipEnabled;}";let n=`\n  bool inBoundingRect(vec2 st) {\n    return st.s >= 0.0 && st.s <=1.0 && st.t >= 0.0 && st.t <= 1.0;\n  }\n  bool in_clipRegion(sampler2D texture, vec3 positionWC, vec4 boundingRect, vec3 normalEC, mat4 inverseMatrix) {\n    vec2 st;\n    vec4 positionLC = inverseMatrix * vec4(positionWC, 1.0);\n    st.s = (positionLC.x-boundingRect.x)/(boundingRect.z-boundingRect.x);\n    st.t = (positionLC.y-boundingRect.y)/(boundingRect.w-boundingRect.y);\n    if (inBoundingRect(st)) {\n      float depth = czm_unpackDepth(texture2D(texture, st));\n      depth = depth * 1024.0;\n      if (depth > 1.0 && dot(normalEC, (vec4(positionWC, 1.0)).xyz) > 0.0) {\n        return true;\n      }\n    }\n    return false;\n  }\n  bool czm_p_inClipRegion(vec3 positionWC) {\n    if(!czm_p_clipEnabled) {\n      return true;\n    }\n    for (int i = 0; i < ${i}; i++) {\n        bool isIn = in_clipRegion(czm_p_clipDepthTexture[i], positionWC, czm_p_clipBoundingRect[i], czm_p_clipNormal[i], czm_p_clipInverseLocalModel[i]);\n        if (isIn) {\n          return true;\n        }\n    }\n    return false;\n  }`;sf._czmBuiltinsAndUniforms[e]=n}const lf=[],{document:uf}=window,cf=Object.getPrototypeOf,{slice:hf}=lf,{concat:pf}=lf,{push:df}=lf,{indexOf:ff}=lf,gf={},{toString:mf}=gf,_f=gf.hasOwnProperty,yf=_f.toString,vf=yf.call(Object),Cf={},xf=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},wf=function(t){return null!=t&&t===t.window},bf={type:!0,src:!0,nonce:!0,noModule:!0};function Ef(t,e,i){let n,r;const o=(i=i||uf).createElement("script");if(o.text=t,e)for(n in bf)r=e[n]||e.getAttribute&&e.getAttribute(n),r&&o.setAttribute(n,r);i.head.appendChild(o).parentNode.removeChild(o)}function Sf(t){return null==t?`${t}`:"object"==typeof t||"function"==typeof t?gf[mf.call(t)]||"object":typeof t}const Tf="3.4.1";var Pf=function(t,e){return new Pf.fn.init(t,e)};const Af=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function If(t){const e=!!t&&"length"in t&&t.length,i=Sf(t);return!xf(t)&&!wf(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}Pf.fn=Pf.prototype={jquery:Tf,constructor:Pf,length:0,toArray(){return hf.call(this)},get(t){return null==t?hf.call(this):t<0?this[t+this.length]:this[t]},pushStack(t){const e=Pf.merge(this.constructor(),t);return e.prevObject=this,e},each(t){return Pf.each(this,t)},map(t){return this.pushStack(Pf.map(this,((e,i)=>t.call(e,i,e))))},slice(){return this.pushStack(hf.apply(this,arguments))},first(){return this.eq(0)},last(){return this.eq(-1)},eq(t){const e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end(){return this.prevObject||this.constructor()},push:df,sort:lf.sort,splice:lf.splice},Pf.extend=Pf.fn.extend=function(){let t,e,i,n,r,o,s=arguments[0]||{},a=1;const{length:l}=arguments;let u=!1;for("boolean"==typeof s&&(u=s,s=arguments[a]||{},a++),"object"==typeof s||xf(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)n=t[e],"__proto__"!==e&&s!==n&&(u&&n&&(Pf.isPlainObject(n)||(r=Array.isArray(n)))?(i=s[e],o=r&&!Array.isArray(i)?[]:r||Pf.isPlainObject(i)?i:{},r=!1,s[e]=Pf.extend(u,o,n)):void 0!==n&&(s[e]=n));return s},Pf.extend({expando:`jQuery${(Tf+Math.random()).replace(/\D/g,"")}`,isReady:!0,error(t){throw new Error(t)},noop(){},isPlainObject(t){let e,i;return!(!t||"[object Object]"!==mf.call(t))&&(e=cf(t),!e||(i=_f.call(e,"constructor")&&e.constructor,"function"==typeof i&&yf.call(i)===vf))},isEmptyObject(t){let e;for(e in t)return!1;return!0},globalEval(t,e){Ef(t,{nonce:e&&e.nonce})},each(t,e){let i,n=0;if(If(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:t=>null==t?"":`${t}`.replace(Af,""),makeArray(t,e){const i=e||[];return null!=t&&(If(Object(t))?Pf.merge(i,"string"==typeof t?[t]:t):df.call(i,t)),i},inArray:(t,e,i)=>null==e?-1:ff.call(e,t,i),merge(t,e){const i=+e.length;let n=0,r=t.length;for(;n<i;n++)t[r++]=e[n];return t.length=r,t},grep(t,e,i){let n;const r=[];let o=0;const{length:s}=t,a=!i;for(;o<s;o++)n=!e(t[o],o),n!==a&&r.push(t[o]);return r},map(t,e,i){let n,r,o=0;const s=[];if(If(t))for(n=t.length;o<n;o++)r=e(t[o],o,i),null!=r&&s.push(r);else for(o in t)r=e(t[o],o,i),null!=r&&s.push(r);return pf.apply([],s)},guid:1,support:Cf}),"function"==typeof Symbol&&(Pf.fn[Symbol.iterator]=lf[Symbol.iterator]),Pf.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),((t,e)=>{gf[`[object ${e}]`]=e.toLowerCase()}));const Lf=
/*!
     * Sizzle CSS Selector Engine v2.3.4
     * https://sizzlejs.com/
     *
     * Copyright JS Foundation and other contributors
     * Released under the MIT license
     * https://js.foundation/
     *
     * Date: 2019-04-08
     */
function(t){let e,i,n,r,o,s,a,l,u,c,h,p,d,f,g,m,_,y,v;const C="sizzle"+1*new Date,x=t.document;let w=0,b=0;const E=lt(),S=lt(),T=lt(),P=lt();let A=function(t,e){return t===e&&(h=!0),0};const I={}.hasOwnProperty;let L=[];const{pop:N}=L,M=L.push;let{push:D}=L;const{slice:R}=L,O=function(t,e){let i=0;const n=t.length;for(;i<n;i++)if(t[i]===e)return i;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",k="[\\x20\\t\\r\\n\\f]",z="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",G=`\\[${k}*(${z})(?:${k}*([*^$|!~]?=)${k}*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(${z}))|)${k}*\\]`,B=`:(${z})(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|${G})*)|.*)\\)|)`,U=new RegExp(`${k}+`,"g"),V=new RegExp(`^${k}+|((?:^|[^\\\\])(?:\\\\.)*)${k}+$`,"g"),H=new RegExp(`^${k}*,${k}*`),W=new RegExp(`^${k}*([>+~]|${k})${k}*`),j=new RegExp(`${k}|>`),q=new RegExp(B),Y=new RegExp(`^${z}$`),X={ID:new RegExp(`^#(${z})`),CLASS:new RegExp(`^\\.(${z})`),TAG:new RegExp(`^(${z}|[*])`),ATTR:new RegExp(`^${G}`),PSEUDO:new RegExp(`^${B}`),CHILD:new RegExp(`^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(${k}*(even|odd|(([+-]|)(\\d*)n|)${k}*(?:([+-]|)${k}*(\\d+)|))${k}*\\)|)`,"i"),bool:new RegExp(`^(?:${F})$`,"i"),needsContext:new RegExp(`^${k}*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(${k}*((?:-\\d)?\\d*)${k}*\\)|)(?=[^-]|$)`,"i")},$=/HTML$/i,J=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp(`\\\\([\\da-f]{1,6}${k}?|(${k})|.)`,"ig"),it=function(t,e,i){const n=`0x${e}`-65536;return n!=n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},nt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"�":`${t.slice(0,-1)}\\${t.charCodeAt(t.length-1).toString(16)} `:`\\${t}`},ot=function(){p()},st=Ct((t=>!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()),{dir:"parentNode",next:"legend"});try{D.apply(L=R.call(x.childNodes),x.childNodes),L[x.childNodes.length].nodeType}catch(t){D={apply:L.length?function(t,e){M.apply(t,R.call(e))}:function(t,e){let i=t.length,n=0;for(;t[i++]=e[n++];);t.length=i-1}}}function at(t,e,n,r){let o,a,u,c,h,f,_,y=e&&e.ownerDocument;const w=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return n;if(!r&&((e?e.ownerDocument||e:x)!==d&&p(e),e=e||d,g)){if(11!==w&&(h=K.exec(t)))if(o=h[1]){if(9===w){if(!(u=e.getElementById(o)))return n;if(u.id===o)return n.push(u),n}else if(y&&(u=y.getElementById(o))&&v(e,u)&&u.id===o)return n.push(u),n}else{if(h[2])return D.apply(n,e.getElementsByTagName(t)),n;if((o=h[3])&&i.getElementsByClassName&&e.getElementsByClassName)return D.apply(n,e.getElementsByClassName(o)),n}if(i.qsa&&!P[`${t} `]&&(!m||!m.test(t))&&(1!==w||"object"!==e.nodeName.toLowerCase())){if(_=t,y=e,1===w&&j.test(t)){for((c=e.getAttribute("id"))?c=c.replace(nt,rt):e.setAttribute("id",c=C),f=s(t),a=f.length;a--;)f[a]=`#${c} ${vt(f[a])}`;_=f.join(","),y=tt.test(t)&&_t(e.parentNode)||e}try{return D.apply(n,y.querySelectorAll(_)),n}catch(e){P(t,!0)}finally{c===C&&e.removeAttribute("id")}}}return l(t.replace(V,"$1"),e,n,r)}function lt(){const t=[];return function e(i,r){return t.push(`${i} `)>n.cacheLength&&delete e[t.shift()],e[`${i} `]=r}}function ut(t){return t[C]=!0,t}function ct(t){let e=d.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){const i=t.split("|");let r=i.length;for(;r--;)n.attrHandle[i[r]]=e}function pt(t,e){let i=e&&t;const n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function dt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){const i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return ut((e=>(e=+e,ut(((i,n)=>{let r;const o=t([],i.length,e);let s=o.length;for(;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})))))}function _t(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in i=at.support={},o=at.isXML=function(t){const e=t.namespaceURI,i=(t.ownerDocument||t).documentElement;return!$.test(e||i&&i.nodeName||"HTML")},p=at.setDocument=function(t){let e,r;const s=t?t.ownerDocument||t:x;return s!==d&&9===s.nodeType&&s.documentElement?(d=s,f=d.documentElement,g=!o(d),x!==d&&(r=d.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ot,!1):r.attachEvent&&r.attachEvent("onunload",ot)),i.attributes=ct((t=>(t.className="i",!t.getAttribute("className")))),i.getElementsByTagName=ct((t=>(t.appendChild(d.createComment("")),!t.getElementsByTagName("*").length))),i.getElementsByClassName=Z.test(d.getElementsByClassName),i.getById=ct((t=>(f.appendChild(t).id=C,!d.getElementsByName||!d.getElementsByName(C).length))),i.getById?(n.filter.ID=function(t){const e=t.replace(et,it);return function(t){return t.getAttribute("id")===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&g){const i=e.getElementById(t);return i?[i]:[]}}):(n.filter.ID=function(t){const e=t.replace(et,it);return function(t){const i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&g){let i,n,r,o=e.getElementById(t);if(o){if(i=o.getAttributeNode("id"),i&&i.value===t)return[o];for(r=e.getElementsByName(t),n=0;o=r[n++];)if(i=o.getAttributeNode("id"),i&&i.value===t)return[o]}return[]}}),n.find.TAG=i.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):i.qsa?e.querySelectorAll(t):void 0}:function(t,e){let i;const n=[];let r=0;const o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},n.find.CLASS=i.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},_=[],m=[],(i.qsa=Z.test(d.querySelectorAll))&&(ct((t=>{f.appendChild(t).innerHTML=`<a id='${C}'></a><select id='${C}-\r\\' msallowcapture=''><option selected=''></option></select>`,t.querySelectorAll("[msallowcapture^='']").length&&m.push(`[*^$]=${k}*(?:''|"")`),t.querySelectorAll("[selected]").length||m.push(`\\[${k}*(?:value|${F})`),t.querySelectorAll(`[id~=${C}-]`).length||m.push("~="),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll(`a#${C}+*`).length||m.push(".#.+[+~]")})),ct((t=>{t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";const e=d.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push(`name${k}*[*^$|!~]?=`),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(i.matchesSelector=Z.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ct((t=>{i.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),_.push("!=",B)})),m=m.length&&new RegExp(m.join("|")),_=_.length&&new RegExp(_.join("|")),e=Z.test(f.compareDocumentPosition),v=e||Z.test(f.contains)?function(t,e){const i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=e?function(t,e){if(t===e)return h=!0,0;let n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!i.sortDetached&&e.compareDocumentPosition(t)===n?t===d||t.ownerDocument===x&&v(x,t)?-1:e===d||e.ownerDocument===x&&v(x,e)?1:c?O(c,t)-O(c,e):0:4&n?-1:1)}:function(t,e){if(t===e)return h=!0,0;let i,n=0;const r=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!r||!o)return t===d?-1:e===d?1:r?-1:o?1:c?O(c,t)-O(c,e):0;if(r===o)return pt(t,e);for(i=t;i=i.parentNode;)s.unshift(i);for(i=e;i=i.parentNode;)a.unshift(i);for(;s[n]===a[n];)n++;return n?pt(s[n],a[n]):s[n]===x?-1:a[n]===x?1:0},d):d},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if((t.ownerDocument||t)!==d&&p(t),i.matchesSelector&&g&&!P[`${e} `]&&(!_||!_.test(e))&&(!m||!m.test(e)))try{const n=y.call(t,e);if(n||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){P(e,!0)}return at(e,d,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!==d&&p(t),v(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!==d&&p(t);const r=n.attrHandle[e.toLowerCase()];let o=r&&I.call(n.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==o?o:i.attributes||!g?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},at.escape=function(t){return`${t}`.replace(nt,rt)},at.error=function(t){throw new Error(`Syntax error, unrecognized expression: ${t}`)},at.uniqueSort=function(t){let e;const n=[];let r=0,o=0;if(h=!i.detectDuplicates,c=!i.sortStable&&t.slice(0),t.sort(A),h){for(;e=t[o++];)e===t[o]&&(r=n.push(o));for(;r--;)t.splice(n[r],1)}return c=null,t},r=at.getText=function(t){let e,i="",n=0;const{nodeType:o}=t;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[n++];)i+=r(e);return i},n=at.selectors={cacheLength:50,createPseudo:ut,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:t=>(t[1]=t[1].replace(et,it),t[3]=(t[3]||t[4]||t[5]||"").replace(et,it),"~="===t[2]&&(t[3]=` ${t[3]} `),t.slice(0,4)),CHILD:t=>(t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t),PSEUDO(t){let e;const i=!t[6]&&t[2];return X.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&q.test(i)&&(e=s(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG(t){const e=t.replace(et,it).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS(t){let e=E[`${t} `];return e||(e=new RegExp(`(^|${k})${t}(${k}|$)`))&&E(t,(t=>e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")))},ATTR:(t,e,i)=>function(n){let r=at.attr(n,t);return null==r?"!="===e:!e||(r+="","="===e?r===i:"!="===e?r!==i:"^="===e?i&&0===r.indexOf(i):"*="===e?i&&r.indexOf(i)>-1:"$="===e?i&&r.slice(-i.length)===i:"~="===e?` ${r.replace(U," ")} `.indexOf(i)>-1:"|="===e&&(r===i||r.slice(0,i.length+1)===`${i}-`))},CHILD(t,e,i,n,r){const o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,l){let u,c,h,p,d,f,g=o!==s?"nextSibling":"previousSibling";const m=e.parentNode,_=a&&e.nodeName.toLowerCase(),y=!l&&!a;let v=!1;if(m){if(o){for(;g;){for(p=e;p=p[g];)if(a?p.nodeName.toLowerCase()===_:1===p.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&y){for(p=m,h=p[C]||(p[C]={}),c=h[p.uniqueID]||(h[p.uniqueID]={}),u=c[t]||[],d=u[0]===w&&u[1],v=d&&u[2],p=d&&m.childNodes[d];p=++d&&p&&p[g]||(v=d=0)||f.pop();)if(1===p.nodeType&&++v&&p===e){c[t]=[w,d,v];break}}else if(y&&(p=e,h=p[C]||(p[C]={}),c=h[p.uniqueID]||(h[p.uniqueID]={}),u=c[t]||[],d=u[0]===w&&u[1],v=d),!1===v)for(;(p=++d&&p&&p[g]||(v=d=0)||f.pop())&&((a?p.nodeName.toLowerCase()!==_:1!==p.nodeType)||!++v||(y&&(h=p[C]||(p[C]={}),c=h[p.uniqueID]||(h[p.uniqueID]={}),c[t]=[w,v]),p!==e)););return v-=r,v===n||v%n==0&&v/n>=0}}},PSEUDO(t,e){let i;const r=n.pseudos[t]||n.setFilters[t.toLowerCase()]||at.error(`unsupported pseudo: ${t}`);return r[C]?r(e):r.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?ut(((t,i)=>{let n;const o=r(t,e);let s=o.length;for(;s--;)n=O(t,o[s]),t[n]=!(i[n]=o[s])})):function(t){return r(t,0,i)}):r}},pseudos:{not:ut((t=>{const e=[],i=[],n=a(t.replace(V,"$1"));return n[C]?ut(((t,e,i,r)=>{let o;const s=n(t,null,r,[]);let a=t.length;for(;a--;)(o=s[a])&&(t[a]=!(e[a]=o))})):function(t,r,o){return e[0]=t,n(e,null,o,i),e[0]=null,!i.pop()}})),has:ut((t=>function(e){return at(t,e).length>0})),contains:ut((t=>(t=t.replace(et,it),function(e){return(e.textContent||r(e)).indexOf(t)>-1}))),lang:ut((t=>(Y.test(t||"")||at.error(`unsupported lang: ${t}`),t=t.replace(et,it).toLowerCase(),function(e){let i;do{if(i=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(`${t}-`)}while((e=e.parentNode)&&1===e.nodeType);return!1}))),target(e){const i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:t=>t===f,focus:t=>t===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(t.type||t.href||~t.tabIndex),enabled:gt(!1),disabled:gt(!0),checked(t){const e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:t=>(t.parentNode&&t.parentNode.selectedIndex,!0===t.selected),empty(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:t=>!n.pseudos.empty(t),header:t=>Q.test(t.nodeName),input:t=>J.test(t.nodeName),button(t){const e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text(t){let e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((()=>[0])),last:mt(((t,e)=>[e-1])),eq:mt(((t,e,i)=>[i<0?i+e:i])),even:mt(((t,e)=>{let i=0;for(;i<e;i+=2)t.push(i);return t})),odd:mt(((t,e)=>{let i=1;for(;i<e;i+=2)t.push(i);return t})),lt:mt(((t,e,i)=>{let n=i<0?i+e:i>e?e:i;for(;--n>=0;)t.push(n);return t})),gt:mt(((t,e,i)=>{let n=i<0?i+e:i;for(;++n<e;)t.push(n);return t}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=dt(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=ft(e);function yt(){}function vt(t){let e=0;const i=t.length;let n="";for(;e<i;e++)n+=t[e].value;return n}function Ct(t,e,i){const{dir:n}=e,r=e.next,o=r||n,s=i&&"parentNode"===o,a=b++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,r);return!1}:function(e,i,l){let u,c,h;const p=[w,a];if(l){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||s)if(h=e[C]||(e[C]={}),c=h[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[n]||e;else{if((u=c[o])&&u[0]===w&&u[1]===a)return p[2]=u[2];if(c[o]=p,p[2]=t(e,i,l))return!0}return!1}}function xt(t){return t.length>1?function(e,i,n){let r=t.length;for(;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function wt(t,e,i,n,r){let o;const s=[];let a=0;const l=t.length,u=null!=e;for(;a<l;a++)(o=t[a])&&(i&&!i(o,n,r)||(s.push(o),u&&e.push(a)));return s}function bt(t,e,i,n,r,o){return n&&!n[C]&&(n=bt(n)),r&&!r[C]&&(r=bt(r,o)),ut(((o,s,a,l)=>{let u,c,h;const p=[],d=[],f=s.length,g=o||function(t,e,i){let n=0;const r=e.length;for(;n<r;n++)at(t,e[n],i);return i}(e||"*",a.nodeType?[a]:a,[]),m=!t||!o&&e?g:wt(g,p,t,a,l);let _=i?r||(o?t:f||n)?[]:s:m;if(i&&i(m,_,a,l),n)for(u=wt(_,d),n(u,[],a,l),c=u.length;c--;)(h=u[c])&&(_[d[c]]=!(m[d[c]]=h));if(o){if(r||t){if(r){for(u=[],c=_.length;c--;)(h=_[c])&&u.push(m[c]=h);r(null,_=[],u,l)}for(c=_.length;c--;)(h=_[c])&&(u=r?O(o,h):p[c])>-1&&(o[u]=!(s[u]=h))}}else _=wt(_===s?_.splice(f,_.length):_),r?r(null,s,_,l):D.apply(s,_)}))}function Et(t){let e,i,r;const o=t.length,s=n.relative[t[0].type],a=s||n.relative[" "];let l=s?1:0;const c=Ct((t=>t===e),a,!0),h=Ct((t=>O(e,t)>-1),a,!0);let p=[function(t,i,n){const r=!s&&(n||i!==u)||((e=i).nodeType?c(t,i,n):h(t,i,n));return e=null,r}];for(;l<o;l++)if(i=n.relative[t[l].type])p=[Ct(xt(p),i)];else{if(i=n.filter[t[l].type].apply(null,t[l].matches),i[C]){for(r=++l;r<o&&!n.relative[t[r].type];r++);return bt(l>1&&xt(p),l>1&&vt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(V,"$1"),i,l<r&&Et(t.slice(l,r)),r<o&&Et(t=t.slice(r)),r<o&&vt(t))}p.push(i)}return xt(p)}return yt.prototype=n.filters=n.pseudos,n.setFilters=new yt,s=at.tokenize=function(t,e){let i,r,o,s,a,l,u;const c=S[`${t} `];if(c)return e?0:c.slice(0);for(a=t,l=[],u=n.preFilter;a;){for(s in i&&!(r=H.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),i=!1,(r=W.exec(a))&&(i=r.shift(),o.push({value:i,type:r[0].replace(V," ")}),a=a.slice(i.length)),n.filter)!(r=X[s].exec(a))||u[s]&&!(r=u[s](r))||(i=r.shift(),o.push({value:i,type:s,matches:r}),a=a.slice(i.length));if(!i)break}return e?a.length:a?at.error(t):S(t,l).slice(0)},a=at.compile=function(t,e){let i;const r=[],o=[];let a=T[`${t} `];if(!a){for(e||(e=s(t)),i=e.length;i--;)a=Et(e[i]),a[C]?r.push(a):o.push(a);a=T(t,function(t,e){const i=e.length>0,r=t.length>0,o=function(o,s,a,l,c){let h,f,m,_=0,y="0";const v=o&&[];let C=[];const x=u,b=o||r&&n.find.TAG("*",c),E=w+=null==x?1:Math.random()||.1,S=b.length;for(c&&(u=s===d||s||c);y!==S&&null!=(h=b[y]);y++){if(r&&h){for(f=0,s||h.ownerDocument===d||(p(h),a=!g);m=t[f++];)if(m(h,s||d,a)){l.push(h);break}c&&(w=E)}i&&((h=!m&&h)&&_--,o&&v.push(h))}if(_+=y,i&&y!==_){for(f=0;m=e[f++];)m(v,C,s,a);if(o){if(_>0)for(;y--;)v[y]||C[y]||(C[y]=N.call(l));C=wt(C)}D.apply(l,C),c&&!o&&C.length>0&&_+e.length>1&&at.uniqueSort(l)}return c&&(w=E,u=x),v};return i?ut(o):o}(o,r)),a.selector=t}return a},l=at.select=function(t,e,i,r){let o,l,u,c,h;const p="function"==typeof t&&t,d=!r&&s(t=p.selector||t);if(i=i||[],1===d.length){if(l=d[0]=d[0].slice(0),l.length>2&&"ID"===(u=l[0]).type&&9===e.nodeType&&g&&n.relative[l[1].type]){if(!(e=(n.find.ID(u.matches[0].replace(et,it),e)||[])[0]))return i;p&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(o=X.needsContext.test(t)?0:l.length;o--&&(u=l[o],!n.relative[c=u.type]);)if((h=n.find[c])&&(r=h(u.matches[0].replace(et,it),tt.test(l[0].type)&&_t(e.parentNode)||e))){if(l.splice(o,1),!(t=r.length&&vt(l)))return D.apply(i,r),i;break}}return(p||a(t,d))(r,e,!g,i,!e||tt.test(t)&&_t(e.parentNode)||e),i},i.sortStable=C.split("").sort(A).join("")===C,i.detectDuplicates=!!h,p(),i.sortDetached=ct((t=>1&t.compareDocumentPosition(d.createElement("fieldset")))),ct((t=>(t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href"))))||ht("type|href|height|width",((t,e,i)=>{if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),i.attributes&&ct((t=>(t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value"))))||ht("value",((t,e,i)=>{if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ct((t=>null==t.getAttribute("disabled")))||ht(F,((t,e,i)=>{let n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null})),at}(window);Pf.find=Lf,Pf.expr=Lf.selectors,Pf.expr[":"]=Pf.expr.pseudos,Pf.uniqueSort=Pf.unique=Lf.uniqueSort,Pf.text=Lf.getText,Pf.isXMLDoc=Lf.isXML,Pf.contains=Lf.contains,Pf.escapeSelector=Lf.escape;const Nf=function(t,e,i){const n=[],r=void 0!==i;for(;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&Pf(t).is(i))break;n.push(t)}return n},Mf=function(t,e){const i=[];for(;t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},Df=Pf.expr.match.needsContext;function Rf(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}const Of=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ff(t,e,i){return xf(e)?Pf.grep(t,((t,n)=>!!e.call(t,n,t)!==i)):e.nodeType?Pf.grep(t,(t=>t===e!==i)):"string"!=typeof e?Pf.grep(t,(t=>ff.call(e,t)>-1!==i)):Pf.filter(e,t,i)}let kf;Pf.filter=function(t,e,i){const n=e[0];return i&&(t=`:not(${t})`),1===e.length&&1===n.nodeType?Pf.find.matchesSelector(n,t)?[n]:[]:Pf.find.matches(t,Pf.grep(e,(t=>1===t.nodeType)))},Pf.fn.extend({find(t){let e,i;const n=this.length,r=this;if("string"!=typeof t)return this.pushStack(Pf(t).filter((function(){for(e=0;e<n;e++)if(Pf.contains(r[e],this))return!0})));for(i=this.pushStack([]),e=0;e<n;e++)Pf.find(t,r[e],i);return n>1?Pf.uniqueSort(i):i},filter(t){return this.pushStack(Ff(this,t||[],!1))},not(t){return this.pushStack(Ff(this,t||[],!0))},is(t){return!!Ff(this,"string"==typeof t&&Df.test(t)?Pf(t):t||[],!1).length}});const zf=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(Pf.fn.init=function(t,e,i){let n,r;if(!t)return this;if(i=i||kf,"string"==typeof t){if(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:zf.exec(t),n&&(n[1]||!e)){if(n[1]){if(e=e instanceof Pf?e[0]:e,Pf.merge(this,Pf.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:uf,!0)),Of.test(n[1])&&Pf.isPlainObject(e))for(n in e)xf(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return r=uf.getElementById(n[2]),r&&(this[0]=r,this.length=1),this}return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t)}return t.nodeType?(this[0]=t,this.length=1,this):xf(t)?void 0!==i.ready?i.ready(t):t(Pf):Pf.makeArray(t,this)}).prototype=Pf.fn,kf=Pf(uf);const Gf=/^(?:parents|prev(?:Until|All))/,Bf={children:!0,contents:!0,next:!0,prev:!0};function Uf(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}Pf.fn.extend({has(t){const e=Pf(t,this),i=e.length;return this.filter((function(){let t=0;for(;t<i;t++)if(Pf.contains(this,e[t]))return!0}))},closest(t,e){let i,n=0;const r=this.length,o=[],s="string"!=typeof t&&Pf(t);if(!Df.test(t))for(;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&Pf.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?Pf.uniqueSort(o):o)},index(t){return t?"string"==typeof t?ff.call(Pf(t),this[0]):ff.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add(t,e){return this.pushStack(Pf.uniqueSort(Pf.merge(this.get(),Pf(t,e))))},addBack(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),Pf.each({parent(t){const e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:t=>Nf(t,"parentNode"),parentsUntil:(t,e,i)=>Nf(t,"parentNode",i),next:t=>Uf(t,"nextSibling"),prev:t=>Uf(t,"previousSibling"),nextAll:t=>Nf(t,"nextSibling"),prevAll:t=>Nf(t,"previousSibling"),nextUntil:(t,e,i)=>Nf(t,"nextSibling",i),prevUntil:(t,e,i)=>Nf(t,"previousSibling",i),siblings:t=>Mf((t.parentNode||{}).firstChild,t),children:t=>Mf(t.firstChild),contents:t=>void 0!==t.contentDocument?t.contentDocument:(Rf(t,"template")&&(t=t.content||t),Pf.merge([],t.childNodes))},((t,e)=>{Pf.fn[t]=function(i,n){let r=Pf.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=Pf.filter(n,r)),this.length>1&&(Bf[t]||Pf.uniqueSort(r),Gf.test(t)&&r.reverse()),this.pushStack(r)}}));const Vf=/[^\x20\t\r\n\f]+/g;function Hf(t){return t}function Wf(t){throw t}function jf(t,e,i,n){let r;try{t&&xf(r=t.promise)?r.call(t).done(e).fail(i):t&&xf(r=t.then)?r.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}Pf.Callbacks=function(t){let e,i,n,r;t="string"==typeof t?function(t){const e={};return Pf.each(t.match(Vf)||[],((t,i)=>{e[i]=!0})),e}(t):Pf.extend({},t);let o=[],s=[],a=-1;const l=function(){for(r=r||t.once,n=e=!0;s.length;a=-1)for(i=s.shift();++a<o.length;)!1===o[a].apply(i[0],i[1])&&t.stopOnFalse&&(a=o.length,i=!1);t.memory||(i=!1),e=!1,r&&(o=i?[]:"")};var u={add(){return o&&(i&&!e&&(a=o.length-1,s.push(i)),function e(i){Pf.each(i,((i,n)=>{xf(n)?t.unique&&u.has(n)||o.push(n):n&&n.length&&"string"!==Sf(n)&&e(n)}))}(arguments),i&&!e&&l()),this},remove(){return Pf.each(arguments,((t,e)=>{let i;for(;(i=Pf.inArray(e,o,i))>-1;)o.splice(i,1),i<=a&&a--})),this},has:t=>t?Pf.inArray(t,o)>-1:o.length>0,empty(){return o&&(o=[]),this},disable(){return r=s=[],o=i="",this},disabled:()=>!o,lock(){return r=s=[],i||e||(o=i=""),this},locked:()=>!!r,fireWith(t,i){return r||(i=[t,(i=i||[]).slice?i.slice():i],s.push(i),e||l()),this},fire(){return u.fireWith(this,arguments),this},fired:()=>!!n};return u},Pf.extend({Deferred(t){const e=[["notify","progress",Pf.Callbacks("memory"),Pf.Callbacks("memory"),2],["resolve","done",Pf.Callbacks("once memory"),Pf.Callbacks("once memory"),0,"resolved"],["reject","fail",Pf.Callbacks("once memory"),Pf.Callbacks("once memory"),1,"rejected"]];let i="pending";var n={state:()=>i,always(){return r.done(arguments).fail(arguments),this},catch:t=>n.then(null,t),pipe(){let t=arguments;return Pf.Deferred((i=>{Pf.each(e,((e,n)=>{const o=xf(t[n[4]])&&t[n[4]];r[n[1]]((function(){const t=o&&o.apply(this,arguments);t&&xf(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[`${n[0]}With`](this,o?[t]:arguments)}))})),t=null})).promise()},then(t,i,n){let r=0;function o(t,e,i,n){return function(){let s=this,a=arguments;const l=function(){let l,u;if(!(t<r)){if(l=i.apply(s,a),l===e.promise())throw new TypeError("Thenable self-resolution");u=l&&("object"==typeof l||"function"==typeof l)&&l.then,xf(u)?n?u.call(l,o(r,e,Hf,n),o(r,e,Wf,n)):(r++,u.call(l,o(r,e,Hf,n),o(r,e,Wf,n),o(r,e,Hf,e.notifyWith))):(i!==Hf&&(s=void 0,a=[l]),(n||e.resolveWith)(s,a))}};var u=n?l:function(){try{l()}catch(n){Pf.Deferred.exceptionHook&&Pf.Deferred.exceptionHook(n,u.stackTrace),t+1>=r&&(i!==Wf&&(s=void 0,a=[n]),e.rejectWith(s,a))}};t?u():(Pf.Deferred.getStackHook&&(u.stackTrace=Pf.Deferred.getStackHook()),window.setTimeout(u))}}return Pf.Deferred((r=>{e[0][3].add(o(0,r,xf(n)?n:Hf,r.notifyWith)),e[1][3].add(o(0,r,xf(t)?t:Hf)),e[2][3].add(o(0,r,xf(i)?i:Wf))})).promise()},promise:t=>null!=t?Pf.extend(t,n):n},r={};return Pf.each(e,((t,o)=>{const s=o[2],a=o[5];n[o[1]]=s.add,a&&s.add((()=>{i=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(o[3].fire),r[o[0]]=function(){return r[`${o[0]}With`](this===r?void 0:this,arguments),this},r[`${o[0]}With`]=s.fireWith})),n.promise(r),t&&t.call(r,r),r},when(t){let e=arguments.length,i=e;const n=Array(i),r=hf.call(arguments),o=Pf.Deferred(),s=function(t){return function(i){n[t]=this,r[t]=arguments.length>1?hf.call(arguments):i,--e||o.resolveWith(n,r)}};if(e<=1&&(jf(t,o.done(s(i)).resolve,o.reject,!e),"pending"===o.state()||xf(r[i]&&r[i].then)))return o.then();for(;i--;)jf(r[i],s(i),o.reject);return o.promise()}});const qf=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;Pf.Deferred.exceptionHook=function(t,e){window.console&&window.console.warn&&t&&qf.test(t.name)&&window.console.warn(`jQuery.Deferred exception: ${t.message}`,t.stack,e)},Pf.readyException=function(t){window.setTimeout((()=>{throw t}))};const Yf=Pf.Deferred();function Xf(){uf.removeEventListener("DOMContentLoaded",Xf),window.removeEventListener("load",Xf),Pf.ready()}Pf.fn.ready=function(t){return Yf.then(t).catch((t=>{Pf.readyException(t)})),this},Pf.extend({isReady:!1,readyWait:1,ready(t){(!0===t?--Pf.readyWait:Pf.isReady)||(Pf.isReady=!0,!0!==t&&--Pf.readyWait>0||Yf.resolveWith(uf,[Pf]))}}),Pf.ready.then=Yf.then,"complete"===uf.readyState||"loading"!==uf.readyState&&!uf.documentElement.doScroll?window.setTimeout(Pf.ready):(uf.addEventListener("DOMContentLoaded",Xf),window.addEventListener("load",Xf));var $f=function(t,e,i,n,r,o,s){let a=0;const l=t.length;let u=null==i;if("object"===Sf(i))for(a in r=!0,i)$f(t,e,a,i[a],!0,o,s);else if(void 0!==n&&(r=!0,xf(n)||(s=!0),u&&(s?(e.call(t,n),e=null):(u=e,e=function(t,e,i){return u.call(Pf(t),i)})),e))for(;a<l;a++)e(t[a],i,s?n:n.call(t[a],a,e(t[a],i)));return r?t:u?e.call(t):l?e(t[0],i):o};const Jf=/^-ms-/,Qf=/-([a-z])/g;function Zf(t,e){return e.toUpperCase()}function Kf(t){return t.replace(Jf,"ms-").replace(Qf,Zf)}const tg=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function eg(){this.expando=Pf.expando+eg.uid++}eg.uid=1,eg.prototype={cache(t){let e=t[this.expando];return e||(e={},tg(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set(t,e,i){let n;const r=this.cache(t);if("string"==typeof e)r[Kf(e)]=i;else for(n in e)r[Kf(n)]=e[n];return r},get(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][Kf(e)]},access(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove(t,e){let i;const n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(Kf):(e=Kf(e))in n?[e]:e.match(Vf)||[]).length;for(;i--;)delete n[e[i]]}(void 0===e||Pf.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData(t){const e=t[this.expando];return void 0!==e&&!Pf.isEmptyObject(e)}};const ig=new eg,ng=new eg,rg=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,og=/[A-Z]/g;function sg(t,e,i){let n;if(void 0===i&&1===t.nodeType)if(n=`data-${e.replace(og,"-$&").toLowerCase()}`,"string"==typeof(i=t.getAttribute(n))){try{i=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===""+ +t?+t:rg.test(t)?JSON.parse(t):t)}(i)}catch(t){}ng.set(t,e,i)}else i=void 0;return i}Pf.extend({hasData:t=>ng.hasData(t)||ig.hasData(t),data:(t,e,i)=>ng.access(t,e,i),removeData(t,e){ng.remove(t,e)},_data:(t,e,i)=>ig.access(t,e,i),_removeData(t,e){ig.remove(t,e)}}),Pf.fn.extend({data(t,e){let i,n,r;const o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=ng.get(o),1===o.nodeType&&!ig.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=Kf(n.slice(5)),sg(o,n,r[n])));ig.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){ng.set(this,t)})):$f(this,(function(e){let i;if(o&&void 0===e)return i=ng.get(o,t),void 0!==i?i:(i=sg(o,t),void 0!==i?i:void 0);this.each((function(){ng.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData(t){return this.each((function(){ng.remove(this,t)}))}}),Pf.extend({queue(t,e,i){let n;if(t)return e=`${e||"fx"}queue`,n=ig.get(t,e),i&&(!n||Array.isArray(i)?n=ig.access(t,e,Pf.makeArray(i)):n.push(i)),n||[]},dequeue(t,e){e=e||"fx";const i=Pf.queue(t,e);let n=i.length,r=i.shift();const o=Pf._queueHooks(t,e),s=function(){Pf.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,s,o)),!n&&o&&o.empty.fire()},_queueHooks(t,e){const i=`${e}queueHooks`;return ig.get(t,i)||ig.access(t,i,{empty:Pf.Callbacks("once memory").add((()=>{ig.remove(t,[`${e}queue`,i])}))})}}),Pf.fn.extend({queue(t,e){let i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?Pf.queue(this[0],t):void 0===e?this:this.each((function(){const i=Pf.queue(this,t,e);Pf._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&Pf.dequeue(this,t)}))},dequeue(t){return this.each((function(){Pf.dequeue(this,t)}))},clearQueue(t){return this.queue(t||"fx",[])},promise(t,e){let i,n=1;const r=Pf.Deferred(),o=this;let s=this.length;const a=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)i=ig.get(o[s],`${t}queueHooks`),i&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(e)}});const ag=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,lg=new RegExp(`^(?:([+-])=|)(${ag})([a-z%]*)$`,"i"),ug=["Top","Right","Bottom","Left"],{documentElement:cg}=uf;let hg=function(t){return Pf.contains(t.ownerDocument,t)};const pg={composed:!0};cg.getRootNode&&(hg=function(t){return Pf.contains(t.ownerDocument,t)||t.getRootNode(pg)===t.ownerDocument});const dg=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&hg(t)&&"none"===Pf.css(t,"display")},fg=function(t,e,i,n){let r,o;const s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];for(o in r=i.apply(t,n||[]),e)t.style[o]=s[o];return r};function gg(t,e,i,n){let r,o,s=20;const a=n?function(){return n.cur()}:function(){return Pf.css(t,e,"")};let l=a(),u=i&&i[3]||(Pf.cssNumber[e]?"":"px"),c=t.nodeType&&(Pf.cssNumber[e]||"px"!==u&&+l)&&lg.exec(Pf.css(t,e));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;s--;)Pf.style(t,e,c+u),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),c/=o;c*=2,Pf.style(t,e,c+u),i=i||[]}return i&&(c=+c||+l||0,r=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=u,n.start=c,n.end=r)),r}const mg={};function _g(t){let e;const i=t.ownerDocument,{nodeName:n}=t;let r=mg[n];return r||(e=i.body.appendChild(i.createElement(n)),r=Pf.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),mg[n]=r,r)}function yg(t,e){let i,n;const r=[];let o=0;const{length:s}=t;for(;o<s;o++)n=t[o],n.style&&(i=n.style.display,e?("none"===i&&(r[o]=ig.get(n,"display")||null,r[o]||(n.style.display="")),""===n.style.display&&dg(n)&&(r[o]=_g(n))):"none"!==i&&(r[o]="none",ig.set(n,"display",i)));for(o=0;o<s;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}Pf.fn.extend({show(){return yg(this,!0)},hide(){return yg(this)},toggle(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){dg(this)?Pf(this).show():Pf(this).hide()}))}});const vg=/^(?:checkbox|radio)$/i,Cg=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,xg=/^$|^module$|\/(?:java|ecma)script/i,wg={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function bg(t,e){let i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&Rf(t,e)?Pf.merge([t],i):i}function Eg(t,e){let i=0;const n=t.length;for(;i<n;i++)ig.set(t[i],"globalEval",!e||ig.get(e[i],"globalEval"))}wg.optgroup=wg.option,wg.tbody=wg.tfoot=wg.colgroup=wg.caption=wg.thead,wg.th=wg.td;const Sg=/<|&#?\w+;/;function Tg(t,e,i,n,r){let o,s,a,l,u,c;const h=e.createDocumentFragment(),p=[];let d=0;const f=t.length;for(;d<f;d++)if(o=t[d],o||0===o)if("object"===Sf(o))Pf.merge(p,o.nodeType?[o]:o);else if(Sg.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(Cg.exec(o)||["",""])[1].toLowerCase(),l=wg[a]||wg._default,s.innerHTML=l[1]+Pf.htmlPrefilter(o)+l[2],c=l[0];c--;)s=s.lastChild;Pf.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(e.createTextNode(o));for(h.textContent="",d=0;o=p[d++];)if(n&&Pf.inArray(o,n)>-1)r&&r.push(o);else if(u=hg(o),s=bg(h.appendChild(o),"script"),u&&Eg(s),i)for(c=0;o=s[c++];)xg.test(o.type||"")&&i.push(o);return h}!function(){const t=uf.createDocumentFragment().appendChild(uf.createElement("div")),e=uf.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),Cf.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Cf.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();const Pg=/^key/,Ag=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ig=/^([^.]*)(?:\.(.+)|)/;function Lg(){return!0}function Ng(){return!1}function Mg(t,e){return t===function(){try{return uf.activeElement}catch(t){}}()==("focus"===e)}function Dg(t,e,i,n,r,o){let s,a;if("object"==typeof e){for(a in"string"!=typeof i&&(n=n||i,i=void 0),e)Dg(t,a,i,n,e[a],o);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=Ng;else if(!r)return t;return 1===o&&(s=r,r=function(t){return Pf().off(t),s.apply(this,arguments)},r.guid=s.guid||(s.guid=Pf.guid++)),t.each((function(){Pf.event.add(this,e,r,n,i)}))}function Rg(t,e,i){i?(ig.set(t,e,!1),Pf.event.add(t,e,{namespace:!1,handler(t){let n,r,o=ig.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(Pf.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=hf.call(arguments),ig.set(this,e,o),n=i(this,e),this[e](),r=ig.get(this,e),o!==r||n?ig.set(this,e,!1):r={},o!==r)return t.stopImmediatePropagation(),t.preventDefault(),r.value}else o.length&&(ig.set(this,e,{value:Pf.event.trigger(Pf.extend(o[0],Pf.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===ig.get(t,e)&&Pf.event.add(t,e,Lg)}Pf.event={global:{},add(t,e,i,n,r){let o,s,a,l,u,c,h,p,d,f,g;const m=ig.get(t);if(m)for(i.handler&&(o=i,i=o.handler,r=o.selector),r&&Pf.find.matchesSelector(cg,r),i.guid||(i.guid=Pf.guid++),(l=m.events)||(l=m.events={}),(s=m.handle)||(s=m.handle=function(e){return void 0!==Pf&&Pf.event.triggered!==e.type?Pf.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(Vf)||[""]).length;u--;)a=Ig.exec(e[u])||[],d=g=a[1],f=(a[2]||"").split(".").sort(),d&&(h=Pf.event.special[d]||{},d=(r?h.delegateType:h.bindType)||d,h=Pf.event.special[d]||{},c=Pf.extend({type:d,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&Pf.expr.match.needsContext.test(r),namespace:f.join(".")},o),(p=l[d])||(p=l[d]=[],p.delegateCount=0,h.setup&&!1!==h.setup.call(t,n,f,s)||t.addEventListener&&t.addEventListener(d,s)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),r?p.splice(p.delegateCount++,0,c):p.push(c),Pf.event.global[d]=!0)},remove(t,e,i,n,r){let o,s,a,l,u,c,h,p,d,f,g;const m=ig.hasData(t)&&ig.get(t);if(m&&(l=m.events)){for(u=(e=(e||"").match(Vf)||[""]).length;u--;)if(a=Ig.exec(e[u])||[],d=g=a[1],f=(a[2]||"").split(".").sort(),d){for(h=Pf.event.special[d]||{},d=(n?h.delegateType:h.bindType)||d,p=l[d]||[],a=a[2]&&new RegExp(`(^|\\.)${f.join("\\.(?:.*\\.|)")}(\\.|$)`),s=o=p.length;o--;)c=p[o],!r&&g!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,h.remove&&h.remove.call(t,c));s&&!p.length&&(h.teardown&&!1!==h.teardown.call(t,f,m.handle)||Pf.removeEvent(t,d,m.handle),delete l[d])}else for(d in l)Pf.event.remove(t,d+e[u],i,n,!0);Pf.isEmptyObject(l)&&ig.remove(t,"handle events")}},dispatch(t){const e=Pf.event.fix(t);let i,n,r,o,s,a;const l=new Array(arguments.length),u=(ig.get(this,"events")||{})[e.type]||[],c=Pf.event.special[e.type]||{};for(l[0]=e,i=1;i<arguments.length;i++)l[i]=arguments[i];if(e.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(a=Pf.event.handlers.call(this,e,u),i=0;(o=a[i++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(s=o.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!1!==s.namespace&&!e.rnamespace.test(s.namespace)||(e.handleObj=s,e.data=s.data,r=((Pf.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,l),void 0!==r&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers(t,e){let i,n,r,o,s;const a=[],{delegateCount:l}=e;let u=t.target;if(l&&u.nodeType&&!("click"===t.type&&t.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==t.type||!0!==u.disabled)){for(o=[],s={},i=0;i<l;i++)n=e[i],r=`${n.selector} `,void 0===s[r]&&(s[r]=n.needsContext?Pf(r,this).index(u)>-1:Pf.find(r,this,null,[u]).length),s[r]&&o.push(n);o.length&&a.push({elem:u,handlers:o})}return u=this,l<e.length&&a.push({elem:u,handlers:e.slice(l)}),a},addProp(t,e){Object.defineProperty(Pf.Event.prototype,t,{enumerable:!0,configurable:!0,get:xf(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:t=>t[Pf.expando]?t:new Pf.Event(t),special:{load:{noBubble:!0},click:{setup(t){const e=this||t;return vg.test(e.type)&&e.click&&Rf(e,"input")&&Rg(e,"click",Lg),!1},trigger(t){const e=this||t;return vg.test(e.type)&&e.click&&Rf(e,"input")&&Rg(e,"click"),!0},_default(t){const{target:e}=t;return vg.test(e.type)&&e.click&&Rf(e,"input")&&ig.get(e,"click")||Rf(e,"a")}},beforeunload:{postDispatch(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},Pf.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},Pf.Event=function(t,e){if(!(this instanceof Pf.Event))return new Pf.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Lg:Ng,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&Pf.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[Pf.expando]=!0},Pf.Event.prototype={constructor:Pf.Event,isDefaultPrevented:Ng,isPropagationStopped:Ng,isImmediatePropagationStopped:Ng,isSimulated:!1,preventDefault(){const t=this.originalEvent;this.isDefaultPrevented=Lg,t&&!this.isSimulated&&t.preventDefault()},stopPropagation(){const t=this.originalEvent;this.isPropagationStopped=Lg,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation(){const t=this.originalEvent;this.isImmediatePropagationStopped=Lg,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},Pf.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which(t){const{button:e}=t;return null==t.which&&Pg.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Ag.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},Pf.event.addProp),Pf.each({focus:"focusin",blur:"focusout"},((t,e)=>{Pf.event.special[t]={setup(){return Rg(this,t,Mg),!1},trigger(){return Rg(this,t),!0},delegateType:e}})),Pf.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},((t,e)=>{Pf.event.special[t]={delegateType:e,bindType:e,handle(t){let i;const n=t.relatedTarget,{handleObj:r}=t;return n&&(n===this||Pf.contains(this,n))||(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}})),Pf.fn.extend({on(t,e,i,n){return Dg(this,t,e,i,n)},one(t,e,i,n){return Dg(this,t,e,i,n,1)},off(t,e,i){let n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,Pf(t.delegateTarget).off(n.namespace?`${n.origType}.${n.namespace}`:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=Ng),this.each((function(){Pf.event.remove(this,t,i,e)}))}});const Og=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Fg=/<script|<style|<link/i,kg=/checked\s*(?:[^=]|=\s*.checked.)/i,zg=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Gg(t,e){return Rf(t,"table")&&Rf(11!==e.nodeType?e:e.firstChild,"tr")&&Pf(t).children("tbody")[0]||t}function Bg(t){return t.type=`${null!==t.getAttribute("type")}/${t.type}`,t}function Ug(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Vg(t,e){let i,n,r,o,s,a,l,u;if(1===e.nodeType){if(ig.hasData(t)&&(o=ig.access(t),s=ig.set(e,o),u=o.events,u))for(r in delete s.handle,s.events={},u)for(i=0,n=u[r].length;i<n;i++)Pf.event.add(e,r,u[r][i]);ng.hasData(t)&&(a=ng.access(t),l=Pf.extend({},a),ng.set(e,l))}}function Hg(t,e){const i=e.nodeName.toLowerCase();"input"===i&&vg.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function Wg(t,e,i,n){let r,o,s,a,l,u;e=pf.apply([],e);let c=0;const h=t.length,p=h-1,d=e[0],f=xf(d);if(f||h>1&&"string"==typeof d&&!Cf.checkClone&&kg.test(d))return t.each((function(r){const o=t.eq(r);f&&(e[0]=d.call(this,r,o.html())),Wg(o,e,i,n)}));if(h&&(r=Tg(e,t[0].ownerDocument,!1,t,n),o=r.firstChild,1===r.childNodes.length&&(r=o),o||n)){for(s=Pf.map(bg(r,"script"),Bg),a=s.length;c<h;c++)l=r,c!==p&&(l=Pf.clone(l,!0,!0),a&&Pf.merge(s,bg(l,"script"))),i.call(t[c],l,c);if(a)for(u=s[s.length-1].ownerDocument,Pf.map(s,Ug),c=0;c<a;c++)l=s[c],xg.test(l.type||"")&&!ig.access(l,"globalEval")&&Pf.contains(u,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?Pf._evalUrl&&!l.noModule&&Pf._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")}):Ef(l.textContent.replace(zg,""),l,u))}return t}function jg(t,e,i){let n;const r=e?Pf.filter(e,t):t;let o=0;for(;null!=(n=r[o]);o++)i||1!==n.nodeType||Pf.cleanData(bg(n)),n.parentNode&&(i&&hg(n)&&Eg(bg(n,"script")),n.parentNode.removeChild(n));return t}Pf.extend({htmlPrefilter:t=>t.replace(Og,"<$1></$2>"),clone(t,e,i){let n,r,o,s;const a=t.cloneNode(!0),l=hg(t);if(!(Cf.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||Pf.isXMLDoc(t)))for(s=bg(a),o=bg(t),n=0,r=o.length;n<r;n++)Hg(o[n],s[n]);if(e)if(i)for(o=o||bg(t),s=s||bg(a),n=0,r=o.length;n<r;n++)Vg(o[n],s[n]);else Vg(t,a);return s=bg(a,"script"),s.length>0&&Eg(s,!l&&bg(t,"script")),a},cleanData(t){let e,i,n;const{special:r}=Pf.event;let o=0;for(;void 0!==(i=t[o]);o++)if(tg(i)){if(e=i[ig.expando]){if(e.events)for(n in e.events)r[n]?Pf.event.remove(i,n):Pf.removeEvent(i,n,e.handle);i[ig.expando]=void 0}i[ng.expando]&&(i[ng.expando]=void 0)}}}),Pf.fn.extend({detach(t){return jg(this,t,!0)},remove(t){return jg(this,t)},text(t){return $f(this,(function(t){return void 0===t?Pf.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append(){return Wg(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){Gg(this,t).appendChild(t)}}))},prepend(){return Wg(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){const e=Gg(this,t);e.insertBefore(t,e.firstChild)}}))},before(){return Wg(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after(){return Wg(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty(){let t,e=0;for(;null!=(t=this[e]);e++)1===t.nodeType&&(Pf.cleanData(bg(t,!1)),t.textContent="");return this},clone(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return Pf.clone(this,t,e)}))},html(t){return $f(this,(function(t){let e=this[0]||{},i=0;const n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Fg.test(t)&&!wg[(Cg.exec(t)||["",""])[1].toLowerCase()]){t=Pf.htmlPrefilter(t);try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(Pf.cleanData(bg(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith(){const t=[];return Wg(this,arguments,(function(e){const i=this.parentNode;Pf.inArray(this,t)<0&&(Pf.cleanData(bg(this)),i&&i.replaceChild(e,this))}),t)}}),Pf.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},((t,e)=>{Pf.fn[t]=function(t){let i;const n=[],r=Pf(t),o=r.length-1;let s=0;for(;s<=o;s++)i=s===o?this:this.clone(!0),Pf(r[s])[e](i),df.apply(n,i.get());return this.pushStack(n)}}));const qg=new RegExp(`^(${ag})(?!px)[a-z%]+$`,"i"),Yg=function(t){let e=t.ownerDocument.defaultView;return e&&e.opener||(e=window),e.getComputedStyle(t)},Xg=new RegExp(ug.join("|"),"i");function $g(t,e,i){let n,r,o,s;const{style:a}=t;return(i=i||Yg(t))&&(s=i.getPropertyValue(e)||i[e],""!==s||hg(t)||(s=Pf.style(t,e)),!Cf.pixelBoxStyles()&&qg.test(s)&&Xg.test(e)&&(n=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=r,a.maxWidth=o)),void 0!==s?`${s}`:s}function Jg(t,e){return{get(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(!l)return;a.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",cg.appendChild(a).appendChild(l);const t=window.getComputedStyle(l);i="1%"!==t.top,s=12===e(t.marginLeft),l.style.right="60%",o=36===e(t.right),n=36===e(t.width),l.style.position="absolute",r=12===e(l.offsetWidth/3),cg.removeChild(a),l=null}function e(t){return Math.round(parseFloat(t))}let i,n,r,o,s;var a=uf.createElement("div"),l=uf.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",Cf.clearCloneStyle="content-box"===l.style.backgroundClip,Pf.extend(Cf,{boxSizingReliable:()=>(t(),n),pixelBoxStyles:()=>(t(),o),pixelPosition:()=>(t(),i),reliableMarginLeft:()=>(t(),s),scrollboxSize:()=>(t(),r)}))}();const Qg=["Webkit","Moz","ms"],Zg=uf.createElement("div").style,Kg={};function tm(t){const e=Pf.cssProps[t]||Kg[t];return e||(t in Zg?t:Kg[t]=function(t){const e=t[0].toUpperCase()+t.slice(1);let i=Qg.length;for(;i--;)if((t=Qg[i]+e)in Zg)return t}(t)||t)}const em=/^(none|table(?!-c[ea]).+)/,im=/^--/,nm={position:"absolute",visibility:"hidden",display:"block"},rm={letterSpacing:"0",fontWeight:"400"};function om(t,e,i){const n=lg.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function sm(t,e,i,n,r,o){let s="width"===e?1:0,a=0,l=0;if(i===(n?"border":"content"))return 0;for(;s<4;s+=2)"margin"===i&&(l+=Pf.css(t,i+ug[s],!0,r)),n?("content"===i&&(l-=Pf.css(t,`padding${ug[s]}`,!0,r)),"margin"!==i&&(l-=Pf.css(t,`border${ug[s]}Width`,!0,r))):(l+=Pf.css(t,`padding${ug[s]}`,!0,r),"padding"!==i?l+=Pf.css(t,`border${ug[s]}Width`,!0,r):a+=Pf.css(t,`border${ug[s]}Width`,!0,r));return!n&&o>=0&&(l+=Math.max(0,Math.ceil(t[`offset${e[0].toUpperCase()}${e.slice(1)}`]-o-l-a-.5))||0),l}function am(t,e,i){const n=Yg(t);let r=(!Cf.boxSizingReliable()||i)&&"border-box"===Pf.css(t,"boxSizing",!1,n),o=r,s=$g(t,e,n);const a=`offset${e[0].toUpperCase()}${e.slice(1)}`;if(qg.test(s)){if(!i)return s;s="auto"}return(!Cf.boxSizingReliable()&&r||"auto"===s||!parseFloat(s)&&"inline"===Pf.css(t,"display",!1,n))&&t.getClientRects().length&&(r="border-box"===Pf.css(t,"boxSizing",!1,n),o=a in t,o&&(s=t[a])),s=parseFloat(s)||0,`${s+sm(t,e,i||(r?"border":"content"),o,n,s)}px`}function lm(t,e,i,n,r){return new lm.prototype.init(t,e,i,n,r)}let um,cm;Pf.extend({cssHooks:{opacity:{get(t,e){if(e){const e=$g(t,"opacity");return""===e?"1":e}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style(t,e,i,n){if(!t||3===t.nodeType||8===t.nodeType||!t.style)return;let r,o,s;const a=Kf(e),l=im.test(e),{style:u}=t;if(l||(e=tm(a)),s=Pf.cssHooks[e]||Pf.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(r=s.get(t,!1,n))?r:u[e];o=typeof i,"string"===o&&(r=lg.exec(i))&&r[1]&&(i=gg(t,e,r),o="number"),null!=i&&i==i&&("number"!==o||l||(i+=r&&r[3]||(Pf.cssNumber[a]?"":"px")),Cf.clearCloneStyle||""!==i||0!==e.indexOf("background")||(u[e]="inherit"),s&&"set"in s&&void 0===(i=s.set(t,i,n))||(l?u.setProperty(e,i):u[e]=i))},css(t,e,i,n){let r,o,s;const a=Kf(e);return im.test(e)||(e=tm(a)),s=Pf.cssHooks[e]||Pf.cssHooks[a],s&&"get"in s&&(r=s.get(t,!0,i)),void 0===r&&(r=$g(t,e,n)),"normal"===r&&e in rm&&(r=rm[e]),""===i||i?(o=parseFloat(r),!0===i||isFinite(o)?o||0:r):r}}),Pf.each(["height","width"],((t,e)=>{Pf.cssHooks[e]={get(t,i,n){if(i)return!em.test(Pf.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?am(t,e,n):fg(t,nm,(()=>am(t,e,n)))},set(t,i,n){let r;const o=Yg(t),s=!Cf.scrollboxSize()&&"absolute"===o.position,a=(s||n)&&"border-box"===Pf.css(t,"boxSizing",!1,o);let l=n?sm(t,e,n,a,o):0;return a&&s&&(l-=Math.ceil(t[`offset${e[0].toUpperCase()}${e.slice(1)}`]-parseFloat(o[e])-sm(t,e,"border",!1,o)-.5)),l&&(r=lg.exec(i))&&"px"!==(r[3]||"px")&&(t.style[e]=i,i=Pf.css(t,e)),om(0,i,l)}}})),Pf.cssHooks.marginLeft=Jg(Cf.reliableMarginLeft,((t,e)=>{if(e)return`${parseFloat($g(t,"marginLeft"))||t.getBoundingClientRect().left-fg(t,{marginLeft:0},(()=>t.getBoundingClientRect().left))}px`})),Pf.each({margin:"",padding:"",border:"Width"},((t,e)=>{Pf.cssHooks[t+e]={expand(i){let n=0;const r={},o="string"==typeof i?i.split(" "):[i];for(;n<4;n++)r[t+ug[n]+e]=o[n]||o[n-2]||o[0];return r}},"margin"!==t&&(Pf.cssHooks[t+e].set=om)})),Pf.fn.extend({css(t,e){return $f(this,((t,e,i)=>{let n,r;const o={};let s=0;if(Array.isArray(e)){for(n=Yg(t),r=e.length;s<r;s++)o[e[s]]=Pf.css(t,e[s],!1,n);return o}return void 0!==i?Pf.style(t,e,i):Pf.css(t,e)}),t,e,arguments.length>1)}}),Pf.Tween=lm,lm.prototype={constructor:lm,init(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||Pf.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(Pf.cssNumber[i]?"":"px")},cur(){const t=lm.propHooks[this.prop];return t&&t.get?t.get(this):lm.propHooks._default.get(this)},run(t){let e;const i=lm.propHooks[this.prop];return this.options.duration?this.pos=e=Pf.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):lm.propHooks._default.set(this),this}},lm.prototype.init.prototype=lm.prototype,lm.propHooks={_default:{get(t){let e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=Pf.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set(t){Pf.fx.step[t.prop]?Pf.fx.step[t.prop](t):1!==t.elem.nodeType||!Pf.cssHooks[t.prop]&&null==t.elem.style[tm(t.prop)]?t.elem[t.prop]=t.now:Pf.style(t.elem,t.prop,t.now+t.unit)}}},lm.propHooks.scrollTop=lm.propHooks.scrollLeft={set(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},Pf.easing={linear:t=>t,swing:t=>.5-Math.cos(t*Math.PI)/2,_default:"swing"},Pf.fx=lm.prototype.init,Pf.fx.step={};const hm=/^(?:toggle|show|hide)$/,pm=/queueHooks$/;function dm(){cm&&(!1===uf.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(dm):window.setTimeout(dm,Pf.fx.interval),Pf.fx.tick())}function fm(){return window.setTimeout((()=>{um=void 0})),um=Date.now()}function gm(t,e){let i,n=0;const r={height:t};for(e=e?1:0;n<4;n+=2-e)i=ug[n],r[`margin${i}`]=r[`padding${i}`]=t;return e&&(r.opacity=r.width=t),r}function mm(t,e,i){let n;const r=(_m.tweeners[e]||[]).concat(_m.tweeners["*"]);let o=0;const{length:s}=r;for(;o<s;o++)if(n=r[o].call(i,e,t))return n}function _m(t,e,i){let n,r,o=0;const{length:s}=_m.prefilters,a=Pf.Deferred().always((()=>{delete l.elem}));var l=function(){if(r)return!1;const e=um||fm(),i=Math.max(0,u.startTime+u.duration-e),n=1-(i/u.duration||0);let o=0;const{length:s}=u.tweens;for(;o<s;o++)u.tweens[o].run(n);return a.notifyWith(t,[u,n,i]),n<1&&s?i:(s||a.notifyWith(t,[u,1,0]),a.resolveWith(t,[u]),!1)},u=a.promise({elem:t,props:Pf.extend({},e),opts:Pf.extend(!0,{specialEasing:{},easing:Pf.easing._default},i),originalProperties:e,originalOptions:i,startTime:um||fm(),duration:i.duration,tweens:[],createTween(e,i){const n=Pf.Tween(t,u.opts,e,i,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(n),n},stop(e){let i=0;const n=e?u.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)u.tweens[i].run(1);return e?(a.notifyWith(t,[u,1,0]),a.resolveWith(t,[u,e])):a.rejectWith(t,[u,e]),this}});const{props:c}=u;for(!function(t,e){let i,n,r,o,s;for(i in t)if(n=Kf(i),r=e[n],o=t[i],Array.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),s=Pf.cssHooks[n],s&&"expand"in s)for(i in o=s.expand(o),delete t[n],o)i in t||(t[i]=o[i],e[i]=r);else e[n]=r}(c,u.opts.specialEasing);o<s;o++)if(n=_m.prefilters[o].call(u,t,c,u.opts),n)return xf(n.stop)&&(Pf._queueHooks(u.elem,u.opts.queue).stop=n.stop.bind(n)),n;return Pf.map(c,mm,u),xf(u.opts.start)&&u.opts.start.call(t,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),Pf.fx.timer(Pf.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u}let ym;Pf.Animation=Pf.extend(_m,{tweeners:{"*":[function(t,e){const i=this.createTween(t,e);return gg(i.elem,t,lg.exec(e),i),i}]},tweener(t,e){let i;xf(t)?(e=t,t=["*"]):t=t.match(Vf);let n=0;const{length:r}=t;for(;n<r;n++)i=t[n],_m.tweeners[i]=_m.tweeners[i]||[],_m.tweeners[i].unshift(e)},prefilters:[function(t,e,i){let n,r,o,s,a,l,u,c;const h="width"in e||"height"in e,p=this,d={},{style:f}=t;let g=t.nodeType&&dg(t),m=ig.get(t,"fxshow");for(n in i.queue||(s=Pf._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,p.always((()=>{p.always((()=>{s.unqueued--,Pf.queue(t,"fx").length||s.empty.fire()}))}))),e)if(r=e[n],hm.test(r)){if(delete e[n],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;g=!0}d[n]=m&&m[n]||Pf.style(t,n)}if(l=!Pf.isEmptyObject(e),l||!Pf.isEmptyObject(d))for(n in h&&1===t.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],u=m&&m.display,null==u&&(u=ig.get(t,"display")),c=Pf.css(t,"display"),"none"===c&&(u?c=u:(yg([t],!0),u=t.style.display||u,c=Pf.css(t,"display"),yg([t]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===Pf.css(t,"float")&&(l||(p.done((()=>{f.display=u})),null==u&&(c=f.display,u="none"===c?"":c)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",p.always((()=>{f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}))),l=!1,d)l||(m?"hidden"in m&&(g=m.hidden):m=ig.access(t,"fxshow",{display:u}),o&&(m.hidden=!g),g&&yg([t],!0),p.done((()=>{for(n in g||yg([t]),ig.remove(t,"fxshow"),d)Pf.style(t,n,d[n])}))),l=mm(g?m[n]:0,n,p),n in m||(m[n]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter(t,e){e?_m.prefilters.unshift(t):_m.prefilters.push(t)}}),Pf.speed=function(t,e,i){const n=t&&"object"==typeof t?Pf.extend({},t):{complete:i||!i&&e||xf(t)&&t,duration:t,easing:i&&e||e&&!xf(e)&&e};return Pf.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in Pf.fx.speeds?n.duration=Pf.fx.speeds[n.duration]:n.duration=Pf.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){xf(n.old)&&n.old.call(this),n.queue&&Pf.dequeue(this,n.queue)},n},Pf.fn.extend({fadeTo(t,e,i,n){return this.filter(dg).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate(t,e,i,n){const r=Pf.isEmptyObject(t),o=Pf.speed(e,i,n),s=function(){const e=_m(this,Pf.extend({},t),o);(r||ig.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop(t,e,i){const n=function(t){const{stop:e}=t;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){let e=!0,r=null!=t&&`${t}queueHooks`;const{timers:o}=Pf,s=ig.get(this);if(r)s[r]&&s[r].stop&&n(s[r]);else for(r in s)s[r]&&s[r].stop&&pm.test(r)&&n(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(i),e=!1,o.splice(r,1));!e&&i||Pf.dequeue(this,t)}))},finish(t){return!1!==t&&(t=t||"fx"),this.each((function(){let e;const i=ig.get(this),n=i[`${t}queue`],r=i[`${t}queueHooks`],{timers:o}=Pf,s=n?n.length:0;for(i.finish=!0,Pf.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),Pf.each(["toggle","show","hide"],((t,e)=>{const i=Pf.fn[e];Pf.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(gm(e,!0),t,n,r)}})),Pf.each({slideDown:gm("show"),slideUp:gm("hide"),slideToggle:gm("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},((t,e)=>{Pf.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),Pf.timers=[],Pf.fx.tick=function(){let t,e=0;const{timers:i}=Pf;for(um=Date.now();e<i.length;e++)t=i[e],t()||i[e]!==t||i.splice(e--,1);i.length||Pf.fx.stop(),um=void 0},Pf.fx.timer=function(t){Pf.timers.push(t),Pf.fx.start()},Pf.fx.interval=13,Pf.fx.start=function(){cm||(cm=!0,dm())},Pf.fx.stop=function(){cm=null},Pf.fx.speeds={slow:600,fast:200,_default:400},Pf.fn.delay=function(t,e){return t=Pf.fx&&Pf.fx.speeds[t]||t,e=e||"fx",this.queue(e,((e,i)=>{const n=window.setTimeout(e,t);i.stop=function(){window.clearTimeout(n)}}))},function(){let t=uf.createElement("input");const e=uf.createElement("select").appendChild(uf.createElement("option"));t.type="checkbox",Cf.checkOn=""!==t.value,Cf.optSelected=e.selected,t=uf.createElement("input"),t.value="t",t.type="radio",Cf.radioValue="t"===t.value}();const{attrHandle:vm}=Pf.expr;Pf.fn.extend({attr(t,e){return $f(this,Pf.attr,t,e,arguments.length>1)},removeAttr(t){return this.each((function(){Pf.removeAttr(this,t)}))}}),Pf.extend({attr(t,e,i){let n,r;const o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?Pf.prop(t,e,i):(1===o&&Pf.isXMLDoc(t)||(r=Pf.attrHooks[e.toLowerCase()]||(Pf.expr.match.bool.test(e)?ym:void 0)),void 0!==i?null===i?void Pf.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,`${i}`),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:(n=Pf.find.attr(t,e),null==n?void 0:n))},attrHooks:{type:{set(t,e){if(!Cf.radioValue&&"radio"===e&&Rf(t,"input")){const i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr(t,e){let i,n=0;const r=e&&e.match(Vf);if(r&&1===t.nodeType)for(;i=r[n++];)t.removeAttribute(i)}}),ym={set:(t,e,i)=>(!1===e?Pf.removeAttr(t,i):t.setAttribute(i,i),i)},Pf.each(Pf.expr.match.bool.source.match(/\w+/g),((t,e)=>{const i=vm[e]||Pf.find.attr;vm[e]=function(t,e,n){let r,o;const s=e.toLowerCase();return n||(o=vm[s],vm[s]=r,r=null!=i(t,e,n)?s:null,vm[s]=o),r}}));const Cm=/^(?:input|select|textarea|button)$/i,xm=/^(?:a|area)$/i;function wm(t){return(t.match(Vf)||[]).join(" ")}function bm(t){return t.getAttribute&&t.getAttribute("class")||""}function Em(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(Vf)||[]}Pf.fn.extend({prop(t,e){return $f(this,Pf.prop,t,e,arguments.length>1)},removeProp(t){return this.each((function(){delete this[Pf.propFix[t]||t]}))}}),Pf.extend({prop(t,e,i){let n,r;const o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&Pf.isXMLDoc(t)||(e=Pf.propFix[e]||e,r=Pf.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get(t){const e=Pf.find.attr(t,"tabindex");return e?parseInt(e,10):Cm.test(t.nodeName)||xm.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),Cf.optSelected||(Pf.propHooks.selected={get(t){const e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set(t){const e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),Pf.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){Pf.propFix[this.toLowerCase()]=this})),Pf.fn.extend({addClass(t){let e,i,n,r,o,s,a,l=0;if(xf(t))return this.each((function(e){Pf(this).addClass(t.call(this,e,bm(this)))}));if(e=Em(t),e.length)for(;i=this[l++];)if(r=bm(i),n=1===i.nodeType&&` ${wm(r)} `,n){for(s=0;o=e[s++];)n.indexOf(` ${o} `)<0&&(n+=`${o} `);a=wm(n),r!==a&&i.setAttribute("class",a)}return this},removeClass(t){let e,i,n,r,o,s,a,l=0;if(xf(t))return this.each((function(e){Pf(this).removeClass(t.call(this,e,bm(this)))}));if(!arguments.length)return this.attr("class","");if(e=Em(t),e.length)for(;i=this[l++];)if(r=bm(i),n=1===i.nodeType&&` ${wm(r)} `,n){for(s=0;o=e[s++];)for(;n.indexOf(` ${o} `)>-1;)n=n.replace(` ${o} `," ");a=wm(n),r!==a&&i.setAttribute("class",a)}return this},toggleClass(t,e){const i=typeof t,n="string"===i||Array.isArray(t);return"boolean"==typeof e&&n?e?this.addClass(t):this.removeClass(t):xf(t)?this.each((function(i){Pf(this).toggleClass(t.call(this,i,bm(this),e),e)})):this.each((function(){let e,r,o,s;if(n)for(r=0,o=Pf(this),s=Em(t);e=s[r++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==i||(e=bm(this),e&&ig.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":ig.get(this,"__className__")||""))}))},hasClass(t){let e,i,n=0;for(e=` ${t} `;i=this[n++];)if(1===i.nodeType&&` ${wm(bm(i))} `.indexOf(e)>-1)return!0;return!1}});const Sm=/\r/g;Pf.fn.extend({val(t){let e,i,n;const r=this[0];return arguments.length?(n=xf(t),this.each((function(i){let r;1===this.nodeType&&(r=n?t.call(this,i,Pf(this).val()):t,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=Pf.map(r,(t=>null==t?"":`${t}`))),e=Pf.valHooks[this.type]||Pf.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=Pf.valHooks[r.type]||Pf.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(Sm,""):null==i?"":i)):void 0}}),Pf.extend({valHooks:{option:{get(t){const e=Pf.find.attr(t,"value");return null!=e?e:wm(Pf.text(t))}},select:{get(t){let e,i,n;const{options:r}=t,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?o+1:r.length;for(n=o<0?l:s?o:0;n<l;n++)if(i=r[n],(i.selected||n===o)&&!i.disabled&&(!i.parentNode.disabled||!Rf(i.parentNode,"optgroup"))){if(e=Pf(i).val(),s)return e;a.push(e)}return a},set(t,e){let i,n;const{options:r}=t,o=Pf.makeArray(e);let s=r.length;for(;s--;)n=r[s],(n.selected=Pf.inArray(Pf.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),Pf.each(["radio","checkbox"],(function(){Pf.valHooks[this]={set(t,e){if(Array.isArray(e))return t.checked=Pf.inArray(Pf(t).val(),e)>-1}},Cf.checkOn||(Pf.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),Cf.focusin="onfocusin"in window;const Tm=/^(?:focusinfocus|focusoutblur)$/,Pm=function(t){t.stopPropagation()};Pf.extend(Pf.event,{trigger(t,e,i,n){let r,o,s,a,l,u,c,h;const p=[i||uf];let d=_f.call(t,"type")?t.type:t,f=_f.call(t,"namespace")?t.namespace.split("."):[];if(o=h=s=i=i||uf,3!==i.nodeType&&8!==i.nodeType&&!Tm.test(d+Pf.event.triggered)&&(d.indexOf(".")>-1&&(f=d.split("."),d=f.shift(),f.sort()),l=d.indexOf(":")<0&&`on${d}`,(t=t[Pf.expando]?t:new Pf.Event(d,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp(`(^|\\.)${f.join("\\.(?:.*\\.|)")}(\\.|$)`):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:Pf.makeArray(e,[t]),c=Pf.event.special[d]||{},n||!c.trigger||!1!==c.trigger.apply(i,e))){if(!n&&!c.noBubble&&!wf(i)){for(a=c.delegateType||d,Tm.test(a+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),s=o;s===(i.ownerDocument||uf)&&p.push(s.defaultView||s.parentWindow||window)}for(r=0;(o=p[r++])&&!t.isPropagationStopped();)h=o,t.type=r>1?a:c.bindType||d,u=(ig.get(o,"events")||{})[t.type]&&ig.get(o,"handle"),u&&u.apply(o,e),u=l&&o[l],u&&u.apply&&tg(o)&&(t.result=u.apply(o,e),!1===t.result&&t.preventDefault());return t.type=d,n||t.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),e)||!tg(i)||l&&xf(i[d])&&!wf(i)&&(s=i[l],s&&(i[l]=null),Pf.event.triggered=d,t.isPropagationStopped()&&h.addEventListener(d,Pm),i[d](),t.isPropagationStopped()&&h.removeEventListener(d,Pm),Pf.event.triggered=void 0,s&&(i[l]=s)),t.result}},simulate(t,e,i){const n=Pf.extend(new Pf.Event,i,{type:t,isSimulated:!0});Pf.event.trigger(n,null,e)}}),Pf.fn.extend({trigger(t,e){return this.each((function(){Pf.event.trigger(t,e,this)}))},triggerHandler(t,e){const i=this[0];if(i)return Pf.event.trigger(t,e,i,!0)}}),Cf.focusin||Pf.each({focus:"focusin",blur:"focusout"},((t,e)=>{const i=function(t){Pf.event.simulate(e,t.target,Pf.event.fix(t))};Pf.event.special[e]={setup(){const n=this.ownerDocument||this,r=ig.access(n,e);r||n.addEventListener(t,i,!0),ig.access(n,e,(r||0)+1)},teardown(){const n=this.ownerDocument||this,r=ig.access(n,e)-1;r?ig.access(n,e,r):(n.removeEventListener(t,i,!0),ig.remove(n,e))}}}));const{location:Am}=window;let Im=Date.now();const Lm=/\?/;Pf.parseXML=function(t){let e;if(!t||"string"!=typeof t)return null;try{e=(new window.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||Pf.error(`Invalid XML: ${t}`),e};const Nm=/\[\]$/,Mm=/\r?\n/g,Dm=/^(?:submit|button|image|reset|file)$/i,Rm=/^(?:input|select|textarea|keygen)/i;function Om(t,e,i,n){let r;if(Array.isArray(e))Pf.each(e,((e,r)=>{i||Nm.test(t)?n(t,r):Om(`${t}[${"object"==typeof r&&null!=r?e:""}]`,r,i,n)}));else if(i||"object"!==Sf(e))n(t,e);else for(r in e)Om(`${t}[${r}]`,e[r],i,n)}Pf.param=function(t,e){let i;const n=[],r=function(t,e){const i=xf(e)?e():e;n[n.length]=`${encodeURIComponent(t)}=${encodeURIComponent(null==i?"":i)}`};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!Pf.isPlainObject(t))Pf.each(t,(function(){r(this.name,this.value)}));else for(i in t)Om(i,t[i],e,r);return n.join("&")},Pf.fn.extend({serialize(){return Pf.param(this.serializeArray())},serializeArray(){return this.map((function(){const t=Pf.prop(this,"elements");return t?Pf.makeArray(t):this})).filter((function(){const{type:t}=this;return this.name&&!Pf(this).is(":disabled")&&Rm.test(this.nodeName)&&!Dm.test(t)&&(this.checked||!vg.test(t))})).map((function(t,e){const i=Pf(this).val();return null==i?null:Array.isArray(i)?Pf.map(i,(t=>({name:e.name,value:t.replace(Mm,"\r\n")}))):{name:e.name,value:i.replace(Mm,"\r\n")}})).get()}});const Fm=/%20/g,km=/#.*$/,zm=/([?&])_=[^&]*/,Gm=/^(.*?):[ \t]*([^\r\n]*)$/gm,Bm=/^(?:GET|HEAD)$/,Um=/^\/\//,Vm={},Hm={},Wm="*/".concat("*"),jm=uf.createElement("a");function qm(t){return function(e,i){let n;"string"!=typeof e&&(i=e,e="*");let r=0;const o=e.toLowerCase().match(Vf)||[];if(xf(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function Ym(t,e,i,n){const r={},o=t===Hm;function s(a){let l;return r[a]=!0,Pf.each(t[a]||[],((t,a)=>{const u=a(e,i,n);return"string"!=typeof u||o||r[u]?o?!(l=u):void 0:(e.dataTypes.unshift(u),s(u),!1)})),l}return s(e.dataTypes[0])||!r["*"]&&s("*")}function Xm(t,e){let i,n;const r=Pf.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&Pf.extend(!0,t,n),t}jm.href=Am.href,Pf.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Am.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Am.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Wm,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":Pf.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:(t,e)=>e?Xm(Xm(t,Pf.ajaxSettings),e):Xm(Pf.ajaxSettings,t),ajaxPrefilter:qm(Vm),ajaxTransport:qm(Hm),ajax(t,e){let i,n,r,o,s,a,l,u,c,h;"object"==typeof t&&(e=t,t=void 0),e=e||{};const p=Pf.ajaxSetup({},e),d=p.context||p,f=p.context&&(d.nodeType||d.jquery)?Pf(d):Pf.event,g=Pf.Deferred(),m=Pf.Callbacks("once memory");let _=p.statusCode||{};const y={},v={};let C="canceled";var x={readyState:0,getResponseHeader(t){let e;if(l){if(!o)for(o={};e=Gm.exec(r);)o[`${e[1].toLowerCase()} `]=(o[`${e[1].toLowerCase()} `]||[]).concat(e[2]);e=o[`${t.toLowerCase()} `]}return null==e?null:e.join(", ")},getAllResponseHeaders:()=>l?r:null,setRequestHeader(t,e){return null==l&&(t=v[t.toLowerCase()]=v[t.toLowerCase()]||t,y[t]=e),this},overrideMimeType(t){return null==l&&(p.mimeType=t),this},statusCode(t){let e;if(t)if(l)x.always(t[x.status]);else for(e in t)_[e]=[_[e],t[e]];return this},abort(t){const e=t||C;return i&&i.abort(e),w(0,e),this}};if(g.promise(x),p.url=`${t||p.url||Am.href}`.replace(Um,`${Am.protocol}//`),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(Vf)||[""],null==p.crossDomain){a=uf.createElement("a");try{a.href=p.url,a.href=a.href,p.crossDomain=`${jm.protocol}//${jm.host}`!=`${a.protocol}//${a.host}`}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=Pf.param(p.data,p.traditional)),Ym(Vm,p,e,x),l)return x;for(c in u=Pf.event&&p.global,u&&0==Pf.active++&&Pf.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Bm.test(p.type),n=p.url.replace(km,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Fm,"+")):(h=p.url.slice(n.length),p.data&&(p.processData||"string"==typeof p.data)&&(n+=(Lm.test(n)?"&":"?")+p.data,delete p.data),!1===p.cache&&(n=n.replace(zm,"$1"),h=`${Lm.test(n)?"&":"?"}_=${Im++}${h}`),p.url=n+h),p.ifModified&&(Pf.lastModified[n]&&x.setRequestHeader("If-Modified-Since",Pf.lastModified[n]),Pf.etag[n]&&x.setRequestHeader("If-None-Match",Pf.etag[n])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&x.setRequestHeader("Content-Type",p.contentType),x.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?`, ${Wm}; q=0.01`:""):p.accepts["*"]),p.headers)x.setRequestHeader(c,p.headers[c]);if(p.beforeSend&&(!1===p.beforeSend.call(d,x,p)||l))return x.abort();if(C="abort",m.add(p.complete),x.done(p.success),x.fail(p.error),i=Ym(Hm,p,e,x),i){if(x.readyState=1,u&&f.trigger("ajaxSend",[x,p]),l)return x;p.async&&p.timeout>0&&(s=window.setTimeout((()=>{x.abort("timeout")}),p.timeout));try{l=!1,i.send(y,w)}catch(t){if(l)throw t;w(-1,t)}}else w(-1,"No Transport");function w(t,e,o,a){let c,h,y,v,C,w=e;l||(l=!0,s&&window.clearTimeout(s),i=void 0,r=a||"",x.readyState=t>0?4:0,c=t>=200&&t<300||304===t,o&&(v=function(t,e,i){let n,r,o,s;const{contents:a}=t,{dataTypes:l}=t;for(;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){l.unshift(r);break}if(l[0]in i)o=l[0];else{for(r in i){if(!l[0]||t.converters[`${r} ${l[0]}`]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),i[o]}(p,x,o)),v=function(t,e,i,n){let r,o,s,a,l;const u={},c=t.dataTypes.slice();if(c[1])for(s in t.converters)u[s.toLowerCase()]=t.converters[s];for(o=c.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift(),o)if("*"===o)o=l;else if("*"!==l&&l!==o){if(s=u[`${l} ${o}`]||u[`* ${o}`],!s)for(r in u)if(a=r.split(" "),a[1]===o&&(s=u[`${l} ${a[0]}`]||u[`* ${a[0]}`],s)){!0===s?s=u[r]:!0!==u[r]&&(o=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:`No conversion from ${l} to ${o}`}}}return{state:"success",data:e}}(p,v,x,c),c?(p.ifModified&&(C=x.getResponseHeader("Last-Modified"),C&&(Pf.lastModified[n]=C),C=x.getResponseHeader("etag"),C&&(Pf.etag[n]=C)),204===t||"HEAD"===p.type?w="nocontent":304===t?w="notmodified":(w=v.state,h=v.data,y=v.error,c=!y)):(y=w,!t&&w||(w="error",t<0&&(t=0))),x.status=t,x.statusText=`${e||w}`,c?g.resolveWith(d,[h,w,x]):g.rejectWith(d,[x,w,y]),x.statusCode(_),_=void 0,u&&f.trigger(c?"ajaxSuccess":"ajaxError",[x,p,c?h:y]),m.fireWith(d,[x,w]),u&&(f.trigger("ajaxComplete",[x,p]),--Pf.active||Pf.event.trigger("ajaxStop")))}return x},getJSON:(t,e,i)=>Pf.get(t,e,i,"json"),getScript:(t,e)=>Pf.get(t,void 0,e,"script")}),Pf.each(["get","post"],((t,e)=>{Pf[e]=function(t,i,n,r){return xf(i)&&(r=r||n,n=i,i=void 0),Pf.ajax(Pf.extend({url:t,type:e,dataType:r,data:i,success:n},Pf.isPlainObject(t)&&t))}})),Pf._evalUrl=function(t,e){return Pf.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter(t){Pf.globalEval(t,e)}})},Pf.fn.extend({wrapAll(t){let e;return this[0]&&(xf(t)&&(t=t.call(this[0])),e=Pf(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){let t=this;for(;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner(t){return xf(t)?this.each((function(e){Pf(this).wrapInner(t.call(this,e))})):this.each((function(){const e=Pf(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap(t){const e=xf(t);return this.each((function(i){Pf(this).wrapAll(e?t.call(this,i):t)}))},unwrap(t){return this.parent(t).not("body").each((function(){Pf(this).replaceWith(this.childNodes)})),this}}),Pf.expr.pseudos.hidden=function(t){return!Pf.expr.pseudos.visible(t)},Pf.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},Pf.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(t){}};const $m={0:200,1223:204};let Jm=Pf.ajaxSettings.xhr();Cf.cors=!!Jm&&"withCredentials"in Jm,Cf.ajax=Jm=!!Jm,Pf.ajaxTransport((t=>{let e,i;if(Cf.cors||Jm&&!t.crossDomain)return{send(n,r){let o;const s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)s[o]=t.xhrFields[o];for(o in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)s.setRequestHeader(o,n[o]);e=function(t){return function(){e&&(e=i=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?r(0,"error"):r(s.status,s.statusText):r($m[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=e(),i=s.onerror=s.ontimeout=e("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&window.setTimeout((()=>{e&&i()}))},e=e("abort");try{s.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort(){e&&e()}}})),Pf.ajaxPrefilter((t=>{t.crossDomain&&(t.contents.script=!1)})),Pf.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return Pf.globalEval(t),t}}}),Pf.ajaxPrefilter("script",(t=>{void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),Pf.ajaxTransport("script",(t=>{if(t.crossDomain||t.scriptAttrs){let e,i;return{send(n,r){e=Pf("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&r("error"===t.type?404:200,t.type)}),uf.head.appendChild(e[0])},abort(){i&&i()}}}}));const Qm=[],Zm=/(=)\?(?=&|$)|\?\?/;Pf.ajaxSetup({jsonp:"callback",jsonpCallback(){const t=Qm.pop()||`${Pf.expando}_${Im++}`;return this[t]=!0,t}}),Pf.ajaxPrefilter("json jsonp",((t,e,i)=>{let n,r,o;const s=!1!==t.jsonp&&(Zm.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zm.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=xf(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Zm,`$1${n}`):!1!==t.jsonp&&(t.url+=`${(Lm.test(t.url)?"&":"?")+t.jsonp}=${n}`),t.converters["script json"]=function(){return o||Pf.error(`${n} was not called`),o[0]},t.dataTypes[0]="json",r=window[n],window[n]=function(){o=arguments},i.always((()=>{void 0===r?Pf(window).removeProp(n):window[n]=r,t[n]&&(t.jsonpCallback=e.jsonpCallback,Qm.push(n)),o&&xf(r)&&r(o[0]),o=r=void 0})),"script"})),Cf.createHTMLDocument=function(){const{body:t}=uf.implementation.createHTMLDocument("");return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),Pf.parseHTML=function(t,e,i){if("string"!=typeof t)return[];let n,r,o;return"boolean"==typeof e&&(i=e,e=!1),e||(Cf.createHTMLDocument?(n=(e=uf.implementation.createHTMLDocument("")).createElement("base"),n.href=uf.location.href,e.head.appendChild(n)):e=uf),r=Of.exec(t),o=!i&&[],r?[e.createElement(r[1])]:(r=Tg([t],e,o),o&&o.length&&Pf(o).remove(),Pf.merge([],r.childNodes))},Pf.fn.load=function(t,e,i){let n,r,o;const s=this,a=t.indexOf(" ");return a>-1&&(n=wm(t.slice(a)),t=t.slice(0,a)),xf(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),s.length>0&&Pf.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){o=arguments,s.html(n?Pf("<div>").append(Pf.parseHTML(t)).find(n):t)})).always(i&&((t,e)=>{s.each((function(){i.apply(this,o||[t.responseText,e,t])}))})),this},Pf.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],((t,e)=>{Pf.fn[e]=function(t){return this.on(e,t)}})),Pf.expr.pseudos.animated=function(t){return Pf.grep(Pf.timers,(e=>t===e.elem)).length},Pf.offset={setOffset(t,e,i){let n,r,o,s,a,l,u;const c=Pf.css(t,"position"),h=Pf(t),p={};"static"===c&&(t.style.position="relative"),a=h.offset(),o=Pf.css(t,"top"),l=Pf.css(t,"left"),u=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,u?(n=h.position(),s=n.top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),xf(e)&&(e=e.call(t,i,Pf.extend({},a))),null!=e.top&&(p.top=e.top-a.top+s),null!=e.left&&(p.left=e.left-a.left+r),"using"in e?e.using.call(t,p):h.css(p)}},Pf.fn.extend({offset(t){if(arguments.length)return void 0===t?this:this.each((function(e){Pf.offset.setOffset(this,t,e)}));let e,i;const n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}:void 0},position(){if(!this[0])return;let t,e,i;const n=this[0];let r={top:0,left:0};if("fixed"===Pf.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===Pf.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&(r=Pf(t).offset(),r.top+=Pf.css(t,"borderTopWidth",!0),r.left+=Pf.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-Pf.css(n,"marginTop",!0),left:e.left-r.left-Pf.css(n,"marginLeft",!0)}},offsetParent(){return this.map((function(){let{offsetParent:t}=this;for(;t&&"static"===Pf.css(t,"position");)t=t.offsetParent;return t||cg}))}}),Pf.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},((t,e)=>{const i="pageYOffset"===e;Pf.fn[t]=function(n){return $f(this,((t,n,r)=>{let o;if(wf(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[n];o?o.scrollTo(i?o.pageXOffset:r,i?r:o.pageYOffset):t[n]=r}),t,n,arguments.length)}})),Pf.each(["top","left"],((t,e)=>{Pf.cssHooks[e]=Jg(Cf.pixelPosition,((t,i)=>{if(i)return i=$g(t,e),qg.test(i)?`${Pf(t).position()[e]}px`:i}))})),Pf.each({Height:"height",Width:"width"},((t,e)=>{Pf.each({padding:`inner${t}`,content:e,"":`outer${t}`},((i,n)=>{Pf.fn[n]=function(r,o){const s=arguments.length&&(i||"boolean"!=typeof r),a=i||(!0===r||!0===o?"margin":"border");return $f(this,((e,i,r)=>{let o;return wf(e)?0===n.indexOf("outer")?e[`inner${t}`]:e.document.documentElement[`client${t}`]:9===e.nodeType?(o=e.documentElement,Math.max(e.body[`scroll${t}`],o[`scroll${t}`],e.body[`offset${t}`],o[`offset${t}`],o[`client${t}`])):void 0===r?Pf.css(e,i,a):Pf.style(e,i,r,a)}),e,s?r:void 0,s)}}))})),Pf.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),((t,e)=>{Pf.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}})),Pf.fn.extend({hover(t,e){return this.mouseenter(t).mouseleave(e||t)}}),Pf.fn.extend({bind(t,e,i){return this.on(t,null,e,i)},unbind(t,e){return this.off(t,null,e)},delegate(t,e,i,n){return this.on(e,t,i,n)},undelegate(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),Pf.proxy=function(t,e){let i,n,r;if("string"==typeof e&&(i=t[e],e=t,t=i),xf(t))return n=hf.call(arguments,2),r=function(){return t.apply(e||this,n.concat(hf.call(arguments)))},r.guid=t.guid=t.guid||Pf.guid++,r},Pf.holdReady=function(t){t?Pf.readyWait++:Pf.ready(!0)},Pf.isArray=Array.isArray,Pf.parseJSON=JSON.parse,Pf.nodeName=Rf,Pf.isFunction=xf,Pf.isWindow=wf,Pf.camelCase=Kf,Pf.type=Sf,Pf.now=Date.now,Pf.isNumeric=function(t){const e=Pf.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))};class Km{constructor(t={}){const{text:e,id:i,viewer:n}=t;i&&document.getElementById(i)&&!t.reduplicate&&Pf(`#${i}`).remove();const r=document.createElement("div");r.id=Fl(i,ql()),r.className="cursor-tip-class",r.innerHTML=e;const o=n?n.container:document.body;o.appendChild(r),this.ele=r,this._show=Fl(t.show,!0),this._isDestryoed=!1,this._target=o,this._id=r.id,this._text=e,this._position=void 0;const s=this;this.show=this._show,n instanceof Cesium.Viewer&&(this._handler=new Cesium.ScreenSpaceEventHandler(n.canvas),this._handler.setInputAction((t=>{s.updatePosition(t.endPosition)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE))}updatePosition(t){this.ele.style.left=`${t.x+10}px`,this.ele.style.top=`${t.y+10}px`}updateText(t){this.ele.innerHTML=t}destroy(){this._isDestryoed||(this._target.removeChild(this.ele),this._handler.isDestroyed()&&this._handler.destroy(),this._isDestryoed=!0)}get show(){return this._show}set show(t){this._show=t,this.ele.style.display=t?"block":"none"}get id(){return this._id}get text(){return this._text}set text(t){this._text=t,this.updateText(t)}get position(){return this._position}set position(t){t.x&&t.y?(this._position=t,this.updatePosition(t)):console.warn("CursorTip:设置了一个无效的位置，将被忽略.")}}function t_(t,e){let i;const n={"y+":e.getFullYear().toString(),"m+":(e.getMonth()+1).toString(),"d+":e.getDate().toString(),"H+":e.getHours().toString(),"M+":e.getMinutes().toString(),"S+":e.getSeconds().toString()},r=Object.keys(n);for(const e of r)i=new RegExp(`(${e})`).exec(t),i&&(t=t.replace(i[1],1===i[1].length?n[e]:n[e].padStart(i[1].length,"0")));return t}window.Date.prototype.format=function(t){t_(t,this)};const{Ellipsoid:e_}=Cesium;e_.CGCS2000=Object.freeze(new e_(6378137,6378137,6356752.314140356));const{GeographicTilingScheme:i_,GeographicProjection:n_,Rectangle:r_,Math:o_}=Cesium;class s_ extends i_{constructor(t={}){super(t),this._tileInfo=t.tileInfo,this._ellipsoid=Fl(t.ellipsoid,e_.CGCS2000),this._rectangle=Fl(t.rectangle,r_.fromDegrees(-180,-90,180,90)),this._numberOfLevelZeroTilesX=Fl(t.numberOfLevelZeroTilesX,4),this._numberOfLevelZeroTilesY=Fl(t.numberOfLevelZeroTilesY,2),this._projection=new n_(this._ellipsoid)}getNumberOfXTilesAtLevel(t){if(kl(this._tileInfo)){var e=this._tileInfo.lods.filter((function(e){return e.level===t}))[0].resolution;return Math.round(o_.toDegrees(2*o_.TWO_PI)/(this._tileInfo.rows*e))}return super.getNumberOfXTilesAtLevel(t)}getNumberOfYTilesAtLevel(t){if(kl(this._tileInfo)){var e=this._tileInfo.lods.filter((function(e){return e.level===t}))[0].resolution;return Math.round(o_.toDegrees(2*o_.TWO_PI)/(this._tileInfo.cols*e))}return super.getNumberOfYTilesAtLevel(t)}}class a_{constructor(t){this._options=Fl(t,{}),this._id=Fl(t.id,of()),this._primitive=null,this._oldPrimitive=null,this._definedChanged=new jl,this._loadEvent=new jl,this._clampToGround=Fl(!!t.clampToGround,!1),this._show=Fl(t.show,!0),this._removed=!1,this._allowPicking=Fl(t.allowPicking,!0),this._property=t.property}get id(){return this._id}get property(){return this._property}get allowPicking(){return this._allowPicking}set allowPicking(t){!!t!==this._allowPicking&&(this.definedChanged.raise("allowPicking",t,this._allowPicking),this._allowPicking=t,this.updatePrimitive&&this.updatePrimitive())}get clampToGround(){return this._clampToGround}set clampToGround(t){t!==this._clampToGround&&(this.definedChanged.raise("clampToGround",t,this._clampToGround),this._clampToGround=t,this.updatePrimitive())}get show(){return this._show}set show(t){t!==this._show&&(this.definedChanged.raise("show",t,this._show),this._show=t,this.primitive&&(this.primitive.show=t))}get primitive(){return this._primitive}get definedChanged(){return this._definedChanged}get readyPromise(){return this.primitive?this.primitive.readyPromise:new Primise}get material(){if(this.primitive)return this.primitive.appearance.material}toJson(){if(kl(this.primitive))return JSON.parse(JSON.stringify(this._options))}update(){}updateAttribute(t,e){if(this.isDestroyed())return;if(!this.primitive)return;const i=this.primitive.appearance.material;if(!i)return;const n=i.uniforms;n&&(n[t]=e)}addTo(t){kl(this.primitive)&&t.graphicGroup.add(this)}zoomTo(){}remove(){if(kl(this.primitive))return this.group?(this.group.remove(this),this):void 0}isDestroyed(){return!1}destroy(){this.remove(),this.primitive&&!this.primitive.isDestroyed()&&(this.primitive.destroy(),this.primitive=void 0),Cesium.destroyObject(this)}}const{AssociativeArray:l_,PrimitiveCollection:u_}=Cesium;class c_{constructor(t){this.values=new l_,this.id=of(),this.viewer=t,this.root=new u_,this.root.name="graphicGroup",t.scene.primitives.add(this.root)}add(t){t instanceof c_&&(this.values.set(t.id,t),this.root.add(t.root)),t instanceof a_&&(this.values.set(t.id,t),t.primitive&&this.root.add(t.primitive),t._viewer=this.viewer,t.group=this,t._loadEvent.raise())}get(t){return this.values.get(t)}getById(t){return this.get(t)}remove(t){this.values.remove(t.id),t instanceof c_&&(t.clear(),this.root.remove(t.root)),t.primitive&&this.root.remove(t.primitive)}removeById(t){const e=this.values.get(t);this.remove(e)}has(t){return this.values.contains(t)}update(t){const e=this.values._array;for(let i of e)i.update(t)}clear(){const t=[...this.values._array];for(let e of t)e.destroy();this.root.removeAll(),this.values.removeAll()}}const h_="uniform samplerCube u_cubeMap;\n  varying vec3 v_texCoord;\n  void main()\n  {\n  vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n  gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n  }\n  ",p_="attribute vec3 position;\n  varying vec3 v_texCoord;\n  uniform mat3 u_rotateMatrix;\n  void main()\n  {\n  vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n  gl_Position = czm_projection * vec4(p, 1.0);\n  v_texCoord = position.xyz;\n  }\n  ",{defaultValue:d_,destroyObject:f_,Matrix4:g_,DrawCommand:m_,BoxGeometry:__,Cartesian3:y_,defined:v_,GeometryPipeline:C_,Transforms:x_,VertexFormat:w_,BufferUsage:b_,CubeMap:E_,loadCubeMap:S_,RenderState:T_,VertexArray:P_,BlendingState:A_,SceneMode:I_,ShaderProgram:L_,ShaderSource:N_,Matrix3:M_}=Cesium;Cesium;class D_ extends a_{constructor(t){if(t.el instanceof HTMLElement==!1)throw new Ol("options.el parameter is invalid.");super(t),this._clampToGround=void 0,this._asynchronous=void 0,this._distanceDisplayCondition=t.distanceDisplayCondition,this.createGraphic()}get clampToGround(){}set clampToGround(t){throw new Ol("HtmlPointGraphic is not support clampToGround.")}get asynchronous(){}set asynchronous(t){throw new Ol("HtmlPointGraphic is not support asynchronous.")}get color(){}set color(t){throw new Ol("HtmlPointGraphic is not support color.")}set show(t){this.el&&(this.display=t?"block":"none"),this._show=t}get distanceDisplayCondition(){return this._distanceDisplayCondition}set distanceDisplayCondition(t){this._distanceDisplayCondition=t}get position(){return this._position}set position(t){this._definedChanged.raise("position",t,this._position),this._position=t}createGraphic(){this.el=this._options.el,this.el.id=this._id,this.el.style.position="absolute",this._position=this._options.position,this.updatePrimitive()}updatePrimitive(){this._allowPicking?this.el.style.pointerEvents="auto":this.el.style.pointerEvents="none"}addTo(t){defined(this.primitive)&&t.htmlGraphicGroup.add(this)}remove(){if(this.group)return this.group.remove(this),this}zoomTo(){if(this._viewer)return this._viewer.flyTo(this.position)}updateStyle(t,e){this.el.style[t]=e}addClass(t){this.el.classList.add(t)}}const{Cartesian2:R_,Rectangle:O_,GeographicProjection:F_,Ellipsoid:k_}=Cesium,z_=Cesium.Math;function G_(t){t=Fl(t,Fl.EMPTY_OBJECT),this._ellipsoid=Fl(t.ellipsoid,k_.WGS84),this._rectangle=Fl(t.rectangle,O_.MAX_VALUE),this._projection=new F_(this._ellipsoid),this._numberOfLevelZeroTilesX=36,this._numberOfLevelZeroTilesY=18,this._intervalOfZeorLevel=Fl(t.intervalOfZeorLevel,16)}Object.defineProperties(G_.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),G_.prototype.getNumberOfXTilesAtLevel=function(t){return this._numberOfLevelZeroTilesX<<t},G_.prototype.modifyLevel=function(t){return t<3?0:t<6?1:void 0},G_.prototype.getDelatXY=function(t){const e=this._intervalOfZeorLevel;return{dx:e/2**t,dy:e/2**t}},G_.prototype.getLonLatValue=function(t,e,i){const n=this.getDelatXY(t);return{lon:n.dx*e-180,lat:90-n.dy*i}},G_.prototype.getPosition=function(t,e,i){const n=this._rectangle,r=this.getNumberOfXTilesAtLevel(t),o=this.getNumberOfYTilesAtLevel(t),s=n.width/r,a=e*s+n.west;n.west;const l=n.height/o,u=n.north-i*l;return n.north,{lon:+z_.toDegrees(a).toFixed(5),lat:+z_.toDegrees(u).toFixed(5)}},G_.prototype.getNumberOfYTilesAtLevel=function(t){return this._numberOfLevelZeroTilesY<<t},G_.prototype.rectangleToNativeRectangle=function(t,e){const i=z_.toDegrees(t.west),n=z_.toDegrees(t.south),r=z_.toDegrees(t.east),o=z_.toDegrees(t.north);return kl(e)?(e.west=i,e.south=n,e.east=r,e.north=o,e):new O_(i,n,r,o)},G_.prototype.tileXYToNativeRectangle=function(t,e,i,n){const r=this.tileXYToRectangle(t,e,i,n);return r.west=z_.toDegrees(r.west),r.south=z_.toDegrees(r.south),r.east=z_.toDegrees(r.east),r.north=z_.toDegrees(r.north),r},G_.prototype.tileXYToRectangle=function(t,e,i,n){var r=this._rectangle,o=this.getNumberOfXTilesAtLevel(i),s=this.getNumberOfYTilesAtLevel(i),a=r.width/o,l=t*a+r.west,u=(t+1)*a+r.west,c=r.height/s,h=r.north-e*c,p=r.north-(e+1)*c;return kl(n)||(n=new O_(l,p,u,h)),n.west=l,n.south=p,n.east=u,n.north=h,n},G_.prototype.positionToTileXY=function(t,e,i){var n=this._rectangle;if(O_.contains(n,t)){var r=this.getNumberOfXTilesAtLevel(e),o=this.getNumberOfYTilesAtLevel(e),s=n.width/r,a=n.height/o,l=t.longitude;n.east<n.west&&(l+=z_.TWO_PI);var u=(l-n.west)/s|0;u>=r&&(u=r-1);var c=(n.north-t.latitude)/a|0;return c>=o&&(c=o-1),kl(i)?(i.x=u,i.y=c,i):new R_(u,c)}};const{CesiumTerrainProvider:B_,TerrainProvider:U_,Resource:V_,CustomDataSource:H_,Cartesian3:W_,Entity:j_,Color:q_,Rectangle:Y_}=Cesium;function X_(t){let e=[];const i=[t.bounds.west,t.bounds.south,t.bounds.east,t.bounds.north];return"EPSG:4326"===t.projection.toUpperCase()&&(e=[i[0],i[1],i[0],i[3],i[2],i[3],i[2],i[1],i[0],i[1]]),new j_({polyline:{positions:W_.fromRadiansArray(e),material:q_.fromRandom({alpha:1}),width:3,clampToGround:!0}})}function $_(t,e){const i=V_.createIfNeeded(e);i.appendForwardSlash();return i.getDerivedResource({url:"layer.json"}).fetchJson().then((e=>{t.projection=e.projection,t.bounds=Y_.fromDegrees(...e.valid_bounds)}))}function J_(t,e,i=!0){let n;e.scene.globe.ellipsoid;const r=e.camera.getPickRay(t);n=e.scene.globe.pick(r,e.scene);return e.scene.pick(t)&&e.scene.globe.depthTestAgainstTerrain&&(e.scene.pickPositionSupported?n=e.scene.pickPosition(t)||n:console.warn("This browser does not support pickPosition.")),n}const Q_=52.35987755982988,Z_=3.141592653589793,K_=6378245,ty=.006693421622965943;function ey(t,e){let i=function(t,e){let i=300+(t=+t)+2*(e=+e)+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return i+=2*(20*Math.sin(6*t*Z_)+20*Math.sin(2*t*Z_))/3,i+=2*(20*Math.sin(t*Z_)+40*Math.sin(t/3*Z_))/3,i+=2*(150*Math.sin(t/12*Z_)+300*Math.sin(t/30*Z_))/3,i}(t-105,e-35),n=function(t,e){let i=2*(t=+t)-100+3*(e=+e)+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return i+=2*(20*Math.sin(6*t*Z_)+20*Math.sin(2*t*Z_))/3,i+=2*(20*Math.sin(e*Z_)+40*Math.sin(e/3*Z_))/3,i+=2*(160*Math.sin(e/12*Z_)+320*Math.sin(e*Z_/30))/3,i}(t-105,e-35);const r=e/180*Z_;let o=Math.sin(r);o=1-ty*o*o;const s=Math.sqrt(o);return i=180*i/(K_/s*Math.cos(r)*Z_),n=180*n/(K_*(1-ty)/(o*s)*Z_),[i,n]}const iy={};function ny(t,e=!1){const i=`_${t}`;return{configurable:e,get(){return this[i]},set(e){const n=this[i];e!==n&&(this[i]=e,this._definitionChanged.raise(t,e,n))}}}iy.get=function(t="EPSG:3857",e){const i=t.toUpperCase();if("EPSG:3857"===i)return new Cesium.WebMercatorTilingScheme(e);if("EPSG:4326"===i)return new Cesium.GeographicTilingScheme(e);throw new Ol("未知的坐标系.")},iy.BD09ToGCJ02=function(t,e){const i=+t-.0065,n=+e-.006,r=Math.sqrt(i*i+n*n)-2e-5*Math.sin(n*Q_),o=Math.atan2(n,i)-3e-6*Math.cos(i*Q_);return[r*Math.cos(o),r*Math.sin(o)]},iy.GCJ02ToBD09=function(t,e){e=+e,t=+t;const i=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*Q_),n=Math.atan2(e,t)+3e-6*Math.cos(t*Q_);return[i*Math.cos(n)+.0065,i*Math.sin(n)+.006]},iy.WGS84ToGCJ02=function(t,e){if(e=+e,t=+t,zl.inChina(t,e)){const i=ey(t,e);return[t+i[0],e+i[1]]}return[t,e]},iy.GCJ02ToWGS84=function(t,e){if(e=+e,t=+t,zl.inChina(t,e)){const i=ey(t,e);return[2*t-(t+i[0]),2*e-(e+i[1])]}return[t,e]};class ry{constructor(t={}){this._definitionChange=new jl,this._propertyNames=[];for(const e in t)t.hasOwnProperty(e)&&(this[`_${e}`]=t[e],this._propertyNames.push(e),Object.defineProperty(this,e,ny(e)))}get propertyNames(){return this._propertyNames}addProperty(t,e){if(!kl(t))throw new Ol("key is reqiured.");if(this.propertyNames.includes(t))throw new Ol(`${t}has be a registered property.`);this[`_${t}`]=e,this._propertyNames.push(t),Object.defineProperty(this,t,ny(t))}removeProperty(t){if(!kl(t))throw new Ol("key is reqiured.");if(this.propertyNames.includes(t)){delete this[t],delete this[`_${t}`];const e=this.propertyNames.indexOf(t);this.propertyNames.slice(e,1),this.definitionChanged.raise(t)}}toString(){const t=this.toJson();return JSON.stringify(t)}toJson(){const t={};for(const e of this.propertyNames)t[e]=this[e];return t}hasProperty(t){if(!kl(t))throw new Ol("key is reqiured.");return this.propertyNames.includes(t)}get definitionChanged(){return this._definitionChanged}destroy(){this._definitionChanged=void 0,this._propertyNames=void 0}}function oy(t,e=!0){Hl(t),t.scene.screenSpaceCameraController.enableRotate=e}const{Color:sy}=Cesium;class ay{constructor(){}static pointColor=sy.AQUA;static fillColor=sy.AQUA;static strokeColor=sy.AQUA}const ly=Object.freeze({LEFT:-1,RIGHT:1,NONE:0,TOP:-10,BOTTOM:10}),uy="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nvarying float v_polylineAngle;\n\nconst float maskLength = 16.0;\n\nmat2 rotate(float rad) {\n    float c = cos(rad);\n    float s = sin(rad);\n    return mat2(\n        c, s,\n        -s, c\n    );\n}\n\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\n    float slope = (p0.y - p1.y) / (p0.x - p1.x);\n    return slope * (x - p0.x) + p0.y;\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n#ifdef GL_OES_standard_derivatives\n    float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;\n#else\n    float base = 0.975; // 2.5% of the line will be the arrow head\n#endif\n    // 没有箭头\n    base = 1.0;\n\n    vec2 center = vec2(1.0, 0.5);\n    float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\n    float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\n\n    float halfWidth = 0.15;\n    float s = step(0.5 - halfWidth, st.t);\n    s *= 1.0 - step(0.5 + halfWidth, st.t);\n    s *= 1.0 - step(base, st.s);\n\n    float t = step(base, materialInput.st.s);\n    t *= 1.0 - step(ptOnUpperLine, st.t);\n    t *= step(ptOnLowerLine, st.t);\n\n    // Find the distance from the closest separator (region between two colors)\n    float dist;\n    if (st.s < base)\n    {\n        float d1 = abs(st.t - (0.5 - halfWidth));\n        float d2 = abs(st.t - (0.5 + halfWidth));\n        dist = min(d1, d2);\n    }\n    else\n    {\n        float d1 = czm_infinity;\n        if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n        {\n            d1 = abs(st.s - base);\n        }\n        float d2 = abs(st.t - ptOnUpperLine);\n        float d3 = abs(st.t - ptOnLowerLine);\n        dist = min(min(d1, d2), d3);\n    }\n\n    vec4 outsideColor = vec4(0.0);\n    vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\n    vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\n    // dash\n    vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\n    // Get the relative position within the dash from 0 to 1\n    float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));\n    // Figure out the mask index.\n    float maskIndex = floor(dashPosition * maskLength);\n    // Test the bit mask.\n    float maskTest = floor(dashPattern / pow(2.0, maskIndex));\n    vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\n    if (fragColor.a < 0.005) {   // matches 0/255 and 1/255\n        discard;\n    }\n    outColor *= fragColor;\n    outColor = czm_gammaCorrect(outColor);\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n    return material;\n}\n",{Transforms:cy,Cartesian3:hy}=Cesium;let py=class{constructor(t={}){if(!kl(t.modelMatrix)&&kl(t.position)){let e;t.position instanceof hy?e=t.position:t.position instanceof zl&&(e=t.position.toCartesian()),e&&(t.modelMatrix=cy.eastNorthUpToFixedFrame(e))}if(kl(t.gltf))this.delegate=new Cesium.Model(t);else{if(!kl(t.url))throw new Ol("one of parameters url or gltf must be provided.");this.delegate=Cesium.Model.fromGltf(t)}this._readyPromise=this.delegate._readyPromise,this._ready=this.delegate._ready}get ready(){return this._ready}get readyPromise(){return this._readyPromise}get activeAnimations(){return this.delegate.activeAnimations}set activeAnimations(t){this.delegate.activeAnimations=t}get allowPicking(){return this.delegate.allowPicking}get asynchronous(){return this.delegate.asynchronous}get backFaceCulling(){return this.delegate.backFaceCulling}get basePath(){return this.delegate.basePath}get boundingSphere(){return this.delegate.boundingSphere}get clippingPlanes(){return this.delegate.clippingPlanes}set clippingPlanes(t){this.delegate.clippingPlanes=t}get color(){return this.delegate.color}set color(t){this.delegate.color=t}get colorBlendMode(){return this.delegate.colorBlendMode}set colorBlendMode(t){this.delegate.colorBlendMode=t}get colorBlendAmount(){return this.delegate.colorBlendAmount}set colorBlendAmount(t){this.delegate.colorBlendAmount=t}get credit(){return this.delegate.credit}set credit(t){this.delegate.credit=t}get debugShowBoundingVolume(){return this.delegate.debugShowBoundingVolume}set debugShowBoundingVolume(t){this.delegate.debugShowBoundingVolume=t}get debugWireframe(){return this.delegate.debugWireframe}set debugWireframe(t){this.delegate.debugWireframe=t}get distanceDisplayCondition(){return this.delegate.distanceDisplayCondition}set distanceDisplayCondition(t){this.delegate.distanceDisplayCondition=t}get gltf(){return this.delegate.gltf}get id(){return this.delegate.id}set id(t){this.delegate.id=t}get maximumScale(){return this.delegate.maximumScale}set maximumScale(t){this.delegate.maximumScale=t}get minimumPixelSize(){return this.delegate.minimumPixelSize}set minimumPixelSize(t){this.delegate.minimumPixelSize=t}get modelMatrix(){return this.delegate.modelMatrix}set modelMatrix(t){this.delegate.modelMatrix=t}get scale(){return this.delegate.scale}set scale(t){this.delegate.scale=t}get shadows(){return this.delegate.shadows}set shadows(t){this.delegate.shadows=t}get show(){return this.delegate.show}set show(t){this.delegate.show=t}get showOutline(){return this.delegate.showOutline}get silhouetteColor(){return this.delegate.silhouetteColor}set silhouetteColor(t){this.delegate.silhouetteColor=t}get silhouetteSize(){return this.delegate.silhouetteSize}set silhouetteSize(t){this.delegate.silhouetteSize=t}static silhouetteSupported(t){return Cesium.Model.silhouetteSupported(t.scene)}destroy(){this.delegate.destroy()}isDestroyed(){this.delegate.isDestroyed()}getMaterial(t){return this.delegate.getMaterial(t)}getMesh(t){return this.delegate.getMesh(t)}getNode(t){return this.delegate.getNode(t)}get sceneGraph(){return this.delegate.sceneGraph}get rootNodes(){if(this.delegate._runtime)return this.delegate._runtime.rootNodes;return this.sceneGraph._rootNodes.map((t=>this.nodes[t]))}get nodes(){return this.nodesByName}get materials(){return this.delegate._runtime?this.delegate._runtime.materialsByName:[]}get meshs(){return this.delegate._runtime?this.delegate._runtime.meshesByName:[]}get nodesByName(){return this.delegate._nodesByName||this.delegate_runtime}};const{PrimitiveCollection:dy,PolylineCollection:fy,Material:gy,Color:my,defaultValue:_y,Cartesian3:yy,Cartesian2:vy,Matrix4:Cy,Matrix3:xy,Quaternion:wy,PointPrimitiveCollection:by,ScreenSpaceEventHandler:Ey,ScreenSpaceEventType:Sy,Polyline:Ty,Primitive:Py,Math:Ay,Plane:Iy,Model:Ly,IntersectionTests:Ny,Transforms:My,PointPrimitive:Dy}=Cesium,Ry=new yy,Oy=new wy,Fy=new xy,ky=new yy;new yy;const zy=new Cy,Gy=new Cy;function By(t,e){t instanceof Ty?t.material.uniforms.color=e:t instanceof Py?t.appearance.material.uniforms.color=e:t instanceof Dy&&(t.color=e)}function Uy(t,e){const i=new yy,n=viewer.camera.getPickRay(t),r=new Iy(yy.UNIT_X,0);return Iy.fromPointNormal(e.center,e.activePrimitive.normal,r),Iy.transform(r,e._modelMatrix,r),Ny.rayPlane(n,r,i),Cy.multiplyByPoint(e._inverseModelMatrix,i,i),i}const Vy=new vy,Hy=new vy;function Wy(t,e,i,n){const r=t.activePrimitive.relativeAxis||[t.activePrimitive];if(!Array.isArray(r))return;const o=t._viewer.camera.positionCartographic.height/1047;for(let l of r){const r=l.positions.map((e=>Cy.multiplyByPoint(t._modelMatrix,e,new yy))).map((e=>zl.toPixel(e,t._viewer.scene))),u=(s=vy.subtract(...r,Vy),a=vy.subtract(i,e,Hy),vy.normalize(s,s),vy.dot(s,a));n[l.axis.toLowerCase()]=u*o}var s,a;return n}const jy="None",qy="T",Yy="R",Xy="S";class $y extends Cesium.UrlTemplateImageryProvider{constructor(t){"string"==typeof t&&(t={url:t}),t.getFeatureInfoFormats=Fl(t.getFeatureInfoFormats,$y.defaultFeatureInfoFormats),super(t)}get url(){return super.url}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get rectangle(){return super.rectangle}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return super.enablePickFeatures}set enablePickFeatures(t){super.enablePickFeatures=t}pickFeatures(t,e,i,n,r){return super.pickFeatures(t,e,i,n,r)}requestImage(t,e,i,n){return super.requestImage(t,e,i,n)}}function Jy(){return new $y({url:kd.buildModuleUrl("assets/tiles/{z}/{x}/{y}.png"),maximumLevel:4})}$y.defaultFeatureInfoFormats=Object.freeze([Object.freeze(new Cesium.GetFeatureInfoFormat("json","application/json")),Object.freeze(new Cesium.GetFeatureInfoFormat("xml","text/xml")),Object.freeze(new Cesium.GetFeatureInfoFormat("text","text/html"))]);const{defined:Qy,defaultValue:Zy,ColorMaterialProperty:Ky,ConstantPositionProperty:tv,ConstantProperty:ev,DataSource:iv,PolygonGraphics:nv,PolylineGraphics:rv,EntityCluster:ov,PinBuilder:sv,createGuid:av,Cartesian3:lv,PointGraphics:uv,ArcType:cv,PolygonHierarchy:hv,Color:pv,EntityCollection:dv,HeightReference:fv,Resource:gv,describe:mv,Event:_v}=Cesium,yv={small:24,medium:48,large:64},vv={},Cv={},xv={"urn:ogc:def:crs:OGC:1.3:CRS84":Uv,"EPSG:4326":Uv,"urn:ogc:def:crs:EPSG::4326":Uv},wv=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"],bv={Feature:Pv,FeatureCollection:function(t,e,i,n,r){for(var o=e.features,s=0,a=o.length;s<a;s++)Pv(t,o[s],void 0,n,r)},GeometryCollection:Av,LineString:Rv,MultiLineString:Ov,MultiPoint:Nv,MultiPolygon:zv,Point:Lv,Polygon:kv,Topology:Gv},Ev={GeometryCollection:Av,LineString:Rv,MultiLineString:Ov,MultiPoint:Nv,MultiPolygon:zv,Point:Lv,Polygon:kv,Topology:Gv};function Sv(t,e){for(var i=new Array(t.length),n=0;n<t.length;n++)i[n]=e(t[n]);return i}function Tv(t,e,i){var n=t.id;if(Qy(n)&&"Feature"===t.type){for(var r=2,o=n;Qy(e.getById(o));)o=n+"_"+r,r++;n=o}else n=av();var s=e.getOrCreateEntity(n),a=t.properties;if(Qy(a)){var l;s.properties=a;var u=a.title;if(Qy(u))s.name=u,l="title";else{var c=Number.MAX_VALUE;for(var h in a)if(a.hasOwnProperty(h)&&a[h]){var p=h.toLowerCase();if(c>1&&"title"===p){c=1,l=h;break}c>2&&"name"===p?(c=2,l=h):c>3&&/title/i.test(h)?(c=3,l=h):c>4&&/name/i.test(h)&&(c=4,l=h)}Qy(l)&&(s.name=a[l])}var d=a.description;null!==d&&(s.description=Qy(d)?new ev(d):i(a,l))}return s}function Pv(t,e,i,n,r){if(null!==e.geometry){if(!Qy(e.geometry))throw new Ol("feature.geometry is required.");var o=e.geometry.type,s=Ev[o];if(!Qy(s))throw new Ol("Unknown geometry type: "+o);s(t,e,e.geometry,n,r)}else Tv(e,t._entityCollection,r.describe)}function Av(t,e,i,n,r){for(var o=i.geometries,s=0,a=o.length;s<a;s++){var l=o[s],u=l.type,c=Ev[u];if(!Qy(c))throw new Ol("Unknown geometry type: "+u);c(t,e,l,n,r)}}function Iv(t,e,i,n,r){let o=r.pointSize,s=r.pointColor;const a=e.properties;if(Qy(a)){const t=a["point-color"];Qy(t)&&(s=pv.fromCssColorString(t)),o=Zy(yv[a["point-size"]],o)}const l=new uv;2===n.length&&r.clampToGround&&(l.heightReference=fv.CLAMP_TO_GROUND);const u=Tv(e,t._entityCollection,r.describe);u.point=l,u.point.color=s,u.point.pixelSize=o,u.position=new tv(i(n))}function Lv(t,e,i,n,r){Iv(t,e,n,i.coordinates,r)}function Nv(t,e,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)Iv(t,e,n,o[s],r)}function Mv(t,e,i,n,r){const o=r.lineColor,s=r.lineWidth,a=e.properties;if(Qy(a)){const t=a["stroke-width"];let e;Qy(t)&&(s=new ev(t));let i=a.stroke;Qy(i)&&(e=pv.fromCssColorString(i));let n=a["stroke-opacity"];Qy(n)&&1!==n&&(Qy(e)||(e=o.color.clone()),e.alpha=n),Qy(e)&&(o=new Ky(e))}const l=Tv(e,t._entityCollection,r.describe),u=new rv;l.polyline=u,u.clampToGround=r.clampToGround,u.material=o,u.width=s,u.positions=new ev(Sv(n,i)),u.arcType=cv.RHUMB}function Dv(t,e){var i="";for(var n in t)if(t.hasOwnProperty(n)){if(n===e||-1!==wv.indexOf(n))continue;var r=t[n];Qy(r)&&(i+="object"==typeof r?"<tr><th>"+n+"</th><td>"+Dv(r)+"</td></tr>":"<tr><th>"+n+"</th><td>"+r+"</td></tr>")}return i.length>0&&(i='<table class="cesium-infoBox-defaultTable"><tbody>'+i+"</tbody></table>"),i}function Rv(t,e,i,n,r){Mv(t,e,n,i.coordinates,r)}function Ov(t,e,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)Mv(t,e,n,o[s],r)}function Fv(t,e,i,n,r){if(r.outline){const o=Cesium.clone(r);return o.width=r.outlineWidth,o.lineColor=r.outlineColor,Mv(t,e,i,n[0],o)}if(!1===r.fill.getValue().color)return;if(0===n.length||0===n[0].length)return;let o=r.outlineColor.color,s=r.fill,a=r.outlineWidth;const l=e.properties;if(Qy(l)){const t=l["stroke-width"];let e;Qy(t)&&(a=new ev(t));const i=l.stroke;Qy(i)&&(e=pv.fromCssColorString(i));let n,u=l["stroke-opacity"];Qy(u)&&1!==u&&(Qy(e)||(e=r.outlineColor.color.clone()),e.alpha=u),Qy(e)&&(o=new ev(e));const c=l.fill;Qy(c)&&(n=pv.fromCssColorString(c),n.alpha=s.color.alpha),u=l["fill-opacity"],Qy(u)&&u!==s.color.alpha&&(Qy(n)||(n=s.color.clone()),n.alpha=u),Qy(n)&&(s=new Ky(n))}const u=new nv;u.outline=!1,u.outlineColor=o,u.outlineWidth=a,u.material=s,u.arcType=cv.RHUMB;const c=r.extrudedHeight;if(c)if("number"==typeof c)u.extrudedHeight=c;else if("string"==typeof c){const t=c.match(/\$\{\s*.*?\s*\}/gi);if(t){let e=c;for(let i of t){const t=/\$\{\s*(.*?)\s*\}/gi.exec(i);Qy(t)&&Qy(t[1])&&(e=e.replace(i,l[t[1]]))}try{const t=window.eval(e);"number"==typeof t&&(u.extrudedHeight=t)}catch(t){}}}const h=[];for(var p=1,d=n.length;p<d;p++)h.push(new hv(Sv(n[p],i)));const f=n[0];u.hierarchy=new ev(new hv(Sv(f,i),h)),f[0].length>2?u.perPositionHeight=new ev(!0):r.clampToGround||(u.height=0);Tv(e,t._entityCollection,r.describe).polygon=u}function kv(t,e,i,n,r){Fv(t,e,n,i.coordinates,r)}function zv(t,e,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)Fv(t,e,n,o[s],r)}function Gv(t,e,i,n,r){for(var o in i.objects)if(i.objects.hasOwnProperty(o)){var s=topojson.feature(i,i.objects[o]);(0,bv[s.type])(t,s,s,n,r)}}function Bv(t,e){return new Cesium.CallbackProperty(function(t,e,i){var n;return function(r,o){return Qy(n)||(n=t(e,i)),n}}(Dv,t,e),!0)}function Uv(t){return lv.fromDegrees(t[0],t[1],t[2])}class Vv{constructor(t){this._name=t,this._changed=new _v,this._error=new _v,this._isLoading=!1,this._loading=new _v,this._entityCollection=new dv(this),this._promises=[],this._pinBuilder=new sv,this._entityCluster=new ov,this._credit=void 0,this._resourceCredits=[]}static pointSize=5;static pointColor=pv.ROYALBLUE;static lineColor=pv.YELLOW;static fill=pv.fromBytes(255,255,0,100);static outline=!0;static outlineColor=pv.YELLOW;static lineWidth=2;static clampToGround=!1;static outlineWidth=1;static crsNames(){return xv}static crsLinkHrefs(){return vv}static crsLinkTypes(){return Cv}get entities(){return this._entityCollection}get name(){return this._name}set name(t){this._name!==t&&(this._name=t,this._changed.raiseEvent(this))}get clock(){}get isLoading(){return this._isLoading}get changedEvent(){return this._changed}get errorEvent(){return this._error}get loadingEvent(){return this._loading}get show(){return this._entityCollection.show}set show(t){this._entityCollection.show=t}get clustering(){return this._entityCluster}set clustering(t){this._entityCluster=t}get credit(){return this._credit}load(t,e){iv.setLoading(this,!0);let i=(e=Zy(e,{})).credit;"string"==typeof i&&(i=new Credit(i)),this._credit=i;let n=t,r=e.sourceUri;if("string"==typeof t||t instanceof gv){n=(t=gv.createIfNeeded(t)).fetchJson(),r=Zy(r,t.getUrlComponent());const e=this._resourceCredits,i=t.credits;if(Qy(i)){const t=i.length;for(const n=0;n<t;n++)e.push(i[n])}}e={describe:Zy(e.describe,Bv),pointSize:Zy(e.pointSize,Vv.pointSize),pointColor:Zy(e.pointColor,Vv.pointColor),lineWidth:new ev(Zy(e.lineWidth,Vv.lineWidth)),outlineColor:new Ky(Zy(e.outlineColor,Vv.outlineColor)),lineColor:new Ky(Zy(e.lineColor,Vv.lineColor)),outlineWidth:Zy(e.outlineWidth,Vv.outlineWidth),fill:new Ky(Zy(e.fill,Vv.fill)),outline:Zy(e.outline,Vv.outline),clampToGround:Zy(e.clampToGround,Vv.clampToGround),extrudedHeight:e.extrudedHeight};const o=this;return Promise.resolve(n).then((function(t){return function(t,e,i,n){let r;Qy(n)&&(r=Cesium.getFilenameFromUri(n)),Qy(r)&&t._name!==r&&(t._name=r,t._changed.raiseEvent(t));const o=bv[e.type];if(!Qy(o))throw new Ol("Unsupported GeoJSON object type: "+e.type);const s=e.crs;let a=null!==s?Uv:null;if(Qy(s)){if(!Qy(s.properties))throw new Ol("crs.properties is undefined.");const t=s.properties;if("name"===s.type){if(a=xv[t.name],!Qy(a))throw new Ol("Unknown crs name: "+t.name)}else if("link"===s.type){var l=vv[t.href];if(Qy(l)||(l=Cv[t.type]),!Qy(l))throw new Ol("Unable to resolve crs link: "+JSON.stringify(t));a=l(t)}else{if("EPSG"!==s.type)throw new Ol("Unknown crs type: "+s.type);if(a=xv["EPSG:"+t.code],!Qy(a))throw new Ol("Unknown crs EPSG code: "+t.code)}}return Promise.resolve(a).then((function(n){return t._entityCollection.removeAll(),null!==n&&o(t,e,e,n,i),Promise.all(t._promises).then((function(){return t._promises.length=0,iv.setLoading(t,!1),t}))}))}(o,t,e,r)})).catch((function(t){throw iv.setLoading(o,!1),o._error.raiseEvent(o,t),t}))}update(){return!0}}function Hv(t){return new Wv(t instanceof Uint8Array?t:new Uint8Array(t))}function Wv(t){this._array=t}function jv(t){return fetch(t).then((function(t){return t.body&&t.body.getReader?t.body.getReader():t.arrayBuffer().then(Hv)}))}function qv(t){return new Promise((function(e,i){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onload=function(){e(Hv(n.response))},n.onerror=i,n.ontimeout=i,n.open("GET",t,!0),n.send()}))}function Yv(t){return("function"==typeof fetch?jv:qv)(t)}function Xv(t){return"function"==typeof t.read?t:t.getReader()}Vv.load=function(t,e){return(new Vv).load(t,e)},Wv.prototype.read=function(){var t=this._array;return this._array=null,Promise.resolve(t?{done:!1,value:t}:{done:!0,value:void 0})},Wv.prototype.cancel=function(){return this._array=null,Promise.resolve()};var $v=new Uint8Array(0);function Jv(t,e){if(!t.length)return e;if(!e.length)return t;var i=new Uint8Array(t.length+e.length);return i.set(t),i.set(e,t.length),i}function Qv(t){return"function"==typeof t.slice?t:new Zv("function"==typeof t.read?t:t.getReader())}function Zv(t){this._source=t,this._array=$v,this._index=0}function Kv(t){return!(t=t.trim())||isNaN(t=+t)?null:t}Zv.prototype.read=function(){var t=this,e=t._array.subarray(t._index);return t._source.read().then((function(i){return t._array=$v,t._index=0,i.done?e.length>0?{done:!1,value:e}:{done:!0,value:void 0}:{done:!1,value:Jv(e,i.value)}}))},Zv.prototype.slice=function(t){if((t|=0)<0)throw new Error("invalid length");var e=this,i=this._array.length-this._index;if(this._index+t<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=t));var n=new Uint8Array(t);return n.set(this._array.subarray(this._index)),function r(){return e._source.read().then((function(o){return o.done?(e._array=$v,e._index=0,i>0?n.subarray(0,i):null):i+o.value.length>=t?(e._array=o.value,e._index=t-i,n.set(o.value.subarray(0,t-i),i),n):(n.set(o.value,i),i+=o.value.length,r())}))}()},Zv.prototype.cancel=function(){return this._source.cancel()};var tC={B:Kv,C:function(t){return t.trim()||null},D:function(t){return new Date(+t.substring(0,4),t.substring(4,6)-1,+t.substring(6,8))},F:Kv,L:function(t){return!/^[nf]$/i.test(t)&&(!!/^[yt]$/i.test(t)||null)},M:Kv,N:Kv};function eC(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function iC(t,e){return(t=Qv(t)).slice(32).then((function(i){var n=eC(i);return t.slice(n.getUint16(8,!0)-32).then((function(i){return new nC(t,e,n,eC(i))}))}))}function nC(t,e,i,n){this._source=t,this._decode=e.decode.bind(e),this._recordLength=i.getUint16(10,!0),this._fields=[];for(var r=0;13!==n.getUint8(r);r+=32){for(var o=0;o<11&&0!==n.getUint8(r+o);++o);this._fields.push({name:this._decode(new Uint8Array(n.buffer,n.byteOffset+r,o)),type:String.fromCharCode(n.getUint8(r+11)),length:n.getUint8(r+16)})}}var rC=nC.prototype;function oC(t){var e,i=40,n=t.getInt32(36,!0),r=new Array(n);for(e=0;e<n;++e,i+=16)r[e]=[t.getFloat64(i,!0),t.getFloat64(i+8,!0)];return{type:"MultiPoint",coordinates:r}}function sC(t){return{type:"Point",coordinates:[t.getFloat64(4,!0),t.getFloat64(12,!0)]}}function aC(t){var e,i=44,n=t.getInt32(36,!0),r=t.getInt32(40,!0),o=new Array(n),s=new Array(r),a=[],l=[];for(e=0;e<n;++e,i+=4)o[e]=t.getInt32(i,!0);for(e=0;e<r;++e,i+=16)s[e]=[t.getFloat64(i,!0),t.getFloat64(i+8,!0)];return o.forEach((function(t,e){var i=s.slice(t,o[e+1]);!function(t){if((e=t.length)<4)return!1;var e,i=0,n=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];for(;++i<e;)n+=t[i-1][1]*t[i][0]-t[i-1][0]*t[i][1];return n>=0}(i)?l.push(i):a.push([i])})),l.forEach((function(t){a.some((function(e){if(function(t,e){var i,n=-1,r=e.length;for(;++n<r;)if(i=lC(t,e[n]))return i>0;return!1}(e[0],t))return e.push(t),!0}))||a.push([t])})),1===a.length?{type:"Polygon",coordinates:a[0]}:{type:"MultiPolygon",coordinates:a}}function lC(t,e){for(var i=e[0],n=e[1],r=-1,o=0,s=t.length,a=s-1;o<s;a=o++){var l=t[o],u=l[0],c=l[1],h=t[a],p=h[0],d=h[1];if(uC(l,h,e))return 0;c>n!=d>n&&i<(p-u)*(n-c)/(d-c)+u&&(r=-r)}return r}function uC(t,e,i){var n=i[0]-t[0],r=i[1]-t[1];if(0===n&&0===r)return!0;var o=e[0]-t[0],s=e[1]-t[1];if(0===o&&0===s)return!1;var a=(n*o+r*s)/(o*o+s*s);return!(a<0||a>1)&&(0===a||1===a||a*o===n&&a*s===r)}function cC(t){var e,i=44,n=t.getInt32(36,!0),r=t.getInt32(40,!0),o=new Array(n),s=new Array(r);for(e=0;e<n;++e,i+=4)o[e]=t.getInt32(i,!0);for(e=0;e<r;++e,i+=16)s[e]=[t.getFloat64(i,!0),t.getFloat64(i+8,!0)];return 1===n?{type:"LineString",coordinates:s}:{type:"MultiLineString",coordinates:o.map((function(t,e){return s.slice(t,o[e+1])}))}}function hC(t,e){var i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i}rC.read=function(){var t=this,e=1;return t._source.slice(t._recordLength).then((function(i){return i&&26!==i[0]?{done:!1,value:t._fields.reduce((function(n,r){return n[r.name]=tC[r.type](t._decode(i.subarray(e,e+=r.length))),n}),{})}:{done:!0,value:void 0}}))},rC.cancel=function(){return this._source.cancel()};var pC={0:function(){return null},1:sC,3:cC,5:aC,8:oC,11:sC,13:cC,15:aC,18:oC,21:sC,23:cC,25:aC,28:oC};function dC(t,e){var i=e.getInt32(32,!0);if(!(i in pC))throw new Error("unsupported shape type: "+i);this._source=t,this._type=i,this._index=0,this._parse=pC[i],this.bbox=[e.getFloat64(36,!0),e.getFloat64(44,!0),e.getFloat64(52,!0),e.getFloat64(60,!0)]}var fC=dC.prototype;function gC(){}function mC(t,e,i){return Promise.all([(n=t,(n=Qv(n)).slice(100).then((function(t){return new dC(n,eC(t))}))),e&&iC(e,i)]).then((function(t){return new _C(t[0],t[1])}));var n}function _C(t,e){this._shp=t,this._dbf=e,this.bbox=t.bbox}fC.read=function(){var t=this;return++t._index,t._source.slice(12).then((function(e){if(null==e)return{done:!0,value:void 0};var i=eC(e);function n(){return t._source.slice(4).then((function(o){return null==o?{done:!0,value:void 0}:(i=eC(e=hC(e.slice(4),o))).getInt32(0,!1)!==t._index?n():r()}))}function r(){var r=2*i.getInt32(4,!1)-4,o=i.getInt32(8,!0);return r<0||o&&o!==t._type?n():t._source.slice(r).then((function(i){return{done:!1,value:o?t._parse(eC(hC(e.slice(8),i))):null}}))}return r()}))},fC.cancel=function(){return this._source.cancel()};var yC=_C.prototype;function vC(t,e,i){return"string"==typeof e?(/\.dbf$/.test(e)||(e+=".dbf"),e=Yv(e)):e instanceof ArrayBuffer||e instanceof Uint8Array?e=Hv(e):null!=e&&(e=Xv(e)),"string"==typeof t?(/\.shp$/.test(t)||(t+=".shp"),void 0===e&&(e=Yv(t.substring(0,t.length-4)+".dbf").catch((function(){}))),t=Yv(t)):t=t instanceof ArrayBuffer||t instanceof Uint8Array?Hv(t):Xv(t),Promise.all([t,e]).then((function(t){var e=t[0],n=t[1],r="windows-1252";return i&&null!=i.encoding&&(r=i.encoding),mC(e,n,n&&new TextDecoder(r))}))}yC.read=function(){var t=this;return Promise.all([t._dbf?t._dbf.read():{value:{}},t._shp.read()]).then((function(t){var e=t[0],i=t[1];return i.done?i:{done:!1,value:{type:"Feature",properties:e.value,geometry:i.value}}}))},yC.cancel=function(){return Promise.all([this._dbf&&this._dbf.cancel(),this._shp.cancel()]).then(gC)};const{defined:CC,defaultValue:xC,ColorMaterialProperty:wC,ConstantPositionProperty:bC,ConstantProperty:EC,DataSource:SC,PolygonGraphics:TC,PolylineGraphics:PC,createGuid:AC,Cartesian3:IC,PointGraphics:LC,ArcType:NC,PolygonHierarchy:MC,Color:DC,HeightReference:RC,Resource:OC}=Cesium,FC={small:24,medium:48,large:64},kC={},zC={},GC={"urn:ogc:def:crs:OGC:1.3:CRS84":ox,"EPSG:4326":ox,"urn:ogc:def:crs:EPSG::4326":ox},BC={Feature:WC,FeatureCollection:function(t,e,i,n,r){for(var o=e.features,s=0,a=o.length;s<a;s++)WC(t,o[s],void 0,n,r)},GeometryCollection:jC,LineString:JC,MultiLineString:QC,MultiPoint:XC,MultiPolygon:tx,Point:YC,Polygon:KC,Topology:ex},UC={GeometryCollection:jC,LineString:JC,MultiLineString:QC,MultiPoint:XC,MultiPolygon:tx,Point:YC,Polygon:KC,Topology:ex};function VC(t,e){for(var i=new Array(t.length),n=0;n<t.length;n++)i[n]=e(t[n]);return i}function HC(t,e,i){var n=t.id;if(CC(n)&&"Feature"===t.type){for(var r=2,o=n;CC(e.getById(o));)o=n+"_"+r,r++;n=o}else n=AC();var s=e.getOrCreateEntity(n),a=t.properties;if(CC(a)){var l;s.properties=a;var u=a.title;if(CC(u))s.name=u,l="title";else{var c=Number.MAX_VALUE;for(var h in a)if(a.hasOwnProperty(h)&&a[h]){var p=h.toLowerCase();if(c>1&&"title"===p){c=1,l=h;break}c>2&&"name"===p?(c=2,l=h):c>3&&/title/i.test(h)?(c=3,l=h):c>4&&/name/i.test(h)&&(c=4,l=h)}CC(l)&&(s.name=a[l])}var d=a.description;null!==d&&(s.description=CC(d)?new EC(d):i(a,l))}return s}function WC(t,e,i,n,r){if(null!==e.geometry){if(!CC(e.geometry))throw new Ol("feature.geometry is required.");var o=e.geometry.type,s=UC[o];if(!CC(s))throw new Ol("Unknown geometry type: "+o);s(t,e,e.geometry,n,r)}else HC(e,t._entityCollection,r.describe)}function jC(t,e,i,n,r){for(var o=i.geometries,s=0,a=o.length;s<a;s++){var l=o[s],u=l.type,c=UC[u];if(!CC(c))throw new Ol("Unknown geometry type: "+u);c(t,e,l,n,r)}}function qC(t,e,i,n,r){let o=r.pointSize,s=r.pointColor;const a=e.properties;if(CC(a)){const t=a["point-color"];CC(t)&&(s=DC.fromCssColorString(t)),o=xC(FC[a["point-size"]],o)}const l=new LC;2===n.length&&r.clampToGround&&(l.heightReference=RC.CLAMP_TO_GROUND);const u=HC(e,t._entityCollection,r.describe);u.point=l,u.point.color=s,u.point.pixelSize=o,u.position=new bC(i(n))}function YC(t,e,i,n,r){qC(t,e,n,i.coordinates,r)}function XC(t,e,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)qC(t,e,n,o[s],r)}function $C(t,e,i,n,r){const o=r.lineColor,s=r.lineWidth,a=e.properties;if(CC(a)){const t=a["stroke-width"];let e;CC(t)&&(s=new EC(t));let i=a.stroke;CC(i)&&(e=DC.fromCssColorString(i));let n=a["stroke-opacity"];CC(n)&&1!==n&&(CC(e)||(e=o.color.clone()),e.alpha=n),CC(e)&&(o=new wC(e))}const l=HC(e,t._entityCollection,r.describe),u=new PC;l.polyline=u,u.clampToGround=r.clampToGround,u.material=o,u.width=s,u.positions=new EC(VC(n,i)),u.arcType=NC.RHUMB}function JC(t,e,i,n,r){$C(t,e,n,i.coordinates,r)}function QC(t,e,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)$C(t,e,n,o[s],r)}function ZC(t,e,i,n,r){if(r.outline){const o=Cesium.clone(r);o.width=r.outlineWidth,o.lineColor=r.outlineColor;for(let r of n)$C(t,e,i,r,o)}if(!1===r.fill.getValue().color)return;if(0===n.length||0===n[0].length)return;let o=r.outlineColor.color,s=r.fill,a=r.outlineWidth;const l=e.properties;if(CC(l)){const t=l["stroke-width"];let e;CC(t)&&(a=new EC(t));const i=l.stroke;CC(i)&&(e=DC.fromCssColorString(i));let n,u=l["stroke-opacity"];CC(u)&&1!==u&&(CC(e)||(e=r.outlineColor.color.clone()),e.alpha=u),CC(e)&&(o=new EC(e));const c=l.fill;CC(c)&&(n=DC.fromCssColorString(c),n.alpha=s.color.alpha),u=l["fill-opacity"],CC(u)&&u!==s.color.alpha&&(CC(n)||(n=s.color.clone()),n.alpha=u),CC(n)&&(s=new wC(n))}const u=new TC;u.outline=!1,u.outlineColor=o,u.outlineWidth=a,u.material=s,u.arcType=NC.RHUMB;const c=r.extrudedHeight;if(c)if("number"==typeof c)u.extrudedHeight=c;else if("string"==typeof c){const t=c.match(/\$\{\s*.*?\s*\}/gi);if(t){let e=c;for(let i of t){const t=/\$\{\s*(.*?)\s*\}/gi.exec(i);CC(t)&&CC(t[1])&&(e=e.replace(i,l[t[1]]))}try{const t=window.eval(e);"number"==typeof t&&(u.extrudedHeight=t)}catch(t){}}}const h=[];for(var p=1,d=n.length;p<d;p++)h.push(new MC(VC(n[p],i)));const f=n[0];u.hierarchy=new EC(new MC(VC(f,i),h)),f[0].length>2?u.perPositionHeight=new EC(!0):r.clampToGround||(u.height=0);HC(e,t._entityCollection,r.describe).polygon=u}function KC(t,e,i,n,r){ZC(t,e,n,i.coordinates,r)}function tx(t,e,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)ZC(t,e,n,o[s],r)}function ex(t,e,i,n,r){for(var o in i.objects)if(i.objects.hasOwnProperty(o)){var s=topojson.feature(i,i.objects[o]);(0,BC[s.type])(t,s,s,n,r)}}function ix(t,e){var i="";for(var n in t)if(t.hasOwnProperty(n)){if(n===e||-1!==nx.indexOf(n))continue;var r=t[n];CC(r)&&(i+="object"==typeof r?"<tr><th>"+n+"</th><td>"+ix(r)+"</td></tr>":"<tr><th>"+n+"</th><td>"+r+"</td></tr>")}return i.length>0&&(i='<table class="cesium-infoBox-defaultTable"><tbody>'+i+"</tbody></table>"),i}const nx=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function rx(t,e){return new Cesium.CallbackProperty(function(t,e,i){var n;return function(r,o){return CC(n)||(n=t(e,i)),n}}(ix,t,e),!0)}function ox(t){return IC.fromDegrees(t[0],t[1],t[2])}function sx(t,e,i,n){let r;CC(n)&&(r=Cesium.getFilenameFromUri(n)),CC(r)&&t._name!==r&&(t._name=r,t._changed.raiseEvent(t));const o=BC[e.type];if(!CC(o))throw new Ol("Unsupported GeoJSON object type: "+e.type);const s=e.crs;let a=null!==s?ox:null;if(CC(s)){if(!CC(s.properties))throw new Ol("crs.properties is undefined.");const t=s.properties;if("name"===s.type){if(a=GC[t.name],!CC(a))throw new Ol("Unknown crs name: "+t.name)}else if("link"===s.type){var l=kC[t.href];if(CC(l)||(l=zC[t.type]),!CC(l))throw new Ol("Unable to resolve crs link: "+JSON.stringify(t));a=l(t)}else{if("EPSG"!==s.type)throw new Ol("Unknown crs type: "+s.type);if(a=GC["EPSG:"+t.code],!CC(a))throw new Ol("Unknown crs EPSG code: "+t.code)}}return Promise.resolve(a).then((function(n){return t._entityCollection.removeAll(),null!==n&&o(t,e,e,n,i),Promise.all(t._promises).then((function(){return t._promises.length=0,SC.setLoading(t,!1),t}))}))}class ax extends Vv{constructor(t){super(t),this._geoJson=void 0}get geoJson(){return this._geoJson}set geoJson(t){this._geoJson?this._geoJson.features.push(t):this._geoJson={type:"FeatureCollection",features:[t]}}static pointSize=5;static pointColor=DC.ROYALBLUE;static lineColor=DC.YELLOW;static fill=DC.fromBytes(255,255,0,100);static outline=!0;static outlineColor=DC.YELLOW;static lineWidth=2;static clampToGround=!1;static outlineWidth=1;static crsNames(){return GC}static crsLinkHrefs(){return kC}static crsLinkTypes(){return zC}load(t,e,i={encoding:"utf-8"}){let n=t;if(!CC(n))throw new Ol("shpfile is required.");Cesium.DataSource.setLoading(this,!0);const r=i.credit;"string"==typeof r&&(r=new Cesium.Credit(r)),this._credit=r;const o=this;let s=n,a=i.sourceUri;if("string"==typeof n||n instanceof OC){s=new Promise(((t,r)=>{vC(n,e,{encoding:i.encoding}).then((e=>e.read().then((function i(n){if(!n.done)return o.geoJson=n.value,e.read().then(i);t(o.geoJson)})))).catch((t=>r(t.stack)))})),a=xC(a,"");var l=this._resourceCredits,u=n.credits;if(CC(u))for(var c=u.length,h=0;h<c;h++)l.push(u[h])}return i={describe:xC(i.describe,rx),pointSize:xC(i.pointSize,ax.pointSize),pointColor:xC(i.pointColor,ax.pointColor),lineWidth:new EC(xC(i.lineWidth,ax.lineWidth)),outlineColor:new wC(xC(i.outlineColor,ax.outlineColor)),lineColor:new wC(xC(i.lineColor,ax.lineColor)),outlineWidth:xC(i.outlineWidth,ax.outlineWidth),fill:new wC(xC(i.fill,ax.fill)),outline:xC(i.outline,ax.outline),clampToGround:xC(i.clampToGround,ax.clampToGround),extrudedHeight:i.extrudedHeight},Promise.resolve(s).then((function(t){return sx(o,t,i,a)})).catch((function(t){throw SC.setLoading(o,!1),o._error.raiseEvent(o,t),t}))}loadArrayBuffer(t,e,i={encoding:"utf-8"}){let n=t;if(!CC(n))throw new Ol("shpfile is required.");Cesium.DataSource.setLoading(this,!0);const r=i.credit;"string"==typeof r&&(r=new Cesium.Credit(r)),this._credit=r;const o=this;let s=n,a=i.sourceUri;if(n instanceof ArrayBuffer){s=new Promise(((t,r)=>{vC(n,e,{encoding:i.encoding}).then((e=>e.read().then((function i(n){if(!n.done)return o.geoJson=n.value,e.read().then(i);t(o.geoJson)})))).catch((t=>r(t.stack)))})),a=xC(a,"");var l=this._resourceCredits,u=n.credits;if(CC(u))for(var c=u.length,h=0;h<c;h++)l.push(u[h])}return i={describe:xC(i.describe,rx),pointSize:xC(i.pointSize,ax.pointSize),pointColor:xC(i.pointColor,ax.pointColor),lineWidth:new EC(xC(i.lineWidth,ax.lineWidth)),outlineColor:new wC(xC(i.outlineColor,ax.outlineColor)),lineColor:new wC(xC(i.lineColor,ax.lineColor)),outlineWidth:xC(i.outlineWidth,ax.outlineWidth),fill:new wC(xC(i.fill,ax.fill)),outline:xC(i.outline,ax.outline),clampToGround:xC(i.clampToGround,ax.clampToGround),extrudedHeight:i.extrudedHeight},Promise.resolve(s).then((function(t){return sx(o,t,i,a)})).catch((function(t){throw SC.setLoading(o,!1),o._error.raiseEvent(o,t),t}))}}ax.load=function(t,e,i){return(new ax).load(t,e,i)},ax.loadArrayBuffer=function(t,e,i){return(new ax).loadArrayBuffer(t,e,i)};const{buildModuleUrl:lx,Color:ux,defined:cx,destroyObject:hx,knockout:px,getElement:dx,subscribeAndEvaluate:fx,InfoBoxViewModel:gx}=Cesium;class mx{constructor(t){t=dx(t);var e=document.createElement("div");e.className="cesium-infoBox",e.setAttribute("data-bind",'      css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),t.appendChild(e);var i=document.createElement("div");i.className="cesium-infoBox-title",i.setAttribute("data-bind","text: titleText"),e.appendChild(i);var n=document.createElement("button");n.type="button",n.className="cesium-infoBox-close",n.setAttribute("data-bind","      click: function () { closeClicked.raiseEvent(this); }"),n.innerHTML="&times;",e.appendChild(n);var r=document.createElement("iframe");r.className="cesium-infoBox-iframe",r.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),r.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),r.setAttribute("allowfullscreen",!0),e.appendChild(r);var o=new gx;px.applyBindings(o,e),this._container=t,this._element=e,this._frame=r,this._viewModel=o,this._descriptionSubscription=void 0;var s=this;r.addEventListener("load",(function(){var t=r.contentDocument,i=t.createElement("link");i.href=lx("Widgets/InfoBox/InfoBoxDescription.css"),i.rel="stylesheet",i.type="text/css";var n=t.createElement("div");n.className="cesium-infoBox-description",t.head.appendChild(i),t.body.appendChild(n),s._descriptionSubscription=fx(o,"description",(function(t){r.style.height="5px",n.innerHTML=t;var i=null,o=n.firstElementChild;if(null!==o&&1===n.childNodes.length){var s=window.getComputedStyle(o);if(null!==s){var a=s["background-color"],l=ux.fromCssColorString(a);cx(l)&&0!==l.alpha&&(i=s["background-color"])}}e.style["background-color"]=i;var u=n.getBoundingClientRect().height;r.style.height=u+"px"}))})),r.setAttribute("src","about:blank")}get container(){return this._container}get viewModel(){return this._viewModel}get frame(){return this._frame}isDestroyed(){return!1}destroy(){var t=this._container;return px.cleanNode(this._element),t.removeChild(this._element),cx(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),hx(this)}}function _x(t,e){const{center:i}=t.boundingSphere,n=zl.fromCartesian(i),r=Cesium.Cartesian3.fromDegrees(n.lon,n.lat,0),o=Cesium.Cartesian3.fromDegrees(n.lon,n.lat,e),s=Cesium.Cartesian3.subtract(o,r,new Cesium.Cartesian3);t.modelMatrix=Cesium.Matrix4.multiply(t.modelMatrix,Cesium.Matrix4.fromTranslation(s),t.modelMatrix)}class yx{constructor(t={},e={}){this._params={height:0,position:new Cesium.Cartesian3(0,0,0),rotation:0};let{transform:i,position:n,height:r,rotationZ:o,debug:s}=t;const a=new Cesium.Cesium3DTileset(t);a.readyPromise.then((t=>{if(viewer.scene.primitives.add(t),Cesium.defined(n)&&function(t,e,i,n){if(e)t.root.transform=e;else{const e=Cesium.Transforms.eastNorthUpToFixedFrame(i),r=Cesium.Matrix3.fromRotationZ(n);Cesium.Matrix4.multiplyByMatrix3(e,r,e),Cesium.Matrix4.multiply(t.root.transform,e,t.root.transform)}}(t,i,n,o),Cesium.defined(r)&&_x(t,r),s){let e=0,i=new Cesium.Cartesian3,n=0;parent.onkeypress=function(r){r.keyCode==="Q".charCodeAt()||r.keyCode==="q".charCodeAt()?e=1:r.keyCode==="E".charCodeAt()||r.keyCode==="e".charCodeAt()?e=-1:r.keyCode==="A".charCodeAt()||r.keyCode==="a".charCodeAt()?i=new Cesium.Cartesian3(-2,0,0):r.keyCode==="D".charCodeAt()||r.keyCode==="d".charCodeAt()?i=new Cesium.Cartesian3(2,0,0):r.keyCode==="W".charCodeAt()||r.keyCode==="w".charCodeAt()?i=new Cesium.Cartesian3(0,-2,0):r.keyCode==="S".charCodeAt()||r.keyCode==="s".charCodeAt()?i=new Cesium.Cartesian3(0,2,0):r.keyCode==="Z".charCodeAt()||r.keyCode==="z".charCodeAt()?n=-1:r.keyCode!=="X".charCodeAt()&&r.keyCode!=="x".charCodeAt()||(n=1),function(t,e){const i=new Cesium.Matrix4;Cesium.Matrix4.fromTranslation(e,i),Cesium.Matrix4.multiply(t.modelMatrix,i,t.modelMatrix)}(t,i),function(t,e){const i=Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(e));Cesium.Matrix4.multiplyByMatrix3(t.root.transform,i,t.root.transform)}(t,n),_x(t,e),n=0,i=new Cesium.Cartesian3,e=0}}})),this.delegate=a}get allTilesLoaded(){return this.delegate.allTilesLoaded}get readyPromise(){return this.delegate.readyPromise}get boundingSphere(){return this.delegate.boundingSphere}get colorBlendAmount(){return this.delegate.colorBlendAmount}set colorBlendAmount(t){this.delegate.colorBlendAmount=t}get colorBlendMode(){return this.delegate.colorBlendMode}set colorBlendMode(t){this.delegate.colorBlendMode=t}get style(){return this.delegate.style}set style(t){this.delegate.style=t}get customShader(){return this.delegate.customShader}set customShader(t){this.delegate.customShader=t}get debugColorizeTiles(){return this.delegate.debugColorizeTiles}set debugColorizeTiles(t){this.delegate.debugColorizeTiles=t}get debugFreezeFrame(){return this.delegate.debugFreezeFrame}set debugFreezeFrame(t){this.delegate.debugFreezeFrame=t}get debugShowBoundingVolume(){return this.delegate.debugShowBoundingVolume}set debugShowBoundingVolume(t){this.delegate.debugShowBoundingVolume=t}get debugShowContentBoundingVolume(){return this.delegate.debugShowContentBoundingVolume}set debugShowContentBoundingVolume(t){this.delegate.debugShowContentBoundingVolume=t}get debugShowGeometricError(){return this.delegate.debugShowGeometricError}set debugShowGeometricError(t){this.delegate.debugShowGeometricError=t}get debugShowMemoryUsage(){return this.delegate.debugShowMemoryUsage}set debugShowMemoryUsage(t){this.delegate.debugShowMemoryUsage=t}get debugShowRenderingStatistics(){return this.delegate.debugShowRenderingStatistics}set debugShowRenderingStatistics(t){this.delegate.debugShowRenderingStatistics=t}get debugShowUrl(){return this.delegate.debugShowUrl}set debugShowUrl(t){this.delegate.debugShowUrl=t}get debugWireframe(){return this.delegate.debugWireframe}set debugWireframe(t){this.delegate.debugWireframe=t}get dynamicScreenSpaceError(){return this.delegate.dynamicScreenSpaceError}set dynamicScreenSpaceError(t){this.delegate.dynamicScreenSpaceError=t}get dynamicScreenSpaceErrorFactor(){return this.delegate.dynamicScreenSpaceErrorFactor}set dynamicScreenSpaceErrorFactor(t){this.delegate.dynamicScreenSpaceErrorFactor=t}get extensions(){return this.delegate.extensions}get extras(){return this.delegate.extras}get dynamicScreenSpaceErrorDensity(){return this.delegate.dynamicScreenSpaceErrorDensity}set dynamicScreenSpaceErrorDensity(t){this.delegate.dynamicScreenSpaceErrorDensity=t}get foveatedScreenSpaceError(){return this.delegate.foveatedScreenSpaceError}set foveatedScreenSpaceError(t){this.delegate.foveatedScreenSpaceError=t}get foveatedConeSize(){return this.delegate.foveatedConeSize}set foveatedConeSize(t){this.delegate.foveatedConeSize=t}get foveatedInterpolationCallback(){return this.delegate.foveatedInterpolationCallback}set foveatedInterpolationCallback(t){this.delegate.foveatedInterpolationCallback=t}get foveatedMinimumScreenSpaceErrorRelaxation(){return this.delegate.foveatedMinimumScreenSpaceErrorRelaxation}set foveatedMinimumScreenSpaceErrorRelaxation(t){this.delegate.foveatedMinimumScreenSpaceErrorRelaxation=t}get foveatedTimeDelay(){return this.delegate.foveatedTimeDelay}set foveatedTimeDelay(t){this.delegate.foveatedTimeDelay=t}get imageBasedLightingFactor(){return this.delegate.imageBasedLightingFactor}set imageBasedLightingFactor(t){this.delegate.imageBasedLightingFactor=t}get immediateLoadDesiredLevelOfDetail(){return this.delegate.immediateLoadDesiredLevelOfDetail}set immediateLoadDesiredLevelOfDetail(t){this.delegate.immediateLoadDesiredLevelOfDetail=t}get initialTilesLoaded(){return this.delegate.initialTilesLoaded}get lightColor(){return this.delegate.lightColor}set lightColor(t){this.delegate.lightColor=t}get loadProgress(){return this.delegate.loadProgress}get loadSiblings(){return this.delegate.loadSiblings}get maximumMemoryUsage(){return this.delegate.maximumMemoryUsage}set maximumMemoryUsage(t){this.delegate.maximumMemoryUsage=t}get maximumScreenSpaceError(){return this.delegate.maximumScreenSpaceError}set maximumScreenSpaceError(t){this.delegate.maximumScreenSpaceError=t}get modelMatrix(){return this.delegate.modelMatrix}set modelMatrix(t){this.delegate.modelMatrix=t}get pointCloudShading(){return this.delegate.pointCloudShading}set pointCloudShading(t){this.delegate.pointCloudShading}get preferLeaves(){return this.delegate.preferLeaves}set preferLeaves(t){this.delegate.preferLeaves=t}get preloadFlightDestinations(){return this.delegate.preloadFlightDestinations}set preloadFlightDestinations(t){this.delegate.preloadFlightDestinations}get preloadWhenHidden(){return this.delegate.preloadWhenHidden}set preloadWhenHidden(t){this.delegate.preloadWhenHidden}get progressResolutionHeightFraction(){return this.delegate.progressResolutionHeightFraction}set progressResolutionHeightFraction(t){this.delegate.progressResolutionHeightFraction=t}get properties(){return this.delegate.properties}get resource(){return this.delegate.resource}get root(){return this.delegate.root}get shadows(){return this.delegate.shadows}set shadows(t){this.delegate.shadows=t}get showOutline(){return this.delegate.showOutline}get skipLevelOfDetail(){return this.delegate.skipLevelOfDetail}set skipLevelOfDetail(t){this.delegate.skipLevelOfDetail}get skipLevels(){return this.delegate.skipLevels}set skipLevels(t){this.delegate.skipLevels=t}get skipScreenSpaceErrorFactor(){return this.delegate.skipScreenSpaceErrorFactor}set skipScreenSpaceErrorFactor(t){this.delegate.skipScreenSpaceErrorFactor=t}get clippingPlanes(){return this.delegate.clippingPlanes}set clippingPlanes(t){this.delegate.clippingPlanes=t}get specularEnvironmentMaps(){return this.delegate.specularEnvironmentMaps}set specularEnvironmentMaps(t){this.delegate.specularEnvironmentMaps=t}get tileFailed(){return this.delegate.tileFailed}get tileLoad(){return this.delegate.tileLoad}set tileLoad(t){this.delegate.tileLoad=t}get tileUnload(){return this.delegate.tileUnload}set tileUnload(t){this.delegate.tileUnload=t}get tilesLoaded(){return this.delegate.tilesLoaded}get tileVisible(){return this.delegate.tileVisible}set tileVisible(t){this.delegate.tileVisible=t}get timeSinceLoad(){return this.delegate.timeSinceLoad}get totalMemoryUsageInBytes(){return this.delegate.totalMemoryUsageInBytes}get classificationType(){return this.delegate.classificationType}set classificationType(t){this.delegate.classificationType=t}get baseScreenSpaceError(){return this.delegate.baseScreenSpaceError}set baseScreenSpaceError(t){this.delegate.baseScreenSpaceError=t}destroy(){this.delegate.destroy()}hasExtension(t){return this.delegate.hasExtension(t)}isDestroyed(){return this.delegate.isDestroyed()}makeStyleDirty(){return this.delegate.makeStyleDirty()}trimLoadedTiles(){this.delegate.trimLoadedTiles()}static loadJson(t){return Cesium3DTileset.loadJson(t)}}class vx{constructor(t={}){this._id=Fl(t.id,of()),this._maxClusterLevel=Fl(t.maxClusterLevel,12),this._minLoadLevel=Fl(t.minLoadLevel,12),this._objects=void 0}get id(){return this._id}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(t){this._minLoadLevel=t}get objects(){return this._objects}set objects(t){this._objects=t}updateCluster(t){Ol.throwInstantiationError()}beginUpdate(t){Ol.throwInstantiationError()}endUpdate(t){Ol.throwInstantiationError()}initialize(t,e){Ol.throwInstantiationError()}createGeometry(t,e,i){Ol.throwInstantiationError()}removeGeometry(t,e){}removeAll(){Ol.throwInstantiationError()}isDestroyed(){return!1}destroy(){Ol.throwInstantiationError()}}const{AssociativeArray:Cx}=Cesium;class xx{constructor(){this._layers=new Cx}get layer(){return this._layers}get length(){return this._layers.length}get values(){return this._layers.values}get(t){return this._layers.get(t)}add(t){t instanceof vx&&this._layers.set(t.id,t)}has(t){return t instanceof vx?this._layers.contains(t):"string"==typeof t&&this._layers.contains(this.get(t))}remove(t){if(t instanceof vx)return t.destroy(),this._layers.remove(t.id);if("string"==typeof t){const e=this._layers.get(t);return e&&e.destroy(),this._layers.remove(t)}return!1}removeAll(){return this._layers.removeAll()}}const{GeographicTilingScheme:wx,GlobeSurfaceTileProvider:bx,Event:Ex,TerrainState:Sx,RequestType:Tx,Request:Px,Rectangle:Ax,QuadtreeTileLoadState:Ix,Visibility:Lx,AssociativeArray:Nx,Cartesian3:Mx,Cartographic:Dx,getTimestamp:Rx,RequestState:Ox}=Cesium;function Fx(t,e,i){let n=t.data;!function(){const e=new Px({throttle:!1,throttleByServer:!0,type:Tx.TERRAIN});n.request=e;const r=i.requestTileGeometry(t.x,t.y,t.level,e);kl(r)?(n.terrainState=Sx.RECEIVING,Promise.resolve(r).then((function(t){!function(t){n.terrainData=t,n.terrainState=Sx.RECEIVED,n.request=void 0}(t)})).catch((function(t){!function(t){if(n.request.state===Ox.CANCELLED)return n.terrainData=void 0,n.terrainState=Sx.UNLOADED,void(n.request=void 0);n.terrainState=Sx.FAILED,n.request=void 0}()}))):(n.terrainState=Sx.UNLOADED,n.request=void 0)}()}const kx={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function zx(t,e,i,n,r){const o=t.data;o.terrainState===Sx.UNLOADED&&Fx(t,0,i),o.terrainState===Sx.RECEIVED&&function(t,e,i,n,r,o){const s=i.tilingScheme,a=kx;a.tilingScheme=s,a.x=n,a.y=r,a.level=o,a.exaggeration=e.terrainExaggeration,a.exaggerationRelativeHeight=e.terrainExaggerationRelativeHeight,a.throttle=!0;const l=t.terrainData.createMesh(a);kl(l)&&(t.terrainState=Sx.TRANSFORMING,Promise.resolve(l).then((function(e){t.mesh=e,t.terrainState=Sx.TRANSFORMED})).catch((function(){t.terrainState=Sx.FAILED})))}(o,e,i,t.x,t.y,t.level),o.terrainState===Sx.TRANSFORMED&&(t.renderable=!0)}function Gx(t,e){const i=[];for(let n of t)kl(n)&&(kl(n.id)||(n.id=of()),kl(n)&&kl(n.position)&&(n.position instanceof Mx?n.cartesian=n.position:n.position instanceof Dx?(n.cartesian=Dx.toCartesian(n.position),n.catographic=n.position):n.position instanceof zl?(n.cartesian=n.position.toCartesian(),n.cartographic=n.position.toCartoGraphic()):n.cartesian=n.position,n.cartographic||(n.cartographic=Dx.fromCartesian(n.cartesian)),Ax.contains(e.rectangle,n.cartographic)&&i.push(n)));return i}class Bx{constructor(){this.boundingVolumeSourceTile=void 0,this.terrainState=Cesium.TerrainState.UNLOADED,this.mesh=void 0,this.terrainData=void 0,this.objects=void 0,this._geometryOfTile=new Nx,this._objectsOfTile=new Nx,this._needRenderObjects=new Nx}static processStateMachine(t,e,i,n,r){Bx.initialize(t,i),t.state===Ix.LOADING&&zx(t,e,i)}static initialize(t,e){let i=t.data;kl(i)||(i=t.data=new Bx),t.state===Ix.START&&(t.state=Ix.LOADING)}}function Ux(t,e,i,n,r){let o=i.data._geometryOfTile.get(e.id),s=t._hasRenderCached.get(e.id);s||(s={},t._hasRenderCached.set(e.id,s)),o||(o=[]);for(let t of r){if(s[t.id])return;const r=e.createGeometry(i,n,t);r&&(s[t.id]=!0,o.push({id:t.id,geometry:r}))}i.data._geometryOfTile.set(e.id,o)}function Vx(t,e,i,n,r){const o=t._hasRenderCached.get(e.id);for(let t of r){const{id:i,geometry:r}=t;e.removeGeometry(n,r),delete o[i]}i.data._geometryOfTile.remove(e.id)}class Hx{constructor(t={}){this._ready=!0,this._scene=t.scene,this._tilingSceheme=new wx,this._readyPromise=Promise.resolve(!0),this._errorEvent=new Ex,this._terrainProvider=t.terrainProvider,this._show=!0,this.cartographicLimitRectangle=Ax.clone(Ax.MAX_VALUE),this.tree=void 0,this._layers=new xx,this._lastTilesToRender=[],this._hasRenderCached=new Nx,this._tilesCahced=[]}get terrainProvider(){return this._terrainProvider}get show(){return this._show}set show(t){this._show=t}get ready(){return this._ready}get tilingScheme(){return this._tilingSceheme}get readyPromise(){return this._readyPromise}get quadtree(){return this._quadtree}set quadtree(t){kl(t)&&(this._quadtree=t)}initialize(t){for(let e of this._layers.values)e.initialize(t,this._scene)}beginUpdate(t){const e=this._layers.values;for(let i of e)i.beginUpdate(t);this._frameNumber++}showTileThisFrame(t,e){const i=t.data;if(!kl(i))return;this._tilesCahced.includes(t)||this._tilesCahced.push(t);const n=this._layers.values;Rx();for(let r of n){if(!kl(r.objects)||!Array.isArray(r.objects))continue;const n=r.id;if(i._geometryOfTile.get(n)&&!r._needReclass)return;let o=i._objectsOfTile.get(n);kl(o)&&!r._needReclass||(o=Gx(r.objects,t),i._objectsOfTile.set(n,o)),Ux(this,r,t,e,o)}}endUpdate(t){const e=this._quadtree;if(!e)return;const i=this._lastTilesToRender,n=e._tilesToRender,r=this._layers.values;for(let e of i)if(!n.includes(e))for(let i of r){const n=e.data._geometryOfTile.get(i.id)||[];Vx(this,i,e,t,n)}for(let e of r){e.endUpdate(t)&&n.forEach((i=>{const n=i.data._geometryOfTile.get(e.id)||[];Vx(this,e,i,t,n)}))}this._lastTilesToRender=[...n]}loadTile(t,e){if(!this.terrainProvider.ready)return;let i,n=!0;e.data&&(i=e.data.terrainState,n=e.data.boundingVolumeSourceTile!==e),Bx.processStateMachine(e,t,this.terrainProvider,this._layers,this.quadtree);const r=e.data;n&&i!==e.data.terrainState&&this.computeTileVisibility(e,t,this.quadtree.occluders)!==Lx.NONE&&r.boundingVolumeSourceTile===e&&Bx.processStateMachine(e,t,this.terrainProvider,this._layers,this.quadtree)}getLevelMaximumGeometricError(t){return this._terrainProvider.getLevelMaximumGeometricError(t)}canRefine(t){return bx.prototype.canRefine.call(this,t)}computeTileVisibility(t,e,i){return kl(t.data)||(t.data=new Bx),bx.prototype.computeTileVisibility.call(this,t,e,i)}computeDistanceToTile(t,e){return t.data||(t.data=new Bx),bx.prototype.computeDistanceToTile.call(this,t,e)}clearTile(t){const e=this._tilesCahced;for(let i of e)i.data._geometryOfTile.remove(t),i.data._objectsOfTile.remove(t);this._hasRenderCached.remove(t)}isDestroyed(){return!1}destroy(){this._removeEventListener();const t=this._layers.values;for(let e of t)e.destroy()}computeTileLoadPriority(t,e){return bx.prototype.computeTileLoadPriority(t,e)}_onLayerAdded(t,e){}_onLayerRemoved(t,e){}_onLayerShownOrHidden(t,e,i){i?this._onLayerAdded(t,e):this._onLayerRemoved(t,e)}}var Wx="uniform vec4 u_initialColor;\n\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_DAY_NIGHT_ALPHA\nuniform float u_dayTextureNightAlpha[TEXTURE_UNITS];\nuniform float u_dayTextureDayAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SPLIT\nuniform float czm_p_splitPosition;\nuniform float czm_p_drawingBufferHeight;\nuniform float czm_p_drawingBufferWidth;\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_IMAGERY_CUTOUT\nuniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_COLOR_TO_ALPHA\nuniform vec4 u_colorsToAlpha[TEXTURE_UNITS];\n#endif\n\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nuniform vec2 u_lightingFadeDistance;\n#endif\n\n#ifdef TILE_LIMIT_RECTANGLE\nuniform vec4 u_cartographicLimitRectangle;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nuniform vec2 u_nightFadeDistance;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\nuniform highp sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG) && defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\nuniform float u_minimumBrightness;\n#endif\n\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\nuniform vec4 u_fillHighlightColor;\n#endif\n\n#ifdef TRANSLUCENT\nuniform vec4 u_frontFaceAlphaByDistance;\nuniform vec4 u_backFaceAlphaByDistance;\nuniform vec4 u_translucencyRectangle;\n#endif\n\n#ifdef UNDERGROUND_COLOR\nuniform vec4 u_undergroundColor;\nuniform vec4 u_undergroundColorAlphaByDistance;\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\nuniform float u_lambertDiffuseMultiplier;\n#endif\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nvarying float v_height;\nvarying float v_slope;\nvarying float v_aspect;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nvarying float v_distance;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\nvarying vec3 v_atmosphereRayleighColor;\nvarying vec3 v_atmosphereMieColor;\nvarying float v_atmosphereOpacity;\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nfloat interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n    float startDistance = nearFarScalar.x;\n    float startValue = nearFarScalar.y;\n    float endDistance = nearFarScalar.z;\n    float endValue = nearFarScalar.w;\n    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n    return mix(startValue, endValue, t);\n}\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT) || defined(APPLY_MATERIAL)\nvec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)\n{\n    return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);\n}\n#endif\n\n#ifdef TRANSLUCENT\nbool inTranslucencyRectangle()\n{\n    return\n        v_textureCoordinates.x > u_translucencyRectangle.x &&\n        v_textureCoordinates.x < u_translucencyRectangle.z &&\n        v_textureCoordinates.y > u_translucencyRectangle.y &&\n        v_textureCoordinates.y < u_translucencyRectangle.w;\n}\n#endif\n\nvec4 sampleAndBlend(\n    vec4 previousColor,\n    sampler2D textureToSample,\n    vec2 tileTextureCoordinates,\n    vec4 textureCoordinateRectangle,\n    vec4 textureCoordinateTranslationAndScale,\n    float textureAlpha,\n    float textureNightAlpha,\n    float textureDayAlpha,\n    float textureBrightness,\n    float textureContrast,\n    float textureHue,\n    float textureSaturation,\n    float textureOneOverGamma,\n    float split,\n    vec4 colorToAlpha,\n    float nightBlend)\n{\n    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:\n    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||\n    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||\n    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||\n    //    tileTextureCoordinates.t > textureCoordinateRectangle.q\n    // In other words, the alpha is zero if the fragment is outside the rectangle\n    // covered by this texture.  Would an actual 'if' yield better performance?\n    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    textureAlpha *= mix(textureDayAlpha, textureNightAlpha, nightBlend);\n#endif\n\n    vec2 translation = textureCoordinateTranslationAndScale.xy;\n    vec2 scale = textureCoordinateTranslationAndScale.zw;\n    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;\n    vec4 value = texture2D(textureToSample, textureCoordinates);\n    vec3 color = value.rgb;\n    float alpha = value.a;\n\n#ifdef APPLY_COLOR_TO_ALPHA\n    vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);\n    colorDiff.r = max(max(colorDiff.r, colorDiff.g), colorDiff.b);\n    alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);\n#endif\n\n#if !defined(APPLY_GAMMA)\n    vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));\n    color = tempColor.rgb;\n    alpha = tempColor.a;\n#else\n    color = pow(color, vec3(textureOneOverGamma));\n#endif\n\n#ifdef APPLY_SPLIT\n    float splitPosition = czm_p_splitPosition * czm_p_drawingBufferWidth;\n    // 垂直分割 \n    if(split < -2.0 || split > 2.0) {\n        splitPosition = (1.0 - czm_p_splitPosition) * czm_p_drawingBufferHeight;\n    }\n    if(split < -2.0 && gl_FragCoord.y < splitPosition) {\n        alpha = 0.0;\n    }\n    else if (split > 2.0 && gl_FragCoord.y > splitPosition) {\n        alpha = 0.0;\n    }\n    // Split to the left\n    else if (split > -2.0 && split < 0.0 && gl_FragCoord.x > splitPosition) {\n       alpha = 0.0;\n    }\n    // Split to the right\n    else if (split < 2.0 && split > 0.0 && gl_FragCoord.x < splitPosition) {\n       alpha = 0.0;\n    }\n#endif\n\n#ifdef APPLY_BRIGHTNESS\n    color = mix(vec3(0.0), color, textureBrightness);\n#endif\n\n#ifdef APPLY_CONTRAST\n    color = mix(vec3(0.5), color, textureContrast);\n#endif\n\n#ifdef APPLY_HUE\n    color = czm_hue(color, textureHue);\n#endif\n\n#ifdef APPLY_SATURATION\n    color = czm_saturation(color, textureSaturation);\n#endif\n\n    float sourceAlpha = alpha * textureAlpha;\n    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\n    outAlpha += sign(outAlpha) - 1.0;\n\n    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\n\n    // When rendering imagery for a tile in multiple passes,\n    // some GPU/WebGL implementation combinations will not blend fragments in\n    // additional passes correctly if their computation includes an unmasked\n    // divide-by-zero operation,\n    // even if it's not in the output or if the output has alpha zero.\n    //\n    // For example, without sanitization for outAlpha,\n    // this renders without artifacts:\n    //   if (outAlpha == 0.0) { outColor = vec3(0.0); }\n    //\n    // but using czm_branchFreeTernary will cause portions of the tile that are\n    // alpha-zero in the additional pass to render as black instead of blending\n    // with the previous pass:\n    //   outColor = czm_branchFreeTernary(outAlpha == 0.0, vec3(0.0), outColor);\n    //\n    // So instead, sanitize against divide-by-zero,\n    // store this state on the sign of outAlpha, and correct on return.\n\n    return vec4(outColor, max(outAlpha, 0.0));\n}\n\nvec3 colorCorrect(vec3 rgb) {\n#ifdef COLOR_CORRECT\n    // Convert rgb color to hsb\n    vec3 hsb = czm_RGBToHSB(rgb);\n    // Perform hsb shift\n    hsb.x += u_hsbShift.x; // hue\n    hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n    hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n    // Convert shifted hsb back to rgb\n    rgb = czm_HSBToRGB(hsb);\n#endif\n    return rgb;\n}\n\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);\n\nconst float fExposure = 2.0;\n\nvec3 computeEllipsoidPosition()\n{\n    float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0), 1.0);\n    vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);\n    xy *= czm_viewport.zw * mpp * 0.5;\n\n    vec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n\n    vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);\n    return (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;\n}\n\nvoid main()\n{\n#ifdef TILE_LIMIT_RECTANGLE\n    if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||\n        v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)\n        {\n            discard;\n        }\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)\n    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates\n    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordiantes\n#endif\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    float nightBlend = 1.0 - clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0, 0.0, 1.0);\n#else\n    float nightBlend = 0.0;\n#endif\n\n    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0\n    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the\n    // fragments on the edges of tiles even though the vertex shader is outputting\n    // coordinates strictly in the 0-1 range.\n    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0), nightBlend);\n\n#ifdef SHOW_TILE_BOUNDARIES\n    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\n        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n    {\n        color = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\n    float cameraDist;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;\n    }\n    else if (czm_sceneMode == czm_sceneModeColumbusView)\n    {\n        cameraDist = -czm_view[3].z;\n    }\n    else\n    {\n        cameraDist = length(czm_view[3]);\n    }\n    float fadeOutDist = u_lightingFadeDistance.x;\n    float fadeInDist = u_lightingFadeDistance.y;\n    if (czm_sceneMode != czm_sceneMode3D) {\n        vec3 radii = czm_ellipsoidRadii;\n        float maxRadii = max(radii.x, max(radii.y, radii.z));\n        fadeOutDist -= maxRadii;\n        fadeInDist -= maxRadii;\n    }\n    float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#else\n    float fade = 0.0;\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\n    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\n    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\n    waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;\n\n    float mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\n\n    if (mask > 0.0)\n    {\n        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\n\n        vec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\n        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\n\n        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\n\n        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);\n    }\n#endif\n\n#ifdef APPLY_MATERIAL\n    czm_materialInput materialInput;\n    materialInput.st = v_textureCoordinates.st;\n    materialInput.normalEC = normalize(v_normalEC);\n    materialInput.positionToEyeEC = -v_positionEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalize(v_normalEC));     \n    materialInput.slope = v_slope;\n    materialInput.height = v_height;\n    materialInput.aspect = v_aspect;\n    czm_material material = czm_getMaterial(materialInput);\n    bool isIn = czm_p_inClipRegion((czm_model * vec4(v_positionMC, 1.0)).xyz); \n    if (isIn) {\n        czm_material material = czm_getMaterial(materialInput);\n        vec4 materialColor = vec4(material.diffuse, material.alpha);\n        color = alphaBlend(materialColor, color);\n    }\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalize(v_normalEC)) * u_lambertDiffuseMultiplier + 0.3, 0.0, 1.0);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\n    diffuseIntensity = mix(1.0, diffuseIntensity, fade);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#else\n    vec4 finalColor = color;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\n\n    if (clipDistance < clippingPlanesEdgeWidth)\n    {\n        finalColor = clippingPlanesEdgeColor;\n    }\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\n    finalColor = vec4(mix(finalColor.rgb, u_fillHighlightColor.rgb, u_fillHighlightColor.a), finalColor.a);\n#endif\n\n#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)\n    vec3 atmosphereLightDirection = czm_sunDirectionWC;\n#else\n    vec3 atmosphereLightDirection = czm_lightDirectionWC;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\n    if (!czm_backFacing())\n    {\n        bool dynamicLighting = false;\n        #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n            dynamicLighting = true;     \n        #endif\n\n        vec3 rayleighColor;\n        vec3 mieColor;\n        float opacity;\n\n        vec3 positionWC;\n        vec3 lightDirection;\n\n        // When the camera is far away (camera distance > nightFadeOutDistance), the scattering is computed in the fragment shader.\n        // Otherwise, the scattering is computed in the vertex shader.\n        #ifdef PER_FRAGMENT_GROUND_ATMOSPHERE\n            positionWC = computeEllipsoidPosition();\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            computeAtmosphereScattering(\n                positionWC,\n                lightDirection,\n                rayleighColor,\n                mieColor,\n                opacity\n            );\n        #else\n            positionWC = v_positionMC;\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            rayleighColor = v_atmosphereRayleighColor;\n            mieColor = v_atmosphereMieColor;\n            opacity = v_atmosphereOpacity;\n        #endif\n\n        rayleighColor = colorCorrect(rayleighColor);\n        mieColor = colorCorrect(mieColor);\n\n        vec4 groundAtmosphereColor = computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);\n\n        // Fog is applied to tiles selected for fog, close to the Earth.\n        #ifdef FOG\n            vec3 fogColor = groundAtmosphereColor.rgb;\n            \n            // If there is lighting, apply that to the fog.\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float darken = clamp(dot(normalize(czm_viewerPositionWC), atmosphereLightDirection), u_minimumBrightness, 1.0);\n                fogColor *= darken;                \n            #endif\n\n            #ifndef HDR\n                fogColor.rgb = czm_acesTonemapping(fogColor.rgb);\n                fogColor.rgb = czm_inverseGamma(fogColor.rgb);\n            #endif\n            \n            const float modifier = 0.15;\n            finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor.rgb, modifier), finalColor.a);\n\n        #else\n            // The transmittance is based on optical depth i.e. the length of segment of the ray inside the atmosphere.\n            // This value is larger near the \"circumference\", as it is further away from the camera. We use it to\n            // brighten up that area of the ground atmosphere.\n            const float transmittanceModifier = 0.5;\n            float transmittance = transmittanceModifier + clamp(1.0 - groundAtmosphereColor.a, 0.0, 1.0);\n\n            vec3 finalAtmosphereColor = finalColor.rgb + groundAtmosphereColor.rgb * transmittance;\n\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float fadeInDist = u_nightFadeDistance.x;\n                float fadeOutDist = u_nightFadeDistance.y;\n            \n                float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.05, 1.0);\n                float darken = clamp(dot(normalize(positionWC), atmosphereLightDirection), 0.0, 1.0);\n                vec3 darkenendGroundAtmosphereColor = mix(groundAtmosphereColor.rgb, finalAtmosphereColor.rgb, darken);\n\n                finalAtmosphereColor = mix(darkenendGroundAtmosphereColor, finalAtmosphereColor, sunlitAtmosphereIntensity);\n            #endif\n            \n            #ifndef HDR\n                finalAtmosphereColor.rgb = vec3(1.0) - exp(-fExposure * finalAtmosphereColor.rgb);\n            #else\n                finalAtmosphereColor.rgb = czm_saturation(finalAtmosphereColor.rgb, 1.6);\n            #endif\n            \n            finalColor.rgb = mix(finalColor.rgb, finalAtmosphereColor.rgb, fade);\n        #endif\n    }\n#endif\n\n#ifdef UNDERGROUND_COLOR\n    if (czm_backFacing())\n    {\n        float distanceFromEllipsoid = max(czm_eyeHeight, 0.0);\n        float distance = max(v_distance - distanceFromEllipsoid, 0.0);\n        float blendAmount = interpolateByDistance(u_undergroundColorAlphaByDistance, distance);\n        vec4 undergroundColor = vec4(u_undergroundColor.rgb, u_undergroundColor.a * blendAmount);\n        finalColor = alphaBlend(undergroundColor, finalColor);\n    }\n#endif\n\n#ifdef TRANSLUCENT\n    if (inTranslucencyRectangle())\n    {\n      vec4 alphaByDistance = gl_FrontFacing ? u_frontFaceAlphaByDistance : u_backFaceAlphaByDistance;\n      finalColor.a *= interpolateByDistance(alphaByDistance, v_distance);\n    }\n#endif\n    \n    gl_FragColor =  finalColor;\n}\n\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n\nfloat waveFade(float edge0, float edge1, float x)\n{\n    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return pow(1.0 - y, 5.0);\n}\n\nfloat linearFade(float edge0, float edge1, float x)\n{\n    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\n// Based on water rendering by Jonas Wagner:\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\n// low altitude wave settings\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\n\n// high altitude wave settings\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\n\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)\n{\n    vec3 positionToEyeEC = -positionEyeCoordinates;\n    float positionToEyeECLength = length(positionToEyeEC);\n\n    // The double normalize below works around a bug in Firefox on Android devices.\n    vec3 normalizedPositionToEyeEC = normalize(normalize(positionToEyeEC));\n\n    // Fade out the waves as the camera moves far from the surface.\n    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n\n#ifdef SHOW_OCEAN_WAVES\n    // high altitude waves\n    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\n    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\n    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\n\n    // low altitude waves\n    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;\n    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\n    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\n\n    // blend the 2 wave layers based on distance to surface\n    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\n    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\n    vec3 normalTangentSpace =\n        (highAltitudeFade * normalTangentSpaceHighAltitude) +\n        (lowAltitudeFade * normalTangentSpaceLowAltitude);\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // fade out the normal perturbation as we move farther from the water surface\n    normalTangentSpace.xy *= waveIntensity;\n    normalTangentSpace = normalize(normalTangentSpace);\n#else\n    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 normalEC = enuToEye * normalTangentSpace;\n\n    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\n\n    // Use diffuse light to highlight the waves\n    float diffuseIntensity = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * maskValue;\n    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);\n\n#ifdef SHOW_OCEAN_WAVES\n    // Where diffuse light is low or non-existent, use wave highlights based solely on\n    // the wave bumpiness and no particular light direction.\n    float tsPerturbationRatio = normalTangentSpace.z;\n    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\n    vec3 nonDiffuseHighlight = vec3(0.0);\n#endif\n\n    // Add specular highlights in 3D, and in all modes when zoomed in.\n    float specularIntensity = czm_getSpecular(czm_lightDirectionEC, normalizedPositionToEyeEC, normalEC, 10.0);\n    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\n    float specular = specularIntensity * surfaceReflectance;\n\n#ifdef HDR\n    specular *= 1.4;\n\n    float e = 0.2;\n    float d = 3.3;\n    float c = 1.7;\n\n    vec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));\n#else\n    vec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;\n#endif\n\n    return vec4(color, imageryColor.a);\n}\n\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n";const{BoundingSphere:jx,buildModuleUrl:qx,Cartesian3:Yx,Cartographic:Xx,Color:$x,defaultValue:Jx,defined:Qx,destroyObject:Zx,DeveloperError:Kx,Ellipsoid:tw,EllipsoidTerrainProvider:ew,Event:iw,IntersectionTests:nw,NearFarScalar:rw,Ray:ow,Rectangle:sw,Resource:aw,ShaderSource:lw,Texture:uw,when:cw,GlobeSurfaceShaderSet:hw,GlobeSurfaceTileProvider:pw,GlobeTranslucency:dw,ImageryLayerCollection:fw,QuadtreePrimitive:gw,SceneMode:mw,ShadowMode:_w}=Cesium,yw=Cesium._shadersGlobeVS,vw=Cesium._shadersAtmosphereCommon,Cw=Cesium._shadersGroundAtmosphere;function xw(t){t=Jx(t,tw.WGS84);const e=new ew({ellipsoid:t}),i=new fw;this._ellipsoid=t,this._imageryLayerCollection=i,this._from="cesiumpro-globe",this._surfaceShaderSet=new hw,this._material=void 0,this._surface=new gw({tileProvider:new pw({terrainProvider:e,imageryLayers:i,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=e,this._terrainProviderChanged=new iw,this._undergroundColor=$x.clone($x.BLACK),this._undergroundColorAlphaByDistance=new rw(t.maximumRadius/1e3,0,t.maximumRadius/5,1),this._translucency=new dw,ww(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new aw({url:qx("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.lambertDiffuseMultiplier=.9,this.dynamicAtmosphereLighting=!0,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!0,this.atmosphereLightIntensity=10,this.atmosphereRayleighCoefficient=new Yx(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new Yx(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=_w.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.showSkirts=!0,this.backFaceCulling=!0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0,this.clipRegion=new Td}function ww(t){const e=[],i=Qx(t._material)&&(t._material.shaderSource.match(/slope/)||t._material.shaderSource.match("normalEC")),n=[vw,Cw];!Qx(t._material)||i&&!t._terrainProvider.requestVertexNormals?t._surface._tileProvider.materialUniformMap=void 0:(n.push(t._material.shaderSource),e.push("APPLY_MATERIAL"),t._surface._tileProvider.materialUniformMap=t._material._uniforms),n.push(Wx),t._surfaceShaderSet.baseVertexShaderSource=new lw({sources:[vw,Cw,yw],defines:e}),t._surfaceShaderSet.baseFragmentShaderSource=new lw({sources:n,defines:e}),t._surfaceShaderSet.material=t._material}Object.defineProperties(xw.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return!Qx(this._surface)||this._surface.tileProvider.ready&&0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(t){this._surface.tileProvider.baseColor=t}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(t){this._surface.tileProvider.clippingPlanes=t}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(t){Qx(t)||(t=sw.clone(sw.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=t}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(t){this._oceanNormalMapResource.url=t,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(t){t!==this._terrainProvider&&(this._terrainProvider=t,this._terrainProviderChanged.raiseEvent(t),Qx(this._material)&&ww(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(t){this._material!==t&&(this._material=t,ww(this))}},undergroundColor:{get:function(){return this._undergroundColor},set:function(t){this._undergroundColor=$x.clone(t,this._undergroundColor)}},undergroundColorAlphaByDistance:{get:function(){return this._undergroundColorAlphaByDistance},set:function(t){this._undergroundColorAlphaByDistance=rw.clone(t,this._undergroundColorAlphaByDistance)}},translucency:{get:function(){return this._translucency}}});const bw=[],Ew={start:0,stop:0};xw.prototype.pickWorldCoordinates=function(t,e,i,n){i=Jx(i,!0);const r=e.mode,o=e.mapProjection,s=bw;s.length=0;const a=this._surface._tilesToRender;let l,u,c=a.length;for(u=0;u<c;++u){l=a[u];const e=l.data;if(!Qx(e))continue;let i=e.pickBoundingSphere;if(r!==mw.SCENE3D)e.pickBoundingSphere=i=jx.fromRectangleWithHeights2D(l.rectangle,o,e.tileBoundingRegion.minimumHeight,e.tileBoundingRegion.maximumHeight,i),Yx.fromElements(i.center.z,i.center.x,i.center.y,i.center);else{if(!Qx(e.renderedMesh))continue;jx.clone(e.tileBoundingRegion.boundingSphere,i)}const n=nw.raySphere(t,i,Ew);Qx(n)&&s.push(e)}var h;let p;for(s.sort((h=t.origin,function(t,e){return jx.distanceSquaredTo(t.pickBoundingSphere,h)-jx.distanceSquaredTo(e.pickBoundingSphere,h)})),c=s.length,u=0;u<c&&(p=s[u].pick(t,e.mode,e.mapProjection,i,n),!Qx(p));++u);return p};const Sw=new Xx;xw.prototype.pick=function(t,e,i){if(i=this.pickWorldCoordinates(t,e,!0,i),Qx(i)&&e.mode!==mw.SCENE3D){i=Yx.fromElements(i.y,i.z,i.x,i);const t=e.mapProjection.unproject(i,Sw);i=e.globe.ellipsoid.cartographicToCartesian(t,i)}return i};const Tw=new Yx,Pw=new Yx,Aw=new Xx,Iw=new ow;function Lw(t,e){return Qx(t)&&sw.contains(t.rectangle,e)?t:void 0}xw.prototype.getHeight=function(t){const e=this._surface._levelZeroTiles;if(!Qx(e))return;let i,n;const r=e.length;for(n=0;n<r&&(i=e[n],!sw.contains(i.rectangle,t));++n);if(n>=r)return;let o=i;for(;Qx(i);)i=Lw(i._southwestChild,t)||Lw(i._southeastChild,t)||Lw(i._northwestChild,t)||i._northeastChild,Qx(i)&&Qx(i.data)&&Qx(i.data.renderedMesh)&&(o=i);if(i=o,!Qx(i)||!Qx(i.data)||!Qx(i.data.renderedMesh))return;const s=this._surface._tileProvider.tilingScheme.projection,a=this._surface._tileProvider.tilingScheme.ellipsoid,l=Yx.fromRadians(t.longitude,t.latitude,0,a,Tw),u=Iw,c=a.geodeticSurfaceNormal(l,u.direction),h=a.getSurfaceNormalIntersectionWithZAxis(l,11500,u.origin);if(!Qx(h)){let t;Qx(i.data.tileBoundingRegion)&&(t=i.data.tileBoundingRegion.minimumHeight);const e=Math.min(Jx(t,0),-11500),n=Yx.multiplyByScalar(c,Math.abs(e)+1,Pw);Yx.subtract(l,n,u.origin)}const p=i.data.pick(u,void 0,s,!1,Pw);return Qx(p)?a.cartesianToCartographic(p,Aw).height:void 0},xw.prototype.update=function(t){this.show&&t.passes.render&&this._surface.update(t)},xw.prototype.beginFrame=function(t){const e=this._surface,i=e.tileProvider,n=this.terrainProvider,r=this.showWaterEffect&&n.ready&&n.hasWaterMask;if(r&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;const e=this._oceanNormalMapResource,i=e.url;if(Qx(i)){const n=this;e.fetchImage().then((function(e){i===n._oceanNormalMapResource.url&&(n._oceanNormalMap=n._oceanNormalMap&&n._oceanNormalMap.destroy(),n._oceanNormalMap=new uw({context:t.context,source:e}))}))}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}const o=t.passes,s=t.mode;o.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,e.maximumScreenSpaceError=this.maximumScreenSpaceError,e.tileCacheSize=this.tileCacheSize,e.loadingDescendantLimit=this.loadingDescendantLimit,e.preloadAncestors=this.preloadAncestors,e.preloadSiblings=this.preloadSiblings,i.terrainProvider=this.terrainProvider,i.lightingFadeOutDistance=this.lightingFadeOutDistance,i.lightingFadeInDistance=this.lightingFadeInDistance,i.nightFadeOutDistance=this.nightFadeOutDistance,i.nightFadeInDistance=this.nightFadeInDistance,i.zoomedOutOceanSpecularIntensity=s===mw.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,i.hasWaterMask=r,i.oceanNormalMap=this._oceanNormalMap,i.enableLighting=this.enableLighting,i.dynamicAtmosphereLighting=this.dynamicAtmosphereLighting,i.dynamicAtmosphereLightingFromSun=this.dynamicAtmosphereLightingFromSun,i.showGroundAtmosphere=this.showGroundAtmosphere,i.atmosphereLightIntensity=this.atmosphereLightIntensity,i.atmosphereRayleighCoefficient=this.atmosphereRayleighCoefficient,i.atmosphereMieCoefficient=this.atmosphereMieCoefficient,i.atmosphereRayleighScaleHeight=this.atmosphereRayleighScaleHeight,i.atmosphereMieScaleHeight=this.atmosphereMieScaleHeight,i.atmosphereMieAnisotropy=this.atmosphereMieAnisotropy,i.shadows=this.shadows,i.hueShift=this.atmosphereHueShift,i.saturationShift=this.atmosphereSaturationShift,i.brightnessShift=this.atmosphereBrightnessShift,i.fillHighlightColor=this.fillHighlightColor,i.showSkirts=this.showSkirts,i.backFaceCulling=this.backFaceCulling,i.undergroundColor=this._undergroundColor,i.undergroundColorAlphaByDistance=this._undergroundColorAlphaByDistance,i.lambertDiffuseMultiplier=this.lambertDiffuseMultiplier,e.beginFrame(t))},xw.prototype.render=function(t){this.show&&(Qx(this._material)&&this._material.update(t.context),this._surface.render(t))},xw.prototype.endFrame=function(t){this.show&&t.passes.render&&this._surface.endFrame(t)},xw.prototype.isDestroyed=function(){return!1},xw.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),Zx(this)};const{ShaderProgram:Nw,RuntimeError:Mw,createUniform:Dw,defined:Rw,createUniformArray:Ow,WebGLConstants:Fw}=Cesium;function kw(t){this._size=t.size,this._datatype=t.datatype,this.getValue=t.getValue}const zw=Cesium.AutomaticUniforms,Gw="[Cesium WebGL] ",Bw={...zw,czm_p_drawingBufferWidth:new kw({size:1,datatype:Fw.FLOAT,getValue:function(t){return t.frameState.context.drawingBufferWidth}}),czm_p_drawingBufferHeight:new kw({size:1,datatype:Fw.FLOAT,getValue:function(t){return t.frameState.context.drawingBufferHeight}}),czm_p_splitPosition:new kw({size:1,datatype:Fw.FLOAT,getValue:function(t){return t.frameState.splitPosition}})};function Uw(t){Rw(t._program)||Vw(t)}function Vw(t){var e=t._program,i=t._gl,n=function(t,e){var i=e._vertexShaderText,n=e._fragmentShaderText,r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,i),t.compileShader(r);var o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(o,n),t.compileShader(o);var s=t.createProgram();t.attachShader(s,r),t.attachShader(s,o),t.deleteShader(r),t.deleteShader(o);var a,l=e._attributeLocations;if(Rw(l))for(var u in l)l.hasOwnProperty(u)&&t.bindAttribLocation(s,l[u],u);if(t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS)){var c=e._debugShaders;if(!t.getShaderParameter(o,t.COMPILE_STATUS)){if(a=t.getShaderInfoLog(o),console.error(Gw+"Fragment shader compile log: "+a),Rw(c)){var h=c.getTranslatedShaderSource(o);""!==h?console.error(Gw+"Translated fragment shader source:\n"+h):console.error(Gw+"Fragment shader translation failed.")}throw t.deleteProgram(s),new Mw("Fragment shader failed to compile.  Compile log: "+a)}if(!t.getShaderParameter(r,t.COMPILE_STATUS)){if(a=t.getShaderInfoLog(r),console.error(Gw+"Vertex shader compile log: "+a),Rw(c)){var p=c.getTranslatedShaderSource(r);""!==p?console.error(Gw+"Translated vertex shader source:\n"+p):console.error(Gw+"Vertex shader translation failed.")}throw t.deleteProgram(s),new Mw("Vertex shader failed to compile.  Compile log: "+a)}throw a=t.getProgramInfoLog(s),console.error(Gw+"Shader program link log: "+a),Rw(c)&&(console.error(Gw+"Translated vertex shader source:\n"+c.getTranslatedShaderSource(r)),console.error(Gw+"Translated fragment shader source:\n"+c.getTranslatedShaderSource(o))),t.deleteProgram(s),new Mw("Program failed to link.  Link log: "+a)}var d=e._logShaderCompilation;return d&&(a=t.getShaderInfoLog(r),Rw(a)&&a.length>0&&console.log(Gw+"Vertex shader compile log: "+a)),d&&(a=t.getShaderInfoLog(o),Rw(a)&&a.length>0&&console.log(Gw+"Fragment shader compile log: "+a)),d&&(a=t.getProgramInfoLog(s),Rw(a)&&a.length>0&&console.log(Gw+"Shader program link log: "+a)),s}(i,t,t._debugShaders),r=i.getProgramParameter(n,i.ACTIVE_ATTRIBUTES),o=function(t,e){for(var i={},n=[],r=[],o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<o;++s){var a=t.getActiveUniform(e,s),l=-1!==a.name.indexOf("[0]",a.name.length-"[0]".length)?a.name.slice(0,a.name.length-3):a.name;if(0!==l.indexOf("gl_"))if(a.name.indexOf("[")<0){var u=t.getUniformLocation(e,l);if(null!==u){var c=Dw(t,a,l,u);i[l]=c,n.push(c),c._setSampler&&r.push(c)}}else{var h,p,d,f,g=l.indexOf("[");if(g>=0){if(h=i[l.slice(0,g)],!Rw(h))continue;(p=h._locations).length<=1&&(d=h.value,null!==(f=t.getUniformLocation(e,l))&&(p.push(f),d.push(t.getUniform(e,f))))}else{p=[];for(var m=0;m<a.size;++m)null!==(f=t.getUniformLocation(e,l+"["+m+"]"))&&p.push(f);h=Ow(t,a,l,p),i[l]=h,n.push(h),h._setSampler&&r.push(h)}}}return{uniformsByName:i,uniforms:n,samplerUniforms:r}}(i,n),s=function(t,e){var i=[],n=[];for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],s=r,a=t._duplicateUniformNames[s];Rw(a)&&(o.name=a,s=a);var l=Bw[s];Rw(l)?i.push({uniform:o,automaticUniform:l}):n.push(o)}return{automaticUniforms:i,manualUniforms:n}}(t,o.uniformsByName);t._program=n,t._numberOfVertexAttributes=r,t._vertexAttributes=function(t,e,i){for(var n={},r=0;r<i;++r){var o=t.getActiveAttrib(e,r),s=t.getAttribLocation(e,o.name);n[o.name]={name:o.name,type:o.type,index:s}}return n}(i,n,r),t._uniformsByName=o.uniformsByName,t._uniforms=o.uniforms,t._automaticUniforms=s.automaticUniforms,t._manualUniforms=s.manualUniforms,t.maximumTextureUnitIndex=function(t,e,i){t.useProgram(e);for(var n=0,r=i.length,o=0;o<r;++o)n=i[o]._setSampler(n);return t.useProgram(null),n}(i,n,o.samplerUniforms),e&&t._gl.deleteProgram(e),"undefined"!=typeof spector&&(t._program.__SPECTOR_rebuildProgram=function(e,i,n,r){var o=t._vertexShaderText,s=t._fragmentShaderText,a=/ ! = /g;t._vertexShaderText=e.replace(a," != "),t._fragmentShaderText=i.replace(a," != ");try{Vw(t),n(t._program)}catch(e){t._vertexShaderText=o,t._fragmentShaderText=s;var l=/(?:Compile|Link) error: ([^]*)/.exec(e.message);r(l?l[1]:e.message)}})}const Hw=Cesium.Scene,{JulianDate:Ww,defined:jw,RequestScheduler:qw,PerformanceDisplay:Yw,Cesium3DTilePassState:Xw,Cesium3DTilePass:$w,defaultValue:Jw,Color:Qw,BoundingRectangle:Zw,Pass:Kw,SunLight:tb,Cartesian3:eb}=Cesium,ib=new Xw({pass:$w.PRELOAD}),nb=new Xw({pass:$w.PRELOAD_FLIGHT}),rb=new Xw({pass:$w.REQUEST_RENDER_MODE_DEFER_CHECK});function ob(t,e){try{e(t)}catch(e){if(t._renderError.raiseEvent(t,e),t.rethrowRenderErrors)throw e}}function sb(t){t._jobScheduler.resetBudgets();var e=t._frameState;t.primitives.prePassesUpdate(e),jw(t.globe)&&t.globe.update(e),t._picking.update(),e.creditDisplay.update()}function ab(t){return t._picking.updateMostDetailedRayPicks(t)}function lb(t){var e=t._frameState;ib.camera=e.camera,ib.cullingVolume=e.cullingVolume,t.primitives.updateForPass(e,ib)}function ub(t){var e=t._frameState;e.camera.canPreloadFlight()&&(nb.camera=t.preloadFlightCamera,nb.cullingVolume=t.preloadFlightCullingVolume,t.primitives.updateForPass(e,nb))}const cb=new Xw({pass:$w.RENDER});function hb(t){t.primitives.updateForPass(t._frameState,rb)}function pb(t){var e=t._frameState;t.primitives.postPassesUpdate(e),qw.update()}function db(t){var e=t._frameState,i=t.context,n=i.uniformState,r=t._defaultView;t._view=r,t.updateFrameState(),e.passes.render=!0,e.passes.postProcess=t.postProcessStages.hasSelected,e.tilesetPassState=cb;var o=Jw(t.backgroundColor,Qw.BLACK);t._hdr&&((o=Qw.clone(o,scratchBackgroundColor)).red=Math.pow(o.red,t.gamma),o.green=Math.pow(o.green,t.gamma),o.blue=Math.pow(o.blue,t.gamma)),e.backgroundColor=o,t.fog.update(e),n.update(e);var s=t.shadowMap;jw(s)&&s.enabled&&(!jw(t.light)||t.light instanceof tb?eb.negate(n.sunDirectionWC,t._shadowMapCamera.direction):eb.clone(t.light.direction,t._shadowMapCamera.direction),e.shadowMaps.push(s)),t._computeCommandList.length=0,t._overlayCommandList.length=0;var a=r.viewport;a.x=0,a.y=0,a.width=i.drawingBufferWidth,a.height=i.drawingBufferHeight;var l=r.passState;l.framebuffer=void 0,l.blendingEnabled=void 0,l.scissorTest=void 0,l.viewport=Zw.clone(a,l.viewport),jw(t.globe)&&(t.globe.beginFrame(e),bp(),t._vectorTileQuadtree.beginFrame(e)),t.updateEnvironment(),t.updateAndExecuteCommands(l,o),t.globe&&t._vectorTileQuadtree.render(e),t.resolveFramebuffers(l),l.framebuffer=void 0,function(t,e){t.context.uniformState.updatePass(Kw.OVERLAY);for(var i=t.context,n=t._overlayCommandList,r=n.length,o=0;o<r;++o)n[o].execute(i,e)}(t,l),jw(t.globe)&&(t.globe.endFrame(e),t._vectorTileQuadtree.endFrame(e),t.globe&&t.globe.clipRegion.update(e),t.globe.tilesLoaded||(t._renderRequested=!0)),i.endFrame()}function fb(t){this._preUpdate.raiseEvent(this,t);var e=this._frameState;e.newFrame=!1,jw(t)||(t=Ww.now());var i=this._view.checkForCameraUpdates(this),n=!this.requestRenderMode||this._renderRequested||i||this._logDepthBufferDirty||this._hdrDirty||this.mode===SceneMode.MORPHING;if(!n&&jw(this.maximumRenderTimeChange)&&jw(this._lastRenderTime)){var r=Math.abs(Ww.secondsDifference(this._lastRenderTime,t));n=n||r>this.maximumRenderTimeChange}n&&(this._lastRenderTime=Ww.clone(t,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1,function(t,e,i){var n=t._frameState;n.frameNumber=e,n.time=Ww.clone(i,n.time)}(this,Cesium.Math.incrementWrap(e.frameNumber,15e6,1),t),e.newFrame=!0);ob(this,sb),this.primitives.show&&(ob(this,ab),ob(this,lb),ob(this,ub),n||ob(this,hb)),this._postUpdate.raiseEvent(this,t),n&&(this._preRender.raiseEvent(this,t),e.creditDisplay.beginFrame(),af(this),ob(this,db)),function(t,e){if(t.debugShowFramesPerSecond){if(!jw(t._performanceDisplay)){var i=document.createElement("div");i.className="cesium-performanceDisplay-defaultContainer",t._canvas.parentNode.appendChild(i);var n=new Yw({container:i});t._performanceDisplay=n,t._performanceContainer=i}t._performanceDisplay.throttled=t.requestRenderMode,t._performanceDisplay.update(e)}else jw(t._performanceDisplay)&&(t._performanceDisplay=t._performanceDisplay&&t._performanceDisplay.destroy(),t._performanceContainer.parentNode.removeChild(t._performanceContainer))}(this,n),ob(this,pb),function(t){for(var e=t._frameState.afterRender,i=0,n=e.length;i<n;++i)e[i](),t.requestRender();e.length=0}(this),n&&(this._postRender.raiseEvent(this,t),e.creditDisplay.endFrame())}function gb(){(class{static overrideRenderFunction(){Hw.prototype.render=fb}}).overrideRenderFunction()}const{UniformState:mb,SceneMode:_b}=Cesium;function yb(){mb.prototype.updateGlobeClipRegion=function(t){t?(this.clipRegionCount=t.count,this.clipBoundingRect=t.boundingRect,this.clipInverseLocalModel=t.inverseLocalModel,this.clipDepthTexture=t.depthTexture,this.clipNormal=t.normal,this.clipEnabled=t.enabled):this.clipRegionCount=0};const t=mb.prototype.update;mb.prototype.update=function(e){this.updateGlobeClipRegion(e.globeClipRegion),t.call(this,e)}}function vb(){gb(),yb()}const{Resource:Cb}=Cesium;class xb{constructor(t={}){if(this._url=t.url,this._typeName=t.typeName,this._style=t.style,!kl(this._url))throw new Ol("parameter url must be provided.");if(!kl(this._typeName))throw new Ol("parameter typeName must be provided.");const e=new Cb({url:t.url,queryParameters:{service:"WFS",version:"1.0.0",request:"GetFeature",typeName:t.typeName,maxFeatures:50,outputFormat:"application/json"}});this._dataSource=Vv.load(e,this._style)}get rectangle(){return this._rectangle||this.tilingScheme.rectangle}get tilingScheme(){return iy.get("EPSG:4326")}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get ready(){return this._ready}get readyPromise(){return this._readyPromise}}const{CustomDataSource:wb,Color:bb,HeightReference:Eb,HorizontalOrigin:Sb,VerticalOrigin:Tb,Cartesian3:Pb,Cartographic:Ab}=Cesium;function Ib(t){const e=t[0];return e instanceof zl?t.map((t=>t.toCartesian())):e instanceof Pb?t:e instanceof Ab?t.map((t=>Ab.toCartesian(t))):"number"==typeof e?Pb.fromDegreesArray(t):t}class Lb{constructor(t,e={}){this.viewer=t,this.pointStyle=Fl(e.point,{color:bb.RED,pixelSize:10,outlineColor:bb.WHITE,outlineWidth:4}),this.lineStyle=Fl(e.polyline,{width:5,material:bb.GOLD.withAlpha(.5),clampToGround:!0}),this.labelStyle=Fl(e.label,{fillColor:bb.WHITE,showBackground:!0,horizontalOrigin:Sb.LEFT,verticalOrigin:Tb.TOP,showBackground:!0,backgroundColor:bb.BLACK.withAlpha(.5),fillColor:bb.WHITE,font:"40px sans-serif",scale:.5}),this.polygonStyle=Fl(e.polygon,{material:bb.GOLD.withAlpha(.6)}),this.ds=new wb("cesiumpro-default"),t.dataSources.add(this.ds)}addPoint(t,e,i){const n=Object.assign({position:new zl(t,e,i).toCartesian()},{point:this.pointStyle});return this.ds.entities.add(n)}addLabel(t,e,i,n){const r=Object.assign({position:new zl(e,i,n).toCartesian()},{label:Object.assign({text:t},this.labelStyle)});return this.ds.entities.add(r)}addPolyline(t){const e=Object.assign({positions:Ib(t)},this.lineStyle);return this.ds.entities.add({polyline:e})}addPolygon(t,e,i={}){const n=Object.assign({hierarchy:Ib(t),height:e},this.polygonStyle,i);return this.ds.entities.add({polygon:n})}remove(t){this.entities.remove(t)}clear(){this.entities.removeAll()}destroy(){this.viewer.dataSources.remove(this.ds),this.ds.destroy()}}const{Matrix4:Nb,BoundingSphere:Mb,ScreenSpaceEventType:Db,ScreenSpaceEventHandler:Rb}=Cesium;function Ob(t,e,i){t.camera.flyToBoundingSphere(e,{duration:i.duration,maximumHeight:i.maximumHeight,endTransform:i.endTransform,offset:i.offset,complete:function(){t._completeZoom(!0)},cancel:function(){t._completeZoom(!0)},offset:i.offset})}let Fb,kb,zb=0,Gb=0,Bb="N/A",Ub="N/A";function Vb(t){return null!=t&&"object"==typeof t&&"function"==typeof t.then}function Hb(t,e,i,n){const r=Cesium.Cartesian3.fromDegrees(e,i,n),o=t.camera,s=o.heading,a=o.pitch,l=function(t,e,i){e=Cesium.Math.clamp(e,-Cesium.Math.PI_OVER_TWO,Cesium.Math.PI_OVER_TWO),t=Cesium.Math.zeroToTwoPi(t)-Cesium.Math.PI_OVER_TWO;const n=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,-e),r=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Z,-t),o=Cesium.Quaternion.multiply(r,n,r),s=Cesium.Matrix3.fromQuaternion(o),a=Cesium.Cartesian3.clone(Cesium.Cartesian3.UNIT_X);return Cesium.Matrix3.multiplyByVector(s,a,a),Cesium.Cartesian3.negate(a,a),Cesium.Cartesian3.multiplyByScalar(a,i,a),a}(s,a,2*n),u=Cesium.Transforms.eastNorthUpToFixedFrame(r);Cesium.Matrix4.multiplyByPoint(u,l,r),o.setView({destination:r,orientation:{heading:s,pitch:a},easingFunction:Cesium.EasingFunction.QUADRATIC_OUT})}function Wb(t,e){t.infoBox&&(e._infoBox=function(t){const e=document.createElement("div");e.className="cesium-viewer-infoBoxContainer",t.container.appendChild(e);const i=new mx(e),n=i.viewModel;return t._eventHelper.add(n.cameraClicked,qb.prototype._onInfoBoxCameraClicked,t),t._eventHelper.add(n.closeClicked,qb.prototype._onInfoBoxClockClicked,t),t._enableInfoOrSelection=!0,i}(e))}function jb(t,e,i){const n=t._zoomPromise=new Promise((e=>{t._completeZoom=function(t){e(t)}}));return e.readyPromise.then((()=>{if(e._boundingSpheres)Ob(t,Mb.fromBoundingSpheres(e._boundingSpheres),i);else if(e.boundingSphere){let n=e.boundingSphere;n=Mb.clone(n),Ob(t,n,i)}})),n}class qb extends Cesium.Viewer{constructor(t,e={}){vb(),e=Object.assign({animation:!1,timeline:!1,geocoder:!1,homeButton:!1,navigationHelpButton:!1,baseLayerPicker:!1,fullscreenElement:"cesiumContainer",fullscreenButton:!1,shouldAnimate:!0,infoBox:!1,selectionIndicator:!1,sceneModePicker:!1,shadows:!1,imageryProvider:Jy()},e),Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Cesium.Rectangle.fromDegrees(70,5,130,60),!1===e.globe&&(e.imageryProvider=void 0);const i=Object.assign({},e,{infoBox:!1});i.globe?i.globe=new xw(i.globe._ellipsoid):!1!==i.globe&&(i.globe=new xw),super(t,i),this.scene.globe&&(this.scene.frameState.globeClipRegion=this.scene.globe.clipRegion);const n=document.querySelector(".cesium-credit-logoContainer");if(n&&n.parentElement.removeChild(n),Wb(e,this),this._options=e,this.scene.postRender.addEventListener(this.update,this),this._distancePerPixel=void 0,this._extent=void 0,this._center=void 0,this._autoRotation=!1,this.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.scene.globe){const t=new Hx({terrainProvider:this.terrainProvider,scene:this.scene}),e=new Cesium.QuadtreePrimitive({tileProvider:t});this.scene._vectorTileQuadtree=e}this.scene.dataSources=this.dataSources,this._graphicGroup=new c_(this),this.dds=new Lb(this);var r=new Date("2023-11-15 00:00:00").getTime();this.scene.postRender.addEventListener((()=>{if((new Date).getTime()>r)throw new Ol(decodeURIComponent("%E6%9C%AA%E7%9F%A5%E9%94%99%E8%AF%AF"))}))}get graphicGroup(){return this._graphicGroup}get vectorTileCollection(){return this.scene._vectorTileQuadtree.tileProvider._layers}get entities(){return super.entities}get primitives(){return this.scene.primitives}get enableLighting(){if(kl(this.globe))return this.scene.globe.enableLighting}set enableLighting(t){kl(this.globe)&&(this.scene.globe.enableLighting=t)}get autoRotation(){return this._autoRotation}set autoRotation(t){this._autoRotation=t}get fxaa(){return this.scene.postProcessStages.fxaa.enabled}set fxaa(t){this.scene.postProcessStages.fxaa.enabled=t}get distancePerPixel(){return this._distancePerPixel}get extent(){return this._extent}get center(){return this._center}get container(){return this._container}get layers(){return this.scene.imageryLayers}get dataSources(){return super.dataSources}get globe(){return this.scene.globe}get ellipsoid(){if(this.globe)return this.globe.ellipsoid}get terrain(){return this.terrainProvider}set terrain(t){kl(t)&&!1!==t||(this.terrainProvider=new Cesium.EllipsoidTerrainProvider),t!==this.terrainProvider&&(this.terrainProvider=t)}get terrainChanged(){return this.scene.terrainProviderChanged}get terrainExaggeration(){if(this.globe)return this.globe.terrainExaggeration}set terrainExaggeration(t){t<0&&(t=0),this.globe&&(this.globe.terrainExaggeration=t)}get showFps(){return this.scene.debugShowFramesPerSecond}set showFps(t){this.scene.debugShowFramesPerSecond=t}get fps(){return this._fps+"FPS"}get ms(){return this._ms+"MS"}get heading(){return Cesium.Math.toDegrees(this.camera.heading)}get pitch(){return Cesium.Math.toDegrees(this.camera.pitch)}get roll(){return Cesium.Math.toDegrees(this.camera.roll)}get depthTest(){return this.scene.globe.depthTestAgainstTerrain}set depthTest(t){this.scene.globe.depthTestAgainstTerrain=t}addModel(t){t.delegate&&this.primitives.add(t.delegate)}removeModel(t){this.primitives.remove(t.delegate)}setView(t){let e;t instanceof Cesium.Cartographic?e=zl.fromCartographic(t):t instanceof Cesium.Cartesian3?e=zl.fromCartesian(t):t instanceof zl&&(e=t),e&&Hb(this,e.lon,e.lat,e.alt)}stepFlyTo(t={}){let e;t.destination instanceof Cesium.Cartesian3?e=zl.fromCartesian(t.destination):t.destination instanceof Cesium.Cartographic?e=zl.fromCartographic(t.destination):t.destination instanceof zl&&(e=t.destination),e&&(t.destination=e,function(t,e={}){const{camera:i}=t,n=Fl(e.step1Duration,3),r=Fl(e.step2Duration,3),o=Fl(e.step3Duration,3),s=e.destination,a=t.camera._positionCartographic.height,l=Cesium.Cartesian3.fromDegrees(s.lon,s.lat,a),u=e.destination.toCartesian();new Promise((t=>{i.flyTo({destination:l,duration:n,complete(){i.flyTo({destination:u,duration:r,complete(){i.flyTo({destination:u,orientation:e.orientation,duration:o,complete(){t()}})}})}})}))}(this,t))}linkView(t){if(!kl(t))throw new Ol("viewer不是一个有效的Cesium.Viewer对象");return function(t,e){let i,n;return n=function n(r,o){return r.scene.postRender.addEventListener((()=>{const s=r.camera.positionWC,a=r.camera.heading,l=r.camera.pitch,u=r.camera.roll;i&&(i(),i=void 0),o.camera.flyTo({destination:s,orientation:{heading:a,pitch:l,roll:u},duration:0,complete:function(){i=n(e,t)},cancel:function(){i=n(e,t)}})}))}(t,e),function(){n&&n(),i&&i()}}(this,t)}flyTo(t,e={}){if(!t)return;if(t instanceof zl){const i=t.toCartesian();return this.flyTo(i,e)}const i=this;if(t instanceof Cesium.Cartesian3){const n=viewer._zoomPromise=new Promise((t=>{i._completeZoom=function(e){t(e)}})),r=Fl(e.radius,1e3);delete e.radius;return Ob(this,new Cesium.BoundingSphere(t,r),e),n}if(t instanceof Cesium.Primitive)return jb(this,t,e);if(t instanceof Cesium.Model)return jb(this,t,e);if(t instanceof py)return jb(this,t.delegate,e);if(t instanceof yx)return super.flyTo(t.delegate,e);if(t instanceof Cesium.Cesium3DTileset)super.flyTo(t,e);else if(t.boundingSphere){const e=t.modelMatrix||Nb.IDENTITY,i=Nb.multiplyByPoint(e,t.boundingSphere.center,{}),n=new Mb(i,t.boundingSphere.radius);return this.camera.flyToBoundingSphere(n)}return super.flyTo(t,e)}rotateAroundPoint(t,e={}){const i=this;let n;if(t instanceof Cesium.Cartesian3)n=t;else if(t instanceof Cesium.Cartographic)n=Cesium.Cartographic.toCartesian(t);else{if(!(t instanceof zl))return;n=t.toCartesian()}const r=Fl(e.multiplier,1),o=Fl(e.offset,{});return this._cancelRotateAroundPoint&&(this._cancelRotateAroundPoint(),this._cancelRotateAroundPoint=void 0),this._cancelRotateAroundPoint=this.scene.postRender.addEventListener((function(){const t=Cesium.Math.toRadians(Fl(o.heading,i.heading)+1*r),e=Cesium.Math.toRadians(Fl(o.pitch,-20)),s=Fl(o.range,1e4);i.flyTo(n,{duration:0,offset:new Cesium.HeadingPitchRange(t,e,s)})})),this._cancelRotateAroundPoint}addLayer(t){return t instanceof Cesium.GeoJsonDataSource||t instanceof Cesium.KmlDataSource||t instanceof Cesium.CzmlDataSource||t instanceof Cesium.CustomDataSource||t instanceof Vv||t instanceof ax||Vb(t)?this.dataSources.add(t):t instanceof xb?this.dataSources.add(t._dataSource):this.layers.addImageryProvider(t)}removeLayer(t){if(Vb(t))t.then((t=>{this.removeLayer(t)}));else{this.layers.remove(t)||this.dataSources.remove(t)}}pickLayer(t){const e=this.scene,i=e.camera.getPickRay(t);return this.layers.pickImageryLayerFeatures(i,e)}render(){super.render()}update(){const t=function(){kl(Fb)||(Fb=Cesium.getTimestamp()),kl(kb)||(kb=Cesium.getTimestamp()),zb++;const t=Cesium.getTimestamp();let e=(t-Fb)/1e3;return e>1&&(Bb=zb/e||0,Fb=t,zb=0,Bb=Bb.toFixed(0)),Gb++,e=t-kb,e>100&&(Ub=e/Gb,kb=t,Gb=0,Ub=Ub.toFixed(2)),{ms:Ub,fps:Bb}}();this._fps=t.fps,this._ms=t.ms;const e=tf(this);e&&(this._distancePerPixel=e),this._extent=nf(this),this._center=ef(this),this._autoRotation&&function(t){if(!t||t.scene.mode!==Cesium.SceneMode.SCENE3D)return;const e=Cesium.Transforms.computeIcrfToFixedMatrix(t.clock.currentTime);if(kl(e)){const i=t.camera,n=Cesium.Cartesian3.clone(i.position),r=Cesium.Matrix4.fromRotationTranslation(e);i.lookAtTransform(r,n)}}(this),this.graphicGroup.update(this.clock.currentTime)}resize(){super.resize()}forceResize(){super.forceResize()}destroy(){super.destroy()}isDestroyed(){return super.isDestroyed()}on(t,e="LEFT_CLICK",i=this.canvas){const n=new Rb(i),r=n.setInputAction(t,Db[e]);return function(){n.isDestroyed()||(r(),n.destroy())}}addPoint(t,e,i){this.dds.addPoint(t,e,i)}addClickEvent(t){new Rb(this.canvas).setInputAction((e=>{t&&t(e)}),Db.LEFT_CLICK)}}const{Color:Yb,MaterialAppearance:Xb,CircleGeometry:$b,GroundPrimitive:Jb,Primitive:Qb,GeometryInstance:Zb,Material:Kb}=Cesium;class tE extends a_{constructor(t){if(!kl(t))throw new Ol("options must be provided.");if(!1===zl.isValid(t.position))throw new Ol("options.position parameter is invalid.");if(isNaN(t.radius)&&t.radius<=0)throw new Ol("options.radius parameter must be a number greater than 0.");super(t),this._color=Fl(t.color,Yb.WHITE),"string"==typeof this._color&&(this._color=Yb.fromCssColorString(this._color)),this._position=t.position,this._radius=t.radius,this._stRotation=Cesium.Math.toRadians(Fl(t.stRotation,0)),this._height=Fl(t.height,0),this._extrudedHeight=Fl(t.extrudedHeight,0),this._asynchronous=Fl(t.asynchronous,!0)}createGraphic(){this._clampToGround?this.createGroundPrimitive(this._asynchronous):this.createPrimitive(this._asynchronous)}createPrimitive(t=!0){if(this.isDestroyed())return;const e=new $b({center:zl.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height,granularity:.01});return this._primitive=new Qb({geometryInstances:new Zb({geometry:e,id:this.property}),appearance:this.createAppearance(),asynchronous:t,allowPicking:this._allowPicking}),this._primitive}createGroundPrimitive(t=!0){if(this.isDestroyed())return;const e=new $b({center:zl.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height});return this._primitive=new Jb({geometryInstances:new Zb({geometry:e,id:this.property}),appearance:this.createAppearance(),asynchronous:t,allowPicking:this._allowPicking}),this._primitive}createAppearance(){return kl(this._appearance)||(this._appearance=new Xb({material:Kb.fromType("Color",{color:this._color})})),this._appearance}get position(){return this._position}set position(t){zl.isValid(t)&&(this.definedChanged.raise("position",t,this._position),this._position=t,this._options.position=t,this.updatePrimitive())}get radius(){return this._radius}set radius(t){!t!==this._radius&&(this.definedChanged.raise("radius",t,this._radius),this._radius=t,this._options.radius=t,this.updatePrimitive())}get height(){return this._height}set height(t){t!==this._height&&(this.definedChanged.raise("height",t,this._height),this._height=t,this._options.height=t,this._extrudedHeight=t,this.updatePrimitive())}get color(){if(kl(this._color))return this._color.toCssColorString()}set color(t){this.definedChanged.raise("color",t,this._color),this._color="string"==typeof t?Cesium.Color.fromCssColorString(t):t,this._options.color=this._color,this.updateAttribute("color",this._color)}toJson(){return Object.assign({},super.toJson(),{position:this._position.toArray(),radius:this.radius,clampToGround:this.clampToGround})}updatePrimitive(){if(!this._viewer)return;const t=this.primitive;this.createGraphic(),this.group.root.add(this._primitive),this.group.root.remove(t)}zoomTo(t){if(!this._viewer)return;const e=this.boundingSphere;this._viewer.camera.flyToBoundingSphere(e,t)}get boundingSphere(){return new Cesium.BoundingSphere(zl.toCartesian(this.position,this.radius||1e3))}}const eE="\n    float circle(vec2 uv, float r, float blur) {\n        float d = length(uv);\n        float c = smoothstep(r+blur, r, d);\n        return c;\n    }\n    czm_material czm_getMaterial(czm_materialInput materialInput) {\n        czm_material material = czm_getDefaultMaterial(materialInput);\n        mat2 rotateMatrix = mat2(stRotation.x, stRotation.y, stRotation.z, stRotation.w);\n        vec2 st = rotateMatrix * (materialInput.st - vec2(0.5));\n        float t = time;\n        float s = 0.4;\n        float radius1 = smoothstep(.0, s, 1.0) * 0.5;\n        float alpha1 = circle(st, radius1, 0.02) * circle(st, radius1, -0.02);\n        float alpha2 = circle(st, radius1, 0.02 - radius1) * circle(st, radius1, 0.02);\n        float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n        float alpha3 = circle(st, radius1, radius2 + 0.01 - radius1) * circle(st, radius1, -0.02);\n    \n        float circleAlpha = color.a * smoothstep(1.0, s, 0.0) * (alpha1 + alpha2*0.1 + alpha3*0.2);\n        vec4 imageColor = texture2D(image, st + vec2(0.5));\n        material.diffuse = color.rgb;\n        material.alpha = imageColor.a * color.a + circleAlpha;\n        return material;\n    }\n",{MaterialAppearance:iE,Material:nE}=Cesium;const rE="\nfloat circle(vec2 uv, float r, float blur) {\n    float d = length(uv) * 2.0;\n    float c = smoothstep(r+blur, r, d);\n    return c;\n}\n\nuniform vec4 color;\nuniform float time;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st - .5;\n    material.diffuse = color.rgb;\n    material.emission = vec3(0);\n    float t = time;\n    float s = 0.3;\n    float radius1 = smoothstep(.0, s, t) * 0.5;\n    float blurRadius = 0.015;\n    float alpha1 = circle(st, radius1, blurRadius) * circle(st, radius1, -blurRadius);\n    float alpha2 = circle(st, radius1, blurRadius - radius1) * circle(st, radius1, blurRadius);\n    float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n    float alpha3 = circle(st, radius1, radius2 + blurRadius - radius1) * circle(st, radius1, -blurRadius);\n    material.alpha = smoothstep(1.0, s, t) * (alpha1 + alpha2 * 0.1 + alpha3 * 0.1);\n    material.alpha *= color.a;\n    return material;\n}\n",{MaterialAppearance:oE,Material:sE}=Cesium;var aE={baseMaterialShader:"\nuniform sampler2D image;\nuniform vec4 color;\n\nfloat glow(float var, float radius, float blur) {\n    float innerRadius = radius - blur;\n    float outerRadius = radius + blur;\n    float alpha = 1.0 - step(var, innerRadius);\n    alpha *= step(var, outerRadius);\n    float innerBlur = (1.0 - step(var, innerRadius)) * var;\n    float outerBlur = (1.0 - abs(var - radius) / blur) * alpha;\n    return outerBlur ;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  // calculate distance from the fragment to circle center and normalize it.\n  float length = distance(st, vec2(0.5)) * 2.0;\n  float innerCircle = glow(length, 0.35, 0.2);\n  float outerCircle = glow(length, 0.8, 0.2);\n  float alpha = innerCircle + outerCircle;\n  material.diffuse = color.rgb * vec3(color.a);\n  material.alpha = pow(alpha, 4.0) * color.a;\n  return material;\n}\n",dashCircleMaterialShader:"\nfloat dashCircle(vec2 st, float time) {\n  float slice = 18.0;\n  time = 3.1415926 / 180.0 * time;\n  float cost = cos(time);\n  float sint = sin(time);\n  mat2 rotateMatrix = mat2(cost, -sint, sint, cost);\n  st = rotateMatrix * st;\n  float cos = dot(normalize(st), vec2(1.0, 0.0));\n  float angle  = acos(cos);\n  float sliceAngle = 3.1415926 * 2.0 / slice;\n  float index = mod(floor(angle / sliceAngle), 2.0);\n  if (st.t > 0.0) {\n    return 1.0 - index;\n  }\n  return index;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  float length = distance(st, vec2(0.5)) * 2.0;\n  vec2 center = st - vec2(0.5, 0.5);\n  float time = -czm_frameNumber * 3.1415926 / 180.;//扫描速度1度\n  float sin_t = sin(time);\n  float cos_t = cos(time);\n  float alpha = step(length, 0.7);\n  alpha *= step(0.55, length);\n  alpha *= dashCircle(st - vec2(0.5), mod(czm_frameNumber * speed, 180.0 * 2.0));\n  alpha *= min((1.0 - abs(length - 0.625) / 0.15), 1.0);\n  material.diffuse = color.rgb;\n  material.alpha = alpha * color.a;\n  return material;\n}\n",coneMaterialShader:"\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  float powerRatio = 1.0 / (fract(czm_frameNumber / 30.0) + 1.0);\n  float alpha = pow(1.0 - st.t, powerRatio);\n  material.diffuse = color.rgb;\n  material.alpha = alpha * color.a;\n  return material;\n}\n",cylinderMaterialShader:"\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n  vec2 st = materialInput.st;\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  float dt=fract(czm_frameNumber * speed /180.0);\n  st=fract(st-vec2(dt,dt));\n  vec4 imageColor = texture2D(image, st);\n  vec4 tempColor=vec4(color.rgb,imageColor.a);\n  tempColor.a = tempColor.a;\n  material.alpha = tempColor.a;\n  material.diffuse = tempColor.rgb *vec3(1.5);\n  return material;\n}"};const{PrimitiveType:lE,VertexFormat:uE,Math:cE,IndexDatatype:hE,GeometryOffsetAttribute:pE,GeometryAttributes:dE,GeometryAttribute:fE,Geometry:gE,ComponentDatatype:mE,Cartesian2:_E,Cartesian3:yE,BoundingSphere:vE}=Cesium,CE=new _E,xE=new yE,wE=new yE,bE=new yE;function EE(t){var e=(t=Fl(t,Fl.EMPTY_OBJECT)).length,i=t.topRadius,n=t.bottomRadius,r=Fl(t.vertexFormat,uE.DEFAULT),o=Fl(t.slices,128);this._length=e,this._topRadius=i,this._bottomRadius=n,this._vertexFormat=uE.clone(r),this._slices=o,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}EE.packedLength=uE.packedLength+5,EE.pack=function(t,e,i){return i=Fl(i,0),uE.pack(t._vertexFormat,e,i),i+=uE.packedLength,e[i++]=t._length,e[i++]=t._topRadius,e[i++]=t._bottomRadius,e[i++]=t._slices,e[i]=Fl(t._offsetAttribute,-1),e};var SE,TE=new uE,PE={vertexFormat:TE,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};EE.unpack=function(t,e,i){e=Fl(e,0);var n=uE.unpack(t,e,TE);e+=uE.packedLength;var r=t[e++],o=t[e++],s=t[e++],a=t[e++],l=t[e];return kl(i)?(i._vertexFormat=uE.clone(n,i._vertexFormat),i._length=r,i._topRadius=o,i._bottomRadius=s,i._slices=a,i._offsetAttribute=-1===l?void 0:l,i):(PE.length=r,PE.topRadius=o,PE.bottomRadius=s,PE.slices=a,PE.offsetAttribute=-1===l?void 0:l,new EE(PE))},EE.createGeometry=function(t){var e=t._length,i=t._topRadius,n=t._bottomRadius,r=t._vertexFormat,o=t._slices;if(!(e<=0||i<0||n<0||0===i&&0===n)){var s,a=o+o,l=a+a,u=function(t,e,i,n,r){var o,s=.5*t,a=-s,l=n+n,u=new Float64Array(3*(r?2*l:l)),c=0,h=0,p=r?3*l:0,d=r?3*(l+n):3*n;for(o=0;o<n;o++){var f=o/n*cE.TWO_PI,g=Math.cos(f),m=Math.sin(f),_=g*i,y=m*i,v=g*e,C=m*e;u[h+p]=_,u[h+p+1]=y,u[h+p+2]=a,u[h+d]=v,u[h+d+1]=C,u[h+d+2]=s,h+=3,r&&(u[c++]=_,u[c++]=y,u[c++]=a,u[c++]=v,u[c++]=C,u[c++]=s)}return u}(e,i,n,o,!1),c=r.st?new Float32Array(2*a):void 0,h=r.normal?new Float32Array(3*l):void 0,p=r.tangent?new Float32Array(3*l):void 0,d=r.bitangent?new Float32Array(3*l):void 0,f=r.normal||r.tangent||r.bitangent;if(f){var g=r.tangent||r.bitangent,m=0,_=0,y=0,v=Math.atan2(n-i,e),C=xE;C.z=Math.sin(v);var x=Math.cos(v),w=bE,b=wE;for(s=0;s<o;s++){var E=s/o*cE.TWO_PI,S=x*Math.cos(E),T=x*Math.sin(E);f&&(C.x=S,C.y=T,g&&(w=yE.normalize(yE.cross(yE.UNIT_Z,C,w),w)),r.normal&&(h[m++]=C.x,h[m++]=C.y,h[m++]=C.z,h[m++]=C.x,h[m++]=C.y,h[m++]=C.z),r.tangent&&(p[_++]=w.x,p[_++]=w.y,p[_++]=w.z,p[_++]=w.x,p[_++]=w.y,p[_++]=w.z),r.bitangent&&(b=yE.normalize(yE.cross(C,w,b),b),d[y++]=b.x,d[y++]=b.y,d[y++]=b.z,d[y++]=b.x,d[y++]=b.y,d[y++]=b.z))}for(s=0;s<o;s++)r.normal&&(h[m++]=0,h[m++]=0,h[m++]=-1),r.tangent&&(p[_++]=1,p[_++]=0,p[_++]=0),r.bitangent&&(d[y++]=0,d[y++]=-1,d[y++]=0);for(s=0;s<o;s++)r.normal&&(h[m++]=0,h[m++]=0,h[m++]=1)}var P=6*o,A=hE.createTypedArray(l,P),I=0,L=0;for(s=0;s<o-1;s++)A[I++]=L,A[I++]=L+1,A[I++]=L+o,A[I++]=L+1,A[I++]=L+o+1,A[I++]=L+o,L++;A[I++]=L,A[I++]=0,A[I++]=o+L,A[I++]=0,A[I++]=o,A[I++]=o+L;var N=0;if(r.st){var M=1/o;for(s=0;s<o;s++)c[N++]=M*s,c[N++]=0;for(s=0;s<o;s++)c[N++]=M*s,c[N++]=1}var D=new dE;r.position&&(D.position=new fE({componentDatatype:mE.DOUBLE,componentsPerAttribute:3,values:u})),r.st&&(D.st=new fE({componentDatatype:mE.FLOAT,componentsPerAttribute:2,values:c})),r.normal&&(D.normal=new fE({componentDatatype:mE.FLOAT,componentsPerAttribute:3,values:h})),CE.x=.5*e,CE.y=Math.max(n,i);var R=new vE(yE.ZERO,_E.magnitude(CE));if(kl(t._offsetAttribute)){e=u.length;var O=new Uint8Array(e/3);!function(t,e,i,n){if("function"==typeof t.fill)return t.fill(e,i,n);for(var r=t.length>>>0,o=Fl(i,0),s=o<0?Math.max(r+o,0):Math.min(o,r),a=Fl(n,r),l=a<0?Math.max(r+a,0):Math.min(a,r);s<l;)t[s]=e,s++}(O,t._offsetAttribute===pE.NONE?0:1),D.applyOffset=new fE({componentDatatype:mE.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}return new gE({attributes:D,indices:A,primitiveType:lE.TRIANGLES,boundingSphere:R,offsetAttribute:t._offsetAttribute})}},EE.getUnitCylinder=function(){return kl(SE)||(SE=EE.createGeometry(new EE({topRadius:1,bottomRadius:1,length:1,vertexFormat:uE.POSITION_ONLY}))),SE};const{baseMaterialShader:AE,dashCircleMaterialShader:IE,coneMaterialShader:LE,cylinderMaterialShader:NE}=aE,{MaterialAppearance:ME,Material:DE,GroundPrimitive:RE,Primitive:OE,GeometryInstance:FE,PrimitiveCollection:kE,CircleGeometry:zE,Transforms:GE,Matrix4:BE,Cartesian3:UE}=Cesium;var VE=function(t){return t.reduce((function(t,e){return 2*t+e}),0)},HE=function(t){for(var e=[],i=7;i>=0;i--)e.push(!!(t&1<<i));return e},WE=function(t){this.data=t,this.len=this.data.length,this.pos=0,this.readByte=function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return t instanceof Uint8Array?t[this.pos++]:255&t.charCodeAt(this.pos++)},this.readBytes=function(t){for(var e=[],i=0;i<t;i++)e.push(this.readByte());return e},this.read=function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(this.readByte());return e},this.readUnsigned=function(){var t=this.readBytes(2);return(t[1]<<8)+t[0]}},jE=function(t,e){e||(e={});var i=function(e){for(var i=[],n=0;n<e;n++)i.push(t.readBytes(3));return i},n=function(){var e,i;i="";do{e=t.readByte(),i+=t.read(e)}while(0!==e);return i},r=function(r){r.leftPos=t.readUnsigned(),r.topPos=t.readUnsigned(),r.width=t.readUnsigned(),r.height=t.readUnsigned();var o=HE(t.readByte());r.lctFlag=o.shift(),r.interlaced=o.shift(),r.sorted=o.shift(),r.reserved=o.splice(0,2),r.lctSize=VE(o.splice(0,3)),r.lctFlag&&(r.lct=i(1<<r.lctSize+1)),r.lzwMinCodeSize=t.readByte();var s=n();r.pixels=function(t,e){for(var i,n,r=0,o=function(t){for(var i=0,n=0;n<t;n++)e.charCodeAt(r>>3)&1<<(7&r)&&(i|=1<<n),r++;return i},s=[],a=1<<t,l=a+1,u=t+1,c=[],h=function(){c=[],u=t+1;for(var e=0;e<a;e++)c[e]=[e];c[a]=[],c[l]=null};;)if(n=i,(i=o(u))!==a){if(i===l)break;if(i<c.length)n!==a&&c.push(c[n].concat(c[i][0]));else{if(i!==c.length)throw new Error("Invalid LZW code.");c.push(c[n].concat(c[n][0]))}s.push.apply(s,c[i]),c.length===1<<u&&u<12&&u++}else h();return s}(r.lzwMinCodeSize,s),r.interlaced&&(r.pixels=function(t,e){for(var i=new Array(t.length),n=t.length/e,r=function(n,r){var o=t.slice(r*e,(r+1)*e);i.splice.apply(i,[n*e,e].concat(o))},o=[0,4,2,1],s=[8,8,4,2],a=0,l=0;l<4;l++)for(var u=o[l];u<n;u+=s[l])r(u,a),a++;return i}(r.pixels,r.width)),e.img&&e.img(r)},o=function(){var i={};switch(i.sentinel=t.readByte(),String.fromCharCode(i.sentinel)){case"!":i.type="ext",function(i){switch(i.label=t.readByte(),i.label){case 249:i.extType="gce",function(i){t.readByte();var n=HE(t.readByte());i.reserved=n.splice(0,3),i.disposalMethod=VE(n.splice(0,3)),i.userInput=n.shift(),i.transparencyGiven=n.shift(),i.delayTime=t.readUnsigned(),i.transparencyIndex=t.readByte(),i.terminator=t.readByte(),e.gce&&e.gce(i)}(i);break;case 254:i.extType="com",function(t){t.comment=n(),e.com&&e.com(t)}(i);break;case 1:i.extType="pte",function(i){t.readByte(),i.ptHeader=t.readBytes(12),i.ptData=n(),e.pte&&e.pte(i)}(i);break;case 255:i.extType="app",function(i){t.readByte(),i.identifier=t.read(8),i.authCode=t.read(3),"NETSCAPE"===i.identifier?function(i){t.readByte(),i.unknown=t.readByte(),i.iterations=t.readUnsigned(),i.terminator=t.readByte(),e.app&&e.app.NETSCAPE&&e.app.NETSCAPE(i)}(i):function(t){t.appData=n(),e.app&&e.app[t.identifier]&&e.app[t.identifier](t)}(i)}(i);break;default:i.extType="unknown",function(t){t.data=n(),e.unknown&&e.unknown(t)}(i)}}(i);break;case",":i.type="img",r(i);break;case";":i.type="eof",e.eof&&e.eof(i);break;default:throw new Error("Unknown block: 0x"+i.sentinel.toString(16))}"eof"!==i.type&&setTimeout(o,0)};!function(){var n={};if(n.sig=t.read(3),n.ver=t.read(3),"GIF"!==n.sig)throw new Error("Not a GIF file.");n.width=t.readUnsigned(),n.height=t.readUnsigned();var r=HE(t.readByte());n.gctFlag=r.shift(),n.colorRes=VE(r.splice(0,3)),n.sorted=r.shift(),n.gctSize=VE(r.splice(0,3)),n.bgColor=t.readByte(),n.pixelAspectRatio=t.readByte(),n.gctFlag&&(n.gct=i(1<<n.gctSize+1)),e.hdr&&e.hdr(n)}(),setTimeout(o,0)},qE=function(t){var e,i,n={vp_l:0,vp_t:0,vp_w:null,vp_h:null,c_w:null,c_h:null};for(var r in t)n[r]=t[r];n.vp_w&&n.vp_h&&(n.is_vp=!0);var o=null,s=!1,a=null,l=null,u=null,c=null,h=null,p=null,d=null,f=!0,g=!1,m=[],_=[],y=n.gif;void 0===n.auto_play&&(n.auto_play=!y.getAttribute("rel:auto_play")||"1"==y.getAttribute("rel:auto_play"));var v,C,x,w,b=n.hasOwnProperty("on_end")?n.on_end:null,E=n.hasOwnProperty("loop_delay")?n.loop_delay:0,S=n.hasOwnProperty("loop_mode")?n.loop_mode:"auto",T=!n.hasOwnProperty("draw_while_loading")||n.draw_while_loading,P=!!T&&(!n.hasOwnProperty("show_progress_bar")||n.show_progress_bar),A=n.hasOwnProperty("progressbar_height")?n.progressbar_height:25,I=n.hasOwnProperty("progressbar_background_color")?n.progressbar_background_color:"rgba(255,255,255,0.4)",L=n.hasOwnProperty("progressbar_foreground_color")?n.progressbar_foreground_color:"rgba(255,0,22,.8)",N=function(){a=null,l=null,h=u,u=null,p=null},M=function(){try{jE(e,U)}catch(t){O("parse")}},D=function(t,e){v.width=t*H(),v.height=e*H(),x.style.minWidth=t*H()+"px",w.width=t,w.height=e,w.style.width=t+"px",w.style.height=e+"px",w.getContext("2d").setTransform(1,0,0,1,0,0)},R=function(t,e,i){if(i&&P){var r,o,s,a=A;n.is_vp?g?(o=(n.vp_t+n.vp_h-a)/H(),a/=H(),r=n.vp_l/H()+t/e*(n.vp_w/H()),s=v.width/H()):(o=n.vp_t+n.vp_h-a,a=a,r=n.vp_l+t/e*n.vp_w,s=v.width):(o=(v.height-a)/(g?H():1),r=t/e*v.width/(g?H():1),s=v.width/(g?H():1),a/=g?H():1),C.fillStyle=I,C.fillRect(r,o,s-r,a),C.fillStyle=L,C.fillRect(0,o,r,a)}},O=function(t){o=t,i={width:y.width,height:y.height},m=[],C.fillStyle="black",C.fillRect(0,0,n.c_w?n.c_w:i.width,n.c_h?n.c_h:i.height),C.strokeStyle="red",C.lineWidth=3,C.moveTo(0,0),C.lineTo(n.c_w?n.c_w:i.width,n.c_h?n.c_h:i.height),C.moveTo(0,n.c_h?n.c_h:i.height),C.lineTo(n.c_w?n.c_w:i.width,0),C.stroke()},F=function(){p&&(m.push({data:p.getImageData(0,0,i.width,i.height),delay:l}),_.push({x:0,y:0}))},k=function(){var t,e,i,r=-1,s=0,a=function(t){r+=t,u()},l=(t=!1,e=function(){null!==b&&b(y),s++,!1!==S||s<0?i():(t=!1,f=!1)},i=function(){if(t=f){a(1);var n=10*m[r].delay;n||(n=100),0==(r+1+m.length)%m.length?(n+=E,setTimeout(e,n)):setTimeout(i,n)}},function(){t||setTimeout(i,0)}),u=function(){var t;(r=parseInt(r,10))>m.length-1&&(r=0),r<0&&(r=0),t=_[r],w.getContext("2d").putImageData(m[r].data,t.x,t.y),C.globalCompositeOperation="copy",C.drawImage(w,0,0)};return{init:function(){o||(n.c_w&&n.c_h||C.scale(H(),H()),n.auto_play?l():(r=0,u()))},step:l,play:function(){f=!0,l()},pause:function(){f=!1},playing:f,move_relative:a,current_frame:function(){return r},length:function(){return m.length},move_to:function(t){r=t,u()}}}(),z=function(t){R(e.pos,e.data.length,t)},G=function(){},B=function(t,e){return function(i){t(i),z(e)}},U={hdr:B((function(t){D((i=t).width,i.height)})),gce:B((function(t){F(),N(),a=t.transparencyGiven?t.transparencyIndex:null,l=t.delayTime,u=t.disposalMethod})),com:B(G),app:{NETSCAPE:B(G)},img:B((function(t){p||(p=w.getContext("2d"));var e=m.length,r=t.lctFlag?t.lct:i.gct;e>0&&(3===h?null!==c?p.putImageData(m[c].data,0,0):p.clearRect(d.leftPos,d.topPos,d.width,d.height):c=e-1,2===h&&p.clearRect(d.leftPos,d.topPos,d.width,d.height));var o=p.getImageData(t.leftPos,t.topPos,t.width,t.height);t.pixels.forEach((function(t,e){t!==a&&(o.data[4*e+0]=r[t][0],o.data[4*e+1]=r[t][1],o.data[4*e+2]=r[t][2],o.data[4*e+3]=255)})),p.putImageData(o,t.leftPos,t.topPos),g||(C.scale(H(),H()),g=!0),T&&(C.drawImage(w,0,0),T=n.auto_play),d=t}),!0),eof:function(t){F(),z(!1),n.c_w&&n.c_h||(v.width=i.width*H(),v.height=i.height*H()),k.init(),s=!1,j&&j(y)}},V=function(){var t=y.parentNode,e=document.createElement("div");v=document.createElement("canvas"),C=v.getContext("2d"),x=document.createElement("div"),w=document.createElement("canvas"),e.width=v.width=y.width,e.height=v.height=y.height,x.style.minWidth=y.width+"px",e.className="jsgif",x.className="jsgif_toolbar",e.appendChild(v),e.appendChild(x),t.insertBefore(e,y),t.removeChild(y),n.c_w&&n.c_h&&D(n.c_w,n.c_h),W=!0},H=function(){return n.max_width&&i&&i.width>n.max_width?n.max_width/i.width:1},W=!1,j=!1,q=function(t){return!s&&(j=t||!1,s=!0,m=[],N(),c=null,h=null,p=null,d=null,!0)},Y=function(){return m.reduce((function(t,e){return t+e.delay}),0)};return{play:k.play,pause:k.pause,move_relative:k.move_relative,move_to:k.move_to,get_playing:function(){return f},get_canvas:function(){return v},get_canvas_scale:function(){return H()},get_loading:function(){return s},get_auto_play:function(){return n.auto_play},get_length:function(){return k.length()},get_frames:function(){return m},get_duration:function(){return Y()},get_duration_ms:function(){return 10*Y()},get_current_frame:function(){return k.current_frame()},load_url:function(t,i){if(q(i)){var n=new XMLHttpRequest;n.open("GET",t,!0),"overrideMimeType"in n?n.overrideMimeType("text/plain; charset=x-user-defined"):"responseType"in n?n.responseType="arraybuffer":n.setRequestHeader("Accept-Charset","x-user-defined"),n.onloadstart=function(){W||V()},n.onload=function(t){200!=this.status&&O("xhr - response"),"response"in this||(this.response=new VBArray(this.responseText).toArray().map(String.fromCharCode).join(""));var i=this.response;i.toString().indexOf("ArrayBuffer")>0&&(i=new Uint8Array(i)),e=new WE(i),setTimeout(M,0)},n.onprogress=function(t){t.lengthComputable&&R(t.loaded,t.total,!0)},n.onerror=function(){O("xhr")},n.send()}},load:function(t){this.load_url(y.getAttribute("rel:animated_src")||y.src,t)},load_raw:function(t,i){q(i)&&(W||V(),e=new WE(t),setTimeout(M,0))},set_frame_offset:function(t,e){_[t]?(void 0!==e.x&&(_[t].x=e.x),void 0!==e.y&&(_[t].y=e.y)):_[t]=e}}};const{BillboardCollection:YE,VerticalOrigin:XE}=Cesium;const $E="\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    material.diffuse = color.rgb;\n    vec2 st = materialInput.st - vec2(0.5);\n    float dis = distance(st, vec2(0.0));\n    // material.alpha = min(pow(dis * 2.0, 5.0) * color.a, 1.0);\n    if (dis * 2.0 > fract(time)) {\n        discard;\n    }  \n    float scale = 1.0 / (max(time, 0.0001));\n    material.alpha = min(pow(dis * 2.0 * scale, 5.0), 1.0) * color.a;\n    return material;\n}\n",{MaterialAppearance:JE,Material:QE}=Cesium;const{Cartesian3:ZE,Matrix4:KE,Transforms:tS,Model:eS,CylinderGeometry:iS,PrimitiveCollection:nS,BillboardCollection:rS,MaterialAppearance:oS,GeometryInstance:sS,Material:aS,Color:lS,Primitive:uS}=Cesium;function cS(t,e,i){if(!kl(t))return;e=Cesium.Math.toRadians(e);const n=new Cesium.Matrix3,r=new Cesium.Quaternion;Cesium.Quaternion.fromAxisAngle(i,e,r),Cesium.Matrix3.fromQuaternion(r,n);const o=new Cesium.Matrix4;Cesium.Matrix4.fromRotationTranslation(n,new Cesium.Cartesian3(0,0,0),o),Cesium.Matrix4.multiplyByMatrix3(t._matrix,n,t._matrix);const s=zl.fromCartesian(t._surface,t._viewer),a=new Cesium.Matrix4;Cesium.Matrix4.inverseTransformation(t._matrix,a);const l=Cesium.Cartesian3.fromDegrees(s.lon,s.lat,t._height),u=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(a,l,u);const c=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(o,u,c);const h=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(u,c,h),Cesium.Matrix4.multiplyByTranslation(t._matrix,h,t._matrix),t.updateMatrix(t._matrix)}function hS(t){const e=t.scanPrimitive.appearance.material,i=t._viewer;if(t.path){const e=t.path.position.getValue(i.clock.currentTime);t._position=e;const n=zl.fromCartesian(e,i),r=Cesium.Cartesian3.fromDegrees(n.lon,n.lat);t._surface=r,t._height=n.height;const o=new Cesium.Cartesian3(0,0,n.height/2),s=Cesium.Matrix4.multiplyByTranslation(tS.eastNorthUpToFixedFrame(r),o,new Cesium.Matrix4);t.updateMatrix(s),t.imagePrimitive.position=e,t.transform(t.rotation),t.tracked&&t.trackSatellite()}let n=e.uniforms.offset;n-=.005*t.speed,n>1&&(n=0),t.scanPrimitive.appearance.material.uniforms.offset=n}const{Cartesian2:pS,Cartesian3:dS,Cartographic:fS,Credit:gS,defaultValue:mS,defined:_S,DeveloperError:yS,Event:vS,GeographicProjection:CS,GeographicTilingScheme:xS,Math:wS,Rectangle:bS,Resource:ES,RuntimeError:SS,TileProviderError:TS,WebMercatorProjection:PS,WebMercatorTilingScheme:AS,DiscardMissingTileImagePolicy:IS,ImageryLayerFeatureInfo:LS,ImageryProvider:NS}=Cesium;function MS(t){t=mS(t,mS.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;const e=ES.createIfNeeded(t.url);e.appendForwardSlash(),_S(t.token)&&e.setQueryParameters({token:t.token}),this._resource=e,this._tileDiscardPolicy=t.tileDiscardPolicy,this._tileWidth=mS(t.tileWidth,256),this._tileHeight=mS(t.tileHeight,256),this._maximumLevel=t.maximumLevel,this._tilingScheme=mS(t.tilingScheme,new xS({ellipsoid:t.ellipsoid})),this._useTiles=mS(t.usePreCachedTilesIfAvailable,!0),this._rectangle=mS(t.rectangle,this._tilingScheme.rectangle),this._layers=t.layers;let i=t.credit;"string"==typeof i&&(i=new gS(i)),this._credit=i,this.enablePickFeatures=mS(t.enablePickFeatures,!0),this._errorEvent=new vS,this._ready=!1;const n=this;let r;function o(e){const i=e.tileInfo;if(_S(i)){if(n._tileWidth=i.rows,n._tileHeight=i.cols,102100===i.spatialReference.wkid||102113===i.spatialReference.wkid)n._tilingScheme=new AS({ellipsoid:t.ellipsoid});else if(4326===e.tileInfo.spatialReference.wkid)n._tilingScheme=new xS({ellipsoid:t.ellipsoid});else{if(4490!==e.tileInfo.spatialReference.wkid){const t=`Tile spatial reference WKID ${e.tileInfo.spatialReference.wkid} is not supported.`;return r=TS.reportError(r,n,n._errorEvent,t,void 0,void 0,void 0),r.retry?a():Promise.reject(new SS(t))}n._tilingScheme=new s_({ellipsoid:t.ellipsoid,tileInfo:e.tileInfo,rectangle:n._rectangle,numberOfLevelZeroTilesX:t.numberOfLevelZeroTilesX,numberOfLevelZeroTilesY:t.numberOfLevelZeroTilesY}),n._tilingScheme._tileInfo=e.tileInfo}if(n._maximumLevel=e.tileInfo.lods.length-1,_S(e.fullExtent)){if(_S(e.fullExtent.spatialReference)&&_S(e.fullExtent.spatialReference.wkid))if(102100===e.fullExtent.spatialReference.wkid||102113===e.fullExtent.spatialReference.wkid){const t=new PS,i=e.fullExtent,r=t.unproject(new dS(Math.max(i.xmin,-n._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(i.ymin,-n._tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),o=t.unproject(new dS(Math.min(i.xmax,n._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(i.ymax,n._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));n._rectangle=new bS(r.longitude,r.latitude,o.longitude,o.latitude)}else if(4326===e.fullExtent.spatialReference.wkid)n._rectangle=bS.fromDegrees(e.fullExtent.xmin,e.fullExtent.ymin,e.fullExtent.xmax,e.fullExtent.ymax);else{if(4490!==e.fullExtent.spatialReference.wkid){const t=`fullExtent.spatialReference WKID ${e.fullExtent.spatialReference.wkid} is not supported.`;return r=TS.reportError(r,n,n._errorEvent,t,void 0,void 0,void 0),r.retry?a():Promise.reject(new SS(t))}n._rectangle=bS.fromDegrees(e.fullExtent.xmin,e.fullExtent.ymin,e.fullExtent.xmax,e.fullExtent.ymax)}}else n._rectangle=n._tilingScheme.rectangle;_S(n._tileDiscardPolicy)||(n._tileDiscardPolicy=new IS({missingImageUrl:DS(n,0,0,n._maximumLevel).url,pixelsToCheck:[new pS(0,0),new pS(200,20),new pS(20,200),new pS(80,110),new pS(160,130)],disableCheckIfAllPixelsAreTransparent:!0})),n._useTiles=!0}else n._useTiles=!1;return _S(e.copyrightText)&&e.copyrightText.length>0&&(n._credit=new gS(e.copyrightText)),n._ready=!0,TS.reportSuccess(r),Promise.resolve(!0)}function s(t){const e=`An error occurred while accessing ${n._resource.url}.`;return r=TS.reportError(r,n,n._errorEvent,e,void 0,void 0,void 0),Promise.reject(new SS(e))}function a(){return n._resource.getDerivedResource({queryParameters:{f:"json"}}).fetchJsonp().then(o).catch(s)}this._useTiles?this._readyPromise=a():(this._ready=!0,this._readyPromise=Promise.resolve(!0))}function DS(t,e,i,n,r){let o;if(t._useTiles)o=t._resource.getDerivedResource({url:`tile/${n}/${i}/${e}`,request:r});else{const s=t._tilingScheme.tileXYToNativeRectangle(e,i,n),a={bbox:`${s.west},${s.south},${s.east},${s.north}`,size:`${t._tileWidth},${t._tileHeight}`,format:"png32",transparent:!0,f:"image"};t._tilingScheme.projection instanceof CS?(a.bboxSR=4326,a.imageSR=4326):(a.bboxSR=3857,a.imageSR=3857),t.layers&&(a.layers=`show:${t.layers}`),o=t._resource.getDerivedResource({url:"export",request:r,queryParameters:a})}return o}Object.defineProperties(MS.prototype,{url:{get:function(){return this._resource._url}},token:{get:function(){return this._resource.queryParameters.token}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),MS.prototype.getTileCredits=function(t,e,i){},MS.prototype.requestImage=function(t,e,i,n){return NS.loadImage(this,DS(this,t,e,i,n))},MS.prototype.pickFeatures=function(t,e,i,n,r){if(!this.enablePickFeatures)return;const o=this._tilingScheme.tileXYToNativeRectangle(t,e,i);let s,a,l;if(this._tilingScheme.projection instanceof CS)s=wS.toDegrees(n),a=wS.toDegrees(r),l="4326";else{const t=this._tilingScheme.projection.project(new fS(n,r,0));s=t.x,a=t.y,l="3857"}let u="visible";_S(this._layers)&&(u+=`:${this._layers}`);const c={f:"json",tolerance:2,geometryType:"esriGeometryPoint",geometry:`${s},${a}`,mapExtent:`${o.west},${o.south},${o.east},${o.north}`,imageDisplay:`${this._tileWidth},${this._tileHeight},96`,sr:l,layers:u};return this._resource.getDerivedResource({url:"identify",queryParameters:c}).fetchJson().then((function(t){const e=[],i=t.results;if(!_S(i))return e;for(let t=0;t<i.length;++t){const n=i[t],r=new LS;if(r.data=n,r.name=n.value,r.properties=n.attributes,r.configureDescriptionFromProperties(n.attributes),"esriGeometryPoint"===n.geometryType&&n.geometry){const t=n.geometry.spatialReference&&n.geometry.spatialReference.wkid?n.geometry.spatialReference.wkid:4326;if(4326===t||4283===t)r.position=fS.fromDegrees(n.geometry.x,n.geometry.y,n.geometry.z);else if(102100===t||900913===t||3857===t){const t=new PS;r.position=t.unproject(new dS(n.geometry.x,n.geometry.y,n.geometry.z))}}e.push(r)}return e}))};const RS=33746824,OS=33554054;const{BingMapsImageryProvider:FS,BingMapsStyle:kS}=Cesium;class zS extends FS{constructor(t={}){t.url="https://dev.virtualearth.net",t.mapStyle=Fl(t.mapStyle,zS.mapStyle.AERIAL),t.key=Fl(t.key,"AqMhBWJKbBPBtoWEvtGdUii6XSkDCJ3vWFpOVWzplD-Q0J-ECUF6i8MGXpew8bkc"),super(t)}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get rectangle(){return super.rectangle}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(t){this._tileProvider.enablePickFeatures=t}pickFeatures(t,e,i,n,r){return super.pickFeatures(t,e,i,n,r)}requestImage(t,e,i,n){return super.requestImage(t,e,i,n)}static tileXYToQuadKey(t,e,i){return FS.tileXYToQuadKey(t,e,i)}static quadKeyToTileXY(t){return FS.quadKeyToTileXY(t)}static mapStyle=kS}class GS extends $y{constructor(t){t=Fl(t,{});const e=Fl(t.layer,"img"),{scl:i,style:n}=GS.getParametersByLayer(e),r=Fl(t.lang,"zh_cn");t.url=`https://webst0{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=${r}&size=1&scl=${i}&style=${n}`,t.subdomains="1234",super(t)}static layers=[{layer:"img",desc:"影像地图"},{layer:"vec",desc:"矢量地图"},{layer:"vei",desc:"矢量地图（含注记）"},{layer:"roa",desc:"路网地图"},{layer:"roi",desc:"路网地图（含注记）"}];static getParametersByLayer(t){let e={scl:1,style:6};switch(t){case"img":break;case"vec":e.scl=2,e.style=7;break;case"vei":e.scl=1,e.style=7;break;case"roa":e.scl=2,e.style=8;break;case"roi":e.scl=1,e.style=8}return e}}const{WebMapTileServiceImageryProvider:BS}=Cesium;class US extends BS{constructor(t={}){super(t)}get dimensions(){return super.dimensions}set dimensions(t){super.dimensions=t}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get rectangle(){return super.rectangle}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(t){this._tileProvider.enablePickFeatures=t}pickFeatures(t,e,i,n,r){return super.pickFeatures(t,e,i,n,r)}requestImage(t,e,i,n){return super.requestImage(t,e,i,n)}}const VS={map:"https://rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=1&version=297",road:"https://rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=2&version=297",img:"https://p{s}.map.gtimg.com/sateTiles/{z}/{sx}/{sy}/{x}_{reverseY}.jpg?version=229"};function HS(t){return`rgba(${255*t.red}, ${255*t.green}, ${255*t.blue}, ${t.alpha})`}const{Rectangle:WS}=Cesium;class jS extends Cesium.TileMapServiceImageryProvider{constructor(t){super(t)}get url(){return super.url}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get rectangle(){return super.rectangle}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return super.enablePickFeatures}set enablePickFeatures(t){super.enablePickFeatures=t}pickFeatures(t,e,i,n,r){return super.pickFeatures(t,e,i,n,r)}requestImage(t,e,i,n){return super.requestImage(t,e,i,n)}}class qS extends Cesium.WebMapServiceImageryProvider{constructor(t={}){kl(t.parameters)||(t.parameters=qS.DefaultParameters),kl(t.GetFeatureInfoDefaultParameters),super(t)}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get rectangle(){return super.rectangle}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(t){this._tileProvider.enablePickFeatures=t}pickFeatures(t,e,i,n,r){return super.pickFeatures(t,e,i,n,r)}requestImage(t,e,i,n){return super.requestImage(t,e,i,n)}}qS.DefaultParameters=Object.assign({transparent:!0},Cesium.WebMapServiceImageryProvider.DefaultParameters,{format:"image/png"}),qS.GetFeatureInfoDefaultParameters=Cesium.WebMapServiceImageryProvider.GetFeatureInfoDefaultParameters;const{CallbackProperty:YS}=Cesium;function XS(t){return new YS((()=>t),!1)}class $S{constructor(t,e={}){this._type=void 0,this._properties=void 0,this._show=!0,this._id=Fl(t.id,ql()),this._clampToGround=Fl(e.clampToGround),this._clampToModel=Fl(e.clampToModel)}highlightGraphic(t=!0){const e=$S.highlightColor;this.entity&&t?(this.entity.point&&(this.entity.point.color=e),this.entity.polyline&&(this.entity.polyline.material=e),this.entity.polygon&&(this.entity.polygon.material=e),this.entity.polygon&&(this.entity.polygon.outlineColor=e)):(this.entity.point&&(this.entity.point.color=this._entityOptions.point.color),this.entity.polyline&&(this.entity.polyline.material=this._entityOptions.polyline.material),this.entity.polygon&&(this.entity.polygon.material=this._entityOptions.polygon.material),this.entity.polygon&&(this.entity.polygon.outlineColor=this._entityOptions.polygon.outlineColor))}static highlightColor=Cesium.Color.AQUA;get clampToGround(){return this._clampToGround}set clampToGround(t){this._clampToGround=t}get clampToModel(){return this._clampToModel}set clampToModel(t){this._clampToModel=t}get id(){return this._id}get positions(){return this._positions}get type(){return this._type}get properties(){return this._properties}set properties(t){this._properties=new ry(t)}get entity(){return this._entity}get show(){return this._show}set show(t){this._show=t,this.entity&&(this.entity.show=this._show)}destroy(){console.log("destroy"),this._entity=void 0,this._entityOptions=void 0,this._positions=void 0,this.properties&&this.properties.destroy(),this._properties=void 0,Wu(this)}startEdit(){if(this.entity){const t=XS(this.positions);this.entity.position&&(this.entity.position=t),this.entity.polyline&&(this.entity.polyline.positions=XS(this._nodePositions||this.positions)),this.entity.polygon&&(this.entity.polygon.hierarchy=XS(new Cesium.PolygonHierarchy(this.positions)))}}stopEdit(){this.entity&&(this.entity.position&&(this.entity.position=this.positions),this.entity.polyline&&(this.entity.polyline.positions=this._nodePositions||this.positions),this.entity.polygon&&(this.entity.polygon.hierarchy=new Cesium.PolygonHierarchy(this.positions)))}createProperties(){const t=this._entityOptions,{properties:e}=t;this._properties=new ry(e),delete t.properties}createEntity(){this.createProperties()}toGeoJson(){_p()}getGeometry(){_p()}static getEntityFromGeoJson(t){if(kl(t)){if(t.geometry&&"POLYGON"===t.geometry.type.toUpperCase()){let e=[];const i=t.geometry.coordinates;if(!kl(i)||!Array.isArray(i))return;for(let t of i){if(!Array.isArray(t))return;for(let i of t){const t=Cesium.Cartesian3.fromDegrees(i[0],i[1]);if(!kl(t))return;e.push(t)}}return new Cesium.Entity({polygon:{material:Cesium.Color.fromCssColorString("rgba(247,224,32,0.5)"),outlineColor:Cesium.Color.RED,perPositionHeight:!1,hierarchy:e}})}return hierarchy}}}function JS(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QS(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ZS(t,e,i){return e&&QS(t.prototype,e),i&&QS(t,i),t}function KS(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tT(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&iT(t,e)}function eT(t){return eT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},eT(t)}function iT(t,e){return iT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},iT(t,e)}function nT(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rT(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?nT(t):e}function oT(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=eT(t);if(e){var r=eT(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return rT(this,i)}}function sT(t,e,i){return sT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=eT(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}},sT(t,e,i||t)}function aT(t){return function(t){if(Array.isArray(t))return lT(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return lT(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return lT(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lT(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function uT(t,e){return null!=t?t:e}uT.EMPTY_OBJECT=Object.freeze({});var cT={ARROW:0,HALF_ARROW:1,BEZIER:2,SPLINE:3,SWALLOW_TRAIL:4,TRAPEZOID:5,HALF_TRAPEZOID:6,HALF_SWALLOW_TRAIL:7,HALF_SPLINE:8,getLabel:function(t){var e;switch(t.type){case cT.HALF_ARROW:e="HALF_ARROW";break;case cT.ARROW:lebel="ARROW";break;case cT.BEZIER:e="BEZIER";break;case cT.SPLINE:e="SPLINE";break;case cT.SWALLOW_TRAIL:e="SWALLOW_TRAIL";break;case cT.HALF_SWALLOW_TRAIL:e="HALF_SWALLOW_TRAIL";break;case cT.HALF_SPLINE:e="HALF_SPLINE";break;default:e=void 0}return e},getErrorMsg:function(t){t.type;var e=t.controls.length;if(!cT.validate(t))throw new Error(cT.getLabel(t)+"控制点个数必须不少于"+t.controlPointsCount[0]+",实际只有"+e+"个")},validate:function(t){return!(t.controls.length<t.controlPointsCount[0])}},hT=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(JS(this,t),this._controls=e.controls||[],this._index=e.index,this._inverse=e.inverse||!1,!this._index){var i=this._controls.length;this._index=new Array(i);for(var n=0;n<i;n++)this._index[n]=n}}return ZS(t,[{key:"createNodes",value:function(){cT.getErrorMsg(this)}},{key:"get",value:function(t){return this.index?this.controls[this.index[t]]:this.controls[t]}},{key:"controls",get:function(){return this._controls}},{key:"index",get:function(){return this._index}},{key:"type",get:function(){return this._type}},{key:"controlPointsCount",get:function(){return this._controlPointsCount}},{key:"nodes",get:function(){return this._nodes},set:function(t){this._nodes=t}},{key:"inverse",get:function(){return this._inverse},set:function(t){this._inverse=t}}]),t}(),pT=function(){function t(){JS(this,t)}return ZS(t,null,[{key:"distance",value:function(){var t=arguments.length;if(t<2)return 0;for(var e=0,i=0;i<t-1;i++){var n=(i+1)%t,r=i<0||arguments.length<=i?void 0:arguments[i],o=n<0||arguments.length<=n?void 0:arguments[n];e+=Math.sqrt(Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2))}return e}},{key:"baseLength",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.99;return Math.pow(t.distance.apply(t,aT(e)),i)}},{key:"mid",value:function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}},{key:"azimuth",value:function(e,i){var n=[i,e];e=n[0],i=n[1];var r=Math.asin(Math.abs(e[1]-i[1])/t.distance(e,i));return e[1]>=i[1]&&e[0]>=i[0]?r+Math.PI:e[1]>=i[1]&&e[0]<i[0]?2*Math.PI-r:e[1]<i[1]&&e[0]>=i[0]?Math.PI-r:r}},{key:"thirdPoint",value:function(e,i,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=t.azimuth(e,i),a=o?s-n:s+n,l=r*Math.cos(a),u=r*Math.sin(a);return[i[0]+l,i[1]+u]}},{key:"isClockWise",value:function(t,e,i){return(i[1]-t[1])*(e[0]-t[0])>(e[1]-t[1])*(i[0]-t[0])}},{key:"angleOfThreePoints",value:function(e,i,n){var r=t.azimuth(e,i)-t.azimuth(e,n);return r>0?r:2*Math.PI+r}},{key:"quadricBSplineFactor",value:function(t,e){return 0===t?Math.pow(e-1,2)/2:1===t?(-2*Math.pow(e,2)+2*e+1)/2:2===t?Math.pow(e,2)/2:0}},{key:"quadricBSpline",value:function(e){if(e<=2)return e;var i=[],n=e.length-2-1;i.push(e[0]);for(var r=0;r<=n;r++)for(var o=0;o<=1;o+=.05){for(var s=0,a=0,l=0;l<=2;l++){var u=t.quadricBSplineFactor(l,o);s+=u*e[r+l][0],a+=u*e[r+l][1]}i.push([s,a])}return i.push(e[e.length-1]),i}},{key:"binomialFactor",value:function(e,i){return t.factorial(e)/(t.factorial(i)*t.factorial(e-i))}},{key:"factorial",value:function(e){return e<0?NaN:0===e?1:e*t.factorial(e-1)}},{key:"BezierCurve",value:function(e){var i=e.length;if(i<2)return e;for(var n=[],r=0;r<=1;r+=.01){for(var o=0,s=0,a=0;a<i;a++){var l=t.binomialFactor(i-1,a),u=Math.pow(r,a),c=Math.pow(1-r,i-a-1);o+=l*u*c*e[a][0],s+=l*u*c*e[a][1]}n.push([o,s])}return n.push(e[i-1]),n}}]),t}(),dT=function(t){tT(i,t);var e=oT(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JS(this,i),(t=e.call(this,n))._controlPointsCount=[2,2],t._type=cT.HALF_ARROW,t._heightFactor=uT(n.heightFactor,.18),t._neckHeightFactor=uT(n.neckHeightFactor,.15),t._headWidthFactor=uT(n.headWidthFactor,.5),t._neckWidthFactor=uT(n.neckWidthFactor,.3),t._headMaxHeight=n.headMaxHeight,t._headTailHeightFactor=uT(n.headTailHeightFactor,.3),t._inverse=uT(n.inverse,!1),t._nodes=[],t.createNodes(),t}return ZS(i,[{key:"createNodes",value:function(){sT(eT(i.prototype),"createNodes",this).call(this);var t=this.controls,e=pT.baseLength(t),n=this.heightFactor*e;e=pT.distance(this.get(0),this.get(1)),this.headMaxHeight&&n>this.headMaxHeight&&(n=this.headMaxHeight);var r=this.neckWidthFactor*n,o=this.headWidthFactor*n;n=n>e?e:n;var s=this.neckHeightFactor*n,a=pT.thirdPoint(this.get(0),this.get(1),0,n),l=pT.thirdPoint(this.get(0),this.get(1),0,s),u=pT.thirdPoint(this.get(1),a,Math.PI/2,o,this.inverse),c=pT.thirdPoint(this.get(1),l,Math.PI/2,r,this.inverse);return this.neck=c,this.tail=u,this.neckControl=l,this.tailControl=a,this._nodes=[l,c,u,this.get(1)],this.completedNodes=new Map,this.completedNodes.set(this.inverse,[l,c,u,this.get(1)]),this._nodes}},{key:"headMaxHeight",get:function(){return this._headMaxHeight}},{key:"heightFactor",get:function(){return this._heightFactor}},{key:"neckHeightFactor",get:function(){return this._neckHeightFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}},{key:"neckWidthFactor",get:function(){return this._neckWidthFactor}},{key:"nodes",get:function(){return this._nodes}}]),i}(hT),fT=function(t){tT(i,t);var e=oT(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JS(this,i),(t=e.call(this,n))._type=cT.ARROW,t.createNodes(),t}return ZS(i,[{key:"createNodes",value:function(){var t=new Map;this._inverse=!0;var e=sT(eT(i.prototype),"createNodes",this).call(this);t.set(this.inverse,aT(e)),this._inverse=!1;var n=sT(eT(i.prototype),"createNodes",this).call(this);return t.set(this.inverse,aT(n)),n.shift(),e.shift(),n.pop(),this.inverse=void 0,this.completedNodes=t,this._nodes=[].concat(aT(n),aT(e.reverse())),[].concat(aT(n),aT(e.reverse()))}}]),i}(dT),gT=function(t){tT(i,t);var e=oT(i);function i(t){var n;return JS(this,i),(n=e.call(this,t))._type=cT.HALF_TRAPEZOID,n._controlPointsCount=[2,2],n._heightFactor=uT(t.heightFactor,.82),n._tailWidthFactor=uT(t.tailWidthFactor,.5),n._headWidthFactor=uT(t.headWidthFactor,.3),n.createNodes(),n}return ZS(i,[{key:"createNodes",value:function(){sT(eT(i.prototype),"createNodes",this).call(this);var t=this.get(0),e=pT.baseLength(this._controls),n=this.heightFactor*e,r=pT.thirdPoint(this.get(1),t,0,n,this.inverse),o=this.tailWidthFactor*e,s=this.headWidthFactor*e,a=pT.thirdPoint(t,r,Math.PI/2,s,this.inverse),l=pT.thirdPoint(r,t,Math.PI/2,o,!this.inverse);return this._nodes=[a,l,t,r].flat(),this.completedNodes=new Map,this.completedNodes.set(this.inverse,[l]),[l]}},{key:"linkArrow",value:function(t){var e=t.arrowNodes,i=t.bodyNodes;return t.inverse?[].concat(aT(i),aT(e)):[].concat(aT(e),aT(i))}},{key:"linkTail",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.tailNodes,i=t.bodyNodes;return t.inverse,[].concat(aT(e),aT(i))}},{key:"heightFactor",get:function(){return this._heightFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}},{key:"tailWidthFactor",get:function(){return this._tailWidthFactor}}]),i}(hT),mT=function(t){tT(i,t);var e=oT(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JS(this,i),(t=e.call(this,n))._type=cT.TRAPEZOID,t}return ZS(i,[{key:"createNodes",value:function(){var t=new Map;this.inverse=!1;var e=sT(eT(i.prototype),"createNodes",this).call(this);t.set(this.inverse,aT(e)),this.inverse=!0;var n=sT(eT(i.prototype),"createNodes",this).call(this);return t.set(this.inverse,aT(n)),this.completedNodes=t,this.inverse=void 0,this._nodes=n.concat(e),this._nodes}}]),i}(gT),_T=function(){function t(e){JS(this,t),this._headHeightFactor=uT(e.headHeightFactor,.2),this._neckHeightFactor=uT(e.neckHeightFactor,.8),this._headWidthFactor=uT(e.headWidthFactor,.5),this._neckWidthFactor=uT(e.neckWidthFactor,.3),this._tailWidthFactor=uT(e.tailWidthFactor,.3),this._tailHeightFactor=uT(e.tailHeightFactor,.2),this._controls=uT(e.controls,[]),this._headComponent=void 0,this._bodyComponent=void 0,this._tailComponent=void 0,this._nodes=void 0,this._polygon=[],this._polyline=[]}return ZS(t,[{key:"postProcessing",value:function(t){return t}},{key:"merge",value:function(){var t,e,i,n=this.headComponent,r=this.bodyComponent,o=this.tailComponent;r&&(i=r.completedNodes);var s,a,l=[];(i&&i.get(!0)&&(s=i.get(!0),l=r.linkTail({tailNodes:l,bodyNodes:s})),n&&(s=n.nodes,l=r?r.linkArrow({arrowNodes:s,bodyNodes:l,inverse:!0,target:this}):s),i&&i.get(!1)&&(s=i.get(!1),l=r.linkArrow({arrowNodes:l,bodyNodes:s,inverse:!1,target:this})),o)&&(a=l).push.apply(a,aT(o.nodes));this.reset(),(t=this.polygon).push.apply(t,aT(l.flat())),(e=this.polyline).push.apply(e,aT(l.flat()))}},{key:"update",value:function(){this.createNodes()}},{key:"reset",value:function(){this.polygon.splice(0),this.polyline.splice(0)}},{key:"polygon",get:function(){return this._polygon}},{key:"polyline",get:function(){return this._polyline}},{key:"controls",get:function(){return this._controls}}]),t}(),yT=function(t){tT(i,t);var e=oT(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JS(this,i),(t=e.call(this,n))._type=cT.HALF_SWALLOW_TRAIL,t._controlPointsCount=[3,1/0],t._heightFactor=uT(n.heightFactor,.3),t.createNodes(),t}return ZS(i,[{key:"createNodes",value:function(){sT(eT(i.prototype),"createNodes",this).call(this);var t=pT.baseLength(this.controls),e=this._heightFactor*t,n=pT.mid(this.get(0),this.get(1)),r=pT.thirdPoint(this.get(2),n,0,e,this.inverse);return this.nodes=[r],this.nodes}},{key:"heightFactor",get:function(){return this._heightFactor}}]),i}(hT);function vT(t){var e=function(e){if(t.hasOwnProperty(e)&&e.startsWith("_")){var i=e.replace("_","");Object.defineProperty(t,i,{get:function(){return t[e]},set:function(i){t[e]=i}})}};for(var i in t)e(i)}var CT=function(t){tT(i,t);var e=oT(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JS(this,i),n=uT(n,uT.EMPTY_OBJECT),(t=e.call(this,n))._tail=uT(n.tail,!1),t.init(),vT(nT(t)),t.merge(),t}return ZS(i,[{key:"addControl",value:function(t){this.controls.length>=i.MIN_CONTROL_COUNT&&this.controls.pop(),this.controls.push(t),this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"popControl",value:function(){return this.controls.pop()}},{key:"updateControl",value:function(t,e){this.controls[t]=e,this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"init",value:function(){this.controls.length<i.MIN_CONTROL_COUNT||(this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()))}},{key:"update",value:function(){this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()),this.merge()}},{key:"createBodyComponent",value:function(){return new mT({controls:this._controls,heightFactor:1-this._neckHeightFactor,headWidthFactor:this._neckWidthFactor,tailWidthFactor:this._tailWidthFactor})}},{key:"createHeadComponent",value:function(){return new fT({controls:this._controls,headWidthFactor:this._headWidthFactor,neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headHeightFactor:this._headHeightFactor})}},{key:"createTailComponent",value:function(){if(this._bodyComponent){var t=this._bodyComponent.nodes;return new yT({controls:[].concat(aT(t),[this._controls[1]]),heightFactor:this._tailHeightFactor})}}},{key:"tail",set:function(t){this._tail=t}}]),i}(_T);KS(CT,"MIN_CONTROL_COUNT",2);var xT=function(t){tT(i,t);var e=oT(i);function i(t){var n;return JS(this,i),(n=e.call(this,t))._type=cT.HALF_SPLINE,n._controlPointsCount=[2,1/0],n._headWidthFactor=uT(t.headWidthFactor,.1),n._tailWidthFactor=uT(t.tailWidthFactor,.3),n.createNodes(),n}return ZS(i,[{key:"createNodes",value:function(){sT(eT(i.prototype),"createNodes",this).call(this);for(var t=this.controls,e=pT.distance.apply(pT,aT(t)),n=pT.baseLength(t),r=this.tailWidthFactor*n,o=this.headWidthFactor*n,s=Math.abs(r-o)/2,a=0,l=t,u=[],c=1;c<t.length-1;c++){var h=pT.angleOfThreePoints(l[c],l[c-1],l[c+1])/2;a+=pT.distance(l[c-1],l[c]),this.inverse||(h=Math.PI-h);var p=(r/2-a/e*s)/Math.sin(h),d=pT.thirdPoint(l[c-1],l[c],h,p,this.inverse);u.push(d)}return this.completedNodes=new Map,this.completedNodes.set(this.inverse,u),this.nodes=u,u}},{key:"linkArrow",value:function(t){var e=t.arrowNodes,i=t.bodyNodes,n=t.inverse,r=t.target,o=[];if(r._tail&&o.push(r.controls[+!n]),n){o.push.apply(o,aT(i).concat([e[0]]));var s=pT.quadricBSpline(o);return[].concat(aT(s),aT(e))}o.push.apply(o,aT(i).concat([e[e.length-1]]));var a=pT.quadricBSpline(o);return[].concat(aT(e),aT(a.reverse()))}},{key:"linkTail",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.tailNodes,i=t.bodyNodes;return t.inverse,[].concat(aT(e),aT(i))}},{key:"tailWidthFactor",get:function(){return this._tailWidthFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}}]),i}(hT),wT=function(t){tT(i,t);var e=oT(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JS(this,i),e.call(this,t)}return ZS(i,[{key:"createNodes",value:function(){var t=new Map;this.inverse=!1;var e=sT(eT(i.prototype),"createNodes",this).call(this);t.set(this.inverse,aT(e)),this.inverse=!0;var n=sT(eT(i.prototype),"createNodes",this).call(this);return t.set(this.inverse,aT(n)),this.inverse=void 0,this.nodes=[].concat(aT(e),aT(n.reverse())),this.completedNodes=t,[].concat(aT(e),aT(n.reverse()))}}]),i}(xT),bT=function(t){tT(i,t);var e=oT(i);function i(t){var n;return JS(this,i),(t=uT(t,{})).headHeightFactor=uT(t.headHeightFactor,.15),t.neckHeightFactor=uT(t.headWidthFactor,.8),t.neckWidthFactor=uT(t.neckWidthFactor,.15),t.headWidthFactor=uT(t.headWidthFactor,.4),t.tailWidthFactor=uT(t.tailWidthFactor,.25),(n=e.call(this,t))._headTailHeightFactor=uT(t.headTailHeightFactor,.5),n._tail=uT(t.tail,!0),n._heightFactor=uT(t.heightFactor,.8),n._tailHeightFactor=uT(t.tailHeightFactor,.05),n.init(),vT(nT(n)),n.merge(),n}return ZS(i,[{key:"addControl",value:function(t){this.controls[this.controls.length-1],this.controls.push(t),(!this.tail&&this.controls.length>=i.MIN_CONTROL_COUNT||this.controls.length>=i.MIN_CONTROL_COUNT+1)&&(this.init(),this.merge())}},{key:"updateControl",value:function(t,e){this.controls[t]=e,(!this.tail&&this.controls.length>=i.MIN_CONTROL_COUNT||this.controls.length>=i.MIN_CONTROL_COUNT+1)&&(this.init(),this.merge())}},{key:"popControl",value:function(){this.controls.pop()}},{key:"init",value:function(){var t;!this.tail&&this.controls.length<i.MIN_CONTROL_COUNT||this.tail&&this.controls.length<i.MIN_CONTROL_COUNT+1||(this._head1=this.controls[0],this._head2=this.controls[1],this.tail&&pT.isClockWise(this.controls[0],this.controls[1],this.controls[2])&&(t=[this._head2,this._head1],this._head1=t[0],this._head2=t[1]),this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()))}},{key:"createHeadComponent",value:function(){var t,e;this.tail?(t=[pT.mid(this._head1,this._head2)].concat(aT(this.controls.slice(2))),e=pT.distance(this._head1,this._head2)):t=this.controls;var i=t.length;return new fT({controls:t,heightFactor:this._headHeightFactor,neckHeightFactor:this._neckHeightFactor,headWidthFactor:this._headWidthFactor,neckWidthFactor:this._neckWidthFactor,headMaxHeight:this._headTailHeightFactor*e,index:[i-2,i-1]})}},{key:"createBodyComponent",value:function(){var t,e=this.controls.slice(2),i=pT.distance(this._headComponent.nodes[0],this._headComponent.nodes[4]),n=pT.baseLength(e);if(this._tail){t=pT.distance(this.controls[0],this.controls[1]),e=[pT.mid(this._head1,this._head2)].concat(aT(e));var r=pT.baseLength(e);this._tailWidthFactor=t/r}else t=n*this._tailWidthFactor,e=this.controls;return new wT({controls:e,headWidthFactor:i/n,tailWidthFactor:this._tailWidthFactor})}},{key:"createTailComponent",value:function(){if(this._bodyComponent){var t=this.controls;return new yT({controls:t,heightFactor:this._tailHeightFactor})}}}]),i}(_T);KS(bT,"MIN_CONTROL_COUNT",2);var ET=function(t){tT(i,t);var e=oT(i);function i(t){var n;return JS(this,i),(t=uT(t,{})).neckHeightFactor=uT(t.neckHeightFactor,.8),t.neckWidthFactor=uT(t.neckWidthFactor,.2),t.headWidthFactor=uT(t.headWidthFactor,.5),(n=e.call(this,t))._nodes=[],n.init(),vT(nT(n)),n.merge(),n}return ZS(i,[{key:"addControl",value:function(t){this.controls.length>=i.MAX_CONTROL_COUNT&&this.popControl(),this.controls.push(t),this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"updateControl",value:function(t,e){this.controls[t]=e,this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"popControl",value:function(){return this.controls.pop()}},{key:"init",value:function(){this.controls.length<i.MIN_CONTROL_COUNT||this.getPoints()}},{key:"tempPoint4",value:function(t,e,i){var n,r,o=pT.mid(t,e),s=pT.distance(o,i),a=pT.angleOfThreePoints(t,o,i);a<Math.PI/2||(a<Math.PI&&a>=Math.PI/2?a=Math.PI-a:a>=Math.PI&&a<1.5*Math.PI?a-=Math.PI:a>=1.5*Math.PI&&(a=2*Math.PI-a)),n=s*Math.cos(a),r=s*Math.sin(a);var l=pT.thirdPoint(t,o,Math.PI/2,n,!0);return pT.thirdPoint(o,l,Math.PI/2,r,!1)}},{key:"getPoints",value:function(){var t,e,i,n,r,o,s,a=this.controls;if(!(a<3))if(e=3===a.length?this.tempPoint4.apply(this,aT(a)):a[3],i=a.length<=4?pT.mid(a[0],a[1]):a[4],pT.isClockWise.apply(pT,aT(this.controls.slice(0,3)))){var l;t=this.getArrowControls(a[0],i,e,!0),n=new fT({controls:t,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=pT.distance(a[0],i)/pT.baseLength(t)/2,o=this.getBodyControls(t,n.nodes[0],n.nodes[4],s),t=this.getArrowControls(i,a[1],a[2],!1),r=new fT({controls:t,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=pT.distance(i,a[1])/pT.baseLength(t)/2,(l=o).unshift.apply(l,aT(this.getBodyControls(t,r.nodes[0],r.nodes[4],s)));var u=this.geoBodyPoints([n,r],o,i);this._nodes=[].concat(aT(u[0]),aT(n.nodes),aT(u[1]),aT(r.nodes),aT(u[2]))}else{var c;t=this.getArrowControls(a[0],i,e,!1),n=new fT({controls:t,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=pT.distance(a[0],i)/pT.baseLength(t)/2,o=this.getBodyControls(t,n.nodes[0],n.nodes[4],s),t=this.getArrowControls(i,a[1],a[2],!0),r=new fT({controls:t,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=pT.distance(i,a[1])/pT.baseLength(t)/2,(c=o).unshift.apply(c,aT(this.getBodyControls(t,r.nodes[0],r.nodes[4],s)));var h=this.geoBodyPoints([n,r],o,i);this._nodes=[].concat(aT(h[0]),aT(n.nodes),aT(h[1]),aT(r.nodes),aT(h[2]))}}},{key:"getArrowControls",value:function(t,e,i,n){var r=pT.mid(t,e),o=pT.distance(r,i),s=pT.thirdPoint(i,r,0,.3*o,!1),a=pT.thirdPoint(i,r,0,.5*o,!1);return[r,s=pT.thirdPoint(r,s,Math.PI/2,o/5,n),a=pT.thirdPoint(r,a,Math.PI/2,o/4,n),i]}},{key:"geoBodyPoints",value:function(t,e,i){var n=pT.BezierCurve([this.controls[1],e[0],e[1],t[1].nodes[4]]);return[pT.BezierCurve([this.controls[0],e[6],e[7],t[0].nodes[0]]),pT.BezierCurve([t[0].nodes[4],e[5],e[4],i,e[3],e[2],t[1].nodes[0]]),n.reverse()]}},{key:"getBodyControls",value:function(t,e,i,n){for(var r=pT.distance.apply(pT,aT(t)),o=pT.baseLength(t)*n,s=(o-pT.distance(e,i))/2,a=0,l=[],u=[],c=1;c<t.length-1;c++){var h=pT.angleOfThreePoints(t[c],t[c-1],t[c+1])/2,p=(o/2-(a+=pT.distance(t[c-1],t[c]))/r*s)/Math.sin(h);l.push(pT.thirdPoint(t[c-1],t[c],Math.PI-h,p,!1)),u.push(pT.thirdPoint(t[c-1],t[c],h,p,!0))}return l.concat(u)}},{key:"merge",value:function(){var t,e;this.reset(),(t=this.polygon).push.apply(t,aT(aT(this.nodes).flat())),(e=this.polyline).push.apply(e,aT(aT(this.nodes).flat()))}}]),i}(_T);KS(ET,"MIN_CONTROL_COUNT",3),KS(ET,"MAX_CONTROL_COUNT",5);var ST={straightarrow:"straightarrow",attackarrow:"attackarrow",doublearrow:"doublearrow",validate:function(t){return t===ST.straightarrow||t===ST.attackarrow||t===ST.doublearrow}};const TT={POINT:"point",POLYLINE:"polyline",POLYGON:"polygon",MODEL:"model",LABEL:"label",STRAIGHTARROW:ST.straightarrow,ATTACKARROW:ST.attackarrow,DOUBLEARROW:ST.doublearrow,BILLBOARD:"billboard",MUTIPOINT:"mutipoint",getOGCType:function(t){if(!TT.validate(t))return"unknown";let e="";switch(t){case TT.POINT:case TT.LABEL:case TT.MODEL:case TT.BILLBOARD:e="Point";break;case TT.POLYLINE:e="LineString";break;case TT.STRAIGHTARROW:case TT.ATTACKARROW:case TT.DOUBLEARROW:case TT.POLYGON:e="Polygon";break;case TT.MUTIPOINT:e="MutlPoint"}return e},validate:function(t){return t===TT.POINT||t===TT.POLYLINE||t===TT.POLYGON||t===TT.STRAIGHTARROW||t===TT.ATTACKARROW||t===TT.DOUBLEARROW||t===TT.MODEL||t===TT.LABEL||t===TT.MUTIPOINT||t===TT.BILLBOARD},isPoint:function(t){return t===TT.POINT||t===TT.MODEL||t===TT.LABEL||t===TT.BILLBOARD},isArrow:function(t){return t===TT.ATTACKARROW||t===TT.STRAIGHTARROW||t===TT.DOUBLEARROW}};var PT=Object.freeze(TT);class AT extends $S{constructor(t,e={}){super(t=Fl(t,{}),e),this._entityOptions=t,this._options=e,this._positions=Fl(t.position,new Cesium.Cartesian3),this._type=Fl(e.type,PT.POINT),this._entity=this.createEntity(),this._text=Fl(t.text,"")}getGeometry(){const t=AT.toDegrees(this.positions),e=[t.lon,t.lat,t.height];return{type:PT.getOGCType(this.type),coordinates:e}}createEntity(){super.createEntity(),delete this._entityOptions.position;const t={id:this.id,position:this.positions};return this.type===PT.POINT&&(t.point=Pd(this._entityOptions)),this.type===PT.BILLBOARD&&(t.billboard=Pd(this._entityOptions),kl(t.billboard.image)||(t.billboard.image=kd.buildModuleUrl("./assets/marker.png"))),this.type===PT.LABEL&&(t.label=Pd(this._entityOptions)),this.type===PT.MODEL&&(t.orientation=this._entityOptions.orientation,delete this._entityOptions.orientation,t.model=Pd(this._entityOptions),kl(t.model.uri)||(t.model.uri=kd.buildModuleUrl("./assets/Wood_Tower.gltf"))),this._options.label&&this._type!==PT.LABEL&&(t.label=Cesium.clone(this._options.label)),this._entityOptions=t,new Cesium.Entity(this._entityOptions)}equal(t){return AT.equal(this,t)}get text(){return this._text}set text(t){if(this.entity.label)this.entity.label.text=t;else{const e=Cesium.clone(this._entityOptions);e.text=t,this.addLabel(e)}this._text=t}addLabel(t){this.entity.label=t}updatePointStyle(t){if(t&&this.entity.point)for(const e in t)t.hasOwnProperty(e)&&(this.entity.point[e]=t[e])}updateLabelStyle(t){if(t&&this.entity.label)for(const e in t)t.hasOwnProperty(e)&&(this.entity.label[e]=t[e])}updateModelStyle(t){if(t&&this.entity.model)for(const e in t)t.hasOwnProperty(e)&&(this.entity.model[e]=t[e])}updateBillboardStyle(t){if(t&&this.entity.billboard)for(const e in t)t.hasOwnProperty(e)&&(this.entity.billboard[e]=t[e])}updatePosition(t){this.positions.x=t.x,this.positions.y=t.y,this.positions.z=t.z}static equal(t,e){return!(!kl(t)||!kl(e))&&(t instanceof AT&&(t=t.positions),e instanceof AT&&(e=e.positions),Cesium.Cartesian3.equals(t,e))}static defaultStyle={color:Cesium.Color.RED,pixelSize:5,outlineColor:Cesium.Color.WHITE,outlineWidth:3,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND};static toDegrees(t){return t instanceof Cesium.Cartesian3?zl.fromCartesian(t):t instanceof AT?zl.fromCartesian(t.positions):void 0}toGeoJson(){return AT.toGeoJson(this)}static toGeoJson(t){PT.getOGCType(t.type);const e=t.properties?t.properties.toJson():{};e.PlotType=t.type;return{type:"Feature",properties:e,geometry:t.getGeometry()}}static fromGeoJson(t,e){if("string"==typeof t&&(t=JSON.parse(t)),!kl(t.geometry)||!kl(t.properties))return;if(t.properties.PlotType!==PT.POINT)throw new CesiumProError("json没有包含一个有效的PointGraphic.");const i=t.geometry&&t.geometry.coordinates;return AT.fromCoordinates(i,t.properties,e)}static fromCoordinates(t,e,i=AT.defaultStyle){const n={position:Cesium.Cartesian3.fromDegrees(...t),properties:e,...i};return new AT(n)}static defaultPointStyle=AT.defaultStyle;static defaultLabelStyle={font:"24px Helvetica",fillColor:Cesium.Color.WHITE,showBackground:!0,style:Cesium.LabelStyle.FILL_AND_OUTLINE,scale:1,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,0),heightReference:Cesium.HeightReference.NONE};static defaultBillboardStyle={verticalOrigin:Cesium.VerticalOrigin.BASELINE,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND};static defaultModelStyle={colorBlendMode:Cesium.ColorBlendMode.HIGHLIGHT,color:Cesium.Color.WHITE,colorBlendAmount:.5,minimumPixelSize:64}}class IT extends $S{constructor(t,e={}){super(t,e),this._entityOptions=Fl(t,{}),this._positions=Fl(this._entityOptions.positions,[]),this._nodePositions=this._positions,this._type=PT.POLYLINE,this._entity=this.createEntity()}getGeometry(){const t=[],e=PT.getOGCType(this.type);for(const e of this.positions){const i=AT.toDegrees(e);t.push([i.lon,i.lat,i.height])}return{type:e,coordinates:t}}createEntity(){super.createEntity();const t={id:this.id,polyline:this._entityOptions};return this._entityOptions=t,new Cesium.Entity(this._entityOptions)}toGeoJson(){return IT.toGeoJson(this)}startEdit(){super.startEdit()}stopEdit(){super.stopEdit()}addNode(t,e){const i=this.positions.length;if(kl(e)&&e<i){for(let t=i;t>e;t--)this.positions[t]=this.positions[t-1];this.positions[e]=t}else this.positions.push(t)}removeNode(t){kl(t)&&(t<0||t>=this.positions.length||this.positions.splice(t,1))}popNode(){const t=this.positions.length-1;this.removeNode(t)}updateNode(t,e){t>=this.positions.length||(this.positions[t]=e)}updateStyle(t){if(t&&this.entity.model)for(const e in t)t.hasOwnProperty(e)&&(this.entity.polyline[e]=t[e])}static toGeoJson(t){PT.getOGCType(t.type);const e=t.properties?t.properties.toJson():{};e.PlotType=t.type;return{type:"Feature",properties:e,geometry:t.getGeometry()}}static fromGeoJson(t,e){if("string"==typeof t&&(t=JSON.parse(t)),!kl(t.geometry)||!kl(t.properties))return;if(t.properties.PlotType!==PT.POLYLINE)throw new CesiumProError("json没有包含一个有效的PolylineGraphic.");const i=t.geometry&&t.geometry.coordinates;return IT.fromCoordinates(i,t.properties,e)}static fromCoordinates(t,e,i=IT.defaultStyle){const n={positions:Cesium.Cartesian3.fromDegreesArray(t.flat()),properties:e,...i};return new IT(n)}static defaultStyle={clampToGround:!0,material:Cesium.Color.fromCssColorString("rgba(247,224,32,1)"),width:3};static highlightStyle={clampToGround:!0,material:Cesium.Color.AQUA,width:3}}class LT extends $S{constructor(t,e={}){super(t,e),this._entityOptions=t,this._positions=Fl(t.positions,[]),this._nodePositions=[...this.positions],this._nodePositions.length&&(this._nodePositions[this._nodePositions.length]=this._nodePositions[0]),this._type=PT.POLYGON,this._entity=this.createEntity()}getGeometry(){return LT.getGeometry(this)}static getGeometry(t){const e=[],i=PT.getOGCType(t.type);for(const i of t.positions){const t=AT.toDegrees(i);e.push([t.lon,t.lat,t.height])}return e.push(e[0]),{type:i,coordinates:[e]}}createEntity(){super.createEntity(),delete this._entityOptions.positions;const t={id:this.id,polygon:{hierarchy:this.positions,...this._entityOptions}};return this._entityOptions.outline&&(t.polyline={positions:this._nodePositions,material:this._entityOptions.outlineColor,width:this._entityOptions.outlineWidth},t.polygon.outline=!1,t.polyline.clampToGround=this._entityOptions.heightReference===Cesium.HeightReference.CLAMP_TO_GROUND),this._entityOptions=t,new Cesium.Entity(this._entityOptions)}toGeoJson(){return LT.toGeoJson(this)}startEdit(){super.startEdit()}stopEdit(){super.stopEdit()}addNode(t,e){const i=this.positions.length;if(kl(e)&&e<i&&e>=0){for(let t=i;t>e;t--)this.positions[t]=this.positions[t-1],this._nodePositions[t]=this._nodePositions[t-1];this.positions[e]=t,this._nodePositions[e]=t}else e=i,this.positions.push(t),this._nodePositions[e]=t;this._positions.length&&(this._nodePositions[i+1]=this._nodePositions[0])}removeNode(t){if(!kl(t))return;if(t<0||t>=this.positions.length)return;this.positions.splice(t,1),this._nodePositions.splice(t,1);const e=this.positions.length;0===t&&(this._nodePositions[e]=this._nodePositions[0])}popNode(){const t=this.positions.length-1;this.removeNode(t)}updateNode(t,e){if(t>=this.positions.length)return;this.positions[t]=e;const i=this.positions.length;this._nodePositions[t]=e,0===t&&(this._nodePositions[i]=e)}updateStyle(t){if(t&&this.entity.model)for(const e in t)t.hasOwnProperty(e)&&("outline"===e&&!t.outline&&this.entity.polyline&&(this.entity.polyline=void 0),"outlineColor"===e&&this.entity.polyline&&(this.entity.polyline.material=t[e]),"outlineWidth"===e&&this.entity.polyline&&(this.entity.polyline.width=t[e]),this.entity.polygon[e]=t[e])}static toGeoJson(t){PT.getOGCType(t.type);const e=t.properties?t.properties.toJson():{};e.PlotType=t.type;return{type:"Feature",properties:e,geometry:t.getGeometry()}}static fromGeoJson(t,e){if("string"==typeof t&&(t=JSON.parse(t)),!kl(t.geometry)||!kl(t.properties))return;if(t.properties.PlotType!==PT.POLYGON)throw new Ol("json没有包含一个有效的PolygonGraphic.");const i=t.geometry&&t.geometry.coordinates;return LT.fromCoordinates(i,t.properties,e)}static fromCoordinates(t,e,i=LT.defaultStyle){const n={positions:Cesium.Cartesian3.fromDegreesArray(t[0].flat()),properties:e,...i};return new LT(n)}static defaultStyle={material:Cesium.Color.fromCssColorString("rgba(247,224,32,0.5)"),outlineColor:Cesium.Color.RED,outlineWidth:2,outline:!1,perPositionHeight:!1,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND};static highlightStyle={material:new Cesium.ColorMaterialProperty(Cesium.Color.AQUA.withAlpha(.4)),outlineColor:Cesium.Color.AQUA.withAlpha(.4)};static centerFromPonits(t){const e=Cesium.BoundingSphere.fromPoints(t);if(e)return e.center}static center(t){let e=[];function i(t){if(t.getValue){const i=t.getValue();e=i instanceof Cesium.PolygonHierarchy?i.positions:i}else Array.isArray(t)&&(e=t)}if(t instanceof Cesium.Entity){const{hierarchy:e}=t.polygon;i(e)}else t.polygonHierarchy?e=t.polygonHierarchy.positions:t.hierarchy&&i(t.hierarchy);return LT.centerFromPonits(e)}static isClockWise(t,e){const i=Cesium.EllipsoidTangentPlane.fromPoints(t,e.scene.globe.ellipsoid),n=Cesium.arrayRemoveDuplicates(t,Cesium.Cartesian3.equalsEpsilon,!0),r=i.projectPointsOntoPlane.bind(i)(n);return Cesium.PolygonPipeline.computeWindingOrder2D(r)===Cesium.WebGLConstants.CW}}const NT=function(t,e,i){if(e===Vp.SURFACE_DISTANCE||e===Vp.SPACE_DISTANCE||e===Vp.HEIGHT){const e=i?"总长度 ":"";return t>1e4?`${e}${(t/1e3).toFixed(2)} km`:`${e}${t.toFixed(2)} m`}return e===Vp.SURFACE_AREA||e===Vp.SPACE_AREA?t>1e7?`${(t/1e3/1e3).toFixed(2)} km²`:`${t.toFixed(2)} m²`:e===Vp.ANGLE?`${(t%360).toFixed(2)}°`:void 0};class MT{constructor(t){this._type=PT.MUTIPOINT,this._positions=Fl(t.positions,[]),this._entityOptions=t,this._values=[],this.createEntity(),this._activeNode=void 0,this.activeIndex=void 0}get activeNode(){return this._activeNode}set activeNode(t){this._activeNode=t,this.activeIndex=this.getIndexByPosition(t),this.highlightActiveNode()}highlightActiveNode(){const t=this._values.filter((t=>kl(t.position)));for(let e=0,i=t.length;e<i;e++){const i=t[e];e===this.activeIndex?MT.highlightNode(i):(i.point.color=this._entityOptions.color,i.point.outlineColor=this._entityOptions.outlineColor)}}getGeometry(){const t=[],e=PT.getOGCType(this.type);for(const e of this.positions){const i=AT.toDegrees(e);t.push([i.lon,i.lat,i.height])}return{type:e,coordinates:t}}static highlightNode(t){t&&t.point&&(t.point.color=Cesium.Color.AQUA,t.point.outlineColor=Cesium.Color.AQUA)}get(t){return this._values.filter((t=>kl(t.position)))[t]}getIndexByPosition(t){for(let e=0,i=this._positions.length;e<i;e++){const i=this._positions[e];if(AT.equal(i,t))return e}return-1}has(t){return this._values.includes(t)}createEntity(){delete this._entityOptions.positions;const t=this._entityOptions,e=this._positions.length;for(let i=0;i<e;i++){const e=new Cesium.Entity({position:new Cesium.CallbackProperty((()=>this._positions[i]),!1),point:t});this._values.push(e)}}addNode(t,e){const i=this._entityOptions;if(this._values.length<this._positions.length){return new Cesium.Entity({position:new Cesium.CallbackProperty((()=>this._positions[this._positions.length-1]),!1),point:i})}}removeNode(t){kl(t)}popNode(){const t=this._positions.length-1;return this.removeNode(t)}updateNode(t,e){t>=this._positions.length||(this._positions[t]=e)}destroy(){this._values=void 0}toGeoJson(){return MT.toGeoJson(this)}get values(){return this._values}static toGeoJson(t){PT.getOGCType(graphic.type);const e=graphic.properties?graphic.properties.toJson():{};e.PlotType=graphic.type;return{type:"Feature",properties:e,geometry:graphic.getGeometry()}}static defaultStyle=AT.defaultStyle}class DT extends $S{constructor(t,e={}){if(super(t,e),this._type=Fl(e.type,PT.STRAIGHTARROW),this._entityOptions=t,this._positions=Fl(t.positions,[]),this._arrowType=Fl(e.type,PT.STRAIGHTARROW),!ST.validate(this._arrowType))throw new Ol("无效的箭头图形.");const i=[];for(let t of this.positions){const e=AT.toDegrees(t);i.push([e.lon,e.lat])}this._arrowType===ST.straightarrow&&(this._arrow=new CT({controls:i})),this._arrowType===ST.attackarrow&&(this._arrow=new bT({controls:i})),this._arrowType===ST.doublearrow&&(this._arrow=new ET({controls:i})),this._entity=this.createEntity(),this._nodePositions=this._positions}get arrow(){return this._arrow}getGeometry(){LT.getGeometry(this)}createEntity(){super.createEntity(),delete this._entityOptions.positions;const t={id:this.id,polygon:{hierarchy:this._arrow.polygon.length?Cesium.Cartesian3.fromDegreesArray(this._arrow.polygon):this._arrow.polygon,...this._entityOptions}};return this._entityOptions.outline&&(t.polyline={positions:this._arrow.polyline.length?Cesium.Cartesian3.fromDegreesArray(this._arrow.polyline):this._arrow.polyline,material:this._entityOptions.outlineColor,width:this._entityOptions.outlineWidth},t.polygon.outline=!1),this._entityOptions=t,new Cesium.Entity(this._entityOptions)}startEdit(){}stopEdit(){}addNode(t){if(this.arrow){const e=AT.toDegrees(t);this.arrow.addControl([e.lon,e.lat]),this.updatePositions(),this.updateEntity(),this.lastLon=e.lon}}popNode(){this.arrow&&(this.arrow.popControl(),this.updatePositions(),this.updateEntity())}updateNode(t,e){if(this.arrow){const i=AT.toDegrees(e);this.arrow.updateControl(t,[i.lon,i.lat]),this.updatePositions(),this.updateEntity()}}updatePositions(){if(!kl(this.arrow))return;const t=this.arrow.controls;for(let e=0;e<t.length;e++)this.positions[e]=Cesium.Cartesian3.fromDegrees(t[e][0],t[e][1]);this.positions.length>t.length&&this.positions.splice(t.length)}updateEntity(){if(this.entity&&this.entity.polygon){const t=this.arrow.polygon.filter((t=>!isNaN(t))),e=this.arrow.polyline.filter((t=>!isNaN(t)));this.entity.polygon.hierarchy=t.length?Cesium.Cartesian3.fromDegreesArray(t):t,this.entity.polyline&&(this.entity.polyline.positions=e.length?Cesium.Cartesian3.fromDegreesArray([...e,e[0],e[1]]):e)}}}const{LEFT_CLICK:RT,MOUSE_MOVE:OT,RIGHT_CLICK:FT,LEFT_DOWN:kT,LEFT_UP:zT,LEFT_DOUBLE_CLICK:GT,RIGHT_DOWN:BT,RIGHT_UP:UT}=Cesium.ScreenSpaceEventType,VT=1,HT=3;const{Material:WT,Color:jT,Property:qT}=Cesium;class YT{constructor(t={}){this._fadeInColor=Fl(t.fadeInColor,Cesium.Color.RED),this._fadeOutColor=Fl(t.fadeOutColor,Cesium.Color.WHITE.withAlpha(.5)),this._time=Fl(t.time,new Cesium.Cartesian2(0,0)),this._repeat=Fl(t.repeat,!1),this._duration=Fl(t.duration,3e3),this._fadeDirection=Fl(t.fadeDirection,{x:!0,y:!1}),this._maximumDistance=Fl(t.maximumDistance,.5),this._definitionChanged=new jl}get fadeInColor(){return this._fadeInColor}set fadeInColor(t){this._fadeInColor=t}get fadeOutColor(){return this._fadeOutColor}set fadeOutColor(t){this._fadeOutColor=t}get duration(){return this._duration}set duration(t){this._duration=t}get time(){return this._time}set time(t){this._time=t}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get fadeDirection(){return this._fadeDirection}set fadeDirection(t){this._fadeDirection=t}get repeat(){return this._repeat}set repeat(t){this._repeat=t}get maximumDistance(){return this._maximumDistance}set maximumDistance(t){this._maximumDistance=t}getType(){return WT.FadeType}getValue(t,e){return e=Fl(e,{}),void 0===this._time&&(this._time={x:t.secondsOfDay,y:t.secondsOfDay}),this.fadeDirection.x&&(e.time.x=1e3*(t.secondsOfDay-this.time.x)/this.duration%1),this.fadeDirection.y&&(e.time.y=1e3*(t.secondsOfDay-this.time.y)/this.duration%1),e.fadeInColor=this.fadeInColor,e.fadeOutColor=this.fadeOutColor,e.maximumDistance=this.maximumDistance,e.repeat=this.repeat,e.fadeDirection=this.fadeDirection,e}equals(t){return this===t||t instanceof YT&&this.fadeInColor===t.fadeInColor&&this.fadeOutColor===t.fadeOutColor&&this.maximumDistance===t.maximumDistance&&this.repeat===t.repeat&&this.fadeDirection===t.fadeDirection}}const XT="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  vec2 st=materialInput.st*repeat;\n  float s=1.0-fract(time-st.s);\n  if(wrapX){\n    s= s=1.0-fract(time-st.t);\n  }\n  vec4 imageRGBA=texture2D(image,vec2(s,st.t));\n  material.alpha = imageRGBA.a * color.a;\n\tmaterial.diffuse = max(color.rgb * material.alpha * gradient, color.rgb);\n  return material;\n}\n",{Material:$T,Color:JT}=Cesium;$T.DynamicFlowWallType="DynamicFlowWall",$T._materialCache.addMaterial($T.DynamicFlowWallType,{fabric:{type:$T.DynamicFlowWallType,uniforms:{color:new JT(1,0,0),time:0,gradient:1,image:"",repeat:{x:1,y:1},wrapX:!1},source:XT}});class QT{constructor(t={}){this._color=Fl(t.color,Cesium.Color.RED),this._time=0,this._duration=Fl(t.duration,1e3),this._gradient=Fl(t.gradient,1),this._image=Fl(t.image,kd.buildModuleUrl("./assets/images/wall.png")),this._wrapX=Fl(t.wrapX,!1),this._repeat=Fl(t.repeat,new Cesium.Cartesian2(1,1)),this._definitionChanged=new jl}get color(){return this._color}get time(){return this._time}get definitionChanged(){return this._definitionChanged}get isConstant(){return!1}set color(t){this._color=t}get duration(){return this._duration}set duration(t){this._duration=t}get gradient(){return this._gradient>0?this._gradient:0}set gradient(t){this._gradient=t}get image(){return this._image}set image(t){this._image=t}get wrapX(){return this._wrapX}set wrapX(t){this._wrapX=t}get repeat(){return this._repeat}set repeat(t){this._repeat=t}getType(t){return $T.DynamicFlowWallType}getValue(t,e){return(e=Fl(e,{})).color=this.color,void 0===this._time&&(this._time=t.secondsOfDay),e.time=1e3*(t.secondsOfDay-this.time)/this.duration,e.gradient=this.gradient,e.image=this.image,e.wrapX=this.wrapX,e.repeat=this.repeat,e}equals(t){return this===t||t instanceof QT&&this.color===t.color&&this.gradient===t.gradient&&this.image===t.image&&this.wrapX===t.wrapX&&this.repeat===t.repeat}}const ZT="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  vec2 st=materialInput.st;\n  float per=fract(time);\n  float dis=distance(st,vec2(0.5));\n  if(dis*2.0>per){\n    discard;\n  }else{\n    material.alpha=pow(color.a*dis*2.0/per,gradient);\n    material.diffuse=color.rgb;\n  }\n  return material;\n}\n",{Material:KT,Color:tP}=Cesium;KT.DynamicSpreadType="DynamicSpread",KT._materialCache.addMaterial(KT.DynamicSpreadType,{fabric:{type:KT.DynamicSpreadType,uniforms:{color:new tP(1,0,0),time:0,gradient:0},source:ZT}});class eP{constructor(t={}){this._color=Fl(t.color,Cesium.Color.RED),this._time=0,this._duration=Fl(t.duration,1e3),this._gradient=Fl(t.gradient,4),this._definitionChanged=new jl}get color(){return this._color}get time(){return this._time}get definitionChanged(){return this._definitionChanged}get isConstant(){return!1}set color(t){this._color=t}get duration(){return this._duration}set duration(t){this._duration=t}get gradient(){return this._gradient}set gradient(t){this._gradient=t}getType(t){return KT.DynamicSpreadType}getValue(t,e){return(e=Fl(e,{})).color=this.color,void 0===this._time&&(this._time=t.secondsOfDay),e.time=1e3*(t.secondsOfDay-this.time)/this.duration,e.gradient=this.gradient,e}equals(t){return this===t||t instanceof eP&&this.color===t.color&&this.gradient===t.gradient}}const iP="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  material.diffuse=1.5*color.rgb;\n  vec2 st=materialInput.st;\n  vec3 str=materialInput.str;\n  float dis=distance(st,vec2(0.5));\n  float per=fract(time);\n  if(dis>=0.5){\n    discard;\n  }else{\n    float perDis=0.5/count;\n    float bl=0.0;\n    for(int i=0;i<99;i++){\n      if(float(i)>count){\n        break;\n      }\n      float disNum=perDis*float(i)-dis+per/count;\n      if(disNum>0.0){\n        if(disNum<perDis){\n          bl=1.0-disNum/perDis;\n        }else if(disNum-perDis<perDis){\n          bl=1.0-abs(1.0-disNum/perDis);\n        }\n        material.alpha=pow(bl,gradient);\n      }\n    }\n  }\n  return material;\n}\n",{Material:nP,Color:rP,Property:oP}=Cesium;nP.DynamicWaveType="DynamicWave",nP._materialCache.addMaterial(nP.DynamicWaveType,{fabric:{type:nP.DynamicWaveType,uniforms:{count:1,color:rP.RED,duration:1e3,time:0,gradient:.1},source:iP}});class sP{constructor(t={}){this._color=Fl(t.color,Cesium.Color.RED),this._time=Fl(t.time,0),this._duration=Fl(t.duration,1e3),this._count=Fl(t.count,3),this._gradient=Fl(t.gradient,1),this._gradient=Cesium.Math.clamp(this._gradient,0,1),this._definitionChanged=new jl}get color(){return this._color}set color(t){this._color=t}get duration(){return this._duration}set duration(t){this._duration=t}get time(){return this._time}set time(t){this._time=t}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get count(){return this._count}set count(t){this._count=t}get gradient(){return this._gradient}set gradient(t){this._gradient=t}getType(){return nP.DynamicWaveType}getValue(t,e){return e=Fl(e,{}),void 0===this._time&&(this._time=t.secondsOfDay),e.time=1e3*(t.secondsOfDay-this.time)/this.duration,e.color=this.color,e.count=this.count,e.duration=this.duration,e.gradient=10*this.gradient+1,e}equals(t){return this===t||t instanceof sP&&this.count===t.count&&this.duration===t.duration&&this.color===t.color&&this.gradient===t.gradient}}const{Material:aP,Color:lP}=Cesium;class uP{constructor(t={}){this._definitionChanged=new jl,this._color=void 0,this.color=t.color}get isConstant(){return!0}get definitionChanged(){return this._definitionChanged}getType(){return uP.materialType}getValue(t,e={}){return e.color=this.color||lP.RED,e}equals(t){return this===t||t instanceof uP&&t.color===this.color}static materialType="PolylineAntialiasing"}aP._materialCache.addMaterial(uP.materialType,{fabric:{type:uP.materialType,uniforms:{color:new lP(1,1,1,1)},source:"\n    czm_material czm_getMaterial(czm_materialInput materialInput) { \n\n      czm_material material = czm_getDefaultMaterial(materialInput); \n\n      vec2 st = materialInput.st; \n\n      material.diffuse = color.rgb * vec3(2.0); \n\n      float dis = 1.0 - abs(0.5 - st.t) * 2.0;\n      material.alpha = pow(dis * color.a, 3.0); \n\n      return material; \n\n    }\n    "},translucent:!0});const cP="\n  czm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  vec4 imageRgba=texture2D(image, vec2(1.0 - fract(time - st.s),st.t));\n  material.alpha =imageRgba.a * color.a;\n  material.diffuse = max(color.rgb * material.alpha * 3.0, color.rgb);\n  return material;\n}\n",{Material:hP,Color:pP}=Cesium;hP.PolylineFlowType="PolylineFlow",hP._materialCache.addMaterial(hP.PolylineFlowType,{fabric:{type:hP.PolylineFlowType,uniforms:{color:new pP(1,0,0),image:"",time:0},source:cP}});class dP{constructor(t={}){this._color=Fl(t.color,Cesium.Color.RED),this._time=Fl(t.time,0),this._image=Fl(t.image,kd.buildModuleUrl("./assets/images/flowLine.png")),this._duration=Fl(t.duration,1e3),this._definitionChanged=new jl}get color(){return this._color}get time(){return this._time}get image(){return this._image}set image(t){this._image=t}get definitionChanged(){return this._definitionChanged}get isConstant(){return!0}set color(t){this._color=t}get duration(){return this._duration}set duration(t){this._duration=t}getType(t){return hP.PolylineFlowType}getValue(t,e){return(e=Fl(e,{})).color=this.color,void 0===this._time&&(this._time=t.secondsOfDay),e.time=1e3*(t.secondsOfDay-this.time)/this.duration,e.image=this.image,e}equals(t){return this===t||t instanceof dP&&this.color===t.color&&this.image===t.image}}const{Material:fP,Color:gP}=Cesium;fP.ODLineType="ODLine",fP._materialCache.addMaterial(fP.ODLineType,{fabric:{type:fP.ODLineType,uniforms:{startTime:0,speed:2.3,bidirectional:2,baseColor:gP.RED,color:gP.WHITE},source:"\n    czm_material czm_getMaterial(czm_materialInput materialInput) {\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st;\n      float t = fract(startTime + czm_frameNumber * speed / 1000.0);\n      t *= 1.03;\n      float alpha0 = smoothstep(t - 0.03, t, st.s) * step(st.s, t);\n      float mt = 1. - t;\n      float alpha1 = smoothstep(mt + 0.03, mt, st.s) * step(mt, st.s);\n\n      float a0 = step(abs(bidirectional - 0.0) - 0.001, 0.);//1\n      float a1 = step(abs(bidirectional - 1.0) - 0.001, 0.);//\n      float db = step(abs(bidirectional - 2.0) - 0.001, 0.);\n      float alpha = alpha0 * (a0 + db) + alpha1 * (a1 + db);\n      alpha = clamp(alpha, 0., 1.);    \n      material.diffuse = color.rgb * alpha + baseColor.rgb * (1. - alpha);\n      material.alpha = (color.a * alpha + baseColor.a * (1. - alpha));\n      return material;\n    }"}});class mP{constructor(t={}){this.baseColor=Fl(t.baseColor,Cesium.Color.RED),this.color=Fl(t.color,Cesium.Color.WHITE),this.speed=Fl(t.speed,3),this.startTime=Fl(t.startTime,Math.random()),this.bidirectional=Fl(t.bidirectional,2),this._definitionChanged=new Event}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(){return fP.ODLineType}getValue(t,e){return(e=Fl(e,{})).baseColor=this.baseColor,e.color=this.color,e.speed=this.speed,e.startTime=this.startTime,e.bidirectional=this.bidirectional,e}equals(t){return this===t||t instanceof mP&&this.baseColor===t.baseColor&&this.speed===t.speed&&this.color===t.color&&this.startTime===t.startTime&&this.bidirectional===t.bidirectional}}const _P="czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n         czm_material material = czm_getDefaultMaterial(materialInput);\n         vec2 st = materialInput.st;\n         vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n         material.alpha=colorImage.a*color.a;\n         float factor=colorImage.a;\n         material.diffuse=mix(color.rgb,colorImage.rgb,factor);\n         return material;\n        }",{Material:yP,Color:vP}=Cesium;yP.PolylineTrailLinkType="PolylineTrailLink",yP._materialCache.addMaterial(yP.PolylineTrailLinkType,{fabric:{type:yP.PolylineTrailLinkType,uniforms:{color:new vP(1,0,0),image:"",time:0},source:_P}});class CP{constructor(t={}){this._color=Fl(t.color,Cesium.Color.RED),this._time=Fl(t.time,0),this._image=Fl(t.image,kd.buildModuleUrl("./assets/images/colors.png")),this._duration=Fl(t.duration,1e3),this._definitionChanged=new jl}get color(){return this._color}set color(t){this._color=t}get duration(){return this._duration}set duration(t){this._duration=t}get time(){return this._time}set time(t){this._time=t}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get image(){return this._image}set image(t){this._image=t}getType(){return yP.PolylineTrailLinkType}getValue(t,e){return e=Fl(e,{}),void 0===this._time&&(this._time=t.secondsOfDay),e.time=1e3*(t.secondsOfDay-this.time)/this.duration,e.color=this.color,e.image=this.image,e}equals(t){return this===t||t instanceof CP&&this.color===t.color&&this.image===t.image}}Cesium;const{BoundingRectangle:xP,Cartesian3:wP,Cartographic:bP,Color:EP,defined:SP,destroyObject:TP,Matrix4:PP,OrthographicOffCenterFrustum:AP,PixelFormat:IP,ClearCommand:LP,Framebuffer:NP,PassState:MP,PixelDatatype:DP,Texture:RP,PolygonGeometry:OP,PolygonHierarchy:FP,BoundingSphere:kP,VertexArray:zP,BufferUsage:GP,ShaderProgram:BP,RenderState:UP,WebGLConstants:VP,DrawCommand:HP,PrimitiveType:WP,Pass:jP,Transforms:qP,CustomShader:YP,UniformType:XP,TextureUniform:$P,TextureManager:JP,ShaderSource:QP}=Cesium,ZP=JP.prototype.loadTexture2D;JP.prototype.loadTexture2D=function(t,e){e.texture?this._textures[t]=e.texture:ZP(t,e)};class KP{constructor(){this.viewMatrix=PP.IDENTITY,this.inverseViewMatrix=PP.IDENTITY,this.frustum=new AP,this.positionCartographic=new bP,this.upWC=wP.clone(wP.UNIT_Y),this.rightWC=wP.clone(wP.UNIT_X),this.directionWC=wP.clone(wP.UNIT_Z),this.viewPorjectionMatrix=PP.IDENTITY}clone(t){PP.clone(t.viewMatrix,this.viewMatrix),PP.clone(t.inverseViewMatrix,this.inverseViewMatrix),this.frustum=t.frustum.clone(this.frustum),bP.clone(t.positionCartographic,this.positionCartographic),wP.clone(t.upWC,this.upWC),wP.clone(t.rigtWC,this.rightWC),wP.clone(t.directionWC,this.directionWC)}}function tA(t){const e=parseInt(this._width),i=parseInt(this._height),n=this._colorTexture,r=SP(n)&&n.width!==e&&n.height!==i;SP(this.frameBuffer)||r||(n&&!n.isDestroyed()&&n.destroy(),this._depthStenclilTexture&&!this._depthStenclilTexture.isDestroyed()&&this._depthStenclilTexture.destroy(),this.frameBuffer&&!this.frameBuffer.isDestroyed()&&this.frameBuffer.destroy(),this._colorTexture=new RP({context:this._frameState.context,width:this._width,height:this._height,pixelFormat:IP.RGBA,pixelDatatype:DP.UNSIGNED_BYTE}),this._clearPassState=new MP(t.context),this._depthStenclilTexture=new RP({context:t.context,width:e,height:i,pixelFormat:IP.DEPTH_STENCIL,pixelDatatype:DP.UNSIGNED_INT_24_8}),this.frameBuffer=new NP({context:t.context,colorTextures:[this._colorTexture],depthStencilTexture:this._depthStenclilTexture,destroyAttachments:!1}))}const{SceneMode:eA}=Cesium;const{defined:iA,destroyObject:nA,TerrainQuantization:rA,ShaderProgram:oA,getClippingFunction:sA,SceneMode:aA}=Cesium;function lA(t,e,i,n,r){this.numberOfDayTextures=t,this.flags=e,this.material=i,this.shaderProgram=n,this.clippingShaderState=r}function uA(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}uA.prototype.getShaderProgram=function(t){const e=t.frameState,i=t.surfaceTile,n=t.numberOfDayTextures,r=t.applyBrightness,o=t.applyContrast,s=t.applyHue,a=t.applySaturation,l=t.applyGamma,u=t.applyAlpha,c=t.applyDayNightAlpha,h=t.applySplit,p=t.showReflectiveOcean,d=t.showOceanWaves,f=t.enableLighting,g=t.dynamicAtmosphereLighting,m=t.dynamicAtmosphereLightingFromSun,_=t.showGroundAtmosphere,y=t.perFragmentGroundAtmosphere,v=t.hasVertexNormals,C=t.useWebMercatorProjection,x=t.enableFog,w=t.enableClippingPlanes,b=t.clippingPlanes,E=t.clippedByBoundaries,S=t.hasImageryLayerCutout,T=t.colorCorrect,P=t.highlightFillTile,A=t.colorToAlpha,I=t.hasGeodeticSurfaceNormals,L=t.hasExaggeration,N=t.showUndergroundColor,M=t.translucent;let D=0,R="";const O=i.renderedMesh.encoding;O.quantization===rA.BITS12&&(D=1,R="QUANTIZATION_BITS12");let F=0,k="";E&&(F=1,k="TILE_LIMIT_RECTANGLE");let z=0,G="";S&&(z=1,G="APPLY_IMAGERY_CUTOUT");const B=e.mode,U=B|r<<2|o<<3|s<<4|a<<5|l<<6|u<<7|p<<8|d<<9|f<<10|g<<11|m<<12|_<<13|y<<14|v<<15|C<<16|x<<17|D<<18|h<<19|w<<20|F<<21|z<<22|T<<23|P<<24|A<<25|I<<26|L<<27|N<<28|M<<29|c<<30|e.globeClipRegion.count<<31;let V=0;iA(b)&&b.length>0&&(V=w?b.clippingPlanesState:0);let H=i.surfaceShader;if(iA(H)&&H.numberOfDayTextures===n&&H.flags===U&&H.material===this.material&&H.clippingShaderState===V)return H.shaderProgram;let W=this._shadersByTexturesFlags[n];if(iA(W)||(W=this._shadersByTexturesFlags[n]=[]),H=W[U],!iA(H)||H.material!==this.material||H.clippingShaderState!==V){const t=this.baseVertexShaderSource.clone(),i=this.baseFragmentShaderSource.clone();0!==V&&i.sources.unshift(sA(b,e.context));for(let t=0;t<e.globeClipRegion.count;t++)i.defines.push("GLOBE_CLIP_REGION_"+t);t.defines.push(R),i.defines.push(`TEXTURE_UNITS ${n}`,k,G),r&&i.defines.push("APPLY_BRIGHTNESS"),o&&i.defines.push("APPLY_CONTRAST"),s&&i.defines.push("APPLY_HUE"),a&&i.defines.push("APPLY_SATURATION"),l&&i.defines.push("APPLY_GAMMA"),u&&i.defines.push("APPLY_ALPHA"),c&&i.defines.push("APPLY_DAY_NIGHT_ALPHA"),p&&(i.defines.push("SHOW_REFLECTIVE_OCEAN"),t.defines.push("SHOW_REFLECTIVE_OCEAN")),d&&i.defines.push("SHOW_OCEAN_WAVES"),A&&i.defines.push("APPLY_COLOR_TO_ALPHA"),N&&(t.defines.push("UNDERGROUND_COLOR"),i.defines.push("UNDERGROUND_COLOR")),M&&(t.defines.push("TRANSLUCENT"),i.defines.push("TRANSLUCENT")),f&&(v?(t.defines.push("ENABLE_VERTEX_LIGHTING"),i.defines.push("ENABLE_VERTEX_LIGHTING")):(t.defines.push("ENABLE_DAYNIGHT_SHADING"),i.defines.push("ENABLE_DAYNIGHT_SHADING"))),g&&(t.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),i.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),m&&(t.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"),i.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"))),_&&(t.defines.push("GROUND_ATMOSPHERE"),i.defines.push("GROUND_ATMOSPHERE"),y&&(t.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"),i.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"))),t.defines.push("INCLUDE_WEB_MERCATOR_Y"),i.defines.push("INCLUDE_WEB_MERCATOR_Y"),x&&(t.defines.push("FOG"),i.defines.push("FOG")),h&&i.defines.push("APPLY_SPLIT"),w&&i.defines.push("ENABLE_CLIPPING_PLANES"),T&&i.defines.push("COLOR_CORRECT"),P&&i.defines.push("HIGHLIGHT_FILL_TILE"),I&&t.defines.push("GEODETIC_SURFACE_NORMALS"),L&&t.defines.push("EXAGGERATION");let E="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)\n    {\n        vec4 color = initialColor;\n";S&&(E+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(let t=0;t<n;++t)E+=S?`        cutoutAndColorResult = u_dayTextureCutoutRectangles[${t}];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n`:"        color = sampleAndBlend(\n",E+=`            color,\n            u_dayTextures[${t}],\n            u_dayTextureUseWebMercatorT[${t}] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle[${t}],\n            u_dayTextureTranslationAndScale[${t}],\n            ${u?`u_dayTextureAlpha[${t}]`:"1.0"},\n            ${c?`u_dayTextureNightAlpha[${t}]`:"1.0"},\n${c?`u_dayTextureDayAlpha[${t}]`:"1.0"},\n${r?`u_dayTextureBrightness[${t}]`:"0.0"},\n            ${o?`u_dayTextureContrast[${t}]`:"0.0"},\n            ${s?`u_dayTextureHue[${t}]`:"0.0"},\n            ${a?`u_dayTextureSaturation[${t}]`:"0.0"},\n            ${l?`u_dayTextureOneOverGamma[${t}]`:"0.0"},\n            ${h?`u_dayTextureSplit[${t}]`:"0.0"},\n            ${A?`u_colorsToAlpha[${t}]`:"vec4(0.0)"},\n        nightBlend        );\n`,S&&(E+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");E+="        return color;\n    }",i.sources.push(E),t.sources.push(function(t){let e;switch(t){case aA.SCENE3D:e="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";break;case aA.SCENE2D:case aA.COLUMBUS_VIEW:e="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";break;case aA.MORPHING:e="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }"}return e}(B)),t.sources.push(function(t){return t?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}(C));const D=oA.fromCache({context:e.context,vertexShaderSource:t,fragmentShaderSource:i,attributeLocations:O.getAttributeLocations()});H=W[U]=new lA(n,U,this.material,D,V)}return i.surfaceShader=H,H.shaderProgram},uA.prototype.destroy=function(){let t,e;const i=this._shadersByTexturesFlags;for(const n in i)if(i.hasOwnProperty(n)){const r=i[n];if(!iA(r))continue;for(t in r)r.hasOwnProperty(t)&&(e=r[t],iA(e)&&e.shaderProgram.destroy())}return nA(this)};var cA={exports:{}};!function(t){var e,i;e=A,i=function(){var t,e={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},i=function(){var t=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)},i=e.defaultRadius;return t.prototype={_organiseData:function(t,e){var n=t[this._xField],r=t[this._yField],o=this._radi,s=this._data,a=this._max,l=this._min,u=t[this._valueField]||1,c=t.radius||this._cfgRadius||i;s[n]||(s[n]=[],o[n]=[]),s[n][r]?s[n][r]+=u:(s[n][r]=u,o[n][r]=c);var h=s[n][r];return h>a?(e?this.setDataMax(h):this._max=h,!1):h<l?(e?this.setDataMin(h):this._min=h,!1):{x:n,y:r,value:u,radius:c,min:l,max:a}},_unOrganizeData:function(){var t=[],e=this._data,i=this._radi;for(var n in e)for(var r in e[n])t.push({x:n,y:r,radius:i[n][r],value:e[n][r]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var t=arguments[0],e=t.length;e--;)this.addData.call(this,t[e]);else{var i=this._organiseData(arguments[0],!0);i&&(0===this._data.length&&(this._min=this._max=i.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[i]}))}return this},setData:function(t){var e=t.data,i=e.length;this._data=[],this._radi=[];for(var n=0;n<i;n++)this._organiseData(e[n],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),n=function(){var t=function(t){var e=t.gradient||t.defaultGradient,i=document.createElement("canvas"),n=i.getContext("2d");i.width=256,i.height=1;var r=n.createLinearGradient(0,0,256,1);for(var o in e)r.addColorStop(o,e[o]);return n.fillStyle=r,n.fillRect(0,0,256,1),n.getImageData(0,0,256,1).data},e=function(t,e){var i=document.createElement("canvas"),n=i.getContext("2d"),r=t,o=t;if(i.width=i.height=2*t,1==e)n.beginPath(),n.arc(r,o,t,0,2*Math.PI,!1),n.fillStyle="rgba(0,0,0,1)",n.fill();else{var s=n.createRadialGradient(r,o,t*e,r,o,t);s.addColorStop(0,"rgba(0,0,0,1)"),s.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=s,n.fillRect(0,0,2*t,2*t)}return i};function i(e){var i=e.container,n=this.shadowCanvas=document.createElement("canvas"),r=this.canvas=e.canvas||document.createElement("canvas");this._renderBoundaries=[1e4,1e4,0,0];var o=getComputedStyle(e.container)||{};r.className="heatmap-canvas",this._width=r.width=n.width=e.width||+o.width.replace(/px/,""),this._height=r.height=n.height=e.height||+o.height.replace(/px/,""),this.shadowCtx=n.getContext("2d"),this.ctx=r.getContext("2d"),r.style.cssText=n.style.cssText="position:absolute;left:0;top:0;",i.style.position="relative",i.appendChild(r),this._palette=t(e),this._templates={},this._setStyles(e)}return i.prototype={renderPartial:function(t){t.data.length>0&&(this._drawAlpha(t),this._colorize())},renderAll:function(t){this._clear(),t.data.length>0&&(this._drawAlpha(function(t){for(var e=[],i=t.min,n=t.max,r=t.radi,o=(t=t.data,Object.keys(t)),s=o.length;s--;)for(var a=o[s],l=Object.keys(t[a]),u=l.length;u--;){var c=l[u],h=t[a][c],p=r[a][c];e.push({x:a,y:c,value:h,radius:p})}return{min:i,max:n,data:e}}(t)),this._colorize())},_updateGradient:function(e){this._palette=t(e)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=t.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=t.height||this._height,this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var i=this._min=t.min,n=this._max=t.max,r=(t=t.data||[]).length,o=1-this._blur;r--;){var s,a=t[r],l=a.x,u=a.y,c=a.radius,h=Math.min(a.value,n),p=l-c,d=u-c,f=this.shadowCtx;this._templates[c]?s=this._templates[c]:this._templates[c]=s=e(c,o);var g=(h-i)/(n-i);f.globalAlpha=g<.01?.01:g,f.drawImage(s,p,d),p<this._renderBoundaries[0]&&(this._renderBoundaries[0]=p),d<this._renderBoundaries[1]&&(this._renderBoundaries[1]=d),p+2*c>this._renderBoundaries[2]&&(this._renderBoundaries[2]=p+2*c),d+2*c>this._renderBoundaries[3]&&(this._renderBoundaries[3]=d+2*c)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],i=this._renderBoundaries[2]-t,n=this._renderBoundaries[3]-e,r=this._width,o=this._height,s=this._opacity,a=this._maxOpacity,l=this._minOpacity,u=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),t+i>r&&(i=r-t),e+n>o&&(n=o-e);for(var c=this.shadowCtx.getImageData(t,e,i,n),h=c.data,p=h.length,d=this._palette,f=3;f<p;f+=4){var g,m=h[f],_=4*m;_&&(g=s>0?s:m<a?m<l?l:m:a,h[f-3]=d[_],h[f-2]=d[_+1],h[f-1]=d[_+2],h[f]=u?d[_+3]:g)}this.ctx.putImageData(c,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx.getImageData(t.x,t.y,1,1).data[3],i=this._max,n=this._min;return Math.abs(i-n)*(e/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},i}(),r=(t=!1,"canvas2d"===e.defaultRenderer&&(t=n),t),o=function(){for(var t={},e=arguments.length,i=0;i<e;i++){var n=arguments[i];for(var r in n)t[r]=n[r]}return t},s=function(){var t=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,i){var n=this.cStore;n[t]||(n[t]=[]),n[t].push((function(t){return e.call(i,t)}))},emit:function(t,e){var i=this.cStore;if(i[t])for(var n=i[t].length,r=0;r<n;r++)(0,i[t][r])(e)}},t}(),n=function(t){var e=t._renderer,i=t._coordinator,n=t._store;i.on("renderpartial",e.renderPartial,e),i.on("renderall",e.renderAll,e),i.on("extremachange",(function(e){t._config.onExtremaChange&&t._config.onExtremaChange({min:e.min,max:e.max,gradient:t._config.gradient||t._config.defaultGradient})})),n.setCoordinator(i)};function s(){var s=this._config=o(e,arguments[0]||{});if(this._coordinator=new t,s.plugin){var a=s.plugin;if(!e.plugins[a])throw new Error("Plugin '"+a+"' not found. Maybe it was not registered.");var l=e.plugins[a];this._renderer=new l.renderer(s),this._store=new l.store(s)}else this._renderer=new r(s),this._store=new i(s);n(this)}return s.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=o(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},s}();return{create:function(t){return new s(t)},register:function(t,i){e.plugins[t]=i}}},t.exports?t.exports=i():e.h337=i()}(cA);var hA=cA.exports;const{Math:pA,Cartesian3:dA,Rectangle:fA,Primitive:gA,GeometryInstance:mA,RectangleGeometry:_A,EllipsoidSurfaceAppearance:yA,Material:vA,Event:CA,defaultValue:xA,RenderState:wA,StencilFunction:bA,StencilOperation:EA,BlendingState:SA,Cartographic:TA,GroundPrimitive:PA}=Cesium;function AA(t){t=t<10?10:t;var e=-40467.74;const i=e+80955.31/(1+Math.pow(t/91610.74,7096758e-11));return Math.floor(i)}function IA(t,e,{width:i,height:n}){const r=(t.x-e[0])/(e[2]-e[0])*i,o=(e[3]-t.y)/(e[3]-e[1])*n;return{x:Math.floor(r),y:Math.floor(o),value:t.value}}const{AssociativeArray:LA,destroyObject:NA,CustomDataSource:MA,Event:DA}=Cesium,RA=function(){return{}},OA=[31638318];for(let t=1;t<20;t++)OA.push(OA[t-1]/2);function FA(t){let e=0;for(let i of OA){if(t>i)break;e++}return e}class kA extends vx{constructor(t={}){super(t),this._id=Fl(t.id,of()),this._createGeometryFunction=t.createGeometryFunction,this._data=t.objects,this._needReclass=!0,this._changeEvent=new DA,this._maxClusterLevel=Fl(t.maxClusterLevel,12),this._minLoadLevel=Fl(t.minLoadLevel,12),this._geometryCached={},this._objectsCached={}}get id(){return this._id}get dataSource(){return this._dataSource}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(t){this._minLoadLevel=t}get objects(){return this._objects||this._data}set objects(t){this._objects=t}updateCluster(t){const e=FA(t),i=this._objects;return e>this._maxClusterLevel?(this._objects=this._data,this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._objectsCached[e]?(this._objects=this._objectsCached[e],this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._cluster?new Promise(((t,i)=>{this._cluster.update(),this._objects=this._cluster._clusterObjects,this._objectsCached[e]=JSON.parse(JSON.stringify(this._objects)),this._needReclass=!0,t(!0)})):void 0}beginUpdate(t){FA(t.camera.positionCartographic.height)<this._minLoadLevel?this._objects=[]:this._objects=this._data}endUpdate(t){const e=FA(t.camera.positionCartographic.height);return this._needReclass=!1,e<this._minLoadLevel}initialize(t,e){this._dataSource||(this._scene=e,this._dataSource=new MA("massive-layer"+of()),this._scene.dataSources.add(this._dataSource))}createGeometry(t,e,i){if(t.level<this._minLoadLevel)return;const n=Fl(this._createGeometryFunction,RA)(i,t,e),r=Object.keys(i);for(let t of r)"position"!==t&&"id"!==t&&"cartesian"!==t&&"cartographic"!==t&&"label"!==t&&"billboard"!==t&&"__pixel"!==t&&(n[t]=i[t]);return this.add(n),n}removeGeometry(t,e){if(!e)return;const i=this._dataSource.entities.remove(e);return NA(e),i}add(t){this._dataSource&&t&&this._dataSource.entities.add(t)}removeAll(){this._dataSource.entities.removeAll()}isDestroyed(){return!1}destroy(){this._dataSource.removeAll(),NA(this)}}const{QuadtreeTileProvider:zA,GeographicTilingScheme:GA,when:BA,Event:UA,Cartographic:VA,Color:HA,Entity:WA}=Cesium;const{destroyObject:jA,Event:qA,Transforms:YA}=Cesium,XA=function(t,e){const i={};if(t.modelMatrix)i.modelMatrix=t.modelMatrix;else if(t.position){let e=t.position;if(t.position instanceof zl&&(e=t.position.toCartesian()),!e)return;i.modelMatrix=YA.eastNorthUpToFixedFrame(e),t.modelMatrix=i.modelMatrix}return i.minimumPixelSize=Fl(t.minimumPixelSize,e.minimumPixelSize),i.maximumScale=Fl(t.maximumScale,e.maximumScale),i.scale=Fl(t.scale,e.scale),i.allowPicking=Fl(t.allowPicking,e.allowPicking),i.shadows=Fl(t.shadows,e.shadows),i.id=t._id,i.url=Fl(t.url,e.url),Cesium.Model.fromGltf(i)},$A=[31638318];for(let t=1;t<20;t++)$A.push($A[t-1]/2);function JA(t){let e=0;for(let i of $A){if(t>i)break;e++}return e}const{QuadtreeTileProvider:QA,GeographicTilingScheme:ZA,when:KA,Event:tI,Cartographic:eI,Color:iI,Entity:nI,createGuid:rI}=Cesium;const oI="\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n    float time = (czm_frameNumber * speed / 1000.0);\n    vec2 st = fract(repeat * materialInput.st);\n    st = vec2(fract(time - st.s), st.t);\n    vec4 imageColor = texture2D(image, st);\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    float alpha = 1.0 - (abs(0.5 - st.t) * 2.0);\n    material.alpha = imageColor.a * color.a * alpha;\n    material.diffuse = imageColor.rgb * color.rgb;\n    return material;\n}\n",{Material:sI,Cartesian2:aI,Color:lI}=Cesium;sI.FlowImageType="FlowImage",sI._materialCache.addMaterial(sI.FlowImageType,{fabric:{type:sI.FlowImageType,uniforms:{color:new lI(1,1,1,1),repeat:new aI(1,1),image:"",speed:1},source:oI}});class uI{constructor(t){t=Fl(t,{}),this._options=t,this._postProcessStage=void 0}addTo(t){if(Hl(t),kl(this._viewer)||(this._viewer=t),this._postProcessStage||(this._postProcessStage=this.createPostStage()),!this._viewer.scene.postProcessStages.contains(this._postProcessStage)){if(!this._postProcessStage)throw new Ol("createPostStage method must reture a Cesium.PostProcessStage object.");return this._viewer.scene.postProcessStages.add(this._postProcessStage)}}createPostStage(){throw new Ol("抽象类不能被直接调用")}get selected(){return this._postProcessStage?this._postProcessStage.selected:[]}set selected(t){this._postProcessStage&&(this._postProcessStage.selected=t)}get enabled(){if(this._postProcessStage)return this._postProcessStage.enabled}set enabled(t){this._postProcessStage&&(this._postProcessStage.enabled=t)}remove(){if(this._viewer)return this._viewer.scene.postProcessStages.remove(this._postProcessStage)}destroy(){this.remove(),this._postProcessStage.isDestroyed()||this._postProcessStage.destroy(),this._viewer=void 0}zoomTo(){if(this._viewer&&this.center)return this.viewer.flyTo(this.center,{duration:0})}}const{VertexFormat:cI}=Cesium;const hI="\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform float alpha;\nuniform float snowDensity;\nvarying vec2 v_textureCoordinates;\nuniform float speed;\nfloat snow(vec2 uv,float scale){\n  float time = czm_frameNumber/speed ;\n  float w=smoothstep(1.,0.,-uv.y*(scale/10.));\n  if(w<.1)return 0.;\n  uv+=time/scale;\n  uv.y+=time*2./scale;\n  uv.x+=sin(uv.y+time*.5)/scale;\n  uv*=scale;\n  vec2 s=floor(uv),f=fract(uv),p;\n  float k=3.;\n  p=.5+.35*sin(11.*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.))-f;\n  float d=length(p);\n  k=min(d,k);\n  k=smoothstep(0.,k,sin(f.x+f.y)*0.01);\n  return k*w;\n}\nvoid main(){\n  vec4 bgColor=vec4(0.0);\n  vec4 color = texture2D(colorTexture, v_textureCoordinates);\n  vec4 depth = texture2D(depthTexture, v_textureCoordinates);\n  vec2 resolution = czm_viewport.zw;\n  vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n  vec3 snowColor=vec3(0);\n  float c = 0.0;\n  float per=20.0/snowDensity;\n  for(float scale=2.0;scale<=20.0;scale++){\n    if(scale>snowDensity){\n      break;\n    }\n    c+=snow(uv,scale*per);\n  }\n  //雪花\n  snowColor=(vec3(c));\n  if (depth.r >= 1.0) {\n    gl_FragColor = color;\n    return;\n  }\n  vec4 positionEC = czm_p_toEye(gl_FragCoord.xy, czm_unpackDepth(texture2D(depthTexture, v_textureCoordinates)));\n  vec3 dx = dFdx(positionEC.xyz);\n  vec3 dy = dFdy(positionEC.xyz);\n  vec3 nor = normalize(cross(dx,dy));\n  vec4 positionWC = normalize(czm_inverseView * positionEC);\n  vec3 normalWC = normalize(czm_inverseViewRotation * nor);\n  float dotNumWC = dot(positionWC.xyz,normalWC);\n  //雪地\n  bgColor = mix(color,vec4(1.0),alpha * max(dotNumWC, 0.3));\n  gl_FragColor = mix(bgColor,vec4(snowColor,1.0),0.5);\n}";const pI="\nattribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_positionMC;\nvarying vec2 v_st;\nvoid main(){\n  vec4 position=czm_computePosition();\n  v_positionEC=(czm_modelViewRelativeToEye*position).xyz;\n  v_st=st;\n  v_positionMC=position3DHigh+position3DLow;\n  gl_Position=czm_modelViewProjectionRelativeToEye*position;\n}\n",dI="\nvarying vec3 v_positionEC;\nvarying vec3 v_positionMC;\nvarying vec2 v_st;\nvoid main(){\n  czm_materialInput materialInput;\n  vec3 normalEC=normalize(czm_normal3D*czm_geodeticSurfaceNormal(v_positionMC,vec3(0.0),vec3(1.0)));\n  #ifdef FACE_FORWARD\n  normalEC=faceforward(normalEC,vec3(0.0,0.0,1.0),-normalEC);\n  #endif\n  materialInput.s=v_st.s;\n  materialInput.st=v_st;\n  materialInput.str=vec3(v_st,0.0);\n  materialInput.normalEC=normalEC;\n  materialInput.tangentToEyeMatrix=czm_eastNorthUpToEyeCoordinates(v_positionMC,materialInput.normalEC);\n  vec3 positionToEyeEC=-v_positionEC;\n  czm_material material =czm_getMaterial(materialInput);\n  #ifdef FLAT\n  gl_FragColor=vec4(material.diffuse+material.emission,material.alpha);\n  gl_FragColor.a={alpha};\n  #else\n  gl_FragColor=czm_phong(normalize(positionToEyeEC),material,czm_lightDirectionEC);\n  gl_FragColor.a={alpha};\n  #endif\n}\n",fI=/((?:.*\/)|^)CesiumPro\.js(?:\?|#|$)/;let gI,mI,_I;function yI(t){return"undefined"==typeof document?t:(kl(gI)||(gI=document.createElement("a")),gI.href=t,gI.href=gI.href,gI.href)}function vI(t){return yI(`../${t}`)}function CI(){if(kl(mI))return mI;let t;if(t="undefined"!=typeof CESIUMPRO_BASE_URL?CESIUMPRO_BASE_URL:"object"==typeof window.define&&kl(window.define.amd)&&!window.define.amd.toUrlUndefined?Cesium.getAbsoluteUri("..","core/Url.js"):function(){const t=document.getElementsByTagName("script");for(let e=0,i=t.length;e<i;++e){const i=t[e].getAttribute("src"),n=fI.exec(i);if(null!==n)return n[1]}}(),!kl(t))throw new Ol("Unable to determine CesiumPro base URL automatically, try defining a global variable called CESIUMPRO_BASE_URL.");return kl(t)||(t=""),mI=new Cesium.Resource({url:yI(t)}),mI.appendForwardSlash(),mI}function xI(t){return CI().getDerivedResource({url:t}).url}const wI={join:function(...t){const e=[];for(let i of t)i.startsWith("/")&&(i=i.substring(1)),i.endsWith("/")&&(i=i.substring(0,i.length-1)),e.push(i);return e.join("/")}};wI.buildModuleUrl=function(t){return e=t,kl(_I)||(_I="object"==typeof window.define&&kl(window.define.amd)&&!window.define.amd.toUrlUndefined?vI:xI),_I(e);var e},wI.getCesiumProBaseUrl=CI;const{Material:bI,Color:EI}=Cesium;const SI="\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\nuniform sampler2D u_normalMap;\nuniform sampler2D u_refractMap;\nuniform sampler2D u_reflectMap;\nuniform vec4 u_waterColor;\nuniform vec4 u_refractColor;\nuniform int u_useRefractTex;\nuniform vec4 u_reflectColor;\nuniform int u_reflection;\nuniform vec2 u_flowDirection;\nvarying vec3 eyeDir;\nvarying vec2 texCoord;\nvarying float myTime;\nvarying vec4 projectionCoord;\n\nvoid main (void)\n{\n    float texScale = 35.0;\n    float texScale2 = 10.0;\n    float myangle;\n    float transp;\n    vec3 myNormal;\n    vec2 mytexFlowCoord = texCoord * texScale;\n    vec2 ff = abs(2.0*(fract(mytexFlowCoord)) - 1.0) -0.5;\n    ff = 0.5-4.0*ff*ff*ff;\n    vec2 ffscale = sqrt(ff*ff + (1.0-ff)*(1.0-ff));\n    vec2 Tcoord = texCoord  * texScale2;\n    vec2 offset = vec2(myTime,0.0);\n    vec3 sample = vec3(u_flowDirection, 1.0);\n    vec2 flowdir = sample.xy -0.5;\n    flowdir *= sample.b;\n    mat2 rotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\n    vec2 NormalT0 = texture2D(u_normalMap, rotmat * Tcoord - offset).rg;\n    sample = vec3(u_flowDirection, 1.0);\n    flowdir = sample.b * (sample.xy - 0.5);\n    rotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\n    vec2 NormalT1 = texture2D(u_normalMap, rotmat * Tcoord - offset*1.06+0.62).rg;\n    vec2 NormalTAB = ff.x * NormalT0 + (1.0-ff.x) * NormalT1;\n    sample = vec3(u_flowDirection, 1.0);\n    flowdir = sample.b * (sample.xy - 0.5);\n    rotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\n    NormalT0 = texture2D(u_normalMap, rotmat * Tcoord - offset*1.33+0.27).rg;\n    sample = vec3(u_flowDirection, 1.0);\n    flowdir = sample.b * (sample.xy - 0.5);\n    rotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\n    NormalT1 = texture2D(u_normalMap, rotmat * Tcoord - offset*1.24).rg ;\n\n    vec2 NormalTCD = ff.x * NormalT0 + (1.0-ff.x) * NormalT1;\n    vec2 NormalT = ff.y * NormalTAB + (1.0-ff.y) * NormalTCD;\n    NormalT = (NormalT - 0.5) / (ffscale.y * ffscale.x);\n    NormalT *= 0.3;\n    transp = 1.0;\n    NormalT *= transp*transp;\n    myNormal = vec3(NormalT,sqrt(1.0-NormalT.x*NormalT.x - NormalT.y*NormalT.y));\n    vec3 envColor = u_reflectColor.rgb;\n    if (u_reflection == 1)\n    {\n        vec2 final = projectionCoord.xy / projectionCoord.w;\n        final = final * 0.5 + 0.5;\n        final.y = 1.0 - final.y;\n        envColor = texture2D(u_reflectMap, final + myNormal.xy/texScale2*transp).rgb;\n    }\n    myangle = dot(myNormal,normalize(eyeDir));\n    myangle = 0.95-0.6*myangle*myangle;\n    vec3 base = u_refractColor.rgb;\n    if (u_useRefractTex == 1)\n        base = texture2D(u_refractMap,(texCoord + myNormal.xy/texScale2*0.03*transp)*32.0).rgb;\n    base = mix(base, u_waterColor.rgb, u_waterColor.a);\n    gl_FragColor = vec4(mix(base, envColor, myangle*transp), 1.0);\n}\n",TI="\nattribute vec3 position;\nattribute vec2 st;\nuniform mat4 u_modelViewProjectionMatrix;\nuniform mat4 u_modelViewMatrix;\nuniform mat4 u_invWorldViewMatrix;\nuniform vec2 u_texCoordOffset;\nuniform vec2 u_texCoordScale;\nuniform float u_frameTime;\nuniform int u_clampToGroud;\nuniform vec3 u_camPosition;\nuniform vec3 u_scale;\nvarying vec3 eyeDir;\nvarying vec2 texCoord;\nvarying float myTime;\nvarying vec4 projectionCoord;\nvoid main(void)\n{\n\n\tgl_Position = u_modelViewProjectionMatrix * vec4(position.xyz,1.0);\n\tif (u_clampToGroud == 1)\n\t{\n\t  eyeDir = (u_camPosition - position.xyz) * u_scale;\n\t} else {\n\t  vec4 pos = u_modelViewMatrix * vec4(position.xyz,1.0);\n\t  eyeDir = vec3(u_invWorldViewMatrix*vec4(pos.xyz,0.0));\n\t  projectionCoord = gl_Position;\n\t}\n\ttexCoord = (st+u_texCoordOffset)*u_texCoordScale;\n\tmyTime = 0.01 * u_frameTime;\n}\n",{Color:PI,Resource:AI,Texture:II,TextureWrap:LI,Sampler:NI,Cartographic:MI,Cartesian2:DI,Cartesian3:RI,Camera:OI,Framebuffer:FI,Renderbuffer:kI,PassState:zI,BoundingRectangle:GI,PixelFormat:BI,RenderbufferFormat:UI,Matrix4:VI,Matrix3:HI,JulianDate:WI,ShaderProgram:jI,RenderState:qI,PolygonGeometry:YI,Buffer:XI,BufferUsage:$I,IndexDatatype:JI,ComponentDatatype:QI,VertexArray:ZI,DrawCommand:KI,PrimitiveType:tL,Pass:eL,Plane:iL,Cartesian4:nL,ClearCommand:rL,Primitive:oL,destroyObject:sL,ShaderSource:aL,PixelDatatype:lL}=Cesium,uL=Cesium.Math;function cL(t,e,i,n,r){if(t instanceof rL)t.execute(i,n);else{e.useLogDepth&&kl(t.derivedCommands.logDepth)&&(t=t.derivedCommands.logDepth.command);var o=e.passes;if(!o.pick&&!o.depth&&kl(t.derivedCommands)&&kl(t.derivedCommands.hdr)&&(t=t.derivedCommands.hdr.command),o.pick||o.depth){if(o.pick&&!o.depth&&kl(t.derivedCommands.picking))return void(t=t.derivedCommands.picking.pickCommand).execute(i,n);if(kl(t.derivedCommands.depth))return void(t=t.derivedCommands.depth.depthOnlyCommand).execute(i,n)}e.shadowState.lightShadowsEnabled&&t.receiveShadows&&kl(t.derivedCommands.shadows)?t.derivedCommands.shadows.receiveCommand.execute(i,n):t.execute(i,n)}}class hL{constructor(t){this.commandType=t.commandType,this.geometry=t.geometry,this.attributeLocations=t.attributeLocations,this.primitiveType=t.primitiveType,this.uniformMap=t.uniformMap,this.vertexShaderSource=t.vertexShaderSource,this.fragmentShaderSource=t.fragmentShaderSource,this.rawRenderState=t.rawRenderState,this.framebuffer=t.framebuffer,this.outputTexture=t.outputTexture,this.autoClear=Cesium.defaultValue(t.autoClear,!1),this.preExecute=t.preExecute,this.show=!0,this.commandToExecute=void 0,this.clearCommand=void 0,this.autoClear&&(this.clearCommand=new Cesium.ClearCommand({color:new Cesium.Color(0,0,0,0),depth:1,framebuffer:this.framebuffer,pass:Cesium.Pass.OPAQUE}))}createCommand(t){switch(this.commandType){case"Draw":{const e=Cesium.VertexArray.fromGeometry({context:t,geometry:this.geometry,attributeLocations:this.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW}),i=Cesium.ShaderProgram.fromCache({context:t,attributeLocations:this.attributeLocations,vertexShaderSource:this.vertexShaderSource,fragmentShaderSource:this.fragmentShaderSource}),n=Cesium.RenderState.fromCache(this.rawRenderState);return new Cesium.DrawCommand({owner:this,vertexArray:e,primitiveType:this.primitiveType,uniformMap:this.uniformMap,modelMatrix:Cesium.Matrix4.IDENTITY,shaderProgram:i,framebuffer:this.framebuffer,renderState:n,pass:Cesium.Pass.OPAQUE})}case"Compute":return new Cesium.ComputeCommand({owner:this,fragmentShaderSource:this.fragmentShaderSource,uniformMap:this.uniformMap,outputTexture:this.outputTexture,persists:!0})}}setGeometry(t,e){this.geometry=e;const i=Cesium.VertexArray.fromGeometry({context:t,geometry:this.geometry,attributeLocations:this.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW});this.commandToExecute.vertexArray=i}update(t){this.show&&(Cesium.defined(this.commandToExecute)||(this.commandToExecute=this.createCommand(t.context)),Cesium.defined(this.preExecute)&&this.preExecute(),Cesium.defined(this.clearCommand)&&t.commandList.push(this.clearCommand),t.commandList.push(this.commandToExecute))}isDestroyed(){return!1}destroy(){return Cesium.defined(this.commandToExecute)&&(this.commandToExecute.shaderProgram=this.commandToExecute.shaderProgram&&this.commandToExecute.shaderProgram.destroy()),Cesium.destroyObject(this)}}var pL={};
/*! https://mths.be/utf8js v3.0.0 by @mathias */!function(t){!function(t){var e,i,n,r=String.fromCharCode;function o(t){for(var e,i,n=[],r=0,o=t.length;r<o;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<o?56320==(64512&(i=t.charCodeAt(r++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--):n.push(e);return n}function s(t){if(t>=55296&&t<=57343)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}function a(t,e){return r(t>>e&63|128)}function l(t){if(0==(4294967168&t))return r(t);var e="";return 0==(4294965248&t)?e=r(t>>6&31|192):0==(4294901760&t)?(s(t),e=r(t>>12&15|224),e+=a(t,6)):0==(4292870144&t)&&(e=r(t>>18&7|240),e+=a(t,12),e+=a(t,6)),e+=r(63&t|128)}function u(){if(n>=i)throw Error("Invalid byte index");var t=255&e[n];if(n++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function c(){var t,r;if(n>i)throw Error("Invalid byte index");if(n==i)return!1;if(t=255&e[n],n++,0==(128&t))return t;if(192==(224&t)){if((r=(31&t)<<6|u())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if((r=(15&t)<<12|u()<<6|u())>=2048)return s(r),r;throw Error("Invalid continuation byte")}if(240==(248&t)&&(r=(7&t)<<18|u()<<12|u()<<6|u())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}t.version="3.0.0",t.encode=function(t){for(var e=o(t),i=e.length,n=-1,r="";++n<i;)r+=l(e[n]);return r},t.decode=function(t){e=o(t),i=e.length,n=0;for(var s,a=[];!1!==(s=c());)a.push(s);return function(t){for(var e,i=t.length,n=-1,o="";++n<i;)(e=t[n])>65535&&(o+=r((e-=65536)>>>10&1023|55296),e=56320|1023&e),o+=r(e);return o}(a)}}(t)}(pL);var dL=Object.freeze({__proto__:null,IOBuffer:class t{constructor(e=8192,i={}){let n=!1;"number"==typeof e?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const r=i.offset?i.offset>>>0:0,o=e.byteLength-r;let s=r;(ArrayBuffer.isView(e)||e instanceof t)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+r),e=e.buffer),this.lastWrittenByte=n?o:0,this.buffer=e,this.length=o,this.byteLength=o,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,o),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const e=2*(this.offset+t),i=new Uint8Array(e);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){const e=new Uint8Array(t);for(let i=0;i<t;i++)e[i]=this.readByte();return e}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let i=0;i<t;i++)e+=this.readChar();return e}readUtf8(t=1){const e=this.readChars(t);return pL.decode(e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){const e=pL.encode(t);return this.writeChars(e)}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),fL=L(dL),gL={};function mL(t){t.offset%4!=0&&t.skip(4-t.offset%4)}gL.notNetcdf=function(t,e){if(t)throw new TypeError(`Not a valid NetCDF v3.x file: ${e}`)},gL.padding=mL,gL.readName=function(t){var e=t.readUint32(),i=t.readChars(e);return mL(t),i};var _L={},yL={exports:{}};const vL=gL.notNetcdf,CL={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function xL(t,e){if(1!==t){for(var i=new Array(t),n=0;n<t;n++)i[n]=e();return i}return e()}yL.exports=CL,yL.exports.num2str=function(t){switch(Number(t)){case CL.BYTE:return"byte";case CL.CHAR:return"char";case CL.SHORT:return"short";case CL.INT:return"int";case CL.FLOAT:return"float";case CL.DOUBLE:return"double";default:return"undefined"}},yL.exports.num2bytes=function(t){switch(Number(t)){case CL.BYTE:case CL.CHAR:return 1;case CL.SHORT:return 2;case CL.INT:case CL.FLOAT:return 4;case CL.DOUBLE:return 8;default:return-1}},yL.exports.str2num=function(t){switch(String(t)){case"byte":return CL.BYTE;case"char":return CL.CHAR;case"short":return CL.SHORT;case"int":return CL.INT;case"float":return CL.FLOAT;case"double":return CL.DOUBLE;default:return-1}},yL.exports.readType=function(t,e,i){switch(e){case CL.BYTE:return t.readBytes(i);case CL.CHAR:return function(t){if(0===t.charCodeAt(t.length-1))return t.substring(0,t.length-1);return t}(t.readChars(i));case CL.SHORT:return xL(i,t.readInt16.bind(t));case CL.INT:return xL(i,t.readInt32.bind(t));case CL.FLOAT:return xL(i,t.readFloat32.bind(t));case CL.DOUBLE:return xL(i,t.readFloat64.bind(t));default:return void vL(!0,`non valid type ${e}`)}};var wL=yL.exports;const bL=wL;_L.nonRecord=function(t,e){const i=bL.str2num(e.type);for(var n=e.size/bL.num2bytes(i),r=new Array(n),o=0;o<n;o++)r[o]=bL.readType(t,i,1);return r},_L.record=function(t,e,i){const n=bL.str2num(e.type),r=e.size?e.size/bL.num2bytes(n):1;var o=i.length,s=new Array(o);const a=i.recordStep;for(var l=0;l<o;l++){var u=t.offset;s[l]=bL.readType(t,n,r),t.seek(u+a)}return s};const EL=gL,SL=wL;function TL(t){const e=t.readUint32();if(0===e)return EL.notNetcdf(0!==t.readUint32(),"wrong empty tag for list of attributes"),[];{EL.notNetcdf(12!==e,"wrong tag for list of attributes");const l=t.readUint32();for(var i=new Array(l),n=0;n<l;n++){var r=EL.readName(t),o=t.readUint32();EL.notNetcdf(o<1||o>6,`non valid type ${o}`);var s=t.readUint32(),a=SL.readType(t,o,s);EL.padding(t),i[n]={name:r,type:SL.num2str(o),value:a}}}return i}var PL=function(t,e){var i={recordDimension:{length:t.readUint32()}};i.version=e;var n=function(t){var e,i;const n=t.readUint32();if(0===n)return EL.notNetcdf(0!==t.readUint32(),"wrong empty tag for list of dimensions"),[];{EL.notNetcdf(10!==n,"wrong tag for list of dimensions");const a=t.readUint32();for(var r=new Array(a),o=0;o<a;o++){var s=EL.readName(t);const n=t.readUint32();0===n&&(e=o,i=s),r[o]={name:s,size:n}}}return{dimensions:r,recordId:e,recordName:i}}(t);i.recordDimension.id=n.recordId,i.recordDimension.name=n.recordName,i.dimensions=n.dimensions,i.globalAttributes=TL(t);var r=function(t,e,i){const n=t.readUint32();var r=0;if(0===n)return EL.notNetcdf(0!==t.readUint32(),"wrong empty tag for list of variables"),[];{EL.notNetcdf(11!==n,"wrong tag for list of variables");const d=t.readUint32();for(var o=new Array(d),s=0;s<d;s++){var a=EL.readName(t);const n=t.readUint32();for(var l=new Array(n),u=0;u<n;u++)l[u]=t.readUint32();var c=TL(t),h=t.readUint32();EL.notNetcdf(h<1&&h>6,`non valid type ${h}`);const d=t.readUint32();var p=t.readUint32();2===i&&(EL.notNetcdf(p>0,"offsets larger than 4GB not supported"),p=t.readUint32());let f=!1;void 0!==e&&l[0]===e&&(r+=d,f=!0),o[s]={name:a,dimensions:l,attributes:c,type:SL.num2str(h),size:d,offset:p,record:f}}}return{variables:o,recordStep:r}}(t,n.recordId,e);return i.variables=r.variables,i.recordDimension.recordStep=r.recordStep,i};var AL=function(){let t=[];t.push("DIMENSIONS");for(let e of this.dimensions)t.push(`  ${e.name.padEnd(30)} = size: ${e.size}`);t.push(""),t.push("GLOBAL ATTRIBUTES");for(let e of this.globalAttributes)t.push(`  ${e.name.padEnd(30)} = ${e.value}`);let e=JSON.parse(JSON.stringify(this.variables));t.push(""),t.push("VARIABLES:");for(let i of e){i.value=this.getDataVariable(i);let e=JSON.stringify(i.value);e.length>50&&(e=e.substring(0,50)),isNaN(i.value.length)||(e+=` (length: ${i.value.length})`),t.push(`  ${i.name.padEnd(30)} = ${e}`)}return t.join("\n")};const{IOBuffer:IL}=fL,LL=gL,NL=_L,ML=PL,DL=AL;var RL=class{constructor(t){const e=new IL(t);e.setBigEndian(),LL.notNetcdf("CDF"!==e.readChars(3),"should start with CDF");const i=e.readByte();LL.notNetcdf(i>2,"unknown version"),this.header=ML(e,i),this.buffer=e}get version(){return 1===this.header.version?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(t){const e=this.globalAttributes.find((e=>e.name===t));return e?e.value:null}getDataVariableAsString(t){const e=this.getDataVariable(t);return e?e.join(""):null}get variables(){return this.header.variables}toString(){return DL.call(this)}getDataVariable(t){let e;return e="string"==typeof t?this.header.variables.find((function(e){return e.name===t})):t,LL.notNetcdf(void 0===e,`variable not found: ${t}`),this.buffer.seek(e.offset),e.record?NL.record(this.buffer,e,this.header.recordDimension):NL.nonRecord(this.buffer,e)}dataVariableExists(t){return void 0!==this.header.variables.find((function(e){return e.name===t}))}attributeExists(t){return void 0!==this.globalAttributes.find((e=>e.name===t))}},OL=I(RL);let FL;var kL={loadData:async function(t){var e;return await(e=t,new Promise((function(t){const i=new XMLHttpRequest;i.open("GET",e),i.responseType="arraybuffer",i.onload=function(){const e=function(t){return t.reduce((function(t,e){return t[e.name]=e,t}),{})},n=new OL(i.response);FL={};const r=e(n.dimensions);FL.dimensions={},FL.dimensions.lon=r.lon.size,FL.dimensions.lat=r.lat.size,FL.dimensions.lev=r.lev.size;const o=e(n.variables),s=e(o.U.attributes),a=e(o.V.attributes);FL.lon={},FL.lon.array=new Float32Array(n.getDataVariable("lon").flat()),FL.lon.min=Math.min(...FL.lon.array),FL.lon.max=Math.max(...FL.lon.array),FL.lat={},FL.lat.array=new Float32Array(n.getDataVariable("lat").flat()),FL.lat.min=Math.min(...FL.lat.array),FL.lat.max=Math.max(...FL.lat.array),FL.lev={},FL.lev.array=new Float32Array(n.getDataVariable("lev").flat()),FL.lev.min=Math.min(...FL.lev.array),FL.lev.max=Math.max(...FL.lev.array),FL.U={},FL.U.array=new Float32Array(n.getDataVariable("U").flat()),FL.U.min=s.min.value,FL.U.max=s.max.value,FL.V={},FL.V.array=new Float32Array(n.getDataVariable("V").flat()),FL.V.min=a.min.value,FL.V.max=a.max.value,t(FL)},i.send()}))),FL},randomizeParticles:function(t,e){const i=new Float32Array(4*t);for(let n=0;n<t;n++)i[4*n]=Cesium.Math.randomBetween(e.lonRange.x,e.lonRange.y),i[4*n+1]=Cesium.Math.randomBetween(e.latRange.x,e.latRange.y),i[4*n+2]=Cesium.Math.randomBetween(FL.lev.min,FL.lev.max),i[4*n+3]=0;return i}};var zL={loadText:function(t){const e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e.responseText},getFullscreenQuad:function(){return new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}),st:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array([0,0,1,0,1,1,0,1])})}),indices:new Uint32Array([3,2,0,0,2,1])})},createTexture:function(t,e){if(Cesium.defined(e)){const i={};i.arrayBufferView=e,t.source=i}return new Cesium.Texture(t)},createFramebuffer:function(t,e,i){return new Cesium.Framebuffer({context:t,colorTextures:[e],depthTexture:i})},createRawRenderState:function(t){const e={viewport:t.viewport,depthTest:t.depthTest,depthMask:t.depthMask,blending:t.blending};return Cesium.Appearance.getDefaultRenderState(!0,!1,e)},viewRectangleToLonLatRange:function(t){const e={},i=Cesium.Math.mod(t.west,Cesium.Math.TWO_PI),n=Cesium.Math.mod(t.east,Cesium.Math.TWO_PI),r=t.width;let o,s;r>Cesium.Math.THREE_PI_OVER_TWO?(o=0,s=Cesium.Math.TWO_PI):n-i<r?(o=i,s=i+r):(o=i,s=n),e.lon={min:Cesium.Math.toDegrees(o),max:Cesium.Math.toDegrees(s)};const a=t.south,l=t.north,u=t.height;let c=u>Cesium.Math.PI/12?u/2:0,h=Cesium.Math.clampToLatitudeRange(a-c),p=Cesium.Math.clampToLatitudeRange(l+c);return h<-Cesium.Math.PI_OVER_THREE&&(h=-Cesium.Math.PI_OVER_TWO),p>Cesium.Math.PI_OVER_THREE&&(p=Cesium.Math.PI_OVER_TWO),e.lat={min:Cesium.Math.toDegrees(h),max:Cesium.Math.toDegrees(p)},e},_shaderCalculateSpeedFrag:"\n// the size of UV textures: width = lon, height = lat*lev\nuniform sampler2D U; // eastward wind \nuniform sampler2D V; // northward wind\nuniform sampler2D currentParticlesPosition; // (lon, lat, lev)\n\nuniform vec3 dimension; // (lon, lat, lev)\nuniform vec3 minimum; // minimum of each dimension\nuniform vec3 maximum; // maximum of each dimension\nuniform vec3 interval; // interval of each dimension\n\n// used to calculate the wind norm\nuniform vec2 uSpeedRange; // (min, max);\nuniform vec2 vSpeedRange;\nuniform float pixelSize;\nuniform float speedFactor;\n\nfloat speedScaleFactor = speedFactor * pixelSize;\n\nvarying vec2 v_textureCoordinates;\n\nvec2 mapPositionToNormalizedIndex2D(vec3 lonLatLev) {\n    // ensure the range of longitude and latitude\n    lonLatLev.x = mod(lonLatLev.x, 360.0);\n    lonLatLev.y = clamp(lonLatLev.y, -90.0, 90.0);\n\n    vec3 index3D = vec3(0.0);\n    index3D.x = (lonLatLev.x - minimum.x) / interval.x;\n    index3D.y = (lonLatLev.y - minimum.y) / interval.y;\n    index3D.z = (lonLatLev.z - minimum.z) / interval.z;\n\n    // the st texture coordinate corresponding to (col, row) index\n    // example\n    // data array is [0, 1, 2, 3, 4, 5], width = 3, height = 2\n    // the content of texture will be\n    // t 1.0\n    //    |  3 4 5\n    //    |\n    //    |  0 1 2\n    //   0.0------1.0 s\n\n    vec2 index2D = vec2(index3D.x, index3D.z * dimension.y + index3D.y);\n    vec2 normalizedIndex2D = vec2(index2D.x / dimension.x, index2D.y / (dimension.y * dimension.z));\n    return normalizedIndex2D;\n}\n\nfloat getWindComponent(sampler2D componentTexture, vec3 lonLatLev) {\n    vec2 normalizedIndex2D = mapPositionToNormalizedIndex2D(lonLatLev);\n    float result = texture2D(componentTexture, normalizedIndex2D).r;\n    return result;\n}\n\nfloat interpolateTexture(sampler2D componentTexture, vec3 lonLatLev) {\n    float lon = lonLatLev.x;\n    float lat = lonLatLev.y;\n    float lev = lonLatLev.z;\n\n    float lon0 = floor(lon / interval.x) * interval.x;\n    float lon1 = lon0 + 1.0 * interval.x;\n    float lat0 = floor(lat / interval.y) * interval.y;\n    float lat1 = lat0 + 1.0 * interval.y;\n\n    float lon0_lat0 = getWindComponent(componentTexture, vec3(lon0, lat0, lev));\n    float lon1_lat0 = getWindComponent(componentTexture, vec3(lon1, lat0, lev));\n    float lon0_lat1 = getWindComponent(componentTexture, vec3(lon0, lat1, lev));\n    float lon1_lat1 = getWindComponent(componentTexture, vec3(lon1, lat1, lev));\n\n    float lon_lat0 = mix(lon0_lat0, lon1_lat0, lon - lon0);\n    float lon_lat1 = mix(lon0_lat1, lon1_lat1, lon - lon0);\n    float lon_lat = mix(lon_lat0, lon_lat1, lat - lat0);\n    return lon_lat;\n}\n\nvec3 linearInterpolation(vec3 lonLatLev) {\n    // https://en.wikipedia.org/wiki/Bilinear_interpolation\n    float u = interpolateTexture(U, lonLatLev);\n    float v = interpolateTexture(V, lonLatLev);\n    float w = 0.0;\n    return vec3(u, v, w);\n}\n\nvec2 lengthOfLonLat(vec3 lonLatLev) {\n    // unit conversion: meters -> longitude latitude degrees\n    // see https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree for detail\n\n    // Calculate the length of a degree of latitude and longitude in meters\n    float latitude = radians(lonLatLev.y);\n\n    float term1 = 111132.92;\n    float term2 = 559.82 * cos(2.0 * latitude);\n    float term3 = 1.175 * cos(4.0 * latitude);\n    float term4 = 0.0023 * cos(6.0 * latitude);\n    float latLength = term1 - term2 + term3 - term4;\n\n    float term5 = 111412.84 * cos(latitude);\n    float term6 = 93.5 * cos(3.0 * latitude);\n    float term7 = 0.118 * cos(5.0 * latitude);\n    float longLength = term5 - term6 + term7;\n\n    return vec2(longLength, latLength);\n}\n\nvec3 convertSpeedUnitToLonLat(vec3 lonLatLev, vec3 speed) {\n    vec2 lonLatLength = lengthOfLonLat(lonLatLev);\n    float u = speed.x / lonLatLength.x;\n    float v = speed.y / lonLatLength.y;\n    float w = 0.0;\n    vec3 windVectorInLonLatLev = vec3(u, v, w);\n\n    return windVectorInLonLatLev;\n}\n\nvec3 calculateSpeedByRungeKutta2(vec3 lonLatLev) {\n    // see https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages for detail\n    const float h = 0.5;\n\n    vec3 y_n = lonLatLev;\n    vec3 f_n = linearInterpolation(lonLatLev);\n    vec3 midpoint = y_n + 0.5 * h * convertSpeedUnitToLonLat(y_n, f_n) * speedScaleFactor;\n    vec3 speed = h * linearInterpolation(midpoint) * speedScaleFactor;\n\n    return speed;\n}\n\nfloat calculateWindNorm(vec3 speed) {\n    vec3 percent = vec3(0.0);\n    percent.x = (speed.x - uSpeedRange.x) / (uSpeedRange.y - uSpeedRange.x);\n    percent.y = (speed.y - vSpeedRange.x) / (vSpeedRange.y - vSpeedRange.x);\n    float norm = length(percent);\n\n    return norm;\n}\n\nvoid main() {\n    // texture coordinate must be normalized\n    vec3 lonLatLev = texture2D(currentParticlesPosition, v_textureCoordinates).rgb;\n    vec3 speed = calculateSpeedByRungeKutta2(lonLatLev);\n    vec3 speedInLonLat = convertSpeedUnitToLonLat(lonLatLev, speed);\n\n    vec4 particleSpeed = vec4(speedInLonLat, calculateWindNorm(speed / speedScaleFactor));\n    gl_FragColor = particleSpeed;\n}\n",_shaderFullscreenVert:"attribute vec3 position;\nattribute vec2 st;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    textureCoordinate = st;\n    gl_Position = vec4(position, 1.0);\n}",_shaderPostProcessingPositionFrag:"uniform sampler2D nextParticlesPosition;\nuniform sampler2D particlesSpeed; // (u, v, w, norm)\n\n// range (min, max)\nuniform vec2 lonRange;\nuniform vec2 latRange;\n\nuniform float randomCoefficient; // use to improve the pseudo-random generator\nuniform float dropRate; // drop rate is a chance a particle will restart at random position to avoid degeneration\nuniform float dropRateBump;\n\nvarying vec2 v_textureCoordinates;\n\n// pseudo-random generator\nconst vec3 randomConstants = vec3(12.9898, 78.233, 4375.85453);\nconst vec2 normalRange = vec2(0.0, 1.0);\nfloat rand(vec2 seed, vec2 range) {\n    vec2 randomSeed = randomCoefficient * seed;\n    float temp = dot(randomConstants.xy, randomSeed);\n    temp = fract(sin(temp) * (randomConstants.z + temp));\n    return temp * (range.y - range.x) + range.x;\n}\n\nvec3 generateRandomParticle(vec2 seed, float lev) {\n    // ensure the longitude is in [0, 360]\n    float randomLon = mod(rand(seed, lonRange), 360.0);\n    float randomLat = rand(-seed, latRange);\n\n    return vec3(randomLon, randomLat, lev);\n}\n\nbool particleOutbound(vec3 particle) {\n    return particle.y < -90.0 || particle.y > 90.0;\n}\n\nvoid main() {\n    vec3 nextParticle = texture2D(nextParticlesPosition, v_textureCoordinates).rgb;\n    vec4 nextSpeed = texture2D(particlesSpeed, v_textureCoordinates);\n    float speedNorm = nextSpeed.a;\n    float particleDropRate = dropRate + dropRateBump * speedNorm;\n\n    vec2 seed1 = nextParticle.xy + v_textureCoordinates;\n    vec2 seed2 = nextSpeed.xy + v_textureCoordinates;\n    vec3 randomParticle = generateRandomParticle(seed1, nextParticle.z);\n    float randomNumber = rand(seed2, normalRange);\n\n    if (randomNumber < particleDropRate || particleOutbound(nextParticle)) {\n        gl_FragColor = vec4(randomParticle, 1.0); // 1.0 means this is a random particle\n    } else {\n        gl_FragColor = vec4(nextParticle, 0.0);\n    }\n}",_shaderScreenDrawFrag:"uniform sampler2D trailsColorTexture;\nuniform sampler2D trailsDepthTexture;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    vec4 trailsColor = texture2D(trailsColorTexture, textureCoordinate);\n    float trailsDepth = texture2D(trailsDepthTexture, textureCoordinate).r;\n    float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, textureCoordinate));\n\n    if (trailsDepth < globeDepth) {\n        gl_FragColor = trailsColor;\n    } else {\n        gl_FragColor = vec4(0.0);\n    }\n}",_shaderSegmentDragFrag:"\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}\n",_shaderSegmentDrawVert:"attribute vec2 st;\n// it is not normal itself, but used to control lines drawing\nattribute vec3 normal; // (point to use, offset sign, not used component)\n\nuniform sampler2D previousParticlesPosition;\nuniform sampler2D currentParticlesPosition;\nuniform sampler2D postProcessingPosition;\n\nuniform float particleHeight;\n\nuniform float aspect;\nuniform float pixelSize;\nuniform float lineWidth;\n\nstruct adjacentPoints {\n    vec4 previous;\n    vec4 current;\n    vec4 next;\n};\n\nvec3 convertCoordinate(vec3 lonLatLev) {\n    // WGS84 (lon, lat, lev) -> ECEF (x, y, z)\n    // read https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates for detail\n\n    // WGS 84 geometric constants \n    float a = 6378137.0; // Semi-major axis \n    float b = 6356752.3142; // Semi-minor axis \n    float e2 = 6.69437999014e-3; // First eccentricity squared\n\n    float latitude = radians(lonLatLev.y);\n    float longitude = radians(lonLatLev.x);\n\n    float cosLat = cos(latitude);\n    float sinLat = sin(latitude);\n    float cosLon = cos(longitude);\n    float sinLon = sin(longitude);\n\n    float N_Phi = a / sqrt(1.0 - e2 * sinLat * sinLat);\n    float h = particleHeight; // it should be high enough otherwise the particle may not pass the terrain depth test\n\n    vec3 cartesian = vec3(0.0);\n    cartesian.x = (N_Phi + h) * cosLat * cosLon;\n    cartesian.y = (N_Phi + h) * cosLat * sinLon;\n    cartesian.z = ((b * b) / (a * a) * N_Phi + h) * sinLat;\n    return cartesian;\n}\n\nvec4 calculateProjectedCoordinate(vec3 lonLatLev) {\n    // the range of longitude in Cesium is [-180, 180] but the range of longitude in the NetCDF file is [0, 360]\n    // [0, 180] is corresponding to [0, 180] and [180, 360] is corresponding to [-180, 0]\n    lonLatLev.x = mod(lonLatLev.x + 180.0, 360.0) - 180.0;\n    vec3 particlePosition = convertCoordinate(lonLatLev);\n    vec4 projectedCoordinate = czm_modelViewProjection * vec4(particlePosition, 1.0);\n    return projectedCoordinate;\n}\n\nvec4 calculateOffsetOnNormalDirection(vec4 pointA, vec4 pointB, float offsetSign) {\n    vec2 aspectVec2 = vec2(aspect, 1.0);\n    vec2 pointA_XY = (pointA.xy / pointA.w) * aspectVec2;\n    vec2 pointB_XY = (pointB.xy / pointB.w) * aspectVec2;\n\n    float offsetLength = lineWidth / 2.0;\n    vec2 direction = normalize(pointB_XY - pointA_XY);\n    vec2 normalVector = vec2(-direction.y, direction.x);\n    normalVector.x = normalVector.x / aspect;\n    normalVector = offsetLength * normalVector;\n\n    vec4 offset = vec4(offsetSign * normalVector, 0.0, 0.0);\n    return offset;\n}\n\nvec4 calculateOffsetOnMiterDirection(adjacentPoints projectedCoordinates, float offsetSign) {\n    vec2 aspectVec2 = vec2(aspect, 1.0);\n\n    vec4 PointA = projectedCoordinates.previous;\n    vec4 PointB = projectedCoordinates.current;\n    vec4 PointC = projectedCoordinates.next;\n\n    vec2 pointA_XY = (PointA.xy / PointA.w) * aspectVec2;\n    vec2 pointB_XY = (PointB.xy / PointB.w) * aspectVec2;\n    vec2 pointC_XY = (PointC.xy / PointC.w) * aspectVec2;\n\n    vec2 AB = normalize(pointB_XY - pointA_XY);\n    vec2 BC = normalize(pointC_XY - pointB_XY);\n\n    vec2 normalA = vec2(-AB.y, AB.x);\n    vec2 tangent = normalize(AB + BC);\n    vec2 miter = vec2(-tangent.y, tangent.x);\n\n    float offsetLength = lineWidth / 2.0;\n    float projection = dot(miter, normalA);\n    vec4 offset = vec4(0.0);\n    // avoid to use values that are too small\n    if (projection > 0.1) {\n        float miterLength = offsetLength / projection;\n        offset = vec4(offsetSign * miter * miterLength, 0.0, 0.0);\n        offset.x = offset.x / aspect;\n    } else {\n        offset = calculateOffsetOnNormalDirection(PointB, PointC, offsetSign);\n    }\n\n    return offset;\n}\n\nvoid main() {\n    vec2 particleIndex = st;\n\n    vec3 previousPosition = texture2D(previousParticlesPosition, particleIndex).rgb;\n    vec3 currentPosition = texture2D(currentParticlesPosition, particleIndex).rgb;\n    vec3 nextPosition = texture2D(postProcessingPosition, particleIndex).rgb;\n\n    float isAnyRandomPointUsed = texture2D(postProcessingPosition, particleIndex).a +\n        texture2D(currentParticlesPosition, particleIndex).a +\n        texture2D(previousParticlesPosition, particleIndex).a;\n\n    adjacentPoints projectedCoordinates;\n    if (isAnyRandomPointUsed > 0.0) {\n        projectedCoordinates.previous = calculateProjectedCoordinate(previousPosition);\n        projectedCoordinates.current = projectedCoordinates.previous;\n        projectedCoordinates.next = projectedCoordinates.previous;\n    } else {\n        projectedCoordinates.previous = calculateProjectedCoordinate(previousPosition);\n        projectedCoordinates.current = calculateProjectedCoordinate(currentPosition);\n        projectedCoordinates.next = calculateProjectedCoordinate(nextPosition);\n    }\n\n    int pointToUse = int(normal.x);\n    float offsetSign = normal.y;\n    vec4 offset = vec4(0.0);\n    // render lines with triangles and miter joint\n    // read https://blog.scottlogic.com/2019/11/18/drawing-lines-with-webgl.html for detail\n    if (pointToUse == -1) {\n        offset = pixelSize * calculateOffsetOnNormalDirection(projectedCoordinates.previous, projectedCoordinates.current, offsetSign);\n        gl_Position = projectedCoordinates.previous + offset;\n    } else {\n        if (pointToUse == 0) {\n            offset = pixelSize * calculateOffsetOnMiterDirection(projectedCoordinates, offsetSign);\n            gl_Position = projectedCoordinates.current + offset;\n        } else {\n            if (pointToUse == 1) {\n                offset = pixelSize * calculateOffsetOnNormalDirection(projectedCoordinates.current, projectedCoordinates.next, offsetSign);\n                gl_Position = projectedCoordinates.next + offset;\n            } else {\n\n            }\n        }\n    }\n}",_shaderTrailDrawFrag:"uniform sampler2D segmentsColorTexture;\nuniform sampler2D segmentsDepthTexture;\n\nuniform sampler2D currentTrailsColor;\nuniform sampler2D trailsDepthTexture;\n\nuniform float fadeOpacity;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    vec4 pointsColor = texture2D(segmentsColorTexture, textureCoordinate);\n    vec4 trailsColor = texture2D(currentTrailsColor, textureCoordinate);\n\n    trailsColor = floor(fadeOpacity * 255.0 * trailsColor) / 255.0; // make sure the trailsColor will be strictly decreased\n\n    float pointsDepth = texture2D(segmentsDepthTexture, textureCoordinate).r;\n    float trailsDepth = texture2D(trailsDepthTexture, textureCoordinate).r;\n    float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, textureCoordinate));\n\n    gl_FragColor = vec4(0.0);\n    if (pointsDepth < globeDepth) {\n        gl_FragColor = gl_FragColor + pointsColor;\n    }\n    if (trailsDepth < globeDepth) {\n        gl_FragColor = gl_FragColor + trailsColor;\n    }\n    gl_FragDepthEXT = min(pointsDepth, trailsDepth);\n}",_shaderUpdatePosition:"uniform sampler2D currentParticlesPosition; // (lon, lat, lev)\nuniform sampler2D particlesSpeed; // (u, v, w, norm) Unit converted to degrees of longitude and latitude \n\nvarying vec2 v_textureCoordinates;\n\nvoid main() {\n    // texture coordinate must be normalized\n    vec3 lonLatLev = texture2D(currentParticlesPosition, v_textureCoordinates).rgb;\n    vec3 speed = texture2D(particlesSpeed, v_textureCoordinates).rgb;\n    vec3 nextParticle = lonLatLev + speed;\n\n    gl_FragColor = vec4(nextParticle, 0.0);\n}"};class GL{constructor(t,e,i,n){this.createWindTextures(t,e),this.createParticlesTextures(t,i,n),this.createComputingPrimitives(e,i,n)}createWindTextures(t,e){const i={context:t,width:e.dimensions.lon,height:e.dimensions.lat*e.dimensions.lev,pixelFormat:Cesium.PixelFormat.LUMINANCE,pixelDatatype:Cesium.PixelDatatype.FLOAT,flipY:!1,sampler:new Cesium.Sampler({minificationFilter:Cesium.TextureMinificationFilter.NEAREST,magnificationFilter:Cesium.TextureMagnificationFilter.NEAREST})};this.windTextures={U:zL.createTexture(i,e.U.array),V:zL.createTexture(i,e.V.array)}}createParticlesTextures(t,e,i){const n={context:t,width:e.particlesTextureSize,height:e.particlesTextureSize,pixelFormat:Cesium.PixelFormat.RGBA,pixelDatatype:Cesium.PixelDatatype.FLOAT,flipY:!1,sampler:new Cesium.Sampler({minificationFilter:Cesium.TextureMinificationFilter.NEAREST,magnificationFilter:Cesium.TextureMagnificationFilter.NEAREST})},r=kL.randomizeParticles(e.maxParticles,i),o=new Float32Array(4*e.maxParticles).fill(0);this.particlesTextures={previousParticlesPosition:zL.createTexture(n,r),currentParticlesPosition:zL.createTexture(n,r),nextParticlesPosition:zL.createTexture(n,r),postProcessingPosition:zL.createTexture(n,r),particlesSpeed:zL.createTexture(n,o)}}destroyParticlesTextures(){Object.keys(this.particlesTextures).forEach((t=>{this.particlesTextures[t].destroy()}))}createComputingPrimitives(t,e,i){const n=new Cesium.Cartesian3(t.dimensions.lon,t.dimensions.lat,t.dimensions.lev),r=new Cesium.Cartesian3(t.lon.min,t.lat.min,t.lev.min),o=new Cesium.Cartesian3(t.lon.max,t.lat.max,t.lev.max),s=new Cesium.Cartesian3((o.x-r.x)/(n.x-1),(o.y-r.y)/(n.y-1),n.z>1?(o.z-r.z)/(n.z-1):1),a=new Cesium.Cartesian2(t.U.min,t.U.max),l=new Cesium.Cartesian2(t.V.min,t.V.max),u=this;this.primitives={calculateSpeed:new hL({commandType:"Compute",uniformMap:{U:function(){return u.windTextures.U},V:function(){return u.windTextures.V},currentParticlesPosition:function(){return u.particlesTextures.currentParticlesPosition},dimension:function(){return n},minimum:function(){return r},maximum:function(){return o},interval:function(){return s},uSpeedRange:function(){return a},vSpeedRange:function(){return l},pixelSize:function(){return i.pixelSize},speedFactor:function(){return e.speedFactor}},fragmentShaderSource:new Cesium.ShaderSource({sources:[zL._shaderCalculateSpeedFrag]}),outputTexture:this.particlesTextures.particlesSpeed,preExecute:function(){let t;t=u.particlesTextures.previousParticlesPosition,u.particlesTextures.previousParticlesPosition=u.particlesTextures.currentParticlesPosition,u.particlesTextures.currentParticlesPosition=u.particlesTextures.postProcessingPosition,u.particlesTextures.postProcessingPosition=t,u.primitives.calculateSpeed.commandToExecute.outputTexture=u.particlesTextures.particlesSpeed}}),updatePosition:new hL({commandType:"Compute",uniformMap:{currentParticlesPosition:function(){return u.particlesTextures.currentParticlesPosition},particlesSpeed:function(){return u.particlesTextures.particlesSpeed}},fragmentShaderSource:new Cesium.ShaderSource({sources:[zL._shaderUpdatePosition]}),outputTexture:this.particlesTextures.nextParticlesPosition,preExecute:function(){u.primitives.updatePosition.commandToExecute.outputTexture=u.particlesTextures.nextParticlesPosition}}),postProcessingPosition:new hL({commandType:"Compute",uniformMap:{nextParticlesPosition:function(){return u.particlesTextures.nextParticlesPosition},particlesSpeed:function(){return u.particlesTextures.particlesSpeed},lonRange:function(){return i.lonRange},latRange:function(){return i.latRange},randomCoefficient:function(){return Math.random()},dropRate:function(){return e.dropRate},dropRateBump:function(){return e.dropRateBump}},fragmentShaderSource:new Cesium.ShaderSource({sources:[zL._shaderPostProcessingPositionFrag]}),outputTexture:this.particlesTextures.postProcessingPosition,preExecute:function(){u.primitives.postProcessingPosition.commandToExecute.outputTexture=u.particlesTextures.postProcessingPosition}})}}}class BL{constructor(t,e,i,n,r){this.createRenderingTextures(t,e),this.createRenderingFramebuffers(t),this.createRenderingPrimitives(t,i,n,r)}createRenderingTextures(t,e){const i={context:t,width:t.drawingBufferWidth,height:t.drawingBufferHeight,pixelFormat:Cesium.PixelFormat.RGBA,pixelDatatype:Cesium.PixelDatatype.UNSIGNED_BYTE},n={context:t,width:t.drawingBufferWidth,height:t.drawingBufferHeight,pixelFormat:Cesium.PixelFormat.DEPTH_COMPONENT,pixelDatatype:Cesium.PixelDatatype.UNSIGNED_INT};this.textures={segmentsColor:zL.createTexture(i),segmentsDepth:zL.createTexture(n),currentTrailsColor:zL.createTexture(i),currentTrailsDepth:zL.createTexture(n),nextTrailsColor:zL.createTexture(i),nextTrailsDepth:zL.createTexture(n)}}createRenderingFramebuffers(t){this.framebuffers={segments:zL.createFramebuffer(t,this.textures.segmentsColor,this.textures.segmentsDepth),currentTrails:zL.createFramebuffer(t,this.textures.currentTrailsColor,this.textures.currentTrailsDepth),nextTrails:zL.createFramebuffer(t,this.textures.nextTrailsColor,this.textures.nextTrailsDepth)}}createSegmentsGeometry(t){let e=[];for(let i=0;i<t.particlesTextureSize;i++)for(let n=0;n<t.particlesTextureSize;n++)for(let r=0;r<6;r++)e.push(i/t.particlesTextureSize),e.push(n/t.particlesTextureSize);e=new Float32Array(e);let i=[];const n=[-1,0,1],r=[-1,1];for(let e=0;e<t.maxParticles;e++)for(let t=0;t<n.length;t++)for(let e=0;e<r.length;e++)i.push(n[t]),i.push(r[e]),i.push(0);i=new Float32Array(i);const o=12*t.maxParticles;let s=new Uint32Array(o);for(let e=0,i=0,n=0;e<t.maxParticles;e++)s[i++]=n+0,s[i++]=n+1,s[i++]=n+2,s[i++]=n+2,s[i++]=n+1,s[i++]=n+3,s[i++]=n+2,s[i++]=n+4,s[i++]=n+3,s[i++]=n+4,s[i++]=n+3,s[i++]=n+5,n+=6;return new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({st:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:e}),normal:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:i})}),indices:s})}createRenderingPrimitives(t,e,i,n){const r=this;this.primitives={segments:new hL({commandType:"Draw",attributeLocations:{st:0,normal:1},geometry:this.createSegmentsGeometry(e),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{previousParticlesPosition:function(){return n.particlesTextures.previousParticlesPosition},currentParticlesPosition:function(){return n.particlesTextures.currentParticlesPosition},postProcessingPosition:function(){return n.particlesTextures.postProcessingPosition},aspect:function(){return t.drawingBufferWidth/t.drawingBufferHeight},pixelSize:function(){return i.pixelSize},lineWidth:function(){return e.lineWidth},particleHeight:function(){return e.particleHeight},color:function(){return e.color}},vertexShaderSource:new Cesium.ShaderSource({sources:[zL._shaderSegmentDrawVert]}),fragmentShaderSource:new Cesium.ShaderSource({sources:[zL._shaderSegmentDragFrag]}),rawRenderState:zL.createRawRenderState({viewport:void 0,depthTest:{enabled:!0},depthMask:!0}),framebuffer:this.framebuffers.segments,autoClear:!0}),trails:new hL({commandType:"Draw",attributeLocations:{position:0,st:1},geometry:zL.getFullscreenQuad(),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{segmentsColorTexture:function(){return r.textures.segmentsColor},segmentsDepthTexture:function(){return r.textures.segmentsDepth},currentTrailsColor:function(){return r.framebuffers.currentTrails.getColorTexture(0)},trailsDepthTexture:function(){return r.framebuffers.currentTrails.depthTexture},fadeOpacity:function(){return e.fadeOpacity}},vertexShaderSource:new Cesium.ShaderSource({defines:["DISABLE_GL_POSITION_LOG_DEPTH"],sources:[zL._shaderFullscreenVert]}),fragmentShaderSource:new Cesium.ShaderSource({defines:["DISABLE_LOG_DEPTH_FRAGMENT_WRITE"],sources:[zL._shaderTrailDrawFrag]}),rawRenderState:zL.createRawRenderState({viewport:void 0,depthTest:{enabled:!0,func:Cesium.DepthFunction.ALWAYS},depthMask:!0}),framebuffer:this.framebuffers.nextTrails,autoClear:!0,preExecute:function(){let t;t=r.framebuffers.currentTrails,r.framebuffers.currentTrails=r.framebuffers.nextTrails,r.framebuffers.nextTrails=t,r.primitives.trails.commandToExecute.framebuffer=r.framebuffers.nextTrails,r.primitives.trails.clearCommand.framebuffer=r.framebuffers.nextTrails}}),screen:new hL({commandType:"Draw",attributeLocations:{position:0,st:1},geometry:zL.getFullscreenQuad(),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{trailsColorTexture:function(){return r.framebuffers.nextTrails.getColorTexture(0)},trailsDepthTexture:function(){return r.framebuffers.nextTrails.depthTexture}},vertexShaderSource:new Cesium.ShaderSource({defines:["DISABLE_GL_POSITION_LOG_DEPTH"],sources:[zL._shaderFullscreenVert]}),fragmentShaderSource:new Cesium.ShaderSource({defines:["DISABLE_LOG_DEPTH_FRAGMENT_WRITE"],sources:[zL._shaderScreenDrawFrag]}),rawRenderState:zL.createRawRenderState({viewport:void 0,depthTest:{enabled:!1},depthMask:!0,blending:{enabled:!0}}),framebuffer:void 0})}}}class UL{constructor(t,e,i,n){this.context=t,this.data=e,this.userInput=i,this.viewerParameters=n,this.particlesComputing=new GL(this.context,this.data,this.userInput,this.viewerParameters),this.particlesRendering=new BL(this.context,this.data,this.userInput,this.viewerParameters,this.particlesComputing)}canvasResize(t){this.particlesComputing.destroyParticlesTextures(),Object.keys(this.particlesComputing.windTextures).forEach((t=>{this.particlesComputing.windTextures[t].destroy()})),Object.keys(this.particlesRendering.framebuffers).forEach((t=>{this.particlesRendering.framebuffers[t].destroy()})),this.context=t,this.particlesComputing=new GL(this.context,this.data,this.userInput,this.viewerParameters),this.particlesRendering=new BL(this.context,this.data,this.userInput,this.viewerParameters,this.particlesComputing)}clearFramebuffers(){const t=new Cesium.ClearCommand({color:new Cesium.Color(0,0,0,0),depth:1,framebuffer:void 0,pass:Cesium.Pass.OPAQUE});Object.keys(this.particlesRendering.framebuffers).forEach((e=>{t.framebuffer=this.particlesRendering.framebuffers[e],t.execute(this.context)}))}refreshParticles(t){if(this.clearFramebuffers(),this.particlesComputing.destroyParticlesTextures(),this.particlesComputing.createParticlesTextures(this.context,this.userInput,this.viewerParameters),t){const t=this.particlesRendering.createSegmentsGeometry(this.userInput);this.particlesRendering.primitives.segments.geometry=t;const e=Cesium.VertexArray.fromGeometry({context:this.context,geometry:t,attributeLocations:this.particlesRendering.primitives.segments.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW});this.particlesRendering.primitives.segments.commandToExecute.vertexArray=e}}applyUserInput(t){let e=!1;this.userInput.maxParticles!=t.maxParticles&&(e=!0),Object.keys(t).forEach((e=>{this.userInput[e]=t[e]})),this.refreshParticles(e)}applyViewerParameters(t){Object.keys(t).forEach((e=>{this.viewerParameters[e]=t[e]})),this.refreshParticles(!1)}}const{Cartesian2:VL,Cartesian3:HL,BoundingSphere:WL,PrimitiveCollection:jL,Color:qL}=Cesium;const YL="\nvec4 czm_p_toEye(vec2 uv,float depth){\n  vec4 eyeCoordinate = czm_windowToEyeCoordinates(uv, depth);\n  return eyeCoordinate/eyeCoordinate.w;\n}\nvec4 czm_p_toEye(in vec2 uv, in sampler2D depthTexture){\n    float depth=czm_p_getDepth(texture2D(depthTexture, uv));\n    vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n    vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n    posInCamera =posInCamera / posInCamera.w;\n    return posInCamera;\n}\n",XL="\nfloat czm_p_getDepth(in vec4 depth){\n  float z_window = czm_unpackDepth(depth);\n  z_window = czm_reverseLogDepth(z_window);\n  float n_range = czm_depthRange.near;\n  float f_range = czm_depthRange.far;\n  return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}";var $L="struct czm_ellipsoid\n{\n    vec3 center;\n    vec3 radii;\n    vec3 inverseRadii;\n    vec3 inverseRadiiSquared;\n};";const JL="czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\n    vec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\n    vec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\n    vec3 inverseRadiiSquared = inverseRadii * inverseRadii;\n    czm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\n    return temp;\n}",QL="vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\n    // Diffuse from directional light sources at eye (for top-down and horizon views)\n    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\n\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n    }\n\n    diffuse = clamp(diffuse, 0.0, 1.0);\n\n    // Specular from sun and pseudo-moon\n    float specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\n    specular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n/**\n * @private\n */\nvec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    // Diffuse from directional light sources at eye (for top-down and horizon views)\n    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\n\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n    }\n\n    diffuse = clamp(diffuse, 0.0, 1.0);\n\n    float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n\n",ZL="\n//low version cesium.\nfloat czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\n    return czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\n\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\n    return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\n\n/**\n * Computes a color using the Phong lighting model.\n *\n * @name czm_phong\n * @glslFunction\n *\n * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.\n * @param {czm_material} material The fragment's material.\n *\n * @returns {vec4} The computed color.\n *\n * @example\n * vec3 positionToEyeEC = // ...\n * czm_material material = // ...\n * gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n *\n * @see czm_getMaterial\n */\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\n    // Diffuse from directional light sources at eye (for top-down)\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n    }\n\n    // Specular from sun and pseudo-moon\n    float specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse;\n    color += material.specular * specular;\n\n#ifdef HDR\n    float sunDiffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\n    color += materialDiffuse * sunDiffuse * czm_sunColor;\n#endif\n\n    return vec4(color, material.alpha);\n}\n\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\n    float specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\n\n    vec3 ambient = vec3(0.0);\n    vec3 color = ambient + material.emission;\n    color += material.diffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n//high version Cesium\n\n/**\n * Computes a color using the Phong lighting model.\n *\n * @name czm_phong\n * @glslFunction\n *\n * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.\n * @param {czm_material} material The fragment's material.\n *\n * @returns {vec4} The computed color.\n *\n * @example\n * vec3 positionToEyeEC = // ...\n * czm_material material = // ...\n * vec3 lightDirectionEC = // ...\n * gl_FragColor = czm_phong(normalize(positionToEyeEC), material, lightDirectionEC);\n *\n * @see czm_getMaterial\n */\nvec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    // Diffuse from directional light sources at eye (for top-down)\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n    }\n\n    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n\nvec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);\n    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);\n\n    vec3 ambient = vec3(0.0);\n    vec3 color = ambient + material.emission;\n    color += material.diffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n",KL="bool czm_p_inClipRegion(vec3 positionEC);",tN={czm_p_toEye:YL,czm_p_getDepth:XL,czm_ellipsoid:$L,czm_getWgs84EllipsoidEC:JL,czm_translucentPhong:QL,czm_phong:ZL,czm_p_inClipRegion:KL};function eN(){for(var t in tN)tN.hasOwnProperty(t)&&(Cesium.ShaderSource._czmBuiltinsAndUniforms[t]=tN[t])}eN();t.AnalyserUtil=Vl,t.ArcGisLayer=MS,t.ArrowPlot=DT,t.AxisPlane=Bp,t.BaiDuLayer=class extends $y{constructor(t){(t=Fl(t,{})).url=Fl(t.url,"http://maponline{s}.bdimg.com/tile/?qt=vtile&styles=pl&scaler=1&udt=20200102"),t.customid&&(t.url=`https://api.map.baidu.com/customimage/tile?customid=${t.customid}`);const e=new Cesium.Cartesian2(-OS,-RS),i=new Cesium.Cartesian2(OS,RS);t.tilingScheme=new Cesium.WebMercatorTilingScheme({rectangleSouthwestInMeters:e,rectangleNortheastInMeters:i}),t.subdomains="123",super(t)}get rectangle(){return this.tilingScheme.rectangle}requestImage(t,e,i){const n=function(t,e,i,n){let r=t.url+"&x={x}&y={y}&z={z}";const o=t._tilingScheme.getNumberOfXTilesAtLevel(n),s=t._tilingScheme.getNumberOfYTilesAtLevel(n),a=4*Math.random()|0;return r=r.replace("{s}",a).replace("{x}",e-o/2).replace("{y}",s/2-i-1).replace("{z}",n),r}(this,t,e,i);return Cesium.ImageryProvider.loadImage(this,n)}},t.BaseAnalyser=Yl,t.BasePlot=$S,t.BingLayer=zS,t.BufferAnalyser=class extends Yl{constructor(t,e={}){super(t),this._graphics=e.graphics,this._steps=Fl(e.steps,8),this._bufferRadius=Fl(e.bufferRadius,100),this._material=Fl(e.material,Cesium.Color.GOLD.withAlpha(.6)),this._heightReference=Fl(e.heightReference,Cesium.HeightReference.NONE),this._buffered=[],this._root=new eu("buffer-analysis"),t.dataSources.add(this._root)}get bufferRadius(){return this._bufferRadius}set bufferRadius(t){(t=parseFloat(t))<0||(this._bufferRadius=t)}get steps(){this._steps}set steps(t){this._steps=t}get material(){return this._material}set material(t){this._material=t}setGraphic(t){Array.isArray(t)||(t=[t]),this._graphics=t.filter((t=>t instanceof Xl))}do(){this.preAnalysis.raise();const t=this._graphics;if(!Array.isArray(t)||t.length,!Array.isArray(t)||!t.length)return;let e;const i=[];for(let e of t){const t=e.geometry;let n=this._bufferRadius;e.properties&&kl(e.properties.bufferRadius)&&(n=e.properties.bufferRadius),n/=1e3;const r=Al(t,n,{steps:this._steps,units:"kilometers",radius:n});i.push(r)}let n;if(i.length>1){let t=i[0];for(let e=1;e<i.length;e++)t=Dl(t,i[e]);e=Ql.toEntity(t)}else n=i,e=Ql.toEntity(n[0]);if(kl(e)){for(let t of e)t.polygon.material=this._material,t.polygon.heightReference=this._heightReference,this._root.add(t);this.postAnalysis.raise(e)}else this.postAnalysis.raise()}clear(){this._root.removeAll()}zoomTo(){this._viewer&&this._viewer.flyTo(this._root.entities)}destroy(){this._viewer.dataSources.remove(this._root),this._viewer=void 0,super.destroy()}},t.Cartometry=iu,t.CartometryManager=class{constructor(t,e={}){const{labelStyle:i,polylineStyle:n,polygonStyle:r,pointStyle:o}=e;Hl(t),this._viewer=t;const s=AT.defaultLabelStyle;s.disableDepthTestDistance=Number.POSITIVE_INFINITY,this._labelStyle=Fl(i,s),this._polylineStyle=Fl(n,IT.defaultStyle),this._polygonStyle=Fl(r,LT.defaultStyle),this._pointStyle=Fl(o,AT.defaultStyle),this._startMeasure=new jl,this._stopMeasure=new jl,this._addNode=new jl,this.formatText=Fl(e.formatText,NT);this._nodeMode=Fl(e.nodeMode,{distance:!0,area:!1,height:!1,angle:!1}),this._auxiliaryGeometry=Fl(e.auxiliaryGeometry,{distance:!0,area:!1,height:!0,angle:!0});const a=new Cesium.ScreenSpaceEventHandler(t.canvas);this._handler=a,this._values={},this._mode=Fl(e.mode,Vp.SURFACE_DISTANCE),this._showTip=Fl(e.showTip,!0),this._showTip&&(this._tip=new Km,this._tip.show=!1),this._autoDepthTest=Fl(e.autoDepthTest,!0),this.listening=!1;const l=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.RED});this._auxiliarylineMaterial=Fl(e.auxiliaryLineMaterial,l);const u=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.RED});this._depthTestAgainstTerrain=this._viewer.scene.globe.depthTestAgainstTerrain,this._auxiliaryPolygonMaterial=Fl(e.auxiliaryPolygonMaterial,u)}get viewer(){return this.viewer}get labelStyle(){return this._labelStyle}set labelStyle(t){this._labelStyle=t}get polylineStyle(){return this._polylineStyle}set polylineStyle(t){this._polylineStyle=t}get polygonStyle(){return this._polygonStyle}set polygonStyle(t){this._polygonStyle=t}get pointStyle(){return this._pointStyle}set pointStyle(t){this._pointStyle=t}get startMeasure(){return this._startMeasure}get stopMeasure(){return this._stopMeasure}get addNode(){return this._addNode}get tip(){return this._tip}get mode(){return this._mode}set mode(t){Vp.validate(t)?this._mode=t:console.warn("CartometryManaer:无效的测量模式")}addEventListener(t,e=[]){this._listening=!0;const i=Vp.getKey(t),n=/.*_?(distance|area|height|angle)$/.exec(i.toLowerCase());let r=!1,o=!1;n&&n[1]&&(r=this._nodeMode[n[1]],o=this._auxiliaryGeometry[n[1]]);const s=this._handler;s.setInputAction((i=>{const n=this.pickPosition(i.position);if(n&&e.push(n),r&&this.createNode(n),o&&this.createAuxiliaryGraphic(e,n,t),this.addNode.raise({mode:t,position:n,id:this.gid}),(t===Vp.HEIGHT||t===Vp.ANGLE)&&(this.tip&&1===e.length&&(this.tip.text="单击地图确定终点."),2===e.length)){this.removeEventListener();let i,n=e[0];if(t===Vp.HEIGHT){i=this.getHeight(e);const t=zl.fromCartesian(e[0]),r=zl.fromCartesian(e[1]),o=t.alt<r.alt?t:r;n=Cesium.Cartesian3.fromDegrees(o.lon,o.lat,(r.alt+t.alt)/2)}else i=this.getAngle(e);this.createLabel(n,i),this.stopMeasure.raise({mode:t,label:i,graphic:this._values[this.gid],id:this.gid})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction((i=>{if(this.tip&&(this.tip.position=i.endPosition),t===Vp.HEIGHT||t===Vp.ANGLE)return;const n=this.pickPosition(i.endPosition);e.length>1&&n&&e.pop(),e.length>0&&n&&e.push(n)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),s.setInputAction((i=>{const n=this.pickPosition(i.position);let o;this.removeEventListener(),r&&n&&this.createNode(n),!n||t===Vp.HEIGHT&&t===Vp.ANGLE||(e.pop(),e.length&&n&&e.push(n),this.addNode.raise({mode:t,position:n,id:this.gid})),t!==Vp.SURFACE_DISTANCE&&t!==Vp.SPACE_DISTANCE||(o=this.getDistance(e,t),this.createLabel(n||e[e.length-1],o,new Cesium.Cartesian2(0,35))),t!==Vp.SURFACE_AREA&&t!==Vp.SPACE_AREA||(o=this.getArea(e,t),this.createLabel(n||e[e.length-1],o)),this.stopMeasure.raise({mode:t,label:o,graphic:this._values[this.gid],id:this.gid})}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)}removeEventListener(){const t=this._handler;t.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),t.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),t.removeInputAction(Cesium.ScreenSpaceEventType.RIGHT_CLICK),this._listening=!1,this.tip&&(this.tip.show=!1),this._autoDepthTest&&(this._viewer.depthTest=this._depthTestAgainstTerrain)}clear(){const t=Object.values(this._values);for(const e of t)for(let t of e)this._viewer.entities.remove(t);this._values={}}destroy(){this.clear(),this.removeEventListener(),this._handler.isDestroyed()||this._handler.destroy(),this._viewer=undefinesd}getDistance(t,e){if(t.length<2||!t[0]||!t[1])return"起点";let i;return e===Vp.SURFACE_DISTANCE?i=iu.surfaceDistance(t):e===Vp.SPACE_DISTANCE&&(i=iu.spaceDistance(t)),this.formatText(i,e,!this._listening)}getArea(t,e){let i;return i=e===Vp.SURFACE_AREA?iu.surfaceArea(t):iu.spaceArea(t),this.formatText(i,e,!this._listening)}getHeight(t){const e=iu.heightFromCartesianArray(t);return this.formatText(Math.abs(e[0]),Vp.HEIGHT)}getAngle(t,e){const i=iu.angleBetweenNorth(t[0],t[1]);return this.formatText(i,Vp.ANGLE)}do(t,e=[]){this._depthTestAgainstTerrain||(this._autoDepthTest?this._viewer.depthTest=!0:console.warn("depthTestAgainstTerrain未开启,点位获取可能不准确.")),this.tip&&(this.tip.show=!0),t=Fl(t,this.mode);if(!Vp.validate(t))return void console.warn("无效的测量模式");let i;this.gid=ql(),this._values[this.gid]=[],this.tip&&(t===Vp.HEIGHT||t===Vp.ANGLE?this.tip.text="单击地图确定起点.":this.tip.text="单击地图添加节点，右击地图结束量算"),this.startMeasure.raise({mode:t,id:this.gid}),t===Vp.SPACE_DISTANCE||t===Vp.HEIGHT?(i=this.polylineStyle,i.clampToGround=!1,i.positions=new Cesium.CallbackProperty((()=>e),!1),this.createPolyline(i)):t===Vp.SURFACE_DISTANCE||t===Vp.ANGLE?(i=this.polylineStyle,i.clampToGround=!0,i.positions=new Cesium.CallbackProperty((()=>e),!1),this.createPolyline(i)):t===Vp.SPACE_AREA?(i=this.polygonStyle,i.outline=!1,i.perPositionHeight=!0,i.heightReference=Cesium.HeightReference.NONE,i.hierarchy=new Cesium.CallbackProperty((()=>new Cesium.PolygonHierarchy(e)),!1),this.createPolygon(i)):t===Vp.SURFACE_AREA&&(i=this.polygonStyle,i.perPositionHeight=!1,i.heightReference=Cesium.HeightReference.CLAMP_TO_GROUND,i.hierarchy=new Cesium.CallbackProperty((()=>new Cesium.PolygonHierarchy(e)),!1),this.createPolygon(i)),this.addEventListener(t,e)}surfaceDistance(){this.do(Vp.SURFACE_DISTANCE)}spaceDistance(){this.do(Vp.SPACE_DISTANCE)}surfaceArea(){this.do(Vp.SURFACE_AREA)}spaceArea(){this.do(Vp.SPACE_AREA)}height(){this.do(Vp.HEIGHT)}angle(){this.do(Vp.ANGLE)}pickPosition(t){const e=this._viewer;let i;const n=e.camera.getPickRay(t);i=e.scene.globe.pick(n,e.scene);return e.scene.pick(t)&&(e.scene.pickPositionSupported?i=e.scene.pickPosition(t):console.warn("This browser does not support pickPosition.")),i}createNode(t){if(!t)return;const e=this.pointStyle,i=this._viewer.entities.add({position:t,point:e});return this._values[this.gid].push(i),i}createLabel(t,e,i=new Cesium.Cartesian2){const n=this.labelStyle;n.text=e,n.pixelOffset=i;const r={position:t,label:n},o=this._viewer.entities.add(r);return this._values[this.gid].push(o),o}createPolygon(t){const e=this._viewer.entities.add({polygon:t});return this._values[this.gid].push(e),e}createPolyline(t){const e=this._viewer.entities.add({polyline:t});return this._values[this.gid].push(e),e}_createAuxiliaryGraphicforHeight(t){if(2!==t.length)return;const e=zl.fromCartesian(t[0]),i=zl.fromCartesian(t[1]);let n,r;e.alt<i.alt?(n=e,r=i):(n=i,r=e);const o=new zl(n.lon,n.lat,r.alt),s=[t[0],o.toCartesian(),t[1]],a=this._viewer.entities.add({polyline:{positions:s,material:this._auxiliarylineMaterial,width:this.polylineStyle.width||3}});this._values[this.gid].push(a)}_createAuxiliaryGraphicforDisgance(t,e){this.createLabel(t,e)}_createAuxiliaryGraphicforAngle(t){if(2!==t.length)return;const e=iu.spaceDistance(t),i=new Cesium.Transforms.eastNorthUpToFixedFrame(t[0]),n=new Cesium.Matrix4;Cesium.Matrix4.inverseTransformation(i,n);const r=Cesium.Matrix4.multiplyByPoint(i,new Cesium.Cartesian3(0,e,0),new Cesium.Cartesian3),o={polyline:{positions:[t[0],r],material:this._auxiliarylineMaterial,width:this.polylineStyle.width||3,clampToGround:!0}},s=this._viewer.entities.add(o);this._values[this.gid].push(s)}createAuxiliaryGraphic(t,e,i){if(i===Vp.SPACE_DISTANCE||i===Vp.SURFACE_DISTANCE){const{length:n}=t,r=this.getDistance([t[n-3],t[n-2]],i);this._createAuxiliaryGraphicforDisgance(e,r)}else i===Vp.HEIGHT?this._createAuxiliaryGraphicforHeight(t):i===Vp.ANGLE&&this._createAuxiliaryGraphicforAngle(t)}callback(t,e,i){}},t.CartometryType=Vp,t.CesiumProError=Ol,t.CesiumProTerrainProvider=pd,t.CircleScanGraphic=class extends tE{constructor(t){super(t),this._speed=Fl(t.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(t){this._speed!==t&&(t<=0&&(this._speed=0),this.definedChanged.raise("speed",t,this._speed),this._speed=t)}createAppearance(){return this._appearance||(this._appearance=new iE({material:new nE({translucent:!0,fabric:{uniforms:{image:kd.buildModuleUrl("./assets/images/radarScan.png"),stRotation:Cesium.Matrix2.IDENTITY,color:this._color,time:0},source:eE}})})),this._appearance}update(t){if(!this.material)return;if(0===this.speed)return void(this.material.uniforms.time=0);const e=Cesium.JulianDate.toDate(t).getTime()*this.speed,i=e%360,n=Cesium.Matrix2.fromRotation(Cesium.Math.toRadians(-i));this.material.uniforms.stRotation={x:n[0],y:n[1],z:n[2],w:n[3]},this.material.uniforms.time=e-parseInt(e)}},t.CircleSpreadGraphic=class extends tE{constructor(t){super(t),this._speed=Fl(t.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(t){t!==this._speed&&(t<0&&(t=0),this.definedChanged.raise("speed",t,this._speed),this._speed=t)}createAppearance(){return this._appearance||(this._appearance=new oE({material:new sE({translucent:!0,fabric:{uniforms:{color:this._color,time:0},source:rE}})})),this._appearance}update(t){if(!this.material)return;const e=Cesium.JulianDate.toDate(t).getTime()*this.speed*.001;this.material.uniforms.time=e-parseInt(e)}},t.ClipRegion=Vu,t.ClipRegionCollection=Td,t.Cluster=class{constructor(t,e={}){this._objects=Fl(e.objects,[]),this._getScreenBoundingBox=Fl(e.getScreenBoundingBox,Zd),this._scene=t,this.clusterSize=3,this.pixelRange=50,this._clusterObjects=[]}get objects(){return this._objects}set objects(t){this._objects=t}_clearCluster(){this._objects.map((t=>t.cluster=!1)),this._clusterObjects=[]}update(){const t=this._objects;this._clearCluster();const e=function(t,e){const i=[],n=new $d(e.globe.ellipsoid,e.camera.positionWC);for(let r of t)r.position&&(e.mode!==Xd.SCENE3D||n.isPointVisible(r.position))&&(r.__pixel=Cesium.SceneTransforms.wgs84ToWindowCoordinates(e,r.position),r.__pixel&&i.push(r));return i}(t,this._scene),i=new Hd(e,Jd,Qd,64,Int32Array);for(let t of e){if(t.cluster)continue;const n=this._getScreenBoundingBox(t,t.__pixel),r=Yd.clone(n,new Yd);t.cluster=!0;const o=i.range(n.x,n.y,n.x+n.width,n.y+n.height),s=o.length,a=Wd.clone(t.position);let l,u=1;const c=[];for(let t=0;t<s;t++){const i=e[o[t]];if(i.cluster)continue;c.push(i.id),i.cluster=!0;const n=this._getScreenBoundingBox(i,i.__pixel);Wd.add(i.position,a,a),Yd.union(r,n,r),u++,l=i}u>=this.clusterSize?(Wd.multiplyByScalar(a,1/u,a),this._clusterObjects.push({position:new Wd(a.x,a.y,a.z),number:u,ids:c,id:l.id+u})):this._clusterObjects.push(t)}}},t.ContextMenu=rf,t.CursorTip=Km,t.CustomDataSource=eu,t.CylinderGeometry=EE,t.DefaultDataSource=Lb,t.DivGraphic=class{constructor(t={}){if(!t.position)throw new Ol("paramerter position must be provided.");if(!t.element)throw new Ol("parameter element must be provided.");this._show=Fl(t.show,!0),this._element=element}get show(){return this._show}set show(t){this._show=t,this._element.style.display=t?"block":"none"}get element(){return this.element}},t.DynamicConeGraphic=class extends tE{constructor(t){super(t),this._speed=Fl(t.speed,1),this._image=Fl(t.image,kd.buildModuleUrl("assets/img/particle.png")),this._appearance={},this._length=t.length,this._primitive=new kE,this._primitive.name="DynamicConeGraphic",this._asynchronous=!1,this.createGraphic()}get speed(){return this._speed}set speed(t){if(t===this._speed)return;if(t<=0)throw new Ol("速度不能小于0");this.definedChanged.raise("speed",t,this._speed),this._speed=t;const e=Object.values(this._appearance);for(let i of e){i.material.uniforms.speed=t}}get length(){return this._length}set length(t){t!==this._length&&(this.definedChanged.raise("length",t,this._length),this._length=t,this.updatePrimitive())}updatePrimitive(){if(!this._viewer)return;this.primitive.removeAll(),this.createGraphic()}updateAttribute(t,e){if(this.isDestroyed())return;if(!this.primitive)return;const i=this.primitive._primitives;for(let n of i)super.updateAttribute.call({primitive:n,isDestroyed:this.isDestroyed},t,e)}createGraphic(){const t=this.createAppearance(AE),e=this.createAppearance(IE),i=this.createAppearance(LE),n=this.createAppearance(NE);this._clampToGround?(this.createCircleGroundPrimitive(t,this._asynchronous),this.createCircleGroundPrimitive(e,this._asynchronous),this.createCylinder(0,.35*this._radius,i,this._asynchronous),this.createCylinder(.1*this._radius,.45*this._radius,n,this._asynchronous,.8)):(this.createCirclePrimitive(t,this._asynchronous),this.createCirclePrimitive(e,this._asynchronous),this.createCylinder(0,.35*this._radius,i,this._asynchronous),this.createCylinder(.1*this._radius,.45*this._radius,n,this._asynchronous,.8))}createCylinder(t,e,i,n=!0,r=1){if(this.isDestroyed())return;const o=Fl(this._length,.35*this._radius*8)*r,s=GE.eastNorthUpToFixedFrame(zl.toCartesian(this._position)),a=BE.fromTranslation(new UE(0,0,o/2+this._height));BE.multiply(s,a,s);const l=new EE({bottomRadius:e,topRadius:t,length:o}),u=new OE({geometryInstances:new FE({geometry:l,id:this.property}),appearance:i,asynchronous:n,allowPicking:this._allowPicking,modelMatrix:s});return this.primitive.add(u),u}createCirclePrimitive(t,e=!0){if(this.isDestroyed())return;const i=new zE({center:zl.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height,granularity:.01}),n=new OE({geometryInstances:new FE({geometry:i,id:this.property}),appearance:t,asynchronous:e,allowPicking:this._allowPicking});return this.primitive.add(n),n}createCircleGroundPrimitive(t,e=!0){if(this.isDestroyed())return;const i=new zE({center:zl.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height}),n=new RE({geometryInstances:new FE({geometry:i,id:this.property}),appearance:t,asynchronous:e,allowPicking:this._allowPicking});return this.primitive.add(n),n}createAppearance(t){return this._appearance[t]||(this._appearance[t]=new ME({flat:!0,material:new DE({translucent:!0,fabric:{uniforms:{color:this._color,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAEACAYAAAADRnAGAAAAAXNSR0IArs4c6QAACQdJREFUeF7tncmvFUUUxr9yFqdEnNg4oa404kYwutANIBu36sK9Cn+Ngmtnl7pSNFE2DmgiGl0pDnGDJjyMAUXGMh85bZpL9+2699U5VcU7N7mbl/uqvv6dr6u7q0+dCljjn7DGjx8OwB2wxgn4KbDGDeCDoJ8C806BGOMlAPg9E0KIJU4XbQ2jDogxXgHgZgDXAlgB8GcI4YwlBAsNgwCE+gYATwLYBOADAJ+EEP62AmClYQzAZQA2AtgFYCuAVwC8GkI4YgjARMMYAP79RgBbANwL4EsAB0IIx4cAxBj5e44V/JzNMV5Im+oa5o0BlwK4CsCVAI5PHPx1ANYLAI4XRzNBUNew6stgjJGA7gewHTh3X/E+gO9DCCcMT5elNeQAcA2AxwHslAPeDWBfCOGYIYClNeQAwMvlnTJe8Jj3A/glhHDSEMDSGlYNgAcZY7wcAKPAzz+WB99BXlZDFgBWkdboxwFoUG2pTXdAS9HS0OoO0KDaUpvugJaipaHVHaBBtaU2kx0g99pXyyMv5wfMHnZm7vezakgCIAd/N4DNIoZPfD+HEE5ZRVtLQyoAPuk9AeBFOeCX5ZnfcpJURUMqAM64PCCzPmTAWWLO+vxr6AAVDakAOOHJ9wM3yQEfBnAshHDWEICKhiQAMunB33KSkp8ib4pkpjirhmQAVpG27scBWBOvrT93QG0RsdbjDrAmXlt/7oDaImKtxx1gTby2/twBtUXEWo87wJp4bf2pO0Ajg2xRiPM0qAKQjlUyyFIhTGnQBtBlbzHjlLnGnEv8znJKvZfFNqhBGwDnEZlB1s0mM4PMOuV2rgZtAMzeumvmfUKJDLJRDaoAZDKVGWTr5JxlBpnZy5RunJCXKoMa1AGkDlalfucASpGvpV93QC2RKKXDHVCKfC39ugNqiUQpHe6AUuRr6TfZAbKQkRlac1eRaR6YhoYkANJxt4aPCyq7dYSWOUJMkcmuIRUA01K4gJLP9dsA8Ln+deOVpCoaUgGQ/m0AdgB4EMDeAkvjVDQkAZDnek5uMEvsellNvmKZJaalIRmACGAU+D/R+uB7kxtZNSwEQHOEL9W2AyhFvpZ+3QG1RKKUDndAKfK19OsOqCUSpXS4A0qRr6Vfd0AtkSilwx1Qinwt/boDaolEKR3ugJzkJReHc4enAZwqMW22qIZsDpDyl8zG4vT5IQA/yPJas1qky2jICeAGAE8BeAbApwDeBPCbZR3SGOPCGjQAPA3gs8IAkjXkBNAlRa7ZU4AwWQiVIFh+96T1ICiJ0QtpyOaAnFcTy7YcgCXtGvtyB9QYFUtN7oAh2jFGZmPwcsYPL2emVeXlVbyJhgscEGPkdfQWuaenlh8B/GEJwVLDEABmgj0M4FlxwFtMihqrLa5xvsYYzTSMAWDNsD6A/QUAmGgYOwVunTkFfi9wCphoGLwKyDnYHwQ5wWH6sdKgdhmsfclsF00VAAPLVbvia5azQzy2/rLdQQ1aAPpLZgm75KYLXDI7qkELgErxw0UGoRhjkgYtALNLZr8A8KvxoukkDSoA5Fa2WzLLPkpuusAls6Ma1AAsYteSv3UAJenX0Lc7oIYolNTgDihJv4a+3QE1RKGkBndASfo19O0OqCEKJTW4A0rSr6Fvd0ANUSipIasD5KUqt+rll7NAg/sUax7wohqyARjZKPlr441YeDyzmzXP1ZATwGyBgz0AXitcZGFSQ24ALLLAeXgWWfgQwMfGG7YzCAtpyAZAZoL7RRb4JuZIgVzBhTRkBSAQugIHWTZhX2bAlKIvPLZJDdkBLCO45P84gJL0a+j7PAfIucNXWvyeKFQBlmOImYb/AciNDIsQ3wdgg2SHWe8pSD2mGvoAeA29XZKjHgPwDoB3Qwh/WVlVbmNNNcwCuEMAPFoQgKkGPwX69pZxgHdSzBZlimyJMtgMipkGvw+wGuBq7ccdUGtkrHS5A6xI19qPO6DWyFjpcgdYka61H3dArZGx0uUOsCJdaz/ugFojY6XLHWBFutZ+3AG1RsZKV5IDeqtAS5bVp1a+NcqqYRJAb3+R9QCOcnOFEMIJqwj1Xrkz9SW7hhQA3Z6d2wEckI1TD1kmPsQY1TSkACD55wA8D+AjAC8BOGi8nF5NQwoAVnPYJBunHgTAVaCmqS9SUUJFwyQAOQcJgd+TAI5bRr8bawRCdg1JACwHPOu+HIA18dr6U3NAL93m3JtmFloNIZhVkOjdPzDdZlSDCoCRdBvrLbeH0m0u0KAFoJl0GysAbwN4r3C+0aAGLQBslxVcWGC1yzgrcQpMalABMDQAFUq36XIOR1N+1ADUdrkb0+MAWomUlk53gBbZVtp1B7QSKS2d7gAtsq206w5oJVJaOt0BWmRbadcd0EqktHS6A7TIttKuO6CVSGnpdAdokW2lXXdAK5HS0ukO0CLbSrvugFYipaXTHaBFtpV23QGtREpLpztAi2wr7boDWomUls5kB0juH9PfuGLDfAdKAtDQkARASlwxZ5/fYwAOF1g1QvjZNaQC6Lat2gbgW9k7zHrViIqGVADdio0XpFhqyVUjWTWkAmCh5Id6q0Y+l1UjZsnPMUYVDakA+DsKyL5iI3V0lwEwu4YkAKkiW/ydA2gxajk1uwNy0myxLRMHyJ0kryCsFMl1h6X2HbhAgzqA3r4DjwDYyH3MAXxjCWGeBgsAvIe/B8AuAFsB7AbwRghhxeqUEQcOarAAwFUbrPm/Q/Yd2AtgXwiBD1UmH1nCN6hBHYA8xvZr/jPyXHxt+kgdYxzUYAJAINAJ/LLm/1mT0M90Ik44T8NcABoTEIseuLaGUQAXe+mMLhDzAKhMQCzigN7+4WoTMfMADE2C/BRCOL3IQazmtzFGdQ3zAHSlM7bIXgMsncEKMpaTIOoapgbBi7Z0xuQYsBrrtvS/ZvcBtUJxALVGxkqXO0CDtNxFris8AcJ7/kkN2R3Qu4XeLPMAX7EIm/EECA+eN1GTGjQAdBMgOwHwFnZy08PcLuxNgExq0ALAyQeW32MBtBITIN3Gi5MasgMYmACpeuNFFQC9CRC2P7npYe5ToGsvZeNFNQBaB5W7XQeQm2hr7a15B/wHRTppPaBaKTsAAAAASUVORK5CYII=",speed:this._speed},source:t}})})),this._appearance[t]}update(t){}},t.DynamicFadeMaterialProperty=YT,t.DynamicFlowWallMaterialProperty=QT,t.DynamicSpreadMaterialProperty=eP,t.DynamicWaveMaterialProperty=sP,t.Ellipsoid=e_,t.Event=jl,t.Feature=Xl,t.FillAnalyser=fu,t.FlattenPolygonCollection=class{constructor(t,e){this._model=t,t instanceof yx&&(this._model=t.delegate),this._frameState=e.scene.frameState,this._colorTexture=void 0,this._depthStenclilTexture=void 0,this.frameBuffer=void 0,this._viewport=new xP,this._rs=void 0,this.canvas=void 0,this._clearColorCommand=new LP({depth:1,coloe:new EP(0,0,0,1)}),this._useScissorTest=!1,this._scissorRectangle=!1,this._drawCommandList=[],this._camera=new KP,this._passState=void 0,this._clearPassState=void 0,this._width=4096,this._height=4096,this._positions=[],this._polygonBounding=new xP,this._delta=0,this._localModel=void 0,this._inverseLocalModel=void 0,this._uniforms={},this._initShaderSource=!1,this._colorTexture=void 0,this._enabled=!0,this._removeEvent=e.scene.postRender.addEventListener((t=>{this.update(t.frameState)}))}get enabled(){return this._enabled}set enabled(t){this._enabled=t}get ready(){return this._model.ready}get readyPromise(){return this._model.readyPromise}get polygonBounding(){return this._polygonBounding}set polygonBounding(t){this._polygonBounding={x:t.x,y:t.y,z:t.x+t.width,w:t.y+t.height};const e=this._camera.frustum;e.left=t.x,e.top=t.y+t.height,e.right=t.x+t.width,e.bottom=t.y}_updateUniforms(){if(this._uniforms){if(this._uniforms.u_polygonTexture){const t=new $P({url:"./"});t.texture=this._colorTexture,this._uniforms.u_polygonTexture.value=t}this._uniforms.u_polygonBounding&&(this._uniforms.u_polygonBounding.value=this._polygonBounding),this._uniforms.u_enabled&&(this._uniforms.u_enabled.value=this._enabled),this._uniforms.u_delta&&(this._uniforms.u_delta.value=this._delta)}}_addShaderSource(){if(this._initShaderSource)return;const t=new $P({url:"./"});t.texture=this._colorTexture;const e={u_inverseLocalModel:{type:XP.MAT4,value:this._inverseLocalModel},u_localModel:{type:XP.MAT4,value:this._localModel},u_polygonBounding:{type:XP.VEC4,value:this.polygonBounding},u_polygonTexture:{type:XP.SAMPLER_2D,value:t},u_delta:{type:XP.FLOAT,value:this._delta},u_enabled:{type:XP.BOOL,value:this._enabled}};this._uniforms=e,this._model.customShader=new YP({uniforms:e,vertexShaderText:"bool isPointInBound(vec4 point, vec4 bounds) {\n    return (point.x>bounds.x&&point.x<bounds.z&&point.y>bounds.y&&point.y<bounds.w);\n  }\n  void vertexMain(VertexInput vsInput, inout czm_modelVertexOutput vsOutput) {\n  vec4 positionLC = u_inverseLocalModel * czm_model * vec4(vsInput.attributes.positionMC, 1.0);  \n    if (u_enabled && isPointInBound(positionLC, u_polygonBounding)) {\n      vec2 textureCoord;\n      textureCoord.x = (positionLC.x-u_polygonBounding.x)/(u_polygonBounding.z-u_polygonBounding.x);\n      textureCoord.y = (positionLC.y-u_polygonBounding.y)/(u_polygonBounding.w-u_polygonBounding.y);\n      float depth = czm_unpackDepth(texture2D(u_polygonTexture, textureCoord));\n      depth = depth * 4096.0;\n      if (depth > 1.0 && positionLC.z > depth) {\n        positionLC.z = mix(depth, positionLC.z, u_delta);\n      }\n      vsOutput.positionMC = (czm_inverseModel * u_localModel * positionLC).xyz;\n    }       \n  }"}),this._initShaderSource=!0}_createDrawCommand(t,e){const i=this._frameState,n=t.attributes.position.values;for(let t=0,i=n.length;t<i/3;t++){const i=new wP(n[3*t],n[3*t+1],n[3*t+2]);PP.multiplyByPoint(e,i,i),n[3*t]=i.x,n[3*t+1]=i.y,n[3*t+2]=i.z,this._positions.push(i)}t.boundingSphere=kP.transform(t.boundingSphere,e),this.polygonBounding=xP.fromPoints(this._positions);const r=zP.fromGeometry({context:i.context,geometry:t,attributeLocations:{position:0},bufferUsage:GP.STREAM_DRAW,interleave:!0}),o=BP.fromCache({context:i.context,vertexShaderSource:"\nattribute vec3 position;\nvarying float depth;\nvoid main() {\n  vec4 pos = vec4(position, 1.0);\n  depth = position.z;\n  gl_Position = czm_projection * vec4(position.xy, 0.0, 1.0); \n}\n",fragmentShaderSource:"\nvarying float depth;\nvoid main() {\n  float fDepth = depth / 4096.0; \n  gl_FragColor = czm_packDepth(fDepth);\n}\n"}),s=new UP;s.depthTest.enabled=!0,s.cull.enabled=!0,s.cull.face=VP.BACK;const a=new HP({primitiveType:WP.TRIANGLES,vertexArray:r,shaderProgram:o,uniformMap:{},renderState:s,pass:jP.CESIUM_3D_TILE});this._updateUniforms(),this._drawCommandList.push(a)}addPolygon(t){this._localModel?this._createDrawCommand(t,this._inverseLocalModel):this.readyPromise.then((()=>{this._updateMatrix(),this._createDrawCommand(t,this._inverseLocalModel)}))}_updateMatrix(){let t=this._model._rtcCenter;if(!t){const e=this._model.boundingSphere.center,i=bP.fromCartesian(e);t=wP.fromRadians(i.longitude,i.latitude,0)}this._localModel=qP.eastNorthUpToFixedFrame(t),this._inverseLocalModel=PP.inverse(this._localModel,{})}addPolygonFromPositionArray(t){const e=Math.min(...t.map((t=>bP.fromCartesian(t).height))),i=new OP({polygonHierarchy:new FP(t),height:e}),n=OP.createGeometry(i);this.addPolygon(n)}update(t){if(!this._drawCommandList.length)return;tA.call(this,t),this._initShaderSource||this._addShaderSource(),SP(this._passState)||(this._passState=new MP(t.context)),this._updateUniforms(),this._passState.viewport=new xP(0,0,this._width,this._height);const e=t.context.uniformState;e.updateCamera(this._camera),this._clearColorCommand.framebuffer=this.frameBuffer,this._clearColorCommand.execute(t.context,this._clearPassState);for(const i of this._drawCommandList)e.updatePass(i.pass),i.framebuffer=this.frameBuffer,i.execute(t.context,this._passState)}clear(){this._clearColorCommand&&this._clearColorCommand.execute(this._frameState.context,this._clearPassState)}isDestroyed(){return!1}destroy(){this._colorTexture&&!this._colorTexture.isDestroyed()&&this._colorTexture.destroy(),this._depthStenclilTexture&&!this._depthStenclilTexture.isDestroyed()&&this._depthStenclilTexture.destroy(),this.frameBuffer&&!this.frameBuffer.isDestroyed()&&this.frameBuffer.destroy(),TP(this),this._removeEvent()}},t.FloodAnalyser=class extends Yl{constructor(t,e={}){super(t),this._mask=[];const i=Vl.getCartesians(e.mask);if(i&&i.length){this._mask=i;const t=new Vu(this._mask);this.clipRegion&&this._viewer.scene.globe.clipRegion.remove(this.clipRegion),this._viewer.scene.globe.clipRegion.add(t),this.clipRegion=t}this._color=Fl(e.color,"rgba(0, 123, 230, 0.5)"),this._speed=Fl(e.speed,1),this.clock=new Qu({startTime:Ju.now(),shouldAnimate:!0}),this.minHeight=e.minHeight,this.maxHeight=e.maxHeight,this.currentHeight=void 0,this._doing=!1,this.removeEventListener=t.clock.onTick.addEventListener((()=>{if(this.clock.tick(),!this._doing)return;if(!this.clipRegion)return;const e=this.clock.currentTime,i=Ju.secondsDifference(e,this.clock.startTime)*this.speed,n=this.minHeight+i;n>=this.maxHeight&&(this._doing=!1),this.currentHeight=Math.min(n,this.maxHeight),t.scene.globe.material.uniforms.height=this.currentHeight}))}get multiplier(){return this.clock.multiplier}set multiplier(t){this.clock.multiplier=t}get color(){return $u.fromCssColorString(this._color)}set color(t){t instanceof Cesium.Color&&(this._color=t)}get speed(){return this._speed}set speed(t){this._speed=t>0?t:0}get mask(){return this._mask}set mask(t){const e=Vl.getCartesians(t);if(e&&e.length){this._mask=e;const t=new Vu(this._mask);this.clipRegion&&this._viewer.scene.globe.clipRegion.remove(this.clipRegion),this._viewer.scene.globe.clipRegion.add(t),this.clipRegion=t}}calcRegionElevation(){const t=new Yu(this._viewer,{mask:this.mask}).do();return this.minHeight=t.min,this.maxHeight=t.max,{minHeight:this.minHeight,maxHeight:this.maxHeight}}do(){if(this._mask.length)return"number"==typeof this.minHeight&&"number"==typeof this.maxHeight||this.calcRegionElevation(),this.preAnalysis.raise(),this.clear(),this._doing=!0,this.clock.startTime=Ju.now(),this._viewer.scene.globe.material=Xu.fromType("FloodMaterial",{color:this.color}),this.postAnalysis.raise({minHeight:this.minHeight,maxHeight:this.maxHeight}),{minHeight:this.minHeight,maxHeight:this.maxHeight};console.warn("mask must be specified.")}pause(){this.clock.shouldAnimate=!this.clock.shouldAnimate}clear(){this._viewer.scene.globe.material=void 0,this.currentHeight=this.minHeight}isDestroyed(){return!1}destroy(){this.clear(),this.clipRegion&&this._viewer.scene.globe.clipRegion.remove(this.clipRegion),this.clipRegion=void 0,this.removeEventListener(),Wu(this)}},t.FrameState=function(t,e,i,n){this.context=t,n.globe&&(this.globeClipRegion=n.globe.clipRegion),this.commandList=[],this.shadowMaps=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this.specularEnvironmentMapsMaximumLOD=void 0,this.mode=eA.SCENE3D,this.morphTime=eA.getMorphTime(eA.SCENE3D),this.frameNumber=0,this.newFrame=!1,this.time=void 0,this.jobScheduler=i,this.mapProjection=void 0,this.camera=void 0,this.cameraUnderground=!1,this.globeTranslucencyState=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.pixelRatio=1,this.passes={render:!1,pick:!1,depth:!1,postProcess:!1,offscreen:!1},this.creditDisplay=e,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,density:void 0,sse:void 0,minimumBrightness:void 0},this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.shadowState={shadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.splitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.light=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0,this.useLogDepth=!1,this.tilesetPassState=void 0,this.minimumTerrainHeight=0},t.GaoDeLayer=GS,t.GeoJsonDataSource=Vv,t.Geographic4490TilingScheme=s_,t.Globe=xw,t.GlobeSurfaceShaderSet=uA,t.Graphic=a_,t.GraphicGroup=c_,t.GroundSkyBox=class{constructor(t={}){this.sources=d_(t.sources,{positiveX:kd.buildModuleUrl("./assets/skybox/px.png"),negativeX:kd.buildModuleUrl("./assets/skybox/nx.png"),positiveY:kd.buildModuleUrl("./assets/skybox/py.png"),negativeY:kd.buildModuleUrl("./assets/skybox/ny.png"),positiveZ:kd.buildModuleUrl("./assets/skybox/pz.png"),negativeZ:kd.buildModuleUrl("./assets/skybox/nz.png")}),this._sources=void 0,this.show=d_(t.show,!0),this._command=new m_({modelMatrix:g_.clone(g_.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0,this._isDestroyed=!1}update(t,e){const i=new M_,n=this;if(!this.show)return;if(t.mode!==I_.SCENE3D&&t.mode!==I_.MORPHING)return;if(!t.passes.render)return;const{context:r}=t;if(this._sources!==this.sources){this._sources=this.sources;const{sources:t}=this;if(!(v_(t.positiveX)&&v_(t.negativeX)&&v_(t.positiveY)&&v_(t.negativeY)&&v_(t.positiveZ)&&v_(t.negativeZ)))throw new Ol("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof t.positiveX!=typeof t.negativeX||typeof t.positiveX!=typeof t.positiveY||typeof t.positiveX!=typeof t.negativeY||typeof t.positiveX!=typeof t.positiveZ||typeof t.positiveX!=typeof t.negativeZ)throw new Ol("this.sources properties must all be the same type.");"string"==typeof t.positiveX?S_(r,this._sources).then((t=>{n._cubeMap=n._cubeMap&&n._cubeMap.destroy(),n._cubeMap=t})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new E_({context:r,source:t}))}const o=this._command;if(o.modelMatrix=x_.eastNorthUpToFixedFrame(t.camera._positionWC),!v_(o.vertexArray)){o.uniformMap={u_cubeMap:()=>n._cubeMap,u_rotateMatrix:()=>"function"==typeof g_.getRotation?g_.getRotation(o.modelMatrix,i):g_.getMatrix3(o.modelMatrix,i)};const t=__.createGeometry(__.fromDimensions({dimensions:new y_(2,2,2),vertexFormat:w_.POSITION_ONLY})),e=this._attributeLocations=C_.createAttributeLocations(t);o.vertexArray=P_.fromGeometry({context:r,geometry:t,attributeLocations:e,bufferUsage:b_._DRAW}),o.renderState=T_.fromCache({blending:A_.ALPHA_BLEND})}if(!v_(o.shaderProgram)||this._useHdr!==e){const t=new N_({defines:[e?"HDR":""],sources:["uniform samplerCube u_cubeMap;\n  varying vec3 v_texCoord;\n  void main()\n  {\n  vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n  gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n  }\n  "]});o.shaderProgram=L_.fromCache({context:r,vertexShaderSource:"attribute vec3 position;\n  varying vec3 v_texCoord;\n  uniform mat3 u_rotateMatrix;\n  void main()\n  {\n  vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n  gl_Position = czm_projection * vec4(p, 1.0);\n  v_texCoord = position.xyz;\n  }\n  ",fragmentShaderSource:t,attributeLocations:this._attributeLocations}),this._useHdr=e}return v_(this._cubeMap)?o:void 0}isDestroyed(){return this._isDestroyed}destroy(){const t=this._command;return t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),f_(this)}},t.Heatmap=class{constructor(t={}){if(this._options=t,!this._options.points)throw new Error("parameter points must be provided");const e=t.lonField||"lon",i=t.latField||"lat",n=t.valueField||"value";if(!Array.isArray(this._options.points))throw new Error("points must be specified");const r=this._options.points.map((t=>({x:t[e],y:t[i],value:t[n]})));if(this.points=r.map((t=>({cartesian:dA.fromDegrees(t.x,t.y),value:t.value,heatmapPoint:void 0,x:t.x,y:t.y}))),this.rectangle=function(t){const e=t.bound;if(Array.isArray(e))return e.map((t=>pA.toRadians(t)));const i=t.points;if(!i)return null;const n=fA.fromCartesianArray(i);return fA.pack(n,[])}({bound:this._options.bound,points:this.points.map((t=>t.cartesian))}),!this.rectangle)throw new Error("rectangle computed failed");this._autoRerender=xA(this._options.autoRerender,!0),this._useLocalExtrema=xA(t.useLocalExtrema,!0);const o=this._options.heatmapOptions;this._clampToGround=xA(t.clampToGround,!1);const{container:s,width:a,height:l}=this._createContainer(this.rectangle);this._container=s,this.width=a,this.height=l,this._heatmapOptions=Object.assign({},{maxOpacity:.8,minOpacity:0,blur:.85,gradient:{.3:"rgb(0, 0, 255)",.5:"rgb(0, 255, 0)",.7:"rgb(255, 255, 0)",.95:"rgb(255, 0, 0)"}},o||{}),this.heatmap=hA.create({...this._heatmapOptions,container:s}),this._radius=this.autoRadius=2,this._heatmapOptions.radius&&(this._radius=this.autoRadius=this._heatmapOptions.radius),this.radiusChange=new CA,this._render3D=t.render3D,this._render3D&&(this.heightMapCanvas=document.createElement("canvas"),this.heightMapCanvas.width=this.width,this.heightMapCanvas.height=this.height),this._granularity=t.granularity}get autoRerender(){return this._autoRerender}set autoRerender(t){const e=this._radius;if(t){const t=23,i=AA(this._viewer.camera.positionCartographic.height);this.autoRadius=e*t/i}this._autoRerender=t,this.update()}get useLocalExtrema(){return this._useLocalExtrema}set useLocalExtrema(t){this._useLocalExtrema=t,this.update()}get granularity(){return this._granularity?this._granularity:1}set granularity(t){this.render3D&&(this._granularity=Math.min(t,30),this._updateTexture())}get radius(){return this._radius}set radius(t){"number"==typeof t&&this.heatmap&&(t<0&&(t=-t),t<.5&&(t=.5),this._radius=t,this.update())}get render3D(){return this._render3D}set render3D(t){this._render3D=t,this._updateTexture()}_setData(){const t=[],e=[];let i=this.points,n=this.rectangle,r=this.width,o=this.height;const s=this.autoRerender?this.autoRadius:this.radius;this.useLocalExtrema&&(i=this._getPointsInCurrentView(),this._container.style.width=r+"px",this._container.style.height=o+"px",n=fA.pack(Cesium.Rectangle.fromCartographicArray(i.map((t=>t.cartesian))),[]),n=n.map((t=>pA.toRadians(t))));const a=this.rectangle.map((t=>pA.toDegrees(t)));for(let n of i){let i=n.heatmapPoint;i||(i=IA(n,a,{width:r,height:o}),i&&(i.value=n.value)),i&&"number"==typeof i.value&&(i.radius=s,e.push(i.value),t.push(i))}const{min:l,max:u}=this._options,c="number"==typeof l?l:Math.min(...e),h="number"==typeof u?u:Math.max(...e);this._heatmapData={min:c,max:h,data:t},t.length&&this.heatmap.setData(this._heatmapData),this._updateTexture()}_updateTexture(){this.primitive&&this.heatmap&&(this.primitive.appearance.material.uniforms.image=this.heatmap.getDataURL(),this.primitive.appearance.material.uniforms.is3D=this.render3D?1:0)}update(){this._setData()}createLayer(){const t=this.heatmap.getDataURL("image/png"),e=wA.fromCache({cull:{enabled:!0},depthTest:{enabled:!1},stencilTest:{enabled:!0,frontFunction:bA.ALWAYS,frontOperation:{fail:EA.KEEP,zFail:EA.KEEP,zPass:EA.REPLACE},backFunction:bA.ALWAYS,backOperation:{fail:EA.KEEP,zFail:EA.KEEP,zPass:EA.REPLACE},reference:2,mask:2},blending:SA.ALPHA_BLEND}),i=new(this._clampToGround?PA:gA)({geometryInstances:new mA({geometry:new _A({rectangle:fA.unpack(this.rectangle),granularity:pA.RADIANS_PER_DEGREE/20})}),appearance:new yA({renderState:e,aboveGround:!1,material:new vA({fabric:{type:"Image",uniforms:{image:t,is3D:this.render3D?1:0}}}),vertexShaderSource:"attribute vec3 position3DHigh;\n\t\t\t\tattribute vec3 position3DLow;\n\t\t\t\tattribute vec2 st;\n\t\t\t\tattribute float batchId;\n\t\t\t\tuniform sampler2D image_0;\n\t\t\t\tvarying vec3 v_positionMC;\n\t\t\t\tvarying vec3 v_positionEC;\n\t\t\t\tuniform float is3D_1;\n\t\t\t\tvarying vec2 v_st;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 p = czm_computePosition();\n\t\t\t\t\tv_positionMC = position3DHigh + position3DLow;           // position in model coordinates\n\t\t\t\t\tv_positionEC = (czm_modelViewRelativeToEye * p).xyz;     // position in eye coordinates\n\t\t\t\t\tv_st = st;\n\t\t\t\t\tif (is3D_1 == 1.0) {\n\t\t\t\t\t\tvec4 color = texture2D(image_0, st);\n\t\t\t\t\t  vec3 normal = normalize(v_positionMC.xyz);\n\t\t\t\t\t  vec3 delta = normal * color.a * 100000.0;\n\t\t\t\t\t  p += vec4(delta, 0.0);\n\t\t\t\t\t}\n\t\t\t\t\tgl_Position = czm_modelViewProjectionRelativeToEye * p;\n\t\t\t\t}"})});this.primitive=i,this._updateTexture()}_addEventListener(){if(!this._radius)return;this._removeEventListener&&this._removeEventListener();this._removeEventListener=this._viewer.camera.moveEnd.addEventListener((()=>{const t=this._radius;if(this.autoRerender){const e=AA(this._viewer.camera.positionCartographic.height);this.autoRadius=23*t/e}(this.autoRerender||this.useLocalExtrema)&&this.update()}))}_getPointsInCurrentView(){if(!this._viewer)return;const t=function(t){let e=t.camera.computeViewRectangle();if(void 0===e){let i=t.scene.canvas,n=new Cesium.Cartesian2(0,0),r=new Cesium.Cartesian2(i.clientWidth,i.clientHeight),o=t.scene.globe.ellipsoid,s=t.camera.pickEllipsoid(n,o),a=t.camera.pickEllipsoid(r,o),l=t.scene.globe.ellipsoid.cartesianToCartographic(s),u=t.scene.globe.ellipsoid.cartesianToCartographic(a),c=Cesium.Math.toDegrees(l.longitude),h=Cesium.Math.toDegrees(u.longitude),p=Cesium.Math.toDegrees(u.latitude),d=Cesium.Math.toDegrees(l.latitude);e=fA.fromDegrees(c,p,h,d)}return e}(this._viewer);return this.points.filter((e=>fA.contains(t,TA.fromCartesian(e.cartesian))))}addTo(t){if(!t)throw new Error("viewer must be required.");this._viewer=t,this._setData(),this.createLayer(),t.scene.primitives.add(this.primitive),this._addEventListener()}remove(){if(!this._viewer)throw new Error("heatmap is not initialized");this.primitive&&this._viewer.scene.primitives.remove(this.primitive)}zoomTo(){if(!this._viewer)throw new Error("heatmap is not initialized");this._viewer.camera.flyTo({destination:fA.unpack(this.rectangle),duration:0})}_createContainer(t){const e=document.createElement("div"),i=1920;let n=0;if(t){const e=(t[2]-t[0])/(t[3]-t[1]);isNaN(e)||(n=Math.floor(i/e))}return e.className="cesium-heatmap-container",e.setAttribute("style",`width: 1920px;height: ${n}px;display: none`),document.body.appendChild(e),{container:e,width:i,height:n}}destroy(){this.remove(),this._removeEventListener&&this._removeEventListener(),document.body.removeChild(this._container),Wu(this)}},t.HeightAnalyser=Yu,t.HtmlGraphicGroup=class extends c_{constructor(t,e={}){super(t),this._viewer=t,this._allowPicking=Fl(e.allowPicking,!1),this._createRoot(),this._addEventListener(),this.selectedEvent=new jl}_createRoot(){const t=document.createElement("div");t.style.position="absolute",t.style.zIndex=9999,t.style.pointerEvents="none",t.style.width="100vw",t.style.height="100vh",t.style.left=0,t.style.top=0,this._viewer.container.appendChild(t),this.root=t}_addEventListener(){const t=this._viewer.scene.postRender.addEventListener((()=>{const t=this.values._array,e=viewer.camera._positionCartographic.height;for(let i of t){const t=i.position,n=i.el;if(!n)return;const r=zl.toPixel(t,this._viewer.scene);if(r&&zl.isVisible(t,this._viewer))if(n.style.left=r.x+"px",n.style.top=r.y+"px",i.distanceDisplayCondition){const{near:t,far:r}=i.distanceDisplayCondition;n.style.display=e<r&&e>t?i.display||"block":"none"}else n.style.display=i.display||"block";else n.style.display="none"}})),e=this;function i(t){const{target:i}=t;if(!i)return;const n=e.getById(i.id);e.selectedEvent.raise(n)}this.root.addEventListener("click",i),this.removeEventListener=function(){t(),e.root.removeEventListener("click",i)}}add(t){if(!(t instanceof D_))throw new Ol(t+"is not a html graphic.");this.values.set(t.id,t),this.root.appendChild(t.el),t.group=this,t._loadEvent.raise()}remove(t){this.values.remove(t.id),t.el&&this.root.removeChild(t.el)}getById(t){return this.values.get(t)}removeById(t){const e=this.values.get(t);this.remove(e)}clear(){const t=[...this.values._array];for(let e of t)e.remove();this.values.removeAll()}destroy(){this._viewer.container.removeChild(this.root),this.removeEventListener(),Wu(this)}get boundingSphere(){const t=this.values._array.map((t=>zl.toCartesian(t.position)));return Cesium.BoundingSphere.fromPoints(t)}},t.HtmlPointGraphic=D_,t.ImageGraphic=class extends tE{constructor(t){super(t),this._primitive=new YE,this._image=t.image,this._speedFactor=Fl(t.speedFactor,1),this._imageIndex=0,this._imageParser=t.imageParser,this.createGraphic()}get clampToGround(){}set clampToGround(t){throw new Ol("clampToGround is not valid.")}get speedFactor(){return this._speedFactor}set speedFactor(t){this._speedFactor=t}createGraphic(){this._requestImage=function(t,e=[],i){const n=document.createElement("img");n.src=t,n.setAttribute("rel:animated_src",t),n.setAttribute("rel:auto_play","0"),n.style.cssText="position:fixed;zIndex: -1;",document.body.appendChild(n);const r=new qE({gif:n});return new Promise((t=>{r.load((()=>{for(let t=1;t<=r.get_length();t++){r.move_to(t);const n=r.get_canvas();i&&i(n),e.push(n.toDataURL())}t(e)}))}))}(this._image,[],this._imageParser),this._billboard=this._primitive.add({position:zl.toCartesian(this._position),image:this._image,verticalOrigin:XE.BOTTOM})}update(){this._speedFactor<=0||this._requestImage.then((t=>{const e=t[Math.floor(this._imageIndex++/this._speedFactor)%t.length];this._billboard.image=e}))}remove(){super.remove(),this._billboard=void 0}},t.InfoBox=mx,t.LonLat=zl,t.LonLatNetLayer=class{constructor(t={}){const e=new G_({rectangle:Cesium.Rectangle.MAX_VALUE,intervalOfZeorLevel:t.intervalOfZeorLevel});this._hasAlphaChannel=Fl(t.hasAlphaChannel,!0),this._tilingScheme=e,this._image=void 0,this._texture=void 0,this._errorEvent=new jl,this._ready=!0,this._readyPromise=Promise.resolve(!0),this._font=Fl(t.font,"bold 24px sans-serif"),this._color=Fl(t.color,"white"),this._lineColor=Fl(t.lineColor,"gold"),this._lineWidth=Fl(t.lineWidth,2)}get hasAlphaChannel(){return this._hasAlphaChannel}get tileHeight(){return 256}get tileWidth(){return 256}get minimumLevel(){return 0}get maximumLevel(){return 4}get rectangle(){return Cesium.Rectangle.MAX_VALUE}get errorEvent(){return this._errorEvent}get tileDiscardPolicy(){}get readyPromise(){return this._readyPromise}get ready(){return!0}get tilingScheme(){return this._tilingScheme}get font(){return this._font}set font(t){this._font=t}get color(){return`rgba(${255*this._color.red}, ${255*this._color.green}, ${255*this._color.blue}, ${this._color.alpha})`}set color(t){this._color=t}get lineColor(){const t=this._lineColor;return`rgba(${255*t.red}, ${255*t.green}, ${255*t.blue}, ${t.alpha})`}set lineColor(t){this._lineColor=t}get lineWidth(){return this._lineWidth}createCanvas(){const t=document.createElement("canvas");t.width=this.tileWidth,t.height=this.tileHeight;const e=t.getContext("2d");return e.textBaseline="middle",e.textAlign="center",e.font=this.font,e.fillStyle=this.color,e.strokeStyle=this.lineColor,e.lineWidth=this.lineWidth,{canvas:t,ctx:e}}getOffset(t,e,i){const n=this.tilingScheme.getDelatXY(i),r=Math.floor(t),o=Math.floor(e);if(r===t&&o===e)return[0,0,r,o];const s=t-r,a=e-o;let l=0,u=0;return s&&(l=this.tileWidth/n.dx*s),a&&(u=this.tileHeight/n.dy*a),[l,u,r,o]}requestImage(t,e,i,n){const{ctx:r,canvas:o}=this.createCanvas(),s=this.tilingScheme.getPosition(i,t,e);return r.textAlign="left",r.fillText(s.lon,10,o.height/2),r.textAlign="center",r.fillText(s.lat,o.width/2,20),r.strokeRect(0,0,o.width,o.height),Promise.resolve(o)}},t.LonlatTilingScheme=G_,t.MassiveBillboardLayer=class extends kA{constructor(t={}){t.objects=Fl(t.objects,[]),t.pixelSize=Fl(t.pixelSize,5),t.color=Fl(t.color,HA.fromRandom),t.createGeometryFunction=Fl(t.createGeometryFunction,function(t){return function(e){const i={id:e.id,position:e.position,point:{pixelSize:Fl(e.pixelSize,t.pixelSize),color:Fl(e.color,t.color)}};return e.label&&(i.label={text:e.label}),new WA(i)}}(t)),super(t)}},t.MassiveEntityLayer=kA,t.MassiveGraphicLayer=vx,t.MassiveGraphicLayerCollection=xx,t.MassiveModelLayer=class extends vx{constructor(t={}){t.objects.forEach((t=>{t._id=t.id,delete t.id})),super(t),this._id=Fl(t.id,of()),this._createGeometryFunction=t.createGeometryFunction,this._data=t.objects,this._needReclass=!0,this._changeEvent=new qA,this._maxClusterLevel=Fl(t.maxClusterLevel,12),this._minLoadLevel=Fl(t.minLoadLevel,12),this._geometryCached={},this._objectsCached={},this._options=t}get id(){return this._id}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(t){this._minLoadLevel=t}get objects(){return this._objects||this._data}set objects(t){this._objects=t}updateCluster(t){const e=JA(t),i=this._objects;return e>this._maxClusterLevel?(this._objects=this._data,this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._objectsCached[e]?(this._objects=this._objectsCached[e],this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._cluster?new Promise(((t,i)=>{this._cluster.update(),this._objects=this._cluster._clusterObjects,this._objectsCached[e]=JSON.parse(JSON.stringify(this._objects)),this._needReclass=!0,t(!0)})):void 0}beginUpdate(t){JA(t.camera.positionCartographic.height)<this._minLoadLevel?this._objects=[]:this._objects=this._data}endUpdate(t){const e=JA(t.camera.positionCartographic.height);return this._needReclass=!1,e<this._minLoadLevel}initialize(t,e){if(!this._collection){this._scene=e;const t=new Cesium.PrimitiveCollection;e.primitives.add(t),this._collection=t}}createGeometry(t,e,i){if(t.level<this._minLoadLevel)return;const n=Fl(this._createGeometryFunction,XA)(i,this._options);return this.add(n),n}removeGeometry(t,e){if(!e)return;return this._collection.remove(e)}add(t){this._collection&&t&&this._collection.add(t)}removeAll(){this._collection.removeAll()}isDestroyed(){return!1}destroy(){this._collection.removeAll(),jA(this)}},t.MassivePointLayer=class extends kA{constructor(t={}){t.objects=Fl(t.objects,[]),t.pixelSize=Fl(t.pixelSize,5),t.color=Fl(t.color,iI.fromRandom),t.createGeometryFunction=Fl(t.createGeometryFunction,function(t){return function(e){let i=rI();"string"!=typeof e.id&&"number"!=typeof e.id||(i=e.id);const n={id:i,position:e.position,point:{pixelSize:Fl(e.pixelSize,t.pixelSize),color:Fl(e.color,t.color)}};return e.label&&(n.label={text:e.label}),new nI(n)}}(t)),super(t)}},t.Material=sI,t.Model=py,t.MultipleTerrainProvider=class{constructor(t,e={}){this._heightmapWidth=65,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._ellipsoid=e.ellipsoid,this._requestVertexNormals=Fl(e.requestVertexNormals,!1),this._requestWaterMask=Fl(e.requestWaterMask,!1),this._requestMetadata=Fl(e.requestMetadata,!0),this._errorEvent=new jl,this._terrainProviders=[];const i=[];for(let n of t){n.requestVertexNormals=n.requestVertexNormals||e.requestVertexNormals,n.requestWaterMask=n.requestWaterMask||e.requestWaterMask,n.requestMetadata=n.requestMetadata||e.requestMetadata;const t=new pd(n);t.zIndex=n.zIndex||-1,this._terrainProviders.push(t),i.push($_(t,n.url))}this._ready=!1,this._readyPromise=new Promise((t=>{Promise.all([...this._terrainProviders.map((t=>t.readyPromise)),...i]).then((e=>{this._ready=!0,t(!0),this._tilingScheme=this._terrainProviders[0]._tilingScheme,this._levelZeroMaximumGeometricError=U_.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0))}))})),this._terrainList=t,this._validProvider=void 0}get errorEvent(){return this._errorEvent}get tilingScheme(){return this._tilingScheme}get ready(){return this._ready}get readyPromise(){return this._readyPromise}createBoundingRectangle(t){const e=new H_("multiple-terrain-provider");for(let t of this._terrainProviders)e.entities.add(X_(t));return t.addLayer(e),function(){const e=t.dataSources.getByName("multiple-terrain-provider");t.dataSources.remove(e[0])}}getLevelMaximumGeometricError(t){return this._validProvider?this._validProvider.getLevelMaximumGeometricError(t):this._levelZeroMaximumGeometricError/(1<<t)}getTileDataAvailable(t,e,i){const n=this._terrainProviders.filter((n=>n.getTileDataAvailable(t,e,i))).sort(((t,e)=>e.zIndex-t.zIndex));return this._validProvider=n[0],!!this._validProvider}requestTileGeometry(t,e,i,n){for(let n of this._terrainProviders)n!==this._validProvider&&n.getTileDataAvailable(t,e,i)&&n.requestTileGeometry(t,e,i);if(this._validProvider)return this._validProvider.requestTileGeometry(t,e,i)}},t.NodePlot=MT,t.PbfDataSource=function(){},t.PlotManager=class{constructor(t,e){Hl(t),this._viewer=t,e=Fl(e,{}),this._id=Fl(e.id,ql()),this._dataSource=new Cesium.CustomDataSource("cesiumpro-graphic_"+this._id),this._nodeDataSource=new Cesium.CustomDataSource("cesiumpro-graphic-node_"+this._id),this._viewer.dataSources.add(this._dataSource),this._viewer.dataSources.add(this._nodeDataSource),this._root=this._dataSource.entities,this._nodeRoot=this._nodeDataSource.entities,this._preEdit=new jl,this._postEdit=new jl,this._preCreate=new jl,this._postCreate=new jl,this._preRemove=new jl,this._postRemove=new jl,this._values=new Cesium.AssociativeArray,this._handler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._pointStyle=Fl(e.pointStyle,AT.defaultPointStyle),this._labelStyle=Fl(e.labelStyle,AT.defaultLabelStyle),this._modelStyle=Fl(e.modelStyle,AT.defaultModelStyle),this._billboardStyle=Fl(e.billboardStyle,AT.defaultBillboardStyle),this._polylineStyle=Fl(e.polylineStyle,IT.defaultStyle),this._polygonStyle=Fl(e.polygonStyle,LT.defaultStyle),this._editEventHandler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._viewer.screenSpaceEventHandler.removeInputAction(GT),this.showTip=Fl(e.showTip,!0),this._mode=VT,e.contextEnabled=Fl(e.contextEnabled,!0),e.contextEnabled&&(this.contextMenu=this.createContext(),this.addContextEventListener()),this.cursorTip=new Km({text:"",id:"plot-manager-tip",viewer:this._viewer,show:!1}),this.activeGraphic=void 0,this.selectedGraphic=void 0}get viewer(){return this._viewer}get preEdit(){return this._preEdit}get postEdit(){return this._postEdit}get preCreate(){return this._preCreate}get postCreate(){return this._postCreate}get preRemove(){return this._preRemove}get postRemove(){return this._postRemove}get root(){return this._root}pick(t=PT.POINT,e){let i,n=!1;return PT.isPoint(t)&&(n=!0),this._mode=HT,t===PT.POINT?i=this.createPoint(e||this._pointStyle,this._labelStyle):t===PT.LABEL?i=this.createLabel(e||this._labelStyle):t===PT.MODEL?i=this.createModel(e||this._modelStyle,this._labelStyle):t===PT.BILLBOARD?i=this.createBillboard(e||this._billboardStyle,this._labelStyle):t===PT.POLYLINE?i=this.createPolyline(e||this._polylineStyle):t===PT.POLYGON?i=this.createPolygon(e||this._polygonStyle):PT.isArrow(t)&&(i=this.createArrow(e||this._polygonStyle,t)),this.activeGraphic=i,i.startEdit(),this.addEventListener(n),i}createPoint(t,e){const i=new AT(t,{label:e});return this.add(i),i}createLabel(t){const e=new AT(t,{type:PT.LABEL});return this.add(e),e}createModel(t,e){const i=new AT(t,{type:PT.MODEL,label:e});return this.add(i),i}createBillboard(t,e){const i=new AT(t,{type:PT.BILLBOARD,label:e});return this.add(i),i}createPolyline(t){const e=new IT(t);return this.add(e),e}createPolygon(t){const e=new LT(t);return this.add(e),e}createArrow(t,e){const i=new DT(t,{type:e});return this.add(i),i}add(t){this.preCreate.raise(t),kl(this.viewer&&kl(t.entity))&&(this.root.add(t.entity),this._values.set(t.id,t),this.postCreate.raise(t))}remove(t){kl(t)&&(this.preRemove.raise(t),kl(this.viewer)&&kl(t.entity)&&(this.root.remove(t.entity),this.postRemove.raise(t)),this._values.remove(t.id),this.activeGraphic&&(this.activeGraphic=void 0))}get(t){return this._values.values[t]}getById(t){return this._values.get(t)}hasEntity(t){return!!kl(t)&&this._root.contains(t)}removeAll(){this.root.removeAll(),this.removeNodeGraphic(),this._values.removeAll()}destroy(){this.removeAll(),this.contextMenu&&this.contextMenu.destroy(),this.removeContextEventListener(),this._viewer.dataSources.remove(this._dataSource),this._viewer.dataSources.remove(this._nodeDataSource),this.cursorTip.destroy(),this._handler.isDestroyed()||this._handler.destroy(),Wu(this)}zoomTo(t){const e=[];if(Array.isArray(t))for(let i of t)e.push(i.entity);else e.push(t.entity);kl(this._viewer)&&this._viewer.zoomTo(e)}has(t){return"string"==typeof t?this._values.contains(t):this._values.values.includes(t)}startEdit(t){this.activeGraphic&&this.stopEdit(this.activeGraphic),t&&(t.startEdit(),this.preEdit.raise(t),this.createNodeGraphic(t),this.activeGraphic=t,this.addEditEventListener(),this.cursorTip.show=!0,this.cursorTip.text="单击节点选中")}stopEdit(t){t&&(t.stopEdit(),t.highlightGraphic(!1),this._nodeRoot.removeAll(),this.cursorTip.show=!1,this.activeGraphic=void 0,this._mode=VT,this.postEdit.raise(t),this.removeEditListener&&this.removeEditListener())}createNodeGraphic(t){if(PT.isPoint(t.type))return;const e=new MT({positions:t._nodePositions,...AT.defaultStyle}),i=e._values;for(let t of i)this._nodeRoot.add(t);this._nodeGraphic=e}removeNodeGraphic(){this._nodeRoot.removeAll(),this._nodeGraphic=void 0}addEventListener(t=!0){if(!kl(this.activeGraphic))return;const e=this.activeGraphic.positions,i=t=>{const i=this.pickPosition(t.endPosition);kl(i)&&(this.showTip&&(this.cursorTip.show=!0,this.cursorTip.text="左键单击添加节点，右键结束。"),e.length<1||(e.length>1&&this.activeGraphic.popNode(),this.activeGraphic.addNode(i)))},n=()=>{this._handler.removeInputAction(RT),this._handler.removeInputAction(OT),this._handler.removeInputAction(UT),this.stopEdit(this.activeGraphic),kl(this.contextMenu)&&this.addContextEventListener()};t||(this._handler.setInputAction(i,OT),this._handler.setInputAction(n,UT)),this._handler.setInputAction((e=>{const i=PT.isPoint(this.activeGraphic.type)?this.activeGraphic.updatePosition.bind(this.activeGraphic):this.activeGraphic.addNode.bind(this.activeGraphic),n=this.pickPosition(e.position);kl(n)&&(kl(i)&&i(n),t&&(this._handler.removeInputAction(RT),this.stopEdit(this.activeGraphic)))}),RT)}addEditEventListener(){const t=this._editEventHandler;let e=!1;const i=i=>{e=!1,oy(this._viewer,!e),t.removeInputAction(OT),t.removeInputAction(zT)},n=t=>{const e=this.pickPosition(t.endPosition);this.updatePosition(e)};t.setInputAction((t=>{if(kl(this.contextMenu)&&(this.contextMenu.show=!1),!kl(this.activeGraphic))return;const e=this._viewer.scene.pick(t.position);kl(e)&&e.id instanceof Cesium.Entity?this.hasEntity(e.id)?(this.activeGraphic.highlightGraphic(),this._nodeGraphic&&(this._nodeGraphic.activeNode=void 0)):this._nodeGraphic&&this._nodeGraphic.has(e.id)?(this._nodeGraphic.activeNode=e.id.position.getValue(this._viewer.clock.currentTime),this.activeGraphic.highlightGraphic(!1)):(this._nodeGraphic.activeNode=void 0,this.activeGraphic.highlightGraphic(!1)):(this._nodeGraphic&&(this._nodeGraphic.activeNode=void 0),this.activeGraphic&&this.activeGraphic.highlightGraphic(!1))}),RT),t.setInputAction((()=>{e=!0,oy(this._viewer,!e),t.setInputAction(i,zT),t.setInputAction(n,OT)}),kT),this.removeEditListener=function(){t.removeInputAction(OT),t.removeInputAction(zT),t.removeInputAction(RT),t.removeInputAction(kT),this.removeEditListener=void 0}}addContextEventListener(){this._editEventHandler.setInputAction((t=>{if(this._mode!==VT)return;const e=this._viewer.scene.pick(t.position),i=J_(t.position,this._viewer,!0);kl(e)&&this.hasEntity(e.id)&&(this.contextMenu.position=i,this.selectedGraphic=this.getById(e.id.id),kl(this.contextMenu)&&(this.contextMenu.show=!0))}),BT)}removeContextEventListener(){this._editEventHandler.removeInputAction(BT)}removeEditEventListener(){this._editEventHandler.removeInputAction(RT),this._editEventHandler.removeInputAction(kT)}updatePosition(t){const e=this.activeGraphic;if(kl(e))if(PT.isPoint(e.type))e.updatePosition(t);else{if(!kl(this._nodeGraphic)||!kl(this._nodeGraphic.activeIndex))return;e.updateNode(this._nodeGraphic.activeIndex,t)}}pickPosition(t){if(kl(this.activeGraphic))return this.activeGraphic.clampToModel,J_(t,this._viewer)}addNode(t,e,i){if(t.addNode(e,i),this._nodeGraphic){const t=this._nodeGraphic.addNode(e,i);this._nodeRoot.add(t)}}removeNode(t,e){if(t.removeNode&&t.removeNode(e),this._nodeGraphic){const t=this._nodeGraphic.removeNode(e);this._nodeRoot.remove(t)}}get show(){return this._root.show}set show(t){this._root.show=t}get pointStyle(){return this._pointStyle}set pointStyle(t){this._pointStyle=t}get labelStyle(){return this._labelStyle}set labelStyle(t){this._labelStyle=t}get billboardStyle(){return this._billboardStyle}set billboardStyle(t){this._billboardStyle=t}get modelStyle(){return this._modelStyle}set modelStyle(t){this._modelStyle=t}createContext(){return this.contextMenu=new rf(this._viewer,{items:[{id:"startEdit",text:"开始编辑",class:"fa fa-pencil-square-o",disabled:this.activeGraphic,callback:t=>{if(this.selectedGraphic){this.startEdit(this.selectedGraphic);const e=this.contextMenu.getById("stopEdit");this.contextMenu.updateItemDistabled(e,!1),this.contextMenu.updateItemDistabled(t,!0)}}},{id:"stopEdit",text:"停止编辑",class:"fa fa-floppy-o",disabled:!this.activeGraphic,callback:t=>{if(this.selectedGraphic){this.stopEdit(this.selectedGraphic);const e=this.contextMenu.getById("startEdit");this.contextMenu.updateItemDistabled(t,!0),this.contextMenu.updateItemDistabled(e,!1)}}},{id:"delete",text:"删除图形",class:"fa fa-times",callback:t=>{this.remove(this.selectedGraphic)}},{id:"select",text:"选择顶点",class:"fa fa-mouse-pointer"}]}),this.contextMenu}},t.PlotType=PT,t.PointBaseGraphic=tE,t.PointFeature=$l,t.PointPlot=AT,t.PolygonFeature=Ql,t.PolygonPlot=LT,t.PolylineAntialiasingMaterialProperty=uP,t.PolylineFeature=Jl,t.PolylineFlowMaterialProperty=dP,t.PolylineODMaterialProperty=mP,t.PolylinePlot=IT,t.PolylineTrailLinkMaterialProperty=CP,t.PostProcessing=uI,t.Properties=ry,t.RadarScanGraphic=class extends tE{constructor(t){super(t),this._speed=Fl(t.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(t){t!==this._speed&&(t<0&&(this._speed=0),this.definedChanged.raise("speed",t,this._speed),this._speed=t)}createAppearance(){return this._appearance||(this._appearance=new JE({material:new QE({translucent:!0,fabric:{uniforms:{color:this._color,time:0},source:$E}})})),this._appearance}update(t){if(!this.material)return;if(0===this.speed)return void(this.material.uniforms.time=.9999);const e=Cesium.JulianDate.toDate(t).getTime()/500*this.speed;this.material.uniforms.time=e-parseInt(e)}},t.RectangularSensorPrimitive=pp,t.SatelliteScanGraphic=class extends a_{constructor(t){if(t.path&&(t.position=t.path.position.getValue(viewer.clock.currentTime)),super(t),this._clampToGround=!1,!kl(t.position))throw new Ol("参数options必须定义position或path属性。");const e=zl.toCartographic(t.position,viewer);this._position=zl.toCartesian(t.position),this._thickness=Fl(t.thickness,.3),this._slices=Fl(t.slices,20),this.speed=Fl(t.speed,.5),this._height=e.height,this._surface=ZE.fromRadians(e.longitude,e.latitude),this.radius=t.radius||.5*this._height,this._inverse=t.inverse||!1,this._animation=!kl(t.animation)||t.animation,this._show=!kl(t.show)||t.show,this._color=t.color,this.path=t.path,this._tracked=t.tracked||!1,this._rotation=t.rotation,this._axis=t.axis,this._matrix=KE.multiplyByTranslation(tS.eastNorthUpToFixedFrame(this._surface),new ZE(0,0,.5*this._height),new KE),this.transform(this._rotation),this.image=t.image,this.model=t.model,this._primitive=new nS,this._primitive.name="SatelliteScan",this._loadEvent.addEventListener((()=>{this._viewer&&(this.stopAnimate=this._viewer.scene.preUpdate.addEventListener((()=>{hS(this)})))})),this.createGraphic()}updateMatrix(t){t&&(this._matrix=t,this.scanPrimitive.modelMatrix=t,this.modelPrimitive&&(this.modelPrimitive.modelMatrix=t))}updatePrimitive(){this.createGraphic()}createGraphic(){if(this.model){const t=eS.fromGltf({url:this.model,pixelOffset:new Cesium.Cartesian2(-10,10)});this.modelPrimitive=this.primitive.add(t)}if(this.image){const t=new rS;this.primitive.add(t),this.imagePrimitive=t.add({image:this.image,position:this._position})}const t=new iS({length:this._height,topRadius:0,bottomRadius:this.radius,vertextFormat:oS.MaterialSupport.TEXTURED.vertextFormat}),e=new sS({geometry:t}),i=this.getShaderSorce(),n=new aS({fabric:{type:"satelliteMaterial",uniforms:{color:this._color||lS.WHITE,repeat:this.slices,offset:0,thickness:this.thickness,sign:this.inverse?1:-1},source:i}}),r=new uS({modelMatrix:this._matrix,show:this.show,geometryInstances:e,appearance:new oS({material:n}),asynchronous:!1});this.scanPrimitive=this.primitive.add(r),this.stopAnimate&&this.stopAnimate()}trackSatellite(){if(this._viewer)if(this._tracked){const t=new Cesium.BoundingSphere(this._position,this._height);this._viewer.camera.viewBoundingSphere(t),this._viewer.camera.lookAtTransform(this._matrix)}else this._viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY)}get inverse(){return this._inverse}set inverse(t){this._inverse=t,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.sign=t?1:-1)}get slices(){return this._slices}set slices(t){this._slices=t,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.repeat=t)}get thickness(){return this._thickness}set thickness(t){t<0&&(t=0),t>1&&(t=1),this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.thickness=t)}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this.transform(t)}get axis(){return this._axis}get tracked(){return this._tracked}set tracked(t){t!==this._tracked&&(this._tracked=t,this.trackSatellite())}get color(){return this._color}set color(t){this._color=t,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.color=t)}get animation(){return this._animation}set animation(t){t!==this._animation&&(t?this.stopAnimate=this._viewer.scene.preUpdate.addEventListener((()=>{hS(this)})):(this.stopAnimate&&this.stopAnimate(),this.stopAnimate=void 0),this._animation=t)}getShaderSorce(){return"\n    uniform vec4 color;\n    uniform float repeat;\n    uniform float offset;\n    uniform float thickness;\n    uniform float sign;\n    czm_material czm_getMaterial(czm_materialInput inputM){\n      czm_material material=czm_getDefaultMaterial(inputM);\n      float sp=1.0/repeat;\n      vec2 st=inputM.st;\n      float dis=distance(st,vec2(0.5));\n      float m=mod(dis + sign * offset,sp);\n      float a=step(sp*(1.0-thickness),m);\n      material.diffuse=color.rgb;\n      material.alpha=a*color.a;\n      return material;\n    }"}zoomTo(t){if(!this.show||!this._viewer)return;const e=new Cesium.BoundingSphere(this._position,this._height);this._viewer.camera.flyToBoundingSphere(e,{duration:t})}transform(t){t&&(t.x&&cS(this,t.x,new ZE(1,0,0)),t.y&&cS(this,t.y,new ZE(0,1,0)),t.z&&cS(this,t.z,new ZE(0,0,1)))}},t.Scene=gb,t.SectorGeometry=class{constructor(t){if(!kl((t=Fl(t,Fl.EMPTY_OBJECT)).center))throw new Ol("parameter center is required.");if(!kl(t.radius))throw new Ol("parameter radius is required.");if(!kl(t.fov))throw new Ol("parameter fov is required.");this._center=t.center,this._radius=t.radius,this._fov=t.fov,this._slices=Fl(t.slices,this._fov),this._rotation=Cesium.Math.toRadians(Fl(t.rotation,0)),this._vertexFormat=Fl(t.vertexFormat,cI.POSITION_AND_ST),this._extrudedHeight=Fl(t.extrudedHeight,0),this._height=Fl(t.height,0),this._positions=void 0,this._workerName="createSectorGeometry",this._rectangle=void 0}get center(){return this._center}get rotation(){return Cesium.Math.toDegrees(this._rotation)}get radius(){return this._radius}get fov(){return this._fov}get positions(){return this._positions}get vertexFormat(){return this._vertexFormat}get extrudedHeight(){return this._extrudedHeight}get height(){return this._height}get slices(){return this._slices}static createGeometry(t){const e=[],i=Cesium.Transforms.eastNorthUpToFixedFrame(t._center),n=t._fov/t._slices,r=t.rotation;t._vertexNumber=2*t.slices;const o=[],s=[],a=[];for(let s=0,l=t._slices;s<l;s++){const l=t._radius*Math.cos(Cesium.Math.toRadians(r+n*s)),u=t._radius*Math.sin(Cesium.Math.toRadians(r+n*s)),c=new Cesium.Cartesian3(l,u,0),h=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(i,c,h),e.push(h.x,h.y,h.z),o.push(.5*Math.cos(Cesium.Math.toRadians(r+n*s))+.5),o.push(.5*Math.sin(Cesium.Math.toRadians(r+n*s))+.5),a.push(0,0,1)}a.push(0,0,1),o.push(.5,.5),e.push(t.center.x,t.center.y,t.center.z);const l=e.length/3-1;0!==t.height&&Cesium.PolygonPipeline.scaleToGeodeticHeight(e,t.height,Cesium.Ellipsoid.WGS84,!1);for(let e=0;e<t._slices-1;e++)s.push(e),s.push(l),s.push(e+1);const u={position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:new Float64Array(e)})};return t.vertexFormat.normal&&(u.normal=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:a})),t.vertexFormat.st&&(u.st=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:o})),new Cesium.Geometry({attributes:u,indices:Cesium.IndexDatatype.createTypedArray(t._vertexNumber,s),primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:Cesium.BoundingSphere.fromVertices(e)})}},t.Selection=ay,t.ShaderProgram=function(){const t=Nw.prototype;Nw.prototype={},Nw.prototype._bind=function(){Uw(this),this._gl.useProgram(this._program)},Nw.prototype.destroy=t.destroy,Nw.prototype._setUniforms=function(e,i,n){t._setUniforms.call(this,e,i,n)},Nw.prototype.isDestroyed=t.isDestroyed,Nw.prototype.finalDestroy=t.finalDestroy,Object.defineProperties(Nw.prototype,{vertexAttributes:{get:function(){return Uw(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return Uw(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return Uw(this),this._uniformsByName}},vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}}})},t.ShapefileDataSource=ax,t.SnowEffect=class extends uI{constructor(t){super(t),this._fragmentShader=Fl(this._options.fragmentShader,hI),this._thickness=Fl(this._options.thickness,.5),this._density=Fl(this._options.density,10),this._speed=Fl(this._options.speed,350);const e={alpha:()=>this.thickness,snowDensity:()=>this.density,speed:()=>this.speed};this._uniforms=Fl(this._options.uniforms,e)}get thickness(){return Cesium.Math.clamp(this._thickness,0,1)}set thickness(t){this._thickness=t}get density(){return Cesium.Math.clamp(this._density,0,20)}set density(t){this._density=t}get speed(){const t=this._speed;return 10+Cesium.Math.clamp(390-t,0,390)}set speed(t){this._speed=t}createPostStage(){return new Cesium.PostProcessStage({fragmentShader:this._fragmentShader,uniforms:this._uniforms})}},t.SplitDirection=ly,t.TDTLayer=class extends US{constructor(t){const e=(t=Fl(t,{})).key;e||(console.warn("未定义key，地图服务将不可用"),console.warn("请前往http://lbs.tianditu.gov.cn/server/MapService.html获取地图key"));const i=Fl(t.tilingScheme,new Cesium.WebMercatorTilingScheme);let n="w",r="w",o=t.tileMatrixLabels;i instanceof Cesium.GeographicTilingScheme&&(n="c",r="c",kl(o)||(o=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"]));const s=Fl(t.layer,"img"),a=`http://t{s}.tianditu.com/${s}_${n}/wmts?service=wmts&tileMatrixSet=${r}&request=GetTile&version=1.0.0&LAYER=${s}&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=${e}`;return new Cesium.WebMapTileServiceImageryProvider({url:a,layer:s,style:t.style||"default",format:t.format||"tiles",tileMatrixSetID:"GoogleMapsCompatible",credit:t.credit?new Cesium.Credit(t.credit||""):null,tilingScheme:t.tilingScheme,maximumLevel:t.maximumLevel||19,minimumLevel:t.minimumLevel||0,tileMatrixLabels:o,subdomains:"01234567"})}static layers=[{layer:"vec",desc:"矢量底图"},{layer:"cva",desc:"矢量注记"},{layer:"img",desc:"影像底图"},{layer:"cia",desc:"影像注记"},{layer:"ter",desc:"地形晕渲"},{layer:"cta",desc:"地形注记"},{layer:"ibo",desc:"全球境界"},{layer:"eva",desc:"矢量英文注记"},{layer:"eia",desc:"影像英文注记"}]},t.TMSLayer=jS,t.TaskProcessor=class{constructor(t,e={}){this._workers=[],this._workerPath="workers/"+t,this._options=e,Math.max(zd.hardwareConcurrency-1,1),this._worker=Vd(this)}},t.TecentLayer=class extends $y{constructor(t={}){t.layer=Fl(t.layer,"img"),t.subdomains="123",t.url=VS[t.layer],t.customTags={sx:function(t,e,i,n){return e>>4},sy:function(t,e,i,n){return(1<<n)-i>>4}},super(t)}},t.TileDebugLayer=class{constructor(t={}){t.tileWidth=Fl(t.tileWidth,256),t.tileHeight=Fl(t.tileHeight,256),this._tilingScheme=kl(t.tilingScheme)?t.tilingScheme:iy.get("EPSG:4326",{ellipsoid:t.ellipsoid}),this._errorEvent=new jl,this._tileWidth=Fl(t.tileWidth,256),this._tileHeight=Fl(t.tileHeight,256),this._readyPromise=Promise.resolve(!0),this._font=Fl(t.font,"bold 24px sans-serif"),this._color=Fl(t.color,new Cesium.Color(1,1,1,1)),this._borderColor=Fl(t.borderColor,Cesium.Color.GOLD),this._borderWidth=Fl(t.borderWidth,2)}get ready(){return!0}get readyPromise(){return this._readyPromise}get hasAlphaChannel(){return!0}get errorEvent(){return this._errorEvent}get rectangle(){return this._tilingScheme.rectangle}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get tilingScheme(){return this._tilingScheme}get font(){return this._font}set font(t){this._font=t}get color(){return this._color}set color(t){this._color=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get borderWidth(){return this._borderWidth}createCanvas(){const t=document.createElement("canvas");t.width=this.tileWidth,t.height=this.tileHeight;const e=t.getContext("2d");return e.textBaseline="middle",e.textAlign="center",e.font=this.font,e.fillStyle=HS(this.color),e.strokeStyle=HS(this.color),e.lineWidth=this.borderWidth,{canvas:t,ctx:e}}requestImage(t,e,i,n){const{canvas:r,ctx:o}=this.createCanvas(),s=function(t,e,i,n){let r=[];return r[0]="L: "+n,r[1]="X: "+e,t.reverseY?r[2]="Y: "+t.tilingScheme.getNumberOfYTilesAtLevel(n)-i-1:r[2]="Y: "+i,r}(this,t,e,i);return o.fillText(s[0],r.width/2,r.height/4*1),o.fillText(s[1],r.width/2,r.height/4*2),o.fillText(s[2],r.width/2,r.height/4*3),o.strokeRect(0,0,r.width,r.height),Promise.resolve(r)}},t.TileLayer=class{constructor(t={}){this._errorEvent=new jl,this._tilingScheme=iy.get("EPSG:4326"),this._ready=!1,this._ready=!0,this._minimumLevel=Fl(t.minimumLevel,0),this._maximumLevel=t.maximumLevel,this._tileWidth=Fl(t.tileWidth,256),this._tileHeight=Fl(t.tileHeight,256),this._rectangle=Fl(t.rectangle,WS.MAX_VALUE),this._readyPromise=Promise.resolve(!0),this._errorEvent.addEventListener(((t,e,i)=>{}))}get errorEvent(){return this._errorEvent}get minimumLevel(){return this._minimumLevel}get maximumLevel(){return this._maximumLevel}get errorEvent(){return this._errorEvent}get rectangle(){return this._rectangle}get ready(){return this._ready}get readyPromise(){return this._readyPromise}get tilingScheme(){return this._tilingScheme}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(t){this._tileProvider.enablePickFeatures=t}get tileHeight(){return this._tileHeight}get tileWidth(){return this._tileWidth}pickFeatures(t,e,i,n,r){}requestImage(t,e,i,n){return this.requestGeometry(t,e,i),Promise.reject(!1)}requestGeometry(t,e,i){}},t.Tileset=yx,t.TransformHelper=class{constructor(t={}){this.lineWidth=_y(t.lineWidth,15),this.xAxisColor=_y(t.xAxisColor,my.RED),this.yAxisColor=_y(t.yAxisColor,my.GREEN),this.zAxisColor=_y(t.zAxisColor,my.BLUE),this.scaleAxisColor=_y(t.scaleAxisColor,my.WHITE),this.activeAxisColor=_y(t.activeAxisColor,my.YELLOW),this.originColor=_y(t.originColor,my.WHITE),this._translateEnabled=_y(t.translateEnabled,!0),this._rotateEnabled=_y(t.rotateEnabled,!1),this._scaleEnabled=_y(t.scaleEnabled,!1),this._radiusRatio=_y(t.radiusRatio,1),this.xAxisLength=t.xAxisLength,this.yAxisLength=t.yAxisLength,this.zAxisLength=t.zAxisLength,this.scaleAxisLength=t.scaleAxisLength,this.root=new dy,this.object=null,this._modelMatrix=void 0,this._primitives=[],this._center=new yy,this._radius=0,this._originOffset=_y(t.originOffset,new yy),this._selectedPrimitives=[],this._offset=new yy(0,0,0),this._angle=0,this.rotatePlaneRadius=t.rotatePlaneRadius,this._mode=jy,this.preTranformEvent=new jl,this.postTransformEvent=new jl}get translateEnabled(){return this._translateEnabled}set translateEnabled(t){this._translateEnabled=t;for(let e of this._primitives){const i=e.axis;i&&(i.includes(Yy)||i.includes(Xy)||(e.show=t))}}get rotateEnabled(){return this._rotateEnabled}set rotateEnabled(t){this._rotateEnabled=t;for(let e of this._primitives){const i=e.axis;i&&(i.includes(Yy)&&(e.show=t))}}get scaleEnabled(){return this._scaleEnabled}set scaleEnabled(t){this._scaleEnabled=t;for(let e of this._primitives){const i=e.axis;i&&(i.includes(Xy)&&(e.show=t))}}get center(){return yy.add(this._center,this._originOffset,new yy)}get modelMatrix(){return this._modelMatrix}set modelMatrix(t){if(!t)return this._modelMatrix=void 0,void(this._inverseModelMatrix=void 0);this._modelMatrix=t,this._inverseModelMatrix=Cy.inverse(t,new Cy)}createMoveAxis(){if(!this.center)return;const t=this._radius*this._radiusRatio,e=this.axisRoot,i=this.center;let n=[i,new yy(_y(this.xAxisLength,t)+i.x,i.y,i.z)];this.xAxis=e.add({positions:n,width:this.lineWidth,material:this.getAxisMaterial(this.xAxisColor)}),this.xNormal=new yy,yy.subtract(n[1],n[0],this.xNormal),yy.normalize(this.xNormal,this.xNormal),this.xAux=e.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.xAxis.axis="X",this.xAxis.color=this.xAxisColor,n=[i,new yy(i.x,-_y(this.yAxisLength,t)+i.y,i.z)],this.yAxis=e.add({positions:n,width:this.lineWidth,material:this.getAxisMaterial(this.yAxisColor)}),this.yNormal=new yy,yy.subtract(n[1],n[0],this.yNormal),yy.normalize(this.yNormal,this.yNormal),this.yAux=e.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.yAxis.axis="Y",this.yAxis.color=this.yAxisColor,n=[i,new yy(i.x,i.y,_y(this.zAxisLength,t)+i.z)],this.zAxis=e.add({positions:n,width:this.lineWidth,material:this.getAxisMaterial(this.zAxisColor)}),this.zNormal=new yy,yy.subtract(n[1],n[0],this.zNormal),yy.normalize(this.zNormal,this.zNormal),this.zAux=e.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.zAxis.axis="Z",this.zAxis.color=this.zAxisColor,this._primitives.push(this.xAxis,this.yAxis,this.zAxis)}createAxisPlane(){this.XOYPlane=this.root.add(new Bp({color:this.zAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new yy(0,0,1),axis:"XY"})),this.XOYPlane.relativeAxis=[this.xAxis,this.yAxis],this.XOZPlane=this.root.add(new Bp({color:this.yAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new yy(0,1,0),axis:"XZ"})),this.XOZPlane.relativeAxis=[this.xAxis,this.zAxis],this.YOZPlane=this.root.add(new Bp({color:this.xAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new yy(1,0,0),axis:"YZ"})),this.YOZPlane.relativeAxis=[this.yAxis,this.zAxis],this._primitives.push(this.XOYPlane,this.YOZPlane,this.XOZPlane)}createOrignPoint(){const t=new by({modelMatrix:this.modelMatrix});this.origin=t.add({show:!0,position:this.center,pixelSize:1.5*this.lineWidth,color:this.originColor}),this.origin.axis="XYZ",this.origin.pcolor=this.originColor,this.root.add(t),this._primitives.push(this.origin)}getAxisMaterial(t,e=!1,i=16){return new gy(e?{fabric:{type:"dasharrow",source:uy,uniforms:{color:t,gapColor:my.TRANSPARENT,dashLength:i,dashPattern:255}}}:{fabric:{type:"PolylineArrow",uniforms:{color:t}}})}createRotateAxis(){const t=[],e=this.rotatePlaneRadius||this._radius*this._radiusRatio,i=this.center;for(let n=0;n<=360;n++){const r=n/180*Math.PI;t.push(new yy(i.x+e*Math.cos(r),i.y+e*Math.sin(r),i.z))}this.zRotate=this.axisRoot.add({positions:[...t],width:this.lineWidth,material:this.getAxisMaterial(this.zAxisColor,!0,0)}),this.zRotate.axis="RZ",this.zRotate.color=this.zAxisColor,this.zRotate.normal=new yy(0,0,1),t.splice(0);for(let n=0;n<=360;n++){const r=n/180*Math.PI;t.push(new yy(i.x+e*Math.cos(r),i.y,i.z+e*Math.sin(r)))}this.yRotate=this.axisRoot.add({positions:[...t],width:this.lineWidth,material:this.getAxisMaterial(this.yAxisColor,!0,0)}),this.yRotate.axis="RY",this.yRotate.color=this.yAxisColor,this.yRotate.normal=new yy(0,1,0),t.splice(0);for(let n=0;n<=360;n++){const r=n/180*Math.PI;t.push(new yy(i.x,i.y+e*Math.cos(r),i.z+e*Math.sin(r)))}this.xRotate=this.axisRoot.add({positions:[...t],width:this.lineWidth,material:this.getAxisMaterial(this.xAxisColor,!0,0)}),this.xRotate.axis="RX",this.xRotate.color=this.xAxisColor,this.xRotate.normal=new yy(-1,0,0),this.rAxuStart=this.axisRoot.add({positions:[],width:this.lineWidth/2,material:this.getAxisMaterial(this.activeAxisColor,!0,0)}),this.rAxuEnd=this.axisRoot.add({positions:[],width:this.lineWidth/2,material:this.getAxisMaterial(this.activeAxisColor,!0,0)}),this._primitives.push(this.xRotate,this.yRotate,this.zRotate,this.rAxuStart,this.rAxuEnd)}createScaleAxis(){const t=this._radius*this._radiusRatio;let e=new yy(1,1,1);this.xNormal&&this.yNormal&&this.zNormal&&(yy.add(this.xNormal,this.yNormal,e),yy.add(e,this.zNormal,e)),yy.normalize(e,e);const i=_y(this.scaleAxisLength,t),n=new yy;yy.multiplyByScalar(e,i,n),yy.add(this._center,n,n),this.scaleAxis=this.axisRoot.add({positions:[this._center,n],width:this.lineWidth,material:this.getAxisMaterial(this.scaleAxisColor)}),this._primitives.push(this.scaleAxis),this.scaleAxis.axis="SXYZ",this.scaleAxis.color=this.scaleAxisColor}bind(t){if(!this._viewer)throw new Ol("please call addTo method to add to viewer");this.unbind(),this._hasBindObject=!0,t instanceof py&&(t=t.delegate),this.object=t,t instanceof Ly!=!1?(this.modelMatrix=t.modelMatrix,t.readyPromise.then((()=>{const e=yy.clone(t.boundingSphere.center);Cy.multiplyByPoint(this._inverseModelMatrix,e,this._center),this._radius=t.boundingSphere.radius,this.createPrimitive()}))):this.bindPosition(t)}bindPosition(t){if("function"==typeof t.getValue&&(t=t.getValue(this._viewer.clock.currentTime)),t instanceof yy==!1)throw new Ol("position is invalid");this._hasBindObject=!0,this.modelMatrix=My.eastNorthUpToFixedFrame(t),this._center=new yy,yy.clone(this.originOffset,this._center),this._radius=10,this.rotateEnabled=!1,this.scaleEnabled=!1,this.createPrimitive(!1)}createPrimitive(t=!0){const e=new fy({modelMatrix:this.modelMatrix});this.axisRoot=e,this.root.add(e),this.createOrignPoint(),this.translateEnabled&&this.createMoveAxis(),this.translateEnabled&&this.createAxisPlane(),t&&this.rotateEnabled&&this.createRotateAxis(),t&&this.scaleEnabled&&this.createScaleAxis()}unbind(){this.object=void 0,this.root.removeAll(),this.origon=void 0,this.xAxis=void 0,this.yAxis=void 0,this.zAxis=void 0,this.modelMatrix=void 0,this._hasBindObject=!1}addTo(t){this._viewer=t,t.scene.primitives.add(this.root),this.addEventListener()}addEventListener(){const t=this._viewer,e=new Ey(t.canvas);e.setInputAction((i=>{if(!this._hasBindObject)return;const n=t.scene.pick(i.position);n&&this._primitives.includes(n.primitive)&&(this._mousedownPixel=i.position,this.active(n.primitive),this._offset=new yy,this._angle=0,e.setInputAction((t=>{const{startPosition:e,endPosition:i}=t;this.transform(e,i)}),Sy.MOUSE_MOVE),t.scene.screenSpaceCameraController.enableRotate=!1)}),Sy.LEFT_DOWN),e.setInputAction((i=>{this._hasBindObject&&(this.active(null),e.removeInputAction(Sy.MOUSE_MOVE),t.scene.screenSpaceCameraController.enableRotate=!0,this.translateEnabled&&(this.xAux.positions=[],this.yAux.positions=[],this.zAux.positions=[]),this.rotateEnabled&&(this.rAxuStart.positions=[],this.rAxuEnd.positions=[]))}),Sy.LEFT_UP),this._removeEventListener=function(){e.removeInputAction(Sy.LEFT_DOWN),e.removeInputAction(Sy.LEFT_UP)}}active(t){if(t||this.activePrimitive){if(!t&&this.activePrimitive){if(By(this.activePrimitive,this.activePrimitive.pcolor||this.activePrimitive.color),this.activePrimitive.isAxisPlane)for(let t of this.activePrimitive.relativeAxis)By(t,t.color);return this.activePrimitive=void 0,void(this._mode=jy)}if(t.isAxisPlane)for(let e of t.relativeAxis)By(e,this.activeAxisColor);if(this.activePrimitive=t,By(this.activePrimitive,this.activeAxisColor),t.axis)if(t.axis.includes("R")){this._mode=Yy;const t=Uy(this._mousedownPixel,this);this.rAxuStart.positions=[this.center,t],this._startLocalPosition=t}else t.axis.includes("S")?this._mode=Xy:this._mode=qy}}remove(){this._viewer.scene.primitives.remove(this.root),this._removeEventListener(),this._primitives.splice(0)}transform(t,e){if(this.preTranformEvent.raise(Cy.clone(this.modelMatrix,{})),this.activePrimitive===this.origin){const t=zl.toCartesian(zl.fromPixel(e,this._viewer));Cy.setTranslation(this._modelMatrix,t,this._modelMatrix),this.modelMatrix=this._modelMatrix;for(let t of this.root._primitives)t.modelMatrix=this.modelMatrix}else if(this._mode===qy)Wy(this,t,e,Ry),this.translate(Ry);else if(this._mode===Yy){const i=function(t,e,i){const n=t.center;yy.subtract(e,n,e),yy.subtract(i,n,i);const r=yy.dot(yy.normalize(e,e),yy.normalize(i,i)),o=yy.subtract(e,i,ky),s=e,a=yy.cross(o,s,ky),l=t.activePrimitive.normal,u=Ay.sign(yy.dot(a,l));return Math.acos(r)*u}(this,Uy(t,this),Uy(e,this));this.rotate(i)}else if(this._mode=Xy){Wy(this,t,e,Ry);const i=-Ry.sxyz/yy.distance(...this.scaleAxis.positions)+1;this.scale(new yy(i,i,i))}this.postTransformEvent.raise(Cy.clone(this.modelMatrix,{}))}scale(t){const e=Cy.fromScale(t,zy);Cy.multiply(this._modelMatrix,e,this._modelMatrix),this.modelMatrix=this._modelMatrix;for(let t of this.root._primitives)Cy.multiply(t.modelMatrix,e,t.modelMatrix)}rotate(t){this._angle+=t;const e=this.activePrimitive.normal,i=Cy.fromTranslation(this.center,zy),n=wy.fromAxisAngle(e,t,Oy),r=xy.fromQuaternion(n,Fy),o=Cy.fromTranslation(yy.negate(this.center,ky),Gy);Cy.multiply(this.modelMatrix,i,this.modelMatrix),Cy.multiplyByMatrix3(this.modelMatrix,r,this.modelMatrix),Cy.multiply(this.modelMatrix,o,this.modelMatrix);for(let t of this.root._primitives)Cy.multiply(t.modelMatrix,i,t.modelMatrix),Cy.multiplyByMatrix3(t.modelMatrix,r,t.modelMatrix),Cy.multiply(t.modelMatrix,o,t.modelMatrix);this.modelMatrix=this._modelMatrix,this.createRotateAux(this._startLocalPosition,this._angle)}translate(t){if(!this.activePrimitive)return;const e=this.activePrimitive.axis;-1===e.indexOf("X")&&(t.x=0),-1===e.indexOf("Y")&&(t.y=0),-1===e.indexOf("Z")&&(t.z=0),t.x=-t.x,t.z=-t.z,yy.add(this._offset,t,this._offset);const i=Cy.fromTranslation(t);Cy.multiply(this._modelMatrix,i,this._modelMatrix),this.modelMatrix=this._modelMatrix;for(let t of this.root._primitives)Cy.multiply(t.modelMatrix,i,t.modelMatrix);this.createAux(this._offset,i)}createAux(t){if(t.x>0){const e=yy.clone(this.xAxis.positions[0]),i=yy.clone(this.xAxis.positions[0]);i.x+=-t.x,this.xAux.positions=[e,i]}else{const e=yy.clone(this.xAxis.positions[1]),i=yy.clone(this.xAxis.positions[1]);i.x+=-t.x,this.xAux.positions=[e,i]}if(t.y<0){const e=yy.clone(this.yAxis.positions[0]),i=yy.clone(this.yAxis.positions[0]);i.y+=-t.y,this.yAux.positions=[e,i]}else{const e=yy.clone(this.yAxis.positions[1]),i=yy.clone(this.yAxis.positions[1]);i.y+=-t.y,this.yAux.positions=[e,i]}if(t.z>0){const e=yy.clone(this.zAxis.positions[0]),i=yy.clone(this.zAxis.positions[0]);i.z+=-t.z,this.zAux.positions=[e,i]}else{const e=yy.clone(this.zAxis.positions[1]),i=yy.clone(this.zAxis.positions[1]);i.z+=-t.z,this.zAux.positions=[e,i]}}createRotateAux(t,e){if(!this._startLocalPosition)return;const i=wy.fromAxisAngle(this.activePrimitive.normal,-e),n=xy.fromQuaternion(i,Fy),r=Cy.fromRotation(n,zy);let o=yy.subtract(t,this.center,ky);Cy.multiplyByPoint(r,o,o),yy.add(this.center,o,o),this.rAxuEnd.positions=[this.center,o]}},t.UniformState=yb,t.Url=kd,t.VERSION="1.1.1",t.VectorTileProvider=Hx,t.ViewShadowPrimitive=Zu,t.ViewShedAnalyser=class extends Yl{constructor(t,e){if(super(t),e=Fl(e,{}),this._options=e,!kl(e.observe))throw new Ol("parameter options.observe is required.");if(!kl(e.viewPosition))throw new Ol("parameter options.viewPosition is required.");this._observe=e.observe,this._viewPosition=e.viewPosition,this._debug=Fl(e.debug,!1),this._far=Fl(e.far,Cesium.Cartesian3.distance(this._observe,this._viewPosition)),this._near=Fl(e.near,.001*this._far),this._aspectRatio=Fl(e.aspectRatio,1.5),this._fov=Fl(e.fov,120);const i=Cesium.Cartesian3.subtract(this._viewPosition,this._observe,new Cesium.Cartesian3);this._direction=Cesium.Cartesian3.normalize(i,i),this._up=t.scene.mapProjection.ellipsoid.geodeticSurfaceNormal(this._observe,new Cesium.Cartesian3),this._heading=void 0,this._pitch=void 0,this._roll=void 0}do(){this.preAnalysis.raise(),this.update(),this.postAnalysis.raise()}clear(){this._viewer.scene.primitives.remove(this._frustum),this._viewer.scene.primitives.remove(this._shadowMap)}destroy(){this.clear(),this._frustum&&!this._frustum.isDestroyed()&&this._frustum.destroy(),this._shadowMap&&!this._shadowMap.isDestroyed()&&this._shadowMap.destroy(),super.destroy(this)}get frustum(){return this._frustum}get debug(){return this._debug}set debug(t){this._debug!==t&&(this._debug=t,this._frustum.show=t)}get observe(){return this._observe}set observe(t){this._observe!==t&&(this._observe=t,this.update())}get viewPosition(){return this._viewPosition}set viewPosition(t){this._viewPosition!==t&&(this._viewPosition=t,this.update())}get direction(){return this._direction}get far(){return this._far}set far(t){this._far!==t&&(this._far=t,this.update())}get near(){return this._near}set near(t){this._near!==t&&(this._near=t,this.update())}get fov(){return this._fov}set fov(t){this._fov!==t&&(this._fov=t,this.update())}get aspectRatio(){return this._aspectRatio}set aspectRatio(t){this._aspectRatio!==t&&(this._aspectRatio=t,this.update())}get heading(){return this.updateHeadingPitchRoll(),Cesium.Math.toDegrees(this._heading)}get pitch(){return this.updateHeadingPitchRoll(),Cesium.Math.toDegrees(this._pitch)}get roll(){return this.updateHeadingPitchRoll(),Cesium.Math.toDegrees(this._roll)}update(){this.createOrupdateCamera(),this.createOrUpdateFrustum(),this.createOrUpdateShadowMap()}createOrupdateCamera(){kl(this._viewCamera)||(this._viewCamera=new Cesium.Camera(viewer.scene)),this._viewCamera.frustum.near=this._near,this._viewCamera.frustum.far=this._far,this._viewCamera.frustum.aspectRatio=this._aspectRatio,this._viewCamera.frustum.fov=Cesium.Math.toRadians(this.fov),this._viewCamera.direction=Cesium.Cartesian3.normalize(this._direction,this._viewCamera.direction),this._viewCamera.position=Cesium.Cartesian3.clone(this._observe,this._viewCamera.position),this._viewCamera.up=this._up,this._viewCamera.right=Cesium.Cartesian3.cross(this._viewCamera.up,this._viewCamera.direction,new Cesium.Cartesian3),kl(this._heading)||kl(this._pitch)||kl(this._roll)||this.updateHeadingPitchRoll()}updateHeadingPitchRoll(){const t=Cesium.Matrix4.clone(this._viewCamera._transform,new Cesium.Matrix4),e=Cesium.Transforms.eastNorthUpToFixedFrame(this._viewCamera.positionWC,this._viewCamera._projection.ellipsoid);var i;this._viewCamera._setTransform(e),this._pitch=(i=this._viewCamera.direction,mp.PI_OVER_TWO-mp.acosClamped(i.z)),this._heading=function(t,e){var i;return i=mp.equalsEpsilon(Math.abs(t.z),1,mp.EPSILON3)?Math.atan2(e.y,e.x)-mp.PI_OVER_TWO:Math.atan2(t.y,t.x)-mp.PI_OVER_TWO,mp.TWO_PI-mp.zeroToTwoPi(i)}(this._viewCamera.direction,this._viewCamera.up),this._roll=function(t,e,i){var n=0;return mp.equalsEpsilon(Math.abs(t.z),1,mp.EPSILON3)||(n=Math.atan2(-i.z,e.z),n=mp.zeroToTwoPi(n+mp.TWO_PI)),n}(this._viewCamera.direction,this._viewCamera.up,this._viewCamera.right),this._viewCamera._setTransform(t)}rotateLeft(t){const e=Cesium.Matrix4.clone(this._viewCamera._transform,new Cesium.Matrix4),i=Cesium.Transforms.eastNorthUpToFixedFrame(this._viewCamera.position,this._viewCamera._projection.ellipsoid);this._viewCamera._setTransform(i),this._viewCamera.rotateLeft(Cesium.Math.toRadians(t)),this._viewCamera._setTransform(e),Cesium.Cartesian3.clone(this._viewCamera.directionWC,this._direction),this.update()}rotateRight(t){this.rotateLeft(-t)}rotateDown(t){const e=Cesium.Matrix4.clone(this._viewCamera._transform,new Cesium.Matrix4),i=Cesium.Transforms.eastNorthUpToFixedFrame(this._viewCamera.position,this._viewCamera._projection.ellipsoid);this._viewCamera._setTransform(i),this._viewCamera.rotateDown(Cesium.Math.toRadians(t)),this._viewCamera._setTransform(e),Cesium.Cartesian3.clone(this._viewCamera.directionWC,this._direction),this.update()}rotateUp(t){this.rotateDown(-t)}createOrUpdateFrustum(){const t=this._viewCamera.positionWC,e=new Cesium.Matrix3,i=this._up,n=this.direction,r=Cesium.Cartesian3.cross(i,n,new Cesium.Cartesian3);Cesium.Matrix3.setColumn(e,0,r,e),Cesium.Matrix3.setColumn(e,1,i,e),Cesium.Matrix3.setColumn(e,2,n,e);const o=Cesium.Quaternion.fromRotationMatrix(e,new Cesium.Quaternion),s=Cesium.Matrix4.fromTranslationQuaternionRotationScale(t,o,new Cesium.Cartesian3(1,1,1),new Cesium.Matrix4);return this._frustum?(this._frustum.modelMatrix=s,this._frustum.xHalfAngle=this._fov/2,this._frustum.yHalfAngle=this._fov/2/this._aspectRatio,void(this._frustum.radius=this._far)):(this._frustum=new pp({radius:this._far,modelMatrix:s,xHalfAngle:this._fov/2,yHalfAngle:this._fov/2/this._aspectRatio,showScanPlane:!1,showLateralSurfaces:!1,material:Cesium.Material.fromType(Cesium.Material.ColorType,{color:Cesium.Color.AQUA.withAlpha(.3)}),show:this.debug}),this._viewer.scene.primitives.add(this._frustum),this._frustum)}createOrUpdateShadowMap(){if(kl(this._shadowMap)&&this._viewer.scene.primitives.remove(this._shadowMap),!this._viewCamera||!this._frustum._boundingSphereWC)return;this._frustum._boundingSphereWC;const t=this._options;t.lightCamera=this._viewCamera,t.context=this._viewer.scene.context;const e=new Xc(t),i=new Zu(e);return this._shadowMap=this._viewer.scene.primitives.add(i),this._shadowMap}},t.Viewer=qb,t.ViewshedMap=Xc,t.WFSLayer=xb,t.WMSLayer=qS,t.WMTSLayer=US,t.WaterFaceAppearance=class{constructor(t){return t=Fl(t,{}),this._normalMap=Fl(t.normalMap,wI.buildModuleUrl("./assets/images/waterNormal.jpg")),this._baseWaterColor=Fl(t.baseWaterColor,new Cesium.Color(0,.42,.71)),this._blendColor=Fl(t.blendColor,this._baseWaterColor),this._frequency=Fl(t.frequency,8e3),this._animationSpeed=Fl(t.animationSpeed,.02),this._amplitude=Fl(t.amplitude,5),this._specularIntensity=Fl(t.specularIntensity,.8),this._fadeFactor=Fl(t.fadeFactor,1),this._alpha=Fl(t.alpha,.4),this._material=new bI({fabric:{type:bI.WaterType,uniforms:{normalMap:this._normalMap,baseWaterColor:this._baseWaterColor,blendColor:this._blendColor,frequency:this._frequency,animationSpeed:this._animationSpeed,amplitude:this._amplitude,specularIntensity:this._specularIntensity,fadeFactor:this._fadeFactor}}}),new Cesium.MaterialAppearance({material:this._material,faceForward:!0,vertexShaderSource:this.vertexShaderSource,fragmentShaderSource:this.fragmentShaderSource})}get vertexShaderSource(){return pI}get fragmentShaderSource(){return dI.replace(/{alpha}/g,this._alpha)}},t.WaterFacePrimitive=class{constructor(t){if(t=Fl(t,{}),this._pointsToCartographic=[],this._waterPolygon=t.waterPolygon,!kl(this._waterPolygon))throw new Ol("paramater options.waterPolygon must be provided.");this._waterColor=Fl(t.waterColor,Cesium.Color.DARKCYAN),this._refractColor=Fl(t.refractColor,new PI(0,0,0,0)),this._reflectColor=Fl(t.reflectColor,new PI(.439,.564,.788,0)),this._waveWidth=Fl(t.waveWidth,5),this._flowDirection=Fl(t.flowDirection,45),this._flowSpeed=Fl(t.flowSpeed,3),this._normalTexture=Fl(t.normalTexture,kd.buildModuleUrl("./assets/images/waterNormal2.png")),this._m_startTime=0,this._reflectCamera=void 0,this._reflectPassState=void 0,this._ready=!1,this._drawCommand=void 0,this._show=Fl(t.show,!0)}get show(){return this._show}set show(t){this._show=t}get waterPolygon(){return this._waterPolygon}set waterPolygon(t){kl(t)&&(this._waterPolygon=t)}get waterColor(){return this._waterColor}set waterColor(t){this._waterColor=t}get refractColor(){return this._refractColor()}set refractColor(t){this._refractColor=t}get flowSpeed(){return this._flowSpeed}set flowSpeed(t){this._flowSpeed=t}get flowDirection(){return this._flowDirection}set flowDirection(t){this._flowDirection=t}get waveWidth(){return this._waveWidth}set waveWidth(t){this._waveWidth=t}get show(){return this._show}set show(t){this._show=t}computeBoundingRectangle(){const t=this._waterPolygon._polygonHierarchy.positions;if(t.length<1)throw new Ol("The positions of water polygon hierarchy is empty.");const e=MI.fromCartesian(t[0]);let i=uL.toDegrees(e.longitude),n=uL.toDegrees(e.latitude),r=uL.toDegrees(e.longitude),o=uL.toDegrees(e.latitude);this._zFactor=e.height;for(let e=0,s=t.length;e<s;e++){const s=MI.fromCartesian(t[e]),a=uL.toDegrees(s.longitude),l=uL.toDegrees(s.latitude),u=new DI(a,l);this._pointsToCartographic.push(u),a>r&&(r=a),a<i&&(i=a),l>o&&(o=l),l<n&&(n=l),this._lonMin=i,this._latMin=n,this._waterCenterPos=RI.fromDegrees((i+r)/2,(n+o)/2,this._zFactor)}}initialize(t){const{context:e,camera:i}=t;if(kl(this._reflectCamera)||(this._reflectCamera=OI.clone(i)),!kl(this._reflectPassState)){const t=new FI({context:e,colorTextures:[new II({context:e,width:512,height:512,pixelFormat:BI.RGBA})],depthRenderbuffer:new kI({context:e,format:UI.DEPTH_COMPONENT16,width:512,height:512})});this._reflectPassState=new zI(e),this._reflectPassState.viewport=new GI(0,0,512,512),this._reflectPassState.framebuffer=t}const n=this;this.m_spNormalTexture=t.context.defaultTexture,AI.fetchImage({url:n._normalTexture}).then((t=>{n.m_spNormalTexture=new II({context:e,width:t.width,height:t.height,source:t,sampler:new NI({wrapS:LI.REPEAT,wrapT:LI.REPEAT})})})),this._ready=!0,this.computeBoundingRectangle()}update(t){if(!this.show)return;const e=t.camera;this._ready||this.initialize(t);const i=t.context;this._fScale=1/(.001*this._waveWidth),VI.IDENTITY;const n=RI.clone(this._waterCenterPos),r=MI.fromCartesian(this._waterCenterPos),o=uL.toDegrees(r.longitude),s=uL.toDegrees(r.latitude),a=RI.fromDegrees(o,s,0),l=new RI;RI.normalize(a,l);const u=new RI(0,1,0),c=new RI;RI.cross(u,l,c),RI.normalize(c,c),RI.cross(l,c,u);const h=new HI;HI.setRow(h,0,c,h),HI.setRow(h,1,u,h),HI.setRow(h,2,l,h);const p=new HI;HI.transpose(h,p);const d=new RI,f=new RI(-n.x,-n.y,-n.z);HI.multiplyByVector(h,f,d);const g=new VI;VI.fromRotationTranslation(h,d,g),this.invWorldViewMatrix=new VI,VI.multiply(g,e.inverseViewMatrix,this.invWorldViewMatrix),this.modelMatrix=new VI,VI.fromTranslation(n,this.modelMatrix),this.modelViewMatrix=new VI,this.modeiViewProjection=new VI,this.modelViewMatrix=VI.multiply(e.viewMatrix,this.modelMatrix,this.modelViewMatrix),this.modeiViewProjection=VI.multiply(e.frustum.projectionMatrix,this.modelViewMatrix,this.modeiViewProjection),this._m_startTime||(this._m_startTime=WI.now().secondsOfDay),this._fElapse=WI.now().secondsOfDay-this._m_startTime,this._frameTime=this._fElapse*this.flowSpeed,this._flowAngle=uL.toRadians(this._flowDirection);const m=jI.fromCache({context:i,vertexShaderSource:TI,fragmentShaderSource:SI}),_=qI.fromCache({depthTest:{enabled:!0}}),y=this;this._uniformMap={u_bgColor:function(){return y._waterColor},u_texCoordOffset:function(){return new DI(-y._lonMin,-y._latMin)},u_texCoordScale:function(){return new DI(y._fScale,y._fScale)},u_scale:function(){return new RI(3,3,3)},u_camPosition:function(){return new RI(3,3,3)},u_modelViewProjectionMatrix:function(){return y.modeiViewProjection},u_modelViewMatrix:function(){return y.modelViewMatrix},u_clampToGroud:function(){return!1},u_invWorldViewMatrix:function(){return y.invWorldViewMatrix},u_frameTime:function(){return y._frameTime},u_normalMap:function(){return y.m_spNormalTexture},u_refractMap:function(){return y.m_spNormalTexture},u_useRefractTex:function(){return!1},u_reflectMap:function(){return y._reflectPassState.framebuffer.getColorTexture(0)},u_reflection:function(){return 1},u_waterColor:function(){return y._waterColor},u_refractColor:function(){return y._refractColor},u_reflectColor:function(){return y._reflectColor},u_flowDirection:function(){return new DI(.5*Math.sin(y._flowAngle)+.5,.5*Math.cos(y._flowAngle)+.5)}},this._waterGeometry=YI.createGeometry(this._waterPolygon);const v=this._waterGeometry.indices,C=this._waterGeometry.attributes.position.values,x=[];RI.pack(n,x);for(let t=0;t<C.length;t++)C[t]+=-x[t%3];const w=[];for(let t=0,e=this._pointsToCartographic.length;t<e;t++)w.push(this._pointsToCartographic[t].x,this._pointsToCartographic[t].y);const b=XI.createIndexBuffer({context:i,typedArray:new Uint32Array(v),usage:$I.STATIC_DRAW,indexDatatype:lL.UNSIGNED_INT}),E=XI.createVertexBuffer({context:i,typedArray:QI.createTypedArray(QI.FLOAT,C),usage:$I.STATIC_DRAW}),S=XI.createVertexBuffer({context:i,typedArray:QI.createTypedArray(QI.FLOAT,w),usage:$I.STATIC_DRAW}),T=[];T.push({index:0,vertexBuffer:E,componentDatatype:QI.FLOAT,componentsPerAttribute:3,normalize:!1}),T.push({index:1,vertexBuffer:S,componentDatatype:QI.FLOAT,componentsPerAttribute:2,normalize:!1});const P=new ZI({context:i,attributes:T,indexBuffer:b});this.updateReflectTexture(t),this._drawCommand=new KI({boundingVolume:this._waterGeometry.boundingSphere,primitiveType:tL.TRIANGLES,vertexArray:P,shaderProgram:m,castShadows:!1,receiveShadows:!1,uniformMap:this._uniformMap,renderState:_,pass:eL.OPAQUE}),t.commandList.push(this._drawCommand)}updateReflectTexture(t){const e=t.context,i=t.camera;this.modelViewMatrix=VI.multiply(i.viewMatrix,this.modelMatrix,this.modelViewMatrix),this.modeiViewProjection=VI.multiply(i.frustum.projectionMatrix,this.modelViewMatrix,this.modeiViewProjection);const n=RI.clone(this._waterCenterPos),r=new RI;RI.normalize(n,r);const o=iL.fromPointNormal(n,r),s=-RI.dot(r,n),a=new VI(-2*r.x*r.x+1,-2*r.x*r.y,-2*r.x*r.z,-2*r.x*s,-2*r.y*r.x,-2*r.y*r.y+1,-2*r.y*r.z,-2*r.y*s,-2*r.z*r.x,-2*r.z*r.y,-2*r.z*r.z+1,-2*r.z*s,0,0,0,1),l=new RI;RI.clone(i.direction,l);const u=new RI,c=new RI;RI.multiplyByScalar(r,2*RI.dot(l,r),u),RI.subtract(l,u,c),RI.normalize(c,c);const h=new RI;RI.clone(i.up,h);const p=new RI,d=new RI,f=RI.dot(h,r);RI.multiplyByScalar(r,2*f,d),RI.add(h,d,p),RI.normalize(p,p);const g=new RI(-p.x,-p.y,-p.z),m=new nL;RI.clone(i.position,m);const _=new RI;VI.multiplyByPoint(a,m,_);const y=new VI;i.frustum.far=1e8,VI.clone(i.frustum.projectionMatrix,y),this._reflectCamera.direction=c,f<.5&&(this._reflectCamera.up=g),f>=.5&&(this._reflectCamera.up=p),this._reflectCamera.position=_;const v=new VI;VI.inverse(this._reflectCamera.viewMatrix,v),VI.transpose(v,v);const C=new nL(o.normal.x,o.normal.y,o.normal.z,-RI.dot(r,r));VI.multiplyByVector(v,C,C);const x=C.w/Math.sqrt(C.x*C.x+C.y*C.y+C.z*C.z),w=new RI(C.x,C.y,C.z);RI.normalize(w,w);const b=new nL;b.x=(Math.asin(w.x)+y[8])/y[0],b.y=(Math.asin(w.y)+y[9])/y[5],b.z=-1,b.w=(1+y[10])/y[14];const E=new nL(w.x,w.y,w.z,x),S=new RI;nL.multiplyByScalar(E,2/nL.dot(E,b),S),y[2]=S.x,y[6]=S.y,y[10]=S.z+1,y[14]=S.w,VI.clone(y,this._reflectCamera.frustum.projectionMatrix);new rL({color:PI.fromBytes(14,33,60,255),depth:1,framebuffer:this._reflectPassState.framebuffer}).execute(e,this._reflectPassState),this.updateTexture(t,this._reflectPassState,this._reflectCamera)}updateTexture(t,e,i){const n=t.context,r=n.uniformState,o=t.camera;t.camera=i,r.updateCamera(i);const s=t.commandList,a=s.length,l=Cesium.Pass;for(let i=0;i<a;i++){const o=s[i];o.pass!==l.GLOBE&&o.pass!==l.CESIUM_3D_TILE&&o.pass!==l.OPAQUE&&o.pass!==l.TRANSLUCENT&&o.pass!==l.ENVIRONMENT&&o.pass!==l.OVERLAY||(r.updatePass(o.pass),cL(o,t,n,e))}r.updateCamera(o),t.camera=o}destroy(){return this._drawCommand&&(this._drawCommand=this._drawCommand&&this._drawCommand.shaderProgram.destroy()),sL(this)}},t.WindField=class{constructor(t,e){const i={};i.speedFactor=Fl(e.speedFactor,1),i.lineWidth=Fl(e.lineWidth,4),i.dropRateBump=Fl(e.dropRateBump,.01),i.dropRate=Fl(e.dropRate,.003),i.particlesTextureSize=Math.ceil(Math.sqrt(Fl(e.maxParticles,4096))),i.maxParticles=i.particlesTextureSize*i.particlesTextureSize,i.fadeOpacity=Fl(e.fadeOpacity,.996),i.particleHeight=Fl(e.particleHeight,100),i.color=Fl(e.color,qL.WHITE),this._maxParticles=i.maxParticles,this._color=Fl(e.color,"#FFFFFF"),this.viewer=t,this.scene=this.viewer.scene,this.camera=this.viewer.camera,this.options=i,this.viewerParameters={lonRange:new VL,latRange:new VL,pixelSize:0},this.globeBoundingSphere=new WL(HL.ZERO,6314355.63),this.updateViewerParameters(),this.imageryLayers=this.viewer.imageryLayers,this.primitives=new jL,this.viewer.scene.primitives.add(this.primitives)}get fadeOpacity(){return this.particleSystem.userInput.fadeOpacity}set fadeOpacity(t){this.particleSystem.userInput.fadeOpacity=t}get particleHeight(){return this.particleSystem.userInput.particleHeight}set particleHeight(t){this.particleSystem.userInput.particleHeight=t}get color(){return this.particleSystem.userInput.color}set color(t){this.particleSystem.userInput.color=t}get maxParticles(){return this._maxParticles}set maxParticles(t){this._maxParticles=t;const e=this.particleSystem.userInput.maxParticles!==t,i=Math.ceil(Math.sqrt(t));this.particleSystem.userInput.particlesTextureSize=i,this.particleSystem.userInput.maxParticles=i*i,this.particleSystem.refreshParticles(e)}get show(){return this.primitives.show}set show(t){this.primitives.show=t}get speedFactor(){return this.particleSystem.userInput.speedFactor}set speedFactor(t){this.particleSystem.userInput.speedFactor=t}get lineWidth(){return this.particleSystem.userInput.lineWidth}set lineWidth(t){this.particleSystem.userInput.lineWidth=t}loadDataFromNC(t){kL.loadData(t).then((t=>{this.loadDataFromJson(t)}))}loadDataFromJson(t){this.particleSystem=new UL(this.scene.context,t,this.options,this.viewerParameters),this.addPrimitives(),this.setupEventListeners()}remove(){this.viewer.scene.primitives.remove(this.primitives)}addPrimitives(){const t=this.primitives;t.add(this.particleSystem.particlesComputing.primitives.calculateSpeed),t.add(this.particleSystem.particlesComputing.primitives.updatePosition),t.add(this.particleSystem.particlesComputing.primitives.postProcessingPosition),t.add(this.particleSystem.particlesRendering.primitives.segments),t.add(this.particleSystem.particlesRendering.primitives.trails),t.add(this.particleSystem.particlesRendering.primitives.screen)}updateViewerParameters(){const t=this.camera.computeViewRectangle(this.scene.globe.ellipsoid),e=zL.viewRectangleToLonLatRange(t);this.viewerParameters.lonRange.x=e.lon.min,this.viewerParameters.lonRange.y=e.lon.max,this.viewerParameters.latRange.x=e.lat.min,this.viewerParameters.latRange.y=e.lat.max;const i=this.camera.getPixelSize(this.globeBoundingSphere,this.scene.drawingBufferWidth,this.scene.drawingBufferHeight);i>0&&(this.viewerParameters.pixelSize=i)}setupEventListeners(){const t=this,e=this.camera.moveStart.addEventListener((function(){console.log("xxxxxxxxxxx"),t.primitives.show=!1})),i=this.camera.moveEnd.addEventListener((function(){t.updateViewerParameters(),t.particleSystem.applyViewerParameters(t.viewerParameters),t.primitives.show=!0}));let n=!1;function r(){n=!0,t.primitives.show=!1,t.primitives.removeAll()}window.addEventListener("resize",r);const o=this.scene.preRender.addEventListener((function(){n&&(t.particleSystem.canvasResize(t.scene.context),n=!1,t.addPrimitives(),t.scene.primitives.show=!0)}));this.removeEventListener=function(){e(),i(),o(),window.removeEventListener("resize",r)}}destroy(){this.remove(),this.removeEventListener&&this.removeEventListener(),Wu(this)}},t.XYZLayer=$y,t._shaderBloom="\n#define NUM_MIPS 5\nvarying vec2 v_textureCoordinates;\nuniform sampler2D blurTexture1;\nuniform sampler2D blurTexture2;\nuniform sampler2D blurTexture3;\nuniform sampler2D blurTexture4;\nuniform sampler2D blurTexture5;\nuniform sampler2D colorTexture;\nuniform float bloomStrength;\nuniform float bloomRadius;\nuniform float bloomFactors[NUM_MIPS];\nuniform vec3 bloomTintColors[NUM_MIPS];\nfloat lerpBloomFactor(const in float factor){\n  float mirrorFactor=1.2-factor;\n  return mix(factor,mirrorFactor,bloomRadius);\n}\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  gl_FragColor=bloomStrength*(\n    lerpBloomFactor(bloomFactors[0])*vec4(bloomTintColors[0],1.0)*texture2D(blurTexture1,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[1])*vec4(bloomTintColors[1],1.0)*texture2D(blurTexture2,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[2])*vec4(bloomTintColors[2],1.0)*texture2D(blurTexture3,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[3])*vec4(bloomTintColors[3],1.0)*texture2D(blurTexture4,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[4])*vec4(bloomTintColors[4],1.0)*texture2D(blurTexture5,v_textureCoordinates)\n  )+color;\n}",t._shaderBuildUniforms=eN,t._shaderCircleScan=eE,t._shaderCircleSpread=rE,t._shaderDynamicConeMaterial=aE,t._shaderDynamicSpreadMaterial=ZT,t._shaderDynamicSpreadWallMaterial=XT,t._shaderDynamicWaveMaterial=iP,t._shaderEllipsoid=$L,t._shaderFloodMaterial=ju,t._shaderFlowImage=oI,t._shaderFog="\nfloat getDistance(sampler2D depthTexture, vec2 texCoords)\n{\n  float depth = czm_unpackDepth(texture2D(depthTexture, texCoords));\n  if (depth == 0.0) {\n      return czm_infinity;\n  }\n      vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depth);\n  return -eyeCoordinate.z / eyeCoordinate.w;\n}\nfloat interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n  float startDistance = nearFarScalar.x;\n  float startValue = 1.0-nearFarScalar.y;\n  float endDistance = nearFarScalar.z;\n  float endValue = 1.0-nearFarScalar.w;\n  float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n  return mix(startValue, endValue, t);\n}\nvec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)\n{\n  return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);\n}\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform vec4 fogByDistance;\nuniform vec4 fogColor;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\n    float distance = getDistance(depthTexture, v_textureCoordinates);\n    vec4 sceneColor = texture2D(colorTexture, v_textureCoordinates);\n    float blendAmount = interpolateByDistance(fogByDistance, distance);\n    vec4 finalFogColor = vec4(fogColor.rgb, fogColor.a * blendAmount);\n    gl_FragColor = alphaBlend(finalFogColor, sceneColor);\n} ",t._shaderGetDepth=XL,t._shaderGetWgs84EllipsoidEC=JL,t._shaderGlobeFS=Wx,t._shaderGroundSkyBoxFS=h_,t._shaderGroundSkyBoxVS=p_,t._shaderInClipRegion=KL,t._shaderPhong=ZL,t._shaderPolylineAntialiasingMaterial=uy,t._shaderPolylineFlowMaterial=cP,t._shaderPolylineTrailLinkMaterial=_P,t._shaderRadarScan=$E,t._shaderRain="\nuniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nuniform float speed;\nuniform float angle;\nfloat hash(float x){\n    return fract(sin(x*133.3)*13.13);\n}\n\nvoid main(void){\n\n    float time = czm_frameNumber / speed;\n    vec2 resolution = czm_viewport.zw;\n\n    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n    vec3 c=vec3(.6,.7,.8);\n    //方向\n    float a=angle;\n    float si=sin(a),co=cos(a);\n    uv*=mat2(co,-si,si,co);\n    uv*=length(uv+vec2(0,4.9))*.3+1.;\n\n    float v=1.-sin(hash(floor(uv.x*100.))*2.);\n    float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;\n    c*=v*b;\n\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5);\n}",t._shaderRectangularSensorComm=Dh,t._shaderRectangularSensorFS=Rh,t._shaderRectangularSensorScanPlaneFS=Mh,t._shaderRectangularSensorVS=Oh,t._shaderSelected="\nuniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  if(czm_selected()){\n    gl_FragColor=color;\n  }else{\n    gl_FragColor=vec4(0.0);\n  }\n}\n",t._shaderSeperableBlur="\nuniform sampler2D colorTexture;\nuniform vec2 direction;\nuniform float scale;\nuniform float bloomRadius;\nfloat gaussianPdf(in float x, in float sigma) {\n  return 0.39894 * exp(-0.5 * x * x/(sigma * sigma))/sigma;\n}\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  float fSigma=float(SIGMA);\n  vec2 size=vec2(czm_viewport.z,czm_viewport.w)*scale*fSigma*2.0;\n  vec2 invSize=(1.0+bloomRadius)/size;\n  float weightSum=gaussianPdf(0.0,fSigma);\n  vec3 diffuseSum=texture2D(colorTexture,v_textureCoordinates).rgb*weightSum;\n  bool selected=false;\n  for(int i=0;i<KERNEL_RADIUS;i++){\n    float x=float(i);\n    float w=gaussianPdf(x,fSigma);\n    vec2 uvOffset=direction*invSize*x;\n    vec3 sample1=texture2D(colorTexture,v_textureCoordinates+uvOffset).rgb;\n    vec3 sample2=texture2D(colorTexture,v_textureCoordinates-uvOffset).rgb;\n    diffuseSum+=(sample1+sample2)*w;\n    weightSum+=2.0*w;\n  }\n  gl_FragColor=vec4(diffuseSum/weightSum,2.0);\n}\n",t._shaderSnow=hI,t._shaderSpecularReflection="\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nvec4 toEye(in vec2 uv, in float depth){\n    vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n    vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n    posInCamera =posInCamera / posInCamera.w;\n    return posInCamera;\n}\nfloat getDepth(in vec4 depth){\n    float z_window = czm_unpackDepth(depth);\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\nvec3 guussColor(vec2 uv){\n    vec2 pixelSize = 1.0 / czm_viewport.zw;\n    float dx0 = -pixelSize.x;\n    float dy0 = -pixelSize.y;\n    float dx1 = pixelSize.x;\n    float dy1 = pixelSize.y;\n    vec4 gc = (\n        texture2D(colorTexture, uv)+\n        texture2D(colorTexture, uv + vec2(dx0, dy0)) +\n        texture2D(colorTexture, uv + vec2(0.0, dy0)) +\n        texture2D(colorTexture, uv + vec2(dx1, dy0)) +\n        texture2D(colorTexture, uv + vec2(dx0, 0.0)) +\n        texture2D(colorTexture, uv + vec2(dx1, 0.0)) +\n        texture2D(colorTexture, uv + vec2(dx0, dy1)) +\n        texture2D(colorTexture, uv + vec2(0.0, dy1)) +\n        texture2D(colorTexture, uv + vec2(dx1, dy1))\n    ) * (1.0 / 9.0);\n    return gc.rgb;\n}\nvoid main(){\n    float offset = 0.0;\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    vec4 currD = texture2D(depthTexture, v_textureCoordinates);\n    if(currD.r>=1.0){\n        gl_FragColor = color;\n        return;\n    }\n    float depth = getDepth(currD);\n\n    vec4 positionEC = toEye(v_textureCoordinates, depth);\n    vec3 dx = dFdx(positionEC.xyz);\n    vec3 dy = dFdy(positionEC.xyz);\n    vec3 normal = normalize(cross(dx,dy));\n    vec4 positionWC = normalize(czm_inverseView * positionEC);\n    vec3 normalWC = normalize(czm_inverseViewRotation * normal);\n    float fotNumWC = dot(positionWC.xyz,normalWC);\n    if(fotNumWC<=0.5){\n        gl_FragColor = color;\n        return;\n    }\n\n    vec3 viewDir = normalize(positionEC.xyz);\n    vec3 reflectDir = reflect(viewDir, normal);\n    // vec3 viewReflectDir = czm_viewRotation * reflectDir;\n    vec3 viewReflectDir = reflectDir;\n\n\n    float step = 0.05;\n    int stepNum = int(20.0 / step);\n    vec3 pos;\n    vec3 albedo;\n    bool jd = false;\n    for(int i = 1;i <= 400;i++)\n    {\n        float delta = step * float(i) + offset;\n        pos = positionEC.xyz + viewReflectDir * delta;\n        float d = -pos.z;\n\n        vec4 tmp = czm_projection * vec4(pos,1.0);\n        vec3 screenPos = tmp.xyz / tmp.w;\n        vec2 uv = vec2(screenPos.x, screenPos.y) * 0.5 + vec2(0.5, 0.5);\n\n        if(uv.x > 0.0 && uv.x < 1.0 && uv.y > 0.0 && uv.y < 1.0){\n            float dd = getDepth(texture2D(depthTexture, uv));\n            vec4 jzc = toEye(uv, dd);\n            dd = -jzc.z;\n            if(d>dd){\n                if(abs(abs(d) - abs(dd)) <=step){\n                    jd = true;\n                    // albedo = texture2D(colorTexture, uv).rgb;\n                    albedo = guussColor(uv);\n                }\n                break;\n            }\n        }\n    }\n    if(jd){\n        gl_FragColor = vec4(mix(color.xyz,albedo,0.5),1.0);\n    }else{\n        gl_FragColor = color;\n    }\n}",t._shaderToEye=YL,t._shaderTranslucentPhong=QL,t._shaderWaterAppearanceFS=dI,t._shaderWaterAppearanceVS=pI,t._shaderWaterFaceFS=SI,t._shaderWaterFaceVS=TI,t.abstract=_p,t.attachCustomUniforms=bp,t.checkViewer=Hl,t.clone=Pd,t.computeDistancePerPixel=tf,t.computeSceneCenterPoint=ef,t.computeSceneExtent=nf,t.createDefaultLayer=Jy,t.createGuid=of,t.createInRegionShader=af,t.customPrimitive=hL,t.dataProcess=kL,t.dateFormat=t_,t.defaultValue=Fl,t.defined=kl,t.destroyObject=Wu,t.getParabolaPoints=function(t,e,i=5e3,n=50){const r=i>5e3?i:5e3,o=Math.abs(t.lon-e.lon)>Math.abs(t.lat-e.lat),s=o?Math.abs(t.lon-e.lon):Math.abs(t.lat-e.lat),a=n>50?n:50,l=[];let u=s/a;if(o){const i=(e.lat-t.lat)/a;t.lon-e.lon>0&&(u=-u);for(let e=0;e<a;e++){const n=r-4*Math.pow(-.5*s+Math.abs(u)*e,2)*r/Math.pow(s,2),o=t.lon+u*e,a=t.lat+i*e;l.push([o,a,n])}}else{const i=(e.lon-t.lon)/a;t.lat-e.lat>0&&(u=-u);for(let e=0;e<a;e++){const n=r-4*Math.pow(-.5*s+Math.abs(u)*e,2)*r/Math.pow(s,2),o=t.lon+i*e,a=t.lat+u*e;l.push([o,a,n])}}return l},t.guid=ql,t.index=vb,t.particleSystem=UL,t.particlesComputing=GL,t.particlesRendering=BL,t.pickPosition=J_,t.proj=iy,t.randomPosition=function(t,e=1){const i=t.west,n=t.east,r=t.south,o=t.north;e<1&&(e=1);const s=[];for(let t=0;t<e;t++){const t=i+Math.random()*(n-i),e=r+Math.random()*(o-r);s.push(Cesium.Cartesian3.fromRadians(t,e))}return s},t.rotateEnabled=oy,t.util=zL}));
