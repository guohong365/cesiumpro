!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CesiumPro={})}(this,(function(e){"use strict";var t=6371008.8,i={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*t,kilometers:6371.0088,kilometres:6371.0088,meters:t,metres:t,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:t/1852,radians:1,yards:6967335.223679999};function n(e,t,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=t||{},n.geometry=e,n}function r(e,t,i){if(void 0===i&&(i={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!u(e[0])||!u(e[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:e},t,i)}function o(e,t,i){void 0===i&&(i={});for(var r=0,o=e;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:e},t,i)}function s(e,t,i){if(void 0===i&&(i={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:e},t,i)}function a(e,t){void 0===t&&(t={});var i={type:"FeatureCollection"};return t.id&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.features=e,i}function l(e){return 180*(e%(2*Math.PI))/Math.PI}function c(e){return e%360*Math.PI/180}function u(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function h(e){return!!e&&e.constructor===Object}function d(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function p(e){return"Feature"===e.type?e.geometry:e}function m(e,t,n){void 0===n&&(n={});var r=d(e),o=d(t),s=c(o[1]-r[1]),a=c(o[0]-r[0]),l=c(r[1]),u=c(o[1]),h=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(l)*Math.cos(u);return function(e,t){void 0===t&&(t="kilometers");var n=i[t];if(!n)throw new Error(t+" units is invalid");return e*n}(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),n.units)}function f(e,t,i){if(null!==e)for(var n,r,o,s,a,l,c,u,h=0,d=0,p=e.type,m="FeatureCollection"===p,g="Feature"===p,y=m?e.features.length:1,v=0;v<y;v++){a=(u=!!(c=m?e.features[v].geometry:g?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<a;_++){var x=0,C=0;if(null!==(s=u?c.geometries[_]:c)){l=s.coordinates;var w=s.type;switch(h=!i||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===t(l,d,v,x,C))return!1;d++,x++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===t(l[n],d,v,x,C))return!1;d++,"MultiPoint"===w&&x++}"LineString"===w&&x++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(r=0;r<l[n].length-h;r++){if(!1===t(l[n][r],d,v,x,C))return!1;d++}"MultiLineString"===w&&x++,"Polygon"===w&&C++}"Polygon"===w&&x++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(C=0,r=0;r<l[n].length;r++){for(o=0;o<l[n][r].length-h;o++){if(!1===t(l[n][r][o],d,v,x,C))return!1;d++}C++}x++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===f(s.geometries[n],t,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function g(e,t){var i,n,r,o,s,a,l,c,u,h,d=0,p="FeatureCollection"===e.type,m="Feature"===e.type,f=p?e.features.length:1;for(i=0;i<f;i++){for(a=p?e.features[i].geometry:m?e.geometry:e,c=p?e.features[i].properties:m?e.properties:{},u=p?e.features[i].bbox:m?e.bbox:void 0,h=p?e.features[i].id:m?e.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,d,c,u,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===t(o.geometries[n],d,c,u,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,d,c,u,h))return!1;d++}}function y(e,t){g(e,(function(e,i,r,o,s){var a,l=null===e?null:e.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==t(n(e,r,{bbox:o,id:s}),i,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<e.coordinates.length;c++){var u=e.coordinates[c];if(!1===t(n({type:a,coordinates:u},r),i,c))return!1}}))}function v(e,t,i){var n=i,r=!1;return function(e,t){y(e,(function(e,i,n){var r=0;if(e.geometry){var o=e.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var a,l=0,c=0,u=0;return!1!==f(e,(function(o,h,d,p,m){if(void 0===a||i>l||p>c||m>u)return a=o,l=i,c=p,u=m,void(r=0);var f=s([a,o],e.properties);if(!1===t(f,i,n,m,r))return!1;r++,a=o}))&&void 0}}}))}(e,(function(e,o,s,a,l){n=!1===r&&void 0===i?e:t(n,e,o,s,a,l),r=!0})),n}function _(e,t,i){if(void 0===i&&(i={}),!0===i.final)return function(e,t){var i=_(t,e);return i=(i+180)%360}(e,t);var n=d(e),r=d(t),o=c(n[0]),s=c(r[0]),a=c(n[1]),u=c(r[1]),h=Math.sin(s-o)*Math.cos(u),p=Math.cos(a)*Math.sin(u)-Math.sin(a)*Math.cos(u)*Math.cos(s-o);return l(Math.atan2(h,p))}function x(e,t,n,o){void 0===o&&(o={});var s=d(e),a=c(s[0]),u=c(s[1]),h=c(n),p=function(e,t){void 0===t&&(t="kilometers");var n=i[t];if(!n)throw new Error(t+" units is invalid");return e/n}(t,o.units),m=Math.asin(Math.sin(u)*Math.cos(p)+Math.cos(u)*Math.sin(p)*Math.cos(h));return r([l(a+Math.atan2(Math.sin(h)*Math.sin(p)*Math.cos(u),Math.cos(p)-Math.sin(u)*Math.sin(m))),l(m)],o.properties)}function C(e,t,i,n){if(!h(n=n||{}))throw new Error("options is invalid");var r,o=[];if("Feature"===e.type)r=e.geometry.coordinates;else{if("LineString"!==e.type)throw new Error("input must be a LineString Feature or Geometry");r=e.coordinates}for(var a,l,c,u=r.length,d=0,p=0;p<r.length&&!(t>=d&&p===r.length-1);p++){if(d>t&&0===o.length){if(!(a=t-d))return o.push(r[p]),s(o);l=_(r[p],r[p-1])-180,c=x(r[p],a,l,n),o.push(c.geometry.coordinates)}if(d>=i)return(a=i-d)?(l=_(r[p],r[p-1])-180,c=x(r[p],a,l,n),o.push(c.geometry.coordinates),s(o)):(o.push(r[p]),s(o));if(d>=t&&o.push(r[p]),p===r.length-1)return s(o);d+=m(r[p],r[p+1],n)}if(d<t&&r.length===u)throw new Error("Start position is beyond line");var f=r[r.length-1];return s([f,f])}function w(e,t,i){if(!h(i=i||{}))throw new Error("options is invalid");var n=i.units,r=i.reverse;if(!e)throw new Error("geojson is required");if(t<=0)throw new Error("segmentLength must be greater than 0");var o=[];return y(e,(function(e){r&&(e.geometry.coordinates=e.geometry.coordinates.reverse()),function(e,t,i,n){var r=function(e,t){return void 0===t&&(t={}),v(e,(function(e,i){var n=i.geometry.coordinates;return e+m(n[0],n[1],t)}),0)}(e,{units:i});if(r<=t)return n(e);var o=r/t;Number.isInteger(o)||(o=Math.floor(o)+1);for(var s=0;s<o;s++){n(C(e,t*s,t*(s+1),{units:i}),s)}}(e,t,n,(function(e){o.push(e)}))})),a(o)}function b(e){var t=[1/0,1/0,-1/0,-1/0];return f(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}function S(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function T(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var i=function e(){if(this instanceof e){var i=[null];i.push.apply(i,arguments);var n=Function.bind.apply(t,i);return new n}return t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),i}function E(e,t,i){if(void 0===i&&(i={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var n=d(e),r=p(t),o=r.type,s=t.bbox,a=r.coordinates;if(s&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(n,s))return!1;"Polygon"===o&&(a=[a]);for(var l=!1,c=0;c<a.length&&!l;c++)if(P(n,a[c][0],i.ignoreBoundary)){for(var u=!1,h=1;h<a[c].length&&!u;)P(n,a[c][h],!i.ignoreBoundary)&&(u=!0),h++;u||(l=!0)}return l}function P(e,t,i){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var r=0,o=t.length-1;r<t.length;o=r++){var s=t[r][0],a=t[r][1],l=t[o][0],c=t[o][1];if(e[1]*(s-l)+a*(l-e[0])+c*(e[0]-s)==0&&(s-e[0])*(l-e[0])<=0&&(a-e[1])*(c-e[1])<=0)return!i;a>e[1]!=c>e[1]&&e[0]<(l-s)*(e[1]-a)/(c-a)+s&&(n=!n)}return n}b.default=b;var A=6378137;function M(e){return function(e,t,i){var n=i;return g(e,(function(e,r,o,s,a){n=0===r&&void 0===i?e:t(n,e,r,o,s,a)})),n}(e,(function(e,t){return e+function(e){var t,i=0;switch(e.type){case"Polygon":return L(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)i+=L(e.coordinates[t]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)}),0)}function L(e){var t=0;if(e&&e.length>0){t+=Math.abs(D(e[0]));for(var i=1;i<e.length;i++)t-=Math.abs(D(e[i]))}return t}function D(e){var t,i,n,r,o,s,a=0,l=e.length;if(l>2){for(s=0;s<l;s++)s===l-2?(n=l-2,r=l-1,o=0):s===l-1?(n=l-1,r=0,o=1):(n=s,r=s+1,o=s+2),t=e[n],i=e[r],a+=(R(e[o][0])-R(t[0]))*Math.sin(R(i[1]));a=a*A*A/2}return a}function R(e){return e*Math.PI/180}function I(e,t,i){void 0===i&&(i={});for(var n=d(e),r=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(t),o=0;o<r.length-1;o++){var s=!1;if(i.ignoreEndVertices&&(0===o&&(s="start"),o===r.length-2&&(s="end"),0===o&&o+1===r.length-1&&(s="both")),k(r[o],r[o+1],n,s,void 0===i.epsilon?null:i.epsilon))return!0}return!1}function k(e,t,i,n,r){var o=i[0],s=i[1],a=e[0],l=e[1],c=t[0],u=t[1],h=c-a,d=u-l,p=(i[0]-a)*d-(i[1]-l)*h;if(null!==r){if(Math.abs(p)>r)return!1}else if(0!==p)return!1;return n?"start"===n?Math.abs(h)>=Math.abs(d)?h>0?a<o&&o<=c:c<=o&&o<a:d>0?l<s&&s<=u:u<=s&&s<l:"end"===n?Math.abs(h)>=Math.abs(d)?h>0?a<=o&&o<c:c<o&&o<=a:d>0?l<=s&&s<u:u<s&&s<=l:"both"===n&&(Math.abs(h)>=Math.abs(d)?h>0?a<o&&o<c:c<o&&o<a:d>0?l<s&&s<u:u<s&&s<l):Math.abs(h)>=Math.abs(d)?h>0?a<=o&&o<=c:c<=o&&o<=a:d>0?l<=s&&s<=u:u<=s&&s<=l}function O(e,t){var i=p(e),n=p(t),r=i.type,o=n.type;switch(r){case"Point":switch(o){case"MultiPoint":return function(e,t){var i,n=!1;for(i=0;i<t.coordinates.length;i++)if(F(t.coordinates[i],e.coordinates)){n=!0;break}return n}(i,n);case"LineString":return I(i,n,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return E(i,n,{ignoreBoundary:!0});default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"MultiPoint":return function(e,t){for(var i=0;i<e.coordinates.length;i++){for(var n=!1,r=0;r<t.coordinates.length;r++)F(e.coordinates[i],t.coordinates[r])&&(n=!0);if(!n)return!1}return!0}(i,n);case"LineString":return function(e,t){for(var i=!1,n=0;n<e.coordinates.length;n++){if(!I(e.coordinates[n],t))return!1;i||(i=I(e.coordinates[n],t,{ignoreEndVertices:!0}))}return i}(i,n);case"Polygon":case"MultiPolygon":return function(e,t){for(var i=!0,n=!1,r=0;r<e.coordinates.length;r++){if(!(n=E(e.coordinates[1],t))){i=!1;break}n=E(e.coordinates[1],t,{ignoreBoundary:!0})}return i&&n}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"LineString":return function(e,t){for(var i=0;i<e.coordinates.length;i++)if(!I(e.coordinates[i],t))return!1;return!0}(i,n);case"Polygon":case"MultiPolygon":return function(e,t){var i=b(t),n=b(e);if(!N(i,n))return!1;for(var r=!1,o=0;o<e.coordinates.length-1;o++){if(!E(e.coordinates[o],t))return!1;if(r||(r=E(e.coordinates[o],t,{ignoreBoundary:!0})),!r)r=E(z(e.coordinates[o],e.coordinates[o+1]),t,{ignoreBoundary:!0})}return r}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Polygon":case"MultiPolygon":return function(e,t){var i=b(e);if(!N(b(t),i))return!1;for(var n=0;n<e.coordinates[0].length;n++)if(!E(e.coordinates[0][n],t))return!1;return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}}function N(e,t){return!(e[0]>t[0])&&(!(e[2]<t[2])&&(!(e[1]>t[1])&&!(e[3]<t[3])))}function F(e,t){return e[0]===t[0]&&e[1]===t[1]}function z(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}
/**
     * splaytree v3.1.2
     * Fast Splay tree for Node and browser
     *
     * @author Alexander Milevski <info@w8r.name>
     * @license MIT
     * @preserve
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
function B(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var G=function(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null};function H(e,t){return e>t?1:e<t?-1:0}function W(e,t,i){for(var n=new G(null,null),r=n,o=n;;){var s=i(e,t.key);if(s<0){if(null===t.left)break;if(i(e,t.left.key)<0){var a=t.left;if(t.left=a.right,a.right=t,null===(t=a).left)break}o.left=t,o=t,t=t.left}else{if(!(s>0))break;if(null===t.right)break;if(i(e,t.right.key)>0){a=t.right;if(t.right=a.left,a.left=t,null===(t=a).right)break}r.right=t,r=t,t=t.right}}return r.right=t.left,o.left=t.right,t.left=n.right,t.right=n.left,t}function U(e,t,i,n){var r=new G(e,t);if(null===i)return r.left=r.right=null,r;var o=n(e,(i=W(e,i,n)).key);return o<0?(r.left=i.left,r.right=i,i.left=null):o>=0&&(r.right=i.right,r.left=i,i.right=null),r}function j(e,t,i){var n=null,r=null;if(t){var o=i((t=W(e,t,i)).key,e);0===o?(n=t.left,r=t.right):o<0?(r=t.right,t.right=null,n=t):(n=t.left,t.left=null,r=t)}return{left:n,right:r}}function V(e,t,i,n,r){if(e){n(t+(i?"└── ":"├── ")+r(e)+"\n");var o=t+(i?"    ":"│   ");e.left&&V(e.left,o,!1,n,r),e.right&&V(e.right,o,!0,n,r)}}var q=function(){function e(e){void 0===e&&(e=H),this._root=null,this._size=0,this._comparator=e}return e.prototype.insert=function(e,t){return this._size++,this._root=U(e,t,this._root,this._comparator)},e.prototype.add=function(e,t){var i=new G(e,t);null===this._root&&(i.left=i.right=null,this._size++,this._root=i);var n=this._comparator,r=W(e,this._root,n),o=n(e,r.key);return 0===o?this._root=r:(o<0?(i.left=r.left,i.right=r,r.left=null):o>0&&(i.right=r.right,i.left=r,r.right=null),this._size++,this._root=i),this._root},e.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},e.prototype._remove=function(e,t,i){var n;return null===t?null:0===i(e,(t=W(e,t,i)).key)?(null===t.left?n=t.right:(n=W(e,t.left,i)).right=t.right,this._size--,n):t},e.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=W(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},e.prototype.findStatic=function(e){for(var t=this._root,i=this._comparator;t;){var n=i(e,t.key);if(0===n)return t;t=n<0?t.left:t.right}return null},e.prototype.find=function(e){return this._root&&(this._root=W(e,this._root,this._comparator),0!==this._comparator(e,this._root.key))?null:this._root},e.prototype.contains=function(e){for(var t=this._root,i=this._comparator;t;){var n=i(e,t.key);if(0===n)return!0;t=n<0?t.left:t.right}return!1},e.prototype.forEach=function(e,t){for(var i=this._root,n=[],r=!1;!r;)null!==i?(n.push(i),i=i.left):0!==n.length?(i=n.pop(),e.call(t,i),i=i.right):r=!0;return this},e.prototype.range=function(e,t,i,n){for(var r=[],o=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,t)>0)break;if(o(s.key,e)>=0&&i.call(n,s))return this;s=s.right}return this},e.prototype.keys=function(){var e=[];return this.forEach((function(t){var i=t.key;return e.push(i)})),e},e.prototype.values=function(){var e=[];return this.forEach((function(t){var i=t.data;return e.push(i)})),e},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.left;)e=e.left;return e},e.prototype.maxNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.right;)e=e.right;return e},e.prototype.at=function(e){for(var t=this._root,i=!1,n=0,r=[];!i;)if(t)r.push(t),t=t.left;else if(r.length>0){if(t=r.pop(),n===e)return t;n++,t=t.right}else i=!0;return null},e.prototype.next=function(e){var t=this._root,i=null;if(e.right){for(i=e.right;i.left;)i=i.left;return i}for(var n=this._comparator;t;){var r=n(e.key,t.key);if(0===r)break;r<0?(i=t,t=t.left):t=t.right}return i},e.prototype.prev=function(e){var t=this._root,i=null;if(null!==e.left){for(i=e.left;i.right;)i=i.right;return i}for(var n=this._comparator;t;){var r=n(e.key,t.key);if(0===r)break;r<0?t=t.left:(i=t,t=t.right)}return i},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return function(e){var t=e,i=[],n=!1,r=new G(null,null),o=r;for(;!n;)t?(i.push(t),t=t.left):i.length>0?t=(t=o=o.next=i.pop()).right:n=!0;return o.next=null,r.next}(this._root)},e.prototype.load=function(e,t,i){void 0===t&&(t=[]),void 0===i&&(i=!1);var n=e.length,r=this._comparator;if(i&&X(e,t,0,n-1,r),null===this._root)this._root=$(e,t,0,n),this._size=n;else{var o=function(e,t,i){var n=new G(null,null),r=n,o=e,s=t;for(;null!==o&&null!==s;)i(o.key,s.key)<0?(r.next=o,o=o.next):(r.next=s,s=s.next),r=r.next;null!==o?r.next=o:null!==s&&(r.next=s);return n.next}(this.toList(),function(e,t){for(var i=new G(null,null),n=i,r=0;r<e.length;r++)n=n.next=new G(e[r],t[r]);return n.next=null,i.next}(e,t),r);n=this._size+n,this._root=Y({head:o},0,n)}return this},e.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){void 0===e&&(e=function(e){return String(e.key)});var t=[];return V(this._root,"",!0,(function(e){return t.push(e)}),e),t.join("")},e.prototype.update=function(e,t,i){var n=this._comparator,r=j(e,this._root,n),o=r.left,s=r.right;n(e,t)<0?s=U(t,i,s,n):o=U(t,i,o,n),this._root=function(e,t,i){return null===t?e:(null===e||((t=W(e.key,t,i)).left=e),t)}(o,s,n)},e.prototype.split=function(e){return j(e,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var e,t,i;return B(this,(function(n){switch(n.label){case 0:e=this._root,t=[],i=!1,n.label=1;case 1:return i?[3,6]:null===e?[3,2]:(t.push(e),e=e.left,[3,5]);case 2:return 0===t.length?[3,4]:[4,e=t.pop()];case 3:return n.sent(),e=e.right,[3,5];case 4:i=!0,n.label=5;case 5:return[3,1];case 6:return[2]}}))},e}();function $(e,t,i,n){var r=n-i;if(r>0){var o=i+Math.floor(r/2),s=e[o],a=t[o],l=new G(s,a);return l.left=$(e,t,i,o),l.right=$(e,t,o+1,n),l}return null}function Y(e,t,i){var n=i-t;if(n>0){var r=t+Math.floor(n/2),o=Y(e,t,r),s=e.head;return s.left=o,e.head=e.head.next,s.right=Y(e,r+1,i),s}return null}function X(e,t,i,n,r){if(!(i>=n)){for(var o=e[i+n>>1],s=i-1,a=n+1;;){do{s++}while(r(e[s],o)<0);do{a--}while(r(e[a],o)>0);if(s>=a)break;var l=e[s];e[s]=e[a],e[a]=l,l=t[s],t[s]=t[a],t[a]=l}X(e,t,i,a,r),X(e,t,a+1,n,r)}}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Q(e,t,i){return t&&Z(e.prototype,t),i&&Z(e,i),e}var K=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},ee=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var i=e.ll.x<t.ll.x?t.ll.x:e.ll.x,n=e.ur.x<t.ur.x?e.ur.x:t.ur.x;return{ll:{x:i,y:e.ll.y<t.ll.y?t.ll.y:e.ll.y},ur:{x:n,y:e.ur.y<t.ur.y?e.ur.y:t.ur.y}}},te=Number.EPSILON;void 0===te&&(te=Math.pow(2,-52));var ie=te*te,ne=function(e,t){if(-te<e&&e<te&&-te<t&&t<te)return 0;var i=e-t;return i*i<ie*e*t?0:e<t?-1:1},re=function(){function e(){J(this,e),this.reset()}return Q(e,[{key:"reset",value:function(){this.xRounder=new oe,this.yRounder=new oe}},{key:"round",value:function(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}]),e}(),oe=function(){function e(){J(this,e),this.tree=new q,this.round(0)}return Q(e,[{key:"round",value:function(e){var t=this.tree.add(e),i=this.tree.prev(t);if(null!==i&&0===ne(t.key,i.key))return this.tree.remove(e),i.key;var n=this.tree.next(t);return null!==n&&0===ne(t.key,n.key)?(this.tree.remove(e),n.key):e}}]),e}(),se=new re,ae=function(e,t){return e.x*t.y-e.y*t.x},le=function(e,t){return e.x*t.x+e.y*t.y},ce=function(e,t,i){var n={x:t.x-e.x,y:t.y-e.y},r={x:i.x-e.x,y:i.y-e.y},o=ae(n,r);return ne(o,0)},ue=function(e){return Math.sqrt(le(e,e))},he=function(e,t,i){var n={x:t.x-e.x,y:t.y-e.y},r={x:i.x-e.x,y:i.y-e.y};return le(r,n)/ue(r)/ue(n)},de=function(e,t,i){return 0===t.y?null:{x:e.x+t.x/t.y*(i-e.y),y:i}},pe=function(e,t,i){return 0===t.x?null:{x:i,y:e.y+t.y/t.x*(i-e.x)}},me=function(){function e(t,i){J(this,e),void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=i}return Q(e,null,[{key:"compare",value:function(t,i){var n=e.comparePoints(t.point,i.point);return 0!==n?n:(t.point!==i.point&&t.link(i),t.isLeft!==i.isLeft?t.isLeft?1:-1:ge.compare(t.segment,i.segment))}},{key:"comparePoints",value:function(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}}]),Q(e,[{key:"link",value:function(e){if(e.point===this.point)throw new Error("Tried to link already linked events");for(var t=e.point.events,i=0,n=t.length;i<n;i++){var r=t[i];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var e=this.point.events.length,t=0;t<e;t++){var i=this.point.events[t];if(void 0===i.segment.consumedBy)for(var n=t+1;n<e;n++){var r=this.point.events[n];void 0===r.consumedBy&&(i.otherSE.point.events===r.otherSE.point.events&&i.segment.consume(r.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var e=[],t=0,i=this.point.events.length;t<i;t++){var n=this.point.events[t];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&e.push(n)}return e}},{key:"getLeftmostComparator",value:function(e){var t=this,i=new Map,n=function(n){var r,o,s,a,l,c=n.otherSE;i.set(n,{sine:(r=t.point,o=e.point,s=c.point,a={x:o.x-r.x,y:o.y-r.y},l={x:s.x-r.x,y:s.y-r.y},ae(l,a)/ue(l)/ue(a)),cosine:he(t.point,e.point,c.point)})};return function(e,t){i.has(e)||n(e),i.has(t)||n(t);var r=i.get(e),o=r.sine,s=r.cosine,a=i.get(t),l=a.sine,c=a.cosine;return o>=0&&l>=0?s<c?1:s>c?-1:0:o<0&&l<0?s<c?-1:s>c?1:0:l<o?-1:l>o?1:0}}}]),e}(),fe=0,ge=function(){function e(t,i,n,r){J(this,e),this.id=++fe,this.leftSE=t,t.segment=this,t.otherSE=i,this.rightSE=i,i.segment=this,i.otherSE=t,this.rings=n,this.windings=r}return Q(e,null,[{key:"compare",value:function(e,t){var i=e.leftSE.point.x,n=t.leftSE.point.x,r=e.rightSE.point.x,o=t.rightSE.point.x;if(o<i)return 1;if(r<n)return-1;var s=e.leftSE.point.y,a=t.leftSE.point.y,l=e.rightSE.point.y,c=t.rightSE.point.y;if(i<n){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var u=e.comparePoint(t.leftSE.point);if(u<0)return 1;if(u>0)return-1;var h=t.comparePoint(e.rightSE.point);return 0!==h?h:-1}if(i>n){if(s<a&&s<c)return-1;if(s>a&&s>c)return 1;var d=t.comparePoint(e.leftSE.point);if(0!==d)return d;var p=e.comparePoint(t.rightSE.point);return p<0?1:p>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(r<o){var m=t.comparePoint(e.rightSE.point);if(0!==m)return m}if(r>o){var f=e.comparePoint(t.rightSE.point);if(f<0)return 1;if(f>0)return-1}if(r!==o){var g=l-s,y=r-i,v=c-a,_=o-n;if(g>y&&v<_)return 1;if(g<y&&v>_)return-1}return r>o?1:r<o||l<c?-1:l>c?1:e.id<t.id?-1:e.id>t.id?1:0}}]),Q(e,[{key:"replaceRightSE",value:function(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:e>t?e:t}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}},{key:"comparePoint",value:function(e){if(this.isAnEndpoint(e))return 0;var t=this.leftSE.point,i=this.rightSE.point,n=this.vector();if(t.x===i.x)return e.x===t.x?0:e.x<t.x?1:-1;var r=(e.y-t.y)/n.y,o=t.x+r*n.x;if(e.x===o)return 0;var s=(e.x-t.x)/n.x,a=t.y+s*n.y;return e.y===a?0:e.y<a?-1:1}},{key:"getIntersection",value:function(e){var t=this.bbox(),i=e.bbox(),n=ee(t,i);if(null===n)return null;var r=this.leftSE.point,o=this.rightSE.point,s=e.leftSE.point,a=e.rightSE.point,l=K(t,s)&&0===this.comparePoint(s),c=K(i,r)&&0===e.comparePoint(r),u=K(t,a)&&0===this.comparePoint(a),h=K(i,o)&&0===e.comparePoint(o);if(c&&l)return h&&!u?o:!h&&u?a:null;if(c)return u&&r.x===a.x&&r.y===a.y?null:r;if(l)return h&&o.x===s.x&&o.y===s.y?null:s;if(h&&u)return null;if(h)return o;if(u)return a;var d=function(e,t,i,n){if(0===t.x)return pe(i,n,e.x);if(0===n.x)return pe(e,t,i.x);if(0===t.y)return de(i,n,e.y);if(0===n.y)return de(e,t,i.y);var r=ae(t,n);if(0==r)return null;var o={x:i.x-e.x,y:i.y-e.y},s=ae(o,t)/r,a=ae(o,n)/r;return{x:(e.x+a*t.x+(i.x+s*n.x))/2,y:(e.y+a*t.y+(i.y+s*n.y))/2}}(r,this.vector(),s,e.vector());return null===d?null:K(n,d)?se.round(d.x,d.y):null}},{key:"split",value:function(t){var i=[],n=void 0!==t.events,r=new me(t,!0),o=new me(t,!1),s=this.rightSE;this.replaceRightSE(o),i.push(o),i.push(r);var a=new e(r,s,this.rings.slice(),this.windings.slice());return me.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),me.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),o.checkForConsuming()),i}},{key:"swapEvents",value:function(){var e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var t=0,i=this.windings.length;t<i;t++)this.windings[t]*=-1}},{key:"consume",value:function(t){for(var i=this,n=t;i.consumedBy;)i=i.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var r=e.compare(i,n);if(0!==r){if(r>0){var o=i;i=n,n=o}if(i.prev===n){var s=i;i=n,n=s}for(var a=0,l=n.rings.length;a<l;a++){var c=n.rings[a],u=n.windings[a],h=i.rings.indexOf(c);-1===h?(i.rings.push(c),i.windings.push(u)):i.windings[h]+=u}n.rings=null,n.windings=null,n.consumedBy=i,n.leftSE.consumedBy=i.leftSE,n.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};for(var t=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys,r=0,o=this.rings.length;r<o;r++){var s=this.rings[r],a=this.windings[r],l=t.indexOf(s);-1===l?(t.push(s),i.push(a)):i[l]+=a}for(var c=[],u=[],h=0,d=t.length;h<d;h++)if(0!==i[h]){var p=t[h],m=p.poly;if(-1===u.indexOf(m))if(p.isExterior)c.push(m);else{-1===u.indexOf(m)&&u.push(m);var f=c.indexOf(p.poly);-1!==f&&c.splice(f,1)}}for(var g=0,y=c.length;g<y;g++){var v=c[g].multiPoly;-1===n.indexOf(v)&&n.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(Ee.type){case"union":var i=0===e.length,n=0===t.length;this._isInResult=i!==n;break;case"intersection":var r,o;e.length<t.length?(r=e.length,o=t.length):(r=t.length,o=e.length),this._isInResult=o===Ee.numMultiPolys&&r<o;break;case"xor":var s=Math.abs(e.length-t.length);this._isInResult=s%2==1;break;case"difference":var a=function(e){return 1===e.length&&e[0].isSubject};this._isInResult=a(e)!==a(t);break;default:throw new Error("Unrecognized operation type found ".concat(Ee.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,i,n){var r,o,s,a=me.comparePoints(t,i);if(a<0)r=t,o=i,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));r=i,o=t,s=-1}return new e(new me(r,!0),new me(o,!1),[n],[s])}}]),e}(),ye=function(){function e(t,i,n){if(J(this,e),!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=n,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=se.round(t[0][0],t[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var o=r,s=1,a=t.length;s<a;s++){if("number"!=typeof t[s][0]||"number"!=typeof t[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var l=se.round(t[s][0],t[s][1]);l.x===o.x&&l.y===o.y||(this.segments.push(ge.fromRing(o,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),o=l)}r.x===o.x&&r.y===o.y||this.segments.push(ge.fromRing(o,r,this))}return Q(e,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,i=this.segments.length;t<i;t++){var n=this.segments[t];e.push(n.leftSE),e.push(n.rightSE)}return e}}]),e}(),ve=function(){function e(t,i){if(J(this,e),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ye(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,r=t.length;n<r;n++){var o=new ye(t[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=i}return Q(e,[{key:"getSweepEvents",value:function(){for(var e=this.exteriorRing.getSweepEvents(),t=0,i=this.interiorRings.length;t<i;t++)for(var n=this.interiorRings[t].getSweepEvents(),r=0,o=n.length;r<o;r++)e.push(n[r]);return e}}]),e}(),_e=function(){function e(t,i){if(J(this,e),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(e){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,r=t.length;n<r;n++){var o=new ve(t[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=i}return Q(e,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,i=this.polys.length;t<i;t++)for(var n=this.polys[t].getSweepEvents(),r=0,o=n.length;r<o;r++)e.push(n[r]);return e}}]),e}(),xe=function(){function e(t){J(this,e),this.events=t;for(var i=0,n=t.length;i<n;i++)t[i].segment.ringOut=this;this.poly=null}return Q(e,null,[{key:"factory",value:function(t){for(var i=[],n=0,r=t.length;n<r;n++){var o=t[n];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,l=o.rightSE,c=[a],u=a.point,h=[];s=a,a=l,c.push(a),a.point!==u;)for(;;){var d=a.getAvailableLinkedEvents();if(0===d.length){var p=c[0].point,m=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(m.x,", ").concat(m.y,"]."))}if(1===d.length){l=d[0].otherSE;break}for(var f=null,g=0,y=h.length;g<y;g++)if(h[g].point===a.point){f=g;break}if(null===f){h.push({index:c.length,point:a.point});var v=a.getLeftmostComparator(s);l=d.sort(v)[0].otherSE;break}var _=h.splice(f)[0],x=c.splice(_.index);x.unshift(x[0].otherSE),i.push(new e(x.reverse()))}i.push(new e(c))}}return i}}]),Q(e,[{key:"getGeom",value:function(){for(var e=this.events[0].point,t=[e],i=1,n=this.events.length-1;i<n;i++){var r=this.events[i].point,o=this.events[i+1].point;0!==ce(r,e,o)&&(t.push(r),e=r)}if(1===t.length)return null;var s=t[0],a=t[1];0===ce(s,e,a)&&t.shift(),t.push(t[0]);for(var l=this.isExteriorRing()?1:-1,c=this.isExteriorRing()?0:t.length-1,u=this.isExteriorRing()?t.length:-1,h=[],d=c;d!=u;d+=l)h.push([t[d].x,t[d].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var e=this.enclosingRing();this._isExteriorRing=!e||!e.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var e=this.events[0],t=1,i=this.events.length;t<i;t++){var n=this.events[t];me.compare(e,n)>0&&(e=n)}for(var r=e.segment.prevInResult(),o=r?r.prevInResult():null;;){if(!r)return null;if(!o)return r.ringOut;if(o.ringOut!==r.ringOut)return o.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=o.prevInResult(),o=r?r.prevInResult():null}}}]),e}(),Ce=function(){function e(t){J(this,e),this.exteriorRing=t,t.poly=this,this.interiorRings=[]}return Q(e,[{key:"addInterior",value:function(e){this.interiorRings.push(e),e.poly=this}},{key:"getGeom",value:function(){var e=[this.exteriorRing.getGeom()];if(null===e[0])return null;for(var t=0,i=this.interiorRings.length;t<i;t++){var n=this.interiorRings[t].getGeom();null!==n&&e.push(n)}return e}}]),e}(),we=function(){function e(t){J(this,e),this.rings=t,this.polys=this._composePolys(t)}return Q(e,[{key:"getGeom",value:function(){for(var e=[],t=0,i=this.polys.length;t<i;t++){var n=this.polys[t].getGeom();null!==n&&e.push(n)}return e}},{key:"_composePolys",value:function(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i];if(!r.poly)if(r.isExteriorRing())t.push(new Ce(r));else{var o=r.enclosingRing();o.poly||t.push(new Ce(o)),o.poly.addInterior(r)}}return t}}]),e}(),be=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ge.compare;J(this,e),this.queue=t,this.tree=new q(i),this.segments=[]}return Q(e,[{key:"process",value:function(e){var t=e.segment,i=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(t),i;var n=e.isLeft?this.tree.insert(t):this.tree.find(t);if(!n)throw new Error("Unable to find segment #".concat(t.id," ")+"[".concat(t.leftSE.point.x,", ").concat(t.leftSE.point.y,"] -> ")+"[".concat(t.rightSE.point.x,", ").concat(t.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=n,o=n,s=void 0,a=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(e.isLeft){var l=null;if(s){var c=s.getIntersection(t);if(null!==c&&(t.isAnEndpoint(c)||(l=c),!s.isAnEndpoint(c)))for(var u=this._splitSafely(s,c),h=0,d=u.length;h<d;h++)i.push(u[h])}var p=null;if(a){var m=a.getIntersection(t);if(null!==m&&(t.isAnEndpoint(m)||(p=m),!a.isAnEndpoint(m)))for(var f=this._splitSafely(a,m),g=0,y=f.length;g<y;g++)i.push(f[g])}if(null!==l||null!==p){var v=null;if(null===l)v=p;else if(null===p)v=l;else{v=me.comparePoints(l,p)<=0?l:p}this.queue.remove(t.rightSE),i.push(t.rightSE);for(var _=t.split(v),x=0,C=_.length;x<C;x++)i.push(_[x])}i.length>0?(this.tree.remove(t),i.push(e)):(this.segments.push(t),t.prev=s)}else{if(s&&a){var w=s.getIntersection(a);if(null!==w){if(!s.isAnEndpoint(w))for(var b=this._splitSafely(s,w),S=0,T=b.length;S<T;S++)i.push(b[S]);if(!a.isAnEndpoint(w))for(var E=this._splitSafely(a,w),P=0,A=E.length;P<A;P++)i.push(E[P])}}this.tree.remove(t)}return i}},{key:"_splitSafely",value:function(e,t){this.tree.remove(e);var i=e.rightSE;this.queue.remove(i);var n=e.split(t);return n.push(i),void 0===e.consumedBy&&this.tree.insert(e),n}}]),e}(),Se="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Te="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Ee=new(function(){function e(){J(this,e)}return Q(e,[{key:"run",value:function(e,t,i){Ee.type=e,se.reset();for(var n=[new _e(t,!0)],r=0,o=i.length;r<o;r++)n.push(new _e(i[r],!1));if(Ee.numMultiPolys=n.length,"difference"===Ee.type)for(var s=n[0],a=1;a<n.length;)null!==ee(n[a].bbox,s.bbox)?a++:n.splice(a,1);if("intersection"===Ee.type)for(var l=0,c=n.length;l<c;l++)for(var u=n[l],h=l+1,d=n.length;h<d;h++)if(null===ee(u.bbox,n[h].bbox))return[];for(var p=new q(me.compare),m=0,f=n.length;m<f;m++)for(var g=n[m].getSweepEvents(),y=0,v=g.length;y<v;y++)if(p.insert(g[y]),p.size>Se)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var _=new be(p),x=p.size,C=p.pop();C;){var w=C.key;if(p.size===x){var b=w.segment;throw new Error("Unable to pop() ".concat(w.isLeft?"left":"right"," SweepEvent ")+"[".concat(w.point.x,", ").concat(w.point.y,"] from segment #").concat(b.id," ")+"[".concat(b.leftSE.point.x,", ").concat(b.leftSE.point.y,"] -> ")+"[".concat(b.rightSE.point.x,", ").concat(b.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(p.size>Se)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(_.segments.length>Te)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var S=_.process(w),T=0,E=S.length;T<E;T++){var P=S[T];void 0===P.consumedBy&&p.insert(P)}x=p.size,C=p.pop()}se.reset();var A=xe.factory(_.segments);return new we(A).getGeom()}}]),e}()),Pe={union:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return Ee.run("union",e,i)},intersection:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return Ee.run("intersection",e,i)},xor:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return Ee.run("xor",e,i)},difference:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return Ee.run("difference",e,i)}},Ae=Pe;function Me(e,t,i){void 0===i&&(i={});var r=p(e),s=p(t),a=Ae.intersection(r.coordinates,s.coordinates);return 0===a.length?null:1===a.length?o(a[0],i.properties):function(e,t,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:e},t,i)}(a,i.properties)}let Le=class extends Error{constructor(e){super(e),this.name="CesiumProError"}};function De(e,t){return null!=e?e:t}function Re(e){return null!=e}Le.throwInstantiationError=function(){throw new DeveloperError("This function defines an interface and should not be called directly.")},Le.throwNoInstance=function(){throw new Le("它的定义了一个接口，不能被以直接调用.")};class Ie{constructor(e,t,i){if(!Re(e))throw new Le("longitude is required.");if(!Re(t))throw new Le("latitude is required.");this.lon=e,this.lat=t,this.alt=De(i,0)}get height(){return this.alt}toPixel(e){return Ie.toPixel(this,e)}toCartesian(){return Ie.toCartesian(this)}toCartographic(){return Ie.toCartographic(this)}getRadias(){return{lon:Cesium.Math.toRadians(this.lon),lat:Cesium.Math.toRadians(this.lat),alt:alt}}isVisible(e){return Ie.isVisible(this,e)}toString(){return`{lon: ${this.lon}, lat: ${this.lat}, alt: ${this.alt}}`}toJson(){return{lon:this.lon,lat:this.lat,alt:this.alt}}toArray(){return[this.lon,this.lat,this.alt]}static isVisible(e,t){if(t instanceof Cesium.Viewer==!1)throw new Le("viewer不是一个有效的Cesium.Viewer对象");if(!Re(e))return!1;const i=Ie.toCartesian(e);if(!i)return!1;if(t.scene.mode===Cesium.SceneMode.SCENE3D){if(!new Cesium.EllipsoidalOccluder(Cesium.Ellipsoid.WGS84,t.camera.position).isPointVisible(i))return!1;const n=Ie.toPixel(e,t.scene);if(!Re(n))return!1;const r=t.canvas.width||t.canvas.clientWidth,o=t.canvas.height||t.canvas.clientHeight;return n.x>0&&n.x<r&&n.y>0&&n.y<o}if(t.scene.mode===Cesium.SceneMode.SCENE2D){const e=t.scene.camera.frustum,{positionWC:n,directionWC:r,upWC:o}=t.scene.camera,s=e.computeCullingVolume(n,r,o),a=Cesium.BoundingSphere.projectTo2D(new BoundingSphere(i,1)),l=s.computeVisibility(a);return l===Cesium.Intersect.INSIDE||l===Cesium.Intersect.INERSECTING}}static toPixel(e,t){if(!Re(t))throw new Le("scene未定义。");if(!Re(e))return;const i=Ie.toCartesian(e);return Re(i)?Cesium.SceneTransforms.wgs84ToWindowCoordinates(t,i):void 0}static toCartographic(e,t){if(!Re(e))throw new Le("point is not defined.");if(e instanceof Ie)return Cesium.Cartographic.fromDegrees(e.lon,e.lat,e.alt);if(e instanceof Cesium.Cartesian3)return Cesium.Cartographic.fromCartesian(e);if(e instanceof Cesium.Cartographic)return e;if(e instanceof Cesium.Cartesian2){const i=Ie.toCartesian(e,t);return Ie.toCartographic(i)}}static toCartesian(e,t){if(Re(e)){if(e instanceof Cesium.Cartesian3)return e;if(e instanceof Cesium.Cartographic)return Cesium.Cartographic.toCartesian(e);if(e instanceof Ie)return Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.alt);if(e instanceof Cesium.Cartesian2){if(!t)return;const i=t.scene.camera.getPickRay(e);return t.scene.globe.pick(i,t.scene)}}}static fromCartesian(e){if(!Re(e))return;const t=Cesium.Cartographic.fromCartesian(e);return Re(t)?Ie.fromCartographic(t):void 0}static fromCartographic(e){if(!Re(e))throw new Le("cartographic is not defined.");return new Ie(Cesium.Math.toDegrees(e.longitude),Cesium.Math.toDegrees(e.latitude),e.height)}static fromPixel(e,t){if(!t.scene.globe)return;if(!Re(e))throw new Le("pixel is not defined.");if(t instanceof Cesium.Viewer==!1)throw new Le("viewer不是一个有效的Cesium.Viewer对象");const i=t.scene.camera.getPickRay(e),n=t.scene.globe.pick(i,t.scene);return Re(n)?Ie.fromCartesian(n):void 0}static fromDegrees(e,t,i){return new Ie(e,t,i)}static fromDegreesArray(e){const t=[];for(let i=0,n=e.length;i<n;i+=2)t.push(new Ie(e[i],e[i+1]));return t}static fromDegreesArrayHeights(e){const t=[];for(let i=0,n=e.length;i<n;i+=3)t.push(new Ie(e[i],e[i+1],e[i+2]));return t}static fromRadians(e,t,i){return new Ie(Cesium.Math.toDegrees(e),Cesium.Math.toDegrees(t),i)}static inChina(...e){if(1!==e.length){const t=+e[0],i=+e[1];return t>73.66&&t<135.05&&i>3.86&&i<53.55}{const t=e[0];if(e[0]instanceof Ie)return Ie.inChina(t.lon,t.lat)}}static fromArray(e){return new Ie(...e)}static fromJson(e){return new Ie(e.lon,e.lat,e.alt)}static isValid(e){return e instanceof Ie?!!Re(e.lon)&&(!!Re(e.lat)&&!!Re(e.alt)):e instanceof Cesium.Cartesian3&&(!!Re(e.x)&&(!!Re(e.y)&&!!Re(e.z)))}}const{Cartographic:ke,Cartesian3:Oe}=Cesium,Ne={};function Fe(e){if(!(e&&e instanceof Cesium.Viewer)){throw new Le(`Expected viewer to be typeof Viewer, actual typeof was ${typeof e}`)}}function ze(e,t){return t-e}Ne.lineChunk=function(e,t,i={}){try{return w(s(e.map((e=>[e.lon,e.lat]))),t,i)}catch(e){throw new Le("计算错误",e)}},Ne.polygonToGrid=function(e,t,i={}){const n=o([e.map((e=>[e.lon,e.lat]))]),s=b(n);return i.mask=n,function(e,t,i){void 0===i&&(i={}),i.mask&&!i.units&&(i.units="kilometers");for(var n=[],o=e[0],s=e[1],l=e[2],c=e[3],u=t/m([o,s],[l,s],i)*(l-o),h=t/m([o,s],[o,c],i)*(c-s),d=l-o,p=c-s,f=Math.floor(d/u),g=(p-Math.floor(p/h)*h)/2,y=o+(d-f*u)/2;y<=l;){for(var v=s+g;v<=c;){var _=r([y,v],i.properties);i.mask?O(_,i.mask)&&n.push(_):n.push(_),v+=h}y+=u}return a(n)}(s,t,i)},Ne.triangleGrid=function(e,t,i={}){const n=o([e.map((e=>[e.lon,e.lat]))]),r=b(n);return i.mask=n,function(e,t,i){void 0===i&&(i={});for(var n=[],r=t/m([e[0],e[1]],[e[2],e[1]],i)*(e[2]-e[0]),s=t/m([e[0],e[1]],[e[0],e[3]],i)*(e[3]-e[1]),l=0,c=e[0];c<=e[2];){for(var u=0,h=e[1];h<=e[3];){var d=null,p=null;l%2==0&&u%2==0?(d=o([[[c,h],[c,h+s],[c+r,h],[c,h]]],i.properties),p=o([[[c,h+s],[c+r,h+s],[c+r,h],[c,h+s]]],i.properties)):l%2==0&&u%2==1?(d=o([[[c,h],[c+r,h+s],[c+r,h],[c,h]]],i.properties),p=o([[[c,h],[c,h+s],[c+r,h+s],[c,h]]],i.properties)):u%2==0&&l%2==1?(d=o([[[c,h],[c,h+s],[c+r,h+s],[c,h]]],i.properties),p=o([[[c,h],[c+r,h+s],[c+r,h],[c,h]]],i.properties)):u%2==1&&l%2==1&&(d=o([[[c,h],[c,h+s],[c+r,h],[c,h]]],i.properties),p=o([[[c,h+s],[c+r,h+s],[c+r,h],[c,h+s]]],i.properties)),i.mask?(Me(i.mask,d)&&n.push(d),Me(i.mask,p)&&n.push(p)):(n.push(d),n.push(p)),h+=s,u++}l++,c+=r}return a(n)}(r,t,i)},Ne.getCartesians=function(e){const t=e[0];return t instanceof Ie?e.map((e=>e.toCartesian())):t instanceof Oe?e:t instanceof ke?e.map((e=>ke.toCartesian(e))):"number"==typeof t?Oe.fromDegreesArray(e):e},Ne.getLonLats=function(e){const t=e[0];return t instanceof Ie?e:t instanceof Oe?e.map((e=>Ie.fromCartesian(e))):t instanceof ke?e.map((e=>Ie.fromCartographic(e))):"number"==typeof t?Ie.fromDegreesArray(e):e},Ne.getArea=function(e){return M(o([e]))};let Be=class{constructor(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}get numberOfListeners(){return this._listeners.length-this._toRemove.length}addEventListener(e,t){if("function"!=typeof e)throw new Le("侦听器应该是一个函数");this._listeners.push(e),this._scopes.push(t);const i=this;return function(){i.removeEventListener(e,t)}}removeEventListener(e,t){if("function"!=typeof e)throw new Le("侦听器应该是一个函数");const i=this._listeners,n=this._scopes;let r=-1;for(let o=0;o<i.length;o++)if(i[o]===e&&n[o]===t){r=o;break}return-1!==r&&(this._insideRaiseEvent?(this._toRemove.push(r),i[r]=void 0,n[r]=void 0):(i.splice(r,1),n.splice(r,1)),!0)}raise(){let e;this._insideRaiseEvent=!0;const t=this._listeners,i=this._scopes;let{length:n}=t;for(e=0;e<n;e++){const n=t[e];Cesium.defined(n)&&t[e].apply(i[e],arguments)}const r=this._toRemove;if(n=r.length,n>0){for(r.sort(ze),e=0;e<n;e++){const n=r[e];t.splice(n,1),i.splice(n,1)}r.length=0}this._insideRaiseEvent=!1}raiseEvent(){this.raise(...arguments)}};function Ge(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=Math.floor(16*Math.random());return("x"===e?t:3&t|8).toString(16)}))}class He{constructor(e,t={}){Fe(e),this._id=De(t.id,Ge()),this.options=t,this._viewer=e,this._doing=!1,this.preDo=new Be,this.postDo=new Be}get type(){return this._type}do(e){}isDestroyed(){return!1}_check(){if(this._doing)throw new Le("上一次分析正在进行，请稍候...");this._doing=!0}}const We={};function Ue(){return!0}function je(e,t){function i(){}const n=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertyNames(Object.getPrototypeOf(e))];for(var r of n)"function"==typeof e[r]&&(e[r]=i);e.isDestroyed=Ue}We.surfaceDistance=function(e){let t=0;for(let i=0;i<e.length-1;i+=1){const n=Cesium.Cartographic.fromCartesian(e[i]),r=Cesium.Cartographic.fromCartesian(e[i+1]),o=new Cesium.EllipsoidGeodesic;o.setEndPoints(n,r);t+=o.surfaceDistance}return t},We.spaceDistance=function(e){let t=0;for(let i=1;i<e.length;i++){const n=e[i-1],r=e[i];t+=Cesium.Cartesian3.distance(n,r)}return t},We.angle=function(e,t,i){let n=0;try{const r=Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Matrix4.inverseTransformation(r,new Cesium.Matrix4),s=Cesium.Matrix4.multiplyByPoint(o,t,new Cesium.Cartesian3),a=Cesium.Matrix4.multiplyByPoint(o,i,new Cesium.Cartesian3),l=Cesium.Cartesian3.normalize(s,new Cesium.Cartesian3),c=Cesium.Cartesian3.normalize(a,new Cesium.Cartesian3),u=Cesium.Cartesian3.dot(l,c);n=Cesium.Math.acosClamped(u)}catch(e){console.log(e),n=0}return Cesium.Math.toDegrees(n)},We.angleBetweenNorth=function(e,t){const i=Cesium.Transforms.eastNorthUpToFixedFrame(e),n=Cesium.Matrix4.inverseTransformation(i,new Cesium.Matrix4),r=Cesium.Matrix4.multiplyByPoint(n,t,new Cesium.Cartesian3),o=Cesium.Cartesian3.normalize(r,new Cesium.Cartesian3),s=new Cesium.Cartesian3(0,1,0),a=Cesium.Cartesian3.dot(o,s);let l=Cesium.Math.acosClamped(a);l=Cesium.Math.toDegrees(l);const c=new Cesium.Cartesian3(1,0,0);return Cesium.Cartesian3.dot(c,o)<0&&(l=360-l),l},We.surfaceArea=function(e){let t=0;for(let i=0;i<e.length-2;i+=1){const n=(i+1)%e.length,r=(i+2)%e.length,o=We.angle(e[i],e[n],e[r]);t+=We.spaceDistance([e[i],e[n]])*We.spaceDistance([e[n],e[r]])*Math.abs(Math.sin(Cesium.Math.toRadians(o)))}return t},We.spaceArea=function(e){const t=[];for(let i of e){const e=Ie.fromCartesian(i);t.push([e.lon,e.lat])}t.push(t[0]);return M(o([t]))},We.heightFromCartesianArray=function(e){if(e.length<2)return 0;const t=[];for(let i=1;i<e.length;i++){const n=Cesium.Cartographic.fromCartesian(e[i-1]),r=Cesium.Cartographic.fromCartesian(e[i]);n&&r?t.push(r.height-n.height):t.push("NaN")}return t};const{Color:Ve,Cartesian3:qe,Cartographic:$e,PrimitiveCollection:Ye,PolygonGeometry:Xe,PolygonHierarchy:Je,GeometryInstance:Ze,Primitive:Qe,GroundPrimitive:Ke,PerInstanceColorAppearance:et}=Cesium;function tt(e,t,i=[]){const n=[];let r=0;const o=Ne.getArea(t);for(let o=0;o<3;o++){const s=t[o],a=$e.fromDegrees(...s),l=e.scene.sampleHeight(a,i);r+=l;const c=qe.fromDegrees(s[0],s[1],l);n.push(c)}return{positions:n,height:r/3,area:o}}class it extends He{constructor(e,t={}){if(super(e,t),!t.mask)throw new Le("parameter mask must be provided.");const i=Ne.getCartesians(t.mask);this._mask=[...i,i[0]],this._mask instanceof qe&&(this._mask=this._mask.map((e=>Ie.fromCartesian(e)))),this.excavatedColor=De(t.excavatedColor,Ve.RED.withAlpha(.5)),this.fillColor=De(t.fillColor,Ve.GREEN.withAlpha(.5)),this._type="excavation-analysis",this._height=De(t.height,0),this._samplerSize=t.samplerSize,this._excludeObject=De(t.excludeObject,[]),this._renderToViewer=De(t.renderToViewer,!0)}static suggestGridCount=300;do(){if(this._check(),this.preDo.raise({samplerSize:this._samplerSize,id:this._id}),!this._mask)return;const e=We.surfaceArea(this._mask),t=this._samplerSize||Math.sqrt(e/1e6/it.suggestGridCount),i=Ne.getLonLats(this._mask),n=Ne.triangleGrid(i,t),r=new Ye;this._root=r,r.name=this.type,this._renderToViewer&&this._viewer.scene.primitives.add(r);const o=n.features.map((e=>e.geometry.coordinates[0])),s=[];let a=0,l=0;for(let e of o){const{height:t,positions:i,area:n}=tt(this._viewer,e,this._excludeObject),r=n*(t-this._height);r>0?l+=r:a+=Math.abs(r),s.push({height:t,positions:i,volume:r}),this._render(i,t)}const c={samplerSize:t,id:this._id,grid:n,result:s,fillVolume:a,excavaVolume:l,graphicCollection:this._root};return this.postDo.raise(c),this._doing=!1,c}_render(e,t){const i=t<this._height?this.excavatedColor:this.fillColor,n=t>this._height,r=function(e,t,i,n){const r=new Xe({polygonHierarchy:new Je(e),perPositionHeight:!0,extrudedHeight:i}),o=new Ze({geometry:r,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(t)}});return new(n?Ke:Qe)({geometryInstances:[o],appearance:new et})}(e,i,this._height,n);this._root.add(r)}destroy(){this._viewer.scene.primitives.remove(this._root),je(this)}}const{Cartographic:nt}=Cesium;class rt extends He{constructor(e,t={}){super(e),this._samplerSize=t.samplerSzie;const i=Ne.getCartesians(t.mask);this._mask=[...i,i[0]],this._type="height-analysis"}static suggestGridCount=300;do(e=[]){this._check(),this.preDo.raise({id:this._id,mask:this._mask});const t=We.surfaceArea(this._mask),i=Math.sqrt(t/1e6/rt.suggestGridCount),n=Ne.getLonLats(this._mask);this.samplerSize=this._samplerSize||i;const r=Ne.polygonToGrid(n,this.samplerSize).features.map((e=>nt.fromDegrees(...e.geometry.coordinates))),{max:o,min:s,avg:a}=function(e,t,i=[]){let n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,o=0;return e.map((e=>{const s=t.scene.sampleHeight(e,i);isNaN(s)||(s>n&&(n=s),s<r&&(r=s),o+=s)})),{max:n,min:r,avg:o/e.length}}(r,this._viewer,e);return this.postDo.raise({id:this._id,mask:this._mask,samplerSize:this.samplerSize}),{max:o,min:s,avg:a,samplerSize:this.samplerSize}}}function ot(){throw new Le("抽象方法无法被调用。")}const{Cartesian3:st,Primitive:at,Material:lt,Geometry:ct,MaterialAppearance:ut,GeometryAttribute:ht,ComponentDatatype:dt,PrimitiveType:pt,BoundingSphere:mt,VertexFormat:ft,defaultValue:gt,GeometryAttributes:yt,Check:vt}=Cesium,_t=new ft,xt=new st;class Ct{constructor(e={}){this._normal=e.normal,this._radius=e.radius,this._center=e.center;const t=gt(e.vertexFormat,ft.DEFAULT);this._vertexFormat=t}static packedLength=ft.packedLength+st.packedLength+1;static pack(e,t,i){return i=gt(i,0),ft.pack(e._vertexFormat,t,i),i+=ft.packedLength,st.pack(e._normal,t,i),i+=st.packedLength,t[i++]=e._radius,t}static unpack(e,t,i){t=gt(t,0);const n=ft.unpack(e,t,_t);t+=ft.packedLength;const r=st.unpack(e,t,xt),o=e[t+=st.packedLength];return defined(i)?(i._vertexFormat=ft.clone(n,i._vertexFormat),i._normal=st.clone(r,i._normal),i._radius=o,i):new PlaneGeometry({vertexFormat:n,normal:r,radius:o})}static createGeometry(e){const t=Math.max(1,.02*e._radius),i=Math.max(.2*e._radius,2*t);let n=[],r=[];const{x:o,y:s,z:a}=e._center;let l;st.equals(e._normal,st.UNIT_X)?(n=[o,-t+s,t+a,o,-i+s,t+a,o,-i+s,i+a,o,-t+s,i+a],l=new st(o,-(t+i)/2+s,(t+i)/2+a),r=[1,0,0,1,0,0,1,0,0,1,0,0]):st.equals(e._normal,st.UNIT_Y)?(n=[t+o,s,t+a,i+o,s,t+a,i+o,s,i+a,t+o,s,i+a],l=new st((t+i)/2+o,s,(t+i)/2+a),r=[0,1,0,0,1,0,0,1,0,0,1,0]):st.equals(e._normal,st.UNIT_Z)&&(n=[t+o,-t+s,a,i+o,-t+s,a,i+o,-i+s,a,t+o,-i+s,a],l=new st((t+i)/2+o,-(t+i)/2+s,a),r=[0,0,1,0,0,1,0,0,1,0,0,1]),n=new Float32Array([...n]);const c=new Float32Array([0,0,1,0,1,1,0,1]),u=new Uint16Array([0,1,2,2,3,0]);return new ct({attributes:new yt({position:new ht({componentDatatype:dt.DOUBLE,componentsPerAttribute:3,values:n}),normal:new ht({componentDatatype:dt.FLOAT,componentsPerAttribute:3,values:r}),st:new ht({componentDatatype:dt.FLOAT,componentsPerAttribute:2,values:c})}),indices:u,primitiveType:pt.TRIANGLES,boundingSphere:new mt(l,(t+i)/2)})}}class wt{constructor(e={}){this._center=e.center,this._modelMatrix=e.modelMatrix,this._color=e.color;const t=e.radius;this._normal=e.normal;const i=new Ct({normal:this._normal,radius:t,vertexFormat:ft.DEFAULT,center:this._center}),n=new Cesium.GeometryInstance({geometry:Ct.createGeometry(i)}),r=new at({asynchronous:!1,geometryInstances:n,modelMatrix:this._modelMatrix,appearance:new ut({material:lt.fromType("Color",{color:this._color})})});return r.isAxisPlane=!0,r.normal=this._normal,r.axis=e.axis,r.color=this._color,r}}const bt={SURFACE_DISTANCE:1,SPACE_DISTANCE:2,SPACE_AREA:3,SURFACE_AREA:4,HEIGHT:5,ANGLE:6,validate:function(e){return e===bt.SURFACE_AREA||e===bt.SURFACE_DISTANCE||e===bt.SPACE_AREA||e===bt.SPACE_DISTANCE||e===bt.HEIGHT||e===bt.ANGLE},getKey:function(e){let t;switch(e){case 1:t="SURFACE_DISTANCE";break;case 2:t="SPACE_DISTANCE";break;case 3:t="SPACE_AREA";break;case 4:t="SURFACE_AREA";break;case 5:t="HEIGHT";break;case 6:t="ANGLE";break;default:t=void 0}return t},getValue:function(e){let t;switch(e){case 1:t="贴地距离";break;case 2:t="空间距离";break;case 3:t="空间面积";break;case 4:t="贴地面积";break;case 5:t="高度";break;case 6:t="方位角";break;default:t=void 0}return t}};var St=Object.freeze(bt);const{RequestState:Tt,AttributeCompression:Et,BoundingSphere:Pt,Cartesian3:At,Credit:Mt,defaultValue:Lt,defined:Dt,DeveloperError:Rt,GeographicTilingScheme:It,WebMercatorTilingScheme:kt,getJsonFromTypedArray:Ot,HeightmapTerrainData:Nt,IndexDatatype:Ft,OrientedBoundingBox:zt,QuantizedMeshTerrainData:Bt,Request:Gt,RequestType:Ht,Resource:Wt,RuntimeError:Ut,TerrainProvider:jt,TileAvailability:Vt,TileProviderError:qt}=Cesium;function $t(e){this.resource=e.resource,this.version=e.version,this.isHeightmap=e.isHeightmap,this.tileUrlTemplates=e.tileUrlTemplates,this.availability=e.availability,this.hasVertexNormals=e.hasVertexNormals,this.hasWaterMask=e.hasWaterMask,this.hasMetadata=e.hasMetadata,this.availabilityLevels=e.availabilityLevels,this.availabilityTilesLoaded=e.availabilityTilesLoaded,this.littleEndianExtensionSize=e.littleEndianExtensionSize,this.availabilityPromiseCache={}}function Yt(e){this._heightmapWidth=65,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._ellipsoid=e.ellipsoid,this._requestVertexNormals=Lt(e.requestVertexNormals,!1),this._requestWaterMask=Lt(e.requestWaterMask,!1),this._requestMetadata=Lt(e.requestMetadata,!0),this._errorEvent=new Be;let t=e.credit;"string"==typeof t&&(t=new Mt(t)),this._credit=t,this._availability=void 0,this._ready=!1,this._tileCredits=void 0;const i=this;let n,r,o;const s=this._layers=[];let a="";const l=[];let c=0;function u(e){let t;if(!e.format)return t="The tile format is not specified in the layer.json file.",o=qt.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Ut(t));if(!e.tiles||0===e.tiles.length)return t="The layer.json file does not specify any tile URL templates.",o=qt.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Ut(t));let d=!1,p=!1,f=!1,g=!0,y=!1;if("heightmap-1.0"===e.format)y=!0,Dt(i._heightmapStructure)||(i._heightmapStructure={heightScale:.2,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:65535}),p=!0,i._requestWaterMask=!0;else if(0!==e.format.indexOf("quantized-mesh-1."))return t=`The tile format "${e.format}" is invalid or not supported.`,o=qt.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Ut(t));const v=e.tiles,_=e.maxzoom;if(c=Math.max(c,_),e.projection&&"EPSG:4326"!==e.projection){if("EPSG:3857"!==e.projection)return t=`The projection "${e.projection}" is invalid or not supported.`,o=qt.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Ut(t));i._tilingScheme=new kt({numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:i._ellipsoid})}else i._tilingScheme=new It({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:i._ellipsoid});if(i._levelZeroMaximumGeometricError=jt.getEstimatedLevelZeroGeometricErrorForAHeightmap(i._tilingScheme.ellipsoid,i._heightmapWidth,i._tilingScheme.getNumberOfXTilesAtLevel(0)),e.scheme&&"tms"!==e.scheme&&"slippyMap"!==e.scheme)return t=`The scheme "${e.scheme}" is invalid or not supported.`,o=qt.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Ut(t));let x;i._scheme=e.scheme,Dt(e.extensions)&&-1!==e.extensions.indexOf("octvertexnormals")?d=!0:Dt(e.extensions)&&-1!==e.extensions.indexOf("vertexnormals")&&(d=!0,g=!1),Dt(e.extensions)&&-1!==e.extensions.indexOf("watermask")&&(p=!0),Dt(e.extensions)&&-1!==e.extensions.indexOf("metadata")&&(f=!0);const C=e.metadataAvailability,w=e.available;let b;if(Dt(w)&&!Dt(C)){b=new Vt(i._tilingScheme,w.length);for(let e=0;e<w.length;++e){const t=w[e],n=i._tilingScheme.getNumberOfYTilesAtLevel(e);Dt(l[e])||(l[e]=[]);for(let i=0;i<t.length;++i){const r=t[i],o=n-r.endY-1,s=n-r.startY-1;l[e].push([r.startX,o,r.endX,s]),b.addAvailableTileRange(e,r.startX,o,r.endX,s)}}}else Dt(C)&&(x=new Vt(i._tilingScheme,_),b=new Vt(i._tilingScheme,_),l[0]=[[0,0,1,0]],b.addAvailableTileRange(0,0,0,1,0));i._hasWaterMask=i._hasWaterMask||p,i._hasVertexNormals=i._hasVertexNormals||d,i._hasMetadata=i._hasMetadata||f,Dt(e.attribution)&&(a.length>0&&(a+=" "),a+=e.attribution),s.push(new $t({resource:n,version:e.version,isHeightmap:y,tileUrlTemplates:v,availability:b,hasVertexNormals:d,hasWaterMask:p,hasMetadata:f,availabilityLevels:C,availabilityTilesLoaded:x,littleEndianExtensionSize:g}));const S=e.parentUrl;if(Dt(S)){if(!Dt(b))return console.log("A layer.json can't have a parentUrl if it does't have an available array."),Promise.resolve(!0);n=n.getDerivedResource({url:S}),n.appendForwardSlash(),r=n.getDerivedResource({url:"layer.json"});const e=r.fetchJson();return Promise.resolve(e).then(u).catch(h)}return Promise.resolve(!0)}function h(e){const t=`An error occurred while accessing ${r.url}.`;return o=qt.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Ut(t))}function d(e){return u(e).then((function(){if(Dt(o))return;const e=l.length;if(e>0){const t=i._availability=new Vt(i._tilingScheme,c);for(let i=0;i<e;++i){const e=l[i];for(let n=0;n<e.length;++n){const r=e[n];t.addAvailableTileRange(i,r[0],r[1],r[2],r[3])}}}if(a.length>0){const e=new Mt(a);Dt(i._tileCredits)?i._tileCredits.push(e):i._tileCredits=[e]}return i._ready=!0,Promise.resolve(!0)}))}function p(e){return Dt(e)&&404===e.statusCode?d({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]}):h()}function m(){return Promise.resolve(r.fetchJson()).then(d).catch(p)}this._readyPromise=Promise.resolve(e.url).then((function(e){const t=Wt.createIfNeeded(e);return t.appendForwardSlash(),n=t,r=n.getDerivedResource({url:"layer.json"}),i._tileCredits=t.credits,m()}))}const Xt=1,Jt=2,Zt=4;function Qt(e){if(!Dt(e)||0===e.length)return{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"};return{Accept:`application/vnd.quantized-mesh;extensions=${e.join("-")},application/octet-stream;q=0.9,*/*;q=0.01`}}function Kt(e,t,i,n,r,o){if(!Dt(r))return Promise.reject(new Ut("Terrain tile doesn't exist"));const s=r.tileUrlTemplates;if(0===s.length)return;let a;if(e._scheme&&"tms"!==e._scheme)a=i;else{a=e._tilingScheme.getNumberOfYTilesAtLevel(n)-i-1}const l=[];let c,u;e._requestVertexNormals&&r.hasVertexNormals&&l.push(r.littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),e._requestWaterMask&&r.hasWaterMask&&l.push("watermask"),e._requestMetadata&&r.hasMetadata&&l.push("metadata");const h=s[(t+a+n)%s.length],d=r.resource;Dt(d._ionEndpoint)&&!Dt(d._ionEndpoint.externalType)?(0!==l.length&&(u={extensions:l.join("-")}),c=Qt(void 0)):c=Qt(l);const p=d.getDerivedResource({url:h,templateValues:{version:r.version,z:n,x:t,y:a},queryParameters:u,headers:c,request:o}).fetchArrayBuffer();return d.request.state!==Tt.ISSUED&&d.request.state!==Tt.ACTIVE&&Dt(p)?p.then((function(o){return Dt(o)?Dt(e._heightmapStructure)?function(e,t,i,n,r){const o=new Uint16Array(t,0,e._heightmapWidth*e._heightmapWidth);return new Nt({buffer:o,childTileMask:new Uint8Array(t,o.byteLength,1)[0],waterMask:new Uint8Array(t,o.byteLength+1,t.byteLength-o.byteLength-1),width:e._heightmapWidth,height:e._heightmapWidth,structure:e._heightmapStructure,credits:e._tileCredits})}(e,o):function(e,t,i,n,r,o){const s=o.littleEndianExtensionSize;let a=0;const l=3*Float64Array.BYTES_PER_ELEMENT,c=4*Float64Array.BYTES_PER_ELEMENT,u=3*Uint16Array.BYTES_PER_ELEMENT;let h=Uint16Array.BYTES_PER_ELEMENT,d=3*h;const p=new DataView(t),m=new At(p.getFloat64(a,!0),p.getFloat64(a+8,!0),p.getFloat64(a+16,!0));a+=l;const f=p.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;const g=p.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;const y=new Pt(new At(p.getFloat64(a,!0),p.getFloat64(a+8,!0),p.getFloat64(a+16,!0)),p.getFloat64(a+l,!0));a+=c;const v=new At(p.getFloat64(a,!0),p.getFloat64(a+8,!0),p.getFloat64(a+16,!0));a+=l;const _=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const x=new Uint16Array(t,a,3*_);a+=_*u,_>65536&&(h=Uint32Array.BYTES_PER_ELEMENT,d=3*h);const C=x.subarray(0,_),w=x.subarray(_,2*_),b=x.subarray(2*_,3*_);Et.zigZagDeltaDecode(C,w,b),a%h!=0&&(a+=h-a%h);const S=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const T=Ft.createTypedArrayFromArrayBuffer(_,t,a,3*S);a+=S*d;let E=0;const P=T.length;for(let e=0;e<P;++e){const t=T[e];T[e]=E-t,0===t&&++E}const A=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const M=Ft.createTypedArrayFromArrayBuffer(_,t,a,A);a+=A*h;const L=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const D=Ft.createTypedArrayFromArrayBuffer(_,t,a,L);a+=L*h;const R=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const I=Ft.createTypedArrayFromArrayBuffer(_,t,a,R);a+=R*h;const k=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const O=Ft.createTypedArrayFromArrayBuffer(_,t,a,k);let N,F;for(a+=k*h;a<p.byteLength;){const l=p.getUint8(a,!0);a+=Uint8Array.BYTES_PER_ELEMENT;const c=p.getUint32(a,s);if(a+=Uint32Array.BYTES_PER_ELEMENT,l===Xt&&e._requestVertexNormals)N=new Uint8Array(t,a,2*_);else if(l===Jt&&e._requestWaterMask)F=new Uint8Array(t,a,c);else if(l===Zt&&e._requestMetadata){const s=p.getUint32(a,!0);if(s>0){const n=Ot(new Uint8Array(t),a+Uint32Array.BYTES_PER_ELEMENT,s).available;if(Dt(n))for(let t=0;t<n.length;++t){const r=i+t+1,s=n[t],a=e._tilingScheme.getNumberOfYTilesAtLevel(r);for(let t=0;t<s.length;++t){const i=s[t],n=a-i.endY-1,l=a-i.startY-1;e.availability.addAvailableTileRange(r,i.startX,n,i.endX,l),o.availability.addAvailableTileRange(r,i.startX,n,i.endX,l)}}}o.availabilityTilesLoaded.addAvailableTileRange(i,n,r,n,r)}a+=c}const z=5*e.getLevelMaximumGeometricError(i),B=e._tilingScheme.tileXYToRectangle(n,r,i),G=zt.fromRectangle(B,f,g,e._tilingScheme.ellipsoid);return new Bt({center:m,minimumHeight:f,maximumHeight:g,boundingSphere:y,orientedBoundingBox:G,horizonOcclusionPoint:v,quantizedVertices:x,encodedNormals:N,indices:T,westIndices:M,southIndices:D,eastIndices:I,northIndices:O,westSkirtHeight:z,southSkirtHeight:z,eastSkirtHeight:z,northSkirtHeight:z,childTileMask:e.availability.computeChildMaskForTile(i,n,r),waterMask:F,credits:e._tileCredits})}(e,o,n,t,i,r):Promise.reject(new Ut("Mesh buffer doesn't exist."))})):void 0}function ei(e,t,i,n){if(0===n)return;const r=e.availabilityLevels,o=n%r==0?n-r:(n/r|0)*r,s=1<<n-o;return{level:o,x:t/s|0,y:i/s|0}}function ti(e,t,i,n,r,o){if(!Dt(r.availabilityLevels))return{result:!1};let s;const a=function(){delete r.availabilityPromiseCache[s]},l=r.availabilityTilesLoaded,c=r.availability;let u=ei(r,t,i,n);for(;Dt(u);){if(c.isTileAvailable(u.level,u.x,u.y)&&!l.isTileAvailable(u.level,u.x,u.y)){let t;if(!o&&(s=`${u.level}-${u.x}-${u.y}`,t=r.availabilityPromiseCache[s],!Dt(t))){const i=new Gt({throttle:!1,throttleByServer:!0,type:Ht.TERRAIN});t=Kt(e,u.x,u.y,u.level,r,i),Dt(t)&&(r.availabilityPromiseCache[s]=t,t.then(a))}return{result:!0,promise:t}}u=ei(r,u.x,u.y,u.level)}return{result:!1}}function ii(e,t){if(null===e||"object"!=typeof e)return e;t=De(t,!1);const i=new e.constructor;for(const n in e)if(e.hasOwnProperty(n)){let r=e[n];t&&(r=ii(r,t)),i[n]=r}return i}Yt.prototype.requestTileGeometry=function(e,t,i,n){const r=this._layers;let o;const s=r.length;if(1===s)o=r[0];else for(let n=0;n<s;++n){const s=r[n];if(!Dt(s.availability)||s.availability.isTileAvailable(i,e,t)){o=s;break}}return Kt(this,e,t,i,o,n)},Object.defineProperties(Yt.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){return this._hasVertexNormals&&this._requestVertexNormals}},hasMetadata:{get:function(){return this._hasMetadata&&this._requestMetadata}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},requestMetadata:{get:function(){return this._requestMetadata}},availability:{get:function(){return this._availability}}}),Yt.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},Yt.prototype.getTileDataAvailable=function(e,t,i){if(!Dt(this._availability))return;if(i>this._availability._maximumLevel)return!1;if(this._availability.isTileAvailable(i,e,t))return!0;if(!this._hasMetadata)return!1;const n=this._layers,r=n.length;for(let o=0;o<r;++o){if(ti(this,e,t,i,n[o],0===o).result)return}return!1},Yt.prototype.loadTileDataAvailability=function(e,t,i){if(!Dt(this._availability)||i>this._availability._maximumLevel||this._availability.isTileAvailable(i,e,t)||!this._hasMetadata)return;const n=this._layers,r=n.length;for(let o=0;o<r;++o){const r=ti(this,e,t,i,n[o],0===o);if(Dt(r.promise))return r.promise}},Yt._getAvailabilityTile=ei;const ni=/((?:.*\/)|^)CesiumPro\.js(?:\?|#|$)/;let ri,oi,si;function ai(e){return"undefined"==typeof document?e:(Re(ri)||(ri=document.createElement("a")),ri.href=e,ri.href=ri.href,ri.href)}function li(e){return ai(`../${e}`)}function ci(){if(Re(oi))return oi;let e;if(e="undefined"!=typeof CESIUMPRO_BASE_URL?CESIUMPRO_BASE_URL:"object"==typeof window.define&&Re(window.define.amd)&&!window.define.amd.toUrlUndefined?Cesium.getAbsoluteUri("..","core/Url.js"):function(){const e=document.getElementsByTagName("script");for(let t=0,i=e.length;t<i;++t){const i=e[t].getAttribute("src"),n=ni.exec(i);if(null!==n)return n[1]}}(),!Re(e))throw new Le("Unable to determine CesiumPro base URL automatically, try defining a global variable called CESIUMPRO_BASE_URL.");return Re(e)||(e=""),oi=new Cesium.Resource({url:ai(e)}),oi.appendForwardSlash(),oi}function ui(e){return ci().getDerivedResource({url:e}).url}function hi(e){Re(si)||(si="object"==typeof window.define&&Re(window.define.amd)&&!window.define.amd.toUrlUndefined?li:ui);return si(e)}const di={join:function(...e){const t=[];for(let i of e)i.startsWith("/")&&(i=i.substring(1)),i.endsWith("/")&&(i=i.substring(0,i.length-1)),t.push(i);return t.join("/")},buildModuleUrl:function(e){return hi(e)}};di.getCesiumProBaseUrl=ci;const{FeatureDetection:pi,isCrossOriginUrl:mi}=Cesium;let fi;function gi(){return Re(fi)||(fi=function(e){let t=Cesium.buildModuleUrl(e);if(mi(t)){const e='importScripts("'+t+'");';let i;try{i=new Blob([e],{type:"application/javascript"})}catch(t){let n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(e),i=n.getBlob("application/javascript")}t=(window.URL||window.webkitURL).createObjectURL(i)}return t}("Workers/cesiumWorkerBootstrapper.js")),fi}function yi(e){const t=new Worker(gi());t.postMessage=De(t.webkitPostMessage,t.postMessage);const i={loaderConfig:{paths:{Workers:hi("workers")},baseUrl:ci().url},workerModule:e._workerPath};return t.postMessage(i),t.onmessage=function(t){!function(e,t){console.log(e,t,"------complete-----")}(e,t.data)},t.postMessage(e._options),t}const{kdbush:vi,Cartesian3:_i,Cartographic:xi,PointPrimitive:Ci,BoundingRectangle:wi,SceneMode:bi,EllipsoidalOccluder:Si}=Cesium;function Ti(e){return e.__pixel.x}function Ei(e){return e.__pixel.y}function Pi(e,t){const i=new wi;return Ci.getScreenSpaceBoundingBox(e,t,i),function(e,t){e.x-=t,e.y-=t,e.width+=2*t,e.height+=2*t}(i,this.pixelRange),i}let Ai;function Mi(e){if(!e.scene.globe)return;const t=Cesium.getTimestamp(),i=e.scene;if(Re(Ai)&&t-Ai<250)return;Ai=t;const n=i.canvas.clientWidth,r=i.canvas.clientHeight,o=i.camera.getPickRay(new Cesium.Cartesian2(n/2,r/2)),s=i.camera.getPickRay(new Cesium.Cartesian2(n/2+1,r/2)),a=i.globe.pick(o,i),l=i.globe.pick(s,i);if(!Re(a)||!Re(l))return;return new Cesium.EllipsoidGeodesic(i.globe.ellipsoid.cartesianToCartographic(a),i.globe.ellipsoid.cartesianToCartographic(l)).surfaceDistance}function Li(e){const t=e.canvas.getBoundingClientRect(),i=new Cesium.Cartesian2(t.width/2,t.height/2);return Ie.fromPixel(i,e)}function Di(e){if(!e.scene.globe)return{};if(e.scene.mode===Cesium.SceneMode.SCENE3D){const t=e.camera.computeViewRectangle();if(!Re(t))return;return{west:Cesium.Math.toDegrees(t.west),south:Cesium.Math.toDegrees(t.south),east:Cesium.Math.toDegrees(t.east),north:Cesium.Math.toDegrees(t.north)}}const t=e.canvas.getBoundingClientRect(),i=Ie.fromPixel(new Cesium.Cartesian2(0,t.height/2),e)||{lon:-180},n=Ie.fromPixel(new Cesium.Cartesian2(t.width,t.height/2),e)||{lon:180},r=Ie.fromPixel(new Cesium.Cartesian2(t.width/2,0),e)||{lat:90},o=Ie.fromPixel(new Cesium.Cartesian2(t.width/2,t.height),e)||{lat:-90};return{west:i.lon,south:o.lat,east:n.lon,north:r.lat}}class Ri{constructor(e,t){Fe(e),this._viewer=e,t=De(t,{});const i=De(t.items,[]);this._items=new Cesium.AssociativeArray,this._position=t.position,this._container=De(t.container,e.container),this._root=this.createMenu(),this.createItems(i),this._show=!0,this._activeSubMenu=void 0,this.parent=t.parent}get show(){return this._show}set show(e){this._show=e,this._root.style.display=e?"block":"none",this._menu.style.display=e?"block":"none"}get position(){return this._position}set position(e){if(this._position=e,this._root){const e=Ie.toPixel(this._position,this._viewer.scene);this._root.style.left=e.x+"px",this._root.style.top=e.y+"px"}}get(e){return this._items.values[e]}getById(e){return this._items.get(e)}add(e){if(this._items.contains(e.id))return;const t=this.createItem(e);this._items.set(t.id,t),this._menu.appendChild(t.el)}remove(e){const t=e.el;try{return this._root.removeChild(t),this._items.remove(e.id),!0}catch(e){return!1}}removeAll(){for(let e of this._items.values)this.remove(e)}createMenu(){const e=document.createElement("div");e.className="context-root";const t=document.createElement("ul");if(t.className="context-menu context-ul",e.appendChild(t),this._container.appendChild(e),this._position){const t=Ie.toPixel(this._position,this._viewer.scene);e.style.left=t.x+"px",e.style.top=t.y+"px"}return this._menu=t,e.oncontextmenu=function(){return!1},e}updateItemText(e,t){const i=document.getElementById(e.id+"-text");i&&(i.innerHTML=t)}updateItemDistabled(e,t){e&&e.a&&(e.disabled=t,e.a.className=t?"context-item-disabled":"context-item")}createItems(e){for(let t of e)this.add(t)}createItem(e={}){const t=document.createElement("li");t.className="context-menu";const i=document.createElement("a");i.className=e.disabled?"context-item-disabled":"context-item";const n=document.createElement("i");if(n.className=e.class,i.appendChild(n),i.innerHTML+=`<span id="${e.id}-text">${e.text}</span>`,t.appendChild(i),t.id=e.id,e.el=t,e.a=i,e.children){const n=document.createElement("i");n.className="fa fa-caret-right",i.appendChild(n);const r=new Ri(this._viewer,{items:e.children,position:this._position,parent:this});t.appendChild(r._menu),r._menu.className+=" context-submenu",e.subMenu=r,r.container=e}return e.el.onmouseover=t=>{t.stopPropagation(),e.disabled||(this._activeSubMenu&&(this._activeSubMenu.show=!1),e.subMenu&&(e.subMenu.show=!0),this._activeSubMenu=e.subMenu)},e.el.onclick=t=>{t.stopPropagation(),e.disabled||(e.callback&&e.callback(e),this.show=!1,this.parent&&(this.parent.show=!1))},e}ContextMenuItem(e){}destroy(){}}function Ii(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}const ki=[],{document:Oi}=window,Ni=Object.getPrototypeOf,{slice:Fi}=ki,{concat:zi}=ki,{push:Bi}=ki,{indexOf:Gi}=ki,Hi={},{toString:Wi}=Hi,Ui=Hi.hasOwnProperty,ji=Ui.toString,Vi=ji.call(Object),qi={},$i=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},Yi=function(e){return null!=e&&e===e.window},Xi={type:!0,src:!0,nonce:!0,noModule:!0};function Ji(e,t,i){let n,r;const o=(i=i||Oi).createElement("script");if(o.text=e,t)for(n in Xi)r=t[n]||t.getAttribute&&t.getAttribute(n),r&&o.setAttribute(n,r);i.head.appendChild(o).parentNode.removeChild(o)}function Zi(e){return null==e?`${e}`:"object"==typeof e||"function"==typeof e?Hi[Wi.call(e)]||"object":typeof e}const Qi="3.4.1";var Ki=function(e,t){return new Ki.fn.init(e,t)};const en=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function tn(e){const t=!!e&&"length"in e&&e.length,i=Zi(e);return!$i(e)&&!Yi(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}Ki.fn=Ki.prototype={jquery:Qi,constructor:Ki,length:0,toArray(){return Fi.call(this)},get(e){return null==e?Fi.call(this):e<0?this[e+this.length]:this[e]},pushStack(e){const t=Ki.merge(this.constructor(),e);return t.prevObject=this,t},each(e){return Ki.each(this,e)},map(e){return this.pushStack(Ki.map(this,((t,i)=>e.call(t,i,t))))},slice(){return this.pushStack(Fi.apply(this,arguments))},first(){return this.eq(0)},last(){return this.eq(-1)},eq(e){const t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end(){return this.prevObject||this.constructor()},push:Bi,sort:ki.sort,splice:ki.splice},Ki.extend=Ki.fn.extend=function(){let e,t,i,n,r,o,s=arguments[0]||{},a=1;const{length:l}=arguments;let c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||$i(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)n=e[t],"__proto__"!==t&&s!==n&&(c&&n&&(Ki.isPlainObject(n)||(r=Array.isArray(n)))?(i=s[t],o=r&&!Array.isArray(i)?[]:r||Ki.isPlainObject(i)?i:{},r=!1,s[t]=Ki.extend(c,o,n)):void 0!==n&&(s[t]=n));return s},Ki.extend({expando:`jQuery${(Qi+Math.random()).replace(/\D/g,"")}`,isReady:!0,error(e){throw new Error(e)},noop(){},isPlainObject(e){let t,i;return!(!e||"[object Object]"!==Wi.call(e))&&(t=Ni(e),!t||(i=Ui.call(t,"constructor")&&t.constructor,"function"==typeof i&&ji.call(i)===Vi))},isEmptyObject(e){let t;for(t in e)return!1;return!0},globalEval(e,t){Ji(e,{nonce:t&&t.nonce})},each(e,t){let i,n=0;if(tn(e))for(i=e.length;n<i&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:e=>null==e?"":`${e}`.replace(en,""),makeArray(e,t){const i=t||[];return null!=e&&(tn(Object(e))?Ki.merge(i,"string"==typeof e?[e]:e):Bi.call(i,e)),i},inArray:(e,t,i)=>null==t?-1:Gi.call(t,e,i),merge(e,t){const i=+t.length;let n=0,r=e.length;for(;n<i;n++)e[r++]=t[n];return e.length=r,e},grep(e,t,i){let n;const r=[];let o=0;const{length:s}=e,a=!i;for(;o<s;o++)n=!t(e[o],o),n!==a&&r.push(e[o]);return r},map(e,t,i){let n,r,o=0;const s=[];if(tn(e))for(n=e.length;o<n;o++)r=t(e[o],o,i),null!=r&&s.push(r);else for(o in e)r=t(e[o],o,i),null!=r&&s.push(r);return zi.apply([],s)},guid:1,support:qi}),"function"==typeof Symbol&&(Ki.fn[Symbol.iterator]=ki[Symbol.iterator]),Ki.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),((e,t)=>{Hi[`[object ${t}]`]=t.toLowerCase()}));const nn=
/*!
     * Sizzle CSS Selector Engine v2.3.4
     * https://sizzlejs.com/
     *
     * Copyright JS Foundation and other contributors
     * Released under the MIT license
     * https://js.foundation/
     *
     * Date: 2019-04-08
     */
function(e){let t,i,n,r,o,s,a,l,c,u,h,d,p,m,f,g,y,v,_;const x="sizzle"+1*new Date,C=e.document;let w=0,b=0;const S=le(),T=le(),E=le(),P=le();let A=function(e,t){return e===t&&(h=!0),0};const M={}.hasOwnProperty;let L=[];const{pop:D}=L,R=L.push;let{push:I}=L;const{slice:k}=L,O=function(e,t){let i=0;const n=e.length;for(;i<n;i++)if(e[i]===t)return i;return-1},N="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",z="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",B=`\\[${F}*(${z})(?:${F}*([*^$|!~]?=)${F}*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(${z}))|)${F}*\\]`,G=`:(${z})(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|${B})*)|.*)\\)|)`,H=new RegExp(`${F}+`,"g"),W=new RegExp(`^${F}+|((?:^|[^\\\\])(?:\\\\.)*)${F}+$`,"g"),U=new RegExp(`^${F}*,${F}*`),j=new RegExp(`^${F}*([>+~]|${F})${F}*`),V=new RegExp(`${F}|>`),q=new RegExp(G),$=new RegExp(`^${z}$`),Y={ID:new RegExp(`^#(${z})`),CLASS:new RegExp(`^\\.(${z})`),TAG:new RegExp(`^(${z}|[*])`),ATTR:new RegExp(`^${B}`),PSEUDO:new RegExp(`^${G}`),CHILD:new RegExp(`^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(${F}*(even|odd|(([+-]|)(\\d*)n|)${F}*(?:([+-]|)${F}*(\\d+)|))${F}*\\)|)`,"i"),bool:new RegExp(`^(?:${N})$`,"i"),needsContext:new RegExp(`^${F}*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(${F}*((?:-\\d)?\\d*)${F}*\\)|)(?=[^-]|$)`,"i")},X=/HTML$/i,J=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp(`\\\\([\\da-f]{1,6}${F}?|(${F})|.)`,"ig"),ie=function(e,t,i){const n=`0x${t}`-65536;return n!=n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ne=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,re=function(e,t){return t?"\0"===e?"�":`${e.slice(0,-1)}\\${e.charCodeAt(e.length-1).toString(16)} `:`\\${e}`},oe=function(){d()},se=xe((e=>!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()),{dir:"parentNode",next:"legend"});try{I.apply(L=k.call(C.childNodes),C.childNodes),L[C.childNodes.length].nodeType}catch(e){I={apply:L.length?function(e,t){R.apply(e,k.call(t))}:function(e,t){let i=e.length,n=0;for(;e[i++]=t[n++];);e.length=i-1}}}function ae(e,t,n,r){let o,a,c,u,h,m,y,v=t&&t.ownerDocument;const w=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return n;if(!r&&((t?t.ownerDocument||t:C)!==p&&d(t),t=t||p,f)){if(11!==w&&(h=K.exec(e)))if(o=h[1]){if(9===w){if(!(c=t.getElementById(o)))return n;if(c.id===o)return n.push(c),n}else if(v&&(c=v.getElementById(o))&&_(t,c)&&c.id===o)return n.push(c),n}else{if(h[2])return I.apply(n,t.getElementsByTagName(e)),n;if((o=h[3])&&i.getElementsByClassName&&t.getElementsByClassName)return I.apply(n,t.getElementsByClassName(o)),n}if(i.qsa&&!P[`${e} `]&&(!g||!g.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(y=e,v=t,1===w&&V.test(e)){for((u=t.getAttribute("id"))?u=u.replace(ne,re):t.setAttribute("id",u=x),m=s(e),a=m.length;a--;)m[a]=`#${u} ${_e(m[a])}`;y=m.join(","),v=ee.test(e)&&ye(t.parentNode)||t}try{return I.apply(n,v.querySelectorAll(y)),n}catch(t){P(e,!0)}finally{u===x&&t.removeAttribute("id")}}}return l(e.replace(W,"$1"),t,n,r)}function le(){const e=[];return function t(i,r){return e.push(`${i} `)>n.cacheLength&&delete t[e.shift()],t[`${i} `]=r}}function ce(e){return e[x]=!0,e}function ue(e){let t=p.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function he(e,t){const i=e.split("|");let r=i.length;for(;r--;)n.attrHandle[i[r]]=t}function de(e,t){let i=t&&e;const n=i&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function pe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function me(e){return function(t){const i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function fe(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ge(e){return ce((t=>(t=+t,ce(((i,n)=>{let r;const o=e([],i.length,t);let s=o.length;for(;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})))))}function ye(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in i=ae.support={},o=ae.isXML=function(e){const t=e.namespaceURI,i=(e.ownerDocument||e).documentElement;return!X.test(t||i&&i.nodeName||"HTML")},d=ae.setDocument=function(e){let t,r;const s=e?e.ownerDocument||e:C;return s!==p&&9===s.nodeType&&s.documentElement?(p=s,m=p.documentElement,f=!o(p),C!==p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",oe,!1):r.attachEvent&&r.attachEvent("onunload",oe)),i.attributes=ue((e=>(e.className="i",!e.getAttribute("className")))),i.getElementsByTagName=ue((e=>(e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length))),i.getElementsByClassName=Q.test(p.getElementsByClassName),i.getById=ue((e=>(m.appendChild(e).id=x,!p.getElementsByName||!p.getElementsByName(x).length))),i.getById?(n.filter.ID=function(e){const t=e.replace(te,ie);return function(e){return e.getAttribute("id")===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){const i=t.getElementById(e);return i?[i]:[]}}):(n.filter.ID=function(e){const t=e.replace(te,ie);return function(e){const i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){let i,n,r,o=t.getElementById(e);if(o){if(i=o.getAttributeNode("id"),i&&i.value===e)return[o];for(r=t.getElementsByName(e),n=0;o=r[n++];)if(i=o.getAttributeNode("id"),i&&i.value===e)return[o]}return[]}}),n.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){let i;const n=[];let r=0;const o=t.getElementsByTagName(e);if("*"===e){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},n.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&f)return t.getElementsByClassName(e)},y=[],g=[],(i.qsa=Q.test(p.querySelectorAll))&&(ue((e=>{m.appendChild(e).innerHTML=`<a id='${x}'></a><select id='${x}-\r\\' msallowcapture=''><option selected=''></option></select>`,e.querySelectorAll("[msallowcapture^='']").length&&g.push(`[*^$]=${F}*(?:''|"")`),e.querySelectorAll("[selected]").length||g.push(`\\[${F}*(?:value|${N})`),e.querySelectorAll(`[id~=${x}-]`).length||g.push("~="),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll(`a#${x}+*`).length||g.push(".#.+[+~]")})),ue((e=>{e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";const t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push(`name${F}*[*^$|!~]?=`),2!==e.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),m.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")}))),(i.matchesSelector=Q.test(v=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&ue((e=>{i.disconnectedMatch=v.call(e,"*"),v.call(e,"[s!='']:x"),y.push("!=",G)})),g=g.length&&new RegExp(g.join("|")),y=y.length&&new RegExp(y.join("|")),t=Q.test(m.compareDocumentPosition),_=t||Q.test(m.contains)?function(e,t){const i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},A=t?function(e,t){if(e===t)return h=!0,0;let n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!i.sortDetached&&t.compareDocumentPosition(e)===n?e===p||e.ownerDocument===C&&_(C,e)?-1:t===p||t.ownerDocument===C&&_(C,t)?1:u?O(u,e)-O(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return h=!0,0;let i,n=0;const r=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!r||!o)return e===p?-1:t===p?1:r?-1:o?1:u?O(u,e)-O(u,t):0;if(r===o)return de(e,t);for(i=e;i=i.parentNode;)s.unshift(i);for(i=t;i=i.parentNode;)a.unshift(i);for(;s[n]===a[n];)n++;return n?de(s[n],a[n]):s[n]===C?-1:a[n]===C?1:0},p):p},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&d(e),i.matchesSelector&&f&&!P[`${t} `]&&(!y||!y.test(t))&&(!g||!g.test(t)))try{const n=v.call(e,t);if(n||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){P(t,!0)}return ae(t,p,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!==p&&d(e),_(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!==p&&d(e);const r=n.attrHandle[t.toLowerCase()];let o=r&&M.call(n.attrHandle,t.toLowerCase())?r(e,t,!f):void 0;return void 0!==o?o:i.attributes||!f?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},ae.escape=function(e){return`${e}`.replace(ne,re)},ae.error=function(e){throw new Error(`Syntax error, unrecognized expression: ${e}`)},ae.uniqueSort=function(e){let t;const n=[];let r=0,o=0;if(h=!i.detectDuplicates,u=!i.sortStable&&e.slice(0),e.sort(A),h){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return u=null,e},r=ae.getText=function(e){let t,i="",n=0;const{nodeType:o}=e;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=r(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)i+=r(t);return i},n=ae.selectors={cacheLength:50,createPseudo:ce,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:e=>(e[1]=e[1].replace(te,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ie),"~="===e[2]&&(e[3]=` ${e[3]} `),e.slice(0,4)),CHILD:e=>(e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e),PSEUDO(e){let t;const i=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&q.test(i)&&(t=s(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG(e){const t=e.replace(te,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS(e){let t=S[`${e} `];return t||(t=new RegExp(`(^|${F})${e}(${F}|$)`))&&S(e,(e=>t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")))},ATTR:(e,t,i)=>function(n){let r=ae.attr(n,e);return null==r?"!="===t:!t||(r+="","="===t?r===i:"!="===t?r!==i:"^="===t?i&&0===r.indexOf(i):"*="===t?i&&r.indexOf(i)>-1:"$="===t?i&&r.slice(-i.length)===i:"~="===t?` ${r.replace(H," ")} `.indexOf(i)>-1:"|="===t&&(r===i||r.slice(0,i.length+1)===`${i}-`))},CHILD(e,t,i,n,r){const o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,l){let c,u,h,d,p,m,f=o!==s?"nextSibling":"previousSibling";const g=t.parentNode,y=a&&t.nodeName.toLowerCase(),v=!l&&!a;let _=!1;if(g){if(o){for(;f;){for(d=t;d=d[f];)if(a?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;m=f="only"===e&&!m&&"nextSibling"}return!0}if(m=[s?g.firstChild:g.lastChild],s&&v){for(d=g,h=d[x]||(d[x]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),c=u[e]||[],p=c[0]===w&&c[1],_=p&&c[2],d=p&&g.childNodes[p];d=++p&&d&&d[f]||(_=p=0)||m.pop();)if(1===d.nodeType&&++_&&d===t){u[e]=[w,p,_];break}}else if(v&&(d=t,h=d[x]||(d[x]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),c=u[e]||[],p=c[0]===w&&c[1],_=p),!1===_)for(;(d=++p&&d&&d[f]||(_=p=0)||m.pop())&&((a?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++_||(v&&(h=d[x]||(d[x]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),u[e]=[w,_]),d!==t)););return _-=r,_===n||_%n==0&&_/n>=0}}},PSEUDO(e,t){let i;const r=n.pseudos[e]||n.setFilters[e.toLowerCase()]||ae.error(`unsupported pseudo: ${e}`);return r[x]?r(t):r.length>1?(i=[e,e,"",t],n.setFilters.hasOwnProperty(e.toLowerCase())?ce(((e,i)=>{let n;const o=r(e,t);let s=o.length;for(;s--;)n=O(e,o[s]),e[n]=!(i[n]=o[s])})):function(e){return r(e,0,i)}):r}},pseudos:{not:ce((e=>{const t=[],i=[],n=a(e.replace(W,"$1"));return n[x]?ce(((e,t,i,r)=>{let o;const s=n(e,null,r,[]);let a=e.length;for(;a--;)(o=s[a])&&(e[a]=!(t[a]=o))})):function(e,r,o){return t[0]=e,n(t,null,o,i),t[0]=null,!i.pop()}})),has:ce((e=>function(t){return ae(e,t).length>0})),contains:ce((e=>(e=e.replace(te,ie),function(t){return(t.textContent||r(t)).indexOf(e)>-1}))),lang:ce((e=>($.test(e||"")||ae.error(`unsupported lang: ${e}`),e=e.replace(te,ie).toLowerCase(),function(t){let i;do{if(i=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(`${e}-`)}while((t=t.parentNode)&&1===t.nodeType);return!1}))),target(t){const i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:e=>e===m,focus:e=>e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex),enabled:fe(!1),disabled:fe(!0),checked(e){const t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:e=>(e.parentNode&&e.parentNode.selectedIndex,!0===e.selected),empty(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:e=>!n.pseudos.empty(e),header:e=>Z.test(e.nodeName),input:e=>J.test(e.nodeName),button(e){const t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text(e){let t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ge((()=>[0])),last:ge(((e,t)=>[t-1])),eq:ge(((e,t,i)=>[i<0?i+t:i])),even:ge(((e,t)=>{let i=0;for(;i<t;i+=2)e.push(i);return e})),odd:ge(((e,t)=>{let i=1;for(;i<t;i+=2)e.push(i);return e})),lt:ge(((e,t,i)=>{let n=i<0?i+t:i>t?t:i;for(;--n>=0;)e.push(n);return e})),gt:ge(((e,t,i)=>{let n=i<0?i+t:i;for(;++n<t;)e.push(n);return e}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[t]=pe(t);for(t in{submit:!0,reset:!0})n.pseudos[t]=me(t);function ve(){}function _e(e){let t=0;const i=e.length;let n="";for(;t<i;t++)n+=e[t].value;return n}function xe(e,t,i){const{dir:n}=t,r=t.next,o=r||n,s=i&&"parentNode"===o,a=b++;return t.first?function(t,i,r){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,r);return!1}:function(t,i,l){let c,u,h;const d=[w,a];if(l){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,l))return!0}else for(;t=t[n];)if(1===t.nodeType||s)if(h=t[x]||(t[x]={}),u=h[t.uniqueID]||(h[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[n]||t;else{if((c=u[o])&&c[0]===w&&c[1]===a)return d[2]=c[2];if(u[o]=d,d[2]=e(t,i,l))return!0}return!1}}function Ce(e){return e.length>1?function(t,i,n){let r=e.length;for(;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function we(e,t,i,n,r){let o;const s=[];let a=0;const l=e.length,c=null!=t;for(;a<l;a++)(o=e[a])&&(i&&!i(o,n,r)||(s.push(o),c&&t.push(a)));return s}function be(e,t,i,n,r,o){return n&&!n[x]&&(n=be(n)),r&&!r[x]&&(r=be(r,o)),ce(((o,s,a,l)=>{let c,u,h;const d=[],p=[],m=s.length,f=o||function(e,t,i){let n=0;const r=t.length;for(;n<r;n++)ae(e,t[n],i);return i}(t||"*",a.nodeType?[a]:a,[]),g=!e||!o&&t?f:we(f,d,e,a,l);let y=i?r||(o?e:m||n)?[]:s:g;if(i&&i(g,y,a,l),n)for(c=we(y,p),n(c,[],a,l),u=c.length;u--;)(h=c[u])&&(y[p[u]]=!(g[p[u]]=h));if(o){if(r||e){if(r){for(c=[],u=y.length;u--;)(h=y[u])&&c.push(g[u]=h);r(null,y=[],c,l)}for(u=y.length;u--;)(h=y[u])&&(c=r?O(o,h):d[u])>-1&&(o[c]=!(s[c]=h))}}else y=we(y===s?y.splice(m,y.length):y),r?r(null,s,y,l):I.apply(s,y)}))}function Se(e){let t,i,r;const o=e.length,s=n.relative[e[0].type],a=s||n.relative[" "];let l=s?1:0;const u=xe((e=>e===t),a,!0),h=xe((e=>O(t,e)>-1),a,!0);let d=[function(e,i,n){const r=!s&&(n||i!==c)||((t=i).nodeType?u(e,i,n):h(e,i,n));return t=null,r}];for(;l<o;l++)if(i=n.relative[e[l].type])d=[xe(Ce(d),i)];else{if(i=n.filter[e[l].type].apply(null,e[l].matches),i[x]){for(r=++l;r<o&&!n.relative[e[r].type];r++);return be(l>1&&Ce(d),l>1&&_e(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(W,"$1"),i,l<r&&Se(e.slice(l,r)),r<o&&Se(e=e.slice(r)),r<o&&_e(e))}d.push(i)}return Ce(d)}return ve.prototype=n.filters=n.pseudos,n.setFilters=new ve,s=ae.tokenize=function(e,t){let i,r,o,s,a,l,c;const u=T[`${e} `];if(u)return t?0:u.slice(0);for(a=e,l=[],c=n.preFilter;a;){for(s in i&&!(r=U.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),i=!1,(r=j.exec(a))&&(i=r.shift(),o.push({value:i,type:r[0].replace(W," ")}),a=a.slice(i.length)),n.filter)!(r=Y[s].exec(a))||c[s]&&!(r=c[s](r))||(i=r.shift(),o.push({value:i,type:s,matches:r}),a=a.slice(i.length));if(!i)break}return t?a.length:a?ae.error(e):T(e,l).slice(0)},a=ae.compile=function(e,t){let i;const r=[],o=[];let a=E[`${e} `];if(!a){for(t||(t=s(e)),i=t.length;i--;)a=Se(t[i]),a[x]?r.push(a):o.push(a);a=E(e,function(e,t){const i=t.length>0,r=e.length>0,o=function(o,s,a,l,u){let h,m,g,y=0,v="0";const _=o&&[];let x=[];const C=c,b=o||r&&n.find.TAG("*",u),S=w+=null==C?1:Math.random()||.1,T=b.length;for(u&&(c=s===p||s||u);v!==T&&null!=(h=b[v]);v++){if(r&&h){for(m=0,s||h.ownerDocument===p||(d(h),a=!f);g=e[m++];)if(g(h,s||p,a)){l.push(h);break}u&&(w=S)}i&&((h=!g&&h)&&y--,o&&_.push(h))}if(y+=v,i&&v!==y){for(m=0;g=t[m++];)g(_,x,s,a);if(o){if(y>0)for(;v--;)_[v]||x[v]||(x[v]=D.call(l));x=we(x)}I.apply(l,x),u&&!o&&x.length>0&&y+t.length>1&&ae.uniqueSort(l)}return u&&(w=S,c=C),_};return i?ce(o):o}(o,r)),a.selector=e}return a},l=ae.select=function(e,t,i,r){let o,l,c,u,h;const d="function"==typeof e&&e,p=!r&&s(e=d.selector||e);if(i=i||[],1===p.length){if(l=p[0]=p[0].slice(0),l.length>2&&"ID"===(c=l[0]).type&&9===t.nodeType&&f&&n.relative[l[1].type]){if(!(t=(n.find.ID(c.matches[0].replace(te,ie),t)||[])[0]))return i;d&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(o=Y.needsContext.test(e)?0:l.length;o--&&(c=l[o],!n.relative[u=c.type]);)if((h=n.find[u])&&(r=h(c.matches[0].replace(te,ie),ee.test(l[0].type)&&ye(t.parentNode)||t))){if(l.splice(o,1),!(e=r.length&&_e(l)))return I.apply(i,r),i;break}}return(d||a(e,p))(r,t,!f,i,!t||ee.test(e)&&ye(t.parentNode)||t),i},i.sortStable=x.split("").sort(A).join("")===x,i.detectDuplicates=!!h,d(),i.sortDetached=ue((e=>1&e.compareDocumentPosition(p.createElement("fieldset")))),ue((e=>(e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href"))))||he("type|href|height|width",((e,t,i)=>{if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),i.attributes&&ue((e=>(e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value"))))||he("value",((e,t,i)=>{if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),ue((e=>null==e.getAttribute("disabled")))||he(N,((e,t,i)=>{let n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null})),ae}(window);Ki.find=nn,Ki.expr=nn.selectors,Ki.expr[":"]=Ki.expr.pseudos,Ki.uniqueSort=Ki.unique=nn.uniqueSort,Ki.text=nn.getText,Ki.isXMLDoc=nn.isXML,Ki.contains=nn.contains,Ki.escapeSelector=nn.escape;const rn=function(e,t,i){const n=[],r=void 0!==i;for(;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&Ki(e).is(i))break;n.push(e)}return n},on=function(e,t){const i=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},sn=Ki.expr.match.needsContext;function an(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}const ln=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function cn(e,t,i){return $i(t)?Ki.grep(e,((e,n)=>!!t.call(e,n,e)!==i)):t.nodeType?Ki.grep(e,(e=>e===t!==i)):"string"!=typeof t?Ki.grep(e,(e=>Gi.call(t,e)>-1!==i)):Ki.filter(t,e,i)}let un;Ki.filter=function(e,t,i){const n=t[0];return i&&(e=`:not(${e})`),1===t.length&&1===n.nodeType?Ki.find.matchesSelector(n,e)?[n]:[]:Ki.find.matches(e,Ki.grep(t,(e=>1===e.nodeType)))},Ki.fn.extend({find(e){let t,i;const n=this.length,r=this;if("string"!=typeof e)return this.pushStack(Ki(e).filter((function(){for(t=0;t<n;t++)if(Ki.contains(r[t],this))return!0})));for(i=this.pushStack([]),t=0;t<n;t++)Ki.find(e,r[t],i);return n>1?Ki.uniqueSort(i):i},filter(e){return this.pushStack(cn(this,e||[],!1))},not(e){return this.pushStack(cn(this,e||[],!0))},is(e){return!!cn(this,"string"==typeof e&&sn.test(e)?Ki(e):e||[],!1).length}});const hn=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(Ki.fn.init=function(e,t,i){let n,r;if(!e)return this;if(i=i||un,"string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:hn.exec(e),n&&(n[1]||!t)){if(n[1]){if(t=t instanceof Ki?t[0]:t,Ki.merge(this,Ki.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:Oi,!0)),ln.test(n[1])&&Ki.isPlainObject(t))for(n in t)$i(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return r=Oi.getElementById(n[2]),r&&(this[0]=r,this.length=1),this}return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e)}return e.nodeType?(this[0]=e,this.length=1,this):$i(e)?void 0!==i.ready?i.ready(e):e(Ki):Ki.makeArray(e,this)}).prototype=Ki.fn,un=Ki(Oi);const dn=/^(?:parents|prev(?:Until|All))/,pn={children:!0,contents:!0,next:!0,prev:!0};function mn(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}Ki.fn.extend({has(e){const t=Ki(e,this),i=t.length;return this.filter((function(){let e=0;for(;e<i;e++)if(Ki.contains(this,t[e]))return!0}))},closest(e,t){let i,n=0;const r=this.length,o=[],s="string"!=typeof e&&Ki(e);if(!sn.test(e))for(;n<r;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&Ki.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?Ki.uniqueSort(o):o)},index(e){return e?"string"==typeof e?Gi.call(Ki(e),this[0]):Gi.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add(e,t){return this.pushStack(Ki.uniqueSort(Ki.merge(this.get(),Ki(e,t))))},addBack(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Ki.each({parent(e){const t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:e=>rn(e,"parentNode"),parentsUntil:(e,t,i)=>rn(e,"parentNode",i),next:e=>mn(e,"nextSibling"),prev:e=>mn(e,"previousSibling"),nextAll:e=>rn(e,"nextSibling"),prevAll:e=>rn(e,"previousSibling"),nextUntil:(e,t,i)=>rn(e,"nextSibling",i),prevUntil:(e,t,i)=>rn(e,"previousSibling",i),siblings:e=>on((e.parentNode||{}).firstChild,e),children:e=>on(e.firstChild),contents:e=>void 0!==e.contentDocument?e.contentDocument:(an(e,"template")&&(e=e.content||e),Ki.merge([],e.childNodes))},((e,t)=>{Ki.fn[e]=function(i,n){let r=Ki.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=Ki.filter(n,r)),this.length>1&&(pn[e]||Ki.uniqueSort(r),dn.test(e)&&r.reverse()),this.pushStack(r)}}));const fn=/[^\x20\t\r\n\f]+/g;function gn(e){return e}function yn(e){throw e}function vn(e,t,i,n){let r;try{e&&$i(r=e.promise)?r.call(e).done(t).fail(i):e&&$i(r=e.then)?r.call(e,t,i):t.apply(void 0,[e].slice(n))}catch(e){i.apply(void 0,[e])}}Ki.Callbacks=function(e){let t,i,n,r;e="string"==typeof e?function(e){const t={};return Ki.each(e.match(fn)||[],((e,i)=>{t[i]=!0})),t}(e):Ki.extend({},e);let o=[],s=[],a=-1;const l=function(){for(r=r||e.once,n=t=!0;s.length;a=-1)for(i=s.shift();++a<o.length;)!1===o[a].apply(i[0],i[1])&&e.stopOnFalse&&(a=o.length,i=!1);e.memory||(i=!1),t=!1,r&&(o=i?[]:"")};var c={add(){return o&&(i&&!t&&(a=o.length-1,s.push(i)),function t(i){Ki.each(i,((i,n)=>{$i(n)?e.unique&&c.has(n)||o.push(n):n&&n.length&&"string"!==Zi(n)&&t(n)}))}(arguments),i&&!t&&l()),this},remove(){return Ki.each(arguments,((e,t)=>{let i;for(;(i=Ki.inArray(t,o,i))>-1;)o.splice(i,1),i<=a&&a--})),this},has:e=>e?Ki.inArray(e,o)>-1:o.length>0,empty(){return o&&(o=[]),this},disable(){return r=s=[],o=i="",this},disabled:()=>!o,lock(){return r=s=[],i||t||(o=i=""),this},locked:()=>!!r,fireWith(e,i){return r||(i=[e,(i=i||[]).slice?i.slice():i],s.push(i),t||l()),this},fire(){return c.fireWith(this,arguments),this},fired:()=>!!n};return c},Ki.extend({Deferred(e){const t=[["notify","progress",Ki.Callbacks("memory"),Ki.Callbacks("memory"),2],["resolve","done",Ki.Callbacks("once memory"),Ki.Callbacks("once memory"),0,"resolved"],["reject","fail",Ki.Callbacks("once memory"),Ki.Callbacks("once memory"),1,"rejected"]];let i="pending";var n={state:()=>i,always(){return r.done(arguments).fail(arguments),this},catch:e=>n.then(null,e),pipe(){let e=arguments;return Ki.Deferred((i=>{Ki.each(t,((t,n)=>{const o=$i(e[n[4]])&&e[n[4]];r[n[1]]((function(){const e=o&&o.apply(this,arguments);e&&$i(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[`${n[0]}With`](this,o?[e]:arguments)}))})),e=null})).promise()},then(e,i,n){let r=0;function o(e,t,i,n){return function(){let s=this,a=arguments;const l=function(){let l,c;if(!(e<r)){if(l=i.apply(s,a),l===t.promise())throw new TypeError("Thenable self-resolution");c=l&&("object"==typeof l||"function"==typeof l)&&l.then,$i(c)?n?c.call(l,o(r,t,gn,n),o(r,t,yn,n)):(r++,c.call(l,o(r,t,gn,n),o(r,t,yn,n),o(r,t,gn,t.notifyWith))):(i!==gn&&(s=void 0,a=[l]),(n||t.resolveWith)(s,a))}};var c=n?l:function(){try{l()}catch(n){Ki.Deferred.exceptionHook&&Ki.Deferred.exceptionHook(n,c.stackTrace),e+1>=r&&(i!==yn&&(s=void 0,a=[n]),t.rejectWith(s,a))}};e?c():(Ki.Deferred.getStackHook&&(c.stackTrace=Ki.Deferred.getStackHook()),window.setTimeout(c))}}return Ki.Deferred((r=>{t[0][3].add(o(0,r,$i(n)?n:gn,r.notifyWith)),t[1][3].add(o(0,r,$i(e)?e:gn)),t[2][3].add(o(0,r,$i(i)?i:yn))})).promise()},promise:e=>null!=e?Ki.extend(e,n):n},r={};return Ki.each(t,((e,o)=>{const s=o[2],a=o[5];n[o[1]]=s.add,a&&s.add((()=>{i=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),s.add(o[3].fire),r[o[0]]=function(){return r[`${o[0]}With`](this===r?void 0:this,arguments),this},r[`${o[0]}With`]=s.fireWith})),n.promise(r),e&&e.call(r,r),r},when(e){let t=arguments.length,i=t;const n=Array(i),r=Fi.call(arguments),o=Ki.Deferred(),s=function(e){return function(i){n[e]=this,r[e]=arguments.length>1?Fi.call(arguments):i,--t||o.resolveWith(n,r)}};if(t<=1&&(vn(e,o.done(s(i)).resolve,o.reject,!t),"pending"===o.state()||$i(r[i]&&r[i].then)))return o.then();for(;i--;)vn(r[i],s(i),o.reject);return o.promise()}});const _n=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;Ki.Deferred.exceptionHook=function(e,t){window.console&&window.console.warn&&e&&_n.test(e.name)&&window.console.warn(`jQuery.Deferred exception: ${e.message}`,e.stack,t)},Ki.readyException=function(e){window.setTimeout((()=>{throw e}))};const xn=Ki.Deferred();function Cn(){Oi.removeEventListener("DOMContentLoaded",Cn),window.removeEventListener("load",Cn),Ki.ready()}Ki.fn.ready=function(e){return xn.then(e).catch((e=>{Ki.readyException(e)})),this},Ki.extend({isReady:!1,readyWait:1,ready(e){(!0===e?--Ki.readyWait:Ki.isReady)||(Ki.isReady=!0,!0!==e&&--Ki.readyWait>0||xn.resolveWith(Oi,[Ki]))}}),Ki.ready.then=xn.then,"complete"===Oi.readyState||"loading"!==Oi.readyState&&!Oi.documentElement.doScroll?window.setTimeout(Ki.ready):(Oi.addEventListener("DOMContentLoaded",Cn),window.addEventListener("load",Cn));var wn=function(e,t,i,n,r,o,s){let a=0;const l=e.length;let c=null==i;if("object"===Zi(i))for(a in r=!0,i)wn(e,t,a,i[a],!0,o,s);else if(void 0!==n&&(r=!0,$i(n)||(s=!0),c&&(s?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(Ki(e),i)})),t))for(;a<l;a++)t(e[a],i,s?n:n.call(e[a],a,t(e[a],i)));return r?e:c?t.call(e):l?t(e[0],i):o};const bn=/^-ms-/,Sn=/-([a-z])/g;function Tn(e,t){return t.toUpperCase()}function En(e){return e.replace(bn,"ms-").replace(Sn,Tn)}const Pn=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function An(){this.expando=Ki.expando+An.uid++}An.uid=1,An.prototype={cache(e){let t=e[this.expando];return t||(t={},Pn(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set(e,t,i){let n;const r=this.cache(e);if("string"==typeof t)r[En(t)]=i;else for(n in t)r[En(n)]=t[n];return r},get(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][En(t)]},access(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove(e,t){let i;const n=e[this.expando];if(void 0!==n){if(void 0!==t){i=(t=Array.isArray(t)?t.map(En):(t=En(t))in n?[t]:t.match(fn)||[]).length;for(;i--;)delete n[t[i]]}(void 0===t||Ki.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData(e){const t=e[this.expando];return void 0!==t&&!Ki.isEmptyObject(t)}};const Mn=new An,Ln=new An,Dn=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Rn=/[A-Z]/g;function In(e,t,i){let n;if(void 0===i&&1===e.nodeType)if(n=`data-${t.replace(Rn,"-$&").toLowerCase()}`,"string"==typeof(i=e.getAttribute(n))){try{i=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===""+ +e?+e:Dn.test(e)?JSON.parse(e):e)}(i)}catch(e){}Ln.set(e,t,i)}else i=void 0;return i}Ki.extend({hasData:e=>Ln.hasData(e)||Mn.hasData(e),data:(e,t,i)=>Ln.access(e,t,i),removeData(e,t){Ln.remove(e,t)},_data:(e,t,i)=>Mn.access(e,t,i),_removeData(e,t){Mn.remove(e,t)}}),Ki.fn.extend({data(e,t){let i,n,r;const o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=Ln.get(o),1===o.nodeType&&!Mn.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=En(n.slice(5)),In(o,n,r[n])));Mn.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each((function(){Ln.set(this,e)})):wn(this,(function(t){let i;if(o&&void 0===t)return i=Ln.get(o,e),void 0!==i?i:(i=In(o,e),void 0!==i?i:void 0);this.each((function(){Ln.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData(e){return this.each((function(){Ln.remove(this,e)}))}}),Ki.extend({queue(e,t,i){let n;if(e)return t=`${t||"fx"}queue`,n=Mn.get(e,t),i&&(!n||Array.isArray(i)?n=Mn.access(e,t,Ki.makeArray(i)):n.push(i)),n||[]},dequeue(e,t){t=t||"fx";const i=Ki.queue(e,t);let n=i.length,r=i.shift();const o=Ki._queueHooks(e,t),s=function(){Ki.dequeue(e,t)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,s,o)),!n&&o&&o.empty.fire()},_queueHooks(e,t){const i=`${t}queueHooks`;return Mn.get(e,i)||Mn.access(e,i,{empty:Ki.Callbacks("once memory").add((()=>{Mn.remove(e,[`${t}queue`,i])}))})}}),Ki.fn.extend({queue(e,t){let i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?Ki.queue(this[0],e):void 0===t?this:this.each((function(){const i=Ki.queue(this,e,t);Ki._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&Ki.dequeue(this,e)}))},dequeue(e){return this.each((function(){Ki.dequeue(this,e)}))},clearQueue(e){return this.queue(e||"fx",[])},promise(e,t){let i,n=1;const r=Ki.Deferred(),o=this;let s=this.length;const a=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)i=Mn.get(o[s],`${e}queueHooks`),i&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(t)}});const kn=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,On=new RegExp(`^(?:([+-])=|)(${kn})([a-z%]*)$`,"i"),Nn=["Top","Right","Bottom","Left"],{documentElement:Fn}=Oi;let zn=function(e){return Ki.contains(e.ownerDocument,e)};const Bn={composed:!0};Fn.getRootNode&&(zn=function(e){return Ki.contains(e.ownerDocument,e)||e.getRootNode(Bn)===e.ownerDocument});const Gn=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&zn(e)&&"none"===Ki.css(e,"display")},Hn=function(e,t,i,n){let r,o;const s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];for(o in r=i.apply(e,n||[]),t)e.style[o]=s[o];return r};function Wn(e,t,i,n){let r,o,s=20;const a=n?function(){return n.cur()}:function(){return Ki.css(e,t,"")};let l=a(),c=i&&i[3]||(Ki.cssNumber[t]?"":"px"),u=e.nodeType&&(Ki.cssNumber[t]||"px"!==c&&+l)&&On.exec(Ki.css(e,t));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)Ki.style(e,t,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;u*=2,Ki.style(e,t,u+c),i=i||[]}return i&&(u=+u||+l||0,r=i[1]?u+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=u,n.end=r)),r}const Un={};function jn(e){let t;const i=e.ownerDocument,{nodeName:n}=e;let r=Un[n];return r||(t=i.body.appendChild(i.createElement(n)),r=Ki.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),Un[n]=r,r)}function Vn(e,t){let i,n;const r=[];let o=0;const{length:s}=e;for(;o<s;o++)n=e[o],n.style&&(i=n.style.display,t?("none"===i&&(r[o]=Mn.get(n,"display")||null,r[o]||(n.style.display="")),""===n.style.display&&Gn(n)&&(r[o]=jn(n))):"none"!==i&&(r[o]="none",Mn.set(n,"display",i)));for(o=0;o<s;o++)null!=r[o]&&(e[o].style.display=r[o]);return e}Ki.fn.extend({show(){return Vn(this,!0)},hide(){return Vn(this)},toggle(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){Gn(this)?Ki(this).show():Ki(this).hide()}))}});const qn=/^(?:checkbox|radio)$/i,$n=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Yn=/^$|^module$|\/(?:java|ecma)script/i,Xn={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Jn(e,t){let i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&an(e,t)?Ki.merge([e],i):i}function Zn(e,t){let i=0;const n=e.length;for(;i<n;i++)Mn.set(e[i],"globalEval",!t||Mn.get(t[i],"globalEval"))}Xn.optgroup=Xn.option,Xn.tbody=Xn.tfoot=Xn.colgroup=Xn.caption=Xn.thead,Xn.th=Xn.td;const Qn=/<|&#?\w+;/;function Kn(e,t,i,n,r){let o,s,a,l,c,u;const h=t.createDocumentFragment(),d=[];let p=0;const m=e.length;for(;p<m;p++)if(o=e[p],o||0===o)if("object"===Zi(o))Ki.merge(d,o.nodeType?[o]:o);else if(Qn.test(o)){for(s=s||h.appendChild(t.createElement("div")),a=($n.exec(o)||["",""])[1].toLowerCase(),l=Xn[a]||Xn._default,s.innerHTML=l[1]+Ki.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;Ki.merge(d,s.childNodes),s=h.firstChild,s.textContent=""}else d.push(t.createTextNode(o));for(h.textContent="",p=0;o=d[p++];)if(n&&Ki.inArray(o,n)>-1)r&&r.push(o);else if(c=zn(o),s=Jn(h.appendChild(o),"script"),c&&Zn(s),i)for(u=0;o=s[u++];)Yn.test(o.type||"")&&i.push(o);return h}!function(){const e=Oi.createDocumentFragment().appendChild(Oi.createElement("div")),t=Oi.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),qi.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",qi.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();const er=/^key/,tr=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ir=/^([^.]*)(?:\.(.+)|)/;function nr(){return!0}function rr(){return!1}function or(e,t){return e===function(){try{return Oi.activeElement}catch(e){}}()==("focus"===t)}function sr(e,t,i,n,r,o){let s,a;if("object"==typeof t){for(a in"string"!=typeof i&&(n=n||i,i=void 0),t)sr(e,a,i,n,t[a],o);return e}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=rr;else if(!r)return e;return 1===o&&(s=r,r=function(e){return Ki().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=Ki.guid++)),e.each((function(){Ki.event.add(this,t,r,n,i)}))}function ar(e,t,i){i?(Mn.set(e,t,!1),Ki.event.add(e,t,{namespace:!1,handler(e){let n,r,o=Mn.get(this,t);if(1&e.isTrigger&&this[t]){if(o.length)(Ki.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=Fi.call(arguments),Mn.set(this,t,o),n=i(this,t),this[t](),r=Mn.get(this,t),o!==r||n?Mn.set(this,t,!1):r={},o!==r)return e.stopImmediatePropagation(),e.preventDefault(),r.value}else o.length&&(Mn.set(this,t,{value:Ki.event.trigger(Ki.extend(o[0],Ki.Event.prototype),o.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Mn.get(e,t)&&Ki.event.add(e,t,nr)}Ki.event={global:{},add(e,t,i,n,r){let o,s,a,l,c,u,h,d,p,m,f;const g=Mn.get(e);if(g)for(i.handler&&(o=i,i=o.handler,r=o.selector),r&&Ki.find.matchesSelector(Fn,r),i.guid||(i.guid=Ki.guid++),(l=g.events)||(l=g.events={}),(s=g.handle)||(s=g.handle=function(t){return void 0!==Ki&&Ki.event.triggered!==t.type?Ki.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(fn)||[""]).length;c--;)a=ir.exec(t[c])||[],p=f=a[1],m=(a[2]||"").split(".").sort(),p&&(h=Ki.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=Ki.event.special[p]||{},u=Ki.extend({type:p,origType:f,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&Ki.expr.match.needsContext.test(r),namespace:m.join(".")},o),(d=l[p])||(d=l[p]=[],d.delegateCount=0,h.setup&&!1!==h.setup.call(e,n,m,s)||e.addEventListener&&e.addEventListener(p,s)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),Ki.event.global[p]=!0)},remove(e,t,i,n,r){let o,s,a,l,c,u,h,d,p,m,f;const g=Mn.hasData(e)&&Mn.get(e);if(g&&(l=g.events)){for(c=(t=(t||"").match(fn)||[""]).length;c--;)if(a=ir.exec(t[c])||[],p=f=a[1],m=(a[2]||"").split(".").sort(),p){for(h=Ki.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,d=l[p]||[],a=a[2]&&new RegExp(`(^|\\.)${m.join("\\.(?:.*\\.|)")}(\\.|$)`),s=o=d.length;o--;)u=d[o],!r&&f!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,m,g.handle)||Ki.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)Ki.event.remove(e,p+t[c],i,n,!0);Ki.isEmptyObject(l)&&Mn.remove(e,"handle events")}},dispatch(e){const t=Ki.event.fix(e);let i,n,r,o,s,a;const l=new Array(arguments.length),c=(Mn.get(this,"events")||{})[t.type]||[],u=Ki.event.special[t.type]||{};for(l[0]=t,i=1;i<arguments.length;i++)l[i]=arguments[i];if(t.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,t)){for(a=Ki.event.handlers.call(this,t,c),i=0;(o=a[i++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,n=0;(s=o.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!1!==s.namespace&&!t.rnamespace.test(s.namespace)||(t.handleObj=s,t.data=s.data,r=((Ki.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,l),void 0!==r&&!1===(t.result=r)&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers(e,t){let i,n,r,o,s;const a=[],{delegateCount:l}=t;let c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(o=[],s={},i=0;i<l;i++)n=t[i],r=`${n.selector} `,void 0===s[r]&&(s[r]=n.needsContext?Ki(r,this).index(c)>-1:Ki.find(r,this,null,[c]).length),s[r]&&o.push(n);o.length&&a.push({elem:c,handlers:o})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp(e,t){Object.defineProperty(Ki.Event.prototype,e,{enumerable:!0,configurable:!0,get:$i(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:e=>e[Ki.expando]?e:new Ki.Event(e),special:{load:{noBubble:!0},click:{setup(e){const t=this||e;return qn.test(t.type)&&t.click&&an(t,"input")&&ar(t,"click",nr),!1},trigger(e){const t=this||e;return qn.test(t.type)&&t.click&&an(t,"input")&&ar(t,"click"),!0},_default(e){const{target:t}=e;return qn.test(t.type)&&t.click&&an(t,"input")&&Mn.get(t,"click")||an(t,"a")}},beforeunload:{postDispatch(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},Ki.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},Ki.Event=function(e,t){if(!(this instanceof Ki.Event))return new Ki.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?nr:rr,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&Ki.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[Ki.expando]=!0},Ki.Event.prototype={constructor:Ki.Event,isDefaultPrevented:rr,isPropagationStopped:rr,isImmediatePropagationStopped:rr,isSimulated:!1,preventDefault(){const e=this.originalEvent;this.isDefaultPrevented=nr,e&&!this.isSimulated&&e.preventDefault()},stopPropagation(){const e=this.originalEvent;this.isPropagationStopped=nr,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation(){const e=this.originalEvent;this.isImmediatePropagationStopped=nr,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},Ki.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which(e){const{button:t}=e;return null==e.which&&er.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&tr.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},Ki.event.addProp),Ki.each({focus:"focusin",blur:"focusout"},((e,t)=>{Ki.event.special[e]={setup(){return ar(this,e,or),!1},trigger(){return ar(this,e),!0},delegateType:t}})),Ki.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},((e,t)=>{Ki.event.special[e]={delegateType:t,bindType:t,handle(e){let i;const n=e.relatedTarget,{handleObj:r}=e;return n&&(n===this||Ki.contains(this,n))||(e.type=r.origType,i=r.handler.apply(this,arguments),e.type=t),i}}})),Ki.fn.extend({on(e,t,i,n){return sr(this,e,t,i,n)},one(e,t,i,n){return sr(this,e,t,i,n,1)},off(e,t,i){let n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,Ki(e.delegateTarget).off(n.namespace?`${n.origType}.${n.namespace}`:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=rr),this.each((function(){Ki.event.remove(this,e,i,t)}))}});const lr=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,cr=/<script|<style|<link/i,ur=/checked\s*(?:[^=]|=\s*.checked.)/i,hr=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function dr(e,t){return an(e,"table")&&an(11!==t.nodeType?t:t.firstChild,"tr")&&Ki(e).children("tbody")[0]||e}function pr(e){return e.type=`${null!==e.getAttribute("type")}/${e.type}`,e}function mr(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function fr(e,t){let i,n,r,o,s,a,l,c;if(1===t.nodeType){if(Mn.hasData(e)&&(o=Mn.access(e),s=Mn.set(t,o),c=o.events,c))for(r in delete s.handle,s.events={},c)for(i=0,n=c[r].length;i<n;i++)Ki.event.add(t,r,c[r][i]);Ln.hasData(e)&&(a=Ln.access(e),l=Ki.extend({},a),Ln.set(t,l))}}function gr(e,t){const i=t.nodeName.toLowerCase();"input"===i&&qn.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function yr(e,t,i,n){let r,o,s,a,l,c;t=zi.apply([],t);let u=0;const h=e.length,d=h-1,p=t[0],m=$i(p);if(m||h>1&&"string"==typeof p&&!qi.checkClone&&ur.test(p))return e.each((function(r){const o=e.eq(r);m&&(t[0]=p.call(this,r,o.html())),yr(o,t,i,n)}));if(h&&(r=Kn(t,e[0].ownerDocument,!1,e,n),o=r.firstChild,1===r.childNodes.length&&(r=o),o||n)){for(s=Ki.map(Jn(r,"script"),pr),a=s.length;u<h;u++)l=r,u!==d&&(l=Ki.clone(l,!0,!0),a&&Ki.merge(s,Jn(l,"script"))),i.call(e[u],l,u);if(a)for(c=s[s.length-1].ownerDocument,Ki.map(s,mr),u=0;u<a;u++)l=s[u],Yn.test(l.type||"")&&!Mn.access(l,"globalEval")&&Ki.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?Ki._evalUrl&&!l.noModule&&Ki._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")}):Ji(l.textContent.replace(hr,""),l,c))}return e}function vr(e,t,i){let n;const r=t?Ki.filter(t,e):e;let o=0;for(;null!=(n=r[o]);o++)i||1!==n.nodeType||Ki.cleanData(Jn(n)),n.parentNode&&(i&&zn(n)&&Zn(Jn(n,"script")),n.parentNode.removeChild(n));return e}Ki.extend({htmlPrefilter:e=>e.replace(lr,"<$1></$2>"),clone(e,t,i){let n,r,o,s;const a=e.cloneNode(!0),l=zn(e);if(!(qi.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Ki.isXMLDoc(e)))for(s=Jn(a),o=Jn(e),n=0,r=o.length;n<r;n++)gr(o[n],s[n]);if(t)if(i)for(o=o||Jn(e),s=s||Jn(a),n=0,r=o.length;n<r;n++)fr(o[n],s[n]);else fr(e,a);return s=Jn(a,"script"),s.length>0&&Zn(s,!l&&Jn(e,"script")),a},cleanData(e){let t,i,n;const{special:r}=Ki.event;let o=0;for(;void 0!==(i=e[o]);o++)if(Pn(i)){if(t=i[Mn.expando]){if(t.events)for(n in t.events)r[n]?Ki.event.remove(i,n):Ki.removeEvent(i,n,t.handle);i[Mn.expando]=void 0}i[Ln.expando]&&(i[Ln.expando]=void 0)}}}),Ki.fn.extend({detach(e){return vr(this,e,!0)},remove(e){return vr(this,e)},text(e){return wn(this,(function(e){return void 0===e?Ki.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append(){return yr(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){dr(this,e).appendChild(e)}}))},prepend(){return yr(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){const t=dr(this,e);t.insertBefore(e,t.firstChild)}}))},before(){return yr(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after(){return yr(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty(){let e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(Ki.cleanData(Jn(e,!1)),e.textContent="");return this},clone(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return Ki.clone(this,e,t)}))},html(e){return wn(this,(function(e){let t=this[0]||{},i=0;const n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!cr.test(e)&&!Xn[($n.exec(e)||["",""])[1].toLowerCase()]){e=Ki.htmlPrefilter(e);try{for(;i<n;i++)t=this[i]||{},1===t.nodeType&&(Ki.cleanData(Jn(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith(){const e=[];return yr(this,arguments,(function(t){const i=this.parentNode;Ki.inArray(this,e)<0&&(Ki.cleanData(Jn(this)),i&&i.replaceChild(t,this))}),e)}}),Ki.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},((e,t)=>{Ki.fn[e]=function(e){let i;const n=[],r=Ki(e),o=r.length-1;let s=0;for(;s<=o;s++)i=s===o?this:this.clone(!0),Ki(r[s])[t](i),Bi.apply(n,i.get());return this.pushStack(n)}}));const _r=new RegExp(`^(${kn})(?!px)[a-z%]+$`,"i"),xr=function(e){let t=e.ownerDocument.defaultView;return t&&t.opener||(t=window),t.getComputedStyle(e)},Cr=new RegExp(Nn.join("|"),"i");function wr(e,t,i){let n,r,o,s;const{style:a}=e;return(i=i||xr(e))&&(s=i.getPropertyValue(t)||i[t],""!==s||zn(e)||(s=Ki.style(e,t)),!qi.pixelBoxStyles()&&_r.test(s)&&Cr.test(t)&&(n=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=r,a.maxWidth=o)),void 0!==s?`${s}`:s}function br(e,t){return{get(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(!l)return;a.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Fn.appendChild(a).appendChild(l);const e=window.getComputedStyle(l);i="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),n=36===t(e.width),l.style.position="absolute",r=12===t(l.offsetWidth/3),Fn.removeChild(a),l=null}function t(e){return Math.round(parseFloat(e))}let i,n,r,o,s;var a=Oi.createElement("div"),l=Oi.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",qi.clearCloneStyle="content-box"===l.style.backgroundClip,Ki.extend(qi,{boxSizingReliable:()=>(e(),n),pixelBoxStyles:()=>(e(),o),pixelPosition:()=>(e(),i),reliableMarginLeft:()=>(e(),s),scrollboxSize:()=>(e(),r)}))}();const Sr=["Webkit","Moz","ms"],Tr=Oi.createElement("div").style,Er={};function Pr(e){const t=Ki.cssProps[e]||Er[e];return t||(e in Tr?e:Er[e]=function(e){const t=e[0].toUpperCase()+e.slice(1);let i=Sr.length;for(;i--;)if((e=Sr[i]+t)in Tr)return e}(e)||e)}const Ar=/^(none|table(?!-c[ea]).+)/,Mr=/^--/,Lr={position:"absolute",visibility:"hidden",display:"block"},Dr={letterSpacing:"0",fontWeight:"400"};function Rr(e,t,i){const n=On.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function Ir(e,t,i,n,r,o){let s="width"===t?1:0,a=0,l=0;if(i===(n?"border":"content"))return 0;for(;s<4;s+=2)"margin"===i&&(l+=Ki.css(e,i+Nn[s],!0,r)),n?("content"===i&&(l-=Ki.css(e,`padding${Nn[s]}`,!0,r)),"margin"!==i&&(l-=Ki.css(e,`border${Nn[s]}Width`,!0,r))):(l+=Ki.css(e,`padding${Nn[s]}`,!0,r),"padding"!==i?l+=Ki.css(e,`border${Nn[s]}Width`,!0,r):a+=Ki.css(e,`border${Nn[s]}Width`,!0,r));return!n&&o>=0&&(l+=Math.max(0,Math.ceil(e[`offset${t[0].toUpperCase()}${t.slice(1)}`]-o-l-a-.5))||0),l}function kr(e,t,i){const n=xr(e);let r=(!qi.boxSizingReliable()||i)&&"border-box"===Ki.css(e,"boxSizing",!1,n),o=r,s=wr(e,t,n);const a=`offset${t[0].toUpperCase()}${t.slice(1)}`;if(_r.test(s)){if(!i)return s;s="auto"}return(!qi.boxSizingReliable()&&r||"auto"===s||!parseFloat(s)&&"inline"===Ki.css(e,"display",!1,n))&&e.getClientRects().length&&(r="border-box"===Ki.css(e,"boxSizing",!1,n),o=a in e,o&&(s=e[a])),s=parseFloat(s)||0,`${s+Ir(e,t,i||(r?"border":"content"),o,n,s)}px`}function Or(e,t,i,n,r){return new Or.prototype.init(e,t,i,n,r)}let Nr,Fr;Ki.extend({cssHooks:{opacity:{get(e,t){if(t){const t=wr(e,"opacity");return""===t?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style(e,t,i,n){if(!e||3===e.nodeType||8===e.nodeType||!e.style)return;let r,o,s;const a=En(t),l=Mr.test(t),{style:c}=e;if(l||(t=Pr(a)),s=Ki.cssHooks[t]||Ki.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(r=s.get(e,!1,n))?r:c[t];o=typeof i,"string"===o&&(r=On.exec(i))&&r[1]&&(i=Wn(e,t,r),o="number"),null!=i&&i==i&&("number"!==o||l||(i+=r&&r[3]||(Ki.cssNumber[a]?"":"px")),qi.clearCloneStyle||""!==i||0!==t.indexOf("background")||(c[t]="inherit"),s&&"set"in s&&void 0===(i=s.set(e,i,n))||(l?c.setProperty(t,i):c[t]=i))},css(e,t,i,n){let r,o,s;const a=En(t);return Mr.test(t)||(t=Pr(a)),s=Ki.cssHooks[t]||Ki.cssHooks[a],s&&"get"in s&&(r=s.get(e,!0,i)),void 0===r&&(r=wr(e,t,n)),"normal"===r&&t in Dr&&(r=Dr[t]),""===i||i?(o=parseFloat(r),!0===i||isFinite(o)?o||0:r):r}}),Ki.each(["height","width"],((e,t)=>{Ki.cssHooks[t]={get(e,i,n){if(i)return!Ar.test(Ki.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?kr(e,t,n):Hn(e,Lr,(()=>kr(e,t,n)))},set(e,i,n){let r;const o=xr(e),s=!qi.scrollboxSize()&&"absolute"===o.position,a=(s||n)&&"border-box"===Ki.css(e,"boxSizing",!1,o);let l=n?Ir(e,t,n,a,o):0;return a&&s&&(l-=Math.ceil(e[`offset${t[0].toUpperCase()}${t.slice(1)}`]-parseFloat(o[t])-Ir(e,t,"border",!1,o)-.5)),l&&(r=On.exec(i))&&"px"!==(r[3]||"px")&&(e.style[t]=i,i=Ki.css(e,t)),Rr(0,i,l)}}})),Ki.cssHooks.marginLeft=br(qi.reliableMarginLeft,((e,t)=>{if(t)return`${parseFloat(wr(e,"marginLeft"))||e.getBoundingClientRect().left-Hn(e,{marginLeft:0},(()=>e.getBoundingClientRect().left))}px`})),Ki.each({margin:"",padding:"",border:"Width"},((e,t)=>{Ki.cssHooks[e+t]={expand(i){let n=0;const r={},o="string"==typeof i?i.split(" "):[i];for(;n<4;n++)r[e+Nn[n]+t]=o[n]||o[n-2]||o[0];return r}},"margin"!==e&&(Ki.cssHooks[e+t].set=Rr)})),Ki.fn.extend({css(e,t){return wn(this,((e,t,i)=>{let n,r;const o={};let s=0;if(Array.isArray(t)){for(n=xr(e),r=t.length;s<r;s++)o[t[s]]=Ki.css(e,t[s],!1,n);return o}return void 0!==i?Ki.style(e,t,i):Ki.css(e,t)}),e,t,arguments.length>1)}}),Ki.Tween=Or,Or.prototype={constructor:Or,init(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||Ki.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(Ki.cssNumber[i]?"":"px")},cur(){const e=Or.propHooks[this.prop];return e&&e.get?e.get(this):Or.propHooks._default.get(this)},run(e){let t;const i=Or.propHooks[this.prop];return this.options.duration?this.pos=t=Ki.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Or.propHooks._default.set(this),this}},Or.prototype.init.prototype=Or.prototype,Or.propHooks={_default:{get(e){let t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=Ki.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set(e){Ki.fx.step[e.prop]?Ki.fx.step[e.prop](e):1!==e.elem.nodeType||!Ki.cssHooks[e.prop]&&null==e.elem.style[Pr(e.prop)]?e.elem[e.prop]=e.now:Ki.style(e.elem,e.prop,e.now+e.unit)}}},Or.propHooks.scrollTop=Or.propHooks.scrollLeft={set(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Ki.easing={linear:e=>e,swing:e=>.5-Math.cos(e*Math.PI)/2,_default:"swing"},Ki.fx=Or.prototype.init,Ki.fx.step={};const zr=/^(?:toggle|show|hide)$/,Br=/queueHooks$/;function Gr(){Fr&&(!1===Oi.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(Gr):window.setTimeout(Gr,Ki.fx.interval),Ki.fx.tick())}function Hr(){return window.setTimeout((()=>{Nr=void 0})),Nr=Date.now()}function Wr(e,t){let i,n=0;const r={height:e};for(t=t?1:0;n<4;n+=2-t)i=Nn[n],r[`margin${i}`]=r[`padding${i}`]=e;return t&&(r.opacity=r.width=e),r}function Ur(e,t,i){let n;const r=(jr.tweeners[t]||[]).concat(jr.tweeners["*"]);let o=0;const{length:s}=r;for(;o<s;o++)if(n=r[o].call(i,t,e))return n}function jr(e,t,i){let n,r,o=0;const{length:s}=jr.prefilters,a=Ki.Deferred().always((()=>{delete l.elem}));var l=function(){if(r)return!1;const t=Nr||Hr(),i=Math.max(0,c.startTime+c.duration-t),n=1-(i/c.duration||0);let o=0;const{length:s}=c.tweens;for(;o<s;o++)c.tweens[o].run(n);return a.notifyWith(e,[c,n,i]),n<1&&s?i:(s||a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:Ki.extend({},t),opts:Ki.extend(!0,{specialEasing:{},easing:Ki.easing._default},i),originalProperties:t,originalOptions:i,startTime:Nr||Hr(),duration:i.duration,tweens:[],createTween(t,i){const n=Ki.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop(t){let i=0;const n=t?c.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)c.tweens[i].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}});const{props:u}=c;for(!function(e,t){let i,n,r,o,s;for(i in e)if(n=En(i),r=t[n],o=e[i],Array.isArray(o)&&(r=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),s=Ki.cssHooks[n],s&&"expand"in s)for(i in o=s.expand(o),delete e[n],o)i in e||(e[i]=o[i],t[i]=r);else t[n]=r}(u,c.opts.specialEasing);o<s;o++)if(n=jr.prefilters[o].call(c,e,u,c.opts),n)return $i(n.stop)&&(Ki._queueHooks(c.elem,c.opts.queue).stop=n.stop.bind(n)),n;return Ki.map(u,Ur,c),$i(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),Ki.fx.timer(Ki.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}let Vr;Ki.Animation=Ki.extend(jr,{tweeners:{"*":[function(e,t){const i=this.createTween(e,t);return Wn(i.elem,e,On.exec(t),i),i}]},tweener(e,t){let i;$i(e)?(t=e,e=["*"]):e=e.match(fn);let n=0;const{length:r}=e;for(;n<r;n++)i=e[n],jr.tweeners[i]=jr.tweeners[i]||[],jr.tweeners[i].unshift(t)},prefilters:[function(e,t,i){let n,r,o,s,a,l,c,u;const h="width"in t||"height"in t,d=this,p={},{style:m}=e;let f=e.nodeType&&Gn(e),g=Mn.get(e,"fxshow");for(n in i.queue||(s=Ki._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((()=>{d.always((()=>{s.unqueued--,Ki.queue(e,"fx").length||s.empty.fire()}))}))),t)if(r=t[n],zr.test(r)){if(delete t[n],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!g||void 0===g[n])continue;f=!0}p[n]=g&&g[n]||Ki.style(e,n)}if(l=!Ki.isEmptyObject(t),l||!Ki.isEmptyObject(p))for(n in h&&1===e.nodeType&&(i.overflow=[m.overflow,m.overflowX,m.overflowY],c=g&&g.display,null==c&&(c=Mn.get(e,"display")),u=Ki.css(e,"display"),"none"===u&&(c?u=c:(Vn([e],!0),c=e.style.display||c,u=Ki.css(e,"display"),Vn([e]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===Ki.css(e,"float")&&(l||(d.done((()=>{m.display=c})),null==c&&(u=m.display,c="none"===u?"":u)),m.display="inline-block")),i.overflow&&(m.overflow="hidden",d.always((()=>{m.overflow=i.overflow[0],m.overflowX=i.overflow[1],m.overflowY=i.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(f=g.hidden):g=Mn.access(e,"fxshow",{display:c}),o&&(g.hidden=!f),f&&Vn([e],!0),d.done((()=>{for(n in f||Vn([e]),Mn.remove(e,"fxshow"),p)Ki.style(e,n,p[n])}))),l=Ur(f?g[n]:0,n,d),n in g||(g[n]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter(e,t){t?jr.prefilters.unshift(e):jr.prefilters.push(e)}}),Ki.speed=function(e,t,i){const n=e&&"object"==typeof e?Ki.extend({},e):{complete:i||!i&&t||$i(e)&&e,duration:e,easing:i&&t||t&&!$i(t)&&t};return Ki.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in Ki.fx.speeds?n.duration=Ki.fx.speeds[n.duration]:n.duration=Ki.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){$i(n.old)&&n.old.call(this),n.queue&&Ki.dequeue(this,n.queue)},n},Ki.fn.extend({fadeTo(e,t,i,n){return this.filter(Gn).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate(e,t,i,n){const r=Ki.isEmptyObject(e),o=Ki.speed(t,i,n),s=function(){const t=jr(this,Ki.extend({},e),o);(r||Mn.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop(e,t,i){const n=function(e){const{stop:t}=e;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each((function(){let t=!0,r=null!=e&&`${e}queueHooks`;const{timers:o}=Ki,s=Mn.get(this);if(r)s[r]&&s[r].stop&&n(s[r]);else for(r in s)s[r]&&s[r].stop&&Br.test(r)&&n(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(i),t=!1,o.splice(r,1));!t&&i||Ki.dequeue(this,e)}))},finish(e){return!1!==e&&(e=e||"fx"),this.each((function(){let t;const i=Mn.get(this),n=i[`${e}queue`],r=i[`${e}queueHooks`],{timers:o}=Ki,s=n?n.length:0;for(i.finish=!0,Ki.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish}))}}),Ki.each(["toggle","show","hide"],((e,t)=>{const i=Ki.fn[t];Ki.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(Wr(t,!0),e,n,r)}})),Ki.each({slideDown:Wr("show"),slideUp:Wr("hide"),slideToggle:Wr("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},((e,t)=>{Ki.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}})),Ki.timers=[],Ki.fx.tick=function(){let e,t=0;const{timers:i}=Ki;for(Nr=Date.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||Ki.fx.stop(),Nr=void 0},Ki.fx.timer=function(e){Ki.timers.push(e),Ki.fx.start()},Ki.fx.interval=13,Ki.fx.start=function(){Fr||(Fr=!0,Gr())},Ki.fx.stop=function(){Fr=null},Ki.fx.speeds={slow:600,fast:200,_default:400},Ki.fn.delay=function(e,t){return e=Ki.fx&&Ki.fx.speeds[e]||e,t=t||"fx",this.queue(t,((t,i)=>{const n=window.setTimeout(t,e);i.stop=function(){window.clearTimeout(n)}}))},function(){let e=Oi.createElement("input");const t=Oi.createElement("select").appendChild(Oi.createElement("option"));e.type="checkbox",qi.checkOn=""!==e.value,qi.optSelected=t.selected,e=Oi.createElement("input"),e.value="t",e.type="radio",qi.radioValue="t"===e.value}();const{attrHandle:qr}=Ki.expr;Ki.fn.extend({attr(e,t){return wn(this,Ki.attr,e,t,arguments.length>1)},removeAttr(e){return this.each((function(){Ki.removeAttr(this,e)}))}}),Ki.extend({attr(e,t,i){let n,r;const o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?Ki.prop(e,t,i):(1===o&&Ki.isXMLDoc(e)||(r=Ki.attrHooks[t.toLowerCase()]||(Ki.expr.match.bool.test(t)?Vr:void 0)),void 0!==i?null===i?void Ki.removeAttr(e,t):r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:(e.setAttribute(t,`${i}`),i):r&&"get"in r&&null!==(n=r.get(e,t))?n:(n=Ki.find.attr(e,t),null==n?void 0:n))},attrHooks:{type:{set(e,t){if(!qi.radioValue&&"radio"===t&&an(e,"input")){const i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr(e,t){let i,n=0;const r=t&&t.match(fn);if(r&&1===e.nodeType)for(;i=r[n++];)e.removeAttribute(i)}}),Vr={set:(e,t,i)=>(!1===t?Ki.removeAttr(e,i):e.setAttribute(i,i),i)},Ki.each(Ki.expr.match.bool.source.match(/\w+/g),((e,t)=>{const i=qr[t]||Ki.find.attr;qr[t]=function(e,t,n){let r,o;const s=t.toLowerCase();return n||(o=qr[s],qr[s]=r,r=null!=i(e,t,n)?s:null,qr[s]=o),r}}));const $r=/^(?:input|select|textarea|button)$/i,Yr=/^(?:a|area)$/i;function Xr(e){return(e.match(fn)||[]).join(" ")}function Jr(e){return e.getAttribute&&e.getAttribute("class")||""}function Zr(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(fn)||[]}Ki.fn.extend({prop(e,t){return wn(this,Ki.prop,e,t,arguments.length>1)},removeProp(e){return this.each((function(){delete this[Ki.propFix[e]||e]}))}}),Ki.extend({prop(e,t,i){let n,r;const o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&Ki.isXMLDoc(e)||(t=Ki.propFix[t]||t,r=Ki.propHooks[t]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:e[t]=i:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get(e){const t=Ki.find.attr(e,"tabindex");return t?parseInt(t,10):$r.test(e.nodeName)||Yr.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),qi.optSelected||(Ki.propHooks.selected={get(e){const t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set(e){const t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),Ki.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){Ki.propFix[this.toLowerCase()]=this})),Ki.fn.extend({addClass(e){let t,i,n,r,o,s,a,l=0;if($i(e))return this.each((function(t){Ki(this).addClass(e.call(this,t,Jr(this)))}));if(t=Zr(e),t.length)for(;i=this[l++];)if(r=Jr(i),n=1===i.nodeType&&` ${Xr(r)} `,n){for(s=0;o=t[s++];)n.indexOf(` ${o} `)<0&&(n+=`${o} `);a=Xr(n),r!==a&&i.setAttribute("class",a)}return this},removeClass(e){let t,i,n,r,o,s,a,l=0;if($i(e))return this.each((function(t){Ki(this).removeClass(e.call(this,t,Jr(this)))}));if(!arguments.length)return this.attr("class","");if(t=Zr(e),t.length)for(;i=this[l++];)if(r=Jr(i),n=1===i.nodeType&&` ${Xr(r)} `,n){for(s=0;o=t[s++];)for(;n.indexOf(` ${o} `)>-1;)n=n.replace(` ${o} `," ");a=Xr(n),r!==a&&i.setAttribute("class",a)}return this},toggleClass(e,t){const i=typeof e,n="string"===i||Array.isArray(e);return"boolean"==typeof t&&n?t?this.addClass(e):this.removeClass(e):$i(e)?this.each((function(i){Ki(this).toggleClass(e.call(this,i,Jr(this),t),t)})):this.each((function(){let t,r,o,s;if(n)for(r=0,o=Ki(this),s=Zr(e);t=s[r++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==i||(t=Jr(this),t&&Mn.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Mn.get(this,"__className__")||""))}))},hasClass(e){let t,i,n=0;for(t=` ${e} `;i=this[n++];)if(1===i.nodeType&&` ${Xr(Jr(i))} `.indexOf(t)>-1)return!0;return!1}});const Qr=/\r/g;Ki.fn.extend({val(e){let t,i,n;const r=this[0];return arguments.length?(n=$i(e),this.each((function(i){let r;1===this.nodeType&&(r=n?e.call(this,i,Ki(this).val()):e,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=Ki.map(r,(e=>null==e?"":`${e}`))),t=Ki.valHooks[this.type]||Ki.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))}))):r?(t=Ki.valHooks[r.type]||Ki.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(Qr,""):null==i?"":i)):void 0}}),Ki.extend({valHooks:{option:{get(e){const t=Ki.find.attr(e,"value");return null!=t?t:Xr(Ki.text(e))}},select:{get(e){let t,i,n;const{options:r}=e,o=e.selectedIndex,s="select-one"===e.type,a=s?null:[],l=s?o+1:r.length;for(n=o<0?l:s?o:0;n<l;n++)if(i=r[n],(i.selected||n===o)&&!i.disabled&&(!i.parentNode.disabled||!an(i.parentNode,"optgroup"))){if(t=Ki(i).val(),s)return t;a.push(t)}return a},set(e,t){let i,n;const{options:r}=e,o=Ki.makeArray(t);let s=r.length;for(;s--;)n=r[s],(n.selected=Ki.inArray(Ki.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(e.selectedIndex=-1),o}}}}),Ki.each(["radio","checkbox"],(function(){Ki.valHooks[this]={set(e,t){if(Array.isArray(t))return e.checked=Ki.inArray(Ki(e).val(),t)>-1}},qi.checkOn||(Ki.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),qi.focusin="onfocusin"in window;const Kr=/^(?:focusinfocus|focusoutblur)$/,eo=function(e){e.stopPropagation()};Ki.extend(Ki.event,{trigger(e,t,i,n){let r,o,s,a,l,c,u,h;const d=[i||Oi];let p=Ui.call(e,"type")?e.type:e,m=Ui.call(e,"namespace")?e.namespace.split("."):[];if(o=h=s=i=i||Oi,3!==i.nodeType&&8!==i.nodeType&&!Kr.test(p+Ki.event.triggered)&&(p.indexOf(".")>-1&&(m=p.split("."),p=m.shift(),m.sort()),l=p.indexOf(":")<0&&`on${p}`,(e=e[Ki.expando]?e:new Ki.Event(p,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp(`(^|\\.)${m.join("\\.(?:.*\\.|)")}(\\.|$)`):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:Ki.makeArray(t,[e]),u=Ki.event.special[p]||{},n||!u.trigger||!1!==u.trigger.apply(i,t))){if(!n&&!u.noBubble&&!Yi(i)){for(a=u.delegateType||p,Kr.test(a+p)||(o=o.parentNode);o;o=o.parentNode)d.push(o),s=o;s===(i.ownerDocument||Oi)&&d.push(s.defaultView||s.parentWindow||window)}for(r=0;(o=d[r++])&&!e.isPropagationStopped();)h=o,e.type=r>1?a:u.bindType||p,c=(Mn.get(o,"events")||{})[e.type]&&Mn.get(o,"handle"),c&&c.apply(o,t),c=l&&o[l],c&&c.apply&&Pn(o)&&(e.result=c.apply(o,t),!1===e.result&&e.preventDefault());return e.type=p,n||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(d.pop(),t)||!Pn(i)||l&&$i(i[p])&&!Yi(i)&&(s=i[l],s&&(i[l]=null),Ki.event.triggered=p,e.isPropagationStopped()&&h.addEventListener(p,eo),i[p](),e.isPropagationStopped()&&h.removeEventListener(p,eo),Ki.event.triggered=void 0,s&&(i[l]=s)),e.result}},simulate(e,t,i){const n=Ki.extend(new Ki.Event,i,{type:e,isSimulated:!0});Ki.event.trigger(n,null,t)}}),Ki.fn.extend({trigger(e,t){return this.each((function(){Ki.event.trigger(e,t,this)}))},triggerHandler(e,t){const i=this[0];if(i)return Ki.event.trigger(e,t,i,!0)}}),qi.focusin||Ki.each({focus:"focusin",blur:"focusout"},((e,t)=>{const i=function(e){Ki.event.simulate(t,e.target,Ki.event.fix(e))};Ki.event.special[t]={setup(){const n=this.ownerDocument||this,r=Mn.access(n,t);r||n.addEventListener(e,i,!0),Mn.access(n,t,(r||0)+1)},teardown(){const n=this.ownerDocument||this,r=Mn.access(n,t)-1;r?Mn.access(n,t,r):(n.removeEventListener(e,i,!0),Mn.remove(n,t))}}}));const{location:to}=window;let io=Date.now();const no=/\?/;Ki.parseXML=function(e){let t;if(!e||"string"!=typeof e)return null;try{t=(new window.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||Ki.error(`Invalid XML: ${e}`),t};const ro=/\[\]$/,oo=/\r?\n/g,so=/^(?:submit|button|image|reset|file)$/i,ao=/^(?:input|select|textarea|keygen)/i;function lo(e,t,i,n){let r;if(Array.isArray(t))Ki.each(t,((t,r)=>{i||ro.test(e)?n(e,r):lo(`${e}[${"object"==typeof r&&null!=r?t:""}]`,r,i,n)}));else if(i||"object"!==Zi(t))n(e,t);else for(r in t)lo(`${e}[${r}]`,t[r],i,n)}Ki.param=function(e,t){let i;const n=[],r=function(e,t){const i=$i(t)?t():t;n[n.length]=`${encodeURIComponent(e)}=${encodeURIComponent(null==i?"":i)}`};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!Ki.isPlainObject(e))Ki.each(e,(function(){r(this.name,this.value)}));else for(i in e)lo(i,e[i],t,r);return n.join("&")},Ki.fn.extend({serialize(){return Ki.param(this.serializeArray())},serializeArray(){return this.map((function(){const e=Ki.prop(this,"elements");return e?Ki.makeArray(e):this})).filter((function(){const{type:e}=this;return this.name&&!Ki(this).is(":disabled")&&ao.test(this.nodeName)&&!so.test(e)&&(this.checked||!qn.test(e))})).map((function(e,t){const i=Ki(this).val();return null==i?null:Array.isArray(i)?Ki.map(i,(e=>({name:t.name,value:e.replace(oo,"\r\n")}))):{name:t.name,value:i.replace(oo,"\r\n")}})).get()}});const co=/%20/g,uo=/#.*$/,ho=/([?&])_=[^&]*/,po=/^(.*?):[ \t]*([^\r\n]*)$/gm,mo=/^(?:GET|HEAD)$/,fo=/^\/\//,go={},yo={},vo="*/".concat("*"),_o=Oi.createElement("a");function xo(e){return function(t,i){let n;"string"!=typeof t&&(i=t,t="*");let r=0;const o=t.toLowerCase().match(fn)||[];if($i(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function Co(e,t,i,n){const r={},o=e===yo;function s(a){let l;return r[a]=!0,Ki.each(e[a]||[],((e,a)=>{const c=a(t,i,n);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)})),l}return s(t.dataTypes[0])||!r["*"]&&s("*")}function wo(e,t){let i,n;const r=Ki.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((r[i]?e:n||(n={}))[i]=t[i]);return n&&Ki.extend(!0,e,n),e}_o.href=to.href,Ki.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:to.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(to.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":vo,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":Ki.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:(e,t)=>t?wo(wo(e,Ki.ajaxSettings),t):wo(Ki.ajaxSettings,e),ajaxPrefilter:xo(go),ajaxTransport:xo(yo),ajax(e,t){let i,n,r,o,s,a,l,c,u,h;"object"==typeof e&&(t=e,e=void 0),t=t||{};const d=Ki.ajaxSetup({},t),p=d.context||d,m=d.context&&(p.nodeType||p.jquery)?Ki(p):Ki.event,f=Ki.Deferred(),g=Ki.Callbacks("once memory");let y=d.statusCode||{};const v={},_={};let x="canceled";var C={readyState:0,getResponseHeader(e){let t;if(l){if(!o)for(o={};t=po.exec(r);)o[`${t[1].toLowerCase()} `]=(o[`${t[1].toLowerCase()} `]||[]).concat(t[2]);t=o[`${e.toLowerCase()} `]}return null==t?null:t.join(", ")},getAllResponseHeaders:()=>l?r:null,setRequestHeader(e,t){return null==l&&(e=_[e.toLowerCase()]=_[e.toLowerCase()]||e,v[e]=t),this},overrideMimeType(e){return null==l&&(d.mimeType=e),this},statusCode(e){let t;if(e)if(l)C.always(e[C.status]);else for(t in e)y[t]=[y[t],e[t]];return this},abort(e){const t=e||x;return i&&i.abort(t),w(0,t),this}};if(f.promise(C),d.url=`${e||d.url||to.href}`.replace(fo,`${to.protocol}//`),d.type=t.method||t.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(fn)||[""],null==d.crossDomain){a=Oi.createElement("a");try{a.href=d.url,a.href=a.href,d.crossDomain=`${_o.protocol}//${_o.host}`!=`${a.protocol}//${a.host}`}catch(e){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=Ki.param(d.data,d.traditional)),Co(go,d,t,C),l)return C;for(u in c=Ki.event&&d.global,c&&0==Ki.active++&&Ki.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!mo.test(d.type),n=d.url.replace(uo,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(co,"+")):(h=d.url.slice(n.length),d.data&&(d.processData||"string"==typeof d.data)&&(n+=(no.test(n)?"&":"?")+d.data,delete d.data),!1===d.cache&&(n=n.replace(ho,"$1"),h=`${no.test(n)?"&":"?"}_=${io++}${h}`),d.url=n+h),d.ifModified&&(Ki.lastModified[n]&&C.setRequestHeader("If-Modified-Since",Ki.lastModified[n]),Ki.etag[n]&&C.setRequestHeader("If-None-Match",Ki.etag[n])),(d.data&&d.hasContent&&!1!==d.contentType||t.contentType)&&C.setRequestHeader("Content-Type",d.contentType),C.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?`, ${vo}; q=0.01`:""):d.accepts["*"]),d.headers)C.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(!1===d.beforeSend.call(p,C,d)||l))return C.abort();if(x="abort",g.add(d.complete),C.done(d.success),C.fail(d.error),i=Co(yo,d,t,C),i){if(C.readyState=1,c&&m.trigger("ajaxSend",[C,d]),l)return C;d.async&&d.timeout>0&&(s=window.setTimeout((()=>{C.abort("timeout")}),d.timeout));try{l=!1,i.send(v,w)}catch(e){if(l)throw e;w(-1,e)}}else w(-1,"No Transport");function w(e,t,o,a){let u,h,v,_,x,w=t;l||(l=!0,s&&window.clearTimeout(s),i=void 0,r=a||"",C.readyState=e>0?4:0,u=e>=200&&e<300||304===e,o&&(_=function(e,t,i){let n,r,o,s;const{contents:a}=e,{dataTypes:l}=e;for(;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){l.unshift(r);break}if(l[0]in i)o=l[0];else{for(r in i){if(!l[0]||e.converters[`${r} ${l[0]}`]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),i[o]}(d,C,o)),_=function(e,t,i,n){let r,o,s,a,l;const c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(o=u.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift(),o)if("*"===o)o=l;else if("*"!==l&&l!==o){if(s=c[`${l} ${o}`]||c[`* ${o}`],!s)for(r in c)if(a=r.split(" "),a[1]===o&&(s=c[`${l} ${a[0]}`]||c[`* ${a[0]}`],s)){!0===s?s=c[r]:!0!==c[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:`No conversion from ${l} to ${o}`}}}return{state:"success",data:t}}(d,_,C,u),u?(d.ifModified&&(x=C.getResponseHeader("Last-Modified"),x&&(Ki.lastModified[n]=x),x=C.getResponseHeader("etag"),x&&(Ki.etag[n]=x)),204===e||"HEAD"===d.type?w="nocontent":304===e?w="notmodified":(w=_.state,h=_.data,v=_.error,u=!v)):(v=w,!e&&w||(w="error",e<0&&(e=0))),C.status=e,C.statusText=`${t||w}`,u?f.resolveWith(p,[h,w,C]):f.rejectWith(p,[C,w,v]),C.statusCode(y),y=void 0,c&&m.trigger(u?"ajaxSuccess":"ajaxError",[C,d,u?h:v]),g.fireWith(p,[C,w]),c&&(m.trigger("ajaxComplete",[C,d]),--Ki.active||Ki.event.trigger("ajaxStop")))}return C},getJSON:(e,t,i)=>Ki.get(e,t,i,"json"),getScript:(e,t)=>Ki.get(e,void 0,t,"script")}),Ki.each(["get","post"],((e,t)=>{Ki[t]=function(e,i,n,r){return $i(i)&&(r=r||n,n=i,i=void 0),Ki.ajax(Ki.extend({url:e,type:t,dataType:r,data:i,success:n},Ki.isPlainObject(e)&&e))}})),Ki._evalUrl=function(e,t){return Ki.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter(e){Ki.globalEval(e,t)}})},Ki.fn.extend({wrapAll(e){let t;return this[0]&&($i(e)&&(e=e.call(this[0])),t=Ki(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){let e=this;for(;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner(e){return $i(e)?this.each((function(t){Ki(this).wrapInner(e.call(this,t))})):this.each((function(){const t=Ki(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)}))},wrap(e){const t=$i(e);return this.each((function(i){Ki(this).wrapAll(t?e.call(this,i):e)}))},unwrap(e){return this.parent(e).not("body").each((function(){Ki(this).replaceWith(this.childNodes)})),this}}),Ki.expr.pseudos.hidden=function(e){return!Ki.expr.pseudos.visible(e)},Ki.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},Ki.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};const bo={0:200,1223:204};let So=Ki.ajaxSettings.xhr();qi.cors=!!So&&"withCredentials"in So,qi.ajax=So=!!So,Ki.ajaxTransport((e=>{let t,i;if(qi.cors||So&&!e.crossDomain)return{send(n,r){let o;const s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)s[o]=e.xhrFields[o];for(o in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)s.setRequestHeader(o,n[o]);t=function(e){return function(){t&&(t=i=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?r(0,"error"):r(s.status,s.statusText):r(bo[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),i=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&window.setTimeout((()=>{t&&i()}))},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort(){t&&t()}}})),Ki.ajaxPrefilter((e=>{e.crossDomain&&(e.contents.script=!1)})),Ki.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return Ki.globalEval(e),e}}}),Ki.ajaxPrefilter("script",(e=>{void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),Ki.ajaxTransport("script",(e=>{if(e.crossDomain||e.scriptAttrs){let t,i;return{send(n,r){t=Ki("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&r("error"===e.type?404:200,e.type)}),Oi.head.appendChild(t[0])},abort(){i&&i()}}}}));const To=[],Eo=/(=)\?(?=&|$)|\?\?/;Ki.ajaxSetup({jsonp:"callback",jsonpCallback(){const e=To.pop()||`${Ki.expando}_${io++}`;return this[e]=!0,e}}),Ki.ajaxPrefilter("json jsonp",((e,t,i)=>{let n,r,o;const s=!1!==e.jsonp&&(Eo.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Eo.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=$i(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Eo,`$1${n}`):!1!==e.jsonp&&(e.url+=`${(no.test(e.url)?"&":"?")+e.jsonp}=${n}`),e.converters["script json"]=function(){return o||Ki.error(`${n} was not called`),o[0]},e.dataTypes[0]="json",r=window[n],window[n]=function(){o=arguments},i.always((()=>{void 0===r?Ki(window).removeProp(n):window[n]=r,e[n]&&(e.jsonpCallback=t.jsonpCallback,To.push(n)),o&&$i(r)&&r(o[0]),o=r=void 0})),"script"})),qi.createHTMLDocument=function(){const{body:e}=Oi.implementation.createHTMLDocument("");return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),Ki.parseHTML=function(e,t,i){if("string"!=typeof e)return[];let n,r,o;return"boolean"==typeof t&&(i=t,t=!1),t||(qi.createHTMLDocument?(n=(t=Oi.implementation.createHTMLDocument("")).createElement("base"),n.href=Oi.location.href,t.head.appendChild(n)):t=Oi),r=ln.exec(e),o=!i&&[],r?[t.createElement(r[1])]:(r=Kn([e],t,o),o&&o.length&&Ki(o).remove(),Ki.merge([],r.childNodes))},Ki.fn.load=function(e,t,i){let n,r,o;const s=this,a=e.indexOf(" ");return a>-1&&(n=Xr(e.slice(a)),e=e.slice(0,a)),$i(t)?(i=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&Ki.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done((function(e){o=arguments,s.html(n?Ki("<div>").append(Ki.parseHTML(e)).find(n):e)})).always(i&&((e,t)=>{s.each((function(){i.apply(this,o||[e.responseText,t,e])}))})),this},Ki.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],((e,t)=>{Ki.fn[t]=function(e){return this.on(t,e)}})),Ki.expr.pseudos.animated=function(e){return Ki.grep(Ki.timers,(t=>e===t.elem)).length},Ki.offset={setOffset(e,t,i){let n,r,o,s,a,l,c;const u=Ki.css(e,"position"),h=Ki(e),d={};"static"===u&&(e.style.position="relative"),a=h.offset(),o=Ki.css(e,"top"),l=Ki.css(e,"left"),c=("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1,c?(n=h.position(),s=n.top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),$i(t)&&(t=t.call(e,i,Ki.extend({},a))),null!=t.top&&(d.top=t.top-a.top+s),null!=t.left&&(d.left=t.left-a.left+r),"using"in t?t.using.call(e,d):h.css(d)}},Ki.fn.extend({offset(e){if(arguments.length)return void 0===e?this:this.each((function(t){Ki.offset.setOffset(this,e,t)}));let t,i;const n=this[0];return n?n.getClientRects().length?(t=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position(){if(!this[0])return;let e,t,i;const n=this[0];let r={top:0,left:0};if("fixed"===Ki.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),i=n.ownerDocument,e=n.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===Ki.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&(r=Ki(e).offset(),r.top+=Ki.css(e,"borderTopWidth",!0),r.left+=Ki.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-Ki.css(n,"marginTop",!0),left:t.left-r.left-Ki.css(n,"marginLeft",!0)}},offsetParent(){return this.map((function(){let{offsetParent:e}=this;for(;e&&"static"===Ki.css(e,"position");)e=e.offsetParent;return e||Fn}))}}),Ki.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},((e,t)=>{const i="pageYOffset"===t;Ki.fn[e]=function(n){return wn(this,((e,n,r)=>{let o;if(Yi(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===r)return o?o[t]:e[n];o?o.scrollTo(i?o.pageXOffset:r,i?r:o.pageYOffset):e[n]=r}),e,n,arguments.length)}})),Ki.each(["top","left"],((e,t)=>{Ki.cssHooks[t]=br(qi.pixelPosition,((e,i)=>{if(i)return i=wr(e,t),_r.test(i)?`${Ki(e).position()[t]}px`:i}))})),Ki.each({Height:"height",Width:"width"},((e,t)=>{Ki.each({padding:`inner${e}`,content:t,"":`outer${e}`},((i,n)=>{Ki.fn[n]=function(r,o){const s=arguments.length&&(i||"boolean"!=typeof r),a=i||(!0===r||!0===o?"margin":"border");return wn(this,((t,i,r)=>{let o;return Yi(t)?0===n.indexOf("outer")?t[`inner${e}`]:t.document.documentElement[`client${e}`]:9===t.nodeType?(o=t.documentElement,Math.max(t.body[`scroll${e}`],o[`scroll${e}`],t.body[`offset${e}`],o[`offset${e}`],o[`client${e}`])):void 0===r?Ki.css(t,i,a):Ki.style(t,i,r,a)}),t,s?r:void 0,s)}}))})),Ki.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),((e,t)=>{Ki.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}})),Ki.fn.extend({hover(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Ki.fn.extend({bind(e,t,i){return this.on(e,null,t,i)},unbind(e,t){return this.off(e,null,t)},delegate(e,t,i,n){return this.on(t,e,i,n)},undelegate(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}}),Ki.proxy=function(e,t){let i,n,r;if("string"==typeof t&&(i=e[t],t=e,e=i),$i(e))return n=Fi.call(arguments,2),r=function(){return e.apply(t||this,n.concat(Fi.call(arguments)))},r.guid=e.guid=e.guid||Ki.guid++,r},Ki.holdReady=function(e){e?Ki.readyWait++:Ki.ready(!0)},Ki.isArray=Array.isArray,Ki.parseJSON=JSON.parse,Ki.nodeName=an,Ki.isFunction=$i,Ki.isWindow=Yi,Ki.camelCase=En,Ki.type=Zi,Ki.now=Date.now,Ki.isNumeric=function(e){const t=Ki.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))};class Po{constructor(e={}){const{text:t,id:i,viewer:n}=e;i&&document.getElementById(i)&&!e.reduplicate&&Ki(`#${i}`).remove();const r=document.createElement("div");r.id=De(i,Ge()),r.className="cursor-tip-class",r.innerHTML=t;const o=n?n.container:document.body;o.appendChild(r),this.ele=r,this._show=De(e.show,!0),this._isDestryoed=!1,this._target=o,this._id=r.id,this._text=t,this._position=void 0;const s=this;this.show=this._show,n instanceof Cesium.Viewer&&(this._handler=new Cesium.ScreenSpaceEventHandler(n.canvas),this._handler.setInputAction((e=>{s.updatePosition(e.endPosition)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE))}updatePosition(e){this.ele.style.left=`${e.x+10}px`,this.ele.style.top=`${e.y+10}px`}updateText(e){this.ele.innerHTML=e}destroy(){this._isDestryoed||(this._target.removeChild(this.ele),this._handler.isDestroyed()&&this._handler.destroy(),this._isDestryoed=!0)}get show(){return this._show}set show(e){this._show=e,this.ele.style.display=e?"block":"none"}get id(){return this._id}get text(){return this._text}set text(e){this._text=e,this.updateText(e)}get position(){return this._position}set position(e){e.x&&e.y?(this._position=e,this.updatePosition(e)):console.warn("CursorTip:设置了一个无效的位置，将被忽略.")}}function Ao(e,t){let i;const n={"y+":t.getFullYear().toString(),"m+":(t.getMonth()+1).toString(),"d+":t.getDate().toString(),"H+":t.getHours().toString(),"M+":t.getMinutes().toString(),"S+":t.getSeconds().toString()},r=Object.keys(n);for(const t of r)i=new RegExp(`(${t})`).exec(e),i&&(e=e.replace(i[1],1===i[1].length?n[t]:n[t].padStart(i[1].length,"0")));return e}window.Date.prototype.format=function(e){Ao(e,this)};const{Ellipsoid:Mo}=Cesium;Mo.CGCS2000=Object.freeze(new Mo(6378137,6378137,6356752.314140356));const{GeographicTilingScheme:Lo,GeographicProjection:Do,Rectangle:Ro,Math:Io}=Cesium;class ko extends Lo{constructor(e={}){super(e),this._tileInfo=e.tileInfo,this._ellipsoid=De(e.ellipsoid,Mo.CGCS2000),this._rectangle=De(e.rectangle,Ro.fromDegrees(-180,-90,180,90)),this._numberOfLevelZeroTilesX=De(e.numberOfLevelZeroTilesX,4),this._numberOfLevelZeroTilesY=De(e.numberOfLevelZeroTilesY,2),this._projection=new Do(this._ellipsoid)}getNumberOfXTilesAtLevel(e){if(Re(this._tileInfo)){var t=this._tileInfo.lods.filter((function(t){return t.level===e}))[0].resolution;return Math.round(Io.toDegrees(2*Io.TWO_PI)/(this._tileInfo.rows*t))}return super.getNumberOfXTilesAtLevel(e)}getNumberOfYTilesAtLevel(e){if(Re(this._tileInfo)){var t=this._tileInfo.lods.filter((function(t){return t.level===e}))[0].resolution;return Math.round(Io.toDegrees(2*Io.TWO_PI)/(this._tileInfo.cols*t))}return super.getNumberOfYTilesAtLevel(e)}}class Oo{constructor(e){this._options=De(e,{}),this._id=De(e.id,Ii()),this._primitive=null,this._oldPrimitive=null,this._definedChanged=new Be,this._loadEvent=new Be,this._clampToGround=De(!!e.clampToGround,!1),this._show=De(e.show,!0),this._removed=!1,this._allowPicking=De(e.allowPicking,!0),this._property=e.property}get id(){return this._id}get property(){return this._property}get allowPicking(){return this._allowPicking}set allowPicking(e){!!e!==this._allowPicking&&(this.definedChanged.raise("allowPicking",e,this._allowPicking),this._allowPicking=e,this.updatePrimitive&&this.updatePrimitive())}get clampToGround(){return this._clampToGround}set clampToGround(e){e!==this._clampToGround&&(this.definedChanged.raise("clampToGround",e,this._clampToGround),this._clampToGround=e,this.updatePrimitive())}get show(){return this._show}set show(e){e!==this._show&&(this.definedChanged.raise("show",e,this._show),this._show=e,this.primitive&&(this.primitive.show=e))}get primitive(){return this._primitive}get definedChanged(){return this._definedChanged}get readyPromise(){return this.primitive?this.primitive.readyPromise:new Primise}get material(){if(this.primitive)return this.primitive.appearance.material}toJson(){if(Re(this.primitive))return JSON.parse(JSON.stringify(this._options))}update(){}updateAttribute(e,t){if(this.isDestroyed())return;if(!this.primitive)return;const i=this.primitive.appearance.material;if(!i)return;const n=i.uniforms;n&&(n[e]=t)}addTo(e){Re(this.primitive)&&e.graphicGroup.add(this)}zoomTo(){}remove(){if(Re(this.primitive))return this.group?(this.group.remove(this),this):void 0}isDestroyed(){return!1}destroy(){this.remove(),this.primitive&&!this.primitive.isDestroyed()&&(this.primitive.destroy(),this.primitive=void 0),Cesium.destroyObject(this)}}const{AssociativeArray:No,PrimitiveCollection:Fo}=Cesium;class zo{constructor(e){this.values=new No,this.id=Ii(),this.viewer=e,this.root=new Fo,this.root.name="graphicGroup",e.scene.primitives.add(this.root)}add(e){e instanceof zo&&(this.values.set(e.id,e),this.root.add(e.root)),e instanceof Oo&&(this.values.set(e.id,e),e.primitive&&this.root.add(e.primitive),e._viewer=this.viewer,e.group=this,e._loadEvent.raise())}get(e){return this.values.get(e)}getById(e){return this.get(e)}remove(e){this.values.remove(e.id),e instanceof zo&&(e.clear(),this.root.remove(e.root)),e.primitive&&this.root.remove(e.primitive)}removeById(e){const t=this.values.get(e);this.remove(t)}has(e){return this.values.contains(e)}update(e){const t=this.values._array;for(let i of t)i.update(e)}clear(){const e=[...this.values._array];for(let t of e)t.destroy();this.root.removeAll(),this.values.removeAll()}}const Bo="uniform samplerCube u_cubeMap;\n  varying vec3 v_texCoord;\n  void main()\n  {\n  vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n  gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n  }\n  ",Go="attribute vec3 position;\n  varying vec3 v_texCoord;\n  uniform mat3 u_rotateMatrix;\n  void main()\n  {\n  vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n  gl_Position = czm_projection * vec4(p, 1.0);\n  v_texCoord = position.xyz;\n  }\n  ",{defaultValue:Ho,destroyObject:Wo,Matrix4:Uo,DrawCommand:jo,BoxGeometry:Vo,Cartesian3:qo,defined:$o,GeometryPipeline:Yo,Transforms:Xo,VertexFormat:Jo,BufferUsage:Zo,CubeMap:Qo,loadCubeMap:Ko,RenderState:es,VertexArray:ts,BlendingState:is,SceneMode:ns,ShaderProgram:rs,ShaderSource:os,Matrix3:ss}=Cesium;Cesium;class as extends Oo{constructor(e){if(e.el instanceof HTMLElement==!1)throw new Le("options.el parameter is invalid.");super(e),this._clampToGround=void 0,this._asynchronous=void 0,this._distanceDisplayCondition=e.distanceDisplayCondition,this.createGraphic()}get clampToGround(){}set clampToGround(e){throw new Le("HtmlPointGraphic is not support clampToGround.")}get asynchronous(){}set asynchronous(e){throw new Le("HtmlPointGraphic is not support asynchronous.")}get color(){}set color(e){throw new Le("HtmlPointGraphic is not support color.")}set show(e){this.el&&(this.display=e?"block":"none"),this._show=e}get distanceDisplayCondition(){return this._distanceDisplayCondition}set distanceDisplayCondition(e){this._distanceDisplayCondition=e}get position(){return this._position}set position(e){this._definedChanged.raise("position",e,this._position),this._position=e}createGraphic(){this.el=this._options.el,this.el.id=this._id,this.el.style.position="absolute",this._position=this._options.position,this.updatePrimitive()}updatePrimitive(){this._allowPicking?this.el.style.pointerEvents="auto":this.el.style.pointerEvents="none"}addTo(e){defined(this.primitive)&&e.htmlGraphicGroup.add(this)}remove(){if(this.group)return this.group.remove(this),this}zoomTo(){if(this._viewer)return this._viewer.flyTo(this.position)}updateStyle(e,t){this.el.style[e]=t}addClass(e){this.el.classList.add(e)}}const{Cartesian2:ls,Rectangle:cs,GeographicProjection:us,Ellipsoid:hs}=Cesium,ds=Cesium.Math;function ps(e){e=De(e,De.EMPTY_OBJECT),this._ellipsoid=De(e.ellipsoid,hs.WGS84),this._rectangle=De(e.rectangle,cs.MAX_VALUE),this._projection=new us(this._ellipsoid),this._numberOfLevelZeroTilesX=36,this._numberOfLevelZeroTilesY=18,this._intervalOfZeorLevel=De(e.intervalOfZeorLevel,16)}Object.defineProperties(ps.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),ps.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},ps.prototype.modifyLevel=function(e){return e<3?0:e<6?1:void 0},ps.prototype.getDelatXY=function(e){const t=this._intervalOfZeorLevel;return{dx:t/2**e,dy:t/2**e}},ps.prototype.getLonLatValue=function(e,t,i){const n=this.getDelatXY(e);return{lon:n.dx*t-180,lat:90-n.dy*i}},ps.prototype.getPosition=function(e,t,i){const n=this._rectangle,r=this.getNumberOfXTilesAtLevel(e),o=this.getNumberOfYTilesAtLevel(e),s=n.width/r,a=t*s+n.west;n.west;const l=n.height/o,c=n.north-i*l;return n.north,{lon:+ds.toDegrees(a).toFixed(5),lat:+ds.toDegrees(c).toFixed(5)}},ps.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},ps.prototype.rectangleToNativeRectangle=function(e,t){const i=ds.toDegrees(e.west),n=ds.toDegrees(e.south),r=ds.toDegrees(e.east),o=ds.toDegrees(e.north);return Re(t)?(t.west=i,t.south=n,t.east=r,t.north=o,t):new cs(i,n,r,o)},ps.prototype.tileXYToNativeRectangle=function(e,t,i,n){const r=this.tileXYToRectangle(e,t,i,n);return r.west=ds.toDegrees(r.west),r.south=ds.toDegrees(r.south),r.east=ds.toDegrees(r.east),r.north=ds.toDegrees(r.north),r},ps.prototype.tileXYToRectangle=function(e,t,i,n){var r=this._rectangle,o=this.getNumberOfXTilesAtLevel(i),s=this.getNumberOfYTilesAtLevel(i),a=r.width/o,l=e*a+r.west,c=(e+1)*a+r.west,u=r.height/s,h=r.north-t*u,d=r.north-(t+1)*u;return Re(n)||(n=new cs(l,d,c,h)),n.west=l,n.south=d,n.east=c,n.north=h,n},ps.prototype.positionToTileXY=function(e,t,i){var n=this._rectangle;if(cs.contains(n,e)){var r=this.getNumberOfXTilesAtLevel(t),o=this.getNumberOfYTilesAtLevel(t),s=n.width/r,a=n.height/o,l=e.longitude;n.east<n.west&&(l+=ds.TWO_PI);var c=(l-n.west)/s|0;c>=r&&(c=r-1);var u=(n.north-e.latitude)/a|0;return u>=o&&(u=o-1),Re(i)?(i.x=c,i.y=u,i):new ls(c,u)}};const{CesiumTerrainProvider:ms,TerrainProvider:fs,Resource:gs,CustomDataSource:ys,Cartesian3:vs,Entity:_s,Color:xs,Rectangle:Cs}=Cesium;function ws(e){let t=[];const i=[e.bounds.west,e.bounds.south,e.bounds.east,e.bounds.north];return"EPSG:4326"===e.projection.toUpperCase()&&(t=[i[0],i[1],i[0],i[3],i[2],i[3],i[2],i[1],i[0],i[1]]),new _s({polyline:{positions:vs.fromRadiansArray(t),material:xs.fromRandom({alpha:1}),width:3,clampToGround:!0}})}function bs(e,t){const i=gs.createIfNeeded(t);i.appendForwardSlash();return i.getDerivedResource({url:"layer.json"}).fetchJson().then((t=>{e.projection=t.projection,e.bounds=Cs.fromDegrees(...t.valid_bounds)}))}function Ss(e,t,i=!0){let n;t.scene.globe.ellipsoid;const r=t.camera.getPickRay(e);n=t.scene.globe.pick(r,t.scene);return t.scene.pick(e)&&t.scene.globe.depthTestAgainstTerrain&&(t.scene.pickPositionSupported?n=t.scene.pickPosition(e)||n:console.warn("This browser does not support pickPosition.")),n}const Ts=52.35987755982988,Es=3.141592653589793,Ps=6378245,As=.006693421622965943;function Ms(e,t){let i=function(e,t){let i=300+(e=+e)+2*(t=+t)+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*Es)+20*Math.sin(2*e*Es))/3,i+=2*(20*Math.sin(e*Es)+40*Math.sin(e/3*Es))/3,i+=2*(150*Math.sin(e/12*Es)+300*Math.sin(e/30*Es))/3,i}(e-105,t-35),n=function(e,t){let i=2*(e=+e)-100+3*(t=+t)+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*Es)+20*Math.sin(2*e*Es))/3,i+=2*(20*Math.sin(t*Es)+40*Math.sin(t/3*Es))/3,i+=2*(160*Math.sin(t/12*Es)+320*Math.sin(t*Es/30))/3,i}(e-105,t-35);const r=t/180*Es;let o=Math.sin(r);o=1-As*o*o;const s=Math.sqrt(o);return i=180*i/(Ps/s*Math.cos(r)*Es),n=180*n/(Ps*(1-As)/(o*s)*Es),[i,n]}const Ls={};function Ds(e,t=!1){const i=`_${e}`;return{configurable:t,get(){return this[i]},set(t){const n=this[i];t!==n&&(this[i]=t,this._definitionChanged.raise(e,t,n))}}}Ls.get=function(e="EPSG:3857",t){const i=e.toUpperCase();if("EPSG:3857"===i)return new Cesium.WebMercatorTilingScheme(t);if("EPSG:4326"===i)return new Cesium.GeographicTilingScheme(t);throw new Le("未知的坐标系.")},Ls.BD09ToGCJ02=function(e,t){const i=+e-.0065,n=+t-.006,r=Math.sqrt(i*i+n*n)-2e-5*Math.sin(n*Ts),o=Math.atan2(n,i)-3e-6*Math.cos(i*Ts);return[r*Math.cos(o),r*Math.sin(o)]},Ls.GCJ02ToBD09=function(e,t){t=+t,e=+e;const i=Math.sqrt(e*e+t*t)+2e-5*Math.sin(t*Ts),n=Math.atan2(t,e)+3e-6*Math.cos(e*Ts);return[i*Math.cos(n)+.0065,i*Math.sin(n)+.006]},Ls.WGS84ToGCJ02=function(e,t){if(t=+t,e=+e,Ie.inChina(e,t)){const i=Ms(e,t);return[e+i[0],t+i[1]]}return[e,t]},Ls.GCJ02ToWGS84=function(e,t){if(t=+t,e=+e,Ie.inChina(e,t)){const i=Ms(e,t);return[2*e-(e+i[0]),2*t-(t+i[1])]}return[e,t]};class Rs{constructor(e={}){this._definitionChange=new Be,this._propertyNames=[];for(const t in e)e.hasOwnProperty(t)&&(this[`_${t}`]=e[t],this._propertyNames.push(t),Object.defineProperty(this,t,Ds(t)))}get propertyNames(){return this._propertyNames}addProperty(e,t){if(!Re(e))throw new Le("key is reqiured.");if(this.propertyNames.includes(e))throw new Le(`${e}has be a registered property.`);this[`_${e}`]=t,this._propertyNames.push(e),Object.defineProperty(this,e,Ds(e))}removeProperty(e){if(!Re(e))throw new Le("key is reqiured.");if(this.propertyNames.includes(e)){delete this[e],delete this[`_${e}`];const t=this.propertyNames.indexOf(e);this.propertyNames.slice(t,1),this.definitionChanged.raise(e)}}toString(){const e=this.toJson();return JSON.stringify(e)}toJson(){const e={};for(const t of this.propertyNames)e[t]=this[t];return e}hasProperty(e){if(!Re(e))throw new Le("key is reqiured.");return this.propertyNames.includes(e)}get definitionChanged(){return this._definitionChanged}destroy(){this._definitionChanged=void 0,this._propertyNames=void 0}}function Is(e,t=!0){Fe(e),e.scene.screenSpaceCameraController.enableRotate=t}const{Color:ks}=Cesium;class Os{constructor(){}static pointColor=ks.AQUA;static fillColor=ks.AQUA;static strokeColor=ks.AQUA}const Ns=Object.freeze({LEFT:-1,RIGHT:1,NONE:0,TOP:-10,BOTTOM:10}),Fs="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nvarying float v_polylineAngle;\n\nconst float maskLength = 16.0;\n\nmat2 rotate(float rad) {\n    float c = cos(rad);\n    float s = sin(rad);\n    return mat2(\n        c, s,\n        -s, c\n    );\n}\n\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\n    float slope = (p0.y - p1.y) / (p0.x - p1.x);\n    return slope * (x - p0.x) + p0.y;\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n#ifdef GL_OES_standard_derivatives\n    float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;\n#else\n    float base = 0.975; // 2.5% of the line will be the arrow head\n#endif\n    // 没有箭头\n    base = 1.0;\n\n    vec2 center = vec2(1.0, 0.5);\n    float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\n    float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\n\n    float halfWidth = 0.15;\n    float s = step(0.5 - halfWidth, st.t);\n    s *= 1.0 - step(0.5 + halfWidth, st.t);\n    s *= 1.0 - step(base, st.s);\n\n    float t = step(base, materialInput.st.s);\n    t *= 1.0 - step(ptOnUpperLine, st.t);\n    t *= step(ptOnLowerLine, st.t);\n\n    // Find the distance from the closest separator (region between two colors)\n    float dist;\n    if (st.s < base)\n    {\n        float d1 = abs(st.t - (0.5 - halfWidth));\n        float d2 = abs(st.t - (0.5 + halfWidth));\n        dist = min(d1, d2);\n    }\n    else\n    {\n        float d1 = czm_infinity;\n        if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n        {\n            d1 = abs(st.s - base);\n        }\n        float d2 = abs(st.t - ptOnUpperLine);\n        float d3 = abs(st.t - ptOnLowerLine);\n        dist = min(min(d1, d2), d3);\n    }\n\n    vec4 outsideColor = vec4(0.0);\n    vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\n    vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\n    // dash\n    vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\n    // Get the relative position within the dash from 0 to 1\n    float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));\n    // Figure out the mask index.\n    float maskIndex = floor(dashPosition * maskLength);\n    // Test the bit mask.\n    float maskTest = floor(dashPattern / pow(2.0, maskIndex));\n    vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\n    if (fragColor.a < 0.005) {   // matches 0/255 and 1/255\n        discard;\n    }\n    outColor *= fragColor;\n    outColor = czm_gammaCorrect(outColor);\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n    return material;\n}\n",{Transforms:zs,Cartesian3:Bs}=Cesium;let Gs=class{constructor(e={}){if(!Re(e.modelMatrix)&&Re(e.position)){let t;e.position instanceof Bs?t=e.position:e.position instanceof Ie&&(t=e.position.toCartesian()),t&&(e.modelMatrix=zs.eastNorthUpToFixedFrame(t))}if(Re(e.gltf))this.delegate=new Cesium.Model(e);else{if(!Re(e.url))throw new Le("one of parameters url or gltf must be provided.");this.delegate=Cesium.Model.fromGltf(e)}this._readyPromise=this.delegate._readyPromise,this._ready=this.delegate._ready}get ready(){return this._ready}get readyPromise(){return this._readyPromise}get activeAnimations(){return this.delegate.activeAnimations}set activeAnimations(e){this.delegate.activeAnimations=e}get allowPicking(){return this.delegate.allowPicking}get asynchronous(){return this.delegate.asynchronous}get backFaceCulling(){return this.delegate.backFaceCulling}get basePath(){return this.delegate.basePath}get boundingSphere(){return this.delegate.boundingSphere}get clippingPlanes(){return this.delegate.clippingPlanes}set clippingPlanes(e){this.delegate.clippingPlanes=e}get color(){return this.delegate.color}set color(e){this.delegate.color=e}get colorBlendMode(){return this.delegate.colorBlendMode}set colorBlendMode(e){this.delegate.colorBlendMode=e}get colorBlendAmount(){return this.delegate.colorBlendAmount}set colorBlendAmount(e){this.delegate.colorBlendAmount=e}get credit(){return this.delegate.credit}set credit(e){this.delegate.credit=e}get debugShowBoundingVolume(){return this.delegate.debugShowBoundingVolume}set debugShowBoundingVolume(e){this.delegate.debugShowBoundingVolume=e}get debugWireframe(){return this.delegate.debugWireframe}set debugWireframe(e){this.delegate.debugWireframe=e}get distanceDisplayCondition(){return this.delegate.distanceDisplayCondition}set distanceDisplayCondition(e){this.delegate.distanceDisplayCondition=e}get gltf(){return this.delegate.gltf}get id(){return this.delegate.id}set id(e){this.delegate.id=e}get maximumScale(){return this.delegate.maximumScale}set maximumScale(e){this.delegate.maximumScale=e}get minimumPixelSize(){return this.delegate.minimumPixelSize}set minimumPixelSize(e){this.delegate.minimumPixelSize=e}get modelMatrix(){return this.delegate.modelMatrix}set modelMatrix(e){this.delegate.modelMatrix=e}get scale(){return this.delegate.scale}set scale(e){this.delegate.scale=e}get shadows(){return this.delegate.shadows}set shadows(e){this.delegate.shadows=e}get show(){return this.delegate.show}set show(e){this.delegate.show=e}get showOutline(){return this.delegate.showOutline}get silhouetteColor(){return this.delegate.silhouetteColor}set silhouetteColor(e){this.delegate.silhouetteColor=e}get silhouetteSize(){return this.delegate.silhouetteSize}set silhouetteSize(e){this.delegate.silhouetteSize=e}static silhouetteSupported(e){return Cesium.Model.silhouetteSupported(e.scene)}destroy(){this.delegate.destroy()}isDestroyed(){this.delegate.isDestroyed()}getMaterial(e){return this.delegate.getMaterial(e)}getMesh(e){return this.delegate.getMesh(e)}getNode(e){return this.delegate.getNode(e)}get sceneGraph(){return this.delegate.sceneGraph}get rootNodes(){if(this.delegate._runtime)return this.delegate._runtime.rootNodes;return this.sceneGraph._rootNodes.map((e=>this.nodes[e]))}get nodes(){return this.nodesByName}get materials(){return this.delegate._runtime?this.delegate._runtime.materialsByName:[]}get meshs(){return this.delegate._runtime?this.delegate._runtime.meshesByName:[]}get nodesByName(){return this.delegate._nodesByName||this.delegate_runtime}};const{PrimitiveCollection:Hs,PolylineCollection:Ws,Material:Us,Color:js,defaultValue:Vs,Cartesian3:qs,Cartesian2:$s,Matrix4:Ys,Matrix3:Xs,Quaternion:Js,PointPrimitiveCollection:Zs,ScreenSpaceEventHandler:Qs,ScreenSpaceEventType:Ks,Polyline:ea,Primitive:ta,Math:ia,Plane:na,Model:ra,IntersectionTests:oa,Transforms:sa}=Cesium,aa=new qs,la=new Js,ca=new Xs,ua=new qs;new qs;const ha=new Ys,da=new Ys;function pa(e,t){e instanceof ea?e.material.uniforms.color=t:e instanceof ta&&(e.appearance.material.uniforms.color=t)}function ma(e,t){const i=new qs,n=viewer.camera.getPickRay(e),r=new na(qs.UNIT_X,0);return na.fromPointNormal(t.center,t.activePrimitive.normal,r),na.transform(r,t._modelMatrix,r),oa.rayPlane(n,r,i),Ys.multiplyByPoint(t._inverseModelMatrix,i,i),i}const fa=new $s,ga=new $s;function ya(e,t,i,n){const r=e.activePrimitive.relativeAxis||[e.activePrimitive];if(!Array.isArray(r))return;const o=e._viewer.camera.positionCartographic.height/1047;for(let l of r){const r=l.positions.map((t=>Ys.multiplyByPoint(e._modelMatrix,t,new qs))).map((t=>Ie.toPixel(t,e._viewer.scene))),c=(s=$s.subtract(...r,fa),a=$s.subtract(i,t,ga),$s.normalize(s,s),$s.dot(s,a));n[l.axis.toLowerCase()]=c*o}var s,a;return n}const va="None",_a="T",xa="R",Ca="S";class wa extends Cesium.UrlTemplateImageryProvider{constructor(e){"string"==typeof e&&(e={url:e}),e.getFeatureInfoFormats=De(e.getFeatureInfoFormats,wa.defaultFeatureInfoFormats),super(e)}get url(){return super.url}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get rectangle(){return super.rectangle}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return super.enablePickFeatures}set enablePickFeatures(e){super.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}}function ba(){return new wa({url:di.buildModuleUrl("assets/tiles/{z}/{x}/{y}.png"),maximumLevel:4})}wa.defaultFeatureInfoFormats=Object.freeze([Object.freeze(new Cesium.GetFeatureInfoFormat("json","application/json")),Object.freeze(new Cesium.GetFeatureInfoFormat("xml","text/xml")),Object.freeze(new Cesium.GetFeatureInfoFormat("text","text/html"))]);const{defined:Sa,defaultValue:Ta,ColorMaterialProperty:Ea,ConstantPositionProperty:Pa,ConstantProperty:Aa,DataSource:Ma,PolygonGraphics:La,PolylineGraphics:Da,EntityCluster:Ra,PinBuilder:Ia,createGuid:ka,Cartesian3:Oa,PointGraphics:Na,ArcType:Fa,PolygonHierarchy:za,Color:Ba,EntityCollection:Ga,HeightReference:Ha,Resource:Wa,describe:Ua,Event:ja}=Cesium,Va={small:24,medium:48,large:64},qa={},$a={},Ya={"urn:ogc:def:crs:OGC:1.3:CRS84":ml,"EPSG:4326":ml,"urn:ogc:def:crs:EPSG::4326":ml},Xa=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"],Ja={Feature:el,FeatureCollection:function(e,t,i,n,r){for(var o=t.features,s=0,a=o.length;s<a;s++)el(e,o[s],void 0,n,r)},GeometryCollection:tl,LineString:al,MultiLineString:ll,MultiPoint:rl,MultiPolygon:hl,Point:nl,Polygon:ul,Topology:dl},Za={GeometryCollection:tl,LineString:al,MultiLineString:ll,MultiPoint:rl,MultiPolygon:hl,Point:nl,Polygon:ul,Topology:dl};function Qa(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=t(e[n]);return i}function Ka(e,t,i){var n=e.id;if(Sa(n)&&"Feature"===e.type){for(var r=2,o=n;Sa(t.getById(o));)o=n+"_"+r,r++;n=o}else n=ka();var s=t.getOrCreateEntity(n),a=e.properties;if(Sa(a)){var l;s.properties=a;var c=a.title;if(Sa(c))s.name=c,l="title";else{var u=Number.MAX_VALUE;for(var h in a)if(a.hasOwnProperty(h)&&a[h]){var d=h.toLowerCase();if(u>1&&"title"===d){u=1,l=h;break}u>2&&"name"===d?(u=2,l=h):u>3&&/title/i.test(h)?(u=3,l=h):u>4&&/name/i.test(h)&&(u=4,l=h)}Sa(l)&&(s.name=a[l])}var p=a.description;null!==p&&(s.description=Sa(p)?new Aa(p):i(a,l))}return s}function el(e,t,i,n,r){if(null!==t.geometry){if(!Sa(t.geometry))throw new Le("feature.geometry is required.");var o=t.geometry.type,s=Za[o];if(!Sa(s))throw new Le("Unknown geometry type: "+o);s(e,t,t.geometry,n,r)}else Ka(t,e._entityCollection,r.describe)}function tl(e,t,i,n,r){for(var o=i.geometries,s=0,a=o.length;s<a;s++){var l=o[s],c=l.type,u=Za[c];if(!Sa(u))throw new Le("Unknown geometry type: "+c);u(e,t,l,n,r)}}function il(e,t,i,n,r){let o=r.pointSize,s=r.pointColor;const a=t.properties;if(Sa(a)){const e=a["point-color"];Sa(e)&&(s=Ba.fromCssColorString(e)),o=Ta(Va[a["point-size"]],o)}const l=new Na;2===n.length&&r.clampToGround&&(l.heightReference=Ha.CLAMP_TO_GROUND);const c=Ka(t,e._entityCollection,r.describe);c.point=l,c.point.color=s,c.point.pixelSize=o,c.position=new Pa(i(n))}function nl(e,t,i,n,r){il(e,t,n,i.coordinates,r)}function rl(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)il(e,t,n,o[s],r)}function ol(e,t,i,n,r){const o=r.lineColor,s=r.lineWidth,a=t.properties;if(Sa(a)){const e=a["stroke-width"];let t;Sa(e)&&(s=new Aa(e));let i=a.stroke;Sa(i)&&(t=Ba.fromCssColorString(i));let n=a["stroke-opacity"];Sa(n)&&1!==n&&(Sa(t)||(t=o.color.clone()),t.alpha=n),Sa(t)&&(o=new Ea(t))}const l=Ka(t,e._entityCollection,r.describe),c=new Da;l.polyline=c,c.clampToGround=r.clampToGround,c.material=o,c.width=s,c.positions=new Aa(Qa(n,i)),c.arcType=Fa.RHUMB}function sl(e,t){var i="";for(var n in e)if(e.hasOwnProperty(n)){if(n===t||-1!==Xa.indexOf(n))continue;var r=e[n];Sa(r)&&(i+="object"==typeof r?"<tr><th>"+n+"</th><td>"+sl(r)+"</td></tr>":"<tr><th>"+n+"</th><td>"+r+"</td></tr>")}return i.length>0&&(i='<table class="cesium-infoBox-defaultTable"><tbody>'+i+"</tbody></table>"),i}function al(e,t,i,n,r){ol(e,t,n,i.coordinates,r)}function ll(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)ol(e,t,n,o[s],r)}function cl(e,t,i,n,r){if(r.outline){const o=Cesium.clone(r);return o.width=r.outlineWidth,o.lineColor=r.outlineColor,ol(e,t,i,n[0],o)}if(!1===r.fill.getValue().color)return;if(0===n.length||0===n[0].length)return;let o=r.outlineColor.color,s=r.fill,a=r.outlineWidth;const l=t.properties;if(Sa(l)){const e=l["stroke-width"];let t;Sa(e)&&(a=new Aa(e));const i=l.stroke;Sa(i)&&(t=Ba.fromCssColorString(i));let n,c=l["stroke-opacity"];Sa(c)&&1!==c&&(Sa(t)||(t=r.outlineColor.color.clone()),t.alpha=c),Sa(t)&&(o=new Aa(t));const u=l.fill;Sa(u)&&(n=Ba.fromCssColorString(u),n.alpha=s.color.alpha),c=l["fill-opacity"],Sa(c)&&c!==s.color.alpha&&(Sa(n)||(n=s.color.clone()),n.alpha=c),Sa(n)&&(s=new Ea(n))}const c=new La;c.outline=!1,c.outlineColor=o,c.outlineWidth=a,c.material=s,c.arcType=Fa.RHUMB;const u=r.extrudedHeight;if(u)if("number"==typeof u)c.extrudedHeight=u;else if("string"==typeof u){const e=u.match(/\$\{\s*.*?\s*\}/gi);if(e){let t=u;for(let i of e){const e=/\$\{\s*(.*?)\s*\}/gi.exec(i);Sa(e)&&Sa(e[1])&&(t=t.replace(i,l[e[1]]))}try{const e=window.eval(t);"number"==typeof e&&(c.extrudedHeight=e)}catch(e){}}}const h=[];for(var d=1,p=n.length;d<p;d++)h.push(new za(Qa(n[d],i)));const m=n[0];c.hierarchy=new Aa(new za(Qa(m,i),h)),m[0].length>2?c.perPositionHeight=new Aa(!0):r.clampToGround||(c.height=0);Ka(t,e._entityCollection,r.describe).polygon=c}function ul(e,t,i,n,r){cl(e,t,n,i.coordinates,r)}function hl(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)cl(e,t,n,o[s],r)}function dl(e,t,i,n,r){for(var o in i.objects)if(i.objects.hasOwnProperty(o)){var s=topojson.feature(i,i.objects[o]);(0,Ja[s.type])(e,s,s,n,r)}}function pl(e,t){return new Cesium.CallbackProperty(function(e,t,i){var n;return function(r,o){return Sa(n)||(n=e(t,i)),n}}(sl,e,t),!0)}function ml(e){return Oa.fromDegrees(e[0],e[1],e[2])}class fl{constructor(e){this._name=e,this._changed=new ja,this._error=new ja,this._isLoading=!1,this._loading=new ja,this._entityCollection=new Ga(this),this._promises=[],this._pinBuilder=new Ia,this._entityCluster=new Ra,this._credit=void 0,this._resourceCredits=[]}static pointSize=5;static pointColor=Ba.ROYALBLUE;static lineColor=Ba.YELLOW;static fill=Ba.fromBytes(255,255,0,100);static outline=!0;static outlineColor=Ba.YELLOW;static lineWidth=2;static clampToGround=!1;static outlineWidth=1;static crsNames(){return Ya}static crsLinkHrefs(){return qa}static crsLinkTypes(){return $a}get entities(){return this._entityCollection}get name(){return this._name}set name(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}get clock(){}get isLoading(){return this._isLoading}get changedEvent(){return this._changed}get errorEvent(){return this._error}get loadingEvent(){return this._loading}get show(){return this._entityCollection.show}set show(e){this._entityCollection.show=e}get clustering(){return this._entityCluster}set clustering(e){this._entityCluster=e}get credit(){return this._credit}load(e,t){Ma.setLoading(this,!0);let i=(t=Ta(t,{})).credit;"string"==typeof i&&(i=new Credit(i)),this._credit=i;let n=e,r=t.sourceUri;if("string"==typeof e||e instanceof Wa){n=(e=Wa.createIfNeeded(e)).fetchJson(),r=Ta(r,e.getUrlComponent());const t=this._resourceCredits,i=e.credits;if(Sa(i)){const e=i.length;for(const n=0;n<e;n++)t.push(i[n])}}t={describe:Ta(t.describe,pl),pointSize:Ta(t.pointSize,fl.pointSize),pointColor:Ta(t.pointColor,fl.pointColor),lineWidth:new Aa(Ta(t.lineWidth,fl.lineWidth)),outlineColor:new Ea(Ta(t.outlineColor,fl.outlineColor)),lineColor:new Ea(Ta(t.lineColor,fl.lineColor)),outlineWidth:Ta(t.outlineWidth,fl.outlineWidth),fill:new Ea(Ta(t.fill,fl.fill)),outline:Ta(t.outline,fl.outline),clampToGround:Ta(t.clampToGround,fl.clampToGround),extrudedHeight:t.extrudedHeight};const o=this;return Promise.resolve(n).then((function(e){return function(e,t,i,n){let r;Sa(n)&&(r=Cesium.getFilenameFromUri(n)),Sa(r)&&e._name!==r&&(e._name=r,e._changed.raiseEvent(e));const o=Ja[t.type];if(!Sa(o))throw new Le("Unsupported GeoJSON object type: "+t.type);const s=t.crs;let a=null!==s?ml:null;if(Sa(s)){if(!Sa(s.properties))throw new Le("crs.properties is undefined.");const e=s.properties;if("name"===s.type){if(a=Ya[e.name],!Sa(a))throw new Le("Unknown crs name: "+e.name)}else if("link"===s.type){var l=qa[e.href];if(Sa(l)||(l=$a[e.type]),!Sa(l))throw new Le("Unable to resolve crs link: "+JSON.stringify(e));a=l(e)}else{if("EPSG"!==s.type)throw new Le("Unknown crs type: "+s.type);if(a=Ya["EPSG:"+e.code],!Sa(a))throw new Le("Unknown crs EPSG code: "+e.code)}}return Promise.resolve(a).then((function(n){return e._entityCollection.removeAll(),null!==n&&o(e,t,t,n,i),Promise.all(e._promises).then((function(){return e._promises.length=0,Ma.setLoading(e,!1),e}))}))}(o,e,t,r)})).catch((function(e){throw Ma.setLoading(o,!1),o._error.raiseEvent(o,e),e}))}update(){return!0}}function gl(e){return new yl(e instanceof Uint8Array?e:new Uint8Array(e))}function yl(e){this._array=e}function vl(e){return fetch(e).then((function(e){return e.body&&e.body.getReader?e.body.getReader():e.arrayBuffer().then(gl)}))}function _l(e){return new Promise((function(t,i){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onload=function(){t(gl(n.response))},n.onerror=i,n.ontimeout=i,n.open("GET",e,!0),n.send()}))}function xl(e){return("function"==typeof fetch?vl:_l)(e)}function Cl(e){return"function"==typeof e.read?e:e.getReader()}fl.load=function(e,t){return(new fl).load(e,t)},yl.prototype.read=function(){var e=this._array;return this._array=null,Promise.resolve(e?{done:!1,value:e}:{done:!0,value:void 0})},yl.prototype.cancel=function(){return this._array=null,Promise.resolve()};var wl=new Uint8Array(0);function bl(e,t){if(!e.length)return t;if(!t.length)return e;var i=new Uint8Array(e.length+t.length);return i.set(e),i.set(t,e.length),i}function Sl(e){return"function"==typeof e.slice?e:new Tl("function"==typeof e.read?e:e.getReader())}function Tl(e){this._source=e,this._array=wl,this._index=0}function El(e){return!(e=e.trim())||isNaN(e=+e)?null:e}Tl.prototype.read=function(){var e=this,t=e._array.subarray(e._index);return e._source.read().then((function(i){return e._array=wl,e._index=0,i.done?t.length>0?{done:!1,value:t}:{done:!0,value:void 0}:{done:!1,value:bl(t,i.value)}}))},Tl.prototype.slice=function(e){if((e|=0)<0)throw new Error("invalid length");var t=this,i=this._array.length-this._index;if(this._index+e<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=e));var n=new Uint8Array(e);return n.set(this._array.subarray(this._index)),function r(){return t._source.read().then((function(o){return o.done?(t._array=wl,t._index=0,i>0?n.subarray(0,i):null):i+o.value.length>=e?(t._array=o.value,t._index=e-i,n.set(o.value.subarray(0,e-i),i),n):(n.set(o.value,i),i+=o.value.length,r())}))}()},Tl.prototype.cancel=function(){return this._source.cancel()};var Pl={B:El,C:function(e){return e.trim()||null},D:function(e){return new Date(+e.substring(0,4),e.substring(4,6)-1,+e.substring(6,8))},F:El,L:function(e){return!/^[nf]$/i.test(e)&&(!!/^[yt]$/i.test(e)||null)},M:El,N:El};function Al(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ml(e,t){return(e=Sl(e)).slice(32).then((function(i){var n=Al(i);return e.slice(n.getUint16(8,!0)-32).then((function(i){return new Ll(e,t,n,Al(i))}))}))}function Ll(e,t,i,n){this._source=e,this._decode=t.decode.bind(t),this._recordLength=i.getUint16(10,!0),this._fields=[];for(var r=0;13!==n.getUint8(r);r+=32){for(var o=0;o<11&&0!==n.getUint8(r+o);++o);this._fields.push({name:this._decode(new Uint8Array(n.buffer,n.byteOffset+r,o)),type:String.fromCharCode(n.getUint8(r+11)),length:n.getUint8(r+16)})}}var Dl=Ll.prototype;function Rl(e){var t,i=40,n=e.getInt32(36,!0),r=new Array(n);for(t=0;t<n;++t,i+=16)r[t]=[e.getFloat64(i,!0),e.getFloat64(i+8,!0)];return{type:"MultiPoint",coordinates:r}}function Il(e){return{type:"Point",coordinates:[e.getFloat64(4,!0),e.getFloat64(12,!0)]}}function kl(e){var t,i=44,n=e.getInt32(36,!0),r=e.getInt32(40,!0),o=new Array(n),s=new Array(r),a=[],l=[];for(t=0;t<n;++t,i+=4)o[t]=e.getInt32(i,!0);for(t=0;t<r;++t,i+=16)s[t]=[e.getFloat64(i,!0),e.getFloat64(i+8,!0)];return o.forEach((function(e,t){var i=s.slice(e,o[t+1]);!function(e){if((t=e.length)<4)return!1;var t,i=0,n=e[t-1][1]*e[0][0]-e[t-1][0]*e[0][1];for(;++i<t;)n+=e[i-1][1]*e[i][0]-e[i-1][0]*e[i][1];return n>=0}(i)?l.push(i):a.push([i])})),l.forEach((function(e){a.some((function(t){if(function(e,t){var i,n=-1,r=t.length;for(;++n<r;)if(i=Ol(e,t[n]))return i>0;return!1}(t[0],e))return t.push(e),!0}))||a.push([e])})),1===a.length?{type:"Polygon",coordinates:a[0]}:{type:"MultiPolygon",coordinates:a}}function Ol(e,t){for(var i=t[0],n=t[1],r=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var l=e[o],c=l[0],u=l[1],h=e[a],d=h[0],p=h[1];if(Nl(l,h,t))return 0;u>n!=p>n&&i<(d-c)*(n-u)/(p-u)+c&&(r=-r)}return r}function Nl(e,t,i){var n=i[0]-e[0],r=i[1]-e[1];if(0===n&&0===r)return!0;var o=t[0]-e[0],s=t[1]-e[1];if(0===o&&0===s)return!1;var a=(n*o+r*s)/(o*o+s*s);return!(a<0||a>1)&&(0===a||1===a||a*o===n&&a*s===r)}function Fl(e){var t,i=44,n=e.getInt32(36,!0),r=e.getInt32(40,!0),o=new Array(n),s=new Array(r);for(t=0;t<n;++t,i+=4)o[t]=e.getInt32(i,!0);for(t=0;t<r;++t,i+=16)s[t]=[e.getFloat64(i,!0),e.getFloat64(i+8,!0)];return 1===n?{type:"LineString",coordinates:s}:{type:"MultiLineString",coordinates:o.map((function(e,t){return s.slice(e,o[t+1])}))}}function zl(e,t){var i=new Uint8Array(e.length+t.length);return i.set(e,0),i.set(t,e.length),i}Dl.read=function(){var e=this,t=1;return e._source.slice(e._recordLength).then((function(i){return i&&26!==i[0]?{done:!1,value:e._fields.reduce((function(n,r){return n[r.name]=Pl[r.type](e._decode(i.subarray(t,t+=r.length))),n}),{})}:{done:!0,value:void 0}}))},Dl.cancel=function(){return this._source.cancel()};var Bl={0:function(){return null},1:Il,3:Fl,5:kl,8:Rl,11:Il,13:Fl,15:kl,18:Rl,21:Il,23:Fl,25:kl,28:Rl};function Gl(e,t){var i=t.getInt32(32,!0);if(!(i in Bl))throw new Error("unsupported shape type: "+i);this._source=e,this._type=i,this._index=0,this._parse=Bl[i],this.bbox=[t.getFloat64(36,!0),t.getFloat64(44,!0),t.getFloat64(52,!0),t.getFloat64(60,!0)]}var Hl=Gl.prototype;function Wl(){}function Ul(e,t,i){return Promise.all([(n=e,(n=Sl(n)).slice(100).then((function(e){return new Gl(n,Al(e))}))),t&&Ml(t,i)]).then((function(e){return new jl(e[0],e[1])}));var n}function jl(e,t){this._shp=e,this._dbf=t,this.bbox=e.bbox}Hl.read=function(){var e=this;return++e._index,e._source.slice(12).then((function(t){if(null==t)return{done:!0,value:void 0};var i=Al(t);function n(){return e._source.slice(4).then((function(o){return null==o?{done:!0,value:void 0}:(i=Al(t=zl(t.slice(4),o))).getInt32(0,!1)!==e._index?n():r()}))}function r(){var r=2*i.getInt32(4,!1)-4,o=i.getInt32(8,!0);return r<0||o&&o!==e._type?n():e._source.slice(r).then((function(i){return{done:!1,value:o?e._parse(Al(zl(t.slice(8),i))):null}}))}return r()}))},Hl.cancel=function(){return this._source.cancel()};var Vl=jl.prototype;function ql(e,t,i){return"string"==typeof t?(/\.dbf$/.test(t)||(t+=".dbf"),t=xl(t)):t instanceof ArrayBuffer||t instanceof Uint8Array?t=gl(t):null!=t&&(t=Cl(t)),"string"==typeof e?(/\.shp$/.test(e)||(e+=".shp"),void 0===t&&(t=xl(e.substring(0,e.length-4)+".dbf").catch((function(){}))),e=xl(e)):e=e instanceof ArrayBuffer||e instanceof Uint8Array?gl(e):Cl(e),Promise.all([e,t]).then((function(e){var t=e[0],n=e[1],r="windows-1252";return i&&null!=i.encoding&&(r=i.encoding),Ul(t,n,n&&new TextDecoder(r))}))}Vl.read=function(){var e=this;return Promise.all([e._dbf?e._dbf.read():{value:{}},e._shp.read()]).then((function(e){var t=e[0],i=e[1];return i.done?i:{done:!1,value:{type:"Feature",properties:t.value,geometry:i.value}}}))},Vl.cancel=function(){return Promise.all([this._dbf&&this._dbf.cancel(),this._shp.cancel()]).then(Wl)};const{defined:$l,defaultValue:Yl,ColorMaterialProperty:Xl,ConstantPositionProperty:Jl,ConstantProperty:Zl,DataSource:Ql,PolygonGraphics:Kl,PolylineGraphics:ec,createGuid:tc,Cartesian3:ic,PointGraphics:nc,ArcType:rc,PolygonHierarchy:oc,Color:sc,HeightReference:ac,Resource:lc}=Cesium,cc={small:24,medium:48,large:64},uc={},hc={},dc={"urn:ogc:def:crs:OGC:1.3:CRS84":Rc,"EPSG:4326":Rc,"urn:ogc:def:crs:EPSG::4326":Rc},pc={Feature:yc,FeatureCollection:function(e,t,i,n,r){for(var o=t.features,s=0,a=o.length;s<a;s++)yc(e,o[s],void 0,n,r)},GeometryCollection:vc,LineString:bc,MultiLineString:Sc,MultiPoint:Cc,MultiPolygon:Pc,Point:xc,Polygon:Ec,Topology:Ac},mc={GeometryCollection:vc,LineString:bc,MultiLineString:Sc,MultiPoint:Cc,MultiPolygon:Pc,Point:xc,Polygon:Ec,Topology:Ac};function fc(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=t(e[n]);return i}function gc(e,t,i){var n=e.id;if($l(n)&&"Feature"===e.type){for(var r=2,o=n;$l(t.getById(o));)o=n+"_"+r,r++;n=o}else n=tc();var s=t.getOrCreateEntity(n),a=e.properties;if($l(a)){var l;s.properties=a;var c=a.title;if($l(c))s.name=c,l="title";else{var u=Number.MAX_VALUE;for(var h in a)if(a.hasOwnProperty(h)&&a[h]){var d=h.toLowerCase();if(u>1&&"title"===d){u=1,l=h;break}u>2&&"name"===d?(u=2,l=h):u>3&&/title/i.test(h)?(u=3,l=h):u>4&&/name/i.test(h)&&(u=4,l=h)}$l(l)&&(s.name=a[l])}var p=a.description;null!==p&&(s.description=$l(p)?new Zl(p):i(a,l))}return s}function yc(e,t,i,n,r){if(null!==t.geometry){if(!$l(t.geometry))throw new Le("feature.geometry is required.");var o=t.geometry.type,s=mc[o];if(!$l(s))throw new Le("Unknown geometry type: "+o);s(e,t,t.geometry,n,r)}else gc(t,e._entityCollection,r.describe)}function vc(e,t,i,n,r){for(var o=i.geometries,s=0,a=o.length;s<a;s++){var l=o[s],c=l.type,u=mc[c];if(!$l(u))throw new Le("Unknown geometry type: "+c);u(e,t,l,n,r)}}function _c(e,t,i,n,r){let o=r.pointSize,s=r.pointColor;const a=t.properties;if($l(a)){const e=a["point-color"];$l(e)&&(s=sc.fromCssColorString(e)),o=Yl(cc[a["point-size"]],o)}const l=new nc;2===n.length&&r.clampToGround&&(l.heightReference=ac.CLAMP_TO_GROUND);const c=gc(t,e._entityCollection,r.describe);c.point=l,c.point.color=s,c.point.pixelSize=o,c.position=new Jl(i(n))}function xc(e,t,i,n,r){_c(e,t,n,i.coordinates,r)}function Cc(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)_c(e,t,n,o[s],r)}function wc(e,t,i,n,r){const o=r.lineColor,s=r.lineWidth,a=t.properties;if($l(a)){const e=a["stroke-width"];let t;$l(e)&&(s=new Zl(e));let i=a.stroke;$l(i)&&(t=sc.fromCssColorString(i));let n=a["stroke-opacity"];$l(n)&&1!==n&&($l(t)||(t=o.color.clone()),t.alpha=n),$l(t)&&(o=new Xl(t))}const l=gc(t,e._entityCollection,r.describe),c=new ec;l.polyline=c,c.clampToGround=r.clampToGround,c.material=o,c.width=s,c.positions=new Zl(fc(n,i)),c.arcType=rc.RHUMB}function bc(e,t,i,n,r){wc(e,t,n,i.coordinates,r)}function Sc(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)wc(e,t,n,o[s],r)}function Tc(e,t,i,n,r){if(r.outline){const o=Cesium.clone(r);o.width=r.outlineWidth,o.lineColor=r.outlineColor;for(let r of n)wc(e,t,i,r,o)}if(!1===r.fill.getValue().color)return;if(0===n.length||0===n[0].length)return;let o=r.outlineColor.color,s=r.fill,a=r.outlineWidth;const l=t.properties;if($l(l)){const e=l["stroke-width"];let t;$l(e)&&(a=new Zl(e));const i=l.stroke;$l(i)&&(t=sc.fromCssColorString(i));let n,c=l["stroke-opacity"];$l(c)&&1!==c&&($l(t)||(t=r.outlineColor.color.clone()),t.alpha=c),$l(t)&&(o=new Zl(t));const u=l.fill;$l(u)&&(n=sc.fromCssColorString(u),n.alpha=s.color.alpha),c=l["fill-opacity"],$l(c)&&c!==s.color.alpha&&($l(n)||(n=s.color.clone()),n.alpha=c),$l(n)&&(s=new Xl(n))}const c=new Kl;c.outline=!1,c.outlineColor=o,c.outlineWidth=a,c.material=s,c.arcType=rc.RHUMB;const u=r.extrudedHeight;if(u)if("number"==typeof u)c.extrudedHeight=u;else if("string"==typeof u){const e=u.match(/\$\{\s*.*?\s*\}/gi);if(e){let t=u;for(let i of e){const e=/\$\{\s*(.*?)\s*\}/gi.exec(i);$l(e)&&$l(e[1])&&(t=t.replace(i,l[e[1]]))}try{const e=window.eval(t);"number"==typeof e&&(c.extrudedHeight=e)}catch(e){}}}const h=[];for(var d=1,p=n.length;d<p;d++)h.push(new oc(fc(n[d],i)));const m=n[0];c.hierarchy=new Zl(new oc(fc(m,i),h)),m[0].length>2?c.perPositionHeight=new Zl(!0):r.clampToGround||(c.height=0);gc(t,e._entityCollection,r.describe).polygon=c}function Ec(e,t,i,n,r){Tc(e,t,n,i.coordinates,r)}function Pc(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)Tc(e,t,n,o[s],r)}function Ac(e,t,i,n,r){for(var o in i.objects)if(i.objects.hasOwnProperty(o)){var s=topojson.feature(i,i.objects[o]);(0,pc[s.type])(e,s,s,n,r)}}function Mc(e,t){var i="";for(var n in e)if(e.hasOwnProperty(n)){if(n===t||-1!==Lc.indexOf(n))continue;var r=e[n];$l(r)&&(i+="object"==typeof r?"<tr><th>"+n+"</th><td>"+Mc(r)+"</td></tr>":"<tr><th>"+n+"</th><td>"+r+"</td></tr>")}return i.length>0&&(i='<table class="cesium-infoBox-defaultTable"><tbody>'+i+"</tbody></table>"),i}const Lc=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function Dc(e,t){return new Cesium.CallbackProperty(function(e,t,i){var n;return function(r,o){return $l(n)||(n=e(t,i)),n}}(Mc,e,t),!0)}function Rc(e){return ic.fromDegrees(e[0],e[1],e[2])}function Ic(e,t,i,n){let r;$l(n)&&(r=Cesium.getFilenameFromUri(n)),$l(r)&&e._name!==r&&(e._name=r,e._changed.raiseEvent(e));const o=pc[t.type];if(!$l(o))throw new Le("Unsupported GeoJSON object type: "+t.type);const s=t.crs;let a=null!==s?Rc:null;if($l(s)){if(!$l(s.properties))throw new Le("crs.properties is undefined.");const e=s.properties;if("name"===s.type){if(a=dc[e.name],!$l(a))throw new Le("Unknown crs name: "+e.name)}else if("link"===s.type){var l=uc[e.href];if($l(l)||(l=hc[e.type]),!$l(l))throw new Le("Unable to resolve crs link: "+JSON.stringify(e));a=l(e)}else{if("EPSG"!==s.type)throw new Le("Unknown crs type: "+s.type);if(a=dc["EPSG:"+e.code],!$l(a))throw new Le("Unknown crs EPSG code: "+e.code)}}return Promise.resolve(a).then((function(n){return e._entityCollection.removeAll(),null!==n&&o(e,t,t,n,i),Promise.all(e._promises).then((function(){return e._promises.length=0,Ql.setLoading(e,!1),e}))}))}class kc extends fl{constructor(e){super(e),this._geoJson=void 0}get geoJson(){return this._geoJson}set geoJson(e){this._geoJson?this._geoJson.features.push(e):this._geoJson={type:"FeatureCollection",features:[e]}}static pointSize=5;static pointColor=sc.ROYALBLUE;static lineColor=sc.YELLOW;static fill=sc.fromBytes(255,255,0,100);static outline=!0;static outlineColor=sc.YELLOW;static lineWidth=2;static clampToGround=!1;static outlineWidth=1;static crsNames(){return dc}static crsLinkHrefs(){return uc}static crsLinkTypes(){return hc}load(e,t,i={encoding:"utf-8"}){let n=e;if(!$l(n))throw new Le("shpfile is required.");Cesium.DataSource.setLoading(this,!0);const r=i.credit;"string"==typeof r&&(r=new Cesium.Credit(r)),this._credit=r;const o=this;let s=n,a=i.sourceUri;if("string"==typeof n||n instanceof lc){s=new Promise(((e,r)=>{ql(n,t,{encoding:i.encoding}).then((t=>t.read().then((function i(n){if(!n.done)return o.geoJson=n.value,t.read().then(i);e(o.geoJson)})))).catch((e=>r(e.stack)))})),a=Yl(a,"");var l=this._resourceCredits,c=n.credits;if($l(c))for(var u=c.length,h=0;h<u;h++)l.push(c[h])}return i={describe:Yl(i.describe,Dc),pointSize:Yl(i.pointSize,kc.pointSize),pointColor:Yl(i.pointColor,kc.pointColor),lineWidth:new Zl(Yl(i.lineWidth,kc.lineWidth)),outlineColor:new Xl(Yl(i.outlineColor,kc.outlineColor)),lineColor:new Xl(Yl(i.lineColor,kc.lineColor)),outlineWidth:Yl(i.outlineWidth,kc.outlineWidth),fill:new Xl(Yl(i.fill,kc.fill)),outline:Yl(i.outline,kc.outline),clampToGround:Yl(i.clampToGround,kc.clampToGround),extrudedHeight:i.extrudedHeight},Promise.resolve(s).then((function(e){return Ic(o,e,i,a)})).catch((function(e){throw Ql.setLoading(o,!1),o._error.raiseEvent(o,e),e}))}loadArrayBuffer(e,t,i={encoding:"utf-8"}){let n=e;if(!$l(n))throw new Le("shpfile is required.");Cesium.DataSource.setLoading(this,!0);const r=i.credit;"string"==typeof r&&(r=new Cesium.Credit(r)),this._credit=r;const o=this;let s=n,a=i.sourceUri;if(n instanceof ArrayBuffer){s=new Promise(((e,r)=>{ql(n,t,{encoding:i.encoding}).then((t=>t.read().then((function i(n){if(!n.done)return o.geoJson=n.value,t.read().then(i);e(o.geoJson)})))).catch((e=>r(e.stack)))})),a=Yl(a,"");var l=this._resourceCredits,c=n.credits;if($l(c))for(var u=c.length,h=0;h<u;h++)l.push(c[h])}return i={describe:Yl(i.describe,Dc),pointSize:Yl(i.pointSize,kc.pointSize),pointColor:Yl(i.pointColor,kc.pointColor),lineWidth:new Zl(Yl(i.lineWidth,kc.lineWidth)),outlineColor:new Xl(Yl(i.outlineColor,kc.outlineColor)),lineColor:new Xl(Yl(i.lineColor,kc.lineColor)),outlineWidth:Yl(i.outlineWidth,kc.outlineWidth),fill:new Xl(Yl(i.fill,kc.fill)),outline:Yl(i.outline,kc.outline),clampToGround:Yl(i.clampToGround,kc.clampToGround),extrudedHeight:i.extrudedHeight},Promise.resolve(s).then((function(e){return Ic(o,e,i,a)})).catch((function(e){throw Ql.setLoading(o,!1),o._error.raiseEvent(o,e),e}))}}kc.load=function(e,t,i){return(new kc).load(e,t,i)},kc.loadArrayBuffer=function(e,t,i){return(new kc).loadArrayBuffer(e,t,i)};const{buildModuleUrl:Oc,Color:Nc,defined:Fc,destroyObject:zc,knockout:Bc,getElement:Gc,subscribeAndEvaluate:Hc,InfoBoxViewModel:Wc}=Cesium;class Uc{constructor(e){e=Gc(e);var t=document.createElement("div");t.className="cesium-infoBox",t.setAttribute("data-bind",'      css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),e.appendChild(t);var i=document.createElement("div");i.className="cesium-infoBox-title",i.setAttribute("data-bind","text: titleText"),t.appendChild(i);var n=document.createElement("button");n.type="button",n.className="cesium-infoBox-close",n.setAttribute("data-bind","      click: function () { closeClicked.raiseEvent(this); }"),n.innerHTML="&times;",t.appendChild(n);var r=document.createElement("iframe");r.className="cesium-infoBox-iframe",r.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),r.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),r.setAttribute("allowfullscreen",!0),t.appendChild(r);var o=new Wc;Bc.applyBindings(o,t),this._container=e,this._element=t,this._frame=r,this._viewModel=o,this._descriptionSubscription=void 0;var s=this;r.addEventListener("load",(function(){var e=r.contentDocument,i=e.createElement("link");i.href=Oc("Widgets/InfoBox/InfoBoxDescription.css"),i.rel="stylesheet",i.type="text/css";var n=e.createElement("div");n.className="cesium-infoBox-description",e.head.appendChild(i),e.body.appendChild(n),s._descriptionSubscription=Hc(o,"description",(function(e){r.style.height="5px",n.innerHTML=e;var i=null,o=n.firstElementChild;if(null!==o&&1===n.childNodes.length){var s=window.getComputedStyle(o);if(null!==s){var a=s["background-color"],l=Nc.fromCssColorString(a);Fc(l)&&0!==l.alpha&&(i=s["background-color"])}}t.style["background-color"]=i;var c=n.getBoundingClientRect().height;r.style.height=c+"px"}))})),r.setAttribute("src","about:blank")}get container(){return this._container}get viewModel(){return this._viewModel}get frame(){return this._frame}isDestroyed(){return!1}destroy(){var e=this._container;return Bc.cleanNode(this._element),e.removeChild(this._element),Fc(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),zc(this)}}function jc(e,t){const{center:i}=e.boundingSphere,n=Ie.fromCartesian(i),r=Cesium.Cartesian3.fromDegrees(n.lon,n.lat,0),o=Cesium.Cartesian3.fromDegrees(n.lon,n.lat,t),s=Cesium.Cartesian3.subtract(o,r,new Cesium.Cartesian3);e.modelMatrix=Cesium.Matrix4.multiply(e.modelMatrix,Cesium.Matrix4.fromTranslation(s),e.modelMatrix)}class Vc{constructor(e={},t={}){this._params={height:0,position:new Cesium.Cartesian3(0,0,0),rotation:0};let{transform:i,position:n,height:r,rotationZ:o,debug:s}=e;const a=new Cesium.Cesium3DTileset(e);a.readyPromise.then((e=>{if(viewer.scene.primitives.add(e),Cesium.defined(n)&&function(e,t,i,n){if(t)e.root.transform=t;else{const t=Cesium.Transforms.eastNorthUpToFixedFrame(i),r=Cesium.Matrix3.fromRotationZ(n);Cesium.Matrix4.multiplyByMatrix3(t,r,t),Cesium.Matrix4.multiply(e.root.transform,t,e.root.transform)}}(e,i,n,o),Cesium.defined(r)&&jc(e,r),s){let t=0,i=new Cesium.Cartesian3,n=0;parent.onkeypress=function(r){r.keyCode==="Q".charCodeAt()||r.keyCode==="q".charCodeAt()?t=1:r.keyCode==="E".charCodeAt()||r.keyCode==="e".charCodeAt()?t=-1:r.keyCode==="A".charCodeAt()||r.keyCode==="a".charCodeAt()?i=new Cesium.Cartesian3(-2,0,0):r.keyCode==="D".charCodeAt()||r.keyCode==="d".charCodeAt()?i=new Cesium.Cartesian3(2,0,0):r.keyCode==="W".charCodeAt()||r.keyCode==="w".charCodeAt()?i=new Cesium.Cartesian3(0,-2,0):r.keyCode==="S".charCodeAt()||r.keyCode==="s".charCodeAt()?i=new Cesium.Cartesian3(0,2,0):r.keyCode==="Z".charCodeAt()||r.keyCode==="z".charCodeAt()?n=-1:r.keyCode!=="X".charCodeAt()&&r.keyCode!=="x".charCodeAt()||(n=1),function(e,t){const i=new Cesium.Matrix4;Cesium.Matrix4.fromTranslation(t,i),Cesium.Matrix4.multiply(e.modelMatrix,i,e.modelMatrix)}(e,i),function(e,t){const i=Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(t));Cesium.Matrix4.multiplyByMatrix3(e.root.transform,i,e.root.transform)}(e,n),jc(e,t),n=0,i=new Cesium.Cartesian3,t=0}}})),this.delegate=a}get allTilesLoaded(){return this.delegate.allTilesLoaded}get readyPromise(){return this.delegate.readyPromise}get boundingSphere(){return this.delegate.boundingSphere}get colorBlendAmount(){return this.delegate.colorBlendAmount}set colorBlendAmount(e){this.delegate.colorBlendAmount=e}get colorBlendMode(){return this.delegate.colorBlendMode}set colorBlendMode(e){this.delegate.colorBlendMode=e}get style(){return this.delegate.style}set style(e){this.delegate.style=e}get customShader(){return this.delegate.customShader}set customShader(e){this.delegate.customShader=e}get debugColorizeTiles(){return this.delegate.debugColorizeTiles}set debugColorizeTiles(e){this.delegate.debugColorizeTiles=e}get debugFreezeFrame(){return this.delegate.debugFreezeFrame}set debugFreezeFrame(e){this.delegate.debugFreezeFrame=e}get debugShowBoundingVolume(){return this.delegate.debugShowBoundingVolume}set debugShowBoundingVolume(e){this.delegate.debugShowBoundingVolume=e}get debugShowContentBoundingVolume(){return this.delegate.debugShowContentBoundingVolume}set debugShowContentBoundingVolume(e){this.delegate.debugShowContentBoundingVolume=e}get debugShowGeometricError(){return this.delegate.debugShowGeometricError}set debugShowGeometricError(e){this.delegate.debugShowGeometricError=e}get debugShowMemoryUsage(){return this.delegate.debugShowMemoryUsage}set debugShowMemoryUsage(e){this.delegate.debugShowMemoryUsage=e}get debugShowRenderingStatistics(){return this.delegate.debugShowRenderingStatistics}set debugShowRenderingStatistics(e){this.delegate.debugShowRenderingStatistics=e}get debugShowUrl(){return this.delegate.debugShowUrl}set debugShowUrl(e){this.delegate.debugShowUrl=e}get debugWireframe(){return this.delegate.debugWireframe}set debugWireframe(e){this.delegate.debugWireframe=e}get dynamicScreenSpaceError(){return this.delegate.dynamicScreenSpaceError}set dynamicScreenSpaceError(e){this.delegate.dynamicScreenSpaceError=e}get dynamicScreenSpaceErrorFactor(){return this.delegate.dynamicScreenSpaceErrorFactor}set dynamicScreenSpaceErrorFactor(e){this.delegate.dynamicScreenSpaceErrorFactor=e}get extensions(){return this.delegate.extensions}get extras(){return this.delegate.extras}get dynamicScreenSpaceErrorDensity(){return this.delegate.dynamicScreenSpaceErrorDensity}set dynamicScreenSpaceErrorDensity(e){this.delegate.dynamicScreenSpaceErrorDensity=e}get foveatedScreenSpaceError(){return this.delegate.foveatedScreenSpaceError}set foveatedScreenSpaceError(e){this.delegate.foveatedScreenSpaceError=e}get foveatedConeSize(){return this.delegate.foveatedConeSize}set foveatedConeSize(e){this.delegate.foveatedConeSize=e}get foveatedInterpolationCallback(){return this.delegate.foveatedInterpolationCallback}set foveatedInterpolationCallback(e){this.delegate.foveatedInterpolationCallback=e}get foveatedMinimumScreenSpaceErrorRelaxation(){return this.delegate.foveatedMinimumScreenSpaceErrorRelaxation}set foveatedMinimumScreenSpaceErrorRelaxation(e){this.delegate.foveatedMinimumScreenSpaceErrorRelaxation=e}get foveatedTimeDelay(){return this.delegate.foveatedTimeDelay}set foveatedTimeDelay(e){this.delegate.foveatedTimeDelay=e}get imageBasedLightingFactor(){return this.delegate.imageBasedLightingFactor}set imageBasedLightingFactor(e){this.delegate.imageBasedLightingFactor=e}get immediateLoadDesiredLevelOfDetail(){return this.delegate.immediateLoadDesiredLevelOfDetail}set immediateLoadDesiredLevelOfDetail(e){this.delegate.immediateLoadDesiredLevelOfDetail=e}get initialTilesLoaded(){return this.delegate.initialTilesLoaded}get lightColor(){return this.delegate.lightColor}set lightColor(e){this.delegate.lightColor=e}get loadProgress(){return this.delegate.loadProgress}get loadSiblings(){return this.delegate.loadSiblings}get maximumMemoryUsage(){return this.delegate.maximumMemoryUsage}set maximumMemoryUsage(e){this.delegate.maximumMemoryUsage=e}get maximumScreenSpaceError(){return this.delegate.maximumScreenSpaceError}set maximumScreenSpaceError(e){this.delegate.maximumScreenSpaceError=e}get modelMatrix(){return this.delegate.modelMatrix}set modelMatrix(e){this.delegate.modelMatrix=e}get pointCloudShading(){return this.delegate.pointCloudShading}set pointCloudShading(e){this.delegate.pointCloudShading}get preferLeaves(){return this.delegate.preferLeaves}set preferLeaves(e){this.delegate.preferLeaves=e}get preloadFlightDestinations(){return this.delegate.preloadFlightDestinations}set preloadFlightDestinations(e){this.delegate.preloadFlightDestinations}get preloadWhenHidden(){return this.delegate.preloadWhenHidden}set preloadWhenHidden(e){this.delegate.preloadWhenHidden}get progressResolutionHeightFraction(){return this.delegate.progressResolutionHeightFraction}set progressResolutionHeightFraction(e){this.delegate.progressResolutionHeightFraction=e}get properties(){return this.delegate.properties}get resource(){return this.delegate.resource}get root(){return this.delegate.root}get shadows(){return this.delegate.shadows}set shadows(e){this.delegate.shadows=e}get showOutline(){return this.delegate.showOutline}get skipLevelOfDetail(){return this.delegate.skipLevelOfDetail}set skipLevelOfDetail(e){this.delegate.skipLevelOfDetail}get skipLevels(){return this.delegate.skipLevels}set skipLevels(e){this.delegate.skipLevels=e}get skipScreenSpaceErrorFactor(){return this.delegate.skipScreenSpaceErrorFactor}set skipScreenSpaceErrorFactor(e){this.delegate.skipScreenSpaceErrorFactor=e}get clippingPlanes(){return this.delegate.clippingPlanes}set clippingPlanes(e){this.delegate.clippingPlanes=e}get specularEnvironmentMaps(){return this.delegate.specularEnvironmentMaps}set specularEnvironmentMaps(e){this.delegate.specularEnvironmentMaps=e}get tileFailed(){return this.delegate.tileFailed}get tileLoad(){return this.delegate.tileLoad}set tileLoad(e){this.delegate.tileLoad=e}get tileUnload(){return this.delegate.tileUnload}set tileUnload(e){this.delegate.tileUnload=e}get tilesLoaded(){return this.delegate.tilesLoaded}get tileVisible(){return this.delegate.tileVisible}set tileVisible(e){this.delegate.tileVisible=e}get timeSinceLoad(){return this.delegate.timeSinceLoad}get totalMemoryUsageInBytes(){return this.delegate.totalMemoryUsageInBytes}get classificationType(){return this.delegate.classificationType}set classificationType(e){this.delegate.classificationType=e}get baseScreenSpaceError(){return this.delegate.baseScreenSpaceError}set baseScreenSpaceError(e){this.delegate.baseScreenSpaceError=e}destroy(){this.delegate.destroy()}hasExtension(e){return this.delegate.hasExtension(e)}isDestroyed(){return this.delegate.isDestroyed()}makeStyleDirty(){return this.delegate.makeStyleDirty()}trimLoadedTiles(){this.delegate.trimLoadedTiles()}static loadJson(e){return Cesium3DTileset.loadJson(e)}}class qc{constructor(e={}){this._id=De(e.id,Ii()),this._maxClusterLevel=De(e.maxClusterLevel,12),this._minLoadLevel=De(e.minLoadLevel,12),this._objects=void 0}get id(){return this._id}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(e){this._minLoadLevel=e}get objects(){return this._objects}set objects(e){this._objects=e}updateCluster(e){Le.throwInstantiationError()}beginUpdate(e){Le.throwInstantiationError()}endUpdate(e){Le.throwInstantiationError()}initialize(e,t){Le.throwInstantiationError()}createGeometry(e,t,i){Le.throwInstantiationError()}removeGeometry(e,t){}removeAll(){Le.throwInstantiationError()}isDestroyed(){return!1}destroy(){Le.throwInstantiationError()}}const{AssociativeArray:$c}=Cesium;class Yc{constructor(){this._layers=new $c}get layer(){return this._layers}get length(){return this._layers.length}get values(){return this._layers.values}get(e){return this._layers.get(e)}add(e){e instanceof qc&&this._layers.set(e.id,e)}has(e){return e instanceof qc?this._layers.contains(e):"string"==typeof e&&this._layers.contains(this.get(e))}remove(e){if(e instanceof qc)return e.destroy(),this._layers.remove(e.id);if("string"==typeof e){const t=this._layers.get(e);return t&&t.destroy(),this._layers.remove(e)}return!1}removeAll(){return this._layers.removeAll()}}const{GeographicTilingScheme:Xc,GlobeSurfaceTileProvider:Jc,Event:Zc,TerrainState:Qc,RequestType:Kc,Request:eu,Rectangle:tu,QuadtreeTileLoadState:iu,Visibility:nu,AssociativeArray:ru,Cartesian3:ou,Cartographic:su,getTimestamp:au,RequestState:lu}=Cesium;function cu(e,t,i){let n=e.data;!function(){const t=new eu({throttle:!1,throttleByServer:!0,type:Kc.TERRAIN});n.request=t;const r=i.requestTileGeometry(e.x,e.y,e.level,t);Re(r)?(n.terrainState=Qc.RECEIVING,Promise.resolve(r).then((function(e){!function(e){n.terrainData=e,n.terrainState=Qc.RECEIVED,n.request=void 0}(e)})).catch((function(e){!function(e){if(n.request.state===lu.CANCELLED)return n.terrainData=void 0,n.terrainState=Qc.UNLOADED,void(n.request=void 0);n.terrainState=Qc.FAILED,n.request=void 0}()}))):(n.terrainState=Qc.UNLOADED,n.request=void 0)}()}const uu={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function hu(e,t,i,n,r){const o=e.data;o.terrainState===Qc.UNLOADED&&cu(e,0,i),o.terrainState===Qc.RECEIVED&&function(e,t,i,n,r,o){const s=i.tilingScheme,a=uu;a.tilingScheme=s,a.x=n,a.y=r,a.level=o,a.exaggeration=t.terrainExaggeration,a.exaggerationRelativeHeight=t.terrainExaggerationRelativeHeight,a.throttle=!0;const l=e.terrainData.createMesh(a);Re(l)&&(e.terrainState=Qc.TRANSFORMING,Promise.resolve(l).then((function(t){e.mesh=t,e.terrainState=Qc.TRANSFORMED})).catch((function(){e.terrainState=Qc.FAILED})))}(o,t,i,e.x,e.y,e.level),o.terrainState===Qc.TRANSFORMED&&(e.renderable=!0)}function du(e,t){const i=[];for(let n of e)Re(n)&&(Re(n.id)||(n.id=Ii()),Re(n)&&Re(n.position)&&(n.position instanceof ou?n.cartesian=n.position:n.position instanceof su?(n.cartesian=su.toCartesian(n.position),n.catographic=n.position):n.position instanceof Ie?(n.cartesian=n.position.toCartesian(),n.cartographic=n.position.toCartoGraphic()):n.cartesian=n.position,n.cartographic||(n.cartographic=su.fromCartesian(n.cartesian)),tu.contains(t.rectangle,n.cartographic)&&i.push(n)));return i}class pu{constructor(){this.boundingVolumeSourceTile=void 0,this.terrainState=Cesium.TerrainState.UNLOADED,this.mesh=void 0,this.terrainData=void 0,this.objects=void 0,this._geometryOfTile=new ru,this._objectsOfTile=new ru,this._needRenderObjects=new ru}static processStateMachine(e,t,i,n,r){pu.initialize(e,i),e.state===iu.LOADING&&hu(e,t,i)}static initialize(e,t){let i=e.data;Re(i)||(i=e.data=new pu),e.state===iu.START&&(e.state=iu.LOADING)}}function mu(e,t,i,n,r){let o=i.data._geometryOfTile.get(t.id),s=e._hasRenderCached.get(t.id);s||(s={},e._hasRenderCached.set(t.id,s)),o||(o=[]);for(let e of r){if(s[e.id])return;const r=t.createGeometry(i,n,e);r&&(s[e.id]=!0,o.push({id:e.id,geometry:r}))}i.data._geometryOfTile.set(t.id,o)}function fu(e,t,i,n,r){const o=e._hasRenderCached.get(t.id);for(let e of r){const{id:i,geometry:r}=e;t.removeGeometry(n,r),delete o[i]}i.data._geometryOfTile.remove(t.id)}class gu{constructor(e={}){this._ready=!0,this._scene=e.scene,this._tilingSceheme=new Xc,this._readyPromise=Promise.resolve(!0),this._errorEvent=new Zc,this._terrainProvider=e.terrainProvider,this._show=!0,this.cartographicLimitRectangle=tu.clone(tu.MAX_VALUE),this.tree=void 0,this._layers=new Yc,this._lastTilesToRender=[],this._hasRenderCached=new ru,this._tilesCahced=[]}get terrainProvider(){return this._terrainProvider}get show(){return this._show}set show(e){this._show=e}get ready(){return this._ready}get tilingScheme(){return this._tilingSceheme}get readyPromise(){return this._readyPromise}get quadtree(){return this._quadtree}set quadtree(e){Re(e)&&(this._quadtree=e)}initialize(e){for(let t of this._layers.values)t.initialize(e,this._scene)}beginUpdate(e){const t=this._layers.values;for(let i of t)i.beginUpdate(e);this._frameNumber++}showTileThisFrame(e,t){const i=e.data;if(!Re(i))return;this._tilesCahced.includes(e)||this._tilesCahced.push(e);const n=this._layers.values;au();for(let r of n){if(!Re(r.objects)||!Array.isArray(r.objects))continue;const n=r.id;if(i._geometryOfTile.get(n)&&!r._needReclass)return;let o=i._objectsOfTile.get(n);Re(o)&&!r._needReclass||(o=du(r.objects,e),i._objectsOfTile.set(n,o)),mu(this,r,e,t,o)}}endUpdate(e){const t=this._quadtree;if(!t)return;const i=this._lastTilesToRender,n=t._tilesToRender,r=this._layers.values;for(let t of i)if(!n.includes(t))for(let i of r){const n=t.data._geometryOfTile.get(i.id)||[];fu(this,i,t,e,n)}for(let t of r){t.endUpdate(e)&&n.forEach((i=>{const n=i.data._geometryOfTile.get(t.id)||[];fu(this,t,i,e,n)}))}this._lastTilesToRender=[...n]}loadTile(e,t){if(!this.terrainProvider.ready)return;let i,n=!0;t.data&&(i=t.data.terrainState,n=t.data.boundingVolumeSourceTile!==t),pu.processStateMachine(t,e,this.terrainProvider,this._layers,this.quadtree);const r=t.data;n&&i!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==nu.NONE&&r.boundingVolumeSourceTile===t&&pu.processStateMachine(t,e,this.terrainProvider,this._layers,this.quadtree)}getLevelMaximumGeometricError(e){return this._terrainProvider.getLevelMaximumGeometricError(e)}canRefine(e){return Jc.prototype.canRefine.call(this,e)}computeTileVisibility(e,t,i){return Re(e.data)||(e.data=new pu),Jc.prototype.computeTileVisibility.call(this,e,t,i)}computeDistanceToTile(e,t){return e.data||(e.data=new pu),Jc.prototype.computeDistanceToTile.call(this,e,t)}clearTile(e){const t=this._tilesCahced;for(let i of t)i.data._geometryOfTile.remove(e),i.data._objectsOfTile.remove(e);this._hasRenderCached.remove(e)}isDestroyed(){return!1}destroy(){this._removeEventListener();const e=this._layers.values;for(let t of e)t.destroy()}computeTileLoadPriority(e,t){return Jc.prototype.computeTileLoadPriority(e,t)}_onLayerAdded(e,t){}_onLayerRemoved(e,t){}_onLayerShownOrHidden(e,t,i){i?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)}}var yu="uniform vec4 u_initialColor;\n\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_DAY_NIGHT_ALPHA\nuniform float u_dayTextureNightAlpha[TEXTURE_UNITS];\nuniform float u_dayTextureDayAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SPLIT\nuniform float czm_p_splitPosition;\nuniform float czm_p_drawingBufferHeight;\nuniform float czm_p_drawingBufferWidth;\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_IMAGERY_CUTOUT\nuniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_COLOR_TO_ALPHA\nuniform vec4 u_colorsToAlpha[TEXTURE_UNITS];\n#endif\n\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nuniform vec2 u_lightingFadeDistance;\n#endif\n\n#ifdef TILE_LIMIT_RECTANGLE\nuniform vec4 u_cartographicLimitRectangle;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nuniform vec2 u_nightFadeDistance;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\nuniform highp sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG) && defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\nuniform float u_minimumBrightness;\n#endif\n\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\nuniform vec4 u_fillHighlightColor;\n#endif\n\n#ifdef TRANSLUCENT\nuniform vec4 u_frontFaceAlphaByDistance;\nuniform vec4 u_backFaceAlphaByDistance;\nuniform vec4 u_translucencyRectangle;\n#endif\n\n#ifdef UNDERGROUND_COLOR\nuniform vec4 u_undergroundColor;\nuniform vec4 u_undergroundColorAlphaByDistance;\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\nuniform float u_lambertDiffuseMultiplier;\n#endif\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nvarying float v_height;\nvarying float v_slope;\nvarying float v_aspect;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nvarying float v_distance;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\nvarying vec3 v_atmosphereRayleighColor;\nvarying vec3 v_atmosphereMieColor;\nvarying float v_atmosphereOpacity;\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nfloat interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n    float startDistance = nearFarScalar.x;\n    float startValue = nearFarScalar.y;\n    float endDistance = nearFarScalar.z;\n    float endValue = nearFarScalar.w;\n    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n    return mix(startValue, endValue, t);\n}\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT) || defined(APPLY_MATERIAL)\nvec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)\n{\n    return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);\n}\n#endif\n\n#ifdef TRANSLUCENT\nbool inTranslucencyRectangle()\n{\n    return\n        v_textureCoordinates.x > u_translucencyRectangle.x &&\n        v_textureCoordinates.x < u_translucencyRectangle.z &&\n        v_textureCoordinates.y > u_translucencyRectangle.y &&\n        v_textureCoordinates.y < u_translucencyRectangle.w;\n}\n#endif\n\nvec4 sampleAndBlend(\n    vec4 previousColor,\n    sampler2D textureToSample,\n    vec2 tileTextureCoordinates,\n    vec4 textureCoordinateRectangle,\n    vec4 textureCoordinateTranslationAndScale,\n    float textureAlpha,\n    float textureNightAlpha,\n    float textureDayAlpha,\n    float textureBrightness,\n    float textureContrast,\n    float textureHue,\n    float textureSaturation,\n    float textureOneOverGamma,\n    float split,\n    vec4 colorToAlpha,\n    float nightBlend)\n{\n    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:\n    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||\n    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||\n    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||\n    //    tileTextureCoordinates.t > textureCoordinateRectangle.q\n    // In other words, the alpha is zero if the fragment is outside the rectangle\n    // covered by this texture.  Would an actual 'if' yield better performance?\n    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    textureAlpha *= mix(textureDayAlpha, textureNightAlpha, nightBlend);\n#endif\n\n    vec2 translation = textureCoordinateTranslationAndScale.xy;\n    vec2 scale = textureCoordinateTranslationAndScale.zw;\n    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;\n    vec4 value = texture2D(textureToSample, textureCoordinates);\n    vec3 color = value.rgb;\n    float alpha = value.a;\n\n#ifdef APPLY_COLOR_TO_ALPHA\n    vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);\n    colorDiff.r = max(max(colorDiff.r, colorDiff.g), colorDiff.b);\n    alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);\n#endif\n\n#if !defined(APPLY_GAMMA)\n    vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));\n    color = tempColor.rgb;\n    alpha = tempColor.a;\n#else\n    color = pow(color, vec3(textureOneOverGamma));\n#endif\n\n#ifdef APPLY_SPLIT\n    float splitPosition = czm_p_splitPosition * czm_p_drawingBufferWidth;\n    // 垂直分割 \n    if(split < -2.0 || split > 2.0) {\n        splitPosition = (1.0 - czm_p_splitPosition) * czm_p_drawingBufferHeight;\n    }\n    if(split < -2.0 && gl_FragCoord.y < splitPosition) {\n        alpha = 0.0;\n    }\n    else if (split > 2.0 && gl_FragCoord.y > splitPosition) {\n        alpha = 0.0;\n    }\n    // Split to the left\n    else if (split > -2.0 && split < 0.0 && gl_FragCoord.x > splitPosition) {\n       alpha = 0.0;\n    }\n    // Split to the right\n    else if (split < 2.0 && split > 0.0 && gl_FragCoord.x < splitPosition) {\n       alpha = 0.0;\n    }\n#endif\n\n#ifdef APPLY_BRIGHTNESS\n    color = mix(vec3(0.0), color, textureBrightness);\n#endif\n\n#ifdef APPLY_CONTRAST\n    color = mix(vec3(0.5), color, textureContrast);\n#endif\n\n#ifdef APPLY_HUE\n    color = czm_hue(color, textureHue);\n#endif\n\n#ifdef APPLY_SATURATION\n    color = czm_saturation(color, textureSaturation);\n#endif\n\n    float sourceAlpha = alpha * textureAlpha;\n    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\n    outAlpha += sign(outAlpha) - 1.0;\n\n    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\n\n    // When rendering imagery for a tile in multiple passes,\n    // some GPU/WebGL implementation combinations will not blend fragments in\n    // additional passes correctly if their computation includes an unmasked\n    // divide-by-zero operation,\n    // even if it's not in the output or if the output has alpha zero.\n    //\n    // For example, without sanitization for outAlpha,\n    // this renders without artifacts:\n    //   if (outAlpha == 0.0) { outColor = vec3(0.0); }\n    //\n    // but using czm_branchFreeTernary will cause portions of the tile that are\n    // alpha-zero in the additional pass to render as black instead of blending\n    // with the previous pass:\n    //   outColor = czm_branchFreeTernary(outAlpha == 0.0, vec3(0.0), outColor);\n    //\n    // So instead, sanitize against divide-by-zero,\n    // store this state on the sign of outAlpha, and correct on return.\n\n    return vec4(outColor, max(outAlpha, 0.0));\n}\n\nvec3 colorCorrect(vec3 rgb) {\n#ifdef COLOR_CORRECT\n    // Convert rgb color to hsb\n    vec3 hsb = czm_RGBToHSB(rgb);\n    // Perform hsb shift\n    hsb.x += u_hsbShift.x; // hue\n    hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n    hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n    // Convert shifted hsb back to rgb\n    rgb = czm_HSBToRGB(hsb);\n#endif\n    return rgb;\n}\n\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);\n\nconst float fExposure = 2.0;\n\nvec3 computeEllipsoidPosition()\n{\n    float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0), 1.0);\n    vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);\n    xy *= czm_viewport.zw * mpp * 0.5;\n\n    vec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n\n    vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);\n    return (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;\n}\n\nvoid main()\n{\n#ifdef TILE_LIMIT_RECTANGLE\n    if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||\n        v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)\n        {\n            discard;\n        }\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)\n    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates\n    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordiantes\n#endif\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    float nightBlend = 1.0 - clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0, 0.0, 1.0);\n#else\n    float nightBlend = 0.0;\n#endif\n\n    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0\n    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the\n    // fragments on the edges of tiles even though the vertex shader is outputting\n    // coordinates strictly in the 0-1 range.\n    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0), nightBlend);\n\n#ifdef SHOW_TILE_BOUNDARIES\n    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\n        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n    {\n        color = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\n    float cameraDist;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;\n    }\n    else if (czm_sceneMode == czm_sceneModeColumbusView)\n    {\n        cameraDist = -czm_view[3].z;\n    }\n    else\n    {\n        cameraDist = length(czm_view[3]);\n    }\n    float fadeOutDist = u_lightingFadeDistance.x;\n    float fadeInDist = u_lightingFadeDistance.y;\n    if (czm_sceneMode != czm_sceneMode3D) {\n        vec3 radii = czm_ellipsoidRadii;\n        float maxRadii = max(radii.x, max(radii.y, radii.z));\n        fadeOutDist -= maxRadii;\n        fadeInDist -= maxRadii;\n    }\n    float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#else\n    float fade = 0.0;\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\n    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\n    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\n    waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;\n\n    float mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\n\n    if (mask > 0.0)\n    {\n        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\n\n        vec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\n        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\n\n        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\n\n        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);\n    }\n#endif\n\n#ifdef APPLY_MATERIAL\n    czm_materialInput materialInput;\n    materialInput.st = v_textureCoordinates.st;\n    materialInput.normalEC = normalize(v_normalEC);\n    materialInput.positionToEyeEC = -v_positionEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalize(v_normalEC));     \n    materialInput.slope = v_slope;\n    materialInput.height = v_height;\n    materialInput.aspect = v_aspect;\n    czm_material material = czm_getMaterial(materialInput);\n    vec4 materialColor = vec4(material.diffuse, material.alpha);\n    color = alphaBlend(materialColor, color);\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalize(v_normalEC)) * u_lambertDiffuseMultiplier + 0.3, 0.0, 1.0);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\n    diffuseIntensity = mix(1.0, diffuseIntensity, fade);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#else\n    vec4 finalColor = color;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\n\n    if (clipDistance < clippingPlanesEdgeWidth)\n    {\n        finalColor = clippingPlanesEdgeColor;\n    }\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\n    finalColor = vec4(mix(finalColor.rgb, u_fillHighlightColor.rgb, u_fillHighlightColor.a), finalColor.a);\n#endif\n\n#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)\n    vec3 atmosphereLightDirection = czm_sunDirectionWC;\n#else\n    vec3 atmosphereLightDirection = czm_lightDirectionWC;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\n    if (!czm_backFacing())\n    {\n        bool dynamicLighting = false;\n        #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n            dynamicLighting = true;     \n        #endif\n\n        vec3 rayleighColor;\n        vec3 mieColor;\n        float opacity;\n\n        vec3 positionWC;\n        vec3 lightDirection;\n\n        // When the camera is far away (camera distance > nightFadeOutDistance), the scattering is computed in the fragment shader.\n        // Otherwise, the scattering is computed in the vertex shader.\n        #ifdef PER_FRAGMENT_GROUND_ATMOSPHERE\n            positionWC = computeEllipsoidPosition();\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            computeAtmosphereScattering(\n                positionWC,\n                lightDirection,\n                rayleighColor,\n                mieColor,\n                opacity\n            );\n        #else\n            positionWC = v_positionMC;\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            rayleighColor = v_atmosphereRayleighColor;\n            mieColor = v_atmosphereMieColor;\n            opacity = v_atmosphereOpacity;\n        #endif\n\n        rayleighColor = colorCorrect(rayleighColor);\n        mieColor = colorCorrect(mieColor);\n\n        vec4 groundAtmosphereColor = computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);\n\n        // Fog is applied to tiles selected for fog, close to the Earth.\n        #ifdef FOG\n            vec3 fogColor = groundAtmosphereColor.rgb;\n            \n            // If there is lighting, apply that to the fog.\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float darken = clamp(dot(normalize(czm_viewerPositionWC), atmosphereLightDirection), u_minimumBrightness, 1.0);\n                fogColor *= darken;                \n            #endif\n\n            #ifndef HDR\n                fogColor.rgb = czm_acesTonemapping(fogColor.rgb);\n                fogColor.rgb = czm_inverseGamma(fogColor.rgb);\n            #endif\n            \n            const float modifier = 0.15;\n            finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor.rgb, modifier), finalColor.a);\n\n        #else\n            // The transmittance is based on optical depth i.e. the length of segment of the ray inside the atmosphere.\n            // This value is larger near the \"circumference\", as it is further away from the camera. We use it to\n            // brighten up that area of the ground atmosphere.\n            const float transmittanceModifier = 0.5;\n            float transmittance = transmittanceModifier + clamp(1.0 - groundAtmosphereColor.a, 0.0, 1.0);\n\n            vec3 finalAtmosphereColor = finalColor.rgb + groundAtmosphereColor.rgb * transmittance;\n\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float fadeInDist = u_nightFadeDistance.x;\n                float fadeOutDist = u_nightFadeDistance.y;\n            \n                float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.05, 1.0);\n                float darken = clamp(dot(normalize(positionWC), atmosphereLightDirection), 0.0, 1.0);\n                vec3 darkenendGroundAtmosphereColor = mix(groundAtmosphereColor.rgb, finalAtmosphereColor.rgb, darken);\n\n                finalAtmosphereColor = mix(darkenendGroundAtmosphereColor, finalAtmosphereColor, sunlitAtmosphereIntensity);\n            #endif\n            \n            #ifndef HDR\n                finalAtmosphereColor.rgb = vec3(1.0) - exp(-fExposure * finalAtmosphereColor.rgb);\n            #else\n                finalAtmosphereColor.rgb = czm_saturation(finalAtmosphereColor.rgb, 1.6);\n            #endif\n            \n            finalColor.rgb = mix(finalColor.rgb, finalAtmosphereColor.rgb, fade);\n        #endif\n    }\n#endif\n\n#ifdef UNDERGROUND_COLOR\n    if (czm_backFacing())\n    {\n        float distanceFromEllipsoid = max(czm_eyeHeight, 0.0);\n        float distance = max(v_distance - distanceFromEllipsoid, 0.0);\n        float blendAmount = interpolateByDistance(u_undergroundColorAlphaByDistance, distance);\n        vec4 undergroundColor = vec4(u_undergroundColor.rgb, u_undergroundColor.a * blendAmount);\n        finalColor = alphaBlend(undergroundColor, finalColor);\n    }\n#endif\n\n#ifdef TRANSLUCENT\n    if (inTranslucencyRectangle())\n    {\n      vec4 alphaByDistance = gl_FrontFacing ? u_frontFaceAlphaByDistance : u_backFaceAlphaByDistance;\n      finalColor.a *= interpolateByDistance(alphaByDistance, v_distance);\n    }\n#endif\n    \n    gl_FragColor =  finalColor;\n}\n\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n\nfloat waveFade(float edge0, float edge1, float x)\n{\n    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return pow(1.0 - y, 5.0);\n}\n\nfloat linearFade(float edge0, float edge1, float x)\n{\n    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\n// Based on water rendering by Jonas Wagner:\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\n// low altitude wave settings\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\n\n// high altitude wave settings\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\n\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)\n{\n    vec3 positionToEyeEC = -positionEyeCoordinates;\n    float positionToEyeECLength = length(positionToEyeEC);\n\n    // The double normalize below works around a bug in Firefox on Android devices.\n    vec3 normalizedPositionToEyeEC = normalize(normalize(positionToEyeEC));\n\n    // Fade out the waves as the camera moves far from the surface.\n    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n\n#ifdef SHOW_OCEAN_WAVES\n    // high altitude waves\n    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\n    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\n    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\n\n    // low altitude waves\n    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;\n    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\n    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\n\n    // blend the 2 wave layers based on distance to surface\n    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\n    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\n    vec3 normalTangentSpace =\n        (highAltitudeFade * normalTangentSpaceHighAltitude) +\n        (lowAltitudeFade * normalTangentSpaceLowAltitude);\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // fade out the normal perturbation as we move farther from the water surface\n    normalTangentSpace.xy *= waveIntensity;\n    normalTangentSpace = normalize(normalTangentSpace);\n#else\n    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 normalEC = enuToEye * normalTangentSpace;\n\n    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\n\n    // Use diffuse light to highlight the waves\n    float diffuseIntensity = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * maskValue;\n    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);\n\n#ifdef SHOW_OCEAN_WAVES\n    // Where diffuse light is low or non-existent, use wave highlights based solely on\n    // the wave bumpiness and no particular light direction.\n    float tsPerturbationRatio = normalTangentSpace.z;\n    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\n    vec3 nonDiffuseHighlight = vec3(0.0);\n#endif\n\n    // Add specular highlights in 3D, and in all modes when zoomed in.\n    float specularIntensity = czm_getSpecular(czm_lightDirectionEC, normalizedPositionToEyeEC, normalEC, 10.0);\n    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\n    float specular = specularIntensity * surfaceReflectance;\n\n#ifdef HDR\n    specular *= 1.4;\n\n    float e = 0.2;\n    float d = 3.3;\n    float c = 1.7;\n\n    vec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));\n#else\n    vec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;\n#endif\n\n    return vec4(color, imageryColor.a);\n}\n\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n";const{BoundingSphere:vu,buildModuleUrl:_u,Cartesian3:xu,Cartographic:Cu,Color:wu,defaultValue:bu,defined:Su,destroyObject:Tu,DeveloperError:Eu,Ellipsoid:Pu,EllipsoidTerrainProvider:Au,Event:Mu,IntersectionTests:Lu,NearFarScalar:Du,Ray:Ru,Rectangle:Iu,Resource:ku,ShaderSource:Ou,Texture:Nu,when:Fu,GlobeSurfaceShaderSet:zu,GlobeSurfaceTileProvider:Bu,GlobeTranslucency:Gu,ImageryLayerCollection:Hu,QuadtreePrimitive:Wu,SceneMode:Uu,ShadowMode:ju}=Cesium,Vu=Cesium._shadersGlobeVS,qu=Cesium._shadersAtmosphereCommon,$u=Cesium._shadersGroundAtmosphere;function Yu(e){e=bu(e,Pu.WGS84);const t=new Au({ellipsoid:e}),i=new Hu;this._ellipsoid=e,this._imageryLayerCollection=i,this._from="cesiumpro-globe",this._surfaceShaderSet=new zu,this._material=void 0,this._surface=new Wu({tileProvider:new Bu({terrainProvider:t,imageryLayers:i,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new Mu,this._undergroundColor=wu.clone(wu.BLACK),this._undergroundColorAlphaByDistance=new Du(e.maximumRadius/1e3,0,e.maximumRadius/5,1),this._translucency=new Gu,Xu(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new ku({url:_u("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.lambertDiffuseMultiplier=.9,this.dynamicAtmosphereLighting=!0,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!0,this.atmosphereLightIntensity=10,this.atmosphereRayleighCoefficient=new xu(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new xu(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=ju.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.showSkirts=!0,this.backFaceCulling=!0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0}function Xu(e){const t=[],i=Su(e._material)&&(e._material.shaderSource.match(/slope/)||e._material.shaderSource.match("normalEC")),n=[qu,$u];!Su(e._material)||i&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.materialUniformMap=void 0:(n.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.materialUniformMap=e._material._uniforms),n.push(yu),e._surfaceShaderSet.baseVertexShaderSource=new Ou({sources:[qu,$u,Vu],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new Ou({sources:n,defines:t}),e._surfaceShaderSet.material=e._material}Object.defineProperties(Yu.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return!Su(this._surface)||this._surface.tileProvider.ready&&0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){Su(e)||(e=Iu.clone(Iu.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),Su(this._material)&&Xu(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,Xu(this))}},undergroundColor:{get:function(){return this._undergroundColor},set:function(e){this._undergroundColor=wu.clone(e,this._undergroundColor)}},undergroundColorAlphaByDistance:{get:function(){return this._undergroundColorAlphaByDistance},set:function(e){this._undergroundColorAlphaByDistance=Du.clone(e,this._undergroundColorAlphaByDistance)}},translucency:{get:function(){return this._translucency}}});const Ju=[],Zu={start:0,stop:0};Yu.prototype.pickWorldCoordinates=function(e,t,i,n){i=bu(i,!0);const r=t.mode,o=t.mapProjection,s=Ju;s.length=0;const a=this._surface._tilesToRender;let l,c,u=a.length;for(c=0;c<u;++c){l=a[c];const t=l.data;if(!Su(t))continue;let i=t.pickBoundingSphere;if(r!==Uu.SCENE3D)t.pickBoundingSphere=i=vu.fromRectangleWithHeights2D(l.rectangle,o,t.tileBoundingRegion.minimumHeight,t.tileBoundingRegion.maximumHeight,i),xu.fromElements(i.center.z,i.center.x,i.center.y,i.center);else{if(!Su(t.renderedMesh))continue;vu.clone(t.tileBoundingRegion.boundingSphere,i)}const n=Lu.raySphere(e,i,Zu);Su(n)&&s.push(t)}var h;let d;for(s.sort((h=e.origin,function(e,t){return vu.distanceSquaredTo(e.pickBoundingSphere,h)-vu.distanceSquaredTo(t.pickBoundingSphere,h)})),u=s.length,c=0;c<u&&(d=s[c].pick(e,t.mode,t.mapProjection,i,n),!Su(d));++c);return d};const Qu=new Cu;Yu.prototype.pick=function(e,t,i){if(i=this.pickWorldCoordinates(e,t,!0,i),Su(i)&&t.mode!==Uu.SCENE3D){i=xu.fromElements(i.y,i.z,i.x,i);const e=t.mapProjection.unproject(i,Qu);i=t.globe.ellipsoid.cartographicToCartesian(e,i)}return i};const Ku=new xu,eh=new xu,th=new Cu,ih=new Ru;function nh(e,t){return Su(e)&&Iu.contains(e.rectangle,t)?e:void 0}Yu.prototype.getHeight=function(e){const t=this._surface._levelZeroTiles;if(!Su(t))return;let i,n;const r=t.length;for(n=0;n<r&&(i=t[n],!Iu.contains(i.rectangle,e));++n);if(n>=r)return;let o=i;for(;Su(i);)i=nh(i._southwestChild,e)||nh(i._southeastChild,e)||nh(i._northwestChild,e)||i._northeastChild,Su(i)&&Su(i.data)&&Su(i.data.renderedMesh)&&(o=i);if(i=o,!Su(i)||!Su(i.data)||!Su(i.data.renderedMesh))return;const s=this._surface._tileProvider.tilingScheme.projection,a=this._surface._tileProvider.tilingScheme.ellipsoid,l=xu.fromRadians(e.longitude,e.latitude,0,a,Ku),c=ih,u=a.geodeticSurfaceNormal(l,c.direction),h=a.getSurfaceNormalIntersectionWithZAxis(l,11500,c.origin);if(!Su(h)){let e;Su(i.data.tileBoundingRegion)&&(e=i.data.tileBoundingRegion.minimumHeight);const t=Math.min(bu(e,0),-11500),n=xu.multiplyByScalar(u,Math.abs(t)+1,eh);xu.subtract(l,n,c.origin)}const d=i.data.pick(c,void 0,s,!1,eh);return Su(d)?a.cartesianToCartographic(d,th).height:void 0},Yu.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},Yu.prototype.beginFrame=function(e){const t=this._surface,i=t.tileProvider,n=this.terrainProvider,r=this.showWaterEffect&&n.ready&&n.hasWaterMask;if(r&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;const t=this._oceanNormalMapResource,i=t.url;if(Su(i)){const n=this;t.fetchImage().then((function(t){i===n._oceanNormalMapResource.url&&(n._oceanNormalMap=n._oceanNormalMap&&n._oceanNormalMap.destroy(),n._oceanNormalMap=new Nu({context:e.context,source:t}))}))}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}const o=e.passes,s=e.mode;o.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,t.loadingDescendantLimit=this.loadingDescendantLimit,t.preloadAncestors=this.preloadAncestors,t.preloadSiblings=this.preloadSiblings,i.terrainProvider=this.terrainProvider,i.lightingFadeOutDistance=this.lightingFadeOutDistance,i.lightingFadeInDistance=this.lightingFadeInDistance,i.nightFadeOutDistance=this.nightFadeOutDistance,i.nightFadeInDistance=this.nightFadeInDistance,i.zoomedOutOceanSpecularIntensity=s===Uu.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,i.hasWaterMask=r,i.oceanNormalMap=this._oceanNormalMap,i.enableLighting=this.enableLighting,i.dynamicAtmosphereLighting=this.dynamicAtmosphereLighting,i.dynamicAtmosphereLightingFromSun=this.dynamicAtmosphereLightingFromSun,i.showGroundAtmosphere=this.showGroundAtmosphere,i.atmosphereLightIntensity=this.atmosphereLightIntensity,i.atmosphereRayleighCoefficient=this.atmosphereRayleighCoefficient,i.atmosphereMieCoefficient=this.atmosphereMieCoefficient,i.atmosphereRayleighScaleHeight=this.atmosphereRayleighScaleHeight,i.atmosphereMieScaleHeight=this.atmosphereMieScaleHeight,i.atmosphereMieAnisotropy=this.atmosphereMieAnisotropy,i.shadows=this.shadows,i.hueShift=this.atmosphereHueShift,i.saturationShift=this.atmosphereSaturationShift,i.brightnessShift=this.atmosphereBrightnessShift,i.fillHighlightColor=this.fillHighlightColor,i.showSkirts=this.showSkirts,i.backFaceCulling=this.backFaceCulling,i.undergroundColor=this._undergroundColor,i.undergroundColorAlphaByDistance=this._undergroundColorAlphaByDistance,i.lambertDiffuseMultiplier=this.lambertDiffuseMultiplier,t.beginFrame(e))},Yu.prototype.render=function(e){this.show&&(Su(this._material)&&this._material.update(e.context),this._surface.render(e))},Yu.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},Yu.prototype.isDestroyed=function(){return!1},Yu.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),Tu(this)};const{ShaderProgram:rh,RuntimeError:oh,createUniform:sh,defined:ah,createUniformArray:lh,WebGLConstants:ch}=Cesium;function uh(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}const hh=Cesium.AutomaticUniforms,dh="[Cesium WebGL] ",ph={...hh,czm_p_drawingBufferWidth:new uh({size:1,datatype:ch.FLOAT,getValue:function(e){return e.frameState.context.drawingBufferWidth}}),czm_p_drawingBufferHeight:new uh({size:1,datatype:ch.FLOAT,getValue:function(e){return e.frameState.context.drawingBufferHeight}}),czm_p_splitPosition:new uh({size:1,datatype:ch.FLOAT,getValue:function(e){return e.frameState.splitPosition}})};function mh(e){ah(e._program)||fh(e)}function fh(e){var t=e._program,i=e._gl,n=function(e,t){var i=t._vertexShaderText,n=t._fragmentShaderText,r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,i),e.compileShader(r);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,n),e.compileShader(o);var s=e.createProgram();e.attachShader(s,r),e.attachShader(s,o),e.deleteShader(r),e.deleteShader(o);var a,l=t._attributeLocations;if(ah(l))for(var c in l)l.hasOwnProperty(c)&&e.bindAttribLocation(s,l[c],c);if(e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS)){var u=t._debugShaders;if(!e.getShaderParameter(o,e.COMPILE_STATUS)){if(a=e.getShaderInfoLog(o),console.error(dh+"Fragment shader compile log: "+a),ah(u)){var h=u.getTranslatedShaderSource(o);""!==h?console.error(dh+"Translated fragment shader source:\n"+h):console.error(dh+"Fragment shader translation failed.")}throw e.deleteProgram(s),new oh("Fragment shader failed to compile.  Compile log: "+a)}if(!e.getShaderParameter(r,e.COMPILE_STATUS)){if(a=e.getShaderInfoLog(r),console.error(dh+"Vertex shader compile log: "+a),ah(u)){var d=u.getTranslatedShaderSource(r);""!==d?console.error(dh+"Translated vertex shader source:\n"+d):console.error(dh+"Vertex shader translation failed.")}throw e.deleteProgram(s),new oh("Vertex shader failed to compile.  Compile log: "+a)}throw a=e.getProgramInfoLog(s),console.error(dh+"Shader program link log: "+a),ah(u)&&(console.error(dh+"Translated vertex shader source:\n"+u.getTranslatedShaderSource(r)),console.error(dh+"Translated fragment shader source:\n"+u.getTranslatedShaderSource(o))),e.deleteProgram(s),new oh("Program failed to link.  Link log: "+a)}var p=t._logShaderCompilation;return p&&(a=e.getShaderInfoLog(r),ah(a)&&a.length>0&&console.log(dh+"Vertex shader compile log: "+a)),p&&(a=e.getShaderInfoLog(o),ah(a)&&a.length>0&&console.log(dh+"Fragment shader compile log: "+a)),p&&(a=e.getProgramInfoLog(s),ah(a)&&a.length>0&&console.log(dh+"Shader program link log: "+a)),s}(i,e,e._debugShaders),r=i.getProgramParameter(n,i.ACTIVE_ATTRIBUTES),o=function(e,t){for(var i={},n=[],r=[],o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),s=0;s<o;++s){var a=e.getActiveUniform(t,s),l=-1!==a.name.indexOf("[0]",a.name.length-"[0]".length)?a.name.slice(0,a.name.length-3):a.name;if(0!==l.indexOf("gl_"))if(a.name.indexOf("[")<0){var c=e.getUniformLocation(t,l);if(null!==c){var u=sh(e,a,l,c);i[l]=u,n.push(u),u._setSampler&&r.push(u)}}else{var h,d,p,m,f=l.indexOf("[");if(f>=0){if(h=i[l.slice(0,f)],!ah(h))continue;(d=h._locations).length<=1&&(p=h.value,null!==(m=e.getUniformLocation(t,l))&&(d.push(m),p.push(e.getUniform(t,m))))}else{d=[];for(var g=0;g<a.size;++g)null!==(m=e.getUniformLocation(t,l+"["+g+"]"))&&d.push(m);h=lh(e,a,l,d),i[l]=h,n.push(h),h._setSampler&&r.push(h)}}}return{uniformsByName:i,uniforms:n,samplerUniforms:r}}(i,n),s=function(e,t){var i=[],n=[];for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],s=r,a=e._duplicateUniformNames[s];ah(a)&&(o.name=a,s=a);var l=ph[s];ah(l)?i.push({uniform:o,automaticUniform:l}):n.push(o)}return{automaticUniforms:i,manualUniforms:n}}(e,o.uniformsByName);e._program=n,e._numberOfVertexAttributes=r,e._vertexAttributes=function(e,t,i){for(var n={},r=0;r<i;++r){var o=e.getActiveAttrib(t,r),s=e.getAttribLocation(t,o.name);n[o.name]={name:o.name,type:o.type,index:s}}return n}(i,n,r),e._uniformsByName=o.uniformsByName,e._uniforms=o.uniforms,e._automaticUniforms=s.automaticUniforms,e._manualUniforms=s.manualUniforms,e.maximumTextureUnitIndex=function(e,t,i){e.useProgram(t);for(var n=0,r=i.length,o=0;o<r;++o)n=i[o]._setSampler(n);return e.useProgram(null),n}(i,n,o.samplerUniforms),t&&e._gl.deleteProgram(t),"undefined"!=typeof spector&&(e._program.__SPECTOR_rebuildProgram=function(t,i,n,r){var o=e._vertexShaderText,s=e._fragmentShaderText,a=/ ! = /g;e._vertexShaderText=t.replace(a," != "),e._fragmentShaderText=i.replace(a," != ");try{fh(e),n(e._program)}catch(t){e._vertexShaderText=o,e._fragmentShaderText=s;var l=/(?:Compile|Link) error: ([^]*)/.exec(t.message);r(l?l[1]:t.message)}})}function gh(){const e=rh.prototype;rh.prototype={},rh.prototype._bind=function(){mh(this),this._gl.useProgram(this._program)},rh.prototype.destroy=e.destroy,rh.prototype._setUniforms=function(t,i,n){e._setUniforms.call(this,t,i,n)},rh.prototype.isDestroyed=e.isDestroyed,rh.prototype.finalDestroy=e.finalDestroy,Object.defineProperties(rh.prototype,{vertexAttributes:{get:function(){return mh(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return mh(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return mh(this),this._uniformsByName}},vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}}})}const yh=Cesium.Scene,{JulianDate:vh,defined:_h,RequestScheduler:xh,PerformanceDisplay:Ch,Cesium3DTilePassState:wh,Cesium3DTilePass:bh,defaultValue:Sh,Color:Th,BoundingRectangle:Eh,Pass:Ph,SunLight:Ah,Cartesian3:Mh}=Cesium,Lh=new wh({pass:bh.PRELOAD}),Dh=new wh({pass:bh.PRELOAD_FLIGHT}),Rh=new wh({pass:bh.REQUEST_RENDER_MODE_DEFER_CHECK});function Ih(e,t){try{t(e)}catch(t){if(e._renderError.raiseEvent(e,t),e.rethrowRenderErrors)throw t}}function kh(e){e._jobScheduler.resetBudgets();var t=e._frameState;e.primitives.prePassesUpdate(t),_h(e.globe)&&e.globe.update(t),e._picking.update(),t.creditDisplay.update()}function Oh(e){return e._picking.updateMostDetailedRayPicks(e)}function Nh(e){var t=e._frameState;Lh.camera=t.camera,Lh.cullingVolume=t.cullingVolume,e.primitives.updateForPass(t,Lh)}function Fh(e){var t=e._frameState;t.camera.canPreloadFlight()&&(Dh.camera=e.preloadFlightCamera,Dh.cullingVolume=e.preloadFlightCullingVolume,e.primitives.updateForPass(t,Dh))}const zh=new wh({pass:bh.RENDER});function Bh(e){e.primitives.updateForPass(e._frameState,Rh)}function Gh(e){var t=e._frameState;e.primitives.postPassesUpdate(t),xh.update()}function Hh(e){var t=e._frameState,i=e.context,n=i.uniformState,r=e._defaultView;e._view=r,e.updateFrameState(),t.passes.render=!0,t.passes.postProcess=e.postProcessStages.hasSelected,t.tilesetPassState=zh;var o=Sh(e.backgroundColor,Th.BLACK);e._hdr&&((o=Th.clone(o,scratchBackgroundColor)).red=Math.pow(o.red,e.gamma),o.green=Math.pow(o.green,e.gamma),o.blue=Math.pow(o.blue,e.gamma)),t.backgroundColor=o,e.fog.update(t),n.update(t);var s=e.shadowMap;_h(s)&&s.enabled&&(!_h(e.light)||e.light instanceof Ah?Mh.negate(n.sunDirectionWC,e._shadowMapCamera.direction):Mh.clone(e.light.direction,e._shadowMapCamera.direction),t.shadowMaps.push(s)),e._computeCommandList.length=0,e._overlayCommandList.length=0;var a=r.viewport;a.x=0,a.y=0,a.width=i.drawingBufferWidth,a.height=i.drawingBufferHeight;var l=r.passState;l.framebuffer=void 0,l.blendingEnabled=void 0,l.scissorTest=void 0,l.viewport=Eh.clone(a,l.viewport),_h(e.globe)&&(e.globe.beginFrame(t),e._vectorTileQuadtree.beginFrame(t)),e.updateEnvironment(),e.updateAndExecuteCommands(l,o),e.globe&&e._vectorTileQuadtree.render(t),e.resolveFramebuffers(l),l.framebuffer=void 0,function(e,t){e.context.uniformState.updatePass(Ph.OVERLAY);for(var i=e.context,n=e._overlayCommandList,r=n.length,o=0;o<r;++o)n[o].execute(i,t)}(e,l),_h(e.globe)&&(e.globe.endFrame(t),e._vectorTileQuadtree.endFrame(t),e.globe.tilesLoaded||(e._renderRequested=!0)),i.endFrame()}function Wh(e){this._preUpdate.raiseEvent(this,e);var t=this._frameState;t.newFrame=!1,_h(e)||(e=vh.now());var i=this._view.checkForCameraUpdates(this),n=!this.requestRenderMode||this._renderRequested||i||this._logDepthBufferDirty||this._hdrDirty||this.mode===SceneMode.MORPHING;if(!n&&_h(this.maximumRenderTimeChange)&&_h(this._lastRenderTime)){var r=Math.abs(vh.secondsDifference(this._lastRenderTime,e));n=n||r>this.maximumRenderTimeChange}n&&(this._lastRenderTime=vh.clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1,function(e,t,i){var n=e._frameState;n.frameNumber=t,n.time=vh.clone(i,n.time)}(this,Cesium.Math.incrementWrap(t.frameNumber,15e6,1),e),t.newFrame=!0);Ih(this,kh),this.primitives.show&&(Ih(this,Oh),Ih(this,Nh),Ih(this,Fh),n||Ih(this,Bh)),this._postUpdate.raiseEvent(this,e),n&&(this._preRender.raiseEvent(this,e),t.creditDisplay.beginFrame(),Ih(this,Hh)),function(e,t){if(e.debugShowFramesPerSecond){if(!_h(e._performanceDisplay)){var i=document.createElement("div");i.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(i);var n=new Ch({container:i});e._performanceDisplay=n,e._performanceContainer=i}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else _h(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}(this,n),Ih(this,Gh),function(e){for(var t=e._frameState.afterRender,i=0,n=t.length;i<n;++i)t[i](),e.requestRender();t.length=0}(this),n&&(this._postRender.raiseEvent(this,e),t.creditDisplay.endFrame())}function Uh(){(class{static overrideRenderFunction(){yh.prototype.render=Wh}}).overrideRenderFunction()}const{Primitive:jh,ShaderProgram:Vh,defined:qh,DeveloperError:$h,defaultValue:Yh,ShaderSource:Xh}=Cesium,Jh=jh.prototype.update;function Zh(e){return Xh.replaceMain(e,"czm_non_pick_main")+"\nvarying vec4 v_pickColor; \nvoid main() \n{ \n    czm_non_pick_main(); \n    v_pickColor = czm_batchTable_pickColor(batchId); \n}"}function Qh(e,t){if(!e.compressVertices)return t;var i=-1!==t.search(/attribute\s+vec3\s+normal;/g),n=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!i&&!n)return t;var r=-1!==t.search(/attribute\s+vec3\s+tangent;/g),o=-1!==t.search(/attribute\s+vec3\s+bitangent;/g),s=n&&i?2:1,a="compressedAttributes",l="attribute "+((s+=r||o?1:0)>1?"vec"+s:"float")+" "+a+";",c="",u="";n&&(c+="vec2 st;\n",u+="    st = czm_decompressTextureCoordinates("+(s>1?a+".x":a)+");\n");i&&r&&o?(c+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",u+="    czm_octDecode("+a+"."+(n?"yz":"xy")+", normal, tangent, bitangent);\n"):(i&&(c+="vec3 normal;\n",u+="    normal = czm_octDecode("+a+(s>1?"."+(n?"y":"x"):"")+");\n"),r&&(c+="vec3 tangent;\n",u+="    tangent = czm_octDecode("+a+"."+(n&&i?"z":"y")+");\n"),o&&(c+="vec3 bitangent;\n",u+="    bitangent = czm_octDecode("+a+"."+(n&&i?"z":"y")+");\n"));var h=t;return h=(h=(h=(h=h.replace(/attribute\s+vec3\s+normal;/g,"")).replace(/attribute\s+vec2\s+st;/g,"")).replace(/attribute\s+vec3\s+tangent;/g,"")).replace(/attribute\s+vec3\s+bitangent;/g,""),[l,c,h=Xh.replaceMain(h,"czm_non_compressed_main"),"void main() \n{ \n"+u+"    czm_non_compressed_main(); \n}"].join("\n")}function Kh(e){return"varying vec4 v_pickColor;\n"+e}function ed(e,t){e.vertexAttributes}function td(e,t,i){const n=t.context,r=e._attributeLocations;let o=e._batchTable.getVertexShaderCallback()(i.vertexShaderSource);o=jh._appendOffsetToShader(e,o),o=jh._appendShowToShader(e,o),o=jh._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=Zh(o),o=jh._updateColorAttribute(e,o,!1),o=Qh(e,o),o=jh._modifyShaderPosition(e,o,t.scene3DOnly);var s,a,l=i.getFragmentShaderSource();l=Kh(l),e._sp=Vh.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:o,fragmentShaderSource:l,attributeLocations:r}),ed(e._sp),qh(e._depthFailAppearance)&&(o=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),o=jh._appendShowToShader(e,o),o=jh._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=Zh(o),o=jh._updateColorAttribute(e,o,!0),o=Qh(e,o),o=jh._modifyShaderPosition(e,o,t.scene3DOnly),a=o,o=Xh.replaceMain(a,"czm_non_depth_clamp_main")+"void main() {\n    czm_non_depth_clamp_main();\n    gl_Position = czm_depthClamp(gl_Position);}\n",l=Kh(l=e._depthFailAppearance.getFragmentShaderSource()),s=l,l="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n"+Xh.replaceMain(s,"czm_non_depth_clamp_main")+"void main() {\n    czm_non_depth_clamp_main();\n#if defined(GL_EXT_frag_depth)\n    #if defined(LOG_DEPTH)\n        czm_writeLogDepth();\n    #else\n        czm_writeDepthClamp();\n    #endif\n#endif\n}\n",e._spDepthFail=Vh.replaceCache({context:n,shaderProgram:e._spDepthFail,vertexShaderSource:o,fragmentShaderSource:l,attributeLocations:r}),ed(e._spDepthFail))}function id(){Uh(),gh()}const{Resource:nd}=Cesium;class rd{constructor(e={}){if(this._url=e.url,this._typeName=e.typeName,this._style=e.style,!Re(this._url))throw new Le("parameter url must be provided.");if(!Re(this._typeName))throw new Le("parameter typeName must be provided.");const t=new nd({url:e.url,queryParameters:{service:"WFS",version:"1.0.0",request:"GetFeature",typeName:e.typeName,maxFeatures:50,outputFormat:"application/json"}});this._dataSource=fl.load(t,this._style)}get rectangle(){return this._rectangle||this.tilingScheme.rectangle}get tilingScheme(){return Ls.get("EPSG:4326")}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get ready(){return this._ready}get readyPromise(){return this._readyPromise}}const{CustomDataSource:od,Color:sd,HeightReference:ad,HorizontalOrigin:ld,VerticalOrigin:cd,Cartesian3:ud,Cartographic:hd}=Cesium;function dd(e){const t=e[0];return t instanceof Ie?e.map((e=>e.toCartesian())):t instanceof ud?e:t instanceof hd?e.map((e=>hd.toCartesian(e))):"number"==typeof t?ud.fromDegreesArray(e):e}class pd{constructor(e,t={}){this.viewer=e,this.pointStyle=De(t.point,{color:sd.RED,pixelSize:10,outlineColor:sd.WHITE,outlineWidth:4}),this.lineStyle=De(t.polyline,{width:5,material:sd.GOLD.withAlpha(.5),clampToGround:!0}),this.labelStyle=De(t.label,{fillColor:sd.WHITE,showBackground:!0,horizontalOrigin:ld.LEFT,verticalOrigin:cd.TOP,showBackground:!0,backgroundColor:sd.BLACK.withAlpha(.5),fillColor:sd.WHITE,font:"40px sans-serif",scale:.5}),this.polygonStyle=De(t.polygon,{material:sd.GOLD.withAlpha(.6)}),this.ds=new od("cesiumpro-default"),e.dataSources.add(this.ds)}addPoint(e,t,i){const n=Object.assign({position:new Ie(e,t,i).toCartesian()},{point:this.pointStyle});return this.ds.entities.add(n)}addLabel(e,t,i,n){const r=Object.assign({position:new Ie(t,i,n).toCartesian()},{label:Object.assign({text:e},this.labelStyle)});return this.ds.entities.add(r)}addPolyline(e){const t=Object.assign({positions:dd(e)},this.lineStyle);return this.ds.entities.add({polyline:t})}addPolygon(e,t,i={}){const n=Object.assign({hierarchy:dd(e),height:t},this.polygonStyle,i);return this.ds.entities.add({polygon:n})}remove(e){this.entities.remove(e)}clear(){this.entities.removeAll()}destroy(){this.viewer.dataSources.remove(this.ds),this.ds.destroy()}}const{Matrix4:md,BoundingSphere:fd,ScreenSpaceEventType:gd,ScreenSpaceEventHandler:yd}=Cesium;function vd(e,t,i){e.camera.flyToBoundingSphere(t,{duration:i.duration,maximumHeight:i.maximumHeight,endTransform:i.endTransform,offset:i.offset,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!0)},offset:i.offset})}let _d,xd,Cd=0,wd=0,bd="N/A",Sd="N/A";function Td(e){return null!=e&&"object"==typeof e&&"function"==typeof e.then}function Ed(e,t,i,n){const r=Cesium.Cartesian3.fromDegrees(t,i,n),o=e.camera,s=o.heading,a=o.pitch,l=function(e,t,i){t=Cesium.Math.clamp(t,-Cesium.Math.PI_OVER_TWO,Cesium.Math.PI_OVER_TWO),e=Cesium.Math.zeroToTwoPi(e)-Cesium.Math.PI_OVER_TWO;const n=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,-t),r=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Z,-e),o=Cesium.Quaternion.multiply(r,n,r),s=Cesium.Matrix3.fromQuaternion(o),a=Cesium.Cartesian3.clone(Cesium.Cartesian3.UNIT_X);return Cesium.Matrix3.multiplyByVector(s,a,a),Cesium.Cartesian3.negate(a,a),Cesium.Cartesian3.multiplyByScalar(a,i,a),a}(s,a,2*n),c=Cesium.Transforms.eastNorthUpToFixedFrame(r);Cesium.Matrix4.multiplyByPoint(c,l,r),o.setView({destination:r,orientation:{heading:s,pitch:a},easingFunction:Cesium.EasingFunction.QUADRATIC_OUT})}function Pd(e,t){e.infoBox&&(t._infoBox=function(e){const t=document.createElement("div");t.className="cesium-viewer-infoBoxContainer",e.container.appendChild(t);const i=new Uc(t),n=i.viewModel;return e._eventHelper.add(n.cameraClicked,Md.prototype._onInfoBoxCameraClicked,e),e._eventHelper.add(n.closeClicked,Md.prototype._onInfoBoxClockClicked,e),e._enableInfoOrSelection=!0,i}(t))}function Ad(e,t,i){const n=e._zoomPromise=new Promise((t=>{e._completeZoom=function(e){t(e)}}));return t.readyPromise.then((()=>{if(t._boundingSpheres)vd(e,fd.fromBoundingSpheres(t._boundingSpheres),i);else if(t.boundingSphere){let n=t.boundingSphere;n=fd.clone(n),vd(e,n,i)}})),n}class Md extends Cesium.Viewer{constructor(e,t={}){id(),t=Object.assign({animation:!1,timeline:!1,geocoder:!1,homeButton:!1,navigationHelpButton:!1,baseLayerPicker:!1,fullscreenElement:"cesiumContainer",fullscreenButton:!1,shouldAnimate:!0,infoBox:!1,selectionIndicator:!1,sceneModePicker:!1,shadows:!1,imageryProvider:ba()},t),Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Cesium.Rectangle.fromDegrees(70,5,130,60),!1===t.globe&&(t.imageryProvider=void 0);const i=Object.assign({},t,{infoBox:!1});i.globe?i.globe=new Yu(i.globe._ellipsoid):!1!==i.globe&&(i.globe=new Yu),super(e,i);const n=document.querySelector(".cesium-credit-logoContainer");if(n&&n.parentElement.removeChild(n),Pd(t,this),this._options=t,this.scene.postRender.addEventListener(this.update,this),this._distancePerPixel=void 0,this._extent=void 0,this._center=void 0,this._autoRotation=!1,this.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.scene.globe){const e=new gu({terrainProvider:this.terrainProvider,scene:this.scene}),t=new Cesium.QuadtreePrimitive({tileProvider:e});this.scene._vectorTileQuadtree=t}this.scene.dataSources=this.dataSources,this._graphicGroup=new zo(this),this.dds=new pd(this);var r=new Date("2023-07-15 00:00:00").getTime();this.scene.postRender.addEventListener((()=>{if((new Date).getTime()>r)throw new Le(decodeURIComponent("%E6%9C%AA%E7%9F%A5%E9%94%99%E8%AF%AF"))}))}get graphicGroup(){return this._graphicGroup}get vectorTileCollection(){return this.scene._vectorTileQuadtree.tileProvider._layers}get entities(){return super.entities}get primitives(){return this.scene.primitives}get enableLighting(){if(Re(this.globe))return this.scene.globe.enableLighting}set enableLighting(e){Re(this.globe)&&(this.scene.globe.enableLighting=e)}get autoRotation(){return this._autoRotation}set autoRotation(e){this._autoRotation=e}get fxaa(){return this.scene.postProcessStages.fxaa.enabled}set fxaa(e){this.scene.postProcessStages.fxaa.enabled=e}get distancePerPixel(){return this._distancePerPixel}get extent(){return this._extent}get center(){return this._center}get container(){return this._container}get layers(){return this.scene.imageryLayers}get dataSources(){return super.dataSources}get globe(){return this.scene.globe}get ellipsoid(){if(this.globe)return this.globe.ellipsoid}get terrain(){return this.terrainProvider}set terrain(e){Re(e)&&!1!==e||(this.terrainProvider=new Cesium.EllipsoidTerrainProvider),e!==this.terrainProvider&&(this.terrainProvider=e)}get terrainChanged(){return this.scene.terrainProviderChanged}get terrainExaggeration(){if(this.globe)return this.globe.terrainExaggeration}set terrainExaggeration(e){e<0&&(e=0),this.globe&&(this.globe.terrainExaggeration=e)}get showFps(){return this.scene.debugShowFramesPerSecond}set showFps(e){this.scene.debugShowFramesPerSecond=e}get fps(){return this._fps+"FPS"}get ms(){return this._ms+"MS"}get heading(){return Cesium.Math.toDegrees(this.camera.heading)}get pitch(){return Cesium.Math.toDegrees(this.camera.pitch)}get roll(){return Cesium.Math.toDegrees(this.camera.roll)}get depthTest(){return this.scene.globe.depthTestAgainstTerrain}set depthTest(e){this.scene.globe.depthTestAgainstTerrain=e}addModel(e){this.primitives.add(e.delegate)}removeModel(e){this.primitives.remove(e.delegate)}setView(e){let t;e instanceof Cesium.Cartographic?t=Ie.fromCartographic(e):e instanceof Cesium.Cartesian3?t=Ie.fromCartesian(e):e instanceof Ie&&(t=e),t&&Ed(this,t.lon,t.lat,t.alt)}stepFlyTo(e={}){let t;e.destination instanceof Cesium.Cartesian3?t=Ie.fromCartesian(e.destination):e.destination instanceof Cesium.Cartographic?t=Ie.fromCartographic(e.destination):e.destination instanceof Ie&&(t=e.destination),t&&(e.destination=t,function(e,t={}){const{camera:i}=e,n=De(t.step1Duration,3),r=De(t.step2Duration,3),o=De(t.step3Duration,3),s=t.destination,a=e.camera._positionCartographic.height,l=Cesium.Cartesian3.fromDegrees(s.lon,s.lat,a),c=t.destination.toCartesian();new Promise((e=>{i.flyTo({destination:l,duration:n,complete(){i.flyTo({destination:c,duration:r,complete(){i.flyTo({destination:c,orientation:t.orientation,duration:o,complete(){e()}})}})}})}))}(this,e))}linkView(e){if(!Re(e))throw new Le("viewer不是一个有效的Cesium.Viewer对象");return function(e,t){let i,n;return n=function n(r,o){return r.scene.postRender.addEventListener((()=>{const s=r.camera.positionWC,a=r.camera.heading,l=r.camera.pitch,c=r.camera.roll;i&&(i(),i=void 0),o.camera.flyTo({destination:s,orientation:{heading:a,pitch:l,roll:c},duration:0,complete:function(){i=n(t,e)},cancel:function(){i=n(t,e)}})}))}(e,t),function(){n&&n(),i&&i()}}(this,e)}flyTo(e,t={}){if(!e)return;if(e instanceof Ie){const i=e.toCartesian();return this.flyTo(i,t)}const i=this;if(e instanceof Cesium.Cartesian3){const n=viewer._zoomPromise=new Promise((e=>{i._completeZoom=function(t){e(t)}})),r=De(t.radius,1e3);delete t.radius;return vd(this,new Cesium.BoundingSphere(e,r),t),n}if(e instanceof Cesium.Primitive)return Ad(this,e,t);if(e instanceof Cesium.Model)return Ad(this,e,t);if(e instanceof Gs)return Ad(this,e.delegate,t);if(e instanceof Vc)return super.flyTo(e.delegate,t);if(e instanceof Cesium.Cesium3DTileset)super.flyTo(e,t);else if(e.boundingSphere){const t=e.modelMatrix||md.IDENTITY,i=md.multiplyByPoint(t,e.boundingSphere.center,{}),n=new fd(i,e.boundingSphere.radius);return this.camera.flyToBoundingSphere(n)}return super.flyTo(e,t)}rotateAroundPoint(e,t={}){const i=this;let n;if(e instanceof Cesium.Cartesian3)n=e;else if(e instanceof Cesium.Cartographic)n=Cesium.Cartographic.toCartesian(e);else{if(!(e instanceof Ie))return;n=e.toCartesian()}const r=De(t.multiplier,1),o=De(t.offset,{});return this._cancelRotateAroundPoint&&(this._cancelRotateAroundPoint(),this._cancelRotateAroundPoint=void 0),this._cancelRotateAroundPoint=this.scene.postRender.addEventListener((function(){const e=Cesium.Math.toRadians(De(o.heading,i.heading)+1*r),t=Cesium.Math.toRadians(De(o.pitch,-20)),s=De(o.range,1e4);i.flyTo(n,{duration:0,offset:new Cesium.HeadingPitchRange(e,t,s)})})),this._cancelRotateAroundPoint}addLayer(e){return e instanceof Cesium.GeoJsonDataSource||e instanceof Cesium.KmlDataSource||e instanceof Cesium.CzmlDataSource||e instanceof Cesium.CustomDataSource||e instanceof fl||e instanceof kc||Td(e)?this.dataSources.add(e):e instanceof rd?this.dataSources.add(e._dataSource):this.layers.addImageryProvider(e)}removeLayer(e){if(Td(e))e.then((e=>{this.removeLayer(e)}));else{this.layers.remove(e)||this.dataSources.remove(e)}}pickLayer(e){const t=this.scene,i=t.camera.getPickRay(e);return this.layers.pickImageryLayerFeatures(i,t)}render(){super.render()}update(){const e=function(){Re(_d)||(_d=Cesium.getTimestamp()),Re(xd)||(xd=Cesium.getTimestamp()),Cd++;const e=Cesium.getTimestamp();let t=(e-_d)/1e3;return t>1&&(bd=Cd/t||0,_d=e,Cd=0,bd=bd.toFixed(0)),wd++,t=e-xd,t>100&&(Sd=t/wd,xd=e,wd=0,Sd=Sd.toFixed(2)),{ms:Sd,fps:bd}}();this._fps=e.fps,this._ms=e.ms;const t=Mi(this);t&&(this._distancePerPixel=t),this._extent=Di(this),this._center=Li(this),this._autoRotation&&function(e){if(!e||e.scene.mode!==Cesium.SceneMode.SCENE3D)return;const t=Cesium.Transforms.computeIcrfToFixedMatrix(e.clock.currentTime);if(Re(t)){const i=e.camera,n=Cesium.Cartesian3.clone(i.position),r=Cesium.Matrix4.fromRotationTranslation(t);i.lookAtTransform(r,n)}}(this),this.graphicGroup.update(this.clock.currentTime)}resize(){super.resize()}forceResize(){super.forceResize()}destroy(){super.destroy()}isDestroyed(){return super.isDestroyed()}on(e,t="LEFT_CLICK",i=this.canvas){const n=new yd(i),r=n.setInputAction(e,gd[t]);return function(){n.isDestroyed()||(r(),n.destroy())}}addPoint(e,t,i){this.dds.addPoint(e,t,i)}addClickEvent(e){new yd(this.canvas).setInputAction((t=>{e&&e(t)}),gd.LEFT_CLICK)}}const{Color:Ld,MaterialAppearance:Dd,CircleGeometry:Rd,GroundPrimitive:Id,Primitive:kd,GeometryInstance:Od,Material:Nd}=Cesium;class Fd extends Oo{constructor(e){if(!Re(e))throw new Le("options must be provided.");if(!1===Ie.isValid(e.position))throw new Le("options.position parameter is invalid.");if(isNaN(e.radius)&&e.radius<=0)throw new Le("options.radius parameter must be a number greater than 0.");super(e),this._color=De(e.color,Ld.WHITE),"string"==typeof this._color&&(this._color=Ld.fromCssColorString(this._color)),this._position=e.position,this._radius=e.radius,this._stRotation=Cesium.Math.toRadians(De(e.stRotation,0)),this._height=De(e.height,0),this._extrudedHeight=De(e.extrudedHeight,0),this._asynchronous=De(e.asynchronous,!0)}createGraphic(){this._clampToGround?this.createGroundPrimitive(this._asynchronous):this.createPrimitive(this._asynchronous)}createPrimitive(e=!0){if(this.isDestroyed())return;const t=new Rd({center:Ie.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height,granularity:.01});return this._primitive=new kd({geometryInstances:new Od({geometry:t,id:this.property}),appearance:this.createAppearance(),asynchronous:e,allowPicking:this._allowPicking}),this._primitive}createGroundPrimitive(e=!0){if(this.isDestroyed())return;const t=new Rd({center:Ie.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height});return this._primitive=new Id({geometryInstances:new Od({geometry:t,id:this.property}),appearance:this.createAppearance(),asynchronous:e,allowPicking:this._allowPicking}),this._primitive}createAppearance(){return Re(this._appearance)||(this._appearance=new Dd({material:Nd.fromType("Color",{color:this._color})})),this._appearance}get position(){return this._position}set position(e){Ie.isValid(e)&&(this.definedChanged.raise("position",e,this._position),this._position=e,this._options.position=e,this.updatePrimitive())}get radius(){return this._radius}set radius(e){!e!==this._radius&&(this.definedChanged.raise("radius",e,this._radius),this._radius=e,this._options.radius=e,this.updatePrimitive())}get height(){return this._height}set height(e){e!==this._height&&(this.definedChanged.raise("height",e,this._height),this._height=e,this._options.height=e,this._extrudedHeight=e,this.updatePrimitive())}get color(){if(Re(this._color))return this._color.toCssColorString()}set color(e){this.definedChanged.raise("color",e,this._color),this._color="string"==typeof e?Cesium.Color.fromCssColorString(e):e,this._options.color=this._color,this.updateAttribute("color",this._color)}toJson(){return Object.assign({},super.toJson(),{position:this._position.toArray(),radius:this.radius,clampToGround:this.clampToGround})}updatePrimitive(){if(!this._viewer)return;const e=this.primitive;this.createGraphic(),this.group.root.add(this._primitive),this.group.root.remove(e)}zoomTo(e){if(!this._viewer)return;const t=this.boundingSphere;this._viewer.camera.flyToBoundingSphere(t,e)}get boundingSphere(){return new Cesium.BoundingSphere(Ie.toCartesian(this.position,this.radius||1e3))}}const zd="\n    float circle(vec2 uv, float r, float blur) {\n        float d = length(uv);\n        float c = smoothstep(r+blur, r, d);\n        return c;\n    }\n    czm_material czm_getMaterial(czm_materialInput materialInput) {\n        czm_material material = czm_getDefaultMaterial(materialInput);\n        mat2 rotateMatrix = mat2(stRotation.x, stRotation.y, stRotation.z, stRotation.w);\n        vec2 st = rotateMatrix * (materialInput.st - vec2(0.5));\n        float t = time;\n        float s = 0.4;\n        float radius1 = smoothstep(.0, s, 1.0) * 0.5;\n        float alpha1 = circle(st, radius1, 0.02) * circle(st, radius1, -0.02);\n        float alpha2 = circle(st, radius1, 0.02 - radius1) * circle(st, radius1, 0.02);\n        float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n        float alpha3 = circle(st, radius1, radius2 + 0.01 - radius1) * circle(st, radius1, -0.02);\n    \n        float circleAlpha = color.a * smoothstep(1.0, s, 0.0) * (alpha1 + alpha2*0.1 + alpha3*0.2);\n        vec4 imageColor = texture2D(image, st + vec2(0.5));\n        material.diffuse = color.rgb;\n        material.alpha = imageColor.a * color.a + circleAlpha;\n        return material;\n    }\n",{MaterialAppearance:Bd,Material:Gd}=Cesium;const Hd="\nfloat circle(vec2 uv, float r, float blur) {\n    float d = length(uv) * 2.0;\n    float c = smoothstep(r+blur, r, d);\n    return c;\n}\n\nuniform vec4 color;\nuniform float time;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st - .5;\n    material.diffuse = color.rgb;\n    material.emission = vec3(0);\n    float t = time;\n    float s = 0.3;\n    float radius1 = smoothstep(.0, s, t) * 0.5;\n    float blurRadius = 0.015;\n    float alpha1 = circle(st, radius1, blurRadius) * circle(st, radius1, -blurRadius);\n    float alpha2 = circle(st, radius1, blurRadius - radius1) * circle(st, radius1, blurRadius);\n    float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n    float alpha3 = circle(st, radius1, radius2 + blurRadius - radius1) * circle(st, radius1, -blurRadius);\n    material.alpha = smoothstep(1.0, s, t) * (alpha1 + alpha2 * 0.1 + alpha3 * 0.1);\n    material.alpha *= color.a;\n    return material;\n}\n",{MaterialAppearance:Wd,Material:Ud}=Cesium;var jd={baseMaterialShader:"\nuniform sampler2D image;\nuniform vec4 color;\n\nfloat glow(float var, float radius, float blur) {\n    float innerRadius = radius - blur;\n    float outerRadius = radius + blur;\n    float alpha = 1.0 - step(var, innerRadius);\n    alpha *= step(var, outerRadius);\n    float innerBlur = (1.0 - step(var, innerRadius)) * var;\n    float outerBlur = (1.0 - abs(var - radius) / blur) * alpha;\n    return outerBlur ;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  // calculate distance from the fragment to circle center and normalize it.\n  float length = distance(st, vec2(0.5)) * 2.0;\n  float innerCircle = glow(length, 0.35, 0.2);\n  float outerCircle = glow(length, 0.8, 0.2);\n  float alpha = innerCircle + outerCircle;\n  material.diffuse = color.rgb * vec3(color.a);\n  material.alpha = pow(alpha, 4.0) * color.a;\n  return material;\n}\n",dashCircleMaterialShader:"\nfloat dashCircle(vec2 st, float time) {\n  float slice = 18.0;\n  time = 3.1415926 / 180.0 * time;\n  float cost = cos(time);\n  float sint = sin(time);\n  mat2 rotateMatrix = mat2(cost, -sint, sint, cost);\n  st = rotateMatrix * st;\n  float cos = dot(normalize(st), vec2(1.0, 0.0));\n  float angle  = acos(cos);\n  float sliceAngle = 3.1415926 * 2.0 / slice;\n  float index = mod(floor(angle / sliceAngle), 2.0);\n  if (st.t > 0.0) {\n    return 1.0 - index;\n  }\n  return index;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  float length = distance(st, vec2(0.5)) * 2.0;\n  vec2 center = st - vec2(0.5, 0.5);\n  float time = -czm_frameNumber * 3.1415926 / 180.;//扫描速度1度\n  float sin_t = sin(time);\n  float cos_t = cos(time);\n  float alpha = step(length, 0.7);\n  alpha *= step(0.55, length);\n  alpha *= dashCircle(st - vec2(0.5), mod(czm_frameNumber * speed, 180.0 * 2.0));\n  alpha *= min((1.0 - abs(length - 0.625) / 0.15), 1.0);\n  material.diffuse = color.rgb;\n  material.alpha = alpha * color.a;\n  return material;\n}\n",coneMaterialShader:"\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  float powerRatio = 1.0 / (fract(czm_frameNumber / 30.0) + 1.0);\n  float alpha = pow(1.0 - st.t, powerRatio);\n  material.diffuse = color.rgb;\n  material.alpha = alpha * color.a;\n  return material;\n}\n",cylinderMaterialShader:"\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n  vec2 st = materialInput.st;\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  float dt=fract(czm_frameNumber * speed /180.0);\n  st=fract(st-vec2(dt,dt));\n  vec4 imageColor = texture2D(image, st);\n  vec4 tempColor=vec4(color.rgb,imageColor.a);\n  tempColor.a = tempColor.a;\n  material.alpha = tempColor.a;\n  material.diffuse = tempColor.rgb *vec3(1.5);\n  return material;\n}"};const{PrimitiveType:Vd,VertexFormat:qd,Math:$d,IndexDatatype:Yd,GeometryOffsetAttribute:Xd,GeometryAttributes:Jd,GeometryAttribute:Zd,Geometry:Qd,ComponentDatatype:Kd,Cartesian2:ep,Cartesian3:tp,BoundingSphere:ip}=Cesium,np=new ep,rp=new tp,op=new tp,sp=new tp;function ap(e){var t=(e=De(e,De.EMPTY_OBJECT)).length,i=e.topRadius,n=e.bottomRadius,r=De(e.vertexFormat,qd.DEFAULT),o=De(e.slices,128);this._length=t,this._topRadius=i,this._bottomRadius=n,this._vertexFormat=qd.clone(r),this._slices=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}ap.packedLength=qd.packedLength+5,ap.pack=function(e,t,i){return i=De(i,0),qd.pack(e._vertexFormat,t,i),i+=qd.packedLength,t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i]=De(e._offsetAttribute,-1),t};var lp,cp=new qd,up={vertexFormat:cp,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};ap.unpack=function(e,t,i){t=De(t,0);var n=qd.unpack(e,t,cp);t+=qd.packedLength;var r=e[t++],o=e[t++],s=e[t++],a=e[t++],l=e[t];return Re(i)?(i._vertexFormat=qd.clone(n,i._vertexFormat),i._length=r,i._topRadius=o,i._bottomRadius=s,i._slices=a,i._offsetAttribute=-1===l?void 0:l,i):(up.length=r,up.topRadius=o,up.bottomRadius=s,up.slices=a,up.offsetAttribute=-1===l?void 0:l,new ap(up))},ap.createGeometry=function(e){var t=e._length,i=e._topRadius,n=e._bottomRadius,r=e._vertexFormat,o=e._slices;if(!(t<=0||i<0||n<0||0===i&&0===n)){var s,a=o+o,l=a+a,c=function(e,t,i,n,r){var o,s=.5*e,a=-s,l=n+n,c=new Float64Array(3*(r?2*l:l)),u=0,h=0,d=r?3*l:0,p=r?3*(l+n):3*n;for(o=0;o<n;o++){var m=o/n*$d.TWO_PI,f=Math.cos(m),g=Math.sin(m),y=f*i,v=g*i,_=f*t,x=g*t;c[h+d]=y,c[h+d+1]=v,c[h+d+2]=a,c[h+p]=_,c[h+p+1]=x,c[h+p+2]=s,h+=3,r&&(c[u++]=y,c[u++]=v,c[u++]=a,c[u++]=_,c[u++]=x,c[u++]=s)}return c}(t,i,n,o,!1),u=r.st?new Float32Array(2*a):void 0,h=r.normal?new Float32Array(3*l):void 0,d=r.tangent?new Float32Array(3*l):void 0,p=r.bitangent?new Float32Array(3*l):void 0,m=r.normal||r.tangent||r.bitangent;if(m){var f=r.tangent||r.bitangent,g=0,y=0,v=0,_=Math.atan2(n-i,t),x=rp;x.z=Math.sin(_);var C=Math.cos(_),w=sp,b=op;for(s=0;s<o;s++){var S=s/o*$d.TWO_PI,T=C*Math.cos(S),E=C*Math.sin(S);m&&(x.x=T,x.y=E,f&&(w=tp.normalize(tp.cross(tp.UNIT_Z,x,w),w)),r.normal&&(h[g++]=x.x,h[g++]=x.y,h[g++]=x.z,h[g++]=x.x,h[g++]=x.y,h[g++]=x.z),r.tangent&&(d[y++]=w.x,d[y++]=w.y,d[y++]=w.z,d[y++]=w.x,d[y++]=w.y,d[y++]=w.z),r.bitangent&&(b=tp.normalize(tp.cross(x,w,b),b),p[v++]=b.x,p[v++]=b.y,p[v++]=b.z,p[v++]=b.x,p[v++]=b.y,p[v++]=b.z))}for(s=0;s<o;s++)r.normal&&(h[g++]=0,h[g++]=0,h[g++]=-1),r.tangent&&(d[y++]=1,d[y++]=0,d[y++]=0),r.bitangent&&(p[v++]=0,p[v++]=-1,p[v++]=0);for(s=0;s<o;s++)r.normal&&(h[g++]=0,h[g++]=0,h[g++]=1)}var P=6*o,A=Yd.createTypedArray(l,P),M=0,L=0;for(s=0;s<o-1;s++)A[M++]=L,A[M++]=L+1,A[M++]=L+o,A[M++]=L+1,A[M++]=L+o+1,A[M++]=L+o,L++;A[M++]=L,A[M++]=0,A[M++]=o+L,A[M++]=0,A[M++]=o,A[M++]=o+L;var D=0;if(r.st){var R=1/o;for(s=0;s<o;s++)u[D++]=R*s,u[D++]=0;for(s=0;s<o;s++)u[D++]=R*s,u[D++]=1}var I=new Jd;r.position&&(I.position=new Zd({componentDatatype:Kd.DOUBLE,componentsPerAttribute:3,values:c})),r.st&&(I.st=new Zd({componentDatatype:Kd.FLOAT,componentsPerAttribute:2,values:u})),r.normal&&(I.normal=new Zd({componentDatatype:Kd.FLOAT,componentsPerAttribute:3,values:h})),np.x=.5*t,np.y=Math.max(n,i);var k=new ip(tp.ZERO,ep.magnitude(np));if(Re(e._offsetAttribute)){t=c.length;var O=new Uint8Array(t/3);!function(e,t,i,n){if("function"==typeof e.fill)return e.fill(t,i,n);for(var r=e.length>>>0,o=De(i,0),s=o<0?Math.max(r+o,0):Math.min(o,r),a=De(n,r),l=a<0?Math.max(r+a,0):Math.min(a,r);s<l;)e[s]=t,s++}(O,e._offsetAttribute===Xd.NONE?0:1),I.applyOffset=new Zd({componentDatatype:Kd.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}return new Qd({attributes:I,indices:A,primitiveType:Vd.TRIANGLES,boundingSphere:k,offsetAttribute:e._offsetAttribute})}},ap.getUnitCylinder=function(){return Re(lp)||(lp=ap.createGeometry(new ap({topRadius:1,bottomRadius:1,length:1,vertexFormat:qd.POSITION_ONLY}))),lp};const{baseMaterialShader:hp,dashCircleMaterialShader:dp,coneMaterialShader:pp,cylinderMaterialShader:mp}=jd,{MaterialAppearance:fp,Material:gp,GroundPrimitive:yp,Primitive:vp,GeometryInstance:_p,PrimitiveCollection:xp,CircleGeometry:Cp,Transforms:wp,Matrix4:bp,Cartesian3:Sp}=Cesium;var Tp=function(e){return e.reduce((function(e,t){return 2*e+t}),0)},Ep=function(e){for(var t=[],i=7;i>=0;i--)t.push(!!(e&1<<i));return t},Pp=function(e){this.data=e,this.len=this.data.length,this.pos=0,this.readByte=function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return e instanceof Uint8Array?e[this.pos++]:255&e.charCodeAt(this.pos++)},this.readBytes=function(e){for(var t=[],i=0;i<e;i++)t.push(this.readByte());return t},this.read=function(e){for(var t="",i=0;i<e;i++)t+=String.fromCharCode(this.readByte());return t},this.readUnsigned=function(){var e=this.readBytes(2);return(e[1]<<8)+e[0]}},Ap=function(e,t){t||(t={});var i=function(t){for(var i=[],n=0;n<t;n++)i.push(e.readBytes(3));return i},n=function(){var t,i;i="";do{t=e.readByte(),i+=e.read(t)}while(0!==t);return i},r=function(r){r.leftPos=e.readUnsigned(),r.topPos=e.readUnsigned(),r.width=e.readUnsigned(),r.height=e.readUnsigned();var o=Ep(e.readByte());r.lctFlag=o.shift(),r.interlaced=o.shift(),r.sorted=o.shift(),r.reserved=o.splice(0,2),r.lctSize=Tp(o.splice(0,3)),r.lctFlag&&(r.lct=i(1<<r.lctSize+1)),r.lzwMinCodeSize=e.readByte();var s=n();r.pixels=function(e,t){for(var i,n,r=0,o=function(e){for(var i=0,n=0;n<e;n++)t.charCodeAt(r>>3)&1<<(7&r)&&(i|=1<<n),r++;return i},s=[],a=1<<e,l=a+1,c=e+1,u=[],h=function(){u=[],c=e+1;for(var t=0;t<a;t++)u[t]=[t];u[a]=[],u[l]=null};;)if(n=i,(i=o(c))!==a){if(i===l)break;if(i<u.length)n!==a&&u.push(u[n].concat(u[i][0]));else{if(i!==u.length)throw new Error("Invalid LZW code.");u.push(u[n].concat(u[n][0]))}s.push.apply(s,u[i]),u.length===1<<c&&c<12&&c++}else h();return s}(r.lzwMinCodeSize,s),r.interlaced&&(r.pixels=function(e,t){for(var i=new Array(e.length),n=e.length/t,r=function(n,r){var o=e.slice(r*t,(r+1)*t);i.splice.apply(i,[n*t,t].concat(o))},o=[0,4,2,1],s=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=o[l];c<n;c+=s[l])r(c,a),a++;return i}(r.pixels,r.width)),t.img&&t.img(r)},o=function(){var i={};switch(i.sentinel=e.readByte(),String.fromCharCode(i.sentinel)){case"!":i.type="ext",function(i){switch(i.label=e.readByte(),i.label){case 249:i.extType="gce",function(i){e.readByte();var n=Ep(e.readByte());i.reserved=n.splice(0,3),i.disposalMethod=Tp(n.splice(0,3)),i.userInput=n.shift(),i.transparencyGiven=n.shift(),i.delayTime=e.readUnsigned(),i.transparencyIndex=e.readByte(),i.terminator=e.readByte(),t.gce&&t.gce(i)}(i);break;case 254:i.extType="com",function(e){e.comment=n(),t.com&&t.com(e)}(i);break;case 1:i.extType="pte",function(i){e.readByte(),i.ptHeader=e.readBytes(12),i.ptData=n(),t.pte&&t.pte(i)}(i);break;case 255:i.extType="app",function(i){e.readByte(),i.identifier=e.read(8),i.authCode=e.read(3),"NETSCAPE"===i.identifier?function(i){e.readByte(),i.unknown=e.readByte(),i.iterations=e.readUnsigned(),i.terminator=e.readByte(),t.app&&t.app.NETSCAPE&&t.app.NETSCAPE(i)}(i):function(e){e.appData=n(),t.app&&t.app[e.identifier]&&t.app[e.identifier](e)}(i)}(i);break;default:i.extType="unknown",function(e){e.data=n(),t.unknown&&t.unknown(e)}(i)}}(i);break;case",":i.type="img",r(i);break;case";":i.type="eof",t.eof&&t.eof(i);break;default:throw new Error("Unknown block: 0x"+i.sentinel.toString(16))}"eof"!==i.type&&setTimeout(o,0)};!function(){var n={};if(n.sig=e.read(3),n.ver=e.read(3),"GIF"!==n.sig)throw new Error("Not a GIF file.");n.width=e.readUnsigned(),n.height=e.readUnsigned();var r=Ep(e.readByte());n.gctFlag=r.shift(),n.colorRes=Tp(r.splice(0,3)),n.sorted=r.shift(),n.gctSize=Tp(r.splice(0,3)),n.bgColor=e.readByte(),n.pixelAspectRatio=e.readByte(),n.gctFlag&&(n.gct=i(1<<n.gctSize+1)),t.hdr&&t.hdr(n)}(),setTimeout(o,0)},Mp=function(e){var t,i,n={vp_l:0,vp_t:0,vp_w:null,vp_h:null,c_w:null,c_h:null};for(var r in e)n[r]=e[r];n.vp_w&&n.vp_h&&(n.is_vp=!0);var o=null,s=!1,a=null,l=null,c=null,u=null,h=null,d=null,p=null,m=!0,f=!1,g=[],y=[],v=n.gif;void 0===n.auto_play&&(n.auto_play=!v.getAttribute("rel:auto_play")||"1"==v.getAttribute("rel:auto_play"));var _,x,C,w,b=n.hasOwnProperty("on_end")?n.on_end:null,S=n.hasOwnProperty("loop_delay")?n.loop_delay:0,T=n.hasOwnProperty("loop_mode")?n.loop_mode:"auto",E=!n.hasOwnProperty("draw_while_loading")||n.draw_while_loading,P=!!E&&(!n.hasOwnProperty("show_progress_bar")||n.show_progress_bar),A=n.hasOwnProperty("progressbar_height")?n.progressbar_height:25,M=n.hasOwnProperty("progressbar_background_color")?n.progressbar_background_color:"rgba(255,255,255,0.4)",L=n.hasOwnProperty("progressbar_foreground_color")?n.progressbar_foreground_color:"rgba(255,0,22,.8)",D=function(){a=null,l=null,h=c,c=null,d=null},R=function(){try{Ap(t,H)}catch(e){O("parse")}},I=function(e,t){_.width=e*U(),_.height=t*U(),C.style.minWidth=e*U()+"px",w.width=e,w.height=t,w.style.width=e+"px",w.style.height=t+"px",w.getContext("2d").setTransform(1,0,0,1,0,0)},k=function(e,t,i){if(i&&P){var r,o,s,a=A;n.is_vp?f?(o=(n.vp_t+n.vp_h-a)/U(),a/=U(),r=n.vp_l/U()+e/t*(n.vp_w/U()),s=_.width/U()):(o=n.vp_t+n.vp_h-a,a=a,r=n.vp_l+e/t*n.vp_w,s=_.width):(o=(_.height-a)/(f?U():1),r=e/t*_.width/(f?U():1),s=_.width/(f?U():1),a/=f?U():1),x.fillStyle=M,x.fillRect(r,o,s-r,a),x.fillStyle=L,x.fillRect(0,o,r,a)}},O=function(e){o=e,i={width:v.width,height:v.height},g=[],x.fillStyle="black",x.fillRect(0,0,n.c_w?n.c_w:i.width,n.c_h?n.c_h:i.height),x.strokeStyle="red",x.lineWidth=3,x.moveTo(0,0),x.lineTo(n.c_w?n.c_w:i.width,n.c_h?n.c_h:i.height),x.moveTo(0,n.c_h?n.c_h:i.height),x.lineTo(n.c_w?n.c_w:i.width,0),x.stroke()},N=function(){d&&(g.push({data:d.getImageData(0,0,i.width,i.height),delay:l}),y.push({x:0,y:0}))},F=function(){var e,t,i,r=-1,s=0,a=function(e){r+=e,c()},l=(e=!1,t=function(){null!==b&&b(v),s++,!1!==T||s<0?i():(e=!1,m=!1)},i=function(){if(e=m){a(1);var n=10*g[r].delay;n||(n=100),0==(r+1+g.length)%g.length?(n+=S,setTimeout(t,n)):setTimeout(i,n)}},function(){e||setTimeout(i,0)}),c=function(){var e;(r=parseInt(r,10))>g.length-1&&(r=0),r<0&&(r=0),e=y[r],w.getContext("2d").putImageData(g[r].data,e.x,e.y),x.globalCompositeOperation="copy",x.drawImage(w,0,0)};return{init:function(){o||(n.c_w&&n.c_h||x.scale(U(),U()),n.auto_play?l():(r=0,c()))},step:l,play:function(){m=!0,l()},pause:function(){m=!1},playing:m,move_relative:a,current_frame:function(){return r},length:function(){return g.length},move_to:function(e){r=e,c()}}}(),z=function(e){k(t.pos,t.data.length,e)},B=function(){},G=function(e,t){return function(i){e(i),z(t)}},H={hdr:G((function(e){I((i=e).width,i.height)})),gce:G((function(e){N(),D(),a=e.transparencyGiven?e.transparencyIndex:null,l=e.delayTime,c=e.disposalMethod})),com:G(B),app:{NETSCAPE:G(B)},img:G((function(e){d||(d=w.getContext("2d"));var t=g.length,r=e.lctFlag?e.lct:i.gct;t>0&&(3===h?null!==u?d.putImageData(g[u].data,0,0):d.clearRect(p.leftPos,p.topPos,p.width,p.height):u=t-1,2===h&&d.clearRect(p.leftPos,p.topPos,p.width,p.height));var o=d.getImageData(e.leftPos,e.topPos,e.width,e.height);e.pixels.forEach((function(e,t){e!==a&&(o.data[4*t+0]=r[e][0],o.data[4*t+1]=r[e][1],o.data[4*t+2]=r[e][2],o.data[4*t+3]=255)})),d.putImageData(o,e.leftPos,e.topPos),f||(x.scale(U(),U()),f=!0),E&&(x.drawImage(w,0,0),E=n.auto_play),p=e}),!0),eof:function(e){N(),z(!1),n.c_w&&n.c_h||(_.width=i.width*U(),_.height=i.height*U()),F.init(),s=!1,V&&V(v)}},W=function(){var e=v.parentNode,t=document.createElement("div");_=document.createElement("canvas"),x=_.getContext("2d"),C=document.createElement("div"),w=document.createElement("canvas"),t.width=_.width=v.width,t.height=_.height=v.height,C.style.minWidth=v.width+"px",t.className="jsgif",C.className="jsgif_toolbar",t.appendChild(_),t.appendChild(C),e.insertBefore(t,v),e.removeChild(v),n.c_w&&n.c_h&&I(n.c_w,n.c_h),j=!0},U=function(){return n.max_width&&i&&i.width>n.max_width?n.max_width/i.width:1},j=!1,V=!1,q=function(e){return!s&&(V=e||!1,s=!0,g=[],D(),u=null,h=null,d=null,p=null,!0)},$=function(){return g.reduce((function(e,t){return e+t.delay}),0)};return{play:F.play,pause:F.pause,move_relative:F.move_relative,move_to:F.move_to,get_playing:function(){return m},get_canvas:function(){return _},get_canvas_scale:function(){return U()},get_loading:function(){return s},get_auto_play:function(){return n.auto_play},get_length:function(){return F.length()},get_frames:function(){return g},get_duration:function(){return $()},get_duration_ms:function(){return 10*$()},get_current_frame:function(){return F.current_frame()},load_url:function(e,i){if(q(i)){var n=new XMLHttpRequest;n.open("GET",e,!0),"overrideMimeType"in n?n.overrideMimeType("text/plain; charset=x-user-defined"):"responseType"in n?n.responseType="arraybuffer":n.setRequestHeader("Accept-Charset","x-user-defined"),n.onloadstart=function(){j||W()},n.onload=function(e){200!=this.status&&O("xhr - response"),"response"in this||(this.response=new VBArray(this.responseText).toArray().map(String.fromCharCode).join(""));var i=this.response;i.toString().indexOf("ArrayBuffer")>0&&(i=new Uint8Array(i)),t=new Pp(i),setTimeout(R,0)},n.onprogress=function(e){e.lengthComputable&&k(e.loaded,e.total,!0)},n.onerror=function(){O("xhr")},n.send()}},load:function(e){this.load_url(v.getAttribute("rel:animated_src")||v.src,e)},load_raw:function(e,i){q(i)&&(j||W(),t=new Pp(e),setTimeout(R,0))},set_frame_offset:function(e,t){y[e]?(void 0!==t.x&&(y[e].x=t.x),void 0!==t.y&&(y[e].y=t.y)):y[e]=t}}};const{BillboardCollection:Lp,VerticalOrigin:Dp}=Cesium;const Rp="\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    material.diffuse = color.rgb;\n    vec2 st = materialInput.st - vec2(0.5);\n    float dis = distance(st, vec2(0.0));\n    // material.alpha = min(pow(dis * 2.0, 5.0) * color.a, 1.0);\n    if (dis * 2.0 > fract(time)) {\n        discard;\n    }  \n    float scale = 1.0 / (max(time, 0.0001));\n    material.alpha = min(pow(dis * 2.0 * scale, 5.0), 1.0) * color.a;\n    return material;\n}\n",{MaterialAppearance:Ip,Material:kp}=Cesium;const{Cartesian3:Op,Matrix4:Np,Transforms:Fp,Model:zp,CylinderGeometry:Bp,PrimitiveCollection:Gp,BillboardCollection:Hp,MaterialAppearance:Wp,GeometryInstance:Up,Material:jp,Color:Vp,Primitive:qp}=Cesium;function $p(e,t,i){if(!Re(e))return;t=Cesium.Math.toRadians(t);const n=new Cesium.Matrix3,r=new Cesium.Quaternion;Cesium.Quaternion.fromAxisAngle(i,t,r),Cesium.Matrix3.fromQuaternion(r,n);const o=new Cesium.Matrix4;Cesium.Matrix4.fromRotationTranslation(n,new Cesium.Cartesian3(0,0,0),o),Cesium.Matrix4.multiplyByMatrix3(e._matrix,n,e._matrix);const s=Ie.fromCartesian(e._surface,e._viewer),a=new Cesium.Matrix4;Cesium.Matrix4.inverseTransformation(e._matrix,a);const l=Cesium.Cartesian3.fromDegrees(s.lon,s.lat,e._height),c=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(a,l,c);const u=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(o,c,u);const h=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(c,u,h),Cesium.Matrix4.multiplyByTranslation(e._matrix,h,e._matrix),e.updateMatrix(e._matrix)}function Yp(e){const t=e.scanPrimitive.appearance.material,i=e._viewer;if(e.path){const t=e.path.position.getValue(i.clock.currentTime);e._position=t;const n=Ie.fromCartesian(t,i),r=Cesium.Cartesian3.fromDegrees(n.lon,n.lat);e._surface=r,e._height=n.height;const o=new Cesium.Cartesian3(0,0,n.height/2),s=Cesium.Matrix4.multiplyByTranslation(Fp.eastNorthUpToFixedFrame(r),o,new Cesium.Matrix4);e.updateMatrix(s),e.imagePrimitive.position=t,e.transform(e.rotation),e.tracked&&e.trackSatellite()}let n=t.uniforms.offset;n-=.005*e.speed,n>1&&(n=0),e.scanPrimitive.appearance.material.uniforms.offset=n}const{Cartesian2:Xp,Cartesian3:Jp,Cartographic:Zp,Credit:Qp,defaultValue:Kp,defined:em,DeveloperError:tm,Event:im,GeographicProjection:nm,GeographicTilingScheme:rm,Math:om,Rectangle:sm,Resource:am,RuntimeError:lm,TileProviderError:cm,WebMercatorProjection:um,WebMercatorTilingScheme:hm,DiscardMissingTileImagePolicy:dm,ImageryLayerFeatureInfo:pm,ImageryProvider:mm}=Cesium;function fm(e){e=Kp(e,Kp.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;const t=am.createIfNeeded(e.url);t.appendForwardSlash(),em(e.token)&&t.setQueryParameters({token:e.token}),this._resource=t,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tileWidth=Kp(e.tileWidth,256),this._tileHeight=Kp(e.tileHeight,256),this._maximumLevel=e.maximumLevel,this._tilingScheme=Kp(e.tilingScheme,new rm({ellipsoid:e.ellipsoid})),this._useTiles=Kp(e.usePreCachedTilesIfAvailable,!0),this._rectangle=Kp(e.rectangle,this._tilingScheme.rectangle),this._layers=e.layers;let i=e.credit;"string"==typeof i&&(i=new Qp(i)),this._credit=i,this.enablePickFeatures=Kp(e.enablePickFeatures,!0),this._errorEvent=new im,this._ready=!1;const n=this;let r;function o(t){const i=t.tileInfo;if(em(i)){if(n._tileWidth=i.rows,n._tileHeight=i.cols,102100===i.spatialReference.wkid||102113===i.spatialReference.wkid)n._tilingScheme=new hm({ellipsoid:e.ellipsoid});else if(4326===t.tileInfo.spatialReference.wkid)n._tilingScheme=new rm({ellipsoid:e.ellipsoid});else{if(4490!==t.tileInfo.spatialReference.wkid){const e=`Tile spatial reference WKID ${t.tileInfo.spatialReference.wkid} is not supported.`;return r=cm.reportError(r,n,n._errorEvent,e,void 0,void 0,void 0),r.retry?a():Promise.reject(new lm(e))}n._tilingScheme=new ko({ellipsoid:e.ellipsoid,tileInfo:t.tileInfo,rectangle:n._rectangle,numberOfLevelZeroTilesX:e.numberOfLevelZeroTilesX,numberOfLevelZeroTilesY:e.numberOfLevelZeroTilesY}),n._tilingScheme._tileInfo=t.tileInfo}if(n._maximumLevel=t.tileInfo.lods.length-1,em(t.fullExtent)){if(em(t.fullExtent.spatialReference)&&em(t.fullExtent.spatialReference.wkid))if(102100===t.fullExtent.spatialReference.wkid||102113===t.fullExtent.spatialReference.wkid){const e=new um,i=t.fullExtent,r=e.unproject(new Jp(Math.max(i.xmin,-n._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(i.ymin,-n._tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),o=e.unproject(new Jp(Math.min(i.xmax,n._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(i.ymax,n._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));n._rectangle=new sm(r.longitude,r.latitude,o.longitude,o.latitude)}else if(4326===t.fullExtent.spatialReference.wkid)n._rectangle=sm.fromDegrees(t.fullExtent.xmin,t.fullExtent.ymin,t.fullExtent.xmax,t.fullExtent.ymax);else{if(4490!==t.fullExtent.spatialReference.wkid){const e=`fullExtent.spatialReference WKID ${t.fullExtent.spatialReference.wkid} is not supported.`;return r=cm.reportError(r,n,n._errorEvent,e,void 0,void 0,void 0),r.retry?a():Promise.reject(new lm(e))}n._rectangle=sm.fromDegrees(t.fullExtent.xmin,t.fullExtent.ymin,t.fullExtent.xmax,t.fullExtent.ymax)}}else n._rectangle=n._tilingScheme.rectangle;em(n._tileDiscardPolicy)||(n._tileDiscardPolicy=new dm({missingImageUrl:gm(n,0,0,n._maximumLevel).url,pixelsToCheck:[new Xp(0,0),new Xp(200,20),new Xp(20,200),new Xp(80,110),new Xp(160,130)],disableCheckIfAllPixelsAreTransparent:!0})),n._useTiles=!0}else n._useTiles=!1;return em(t.copyrightText)&&t.copyrightText.length>0&&(n._credit=new Qp(t.copyrightText)),n._ready=!0,cm.reportSuccess(r),Promise.resolve(!0)}function s(e){const t=`An error occurred while accessing ${n._resource.url}.`;return r=cm.reportError(r,n,n._errorEvent,t,void 0,void 0,void 0),Promise.reject(new lm(t))}function a(){return n._resource.getDerivedResource({queryParameters:{f:"json"}}).fetchJsonp().then(o).catch(s)}this._useTiles?this._readyPromise=a():(this._ready=!0,this._readyPromise=Promise.resolve(!0))}function gm(e,t,i,n,r){let o;if(e._useTiles)o=e._resource.getDerivedResource({url:`tile/${n}/${i}/${t}`,request:r});else{const s=e._tilingScheme.tileXYToNativeRectangle(t,i,n),a={bbox:`${s.west},${s.south},${s.east},${s.north}`,size:`${e._tileWidth},${e._tileHeight}`,format:"png32",transparent:!0,f:"image"};e._tilingScheme.projection instanceof nm?(a.bboxSR=4326,a.imageSR=4326):(a.bboxSR=3857,a.imageSR=3857),e.layers&&(a.layers=`show:${e.layers}`),o=e._resource.getDerivedResource({url:"export",request:r,queryParameters:a})}return o}Object.defineProperties(fm.prototype,{url:{get:function(){return this._resource._url}},token:{get:function(){return this._resource.queryParameters.token}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),fm.prototype.getTileCredits=function(e,t,i){},fm.prototype.requestImage=function(e,t,i,n){return mm.loadImage(this,gm(this,e,t,i,n))},fm.prototype.pickFeatures=function(e,t,i,n,r){if(!this.enablePickFeatures)return;const o=this._tilingScheme.tileXYToNativeRectangle(e,t,i);let s,a,l;if(this._tilingScheme.projection instanceof nm)s=om.toDegrees(n),a=om.toDegrees(r),l="4326";else{const e=this._tilingScheme.projection.project(new Zp(n,r,0));s=e.x,a=e.y,l="3857"}let c="visible";em(this._layers)&&(c+=`:${this._layers}`);const u={f:"json",tolerance:2,geometryType:"esriGeometryPoint",geometry:`${s},${a}`,mapExtent:`${o.west},${o.south},${o.east},${o.north}`,imageDisplay:`${this._tileWidth},${this._tileHeight},96`,sr:l,layers:c};return this._resource.getDerivedResource({url:"identify",queryParameters:u}).fetchJson().then((function(e){const t=[],i=e.results;if(!em(i))return t;for(let e=0;e<i.length;++e){const n=i[e],r=new pm;if(r.data=n,r.name=n.value,r.properties=n.attributes,r.configureDescriptionFromProperties(n.attributes),"esriGeometryPoint"===n.geometryType&&n.geometry){const e=n.geometry.spatialReference&&n.geometry.spatialReference.wkid?n.geometry.spatialReference.wkid:4326;if(4326===e||4283===e)r.position=Zp.fromDegrees(n.geometry.x,n.geometry.y,n.geometry.z);else if(102100===e||900913===e||3857===e){const e=new um;r.position=e.unproject(new Jp(n.geometry.x,n.geometry.y,n.geometry.z))}}t.push(r)}return t}))};const ym=33746824,vm=33554054;const{BingMapsImageryProvider:_m,BingMapsStyle:xm}=Cesium;class Cm extends _m{constructor(e={}){e.url="https://dev.virtualearth.net",e.mapStyle=De(e.mapStyle,Cm.mapStyle.AERIAL),e.key=De(e.key,"AqMhBWJKbBPBtoWEvtGdUii6XSkDCJ3vWFpOVWzplD-Q0J-ECUF6i8MGXpew8bkc"),super(e)}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get rectangle(){return super.rectangle}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(e){this._tileProvider.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}static tileXYToQuadKey(e,t,i){return _m.tileXYToQuadKey(e,t,i)}static quadKeyToTileXY(e){return _m.quadKeyToTileXY(e)}static mapStyle=xm}class wm extends wa{constructor(e){e=De(e,{});const t=De(e.layer,"img"),{scl:i,style:n}=wm.getParametersByLayer(t),r=De(e.lang,"zh_cn");e.url=`https://webst0{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=${r}&size=1&scl=${i}&style=${n}`,e.subdomains="1234",super(e)}static layers=[{layer:"img",desc:"影像地图"},{layer:"vec",desc:"矢量地图"},{layer:"vei",desc:"矢量地图（含注记）"},{layer:"roa",desc:"路网地图"},{layer:"roi",desc:"路网地图（含注记）"}];static getParametersByLayer(e){let t={scl:1,style:6};switch(e){case"img":break;case"vec":t.scl=2,t.style=7;break;case"vei":t.scl=1,t.style=7;break;case"roa":t.scl=2,t.style=8;break;case"roi":t.scl=1,t.style=8}return t}}const{WebMapTileServiceImageryProvider:bm}=Cesium;class Sm extends bm{constructor(e={}){super(e)}get dimensions(){return super.dimensions}set dimensions(e){super.dimensions=e}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get rectangle(){return super.rectangle}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(e){this._tileProvider.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}}const Tm={map:"https://rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=1&version=297",road:"https://rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=2&version=297",img:"https://p{s}.map.gtimg.com/sateTiles/{z}/{sx}/{sy}/{x}_{reverseY}.jpg?version=229"};function Em(e){return`rgba(${255*e.red}, ${255*e.green}, ${255*e.blue}, ${e.alpha})`}const{Rectangle:Pm}=Cesium;class Am extends Cesium.TileMapServiceImageryProvider{constructor(e){super(e)}get url(){return super.url}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get rectangle(){return super.rectangle}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return super.enablePickFeatures}set enablePickFeatures(e){super.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}}class Mm extends Cesium.WebMapServiceImageryProvider{constructor(e={}){Re(e.parameters)||(e.parameters=Mm.DefaultParameters),Re(e.GetFeatureInfoDefaultParameters),super(e)}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get rectangle(){return super.rectangle}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(e){this._tileProvider.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}}Mm.DefaultParameters=Object.assign({transparent:!0},Cesium.WebMapServiceImageryProvider.DefaultParameters,{format:"image/png"}),Mm.GetFeatureInfoDefaultParameters=Cesium.WebMapServiceImageryProvider.GetFeatureInfoDefaultParameters;const{CallbackProperty:Lm}=Cesium;function Dm(e){return new Lm((()=>e),!1)}class Rm{constructor(e,t={}){this._type=void 0,this._properties=void 0,this._show=!0,this._id=De(e.id,Ge()),this._clampToGround=De(t.clampToGround),this._clampToModel=De(t.clampToModel)}highlightGraphic(e=!0){const t=Rm.highlightColor;this.entity&&e?(this.entity.point&&(this.entity.point.color=t),this.entity.polyline&&(this.entity.polyline.material=t),this.entity.polygon&&(this.entity.polygon.material=t),this.entity.polygon&&(this.entity.polygon.outlineColor=t)):(this.entity.point&&(this.entity.point.color=this._entityOptions.point.color),this.entity.polyline&&(this.entity.polyline.material=this._entityOptions.polyline.material),this.entity.polygon&&(this.entity.polygon.material=this._entityOptions.polygon.material),this.entity.polygon&&(this.entity.polygon.outlineColor=this._entityOptions.polygon.outlineColor))}static highlightColor=Cesium.Color.AQUA;get clampToGround(){return this._clampToGround}set clampToGround(e){this._clampToGround=e}get clampToModel(){return this._clampToModel}set clampToModel(e){this._clampToModel=e}get id(){return this._id}get positions(){return this._positions}get type(){return this._type}get properties(){return this._properties}set properties(e){this._properties=new Rs(e)}get entity(){return this._entity}get show(){return this._show}set show(e){this._show=e,this.entity&&(this.entity.show=this._show)}destroy(){console.log("destroy"),this._entity=void 0,this._entityOptions=void 0,this._positions=void 0,this.properties&&this.properties.destroy(),this._properties=void 0,je(this)}startEdit(){if(this.entity){const e=Dm(this.positions);this.entity.position&&(this.entity.position=e),this.entity.polyline&&(this.entity.polyline.positions=Dm(this._nodePositions||this.positions)),this.entity.polygon&&(this.entity.polygon.hierarchy=Dm(new Cesium.PolygonHierarchy(this.positions)))}}stopEdit(){this.entity&&(this.entity.position&&(this.entity.position=this.positions),this.entity.polyline&&(this.entity.polyline.positions=this._nodePositions||this.positions),this.entity.polygon&&(this.entity.polygon.hierarchy=new Cesium.PolygonHierarchy(this.positions)))}createProperties(){const e=this._entityOptions,{properties:t}=e;this._properties=new Rs(t),delete e.properties}createEntity(){this.createProperties()}toGeoJson(){ot()}getGeometry(){ot()}static getEntityFromGeoJson(e){if(Re(e)){if(e.geometry&&"POLYGON"===e.geometry.type.toUpperCase()){let t=[];const i=e.geometry.coordinates;if(!Re(i)||!Array.isArray(i))return;for(let e of i){if(!Array.isArray(e))return;for(let i of e){const e=Cesium.Cartesian3.fromDegrees(i[0],i[1]);if(!Re(e))return;t.push(e)}}return new Cesium.Entity({polygon:{material:Cesium.Color.fromCssColorString("rgba(247,224,32,0.5)"),outlineColor:Cesium.Color.RED,perPositionHeight:!1,hierarchy:t}})}return hierarchy}}}function Im(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function km(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Om(e,t,i){return t&&km(e.prototype,t),i&&km(e,i),e}function Nm(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Fm(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bm(e,t)}function zm(e){return zm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zm(e)}function Bm(e,t){return Bm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Bm(e,t)}function Gm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hm(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?Gm(e):t}function Wm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=zm(e);if(t){var r=zm(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Hm(this,i)}}function Um(e,t,i){return Um="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zm(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}},Um(e,t,i||e)}function jm(e){return function(e){if(Array.isArray(e))return Vm(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Vm(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Vm(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vm(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function qm(e,t){return null!=e?e:t}qm.EMPTY_OBJECT=Object.freeze({});var $m={ARROW:0,HALF_ARROW:1,BEZIER:2,SPLINE:3,SWALLOW_TRAIL:4,TRAPEZOID:5,HALF_TRAPEZOID:6,HALF_SWALLOW_TRAIL:7,HALF_SPLINE:8,getLabel:function(e){var t;switch(e.type){case $m.HALF_ARROW:t="HALF_ARROW";break;case $m.ARROW:lebel="ARROW";break;case $m.BEZIER:t="BEZIER";break;case $m.SPLINE:t="SPLINE";break;case $m.SWALLOW_TRAIL:t="SWALLOW_TRAIL";break;case $m.HALF_SWALLOW_TRAIL:t="HALF_SWALLOW_TRAIL";break;case $m.HALF_SPLINE:t="HALF_SPLINE";break;default:t=void 0}return t},getErrorMsg:function(e){e.type;var t=e.controls.length;if(!$m.validate(e))throw new Error($m.getLabel(e)+"控制点个数必须不少于"+e.controlPointsCount[0]+",实际只有"+t+"个")},validate:function(e){return!(e.controls.length<e.controlPointsCount[0])}},Ym=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Im(this,e),this._controls=t.controls||[],this._index=t.index,this._inverse=t.inverse||!1,!this._index){var i=this._controls.length;this._index=new Array(i);for(var n=0;n<i;n++)this._index[n]=n}}return Om(e,[{key:"createNodes",value:function(){$m.getErrorMsg(this)}},{key:"get",value:function(e){return this.index?this.controls[this.index[e]]:this.controls[e]}},{key:"controls",get:function(){return this._controls}},{key:"index",get:function(){return this._index}},{key:"type",get:function(){return this._type}},{key:"controlPointsCount",get:function(){return this._controlPointsCount}},{key:"nodes",get:function(){return this._nodes},set:function(e){this._nodes=e}},{key:"inverse",get:function(){return this._inverse},set:function(e){this._inverse=e}}]),e}(),Xm=function(){function e(){Im(this,e)}return Om(e,null,[{key:"distance",value:function(){var e=arguments.length;if(e<2)return 0;for(var t=0,i=0;i<e-1;i++){var n=(i+1)%e,r=i<0||arguments.length<=i?void 0:arguments[i],o=n<0||arguments.length<=n?void 0:arguments[n];t+=Math.sqrt(Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2))}return t}},{key:"baseLength",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.99;return Math.pow(e.distance.apply(e,jm(t)),i)}},{key:"mid",value:function(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}},{key:"azimuth",value:function(t,i){var n=[i,t];t=n[0],i=n[1];var r=Math.asin(Math.abs(t[1]-i[1])/e.distance(t,i));return t[1]>=i[1]&&t[0]>=i[0]?r+Math.PI:t[1]>=i[1]&&t[0]<i[0]?2*Math.PI-r:t[1]<i[1]&&t[0]>=i[0]?Math.PI-r:r}},{key:"thirdPoint",value:function(t,i,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=e.azimuth(t,i),a=o?s-n:s+n,l=r*Math.cos(a),c=r*Math.sin(a);return[i[0]+l,i[1]+c]}},{key:"isClockWise",value:function(e,t,i){return(i[1]-e[1])*(t[0]-e[0])>(t[1]-e[1])*(i[0]-e[0])}},{key:"angleOfThreePoints",value:function(t,i,n){var r=e.azimuth(t,i)-e.azimuth(t,n);return r>0?r:2*Math.PI+r}},{key:"quadricBSplineFactor",value:function(e,t){return 0===e?Math.pow(t-1,2)/2:1===e?(-2*Math.pow(t,2)+2*t+1)/2:2===e?Math.pow(t,2)/2:0}},{key:"quadricBSpline",value:function(t){if(t<=2)return t;var i=[],n=t.length-2-1;i.push(t[0]);for(var r=0;r<=n;r++)for(var o=0;o<=1;o+=.05){for(var s=0,a=0,l=0;l<=2;l++){var c=e.quadricBSplineFactor(l,o);s+=c*t[r+l][0],a+=c*t[r+l][1]}i.push([s,a])}return i.push(t[t.length-1]),i}},{key:"binomialFactor",value:function(t,i){return e.factorial(t)/(e.factorial(i)*e.factorial(t-i))}},{key:"factorial",value:function(t){return t<0?NaN:0===t?1:t*e.factorial(t-1)}},{key:"BezierCurve",value:function(t){var i=t.length;if(i<2)return t;for(var n=[],r=0;r<=1;r+=.01){for(var o=0,s=0,a=0;a<i;a++){var l=e.binomialFactor(i-1,a),c=Math.pow(r,a),u=Math.pow(1-r,i-a-1);o+=l*c*u*t[a][0],s+=l*c*u*t[a][1]}n.push([o,s])}return n.push(t[i-1]),n}}]),e}(),Jm=function(e){Fm(i,e);var t=Wm(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Im(this,i),(e=t.call(this,n))._controlPointsCount=[2,2],e._type=$m.HALF_ARROW,e._heightFactor=qm(n.heightFactor,.18),e._neckHeightFactor=qm(n.neckHeightFactor,.15),e._headWidthFactor=qm(n.headWidthFactor,.5),e._neckWidthFactor=qm(n.neckWidthFactor,.3),e._headMaxHeight=n.headMaxHeight,e._headTailHeightFactor=qm(n.headTailHeightFactor,.3),e._inverse=qm(n.inverse,!1),e._nodes=[],e.createNodes(),e}return Om(i,[{key:"createNodes",value:function(){Um(zm(i.prototype),"createNodes",this).call(this);var e=this.controls,t=Xm.baseLength(e),n=this.heightFactor*t;t=Xm.distance(this.get(0),this.get(1)),this.headMaxHeight&&n>this.headMaxHeight&&(n=this.headMaxHeight);var r=this.neckWidthFactor*n,o=this.headWidthFactor*n;n=n>t?t:n;var s=this.neckHeightFactor*n,a=Xm.thirdPoint(this.get(0),this.get(1),0,n),l=Xm.thirdPoint(this.get(0),this.get(1),0,s),c=Xm.thirdPoint(this.get(1),a,Math.PI/2,o,this.inverse),u=Xm.thirdPoint(this.get(1),l,Math.PI/2,r,this.inverse);return this.neck=u,this.tail=c,this.neckControl=l,this.tailControl=a,this._nodes=[l,u,c,this.get(1)],this.completedNodes=new Map,this.completedNodes.set(this.inverse,[l,u,c,this.get(1)]),this._nodes}},{key:"headMaxHeight",get:function(){return this._headMaxHeight}},{key:"heightFactor",get:function(){return this._heightFactor}},{key:"neckHeightFactor",get:function(){return this._neckHeightFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}},{key:"neckWidthFactor",get:function(){return this._neckWidthFactor}},{key:"nodes",get:function(){return this._nodes}}]),i}(Ym),Zm=function(e){Fm(i,e);var t=Wm(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Im(this,i),(e=t.call(this,n))._type=$m.ARROW,e.createNodes(),e}return Om(i,[{key:"createNodes",value:function(){var e=new Map;this._inverse=!0;var t=Um(zm(i.prototype),"createNodes",this).call(this);e.set(this.inverse,jm(t)),this._inverse=!1;var n=Um(zm(i.prototype),"createNodes",this).call(this);return e.set(this.inverse,jm(n)),n.shift(),t.shift(),n.pop(),this.inverse=void 0,this.completedNodes=e,this._nodes=[].concat(jm(n),jm(t.reverse())),[].concat(jm(n),jm(t.reverse()))}}]),i}(Jm),Qm=function(e){Fm(i,e);var t=Wm(i);function i(e){var n;return Im(this,i),(n=t.call(this,e))._type=$m.HALF_TRAPEZOID,n._controlPointsCount=[2,2],n._heightFactor=qm(e.heightFactor,.82),n._tailWidthFactor=qm(e.tailWidthFactor,.5),n._headWidthFactor=qm(e.headWidthFactor,.3),n.createNodes(),n}return Om(i,[{key:"createNodes",value:function(){Um(zm(i.prototype),"createNodes",this).call(this);var e=this.get(0),t=Xm.baseLength(this._controls),n=this.heightFactor*t,r=Xm.thirdPoint(this.get(1),e,0,n,this.inverse),o=this.tailWidthFactor*t,s=this.headWidthFactor*t,a=Xm.thirdPoint(e,r,Math.PI/2,s,this.inverse),l=Xm.thirdPoint(r,e,Math.PI/2,o,!this.inverse);return this._nodes=[a,l,e,r].flat(),this.completedNodes=new Map,this.completedNodes.set(this.inverse,[l]),[l]}},{key:"linkArrow",value:function(e){var t=e.arrowNodes,i=e.bodyNodes;return e.inverse?[].concat(jm(i),jm(t)):[].concat(jm(t),jm(i))}},{key:"linkTail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tailNodes,i=e.bodyNodes;return e.inverse,[].concat(jm(t),jm(i))}},{key:"heightFactor",get:function(){return this._heightFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}},{key:"tailWidthFactor",get:function(){return this._tailWidthFactor}}]),i}(Ym),Km=function(e){Fm(i,e);var t=Wm(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Im(this,i),(e=t.call(this,n))._type=$m.TRAPEZOID,e}return Om(i,[{key:"createNodes",value:function(){var e=new Map;this.inverse=!1;var t=Um(zm(i.prototype),"createNodes",this).call(this);e.set(this.inverse,jm(t)),this.inverse=!0;var n=Um(zm(i.prototype),"createNodes",this).call(this);return e.set(this.inverse,jm(n)),this.completedNodes=e,this.inverse=void 0,this._nodes=n.concat(t),this._nodes}}]),i}(Qm),ef=function(){function e(t){Im(this,e),this._headHeightFactor=qm(t.headHeightFactor,.2),this._neckHeightFactor=qm(t.neckHeightFactor,.8),this._headWidthFactor=qm(t.headWidthFactor,.5),this._neckWidthFactor=qm(t.neckWidthFactor,.3),this._tailWidthFactor=qm(t.tailWidthFactor,.3),this._tailHeightFactor=qm(t.tailHeightFactor,.2),this._controls=qm(t.controls,[]),this._headComponent=void 0,this._bodyComponent=void 0,this._tailComponent=void 0,this._nodes=void 0,this._polygon=[],this._polyline=[]}return Om(e,[{key:"postProcessing",value:function(e){return e}},{key:"merge",value:function(){var e,t,i,n=this.headComponent,r=this.bodyComponent,o=this.tailComponent;r&&(i=r.completedNodes);var s,a,l=[];(i&&i.get(!0)&&(s=i.get(!0),l=r.linkTail({tailNodes:l,bodyNodes:s})),n&&(s=n.nodes,l=r?r.linkArrow({arrowNodes:s,bodyNodes:l,inverse:!0,target:this}):s),i&&i.get(!1)&&(s=i.get(!1),l=r.linkArrow({arrowNodes:l,bodyNodes:s,inverse:!1,target:this})),o)&&(a=l).push.apply(a,jm(o.nodes));this.reset(),(e=this.polygon).push.apply(e,jm(l.flat())),(t=this.polyline).push.apply(t,jm(l.flat()))}},{key:"update",value:function(){this.createNodes()}},{key:"reset",value:function(){this.polygon.splice(0),this.polyline.splice(0)}},{key:"polygon",get:function(){return this._polygon}},{key:"polyline",get:function(){return this._polyline}},{key:"controls",get:function(){return this._controls}}]),e}(),tf=function(e){Fm(i,e);var t=Wm(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Im(this,i),(e=t.call(this,n))._type=$m.HALF_SWALLOW_TRAIL,e._controlPointsCount=[3,1/0],e._heightFactor=qm(n.heightFactor,.3),e.createNodes(),e}return Om(i,[{key:"createNodes",value:function(){Um(zm(i.prototype),"createNodes",this).call(this);var e=Xm.baseLength(this.controls),t=this._heightFactor*e,n=Xm.mid(this.get(0),this.get(1)),r=Xm.thirdPoint(this.get(2),n,0,t,this.inverse);return this.nodes=[r],this.nodes}},{key:"heightFactor",get:function(){return this._heightFactor}}]),i}(Ym);function nf(e){var t=function(t){if(e.hasOwnProperty(t)&&t.startsWith("_")){var i=t.replace("_","");Object.defineProperty(e,i,{get:function(){return e[t]},set:function(i){e[t]=i}})}};for(var i in e)t(i)}var rf=function(e){Fm(i,e);var t=Wm(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Im(this,i),n=qm(n,qm.EMPTY_OBJECT),(e=t.call(this,n))._tail=qm(n.tail,!1),e.init(),nf(Gm(e)),e.merge(),e}return Om(i,[{key:"addControl",value:function(e){this.controls.length>=i.MIN_CONTROL_COUNT&&this.controls.pop(),this.controls.push(e),this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"popControl",value:function(){return this.controls.pop()}},{key:"updateControl",value:function(e,t){this.controls[e]=t,this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"init",value:function(){this.controls.length<i.MIN_CONTROL_COUNT||(this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()))}},{key:"update",value:function(){this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()),this.merge()}},{key:"createBodyComponent",value:function(){return new Km({controls:this._controls,heightFactor:1-this._neckHeightFactor,headWidthFactor:this._neckWidthFactor,tailWidthFactor:this._tailWidthFactor})}},{key:"createHeadComponent",value:function(){return new Zm({controls:this._controls,headWidthFactor:this._headWidthFactor,neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headHeightFactor:this._headHeightFactor})}},{key:"createTailComponent",value:function(){if(this._bodyComponent){var e=this._bodyComponent.nodes;return new tf({controls:[].concat(jm(e),[this._controls[1]]),heightFactor:this._tailHeightFactor})}}},{key:"tail",set:function(e){this._tail=e}}]),i}(ef);Nm(rf,"MIN_CONTROL_COUNT",2);var of=function(e){Fm(i,e);var t=Wm(i);function i(e){var n;return Im(this,i),(n=t.call(this,e))._type=$m.HALF_SPLINE,n._controlPointsCount=[2,1/0],n._headWidthFactor=qm(e.headWidthFactor,.1),n._tailWidthFactor=qm(e.tailWidthFactor,.3),n.createNodes(),n}return Om(i,[{key:"createNodes",value:function(){Um(zm(i.prototype),"createNodes",this).call(this);for(var e=this.controls,t=Xm.distance.apply(Xm,jm(e)),n=Xm.baseLength(e),r=this.tailWidthFactor*n,o=this.headWidthFactor*n,s=Math.abs(r-o)/2,a=0,l=e,c=[],u=1;u<e.length-1;u++){var h=Xm.angleOfThreePoints(l[u],l[u-1],l[u+1])/2;a+=Xm.distance(l[u-1],l[u]),this.inverse||(h=Math.PI-h);var d=(r/2-a/t*s)/Math.sin(h),p=Xm.thirdPoint(l[u-1],l[u],h,d,this.inverse);c.push(p)}return this.completedNodes=new Map,this.completedNodes.set(this.inverse,c),this.nodes=c,c}},{key:"linkArrow",value:function(e){var t=e.arrowNodes,i=e.bodyNodes,n=e.inverse,r=e.target,o=[];if(r._tail&&o.push(r.controls[+!n]),n){o.push.apply(o,jm(i).concat([t[0]]));var s=Xm.quadricBSpline(o);return[].concat(jm(s),jm(t))}o.push.apply(o,jm(i).concat([t[t.length-1]]));var a=Xm.quadricBSpline(o);return[].concat(jm(t),jm(a.reverse()))}},{key:"linkTail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tailNodes,i=e.bodyNodes;return e.inverse,[].concat(jm(t),jm(i))}},{key:"tailWidthFactor",get:function(){return this._tailWidthFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}}]),i}(Ym),sf=function(e){Fm(i,e);var t=Wm(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Im(this,i),t.call(this,e)}return Om(i,[{key:"createNodes",value:function(){var e=new Map;this.inverse=!1;var t=Um(zm(i.prototype),"createNodes",this).call(this);e.set(this.inverse,jm(t)),this.inverse=!0;var n=Um(zm(i.prototype),"createNodes",this).call(this);return e.set(this.inverse,jm(n)),this.inverse=void 0,this.nodes=[].concat(jm(t),jm(n.reverse())),this.completedNodes=e,[].concat(jm(t),jm(n.reverse()))}}]),i}(of),af=function(e){Fm(i,e);var t=Wm(i);function i(e){var n;return Im(this,i),(e=qm(e,{})).headHeightFactor=qm(e.headHeightFactor,.15),e.neckHeightFactor=qm(e.headWidthFactor,.8),e.neckWidthFactor=qm(e.neckWidthFactor,.15),e.headWidthFactor=qm(e.headWidthFactor,.4),e.tailWidthFactor=qm(e.tailWidthFactor,.25),(n=t.call(this,e))._headTailHeightFactor=qm(e.headTailHeightFactor,.5),n._tail=qm(e.tail,!0),n._heightFactor=qm(e.heightFactor,.8),n._tailHeightFactor=qm(e.tailHeightFactor,.05),n.init(),nf(Gm(n)),n.merge(),n}return Om(i,[{key:"addControl",value:function(e){this.controls[this.controls.length-1],this.controls.push(e),(!this.tail&&this.controls.length>=i.MIN_CONTROL_COUNT||this.controls.length>=i.MIN_CONTROL_COUNT+1)&&(this.init(),this.merge())}},{key:"updateControl",value:function(e,t){this.controls[e]=t,(!this.tail&&this.controls.length>=i.MIN_CONTROL_COUNT||this.controls.length>=i.MIN_CONTROL_COUNT+1)&&(this.init(),this.merge())}},{key:"popControl",value:function(){this.controls.pop()}},{key:"init",value:function(){var e;!this.tail&&this.controls.length<i.MIN_CONTROL_COUNT||this.tail&&this.controls.length<i.MIN_CONTROL_COUNT+1||(this._head1=this.controls[0],this._head2=this.controls[1],this.tail&&Xm.isClockWise(this.controls[0],this.controls[1],this.controls[2])&&(e=[this._head2,this._head1],this._head1=e[0],this._head2=e[1]),this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()))}},{key:"createHeadComponent",value:function(){var e,t;this.tail?(e=[Xm.mid(this._head1,this._head2)].concat(jm(this.controls.slice(2))),t=Xm.distance(this._head1,this._head2)):e=this.controls;var i=e.length;return new Zm({controls:e,heightFactor:this._headHeightFactor,neckHeightFactor:this._neckHeightFactor,headWidthFactor:this._headWidthFactor,neckWidthFactor:this._neckWidthFactor,headMaxHeight:this._headTailHeightFactor*t,index:[i-2,i-1]})}},{key:"createBodyComponent",value:function(){var e,t=this.controls.slice(2),i=Xm.distance(this._headComponent.nodes[0],this._headComponent.nodes[4]),n=Xm.baseLength(t);if(this._tail){e=Xm.distance(this.controls[0],this.controls[1]),t=[Xm.mid(this._head1,this._head2)].concat(jm(t));var r=Xm.baseLength(t);this._tailWidthFactor=e/r}else e=n*this._tailWidthFactor,t=this.controls;return new sf({controls:t,headWidthFactor:i/n,tailWidthFactor:this._tailWidthFactor})}},{key:"createTailComponent",value:function(){if(this._bodyComponent){var e=this.controls;return new tf({controls:e,heightFactor:this._tailHeightFactor})}}}]),i}(ef);Nm(af,"MIN_CONTROL_COUNT",2);var lf=function(e){Fm(i,e);var t=Wm(i);function i(e){var n;return Im(this,i),(e=qm(e,{})).neckHeightFactor=qm(e.neckHeightFactor,.8),e.neckWidthFactor=qm(e.neckWidthFactor,.2),e.headWidthFactor=qm(e.headWidthFactor,.5),(n=t.call(this,e))._nodes=[],n.init(),nf(Gm(n)),n.merge(),n}return Om(i,[{key:"addControl",value:function(e){this.controls.length>=i.MAX_CONTROL_COUNT&&this.popControl(),this.controls.push(e),this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"updateControl",value:function(e,t){this.controls[e]=t,this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"popControl",value:function(){return this.controls.pop()}},{key:"init",value:function(){this.controls.length<i.MIN_CONTROL_COUNT||this.getPoints()}},{key:"tempPoint4",value:function(e,t,i){var n,r,o=Xm.mid(e,t),s=Xm.distance(o,i),a=Xm.angleOfThreePoints(e,o,i);a<Math.PI/2||(a<Math.PI&&a>=Math.PI/2?a=Math.PI-a:a>=Math.PI&&a<1.5*Math.PI?a-=Math.PI:a>=1.5*Math.PI&&(a=2*Math.PI-a)),n=s*Math.cos(a),r=s*Math.sin(a);var l=Xm.thirdPoint(e,o,Math.PI/2,n,!0);return Xm.thirdPoint(o,l,Math.PI/2,r,!1)}},{key:"getPoints",value:function(){var e,t,i,n,r,o,s,a=this.controls;if(!(a<3))if(t=3===a.length?this.tempPoint4.apply(this,jm(a)):a[3],i=a.length<=4?Xm.mid(a[0],a[1]):a[4],Xm.isClockWise.apply(Xm,jm(this.controls.slice(0,3)))){var l;e=this.getArrowControls(a[0],i,t,!0),n=new Zm({controls:e,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=Xm.distance(a[0],i)/Xm.baseLength(e)/2,o=this.getBodyControls(e,n.nodes[0],n.nodes[4],s),e=this.getArrowControls(i,a[1],a[2],!1),r=new Zm({controls:e,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=Xm.distance(i,a[1])/Xm.baseLength(e)/2,(l=o).unshift.apply(l,jm(this.getBodyControls(e,r.nodes[0],r.nodes[4],s)));var c=this.geoBodyPoints([n,r],o,i);this._nodes=[].concat(jm(c[0]),jm(n.nodes),jm(c[1]),jm(r.nodes),jm(c[2]))}else{var u;e=this.getArrowControls(a[0],i,t,!1),n=new Zm({controls:e,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=Xm.distance(a[0],i)/Xm.baseLength(e)/2,o=this.getBodyControls(e,n.nodes[0],n.nodes[4],s),e=this.getArrowControls(i,a[1],a[2],!0),r=new Zm({controls:e,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=Xm.distance(i,a[1])/Xm.baseLength(e)/2,(u=o).unshift.apply(u,jm(this.getBodyControls(e,r.nodes[0],r.nodes[4],s)));var h=this.geoBodyPoints([n,r],o,i);this._nodes=[].concat(jm(h[0]),jm(n.nodes),jm(h[1]),jm(r.nodes),jm(h[2]))}}},{key:"getArrowControls",value:function(e,t,i,n){var r=Xm.mid(e,t),o=Xm.distance(r,i),s=Xm.thirdPoint(i,r,0,.3*o,!1),a=Xm.thirdPoint(i,r,0,.5*o,!1);return[r,s=Xm.thirdPoint(r,s,Math.PI/2,o/5,n),a=Xm.thirdPoint(r,a,Math.PI/2,o/4,n),i]}},{key:"geoBodyPoints",value:function(e,t,i){var n=Xm.BezierCurve([this.controls[1],t[0],t[1],e[1].nodes[4]]);return[Xm.BezierCurve([this.controls[0],t[6],t[7],e[0].nodes[0]]),Xm.BezierCurve([e[0].nodes[4],t[5],t[4],i,t[3],t[2],e[1].nodes[0]]),n.reverse()]}},{key:"getBodyControls",value:function(e,t,i,n){for(var r=Xm.distance.apply(Xm,jm(e)),o=Xm.baseLength(e)*n,s=(o-Xm.distance(t,i))/2,a=0,l=[],c=[],u=1;u<e.length-1;u++){var h=Xm.angleOfThreePoints(e[u],e[u-1],e[u+1])/2,d=(o/2-(a+=Xm.distance(e[u-1],e[u]))/r*s)/Math.sin(h);l.push(Xm.thirdPoint(e[u-1],e[u],Math.PI-h,d,!1)),c.push(Xm.thirdPoint(e[u-1],e[u],h,d,!0))}return l.concat(c)}},{key:"merge",value:function(){var e,t;this.reset(),(e=this.polygon).push.apply(e,jm(jm(this.nodes).flat())),(t=this.polyline).push.apply(t,jm(jm(this.nodes).flat()))}}]),i}(ef);Nm(lf,"MIN_CONTROL_COUNT",3),Nm(lf,"MAX_CONTROL_COUNT",5);var cf={straightarrow:"straightarrow",attackarrow:"attackarrow",doublearrow:"doublearrow",validate:function(e){return e===cf.straightarrow||e===cf.attackarrow||e===cf.doublearrow}};const uf={POINT:"point",POLYLINE:"polyline",POLYGON:"polygon",MODEL:"model",LABEL:"label",STRAIGHTARROW:cf.straightarrow,ATTACKARROW:cf.attackarrow,DOUBLEARROW:cf.doublearrow,BILLBOARD:"billboard",MUTIPOINT:"mutipoint",getOGCType:function(e){if(!uf.validate(e))return"unknown";let t="";switch(e){case uf.POINT:case uf.LABEL:case uf.MODEL:case uf.BILLBOARD:t="Point";break;case uf.POLYLINE:t="LineString";break;case uf.STRAIGHTARROW:case uf.ATTACKARROW:case uf.DOUBLEARROW:case uf.POLYGON:t="Polygon";break;case uf.MUTIPOINT:t="MutlPoint"}return t},validate:function(e){return e===uf.POINT||e===uf.POLYLINE||e===uf.POLYGON||e===uf.STRAIGHTARROW||e===uf.ATTACKARROW||e===uf.DOUBLEARROW||e===uf.MODEL||e===uf.LABEL||e===uf.MUTIPOINT||e===uf.BILLBOARD},isPoint:function(e){return e===uf.POINT||e===uf.MODEL||e===uf.LABEL||e===uf.BILLBOARD},isArrow:function(e){return e===uf.ATTACKARROW||e===uf.STRAIGHTARROW||e===uf.DOUBLEARROW}};var hf=Object.freeze(uf);class df extends Rm{constructor(e,t={}){super(e=De(e,{}),t),this._entityOptions=e,this._options=t,this._positions=De(e.position,new Cesium.Cartesian3),this._type=De(t.type,hf.POINT),this._entity=this.createEntity(),this._text=De(e.text,"")}getGeometry(){const e=df.toDegrees(this.positions),t=[e.lon,e.lat,e.height];return{type:hf.getOGCType(this.type),coordinates:t}}createEntity(){super.createEntity(),delete this._entityOptions.position;const e={id:this.id,position:this.positions};return this.type===hf.POINT&&(e.point=ii(this._entityOptions)),this.type===hf.BILLBOARD&&(e.billboard=ii(this._entityOptions),Re(e.billboard.image)||(e.billboard.image=di.buildModuleUrl("./assets/marker.png"))),this.type===hf.LABEL&&(e.label=ii(this._entityOptions)),this.type===hf.MODEL&&(e.orientation=this._entityOptions.orientation,delete this._entityOptions.orientation,e.model=ii(this._entityOptions),Re(e.model.uri)||(e.model.uri=di.buildModuleUrl("./assets/Wood_Tower.gltf"))),this._options.label&&this._type!==hf.LABEL&&(e.label=Cesium.clone(this._options.label)),this._entityOptions=e,new Cesium.Entity(this._entityOptions)}equal(e){return df.equal(this,e)}get text(){return this._text}set text(e){if(this.entity.label)this.entity.label.text=e;else{const t=Cesium.clone(this._entityOptions);t.text=e,this.addLabel(t)}this._text=e}addLabel(e){this.entity.label=e}updatePointStyle(e){if(e&&this.entity.point)for(const t in e)e.hasOwnProperty(t)&&(this.entity.point[t]=e[t])}updateLabelStyle(e){if(e&&this.entity.label)for(const t in e)e.hasOwnProperty(t)&&(this.entity.label[t]=e[t])}updateModelStyle(e){if(e&&this.entity.model)for(const t in e)e.hasOwnProperty(t)&&(this.entity.model[t]=e[t])}updateBillboardStyle(e){if(e&&this.entity.billboard)for(const t in e)e.hasOwnProperty(t)&&(this.entity.billboard[t]=e[t])}updatePosition(e){this.positions.x=e.x,this.positions.y=e.y,this.positions.z=e.z}static equal(e,t){return!(!Re(e)||!Re(t))&&(e instanceof df&&(e=e.positions),t instanceof df&&(t=t.positions),Cesium.Cartesian3.equals(e,t))}static defaultStyle={color:Cesium.Color.RED,pixelSize:5,outlineColor:Cesium.Color.WHITE,outlineWidth:3,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND};static toDegrees(e){return e instanceof Cesium.Cartesian3?Ie.fromCartesian(e):e instanceof df?Ie.fromCartesian(e.positions):void 0}toGeoJson(){return df.toGeoJson(this)}static toGeoJson(e){hf.getOGCType(e.type);const t=e.properties?e.properties.toJson():{};t.PlotType=e.type;return{type:"Feature",properties:t,geometry:e.getGeometry()}}static fromGeoJson(e,t){if("string"==typeof e&&(e=JSON.parse(e)),!Re(e.geometry)||!Re(e.properties))return;if(e.properties.PlotType!==hf.POINT)throw new CesiumProError("json没有包含一个有效的PointGraphic.");const i=e.geometry&&e.geometry.coordinates;return df.fromCoordinates(i,e.properties,t)}static fromCoordinates(e,t,i=df.defaultStyle){const n={position:Cesium.Cartesian3.fromDegrees(...e),properties:t,...i};return new df(n)}static defaultPointStyle=df.defaultStyle;static defaultLabelStyle={font:"30px Helvetica",fillColor:Cesium.Color.WHITE,showBackground:!0,style:Cesium.LabelStyle.FILL_AND_OUTLINE,scale:1,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,0),heightReference:Cesium.HeightReference.NONE};static defaultBillboardStyle={verticalOrigin:Cesium.VerticalOrigin.BASELINE,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND};static defaultModelStyle={colorBlendMode:Cesium.ColorBlendMode.HIGHLIGHT,color:Cesium.Color.WHITE,colorBlendAmount:.5,minimumPixelSize:64}}class pf extends Rm{constructor(e,t={}){super(e,t),this._entityOptions=De(e,{}),this._positions=De(this._entityOptions.positions,[]),this._nodePositions=this._positions,this._type=hf.POLYLINE,this._entity=this.createEntity()}getGeometry(){const e=[],t=hf.getOGCType(this.type);for(const t of this.positions){const i=df.toDegrees(t);e.push([i.lon,i.lat,i.height])}return{type:t,coordinates:e}}createEntity(){super.createEntity();const e={id:this.id,polyline:this._entityOptions};return this._entityOptions=e,new Cesium.Entity(this._entityOptions)}toGeoJson(){return pf.toGeoJson(this)}startEdit(){super.startEdit()}stopEdit(){super.stopEdit()}addNode(e,t){const i=this.positions.length;if(Re(t)&&t<i){for(let e=i;e>t;e--)this.positions[e]=this.positions[e-1];this.positions[t]=e}else this.positions.push(e)}removeNode(e){Re(e)&&(e<0||e>=this.positions.length||this.positions.splice(e,1))}popNode(){const e=this.positions.length-1;this.removeNode(e)}updateNode(e,t){e>=this.positions.length||(this.positions[e]=t)}updateStyle(e){if(e&&this.entity.model)for(const t in e)e.hasOwnProperty(t)&&(this.entity.polyline[t]=e[t])}static toGeoJson(e){hf.getOGCType(e.type);const t=e.properties?e.properties.toJson():{};t.PlotType=e.type;return{type:"Feature",properties:t,geometry:e.getGeometry()}}static fromGeoJson(e,t){if("string"==typeof e&&(e=JSON.parse(e)),!Re(e.geometry)||!Re(e.properties))return;if(e.properties.PlotType!==hf.POLYLINE)throw new CesiumProError("json没有包含一个有效的PolylineGraphic.");const i=e.geometry&&e.geometry.coordinates;return pf.fromCoordinates(i,e.properties,t)}static fromCoordinates(e,t,i=pf.defaultStyle){const n={positions:Cesium.Cartesian3.fromDegreesArray(e.flat()),properties:t,...i};return new pf(n)}static defaultStyle={clampToGround:!0,material:Cesium.Color.fromCssColorString("rgba(247,224,32,1)"),width:3};static highlightStyle={clampToGround:!0,material:Cesium.Color.AQUA,width:3}}class mf extends Rm{constructor(e,t={}){super(e,t),this._entityOptions=e,this._positions=De(e.positions,[]),this._nodePositions=[...this.positions],this._nodePositions.length&&(this._nodePositions[this._nodePositions.length]=this._nodePositions[0]),this._type=hf.POLYGON,this._entity=this.createEntity()}getGeometry(){return mf.getGeometry(this)}static getGeometry(e){const t=[],i=hf.getOGCType(e.type);for(const i of e.positions){const e=df.toDegrees(i);t.push([e.lon,e.lat,e.height])}return t.push(t[0]),{type:i,coordinates:[t]}}createEntity(){super.createEntity(),delete this._entityOptions.positions;const e={id:this.id,polygon:{hierarchy:this.positions,...this._entityOptions}};return this._entityOptions.outline&&(e.polyline={positions:this._nodePositions,material:this._entityOptions.outlineColor,width:this._entityOptions.outlineWidth},e.polygon.outline=!1,e.polyline.clampToGround=this._entityOptions.heightReference===Cesium.HeightReference.CLAMP_TO_GROUND),this._entityOptions=e,new Cesium.Entity(this._entityOptions)}toGeoJson(){return mf.toGeoJson(this)}startEdit(){super.startEdit()}stopEdit(){super.stopEdit()}addNode(e,t){const i=this.positions.length;if(Re(t)&&t<i&&t>=0){for(let e=i;e>t;e--)this.positions[e]=this.positions[e-1],this._nodePositions[e]=this._nodePositions[e-1];this.positions[t]=e,this._nodePositions[t]=e}else t=i,this.positions.push(e),this._nodePositions[t]=e;this._positions.length&&(this._nodePositions[i+1]=this._nodePositions[0])}removeNode(e){if(!Re(e))return;if(e<0||e>=this.positions.length)return;this.positions.splice(e,1),this._nodePositions.splice(e,1);const t=this.positions.length;0===e&&(this._nodePositions[t]=this._nodePositions[0])}popNode(){const e=this.positions.length-1;this.removeNode(e)}updateNode(e,t){if(e>=this.positions.length)return;this.positions[e]=t;const i=this.positions.length;this._nodePositions[e]=t,0===e&&(this._nodePositions[i]=t)}updateStyle(e){if(e&&this.entity.model)for(const t in e)e.hasOwnProperty(t)&&("outline"===t&&!e.outline&&this.entity.polyline&&(this.entity.polyline=void 0),"outlineColor"===t&&this.entity.polyline&&(this.entity.polyline.material=e[t]),"outlineWidth"===t&&this.entity.polyline&&(this.entity.polyline.width=e[t]),this.entity.polygon[t]=e[t])}static toGeoJson(e){hf.getOGCType(e.type);const t=e.properties?e.properties.toJson():{};t.PlotType=e.type;return{type:"Feature",properties:t,geometry:e.getGeometry()}}static fromGeoJson(e,t){if("string"==typeof e&&(e=JSON.parse(e)),!Re(e.geometry)||!Re(e.properties))return;if(e.properties.PlotType!==hf.POLYGON)throw new Le("json没有包含一个有效的PolygonGraphic.");const i=e.geometry&&e.geometry.coordinates;return mf.fromCoordinates(i,e.properties,t)}static fromCoordinates(e,t,i=mf.defaultStyle){const n={positions:Cesium.Cartesian3.fromDegreesArray(e[0].flat()),properties:t,...i};return new mf(n)}static defaultStyle={material:Cesium.Color.fromCssColorString("rgba(247,224,32,0.5)"),outlineColor:Cesium.Color.RED,outlineWidth:2,outline:!1,perPositionHeight:!1,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND};static highlightStyle={material:new Cesium.ColorMaterialProperty(Cesium.Color.AQUA.withAlpha(.4)),outlineColor:Cesium.Color.AQUA.withAlpha(.4)};static centerFromPonits(e){const t=Cesium.BoundingSphere.fromPoints(e);if(t)return t.center}static center(e){let t=[];function i(e){if(e.getValue){const i=e.getValue();t=i instanceof Cesium.PolygonHierarchy?i.positions:i}else Array.isArray(e)&&(t=e)}if(e instanceof Cesium.Entity){const{hierarchy:t}=e.polygon;i(t)}else e.polygonHierarchy?t=e.polygonHierarchy.positions:e.hierarchy&&i(e.hierarchy);return mf.centerFromPonits(t)}static isClockWise(e,t){const i=Cesium.EllipsoidTangentPlane.fromPoints(e,t.scene.globe.ellipsoid),n=Cesium.arrayRemoveDuplicates(e,Cesium.Cartesian3.equalsEpsilon,!0),r=i.projectPointsOntoPlane.bind(i)(n);return Cesium.PolygonPipeline.computeWindingOrder2D(r)===Cesium.WebGLConstants.CW}}const ff=function(e,t,i){if(t===St.SURFACE_DISTANCE||t===St.SPACE_DISTANCE||t===St.HEIGHT){const t=i?"总长度 ":"";return e>1e4?`${t}${(e/1e3).toFixed(2)} km`:`${t}${e.toFixed(2)} m`}return t===St.SURFACE_AREA||t===St.SPACE_AREA?e>1e7?`${(e/1e3/1e3).toFixed(2)} km²`:`${e.toFixed(2)} m²`:t===St.ANGLE?`${(e%360).toFixed(2)}°`:void 0};class gf{constructor(e){this._type=hf.MUTIPOINT,this._positions=De(e.positions,[]),this._entityOptions=e,this._values=[],this.createEntity(),this._activeNode=void 0,this.activeIndex=void 0}get activeNode(){return this._activeNode}set activeNode(e){this._activeNode=e,this.activeIndex=this.getIndexByPosition(e),this.highlightActiveNode()}highlightActiveNode(){const e=this._values.filter((e=>Re(e.position)));for(let t=0,i=e.length;t<i;t++){const i=e[t];t===this.activeIndex?gf.highlightNode(i):(i.point.color=this._entityOptions.color,i.point.outlineColor=this._entityOptions.outlineColor)}}getGeometry(){const e=[],t=hf.getOGCType(this.type);for(const t of this.positions){const i=df.toDegrees(t);e.push([i.lon,i.lat,i.height])}return{type:t,coordinates:e}}static highlightNode(e){e&&e.point&&(e.point.color=Cesium.Color.AQUA,e.point.outlineColor=Cesium.Color.AQUA)}get(e){return this._values.filter((e=>Re(e.position)))[e]}getIndexByPosition(e){for(let t=0,i=this._positions.length;t<i;t++){const i=this._positions[t];if(df.equal(i,e))return t}return-1}has(e){return this._values.includes(e)}createEntity(){delete this._entityOptions.positions;const e=this._entityOptions,t=this._positions.length;for(let i=0;i<t;i++){const t=new Cesium.Entity({position:new Cesium.CallbackProperty((()=>this._positions[i]),!1),point:e});this._values.push(t)}}addNode(e,t){const i=this._entityOptions;if(this._values.length<this._positions.length){return new Cesium.Entity({position:new Cesium.CallbackProperty((()=>this._positions[this._positions.length-1]),!1),point:i})}}removeNode(e){Re(e)}popNode(){const e=this._positions.length-1;return this.removeNode(e)}updateNode(e,t){e>=this._positions.length||(this._positions[e]=t)}destroy(){this._values=void 0}toGeoJson(){return gf.toGeoJson(this)}get values(){return this._values}static toGeoJson(e){hf.getOGCType(graphic.type);const t=graphic.properties?graphic.properties.toJson():{};t.PlotType=graphic.type;return{type:"Feature",properties:t,geometry:graphic.getGeometry()}}static defaultStyle=df.defaultStyle}class yf extends Rm{constructor(e,t={}){if(super(e,t),this._type=De(t.type,hf.STRAIGHTARROW),this._entityOptions=e,this._positions=De(e.positions,[]),this._arrowType=De(t.type,hf.STRAIGHTARROW),!cf.validate(this._arrowType))throw new Le("无效的箭头图形.");const i=[];for(let e of this.positions){const t=df.toDegrees(e);i.push([t.lon,t.lat])}this._arrowType===cf.straightarrow&&(this._arrow=new rf({controls:i})),this._arrowType===cf.attackarrow&&(this._arrow=new af({controls:i})),this._arrowType===cf.doublearrow&&(this._arrow=new lf({controls:i})),this._entity=this.createEntity(),this._nodePositions=this._positions}get arrow(){return this._arrow}getGeometry(){mf.getGeometry(this)}createEntity(){super.createEntity(),delete this._entityOptions.positions;const e={id:this.id,polygon:{hierarchy:this._arrow.polygon.length?Cesium.Cartesian3.fromDegreesArray(this._arrow.polygon):this._arrow.polygon,...this._entityOptions}};return this._entityOptions.outline&&(e.polyline={positions:this._arrow.polyline.length?Cesium.Cartesian3.fromDegreesArray(this._arrow.polyline):this._arrow.polyline,material:this._entityOptions.outlineColor,width:this._entityOptions.outlineWidth},e.polygon.outline=!1),this._entityOptions=e,new Cesium.Entity(this._entityOptions)}startEdit(){}stopEdit(){}addNode(e){if(this.arrow){const t=df.toDegrees(e);this.arrow.addControl([t.lon,t.lat]),this.updatePositions(),this.updateEntity(),this.lastLon=t.lon}}popNode(){this.arrow&&(this.arrow.popControl(),this.updatePositions(),this.updateEntity())}updateNode(e,t){if(this.arrow){const i=df.toDegrees(t);this.arrow.updateControl(e,[i.lon,i.lat]),this.updatePositions(),this.updateEntity()}}updatePositions(){if(!Re(this.arrow))return;const e=this.arrow.controls;for(let t=0;t<e.length;t++)this.positions[t]=Cesium.Cartesian3.fromDegrees(e[t][0],e[t][1]);this.positions.length>e.length&&this.positions.splice(e.length)}updateEntity(){if(this.entity&&this.entity.polygon){const e=this.arrow.polygon.filter((e=>!isNaN(e))),t=this.arrow.polyline.filter((e=>!isNaN(e)));this.entity.polygon.hierarchy=e.length?Cesium.Cartesian3.fromDegreesArray(e):e,this.entity.polyline&&(this.entity.polyline.positions=t.length?Cesium.Cartesian3.fromDegreesArray([...t,t[0],t[1]]):t)}}}const{LEFT_CLICK:vf,MOUSE_MOVE:_f,RIGHT_CLICK:xf,LEFT_DOWN:Cf,LEFT_UP:wf,LEFT_DOUBLE_CLICK:bf,RIGHT_DOWN:Sf,RIGHT_UP:Tf}=Cesium.ScreenSpaceEventType,Ef=1,Pf=3;const{Material:Af,Color:Mf,Property:Lf}=Cesium;class Df{constructor(e={}){this._fadeInColor=De(e.fadeInColor,Cesium.Color.RED),this._fadeOutColor=De(e.fadeOutColor,Cesium.Color.WHITE.withAlpha(.5)),this._time=De(e.time,new Cesium.Cartesian2(0,0)),this._repeat=De(e.repeat,!1),this._duration=De(e.duration,3e3),this._fadeDirection=De(e.fadeDirection,{x:!0,y:!1}),this._maximumDistance=De(e.maximumDistance,.5),this._definitionChanged=new Be}get fadeInColor(){return this._fadeInColor}set fadeInColor(e){this._fadeInColor=e}get fadeOutColor(){return this._fadeOutColor}set fadeOutColor(e){this._fadeOutColor=e}get duration(){return this._duration}set duration(e){this._duration=e}get time(){return this._time}set time(e){this._time=e}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get fadeDirection(){return this._fadeDirection}set fadeDirection(e){this._fadeDirection=e}get repeat(){return this._repeat}set repeat(e){this._repeat=e}get maximumDistance(){return this._maximumDistance}set maximumDistance(e){this._maximumDistance=e}getType(){return Af.FadeType}getValue(e,t){return t=De(t,{}),void 0===this._time&&(this._time={x:e.secondsOfDay,y:e.secondsOfDay}),this.fadeDirection.x&&(t.time.x=1e3*(e.secondsOfDay-this.time.x)/this.duration%1),this.fadeDirection.y&&(t.time.y=1e3*(e.secondsOfDay-this.time.y)/this.duration%1),t.fadeInColor=this.fadeInColor,t.fadeOutColor=this.fadeOutColor,t.maximumDistance=this.maximumDistance,t.repeat=this.repeat,t.fadeDirection=this.fadeDirection,t}equals(e){return this===e||e instanceof Df&&this.fadeInColor===e.fadeInColor&&this.fadeOutColor===e.fadeOutColor&&this.maximumDistance===e.maximumDistance&&this.repeat===e.repeat&&this.fadeDirection===e.fadeDirection}}const Rf="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  vec2 st=materialInput.st*repeat;\n  float s=1.0-fract(time-st.s);\n  if(wrapX){\n    s= s=1.0-fract(time-st.t);\n  }\n  vec4 imageRGBA=texture2D(image,vec2(s,st.t));\n  material.alpha = imageRGBA.a * color.a;\n\tmaterial.diffuse = max(color.rgb * material.alpha * gradient, color.rgb);\n  return material;\n}\n",{Material:If,Color:kf}=Cesium;If.DynamicFlowWallType="DynamicFlowWall",If._materialCache.addMaterial(If.DynamicFlowWallType,{fabric:{type:If.DynamicFlowWallType,uniforms:{color:new kf(1,0,0),time:0,gradient:1,image:"",repeat:{x:1,y:1},wrapX:!1},source:Rf}});class Of{constructor(e={}){this._color=De(e.color,Cesium.Color.RED),this._time=0,this._duration=De(e.duration,1e3),this._gradient=De(e.gradient,1),this._image=De(e.image,di.buildModuleUrl("./assets/images/wall.png")),this._wrapX=De(e.wrapX,!1),this._repeat=De(e.repeat,new Cesium.Cartesian2(1,1)),this._definitionChanged=new Be}get color(){return this._color}get time(){return this._time}get definitionChanged(){return this._definitionChanged}get isConstant(){return!1}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}get gradient(){return this._gradient>0?this._gradient:0}set gradient(e){this._gradient=e}get image(){return this._image}set image(e){this._image=e}get wrapX(){return this._wrapX}set wrapX(e){this._wrapX=e}get repeat(){return this._repeat}set repeat(e){this._repeat=e}getType(e){return If.DynamicFlowWallType}getValue(e,t){return(t=De(t,{})).color=this.color,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.gradient=this.gradient,t.image=this.image,t.wrapX=this.wrapX,t.repeat=this.repeat,t}equals(e){return this===e||e instanceof Of&&this.color===e.color&&this.gradient===e.gradient&&this.image===e.image&&this.wrapX===e.wrapX&&this.repeat===e.repeat}}const Nf="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  vec2 st=materialInput.st;\n  float per=fract(time);\n  float dis=distance(st,vec2(0.5));\n  if(dis*2.0>per){\n    discard;\n  }else{\n    material.alpha=pow(color.a*dis*2.0/per,gradient);\n    material.diffuse=color.rgb;\n  }\n  return material;\n}\n",{Material:Ff,Color:zf}=Cesium;Ff.DynamicSpreadType="DynamicSpread",Ff._materialCache.addMaterial(Ff.DynamicSpreadType,{fabric:{type:Ff.DynamicSpreadType,uniforms:{color:new zf(1,0,0),time:0,gradient:0},source:Nf}});class Bf{constructor(e={}){this._color=De(e.color,Cesium.Color.RED),this._time=0,this._duration=De(e.duration,1e3),this._gradient=De(e.gradient,4),this._definitionChanged=new Be}get color(){return this._color}get time(){return this._time}get definitionChanged(){return this._definitionChanged}get isConstant(){return!1}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}get gradient(){return this._gradient}set gradient(e){this._gradient=e}getType(e){return Ff.DynamicSpreadType}getValue(e,t){return(t=De(t,{})).color=this.color,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.gradient=this.gradient,t}equals(e){return this===e||e instanceof Bf&&this.color===e.color&&this.gradient===e.gradient}}const Gf="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  material.diffuse=1.5*color.rgb;\n  vec2 st=materialInput.st;\n  vec3 str=materialInput.str;\n  float dis=distance(st,vec2(0.5));\n  float per=fract(time);\n  if(dis>=0.5){\n    discard;\n  }else{\n    float perDis=0.5/count;\n    float bl=0.0;\n    for(int i=0;i<99;i++){\n      if(float(i)>count){\n        break;\n      }\n      float disNum=perDis*float(i)-dis+per/count;\n      if(disNum>0.0){\n        if(disNum<perDis){\n          bl=1.0-disNum/perDis;\n        }else if(disNum-perDis<perDis){\n          bl=1.0-abs(1.0-disNum/perDis);\n        }\n        material.alpha=pow(bl,gradient);\n      }\n    }\n  }\n  return material;\n}\n",{Material:Hf,Color:Wf,Property:Uf}=Cesium;Hf.DynamicWaveType="DynamicWave",Hf._materialCache.addMaterial(Hf.DynamicWaveType,{fabric:{type:Hf.DynamicWaveType,uniforms:{count:1,color:Wf.RED,duration:1e3,time:0,gradient:.1},source:Gf}});class jf{constructor(e={}){this._color=De(e.color,Cesium.Color.RED),this._time=De(e.time,0),this._duration=De(e.duration,1e3),this._count=De(e.count,3),this._gradient=De(e.gradient,1),this._gradient=Cesium.Math.clamp(this._gradient,0,1),this._definitionChanged=new Be}get color(){return this._color}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}get time(){return this._time}set time(e){this._time=e}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get count(){return this._count}set count(e){this._count=e}get gradient(){return this._gradient}set gradient(e){this._gradient=e}getType(){return Hf.DynamicWaveType}getValue(e,t){return t=De(t,{}),void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.color=this.color,t.count=this.count,t.duration=this.duration,t.gradient=10*this.gradient+1,t}equals(e){return this===e||e instanceof jf&&this.count===e.count&&this.duration===e.duration&&this.color===e.color&&this.gradient===e.gradient}}const{Material:Vf,Color:qf}=Cesium;class $f{constructor(e={}){this._definitionChanged=new Be,this._color=void 0,this.color=e.color}get isConstant(){return!0}get definitionChanged(){return this._definitionChanged}getType(){return $f.materialType}getValue(e,t={}){return t.color=this.color||qf.RED,t}equals(e){return this===e||e instanceof $f&&e.color===this.color}static materialType="PolylineAntialiasing"}Vf._materialCache.addMaterial($f.materialType,{fabric:{type:$f.materialType,uniforms:{color:new qf(1,1,1,1)},source:"\n    czm_material czm_getMaterial(czm_materialInput materialInput) { \n\n      czm_material material = czm_getDefaultMaterial(materialInput); \n\n      vec2 st = materialInput.st; \n\n      material.diffuse = color.rgb * vec3(2.0); \n\n      float dis = 1.0 - abs(0.5 - st.t) * 2.0;\n      material.alpha = pow(dis * color.a, 3.0); \n\n      return material; \n\n    }\n    "},translucent:!0});const Yf="\n  czm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  vec4 imageRgba=texture2D(image, vec2(1.0 - fract(time - st.s),st.t));\n  material.alpha =imageRgba.a * color.a;\n  material.diffuse = max(color.rgb * material.alpha * 3.0, color.rgb);\n  return material;\n}\n",{Material:Xf,Color:Jf}=Cesium;Xf.PolylineFlowType="PolylineFlow",Xf._materialCache.addMaterial(Xf.PolylineFlowType,{fabric:{type:Xf.PolylineFlowType,uniforms:{color:new Jf(1,0,0),image:"",time:0},source:Yf}});class Zf{constructor(e={}){this._color=De(e.color,Cesium.Color.RED),this._time=De(e.time,0),this._image=De(e.image,di.buildModuleUrl("./assets/images/flowLine.png")),this._duration=De(e.duration,1e3),this._definitionChanged=new Be}get color(){return this._color}get time(){return this._time}get image(){return this._image}set image(e){this._image=e}get definitionChanged(){return this._definitionChanged}get isConstant(){return!0}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}getType(e){return Xf.PolylineFlowType}getValue(e,t){return(t=De(t,{})).color=this.color,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.image=this.image,t}equals(e){return this===e||e instanceof Zf&&this.color===e.color&&this.image===e.image}}const{Material:Qf,Color:Kf}=Cesium;Qf.ODLineType="ODLine",Qf._materialCache.addMaterial(Qf.ODLineType,{fabric:{type:Qf.ODLineType,uniforms:{startTime:0,speed:2.3,bidirectional:2,baseColor:Kf.RED,color:Kf.WHITE},source:"\n    czm_material czm_getMaterial(czm_materialInput materialInput) {\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st;\n      float t = fract(startTime + czm_frameNumber * speed / 1000.0);\n      t *= 1.03;\n      float alpha0 = smoothstep(t - 0.03, t, st.s) * step(st.s, t);\n      float mt = 1. - t;\n      float alpha1 = smoothstep(mt + 0.03, mt, st.s) * step(mt, st.s);\n\n      float a0 = step(abs(bidirectional - 0.0) - 0.001, 0.);//1\n      float a1 = step(abs(bidirectional - 1.0) - 0.001, 0.);//\n      float db = step(abs(bidirectional - 2.0) - 0.001, 0.);\n      float alpha = alpha0 * (a0 + db) + alpha1 * (a1 + db);\n      alpha = clamp(alpha, 0., 1.);    \n      material.diffuse = color.rgb * alpha + baseColor.rgb * (1. - alpha);\n      material.alpha = (color.a * alpha + baseColor.a * (1. - alpha));\n      return material;\n    }"}});class eg{constructor(e={}){this.baseColor=De(e.baseColor,Cesium.Color.RED),this.color=De(e.color,Cesium.Color.WHITE),this.speed=De(e.speed,3),this.startTime=De(e.startTime,Math.random()),this.bidirectional=De(e.bidirectional,2),this._definitionChanged=new Event}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(){return Qf.ODLineType}getValue(e,t){return(t=De(t,{})).baseColor=this.baseColor,t.color=this.color,t.speed=this.speed,t.startTime=this.startTime,t.bidirectional=this.bidirectional,t}equals(e){return this===e||e instanceof eg&&this.baseColor===e.baseColor&&this.speed===e.speed&&this.color===e.color&&this.startTime===e.startTime&&this.bidirectional===e.bidirectional}}const tg="czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n         czm_material material = czm_getDefaultMaterial(materialInput);\n         vec2 st = materialInput.st;\n         vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n         material.alpha=colorImage.a*color.a;\n         float factor=colorImage.a;\n         material.diffuse=mix(color.rgb,colorImage.rgb,factor);\n         return material;\n        }",{Material:ig,Color:ng}=Cesium;ig.PolylineTrailLinkType="PolylineTrailLink",ig._materialCache.addMaterial(ig.PolylineTrailLinkType,{fabric:{type:ig.PolylineTrailLinkType,uniforms:{color:new ng(1,0,0),image:"",time:0},source:tg}});class rg{constructor(e={}){this._color=De(e.color,Cesium.Color.RED),this._time=De(e.time,0),this._image=De(e.image,di.buildModuleUrl("./assets/images/colors.png")),this._duration=De(e.duration,1e3),this._definitionChanged=new Be}get color(){return this._color}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}get time(){return this._time}set time(e){this._time=e}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get image(){return this._image}set image(e){this._image=e}getType(){return ig.PolylineTrailLinkType}getValue(e,t){return t=De(t,{}),void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.color=this.color,t.image=this.image,t}equals(e){return this===e||e instanceof rg&&this.color===e.color&&this.image===e.image}}Cesium;const{BoundingRectangle:og,Cartesian3:sg,Cartographic:ag,Color:lg,defined:cg,destroyObject:ug,Matrix4:hg,OrthographicOffCenterFrustum:dg,PixelFormat:pg,ClearCommand:mg,Framebuffer:fg,PassState:gg,PixelDatatype:yg,Texture:vg,PolygonGeometry:_g,PolygonHierarchy:xg,BoundingSphere:Cg,VertexArray:wg,BufferUsage:bg,ShaderProgram:Sg,RenderState:Tg,WebGLConstants:Eg,DrawCommand:Pg,PrimitiveType:Ag,Pass:Mg,Transforms:Lg,CustomShader:Dg,UniformType:Rg,TextureUniform:Ig,TextureManager:kg,ShaderSource:Og}=Cesium,Ng=kg.prototype.loadTexture2D;kg.prototype.loadTexture2D=function(e,t){t.texture?this._textures[e]=t.texture:Ng(e,t)};class Fg{constructor(){this.viewMatrix=hg.IDENTITY,this.inverseViewMatrix=hg.IDENTITY,this.frustum=new dg,this.positionCartographic=new ag,this.upWC=sg.clone(sg.UNIT_Y),this.rightWC=sg.clone(sg.UNIT_X),this.directionWC=sg.clone(sg.UNIT_Z),this.viewPorjectionMatrix=hg.IDENTITY}clone(e){hg.clone(e.viewMatrix,this.viewMatrix),hg.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),ag.clone(e.positionCartographic,this.positionCartographic),sg.clone(e.upWC,this.upWC),sg.clone(e.rigtWC,this.rightWC),sg.clone(e.directionWC,this.directionWC)}}function zg(e){const t=parseInt(this._width),i=parseInt(this._height),n=this._colorTexture,r=cg(n)&&n.width!==t&&n.height!==i;cg(this.frameBuffer)||r||(n&&!n.isDestroyed()&&n.destroy(),this._depthStenclilTexture&&!this._depthStenclilTexture.isDestroyed()&&this._depthStenclilTexture.destroy(),this.frameBuffer&&!this.frameBuffer.isDestroyed()&&this.frameBuffer.destroy(),this._colorTexture=new vg({context:this._frameState.context,width:this._width,height:this._height,pixelFormat:pg.RGBA,pixelDatatype:yg.UNSIGNED_BYTE}),window._colorTexture=this._colorTexture,this._clearPassState=new gg(e.context),this._depthStenclilTexture=new vg({context:e.context,width:t,height:i,pixelFormat:pg.DEPTH_STENCIL,pixelDatatype:yg.UNSIGNED_INT_24_8}),this.frameBuffer=new fg({context:e.context,colorTextures:[this._colorTexture],depthStencilTexture:this._depthStenclilTexture,destroyAttachments:!1}))}const{AssociativeArray:Bg,destroyObject:Gg,CustomDataSource:Hg,Event:Wg}=Cesium,Ug=function(){return{}},jg=[31638318];for(let e=1;e<20;e++)jg.push(jg[e-1]/2);function Vg(e){let t=0;for(let i of jg){if(e>i)break;t++}return t}class qg extends qc{constructor(e={}){super(e),this._id=De(e.id,Ii()),this._createGeometryFunction=e.createGeometryFunction,this._data=e.objects,this._needReclass=!0,this._changeEvent=new Wg,this._maxClusterLevel=De(e.maxClusterLevel,12),this._minLoadLevel=De(e.minLoadLevel,12),this._geometryCached={},this._objectsCached={}}get id(){return this._id}get dataSource(){return this._dataSource}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(e){this._minLoadLevel=e}get objects(){return this._objects||this._data}set objects(e){this._objects=e}updateCluster(e){const t=Vg(e),i=this._objects;return t>this._maxClusterLevel?(this._objects=this._data,this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._objectsCached[t]?(this._objects=this._objectsCached[t],this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._cluster?new Promise(((e,i)=>{this._cluster.update(),this._objects=this._cluster._clusterObjects,this._objectsCached[t]=JSON.parse(JSON.stringify(this._objects)),this._needReclass=!0,e(!0)})):void 0}beginUpdate(e){Vg(e.camera.positionCartographic.height)<this._minLoadLevel?this._objects=[]:this._objects=this._data}endUpdate(e){const t=Vg(e.camera.positionCartographic.height);return this._needReclass=!1,t<this._minLoadLevel}initialize(e,t){this._dataSource||(this._scene=t,this._dataSource=new Hg("massive-layer"+Ii()),this._scene.dataSources.add(this._dataSource))}createGeometry(e,t,i){if(e.level<this._minLoadLevel)return;const n=De(this._createGeometryFunction,Ug)(i,e,t),r=Object.keys(i);for(let e of r)"position"!==e&&"id"!==e&&"cartesian"!==e&&"cartographic"!==e&&"label"!==e&&"billboard"!==e&&"__pixel"!==e&&(n[e]=i[e]);return this.add(n),n}removeGeometry(e,t){if(!t)return;const i=this._dataSource.entities.remove(t);return Gg(t),i}add(e){this._dataSource&&e&&this._dataSource.entities.add(e)}removeAll(){this._dataSource.entities.removeAll()}isDestroyed(){return!1}destroy(){this._dataSource.removeAll(),Gg(this)}}const{QuadtreeTileProvider:$g,GeographicTilingScheme:Yg,when:Xg,Event:Jg,Cartographic:Zg,Color:Qg,Entity:Kg}=Cesium;const{destroyObject:ey,Event:ty,Transforms:iy}=Cesium,ny=function(e,t){const i={};if(e.modelMatrix)i.modelMatrix=e.modelMatrix;else if(e.position){let t=e.position;if(e.position instanceof Ie&&(t=e.position.toCartesian()),!t)return;i.modelMatrix=iy.eastNorthUpToFixedFrame(t),e.modelMatrix=i.modelMatrix}return i.minimumPixelSize=De(e.minimumPixelSize,t.minimumPixelSize),i.maximumScale=De(e.maximumScale,t.maximumScale),i.scale=De(e.scale,t.scale),i.allowPicking=De(e.allowPicking,t.allowPicking),i.shadows=De(e.shadows,t.shadows),i.id=e._id,i.url=De(e.url,t.url),Cesium.Model.fromGltf(i)},ry=[31638318];for(let e=1;e<20;e++)ry.push(ry[e-1]/2);function oy(e){let t=0;for(let i of ry){if(e>i)break;t++}return t}const{QuadtreeTileProvider:sy,GeographicTilingScheme:ay,when:ly,Event:cy,Cartographic:uy,Color:hy,Entity:dy,createGuid:py}=Cesium;const my="\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n    float time = (czm_frameNumber * speed / 1000.0);\n    vec2 st = fract(repeat * materialInput.st);\n    st = vec2(fract(time - st.s), st.t);\n    vec4 imageColor = texture2D(image, st);\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    float alpha = 1.0 - (abs(0.5 - st.t) * 2.0);\n    material.alpha = imageColor.a * color.a * alpha;\n    material.diffuse = imageColor.rgb * color.rgb;\n    return material;\n}\n",{Material:fy,Cartesian2:gy,Color:yy}=Cesium;fy.FlowImageType="FlowImage",fy._materialCache.addMaterial(fy.FlowImageType,{fabric:{type:fy.FlowImageType,uniforms:{color:new yy(1,1,1,1),repeat:new gy(1,1),image:"",speed:1},source:my}});class vy{constructor(e){e=De(e,{}),this._options=e,this._postProcessStage=void 0}addTo(e){if(Fe(e),Re(this._viewer)||(this._viewer=e),this._postProcessStage||(this._postProcessStage=this.createPostStage()),!this._viewer.scene.postProcessStages.contains(this._postProcessStage)){if(!this._postProcessStage)throw new Le("createPostStage method must reture a Cesium.PostProcessStage object.");return this._viewer.scene.postProcessStages.add(this._postProcessStage)}}createPostStage(){throw new Le("抽象类不能被直接调用")}get selected(){return this._postProcessStage?this._postProcessStage.selected:[]}set selected(e){this._postProcessStage&&(this._postProcessStage.selected=e)}get enabled(){if(this._postProcessStage)return this._postProcessStage.enabled}set enabled(e){this._postProcessStage&&(this._postProcessStage.enabled=e)}remove(){if(this._viewer)return this._viewer.scene.postProcessStages.remove(this._postProcessStage)}destroy(){this.remove(),this._postProcessStage.isDestroyed()||this._postProcessStage.destroy(),this._viewer=void 0}zoomTo(){if(this._viewer&&this.center)return this.viewer.flyTo(this.center,{duration:0})}}var _y='#ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform bool u_showIntersection;\nuniform bool u_showThroughEllipsoid;\n\nuniform float u_radius;\nuniform float u_xHalfAngle;\nuniform float u_yHalfAngle;\nuniform float u_normalDirection;\nuniform vec4 u_color;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvec4 getColor(float sensorRadius, vec3 pointEC)\n{\n  czm_materialInput materialInput;\n\n  vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\n  materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\n  materialInput.str = pointMC / sensorRadius;\n\n  vec3 positionToEyeEC = -v_positionEC;\n  materialInput.positionToEyeEC = positionToEyeEC;\n\n  vec3 normalEC = normalize(v_normalEC);\n  materialInput.normalEC = u_normalDirection * normalEC;\n\n  czm_material material = czm_getMaterial(materialInput);\n\n  material.diffuse = u_color.rgb;\n  material.alpha = u_color.a;\n\n  return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);\n\n}\n\nbool isOnBoundary(float value, float epsilon)\n{\n  float width = getIntersectionWidth();\n  float tolerance = width * epsilon;\n\n#ifdef GL_OES_standard_derivatives\n  float delta = max(abs(dFdx(value)), abs(dFdy(value)));\n  float pixels = width * delta;\n  float temp = abs(value);\n  // There are a couple things going on here.\n  // First we test the value at the current fragment to see if it is within the tolerance.\n  // We also want to check if the value of an adjacent pixel is within the tolerance,\n  // but we don\'t want to admit points that are obviously not on the surface.\n  // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\n  // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\n  // the points is close to zero.\n  return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\n#else\n  return abs(value) < tolerance;\n#endif\n}\n\nvec4 shade(bool isOnBoundary)\n{\n  if (u_showIntersection && isOnBoundary)\n  {\n      return getIntersectionColor();\n  }\n  return getColor(u_radius, v_positionEC);\n}\n\nfloat ellipsoidSurfaceFunction(czm_ellipsoid ellipsoid, vec3 point)\n{\n  vec3 scaled = ellipsoid.inverseRadii * point;\n  return dot(scaled, scaled) - 1.0;\n}\n\nvoid main()\n{\n  vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\n  vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\n\n  //vec3 pixDir = normalize(v_position);\n  float positionX = v_position.x;\n  float positionY = v_position.y;\n  float positionZ = v_position.z;\n\n  vec3 zDir = vec3(0.0, 0.0, 1.0);\n  vec3 lineX = vec3(positionX, 0 ,positionZ);\n  vec3 lineY = vec3(0, positionY, positionZ);\n  float resX = dot(normalize(lineX), zDir);\n  if(resX < cos(u_xHalfAngle) - 0.0001){\n      discard;\n  }\n  float resY = dot(normalize(lineY), zDir);\n  if(resY < cos(u_yHalfAngle)- 0.0001){\n      discard;\n  }\n\n\n  czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n  float ellipsoidValue = ellipsoidSurfaceFunction(ellipsoid, v_positionWC);\n\n  // Occluded by the ellipsoid?\nif (!u_showThroughEllipsoid)\n{\n    // Discard if in the ellipsoid\n    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\n    if (ellipsoidValue < 0.0)\n    {\n          discard;\n    }\n\n    // Discard if in the sensor\'s shadow\n    if (inSensorShadow(sensorVertexWC, ellipsoid, v_positionWC))\n    {\n        discard;\n    }\n  }\n\n  // Notes: Each surface functions should have an associated tolerance based on the floating point error.\n  bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\n  gl_FragColor = shade(isOnEllipsoid);\n\n}',xy="\nuniform vec4 u_intersectionColor;\nuniform float u_intersectionWidth;\nuniform vec4 u_lineColor;\nbool inSensorShadow(vec3 coneVertexWC, czm_ellipsoid ellipsoidEC, vec3 pointWC)\n{\n  // Diagonal matrix from the unscaled ellipsoid space to the scaled space.\n  vec3 D = ellipsoidEC.inverseRadii;\n\n  // Sensor vertex in the scaled ellipsoid space\n  vec3 q = D * coneVertexWC;\n  float qMagnitudeSquared = dot(q, q);\n  float test = qMagnitudeSquared - 1.0;\n\n  // Sensor vertex to fragment vector in the ellipsoid's scaled space\n  vec3 temp = D * pointWC - q;\n  float d = dot(temp, q);\n\n  // Behind silhouette plane and inside silhouette cone\n  return (d < -test) && (d / length(temp) < -sqrt(test));\n}\n\n///////////////////////////////////////////////////////////////////////////////\n\nvec4 getLineColor()\n{\n  return u_lineColor;\n}\n\nvec4 getIntersectionColor()\n{\n  return u_intersectionColor;\n}\n\nfloat getIntersectionWidth()\n{\n  return u_intersectionWidth;\n}\n\nvec2 sensor2dTextureCoordinates(float sensorRadius, vec3 pointMC)\n{\n  // (s, t) both in the range [0, 1]\n  float t = pointMC.z / sensorRadius;\n  float s = 1.0 + (atan(pointMC.y, pointMC.x) / czm_twoPi);\n  s = s - floor(s);\n\n  return vec2(s, t);\n}",Cy='\n#ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform bool u_showIntersection;\nuniform bool u_showThroughEllipsoid;\n\nuniform float u_radius;\nuniform float u_xHalfAngle;\nuniform float u_yHalfAngle;\nuniform float u_normalDirection;\nuniform float u_type;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvec4 getColor(float sensorRadius, vec3 pointEC)\n{\n  czm_materialInput materialInput;\n\n  vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\n  materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\n  materialInput.str = pointMC / sensorRadius;\n\n  vec3 positionToEyeEC = -v_positionEC;\n  materialInput.positionToEyeEC = positionToEyeEC;\n\n  vec3 normalEC = normalize(v_normalEC);\n  materialInput.normalEC = u_normalDirection * normalEC;\n\n  czm_material material = czm_getMaterial(materialInput);\n\n  return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);\n\n}\n\nbool isOnBoundary(float value, float epsilon)\n{\n  float width = getIntersectionWidth();\n  float tolerance = width * epsilon;\n\n#ifdef GL_OES_standard_derivatives\n  float delta = max(abs(dFdx(value)), abs(dFdy(value)));\n  float pixels = width * delta;\n  float temp = abs(value);\n  // There are a couple things going on here.\n  // First we test the value at the current fragment to see if it is within the tolerance.\n  // We also want to check if the value of an adjacent pixel is within the tolerance,\n  // but we don\'t want to admit points that are obviously not on the surface.\n  // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\n  // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\n  // the points is close to zero.\n  return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\n#else\n  return abs(value) < tolerance;\n#endif\n}\n\nvec4 shade(bool isOnBoundary)\n{\n  if (u_showIntersection && isOnBoundary)\n  {\n      return getIntersectionColor();\n  }\n  if(u_type == 1.0){\n      return getLineColor();\n  }\n  return getColor(u_radius, v_positionEC);\n}\n\nfloat ellipsoidSurfaceFunction(czm_ellipsoid ellipsoid, vec3 point)\n{\n  vec3 scaled = ellipsoid.inverseRadii * point;\n  return dot(scaled, scaled) - 1.0;\n}\n\nvoid main()\n{\n  vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\n  vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\n\n  //vec3 pixDir = normalize(v_position);\n  float positionX = v_position.x;\n  float positionY = v_position.y;\n  float positionZ = v_position.z;\n\n  vec3 zDir = vec3(0.0, 0.0, 1.0);\n  vec3 lineX = vec3(positionX, 0 ,positionZ);\n  vec3 lineY = vec3(0, positionY, positionZ);\n  float resX = dot(normalize(lineX), zDir);\n  if(resX < cos(u_xHalfAngle)-0.00001){\n      discard;\n  }\n  float resY = dot(normalize(lineY), zDir);\n  if(resY < cos(u_yHalfAngle)-0.00001){\n      discard;\n  }\n\n\n  czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n  float ellipsoidValue = ellipsoidSurfaceFunction(ellipsoid, v_positionWC);\n\n  // Occluded by the ellipsoid?\nif (!u_showThroughEllipsoid)\n{\n    // Discard if in the ellipsoid\n    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\n    if (ellipsoidValue < 0.0)\n    {\n          discard;\n    }\n\n    // Discard if in the sensor\'s shadow\n    if (inSensorShadow(sensorVertexWC, ellipsoid, v_positionWC))\n    {\n        discard;\n    }\n  }\n\n  // Notes: Each surface functions should have an associated tolerance based on the floating point error.\n  bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\n  //isOnEllipsoid = false;\n  //if((resX >= 0.8 && resX <= 0.81)||(resY >= 0.8 && resY <= 0.81)){\n  /*if(false){\n      gl_FragColor = vec4(1.0,0.0,0.0,1.0);\n  }else{\n      gl_FragColor = shade(isOnEllipsoid);\n  }\n*/\n  gl_FragColor = shade(isOnEllipsoid);\n\n}',wy="attribute vec4 position;\nattribute vec3 normal;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n  gl_Position = czm_modelViewProjection * position;\n  v_position = vec3(position);\n  v_positionWC = (czm_model * position).xyz;\n  v_positionEC = (czm_modelView * position).xyz;\n  v_normalEC = czm_normal * normal;\n}";const{Matrix4:by,Material:Sy,Color:Ty,JulianDate:Ey,BoundingSphere:Py,DrawCommand:Ay,PrimitiveType:My,SceneMode:Ly,Matrix3:Dy,Buffer:Ry,BufferUsage:Iy,VertexArray:ky,VertexFormat:Oy,ComponentDatatype:Ny,RenderState:Fy,BlendingState:zy,Pass:By,combine:Gy,CullFace:Hy,Cartesian3:Wy,EllipsoidGeometry:Uy,EllipsoidOutlineGeometry:jy,ShaderSource:Vy,ShaderProgram:qy}=Cesium,{cos:$y,sin:Yy,tan:Xy,atan:Jy}=Math,Zy=Cesium.Math,Qy={position:0,normal:1};function Ky(e,t,i,n,r,o,s,a,l,c,u,h){c&&i&&(i.vertexArray=s,i.renderState=r,i.shaderProgram=o,i.uniformMap=Gy(a,e._material._uniforms),i.uniformMap.u_normalDirection=function(){return-1},i.pass=u,i.modelMatrix=l,e._colorCommands.push(i)),t.vertexArray=s,t.renderState=n,t.shaderProgram=o,t.uniformMap=Gy(a,e._material._uniforms),h&&(t.uniformMap.u_type=function(){return 1}),t.pass=u,t.modelMatrix=l,e._colorCommands.push(t)}function ev(e,t,i){const n=e.slice,r=$y(i),o=Xy(i),s=$y(t),a=Xy(t),l=Jy(s*o),c=Jy(r*a),u=[];for(let e=0;e<n;e++){const t=2*l*e/(n-1)-l;u.push(new Wy(0,Yy(t),$y(t)))}const h=[];for(let e=0;e<n;e++){const t=2*c*e/(n-1)-c;h.push(new Wy(Yy(t),0,$y(t)))}return{zoy:u,zox:h}}function tv(e,t){const i=t.length-1,n=new Float32Array(9*i);let r=0;for(let e=0;e<i;e++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=t[e].x,n[r++]=t[e].y,n[r++]=t[e].z,n[r++]=t[e+1].x,n[r++]=t[e+1].y,n[r++]=t[e+1].z;const o=Ry.createVertexBuffer({context:e,typedArray:n,usage:Iy.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:Qy.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:Ny.FLOAT,offsetInBytes:0,strideInBytes:s}];return new ky({context:e,attributes:a})}const{VertexFormat:iv}=Cesium;const nv="\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform float alpha;\nuniform float snowDensity;\nvarying vec2 v_textureCoordinates;\nuniform float speed;\nfloat snow(vec2 uv,float scale){\n  float time = czm_frameNumber/speed ;\n  float w=smoothstep(1.,0.,-uv.y*(scale/10.));\n  if(w<.1)return 0.;\n  uv+=time/scale;\n  uv.y+=time*2./scale;\n  uv.x+=sin(uv.y+time*.5)/scale;\n  uv*=scale;\n  vec2 s=floor(uv),f=fract(uv),p;\n  float k=3.;\n  p=.5+.35*sin(11.*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.))-f;\n  float d=length(p);\n  k=min(d,k);\n  k=smoothstep(0.,k,sin(f.x+f.y)*0.01);\n  return k*w;\n}\nvoid main(){\n  vec4 bgColor=vec4(0.0);\n  vec4 color = texture2D(colorTexture, v_textureCoordinates);\n  vec4 depth = texture2D(depthTexture, v_textureCoordinates);\n  vec2 resolution = czm_viewport.zw;\n  vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n  vec3 snowColor=vec3(0);\n  float c = 0.0;\n  float per=20.0/snowDensity;\n  for(float scale=2.0;scale<=20.0;scale++){\n    if(scale>snowDensity){\n      break;\n    }\n    c+=snow(uv,scale*per);\n  }\n  //雪花\n  snowColor=(vec3(c));\n  if (depth.r >= 1.0) {\n    gl_FragColor = color;\n    return;\n  }\n  vec4 positionEC = czm_p_toEye(gl_FragCoord.xy, czm_unpackDepth(texture2D(depthTexture, v_textureCoordinates)));\n  vec3 dx = dFdx(positionEC.xyz);\n  vec3 dy = dFdy(positionEC.xyz);\n  vec3 nor = normalize(cross(dx,dy));\n  vec4 positionWC = normalize(czm_inverseView * positionEC);\n  vec3 normalWC = normalize(czm_inverseViewRotation * nor);\n  float dotNumWC = dot(positionWC.xyz,normalWC);\n  //雪地\n  bgColor = mix(color,vec4(1.0),alpha * max(dotNumWC, 0.3));\n  gl_FragColor = mix(bgColor,vec4(snowColor,1.0),0.5);\n}";const rv="\nattribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_positionMC;\nvarying vec2 v_st;\nvoid main(){\n  vec4 position=czm_computePosition();\n  v_positionEC=(czm_modelViewRelativeToEye*position).xyz;\n  v_st=st;\n  v_positionMC=position3DHigh+position3DLow;\n  gl_Position=czm_modelViewProjectionRelativeToEye*position;\n}\n",ov="\nvarying vec3 v_positionEC;\nvarying vec3 v_positionMC;\nvarying vec2 v_st;\nvoid main(){\n  czm_materialInput materialInput;\n  vec3 normalEC=normalize(czm_normal3D*czm_geodeticSurfaceNormal(v_positionMC,vec3(0.0),vec3(1.0)));\n  #ifdef FACE_FORWARD\n  normalEC=faceforward(normalEC,vec3(0.0,0.0,1.0),-normalEC);\n  #endif\n  materialInput.s=v_st.s;\n  materialInput.st=v_st;\n  materialInput.str=vec3(v_st,0.0);\n  materialInput.normalEC=normalEC;\n  materialInput.tangentToEyeMatrix=czm_eastNorthUpToEyeCoordinates(v_positionMC,materialInput.normalEC);\n  vec3 positionToEyeEC=-v_positionEC;\n  czm_material material =czm_getMaterial(materialInput);\n  #ifdef FLAT\n  gl_FragColor=vec4(material.diffuse+material.emission,material.alpha);\n  gl_FragColor.a={alpha};\n  #else\n  gl_FragColor=czm_phong(normalize(positionToEyeEC),material,czm_lightDirectionEC);\n  gl_FragColor.a={alpha};\n  #endif\n}\n",sv=/((?:.*\/)|^)CesiumPro\.js(?:\?|#|$)/;let av,lv,cv;function uv(e){return"undefined"==typeof document?e:(Re(av)||(av=document.createElement("a")),av.href=e,av.href=av.href,av.href)}function hv(e){return uv(`../${e}`)}function dv(){if(Re(lv))return lv;let e;if(e="undefined"!=typeof CESIUMPRO_BASE_URL?CESIUMPRO_BASE_URL:"object"==typeof window.define&&Re(window.define.amd)&&!window.define.amd.toUrlUndefined?Cesium.getAbsoluteUri("..","core/Url.js"):function(){const e=document.getElementsByTagName("script");for(let t=0,i=e.length;t<i;++t){const i=e[t].getAttribute("src"),n=sv.exec(i);if(null!==n)return n[1]}}(),!Re(e))throw new Le("Unable to determine CesiumPro base URL automatically, try defining a global variable called CESIUMPRO_BASE_URL.");return Re(e)||(e=""),lv=new Cesium.Resource({url:uv(e)}),lv.appendForwardSlash(),lv}function pv(e){return dv().getDerivedResource({url:e}).url}const mv={join:function(...e){const t=[];for(let i of e)i.startsWith("/")&&(i=i.substring(1)),i.endsWith("/")&&(i=i.substring(0,i.length-1)),t.push(i);return t.join("/")}};mv.buildModuleUrl=function(e){return t=e,Re(cv)||(cv="object"==typeof window.define&&Re(window.define.amd)&&!window.define.amd.toUrlUndefined?hv:pv),cv(t);var t},mv.getCesiumProBaseUrl=dv;const{Material:fv,Color:gv}=Cesium;class yv{constructor(e){this.commandType=e.commandType,this.geometry=e.geometry,this.attributeLocations=e.attributeLocations,this.primitiveType=e.primitiveType,this.uniformMap=e.uniformMap,this.vertexShaderSource=e.vertexShaderSource,this.fragmentShaderSource=e.fragmentShaderSource,this.rawRenderState=e.rawRenderState,this.framebuffer=e.framebuffer,this.outputTexture=e.outputTexture,this.autoClear=Cesium.defaultValue(e.autoClear,!1),this.preExecute=e.preExecute,this.show=!0,this.commandToExecute=void 0,this.clearCommand=void 0,this.autoClear&&(this.clearCommand=new Cesium.ClearCommand({color:new Cesium.Color(0,0,0,0),depth:1,framebuffer:this.framebuffer,pass:Cesium.Pass.OPAQUE}))}createCommand(e){switch(this.commandType){case"Draw":{const t=Cesium.VertexArray.fromGeometry({context:e,geometry:this.geometry,attributeLocations:this.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW}),i=Cesium.ShaderProgram.fromCache({context:e,attributeLocations:this.attributeLocations,vertexShaderSource:this.vertexShaderSource,fragmentShaderSource:this.fragmentShaderSource}),n=Cesium.RenderState.fromCache(this.rawRenderState);return new Cesium.DrawCommand({owner:this,vertexArray:t,primitiveType:this.primitiveType,uniformMap:this.uniformMap,modelMatrix:Cesium.Matrix4.IDENTITY,shaderProgram:i,framebuffer:this.framebuffer,renderState:n,pass:Cesium.Pass.OPAQUE})}case"Compute":return new Cesium.ComputeCommand({owner:this,fragmentShaderSource:this.fragmentShaderSource,uniformMap:this.uniformMap,outputTexture:this.outputTexture,persists:!0})}}setGeometry(e,t){this.geometry=t;const i=Cesium.VertexArray.fromGeometry({context:e,geometry:this.geometry,attributeLocations:this.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW});this.commandToExecute.vertexArray=i}update(e){this.show&&(Cesium.defined(this.commandToExecute)||(this.commandToExecute=this.createCommand(e.context)),Cesium.defined(this.preExecute)&&this.preExecute(),Cesium.defined(this.clearCommand)&&e.commandList.push(this.clearCommand),e.commandList.push(this.commandToExecute))}isDestroyed(){return!1}destroy(){return Cesium.defined(this.commandToExecute)&&(this.commandToExecute.shaderProgram=this.commandToExecute.shaderProgram&&this.commandToExecute.shaderProgram.destroy()),Cesium.destroyObject(this)}}var vv={};
/*! https://mths.be/utf8js v3.0.0 by @mathias */!function(e){!function(e){var t,i,n,r=String.fromCharCode;function o(e){for(var t,i,n=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(i=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--):n.push(t);return n}function s(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function a(e,t){return r(e>>t&63|128)}function l(e){if(0==(4294967168&e))return r(e);var t="";return 0==(4294965248&e)?t=r(e>>6&31|192):0==(4294901760&e)?(s(e),t=r(e>>12&15|224),t+=a(e,6)):0==(4292870144&e)&&(t=r(e>>18&7|240),t+=a(e,12),t+=a(e,6)),t+=r(63&e|128)}function c(){if(n>=i)throw Error("Invalid byte index");var e=255&t[n];if(n++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(){var e,r;if(n>i)throw Error("Invalid byte index");if(n==i)return!1;if(e=255&t[n],n++,0==(128&e))return e;if(192==(224&e)){if((r=(31&e)<<6|c())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if((r=(15&e)<<12|c()<<6|c())>=2048)return s(r),r;throw Error("Invalid continuation byte")}if(240==(248&e)&&(r=(7&e)<<18|c()<<12|c()<<6|c())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}e.version="3.0.0",e.encode=function(e){for(var t=o(e),i=t.length,n=-1,r="";++n<i;)r+=l(t[n]);return r},e.decode=function(e){t=o(e),i=t.length,n=0;for(var s,a=[];!1!==(s=u());)a.push(s);return function(e){for(var t,i=e.length,n=-1,o="";++n<i;)(t=e[n])>65535&&(o+=r((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=r(t);return o}(a)}}(e)}(vv);var _v=Object.freeze({__proto__:null,IOBuffer:class e{constructor(t=8192,i={}){let n=!1;"number"==typeof t?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const r=i.offset?i.offset>>>0:0,o=t.byteLength-r;let s=r;(ArrayBuffer.isView(t)||t instanceof e)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+r),t=t.buffer),this.lastWrittenByte=n?o:0,this.buffer=t,this.length=o,this.byteLength=o,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,o),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const t=2*(this.offset+e),i=new Uint8Array(t);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){const t=new Uint8Array(e);for(let i=0;i<e;i++)t[i]=this.readByte();return t}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let i=0;i<e;i++)t+=this.readChar();return t}readUtf8(e=1){const t=this.readChars(e);return vv.decode(t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){const t=vv.encode(e);return this.writeChars(t)}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),xv=T(_v),Cv={};function wv(e){e.offset%4!=0&&e.skip(4-e.offset%4)}Cv.notNetcdf=function(e,t){if(e)throw new TypeError(`Not a valid NetCDF v3.x file: ${t}`)},Cv.padding=wv,Cv.readName=function(e){var t=e.readUint32(),i=e.readChars(t);return wv(e),i};var bv={},Sv={exports:{}};const Tv=Cv.notNetcdf,Ev={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function Pv(e,t){if(1!==e){for(var i=new Array(e),n=0;n<e;n++)i[n]=t();return i}return t()}Sv.exports=Ev,Sv.exports.num2str=function(e){switch(Number(e)){case Ev.BYTE:return"byte";case Ev.CHAR:return"char";case Ev.SHORT:return"short";case Ev.INT:return"int";case Ev.FLOAT:return"float";case Ev.DOUBLE:return"double";default:return"undefined"}},Sv.exports.num2bytes=function(e){switch(Number(e)){case Ev.BYTE:case Ev.CHAR:return 1;case Ev.SHORT:return 2;case Ev.INT:case Ev.FLOAT:return 4;case Ev.DOUBLE:return 8;default:return-1}},Sv.exports.str2num=function(e){switch(String(e)){case"byte":return Ev.BYTE;case"char":return Ev.CHAR;case"short":return Ev.SHORT;case"int":return Ev.INT;case"float":return Ev.FLOAT;case"double":return Ev.DOUBLE;default:return-1}},Sv.exports.readType=function(e,t,i){switch(t){case Ev.BYTE:return e.readBytes(i);case Ev.CHAR:return function(e){if(0===e.charCodeAt(e.length-1))return e.substring(0,e.length-1);return e}(e.readChars(i));case Ev.SHORT:return Pv(i,e.readInt16.bind(e));case Ev.INT:return Pv(i,e.readInt32.bind(e));case Ev.FLOAT:return Pv(i,e.readFloat32.bind(e));case Ev.DOUBLE:return Pv(i,e.readFloat64.bind(e));default:return void Tv(!0,`non valid type ${t}`)}};var Av=Sv.exports;const Mv=Av;bv.nonRecord=function(e,t){const i=Mv.str2num(t.type);for(var n=t.size/Mv.num2bytes(i),r=new Array(n),o=0;o<n;o++)r[o]=Mv.readType(e,i,1);return r},bv.record=function(e,t,i){const n=Mv.str2num(t.type),r=t.size?t.size/Mv.num2bytes(n):1;var o=i.length,s=new Array(o);const a=i.recordStep;for(var l=0;l<o;l++){var c=e.offset;s[l]=Mv.readType(e,n,r),e.seek(c+a)}return s};const Lv=Cv,Dv=Av;function Rv(e){const t=e.readUint32();if(0===t)return Lv.notNetcdf(0!==e.readUint32(),"wrong empty tag for list of attributes"),[];{Lv.notNetcdf(12!==t,"wrong tag for list of attributes");const l=e.readUint32();for(var i=new Array(l),n=0;n<l;n++){var r=Lv.readName(e),o=e.readUint32();Lv.notNetcdf(o<1||o>6,`non valid type ${o}`);var s=e.readUint32(),a=Dv.readType(e,o,s);Lv.padding(e),i[n]={name:r,type:Dv.num2str(o),value:a}}}return i}var Iv=function(e,t){var i={recordDimension:{length:e.readUint32()}};i.version=t;var n=function(e){var t,i;const n=e.readUint32();if(0===n)return Lv.notNetcdf(0!==e.readUint32(),"wrong empty tag for list of dimensions"),[];{Lv.notNetcdf(10!==n,"wrong tag for list of dimensions");const a=e.readUint32();for(var r=new Array(a),o=0;o<a;o++){var s=Lv.readName(e);const n=e.readUint32();0===n&&(t=o,i=s),r[o]={name:s,size:n}}}return{dimensions:r,recordId:t,recordName:i}}(e);i.recordDimension.id=n.recordId,i.recordDimension.name=n.recordName,i.dimensions=n.dimensions,i.globalAttributes=Rv(e);var r=function(e,t,i){const n=e.readUint32();var r=0;if(0===n)return Lv.notNetcdf(0!==e.readUint32(),"wrong empty tag for list of variables"),[];{Lv.notNetcdf(11!==n,"wrong tag for list of variables");const p=e.readUint32();for(var o=new Array(p),s=0;s<p;s++){var a=Lv.readName(e);const n=e.readUint32();for(var l=new Array(n),c=0;c<n;c++)l[c]=e.readUint32();var u=Rv(e),h=e.readUint32();Lv.notNetcdf(h<1&&h>6,`non valid type ${h}`);const p=e.readUint32();var d=e.readUint32();2===i&&(Lv.notNetcdf(d>0,"offsets larger than 4GB not supported"),d=e.readUint32());let m=!1;void 0!==t&&l[0]===t&&(r+=p,m=!0),o[s]={name:a,dimensions:l,attributes:u,type:Dv.num2str(h),size:p,offset:d,record:m}}}return{variables:o,recordStep:r}}(e,n.recordId,t);return i.variables=r.variables,i.recordDimension.recordStep=r.recordStep,i};var kv=function(){let e=[];e.push("DIMENSIONS");for(let t of this.dimensions)e.push(`  ${t.name.padEnd(30)} = size: ${t.size}`);e.push(""),e.push("GLOBAL ATTRIBUTES");for(let t of this.globalAttributes)e.push(`  ${t.name.padEnd(30)} = ${t.value}`);let t=JSON.parse(JSON.stringify(this.variables));e.push(""),e.push("VARIABLES:");for(let i of t){i.value=this.getDataVariable(i);let t=JSON.stringify(i.value);t.length>50&&(t=t.substring(0,50)),isNaN(i.value.length)||(t+=` (length: ${i.value.length})`),e.push(`  ${i.name.padEnd(30)} = ${t}`)}return e.join("\n")};const{IOBuffer:Ov}=xv,Nv=Cv,Fv=bv,zv=Iv,Bv=kv;var Gv=class{constructor(e){const t=new Ov(e);t.setBigEndian(),Nv.notNetcdf("CDF"!==t.readChars(3),"should start with CDF");const i=t.readByte();Nv.notNetcdf(i>2,"unknown version"),this.header=zv(t,i),this.buffer=t}get version(){return 1===this.header.version?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(e){const t=this.globalAttributes.find((t=>t.name===e));return t?t.value:null}getDataVariableAsString(e){const t=this.getDataVariable(e);return t?t.join(""):null}get variables(){return this.header.variables}toString(){return Bv.call(this)}getDataVariable(e){let t;return t="string"==typeof e?this.header.variables.find((function(t){return t.name===e})):e,Nv.notNetcdf(void 0===t,`variable not found: ${e}`),this.buffer.seek(t.offset),t.record?Fv.record(this.buffer,t,this.header.recordDimension):Fv.nonRecord(this.buffer,t)}dataVariableExists(e){return void 0!==this.header.variables.find((function(t){return t.name===e}))}attributeExists(e){return void 0!==this.globalAttributes.find((t=>t.name===e))}},Hv=S(Gv);let Wv;var Uv={loadData:async function(e){var t;return await(t=e,new Promise((function(e){const i=new XMLHttpRequest;i.open("GET",t),i.responseType="arraybuffer",i.onload=function(){const t=function(e){return e.reduce((function(e,t){return e[t.name]=t,e}),{})},n=new Hv(i.response);Wv={};const r=t(n.dimensions);Wv.dimensions={},Wv.dimensions.lon=r.lon.size,Wv.dimensions.lat=r.lat.size,Wv.dimensions.lev=r.lev.size;const o=t(n.variables),s=t(o.U.attributes),a=t(o.V.attributes);Wv.lon={},Wv.lon.array=new Float32Array(n.getDataVariable("lon").flat()),Wv.lon.min=Math.min(...Wv.lon.array),Wv.lon.max=Math.max(...Wv.lon.array),Wv.lat={},Wv.lat.array=new Float32Array(n.getDataVariable("lat").flat()),Wv.lat.min=Math.min(...Wv.lat.array),Wv.lat.max=Math.max(...Wv.lat.array),Wv.lev={},Wv.lev.array=new Float32Array(n.getDataVariable("lev").flat()),Wv.lev.min=Math.min(...Wv.lev.array),Wv.lev.max=Math.max(...Wv.lev.array),Wv.U={},Wv.U.array=new Float32Array(n.getDataVariable("U").flat()),Wv.U.min=s.min.value,Wv.U.max=s.max.value,Wv.V={},Wv.V.array=new Float32Array(n.getDataVariable("V").flat()),Wv.V.min=a.min.value,Wv.V.max=a.max.value,e(Wv)},i.send()}))),Wv},randomizeParticles:function(e,t){const i=new Float32Array(4*e);for(let n=0;n<e;n++)i[4*n]=Cesium.Math.randomBetween(t.lonRange.x,t.lonRange.y),i[4*n+1]=Cesium.Math.randomBetween(t.latRange.x,t.latRange.y),i[4*n+2]=Cesium.Math.randomBetween(Wv.lev.min,Wv.lev.max),i[4*n+3]=0;return i}};var jv={loadText:function(e){const t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t.responseText},getFullscreenQuad:function(){return new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}),st:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array([0,0,1,0,1,1,0,1])})}),indices:new Uint32Array([3,2,0,0,2,1])})},createTexture:function(e,t){if(Cesium.defined(t)){const i={};i.arrayBufferView=t,e.source=i}return new Cesium.Texture(e)},createFramebuffer:function(e,t,i){return new Cesium.Framebuffer({context:e,colorTextures:[t],depthTexture:i})},createRawRenderState:function(e){const t={viewport:e.viewport,depthTest:e.depthTest,depthMask:e.depthMask,blending:e.blending};return Cesium.Appearance.getDefaultRenderState(!0,!1,t)},viewRectangleToLonLatRange:function(e){const t={},i=Cesium.Math.mod(e.west,Cesium.Math.TWO_PI),n=Cesium.Math.mod(e.east,Cesium.Math.TWO_PI),r=e.width;let o,s;r>Cesium.Math.THREE_PI_OVER_TWO?(o=0,s=Cesium.Math.TWO_PI):n-i<r?(o=i,s=i+r):(o=i,s=n),t.lon={min:Cesium.Math.toDegrees(o),max:Cesium.Math.toDegrees(s)};const a=e.south,l=e.north,c=e.height;let u=c>Cesium.Math.PI/12?c/2:0,h=Cesium.Math.clampToLatitudeRange(a-u),d=Cesium.Math.clampToLatitudeRange(l+u);return h<-Cesium.Math.PI_OVER_THREE&&(h=-Cesium.Math.PI_OVER_TWO),d>Cesium.Math.PI_OVER_THREE&&(d=Cesium.Math.PI_OVER_TWO),t.lat={min:Cesium.Math.toDegrees(h),max:Cesium.Math.toDegrees(d)},t},_shaderCalculateSpeedFrag:"\n// the size of UV textures: width = lon, height = lat*lev\nuniform sampler2D U; // eastward wind \nuniform sampler2D V; // northward wind\nuniform sampler2D currentParticlesPosition; // (lon, lat, lev)\n\nuniform vec3 dimension; // (lon, lat, lev)\nuniform vec3 minimum; // minimum of each dimension\nuniform vec3 maximum; // maximum of each dimension\nuniform vec3 interval; // interval of each dimension\n\n// used to calculate the wind norm\nuniform vec2 uSpeedRange; // (min, max);\nuniform vec2 vSpeedRange;\nuniform float pixelSize;\nuniform float speedFactor;\n\nfloat speedScaleFactor = speedFactor * pixelSize;\n\nvarying vec2 v_textureCoordinates;\n\nvec2 mapPositionToNormalizedIndex2D(vec3 lonLatLev) {\n    // ensure the range of longitude and latitude\n    lonLatLev.x = mod(lonLatLev.x, 360.0);\n    lonLatLev.y = clamp(lonLatLev.y, -90.0, 90.0);\n\n    vec3 index3D = vec3(0.0);\n    index3D.x = (lonLatLev.x - minimum.x) / interval.x;\n    index3D.y = (lonLatLev.y - minimum.y) / interval.y;\n    index3D.z = (lonLatLev.z - minimum.z) / interval.z;\n\n    // the st texture coordinate corresponding to (col, row) index\n    // example\n    // data array is [0, 1, 2, 3, 4, 5], width = 3, height = 2\n    // the content of texture will be\n    // t 1.0\n    //    |  3 4 5\n    //    |\n    //    |  0 1 2\n    //   0.0------1.0 s\n\n    vec2 index2D = vec2(index3D.x, index3D.z * dimension.y + index3D.y);\n    vec2 normalizedIndex2D = vec2(index2D.x / dimension.x, index2D.y / (dimension.y * dimension.z));\n    return normalizedIndex2D;\n}\n\nfloat getWindComponent(sampler2D componentTexture, vec3 lonLatLev) {\n    vec2 normalizedIndex2D = mapPositionToNormalizedIndex2D(lonLatLev);\n    float result = texture2D(componentTexture, normalizedIndex2D).r;\n    return result;\n}\n\nfloat interpolateTexture(sampler2D componentTexture, vec3 lonLatLev) {\n    float lon = lonLatLev.x;\n    float lat = lonLatLev.y;\n    float lev = lonLatLev.z;\n\n    float lon0 = floor(lon / interval.x) * interval.x;\n    float lon1 = lon0 + 1.0 * interval.x;\n    float lat0 = floor(lat / interval.y) * interval.y;\n    float lat1 = lat0 + 1.0 * interval.y;\n\n    float lon0_lat0 = getWindComponent(componentTexture, vec3(lon0, lat0, lev));\n    float lon1_lat0 = getWindComponent(componentTexture, vec3(lon1, lat0, lev));\n    float lon0_lat1 = getWindComponent(componentTexture, vec3(lon0, lat1, lev));\n    float lon1_lat1 = getWindComponent(componentTexture, vec3(lon1, lat1, lev));\n\n    float lon_lat0 = mix(lon0_lat0, lon1_lat0, lon - lon0);\n    float lon_lat1 = mix(lon0_lat1, lon1_lat1, lon - lon0);\n    float lon_lat = mix(lon_lat0, lon_lat1, lat - lat0);\n    return lon_lat;\n}\n\nvec3 linearInterpolation(vec3 lonLatLev) {\n    // https://en.wikipedia.org/wiki/Bilinear_interpolation\n    float u = interpolateTexture(U, lonLatLev);\n    float v = interpolateTexture(V, lonLatLev);\n    float w = 0.0;\n    return vec3(u, v, w);\n}\n\nvec2 lengthOfLonLat(vec3 lonLatLev) {\n    // unit conversion: meters -> longitude latitude degrees\n    // see https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree for detail\n\n    // Calculate the length of a degree of latitude and longitude in meters\n    float latitude = radians(lonLatLev.y);\n\n    float term1 = 111132.92;\n    float term2 = 559.82 * cos(2.0 * latitude);\n    float term3 = 1.175 * cos(4.0 * latitude);\n    float term4 = 0.0023 * cos(6.0 * latitude);\n    float latLength = term1 - term2 + term3 - term4;\n\n    float term5 = 111412.84 * cos(latitude);\n    float term6 = 93.5 * cos(3.0 * latitude);\n    float term7 = 0.118 * cos(5.0 * latitude);\n    float longLength = term5 - term6 + term7;\n\n    return vec2(longLength, latLength);\n}\n\nvec3 convertSpeedUnitToLonLat(vec3 lonLatLev, vec3 speed) {\n    vec2 lonLatLength = lengthOfLonLat(lonLatLev);\n    float u = speed.x / lonLatLength.x;\n    float v = speed.y / lonLatLength.y;\n    float w = 0.0;\n    vec3 windVectorInLonLatLev = vec3(u, v, w);\n\n    return windVectorInLonLatLev;\n}\n\nvec3 calculateSpeedByRungeKutta2(vec3 lonLatLev) {\n    // see https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages for detail\n    const float h = 0.5;\n\n    vec3 y_n = lonLatLev;\n    vec3 f_n = linearInterpolation(lonLatLev);\n    vec3 midpoint = y_n + 0.5 * h * convertSpeedUnitToLonLat(y_n, f_n) * speedScaleFactor;\n    vec3 speed = h * linearInterpolation(midpoint) * speedScaleFactor;\n\n    return speed;\n}\n\nfloat calculateWindNorm(vec3 speed) {\n    vec3 percent = vec3(0.0);\n    percent.x = (speed.x - uSpeedRange.x) / (uSpeedRange.y - uSpeedRange.x);\n    percent.y = (speed.y - vSpeedRange.x) / (vSpeedRange.y - vSpeedRange.x);\n    float norm = length(percent);\n\n    return norm;\n}\n\nvoid main() {\n    // texture coordinate must be normalized\n    vec3 lonLatLev = texture2D(currentParticlesPosition, v_textureCoordinates).rgb;\n    vec3 speed = calculateSpeedByRungeKutta2(lonLatLev);\n    vec3 speedInLonLat = convertSpeedUnitToLonLat(lonLatLev, speed);\n\n    vec4 particleSpeed = vec4(speedInLonLat, calculateWindNorm(speed / speedScaleFactor));\n    gl_FragColor = particleSpeed;\n}\n",_shaderFullscreenVert:"attribute vec3 position;\nattribute vec2 st;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    textureCoordinate = st;\n    gl_Position = vec4(position, 1.0);\n}",_shaderPostProcessingPositionFrag:"uniform sampler2D nextParticlesPosition;\nuniform sampler2D particlesSpeed; // (u, v, w, norm)\n\n// range (min, max)\nuniform vec2 lonRange;\nuniform vec2 latRange;\n\nuniform float randomCoefficient; // use to improve the pseudo-random generator\nuniform float dropRate; // drop rate is a chance a particle will restart at random position to avoid degeneration\nuniform float dropRateBump;\n\nvarying vec2 v_textureCoordinates;\n\n// pseudo-random generator\nconst vec3 randomConstants = vec3(12.9898, 78.233, 4375.85453);\nconst vec2 normalRange = vec2(0.0, 1.0);\nfloat rand(vec2 seed, vec2 range) {\n    vec2 randomSeed = randomCoefficient * seed;\n    float temp = dot(randomConstants.xy, randomSeed);\n    temp = fract(sin(temp) * (randomConstants.z + temp));\n    return temp * (range.y - range.x) + range.x;\n}\n\nvec3 generateRandomParticle(vec2 seed, float lev) {\n    // ensure the longitude is in [0, 360]\n    float randomLon = mod(rand(seed, lonRange), 360.0);\n    float randomLat = rand(-seed, latRange);\n\n    return vec3(randomLon, randomLat, lev);\n}\n\nbool particleOutbound(vec3 particle) {\n    return particle.y < -90.0 || particle.y > 90.0;\n}\n\nvoid main() {\n    vec3 nextParticle = texture2D(nextParticlesPosition, v_textureCoordinates).rgb;\n    vec4 nextSpeed = texture2D(particlesSpeed, v_textureCoordinates);\n    float speedNorm = nextSpeed.a;\n    float particleDropRate = dropRate + dropRateBump * speedNorm;\n\n    vec2 seed1 = nextParticle.xy + v_textureCoordinates;\n    vec2 seed2 = nextSpeed.xy + v_textureCoordinates;\n    vec3 randomParticle = generateRandomParticle(seed1, nextParticle.z);\n    float randomNumber = rand(seed2, normalRange);\n\n    if (randomNumber < particleDropRate || particleOutbound(nextParticle)) {\n        gl_FragColor = vec4(randomParticle, 1.0); // 1.0 means this is a random particle\n    } else {\n        gl_FragColor = vec4(nextParticle, 0.0);\n    }\n}",_shaderScreenDrawFrag:"uniform sampler2D trailsColorTexture;\nuniform sampler2D trailsDepthTexture;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    vec4 trailsColor = texture2D(trailsColorTexture, textureCoordinate);\n    float trailsDepth = texture2D(trailsDepthTexture, textureCoordinate).r;\n    float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, textureCoordinate));\n\n    if (trailsDepth < globeDepth) {\n        gl_FragColor = trailsColor;\n    } else {\n        gl_FragColor = vec4(0.0);\n    }\n}",_shaderSegmentDragFrag:"\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}\n",_shaderSegmentDrawVert:"attribute vec2 st;\n// it is not normal itself, but used to control lines drawing\nattribute vec3 normal; // (point to use, offset sign, not used component)\n\nuniform sampler2D previousParticlesPosition;\nuniform sampler2D currentParticlesPosition;\nuniform sampler2D postProcessingPosition;\n\nuniform float particleHeight;\n\nuniform float aspect;\nuniform float pixelSize;\nuniform float lineWidth;\n\nstruct adjacentPoints {\n    vec4 previous;\n    vec4 current;\n    vec4 next;\n};\n\nvec3 convertCoordinate(vec3 lonLatLev) {\n    // WGS84 (lon, lat, lev) -> ECEF (x, y, z)\n    // read https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates for detail\n\n    // WGS 84 geometric constants \n    float a = 6378137.0; // Semi-major axis \n    float b = 6356752.3142; // Semi-minor axis \n    float e2 = 6.69437999014e-3; // First eccentricity squared\n\n    float latitude = radians(lonLatLev.y);\n    float longitude = radians(lonLatLev.x);\n\n    float cosLat = cos(latitude);\n    float sinLat = sin(latitude);\n    float cosLon = cos(longitude);\n    float sinLon = sin(longitude);\n\n    float N_Phi = a / sqrt(1.0 - e2 * sinLat * sinLat);\n    float h = particleHeight; // it should be high enough otherwise the particle may not pass the terrain depth test\n\n    vec3 cartesian = vec3(0.0);\n    cartesian.x = (N_Phi + h) * cosLat * cosLon;\n    cartesian.y = (N_Phi + h) * cosLat * sinLon;\n    cartesian.z = ((b * b) / (a * a) * N_Phi + h) * sinLat;\n    return cartesian;\n}\n\nvec4 calculateProjectedCoordinate(vec3 lonLatLev) {\n    // the range of longitude in Cesium is [-180, 180] but the range of longitude in the NetCDF file is [0, 360]\n    // [0, 180] is corresponding to [0, 180] and [180, 360] is corresponding to [-180, 0]\n    lonLatLev.x = mod(lonLatLev.x + 180.0, 360.0) - 180.0;\n    vec3 particlePosition = convertCoordinate(lonLatLev);\n    vec4 projectedCoordinate = czm_modelViewProjection * vec4(particlePosition, 1.0);\n    return projectedCoordinate;\n}\n\nvec4 calculateOffsetOnNormalDirection(vec4 pointA, vec4 pointB, float offsetSign) {\n    vec2 aspectVec2 = vec2(aspect, 1.0);\n    vec2 pointA_XY = (pointA.xy / pointA.w) * aspectVec2;\n    vec2 pointB_XY = (pointB.xy / pointB.w) * aspectVec2;\n\n    float offsetLength = lineWidth / 2.0;\n    vec2 direction = normalize(pointB_XY - pointA_XY);\n    vec2 normalVector = vec2(-direction.y, direction.x);\n    normalVector.x = normalVector.x / aspect;\n    normalVector = offsetLength * normalVector;\n\n    vec4 offset = vec4(offsetSign * normalVector, 0.0, 0.0);\n    return offset;\n}\n\nvec4 calculateOffsetOnMiterDirection(adjacentPoints projectedCoordinates, float offsetSign) {\n    vec2 aspectVec2 = vec2(aspect, 1.0);\n\n    vec4 PointA = projectedCoordinates.previous;\n    vec4 PointB = projectedCoordinates.current;\n    vec4 PointC = projectedCoordinates.next;\n\n    vec2 pointA_XY = (PointA.xy / PointA.w) * aspectVec2;\n    vec2 pointB_XY = (PointB.xy / PointB.w) * aspectVec2;\n    vec2 pointC_XY = (PointC.xy / PointC.w) * aspectVec2;\n\n    vec2 AB = normalize(pointB_XY - pointA_XY);\n    vec2 BC = normalize(pointC_XY - pointB_XY);\n\n    vec2 normalA = vec2(-AB.y, AB.x);\n    vec2 tangent = normalize(AB + BC);\n    vec2 miter = vec2(-tangent.y, tangent.x);\n\n    float offsetLength = lineWidth / 2.0;\n    float projection = dot(miter, normalA);\n    vec4 offset = vec4(0.0);\n    // avoid to use values that are too small\n    if (projection > 0.1) {\n        float miterLength = offsetLength / projection;\n        offset = vec4(offsetSign * miter * miterLength, 0.0, 0.0);\n        offset.x = offset.x / aspect;\n    } else {\n        offset = calculateOffsetOnNormalDirection(PointB, PointC, offsetSign);\n    }\n\n    return offset;\n}\n\nvoid main() {\n    vec2 particleIndex = st;\n\n    vec3 previousPosition = texture2D(previousParticlesPosition, particleIndex).rgb;\n    vec3 currentPosition = texture2D(currentParticlesPosition, particleIndex).rgb;\n    vec3 nextPosition = texture2D(postProcessingPosition, particleIndex).rgb;\n\n    float isAnyRandomPointUsed = texture2D(postProcessingPosition, particleIndex).a +\n        texture2D(currentParticlesPosition, particleIndex).a +\n        texture2D(previousParticlesPosition, particleIndex).a;\n\n    adjacentPoints projectedCoordinates;\n    if (isAnyRandomPointUsed > 0.0) {\n        projectedCoordinates.previous = calculateProjectedCoordinate(previousPosition);\n        projectedCoordinates.current = projectedCoordinates.previous;\n        projectedCoordinates.next = projectedCoordinates.previous;\n    } else {\n        projectedCoordinates.previous = calculateProjectedCoordinate(previousPosition);\n        projectedCoordinates.current = calculateProjectedCoordinate(currentPosition);\n        projectedCoordinates.next = calculateProjectedCoordinate(nextPosition);\n    }\n\n    int pointToUse = int(normal.x);\n    float offsetSign = normal.y;\n    vec4 offset = vec4(0.0);\n    // render lines with triangles and miter joint\n    // read https://blog.scottlogic.com/2019/11/18/drawing-lines-with-webgl.html for detail\n    if (pointToUse == -1) {\n        offset = pixelSize * calculateOffsetOnNormalDirection(projectedCoordinates.previous, projectedCoordinates.current, offsetSign);\n        gl_Position = projectedCoordinates.previous + offset;\n    } else {\n        if (pointToUse == 0) {\n            offset = pixelSize * calculateOffsetOnMiterDirection(projectedCoordinates, offsetSign);\n            gl_Position = projectedCoordinates.current + offset;\n        } else {\n            if (pointToUse == 1) {\n                offset = pixelSize * calculateOffsetOnNormalDirection(projectedCoordinates.current, projectedCoordinates.next, offsetSign);\n                gl_Position = projectedCoordinates.next + offset;\n            } else {\n\n            }\n        }\n    }\n}",_shaderTrailDrawFrag:"uniform sampler2D segmentsColorTexture;\nuniform sampler2D segmentsDepthTexture;\n\nuniform sampler2D currentTrailsColor;\nuniform sampler2D trailsDepthTexture;\n\nuniform float fadeOpacity;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    vec4 pointsColor = texture2D(segmentsColorTexture, textureCoordinate);\n    vec4 trailsColor = texture2D(currentTrailsColor, textureCoordinate);\n\n    trailsColor = floor(fadeOpacity * 255.0 * trailsColor) / 255.0; // make sure the trailsColor will be strictly decreased\n\n    float pointsDepth = texture2D(segmentsDepthTexture, textureCoordinate).r;\n    float trailsDepth = texture2D(trailsDepthTexture, textureCoordinate).r;\n    float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, textureCoordinate));\n\n    gl_FragColor = vec4(0.0);\n    if (pointsDepth < globeDepth) {\n        gl_FragColor = gl_FragColor + pointsColor;\n    }\n    if (trailsDepth < globeDepth) {\n        gl_FragColor = gl_FragColor + trailsColor;\n    }\n    gl_FragDepthEXT = min(pointsDepth, trailsDepth);\n}",_shaderUpdatePosition:"uniform sampler2D currentParticlesPosition; // (lon, lat, lev)\nuniform sampler2D particlesSpeed; // (u, v, w, norm) Unit converted to degrees of longitude and latitude \n\nvarying vec2 v_textureCoordinates;\n\nvoid main() {\n    // texture coordinate must be normalized\n    vec3 lonLatLev = texture2D(currentParticlesPosition, v_textureCoordinates).rgb;\n    vec3 speed = texture2D(particlesSpeed, v_textureCoordinates).rgb;\n    vec3 nextParticle = lonLatLev + speed;\n\n    gl_FragColor = vec4(nextParticle, 0.0);\n}"};class Vv{constructor(e,t,i,n){this.createWindTextures(e,t),this.createParticlesTextures(e,i,n),this.createComputingPrimitives(t,i,n)}createWindTextures(e,t){const i={context:e,width:t.dimensions.lon,height:t.dimensions.lat*t.dimensions.lev,pixelFormat:Cesium.PixelFormat.LUMINANCE,pixelDatatype:Cesium.PixelDatatype.FLOAT,flipY:!1,sampler:new Cesium.Sampler({minificationFilter:Cesium.TextureMinificationFilter.NEAREST,magnificationFilter:Cesium.TextureMagnificationFilter.NEAREST})};this.windTextures={U:jv.createTexture(i,t.U.array),V:jv.createTexture(i,t.V.array)}}createParticlesTextures(e,t,i){const n={context:e,width:t.particlesTextureSize,height:t.particlesTextureSize,pixelFormat:Cesium.PixelFormat.RGBA,pixelDatatype:Cesium.PixelDatatype.FLOAT,flipY:!1,sampler:new Cesium.Sampler({minificationFilter:Cesium.TextureMinificationFilter.NEAREST,magnificationFilter:Cesium.TextureMagnificationFilter.NEAREST})},r=Uv.randomizeParticles(t.maxParticles,i),o=new Float32Array(4*t.maxParticles).fill(0);this.particlesTextures={previousParticlesPosition:jv.createTexture(n,r),currentParticlesPosition:jv.createTexture(n,r),nextParticlesPosition:jv.createTexture(n,r),postProcessingPosition:jv.createTexture(n,r),particlesSpeed:jv.createTexture(n,o)}}destroyParticlesTextures(){Object.keys(this.particlesTextures).forEach((e=>{this.particlesTextures[e].destroy()}))}createComputingPrimitives(e,t,i){const n=new Cesium.Cartesian3(e.dimensions.lon,e.dimensions.lat,e.dimensions.lev),r=new Cesium.Cartesian3(e.lon.min,e.lat.min,e.lev.min),o=new Cesium.Cartesian3(e.lon.max,e.lat.max,e.lev.max),s=new Cesium.Cartesian3((o.x-r.x)/(n.x-1),(o.y-r.y)/(n.y-1),n.z>1?(o.z-r.z)/(n.z-1):1),a=new Cesium.Cartesian2(e.U.min,e.U.max),l=new Cesium.Cartesian2(e.V.min,e.V.max),c=this;this.primitives={calculateSpeed:new yv({commandType:"Compute",uniformMap:{U:function(){return c.windTextures.U},V:function(){return c.windTextures.V},currentParticlesPosition:function(){return c.particlesTextures.currentParticlesPosition},dimension:function(){return n},minimum:function(){return r},maximum:function(){return o},interval:function(){return s},uSpeedRange:function(){return a},vSpeedRange:function(){return l},pixelSize:function(){return i.pixelSize},speedFactor:function(){return t.speedFactor}},fragmentShaderSource:new Cesium.ShaderSource({sources:[jv._shaderCalculateSpeedFrag]}),outputTexture:this.particlesTextures.particlesSpeed,preExecute:function(){let e;e=c.particlesTextures.previousParticlesPosition,c.particlesTextures.previousParticlesPosition=c.particlesTextures.currentParticlesPosition,c.particlesTextures.currentParticlesPosition=c.particlesTextures.postProcessingPosition,c.particlesTextures.postProcessingPosition=e,c.primitives.calculateSpeed.commandToExecute.outputTexture=c.particlesTextures.particlesSpeed}}),updatePosition:new yv({commandType:"Compute",uniformMap:{currentParticlesPosition:function(){return c.particlesTextures.currentParticlesPosition},particlesSpeed:function(){return c.particlesTextures.particlesSpeed}},fragmentShaderSource:new Cesium.ShaderSource({sources:[jv._shaderUpdatePosition]}),outputTexture:this.particlesTextures.nextParticlesPosition,preExecute:function(){c.primitives.updatePosition.commandToExecute.outputTexture=c.particlesTextures.nextParticlesPosition}}),postProcessingPosition:new yv({commandType:"Compute",uniformMap:{nextParticlesPosition:function(){return c.particlesTextures.nextParticlesPosition},particlesSpeed:function(){return c.particlesTextures.particlesSpeed},lonRange:function(){return i.lonRange},latRange:function(){return i.latRange},randomCoefficient:function(){return Math.random()},dropRate:function(){return t.dropRate},dropRateBump:function(){return t.dropRateBump}},fragmentShaderSource:new Cesium.ShaderSource({sources:[jv._shaderPostProcessingPositionFrag]}),outputTexture:this.particlesTextures.postProcessingPosition,preExecute:function(){c.primitives.postProcessingPosition.commandToExecute.outputTexture=c.particlesTextures.postProcessingPosition}})}}}class qv{constructor(e,t,i,n,r){this.createRenderingTextures(e,t),this.createRenderingFramebuffers(e),this.createRenderingPrimitives(e,i,n,r)}createRenderingTextures(e,t){const i={context:e,width:e.drawingBufferWidth,height:e.drawingBufferHeight,pixelFormat:Cesium.PixelFormat.RGBA,pixelDatatype:Cesium.PixelDatatype.UNSIGNED_BYTE},n={context:e,width:e.drawingBufferWidth,height:e.drawingBufferHeight,pixelFormat:Cesium.PixelFormat.DEPTH_COMPONENT,pixelDatatype:Cesium.PixelDatatype.UNSIGNED_INT};this.textures={segmentsColor:jv.createTexture(i),segmentsDepth:jv.createTexture(n),currentTrailsColor:jv.createTexture(i),currentTrailsDepth:jv.createTexture(n),nextTrailsColor:jv.createTexture(i),nextTrailsDepth:jv.createTexture(n)}}createRenderingFramebuffers(e){this.framebuffers={segments:jv.createFramebuffer(e,this.textures.segmentsColor,this.textures.segmentsDepth),currentTrails:jv.createFramebuffer(e,this.textures.currentTrailsColor,this.textures.currentTrailsDepth),nextTrails:jv.createFramebuffer(e,this.textures.nextTrailsColor,this.textures.nextTrailsDepth)}}createSegmentsGeometry(e){let t=[];for(let i=0;i<e.particlesTextureSize;i++)for(let n=0;n<e.particlesTextureSize;n++)for(let r=0;r<6;r++)t.push(i/e.particlesTextureSize),t.push(n/e.particlesTextureSize);t=new Float32Array(t);let i=[];const n=[-1,0,1],r=[-1,1];for(let t=0;t<e.maxParticles;t++)for(let e=0;e<n.length;e++)for(let t=0;t<r.length;t++)i.push(n[e]),i.push(r[t]),i.push(0);i=new Float32Array(i);const o=12*e.maxParticles;let s=new Uint32Array(o);for(let t=0,i=0,n=0;t<e.maxParticles;t++)s[i++]=n+0,s[i++]=n+1,s[i++]=n+2,s[i++]=n+2,s[i++]=n+1,s[i++]=n+3,s[i++]=n+2,s[i++]=n+4,s[i++]=n+3,s[i++]=n+4,s[i++]=n+3,s[i++]=n+5,n+=6;return new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({st:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:t}),normal:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:i})}),indices:s})}createRenderingPrimitives(e,t,i,n){const r=this;this.primitives={segments:new yv({commandType:"Draw",attributeLocations:{st:0,normal:1},geometry:this.createSegmentsGeometry(t),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{previousParticlesPosition:function(){return n.particlesTextures.previousParticlesPosition},currentParticlesPosition:function(){return n.particlesTextures.currentParticlesPosition},postProcessingPosition:function(){return n.particlesTextures.postProcessingPosition},aspect:function(){return e.drawingBufferWidth/e.drawingBufferHeight},pixelSize:function(){return i.pixelSize},lineWidth:function(){return t.lineWidth},particleHeight:function(){return t.particleHeight},color:function(){return t.color}},vertexShaderSource:new Cesium.ShaderSource({sources:[jv._shaderSegmentDrawVert]}),fragmentShaderSource:new Cesium.ShaderSource({sources:[jv._shaderSegmentDragFrag]}),rawRenderState:jv.createRawRenderState({viewport:void 0,depthTest:{enabled:!0},depthMask:!0}),framebuffer:this.framebuffers.segments,autoClear:!0}),trails:new yv({commandType:"Draw",attributeLocations:{position:0,st:1},geometry:jv.getFullscreenQuad(),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{segmentsColorTexture:function(){return r.textures.segmentsColor},segmentsDepthTexture:function(){return r.textures.segmentsDepth},currentTrailsColor:function(){return r.framebuffers.currentTrails.getColorTexture(0)},trailsDepthTexture:function(){return r.framebuffers.currentTrails.depthTexture},fadeOpacity:function(){return t.fadeOpacity}},vertexShaderSource:new Cesium.ShaderSource({defines:["DISABLE_GL_POSITION_LOG_DEPTH"],sources:[jv._shaderFullscreenVert]}),fragmentShaderSource:new Cesium.ShaderSource({defines:["DISABLE_LOG_DEPTH_FRAGMENT_WRITE"],sources:[jv._shaderTrailDrawFrag]}),rawRenderState:jv.createRawRenderState({viewport:void 0,depthTest:{enabled:!0,func:Cesium.DepthFunction.ALWAYS},depthMask:!0}),framebuffer:this.framebuffers.nextTrails,autoClear:!0,preExecute:function(){let e;e=r.framebuffers.currentTrails,r.framebuffers.currentTrails=r.framebuffers.nextTrails,r.framebuffers.nextTrails=e,r.primitives.trails.commandToExecute.framebuffer=r.framebuffers.nextTrails,r.primitives.trails.clearCommand.framebuffer=r.framebuffers.nextTrails}}),screen:new yv({commandType:"Draw",attributeLocations:{position:0,st:1},geometry:jv.getFullscreenQuad(),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{trailsColorTexture:function(){return r.framebuffers.nextTrails.getColorTexture(0)},trailsDepthTexture:function(){return r.framebuffers.nextTrails.depthTexture}},vertexShaderSource:new Cesium.ShaderSource({defines:["DISABLE_GL_POSITION_LOG_DEPTH"],sources:[jv._shaderFullscreenVert]}),fragmentShaderSource:new Cesium.ShaderSource({defines:["DISABLE_LOG_DEPTH_FRAGMENT_WRITE"],sources:[jv._shaderScreenDrawFrag]}),rawRenderState:jv.createRawRenderState({viewport:void 0,depthTest:{enabled:!1},depthMask:!0,blending:{enabled:!0}}),framebuffer:void 0})}}}class $v{constructor(e,t,i,n){this.context=e,this.data=t,this.userInput=i,this.viewerParameters=n,this.particlesComputing=new Vv(this.context,this.data,this.userInput,this.viewerParameters),this.particlesRendering=new qv(this.context,this.data,this.userInput,this.viewerParameters,this.particlesComputing)}canvasResize(e){this.particlesComputing.destroyParticlesTextures(),Object.keys(this.particlesComputing.windTextures).forEach((e=>{this.particlesComputing.windTextures[e].destroy()})),Object.keys(this.particlesRendering.framebuffers).forEach((e=>{this.particlesRendering.framebuffers[e].destroy()})),this.context=e,this.particlesComputing=new Vv(this.context,this.data,this.userInput,this.viewerParameters),this.particlesRendering=new qv(this.context,this.data,this.userInput,this.viewerParameters,this.particlesComputing)}clearFramebuffers(){const e=new Cesium.ClearCommand({color:new Cesium.Color(0,0,0,0),depth:1,framebuffer:void 0,pass:Cesium.Pass.OPAQUE});Object.keys(this.particlesRendering.framebuffers).forEach((t=>{e.framebuffer=this.particlesRendering.framebuffers[t],e.execute(this.context)}))}refreshParticles(e){if(this.clearFramebuffers(),this.particlesComputing.destroyParticlesTextures(),this.particlesComputing.createParticlesTextures(this.context,this.userInput,this.viewerParameters),e){const e=this.particlesRendering.createSegmentsGeometry(this.userInput);this.particlesRendering.primitives.segments.geometry=e;const t=Cesium.VertexArray.fromGeometry({context:this.context,geometry:e,attributeLocations:this.particlesRendering.primitives.segments.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW});this.particlesRendering.primitives.segments.commandToExecute.vertexArray=t}}applyUserInput(e){let t=!1;this.userInput.maxParticles!=e.maxParticles&&(t=!0),Object.keys(e).forEach((t=>{this.userInput[t]=e[t]})),this.refreshParticles(t)}applyViewerParameters(e){Object.keys(e).forEach((t=>{this.viewerParameters[t]=e[t]})),this.refreshParticles(!1)}}const{Cartesian2:Yv,Cartesian3:Xv,BoundingSphere:Jv,PrimitiveCollection:Zv,Color:Qv}=Cesium;const Kv="\nvec4 czm_p_toEye(vec2 uv,float depth){\n  vec4 eyeCoordinate = czm_windowToEyeCoordinates(uv, depth);\n  return eyeCoordinate/eyeCoordinate.w;\n}\nvec4 czm_p_toEye(in vec2 uv, in sampler2D depthTexture){\n    float depth=czm_p_getDepth(texture2D(depthTexture, uv));\n    vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n    vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n    posInCamera =posInCamera / posInCamera.w;\n    return posInCamera;\n}\n",e_="\nfloat czm_p_getDepth(in vec4 depth){\n  float z_window = czm_unpackDepth(depth);\n  z_window = czm_reverseLogDepth(z_window);\n  float n_range = czm_depthRange.near;\n  float f_range = czm_depthRange.far;\n  return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}";var t_="struct czm_ellipsoid\n{\n    vec3 center;\n    vec3 radii;\n    vec3 inverseRadii;\n    vec3 inverseRadiiSquared;\n};";const i_="czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\n    vec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\n    vec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\n    vec3 inverseRadiiSquared = inverseRadii * inverseRadii;\n    czm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\n    return temp;\n}",n_="vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\n    // Diffuse from directional light sources at eye (for top-down and horizon views)\n    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\n\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n    }\n\n    diffuse = clamp(diffuse, 0.0, 1.0);\n\n    // Specular from sun and pseudo-moon\n    float specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\n    specular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n/**\n * @private\n */\nvec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    // Diffuse from directional light sources at eye (for top-down and horizon views)\n    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\n\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n    }\n\n    diffuse = clamp(diffuse, 0.0, 1.0);\n\n    float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n\n",r_="\n//low version cesium.\nfloat czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\n    return czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\n\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\n    return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\n\n/**\n * Computes a color using the Phong lighting model.\n *\n * @name czm_phong\n * @glslFunction\n *\n * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.\n * @param {czm_material} material The fragment's material.\n *\n * @returns {vec4} The computed color.\n *\n * @example\n * vec3 positionToEyeEC = // ...\n * czm_material material = // ...\n * gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n *\n * @see czm_getMaterial\n */\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\n    // Diffuse from directional light sources at eye (for top-down)\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n    }\n\n    // Specular from sun and pseudo-moon\n    float specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse;\n    color += material.specular * specular;\n\n#ifdef HDR\n    float sunDiffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\n    color += materialDiffuse * sunDiffuse * czm_sunColor;\n#endif\n\n    return vec4(color, material.alpha);\n}\n\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\n    float specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\n\n    vec3 ambient = vec3(0.0);\n    vec3 color = ambient + material.emission;\n    color += material.diffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n//high version Cesium\n\n/**\n * Computes a color using the Phong lighting model.\n *\n * @name czm_phong\n * @glslFunction\n *\n * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.\n * @param {czm_material} material The fragment's material.\n *\n * @returns {vec4} The computed color.\n *\n * @example\n * vec3 positionToEyeEC = // ...\n * czm_material material = // ...\n * vec3 lightDirectionEC = // ...\n * gl_FragColor = czm_phong(normalize(positionToEyeEC), material, lightDirectionEC);\n *\n * @see czm_getMaterial\n */\nvec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    // Diffuse from directional light sources at eye (for top-down)\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n    }\n\n    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n\nvec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);\n    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);\n\n    vec3 ambient = vec3(0.0);\n    vec3 color = ambient + material.emission;\n    color += material.diffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n",o_={czm_p_toEye:Kv,czm_p_getDepth:e_,czm_ellipsoid:t_,czm_getWgs84EllipsoidEC:i_,czm_translucentPhong:n_,czm_phong:r_};function s_(){for(var e in o_)o_.hasOwnProperty(e)&&(Cesium.ShaderSource._czmBuiltinsAndUniforms[e]=o_[e])}s_();e.AnalysisUtil=Ne,e.ArcGisLayer=fm,e.ArrowPlot=yf,e.AxisPlane=wt,e.BaiDuLayer=class extends wa{constructor(e){(e=De(e,{})).url=De(e.url,"http://maponline{s}.bdimg.com/tile/?qt=vtile&styles=pl&scaler=1&udt=20200102"),e.customid&&(e.url=`https://api.map.baidu.com/customimage/tile?customid=${e.customid}`);const t=new Cesium.Cartesian2(-vm,-ym),i=new Cesium.Cartesian2(vm,ym);e.tilingScheme=new Cesium.WebMercatorTilingScheme({rectangleSouthwestInMeters:t,rectangleNortheastInMeters:i}),e.subdomains="123",super(e)}get rectangle(){return this.tilingScheme.rectangle}requestImage(e,t,i){const n=function(e,t,i,n){let r=e.url+"&x={x}&y={y}&z={z}";const o=e._tilingScheme.getNumberOfXTilesAtLevel(n),s=e._tilingScheme.getNumberOfYTilesAtLevel(n),a=4*Math.random()|0;return r=r.replace("{s}",a).replace("{x}",t-o/2).replace("{y}",s/2-i-1).replace("{z}",n),r}(this,e,t,i);return Cesium.ImageryProvider.loadImage(this,n)}},e.BaseAnalysis=He,e.BasePlot=Rm,e.BingLayer=Cm,e.Cartometry=We,e.CartometryManager=class{constructor(e,t={}){const{labelStyle:i,polylineStyle:n,polygonStyle:r,pointStyle:o}=t;Fe(e),this._viewer=e;const s=df.defaultLabelStyle;s.disableDepthTestDistance=Number.POSITIVE_INFINITY,this._labelStyle=De(i,s),this._polylineStyle=De(n,pf.defaultStyle),this._polygonStyle=De(r,mf.defaultStyle),this._pointStyle=De(o,df.defaultStyle),this._startMeasure=new Be,this._stopMeasure=new Be,this._addNode=new Be,this.formatText=De(t.formatText,ff);this._nodeMode=De(t.nodeMode,{distance:!0,area:!1,height:!1,angle:!1}),this._auxiliaryGeometry=De(t.auxiliaryGeometry,{distance:!0,area:!1,height:!0,angle:!0});const a=new Cesium.ScreenSpaceEventHandler(e.canvas);this._handler=a,this._values={},this._mode=De(t.mode,St.SURFACE_DISTANCE),this._showTip=De(t.showTip,!0),this._showTip&&(this._tip=new Po,this._tip.show=!1),this._autoDepthTest=De(t.autoDepthTest,!0),this.listening=!1;const l=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.RED});this._auxiliarylineMaterial=De(t.auxiliaryLineMaterial,l);const c=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.RED});this._depthTestAgainstTerrain=this._viewer.scene.globe.depthTestAgainstTerrain,this._auxiliaryPolygonMaterial=De(t.auxiliaryPolygonMaterial,c)}get viewer(){return this.viewer}get labelStyle(){return this._labelStyle}set labelStyle(e){this._labelStyle=e}get polylineStyle(){return this._polylineStyle}set polylineStyle(e){this._polylineStyle=e}get polygonStyle(){return this._polygonStyle}set polygonStyle(e){this._polygonStyle=e}get pointStyle(){return this._pointStyle}set pointStyle(e){this._pointStyle=e}get startMeasure(){return this._startMeasure}get stopMeasure(){return this._stopMeasure}get addNode(){return this._addNode}get tip(){return this._tip}get mode(){return this._mode}set mode(e){St.validate(e)?this._mode=e:console.warn("CartometryManaer:无效的测量模式")}addEventListener(e,t=[]){this._listening=!0;const i=St.getKey(e),n=/.*_?(distance|area|height|angle)$/.exec(i.toLowerCase());let r=!1,o=!1;n&&n[1]&&(r=this._nodeMode[n[1]],o=this._auxiliaryGeometry[n[1]]);const s=this._handler;s.setInputAction((i=>{const n=this.pickPosition(i.position);if(n&&t.push(n),r&&this.createNode(n),o&&this.createAuxiliaryGraphic(t,n,e),this.addNode.raise({mode:e,position:n,id:this.gid}),(e===St.HEIGHT||e===St.ANGLE)&&(this.tip&&1===t.length&&(this.tip.text="单击地图确定终点."),2===t.length)){this.removeEventListener();let i,n=t[0];if(e===St.HEIGHT){i=this.getHeight(t);const e=Ie.fromCartesian(t[0]),r=Ie.fromCartesian(t[1]),o=e.alt<r.alt?e:r;n=Cesium.Cartesian3.fromDegrees(o.lon,o.lat,(r.alt+e.alt)/2)}else i=this.getAngle(t);this.createLabel(n,i),this.stopMeasure.raise({mode:e,label:i,graphic:this._values[this.gid],id:this.gid})}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction((i=>{if(this.tip&&(this.tip.position=i.endPosition),e===St.HEIGHT||e===St.ANGLE)return;const n=this.pickPosition(i.endPosition);t.length>1&&n&&t.pop(),t.length>0&&n&&t.push(n)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),s.setInputAction((i=>{const n=this.pickPosition(i.position);let o;this.removeEventListener(),r&&n&&this.createNode(n),!n||e===St.HEIGHT&&e===St.ANGLE||(t.pop(),t.length&&n&&t.push(n),this.addNode.raise({mode:e,position:n,id:this.gid})),e!==St.SURFACE_DISTANCE&&e!==St.SPACE_DISTANCE||(o=this.getDistance(t,e),this.createLabel(n||t[t.length-1],o)),e!==St.SURFACE_AREA&&e!==St.SPACE_AREA||(o=this.getArea(t,e),this.createLabel(n||t[t.length-1],o)),this.stopMeasure.raise({mode:e,label:o,graphic:this._values[this.gid],id:this.gid})}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)}removeEventListener(){const e=this._handler;e.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),e.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),e.removeInputAction(Cesium.ScreenSpaceEventType.RIGHT_CLICK),this._listening=!1,this.tip&&(this.tip.show=!1),this._autoDepthTest&&(this._viewer.depthTest=this._depthTestAgainstTerrain)}clear(){const e=Object.values(this._values);for(const t of e)for(let e of t)this._viewer.entities.remove(e);this._values={}}destroy(){this.clear(),this.removeEventListener(),this._handler.isDestroyed()||this._handler.destroy(),this._viewer=undefinesd}getDistance(e,t){if(e.length<2||!e[0]||!e[1])return"起点";let i;return t===St.SURFACE_DISTANCE?i=We.surfaceDistance(e):t===St.SPACE_DISTANCE&&(i=We.spaceDistance(e)),this.formatText(i,t,!this._listening)}getArea(e,t){let i;return i=t===St.SURFACE_AREA?We.surfaceArea(e):We.spaceArea(e),this.formatText(i,t,!this._listening)}getHeight(e){const t=We.heightFromCartesianArray(e);return this.formatText(Math.abs(t[0]),St.HEIGHT)}getAngle(e,t){const i=We.angleBetweenNorth(e[0],e[1]);return this.formatText(i,St.ANGLE)}do(e,t=[]){this._depthTestAgainstTerrain||(this._autoDepthTest?this._viewer.depthTest=!0:console.warn("depthTestAgainstTerrain未开启,点位获取可能不准确.")),this.tip&&(this.tip.show=!0),e=De(e,this.mode);if(!St.validate(e))return void console.warn("无效的测量模式");let i;this.gid=Ge(),this._values[this.gid]=[],this.tip&&(e===St.HEIGHT||e===St.ANGLE?this.tip.text="单击地图确定起点.":this.tip.text="单击地图添加节点，右击地图结束量算"),this.startMeasure.raise({mode:e,id:this.gid}),e===St.SPACE_DISTANCE||e===St.HEIGHT?(i=this.polylineStyle,i.clampToGround=!1,i.positions=new Cesium.CallbackProperty((()=>t),!1),this.createPolyline(i)):e===St.SURFACE_DISTANCE||e===St.ANGLE?(i=this.polylineStyle,i.clampToGround=!0,i.positions=new Cesium.CallbackProperty((()=>t),!1),this.createPolyline(i)):e===St.SPACE_AREA?(i=this.polygonStyle,i.outline=!1,i.perPositionHeight=!0,i.heightReference=Cesium.HeightReference.NONE,i.hierarchy=new Cesium.CallbackProperty((()=>new Cesium.PolygonHierarchy(t)),!1),this.createPolygon(i)):e===St.SURFACE_AREA&&(i=this.polygonStyle,i.perPositionHeight=!1,i.heightReference=Cesium.HeightReference.CLAMP_TO_GROUND,i.hierarchy=new Cesium.CallbackProperty((()=>new Cesium.PolygonHierarchy(t)),!1),this.createPolygon(i)),this.addEventListener(e,t)}surfaceDistance(){this.do(St.SURFACE_DISTANCE)}spaceDistance(){this.do(St.SPACE_DISTANCE)}surfaceArea(){this.do(St.SURFACE_AREA)}spaceArea(){this.do(St.SPACE_AREA)}height(){this.do(St.HEIGHT)}angle(){this.do(St.ANGLE)}pickPosition(e){const t=this._viewer;let i;const n=t.camera.getPickRay(e);i=t.scene.globe.pick(n,t.scene);return t.scene.pick(e)&&(t.scene.pickPositionSupported?i=t.scene.pickPosition(e):console.warn("This browser does not support pickPosition.")),i}createNode(e){if(!e)return;const t=this.pointStyle,i=this._viewer.entities.add({position:e,point:t});return this._values[this.gid].push(i),i}createLabel(e,t){const i=this.labelStyle;i.text=t;const n=Ie.fromCartesian(e);i.pixelOffset=new Cesium.Cartesian3(0,0,n.height>0?-n.height:0);const r=this._viewer.entities.add({position:e,label:i});return this._values[this.gid].push(r),r}createPolygon(e){const t=this._viewer.entities.add({polygon:e});return this._values[this.gid].push(t),t}createPolyline(e){const t=this._viewer.entities.add({polyline:e});return this._values[this.gid].push(t),t}_createAuxiliaryGraphicforHeight(e){if(2!==e.length)return;const t=Ie.fromCartesian(e[0]),i=Ie.fromCartesian(e[1]);let n,r;t.alt<i.alt?(n=t,r=i):(n=i,r=t);const o=new Ie(n.lon,n.lat,r.alt),s=[e[0],o.toCartesian(),e[1]],a=this._viewer.entities.add({polyline:{positions:s,material:this._auxiliarylineMaterial,width:this.polylineStyle.width||3}});this._values[this.gid].push(a)}_createAuxiliaryGraphicforDisgance(e,t){this.createLabel(e,t)}_createAuxiliaryGraphicforAngle(e){if(2!==e.length)return;const t=We.spaceDistance(e),i=new Cesium.Transforms.eastNorthUpToFixedFrame(e[0]),n=new Cesium.Matrix4;Cesium.Matrix4.inverseTransformation(i,n);const r=Cesium.Matrix4.multiplyByPoint(i,new Cesium.Cartesian3(0,t,0),new Cesium.Cartesian3),o={polyline:{positions:[e[0],r],material:this._auxiliarylineMaterial,width:this.polylineStyle.width||3,clampToGround:!0}},s=this._viewer.entities.add(o);this._values[this.gid].push(s)}createAuxiliaryGraphic(e,t,i){if(i===St.SPACE_DISTANCE||i===St.SURFACE_DISTANCE){const{length:n}=e,r=this.getDistance([e[n-3],e[n-2]],i);this._createAuxiliaryGraphicforDisgance(t,r)}else i===St.HEIGHT?this._createAuxiliaryGraphicforHeight(e):i===St.ANGLE&&this._createAuxiliaryGraphicforAngle(e)}callback(e,t,i){}},e.CartometryType=St,e.CesiumProError=Le,e.CesiumProTerrainProvider=Yt,e.CircleScanGraphic=class extends Fd{constructor(e){super(e),this._speed=De(e.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(e){this._speed!==e&&(e<=0&&(this._speed=0),this.definedChanged.raise("speed",e,this._speed),this._speed=e)}createAppearance(){return this._appearance||(this._appearance=new Bd({material:new Gd({translucent:!0,fabric:{uniforms:{image:di.buildModuleUrl("./assets/images/radarScan.png"),stRotation:Cesium.Matrix2.IDENTITY,color:this._color,time:0},source:zd}})})),this._appearance}update(e){if(!this.material)return;if(0===this.speed)return void(this.material.uniforms.time=0);const t=Cesium.JulianDate.toDate(e).getTime()*this.speed,i=t%360,n=Cesium.Matrix2.fromRotation(Cesium.Math.toRadians(-i));this.material.uniforms.stRotation={x:n[0],y:n[1],z:n[2],w:n[3]},this.material.uniforms.time=t-parseInt(t)}},e.CircleSpreadGraphic=class extends Fd{constructor(e){super(e),this._speed=De(e.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(e){e!==this._speed&&(e<0&&(e=0),this.definedChanged.raise("speed",e,this._speed),this._speed=e)}createAppearance(){return this._appearance||(this._appearance=new Wd({material:new Ud({translucent:!0,fabric:{uniforms:{color:this._color,time:0},source:Hd}})})),this._appearance}update(e){if(!this.material)return;const t=Cesium.JulianDate.toDate(e).getTime()*this.speed*.001;this.material.uniforms.time=t-parseInt(t)}},e.Cluster=class{constructor(e,t={}){this._objects=De(t.objects,[]),this._getScreenBoundingBox=De(t.getScreenBoundingBox,Pi),this._scene=e,this.clusterSize=3,this.pixelRange=50,this._clusterObjects=[]}get objects(){return this._objects}set objects(e){this._objects=e}_clearCluster(){this._objects.map((e=>e.cluster=!1)),this._clusterObjects=[]}update(){const e=this._objects;this._clearCluster();const t=function(e,t){const i=[],n=new Si(t.globe.ellipsoid,t.camera.positionWC);for(let r of e)r.position&&(t.mode!==bi.SCENE3D||n.isPointVisible(r.position))&&(r.__pixel=Cesium.SceneTransforms.wgs84ToWindowCoordinates(t,r.position),r.__pixel&&i.push(r));return i}(e,this._scene),i=new vi(t,Ti,Ei,64,Int32Array);for(let e of t){if(e.cluster)continue;const n=this._getScreenBoundingBox(e,e.__pixel),r=wi.clone(n,new wi);e.cluster=!0;const o=i.range(n.x,n.y,n.x+n.width,n.y+n.height),s=o.length,a=_i.clone(e.position);let l,c=1;const u=[];for(let e=0;e<s;e++){const i=t[o[e]];if(i.cluster)continue;u.push(i.id),i.cluster=!0;const n=this._getScreenBoundingBox(i,i.__pixel);_i.add(i.position,a,a),wi.union(r,n,r),c++,l=i}c>=this.clusterSize?(_i.multiplyByScalar(a,1/c,a),this._clusterObjects.push({position:new _i(a.x,a.y,a.z),number:c,ids:u,id:l.id+c})):this._clusterObjects.push(e)}}},e.ContextMenu=Ri,e.CursorTip=Po,e.CylinderGeometry=ap,e.DefaultDataSource=pd,e.DivGraphic=class{constructor(e={}){if(!e.position)throw new Le("paramerter position must be provided.");if(!e.element)throw new Le("parameter element must be provided.");this._show=De(e.show,!0),this._element=element}get show(){return this._show}set show(e){this._show=e,this._element.style.display=e?"block":"none"}get element(){return this.element}},e.DynamicConeGraphic=class extends Fd{constructor(e){super(e),this._speed=De(e.speed,1),this._image=De(e.image,di.buildModuleUrl("assets/img/particle.png")),this._appearance={},this._length=e.length,this._primitive=new xp,this._primitive.name="DynamicConeGraphic",this._asynchronous=!1,this.createGraphic()}get speed(){return this._speed}set speed(e){if(e===this._speed)return;if(e<=0)throw new Le("速度不能小于0");this.definedChanged.raise("speed",e,this._speed),this._speed=e;const t=Object.values(this._appearance);for(let i of t){i.material.uniforms.speed=e}}get length(){return this._length}set length(e){e!==this._length&&(this.definedChanged.raise("length",e,this._length),this._length=e,this.updatePrimitive())}updatePrimitive(){if(!this._viewer)return;this.primitive.removeAll(),this.createGraphic()}updateAttribute(e,t){if(this.isDestroyed())return;if(!this.primitive)return;const i=this.primitive._primitives;for(let n of i)super.updateAttribute.call({primitive:n,isDestroyed:this.isDestroyed},e,t)}createGraphic(){const e=this.createAppearance(hp),t=this.createAppearance(dp),i=this.createAppearance(pp),n=this.createAppearance(mp);this._clampToGround?(this.createCircleGroundPrimitive(e,this._asynchronous),this.createCircleGroundPrimitive(t,this._asynchronous),this.createCylinder(0,.35*this._radius,i,this._asynchronous),this.createCylinder(.1*this._radius,.45*this._radius,n,this._asynchronous,.8)):(this.createCirclePrimitive(e,this._asynchronous),this.createCirclePrimitive(t,this._asynchronous),this.createCylinder(0,.35*this._radius,i,this._asynchronous),this.createCylinder(.1*this._radius,.45*this._radius,n,this._asynchronous,.8))}createCylinder(e,t,i,n=!0,r=1){if(this.isDestroyed())return;const o=De(this._length,.35*this._radius*8)*r,s=wp.eastNorthUpToFixedFrame(Ie.toCartesian(this._position)),a=bp.fromTranslation(new Sp(0,0,o/2+this._height));bp.multiply(s,a,s);const l=new ap({bottomRadius:t,topRadius:e,length:o}),c=new vp({geometryInstances:new _p({geometry:l,id:this.property}),appearance:i,asynchronous:n,allowPicking:this._allowPicking,modelMatrix:s});return this.primitive.add(c),c}createCirclePrimitive(e,t=!0){if(this.isDestroyed())return;const i=new Cp({center:Ie.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height,granularity:.01}),n=new vp({geometryInstances:new _p({geometry:i,id:this.property}),appearance:e,asynchronous:t,allowPicking:this._allowPicking});return this.primitive.add(n),n}createCircleGroundPrimitive(e,t=!0){if(this.isDestroyed())return;const i=new Cp({center:Ie.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height}),n=new yp({geometryInstances:new _p({geometry:i,id:this.property}),appearance:e,asynchronous:t,allowPicking:this._allowPicking});return this.primitive.add(n),n}createAppearance(e){return this._appearance[e]||(this._appearance[e]=new fp({flat:!0,material:new gp({translucent:!0,fabric:{uniforms:{color:this._color,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAEACAYAAAADRnAGAAAAAXNSR0IArs4c6QAACQdJREFUeF7tncmvFUUUxr9yFqdEnNg4oa404kYwutANIBu36sK9Cn+Ngmtnl7pSNFE2DmgiGl0pDnGDJjyMAUXGMh85bZpL9+2699U5VcU7N7mbl/uqvv6dr6u7q0+dCljjn7DGjx8OwB2wxgn4KbDGDeCDoJ8C806BGOMlAPg9E0KIJU4XbQ2jDogxXgHgZgDXAlgB8GcI4YwlBAsNgwCE+gYATwLYBOADAJ+EEP62AmClYQzAZQA2AtgFYCuAVwC8GkI4YgjARMMYAP79RgBbANwL4EsAB0IIx4cAxBj5e44V/JzNMV5Im+oa5o0BlwK4CsCVAI5PHPx1ANYLAI4XRzNBUNew6stgjJGA7gewHTh3X/E+gO9DCCcMT5elNeQAcA2AxwHslAPeDWBfCOGYIYClNeQAwMvlnTJe8Jj3A/glhHDSEMDSGlYNgAcZY7wcAKPAzz+WB99BXlZDFgBWkdboxwFoUG2pTXdAS9HS0OoO0KDaUpvugJaipaHVHaBBtaU2kx0g99pXyyMv5wfMHnZm7vezakgCIAd/N4DNIoZPfD+HEE5ZRVtLQyoAPuk9AeBFOeCX5ZnfcpJURUMqAM64PCCzPmTAWWLO+vxr6AAVDakAOOHJ9wM3yQEfBnAshHDWEICKhiQAMunB33KSkp8ib4pkpjirhmQAVpG27scBWBOvrT93QG0RsdbjDrAmXlt/7oDaImKtxx1gTby2/twBtUXEWo87wJp4bf2pO0Ajg2xRiPM0qAKQjlUyyFIhTGnQBtBlbzHjlLnGnEv8znJKvZfFNqhBGwDnEZlB1s0mM4PMOuV2rgZtAMzeumvmfUKJDLJRDaoAZDKVGWTr5JxlBpnZy5RunJCXKoMa1AGkDlalfucASpGvpV93QC2RKKXDHVCKfC39ugNqiUQpHe6AUuRr6TfZAbKQkRlac1eRaR6YhoYkANJxt4aPCyq7dYSWOUJMkcmuIRUA01K4gJLP9dsA8Ln+deOVpCoaUgGQ/m0AdgB4EMDeAkvjVDQkAZDnek5uMEvsellNvmKZJaalIRmACGAU+D/R+uB7kxtZNSwEQHOEL9W2AyhFvpZ+3QG1RKKUDndAKfK19OsOqCUSpXS4A0qRr6Vfd0AtkSilwx1Qinwt/boDaolEKR3ugJzkJReHc4enAZwqMW22qIZsDpDyl8zG4vT5IQA/yPJas1qky2jICeAGAE8BeAbApwDeBPCbZR3SGOPCGjQAPA3gs8IAkjXkBNAlRa7ZU4AwWQiVIFh+96T1ICiJ0QtpyOaAnFcTy7YcgCXtGvtyB9QYFUtN7oAh2jFGZmPwcsYPL2emVeXlVbyJhgscEGPkdfQWuaenlh8B/GEJwVLDEABmgj0M4FlxwFtMihqrLa5xvsYYzTSMAWDNsD6A/QUAmGgYOwVunTkFfi9wCphoGLwKyDnYHwQ5wWH6sdKgdhmsfclsF00VAAPLVbvia5azQzy2/rLdQQ1aAPpLZgm75KYLXDI7qkELgErxw0UGoRhjkgYtALNLZr8A8KvxoukkDSoA5Fa2WzLLPkpuusAls6Ma1AAsYteSv3UAJenX0Lc7oIYolNTgDihJv4a+3QE1RKGkBndASfo19O0OqCEKJTW4A0rSr6Fvd0ANUSipIasD5KUqt+rll7NAg/sUax7wohqyARjZKPlr441YeDyzmzXP1ZATwGyBgz0AXitcZGFSQ24ALLLAeXgWWfgQwMfGG7YzCAtpyAZAZoL7RRb4JuZIgVzBhTRkBSAQugIHWTZhX2bAlKIvPLZJDdkBLCO45P84gJL0a+j7PAfIucNXWvyeKFQBlmOImYb/AciNDIsQ3wdgg2SHWe8pSD2mGvoAeA29XZKjHgPwDoB3Qwh/WVlVbmNNNcwCuEMAPFoQgKkGPwX69pZxgHdSzBZlimyJMtgMipkGvw+wGuBq7ccdUGtkrHS5A6xI19qPO6DWyFjpcgdYka61H3dArZGx0uUOsCJdaz/ugFojY6XLHWBFutZ+3AG1RsZKV5IDeqtAS5bVp1a+NcqqYRJAb3+R9QCOcnOFEMIJqwj1Xrkz9SW7hhQA3Z6d2wEckI1TD1kmPsQY1TSkACD55wA8D+AjAC8BOGi8nF5NQwoAVnPYJBunHgTAVaCmqS9SUUJFwyQAOQcJgd+TAI5bRr8bawRCdg1JACwHPOu+HIA18dr6U3NAL93m3JtmFloNIZhVkOjdPzDdZlSDCoCRdBvrLbeH0m0u0KAFoJl0GysAbwN4r3C+0aAGLQBslxVcWGC1yzgrcQpMalABMDQAFUq36XIOR1N+1ADUdrkb0+MAWomUlk53gBbZVtp1B7QSKS2d7gAtsq206w5oJVJaOt0BWmRbadcd0EqktHS6A7TIttKuO6CVSGnpdAdokW2lXXdAK5HS0ukO0CLbSrvugFYipaXTHaBFtpV23QGtREpLpztAi2wr7boDWomUls5kB0juH9PfuGLDfAdKAtDQkARASlwxZ5/fYwAOF1g1QvjZNaQC6Lat2gbgW9k7zHrViIqGVADdio0XpFhqyVUjWTWkAmCh5Id6q0Y+l1UjZsnPMUYVDakA+DsKyL5iI3V0lwEwu4YkAKkiW/ydA2gxajk1uwNy0myxLRMHyJ0kryCsFMl1h6X2HbhAgzqA3r4DjwDYyH3MAXxjCWGeBgsAvIe/B8AuAFsB7AbwRghhxeqUEQcOarAAwFUbrPm/Q/Yd2AtgXwiBD1UmH1nCN6hBHYA8xvZr/jPyXHxt+kgdYxzUYAJAINAJ/LLm/1mT0M90Ik44T8NcABoTEIseuLaGUQAXe+mMLhDzAKhMQCzigN7+4WoTMfMADE2C/BRCOL3IQazmtzFGdQ3zAHSlM7bIXgMsncEKMpaTIOoapgbBi7Z0xuQYsBrrtvS/ZvcBtUJxALVGxkqXO0CDtNxFris8AcJ7/kkN2R3Qu4XeLPMAX7EIm/EECA+eN1GTGjQAdBMgOwHwFnZy08PcLuxNgExq0ALAyQeW32MBtBITIN3Gi5MasgMYmACpeuNFFQC9CRC2P7npYe5ToGsvZeNFNQBaB5W7XQeQm2hr7a15B/wHRTppPaBaKTsAAAAASUVORK5CYII=",speed:this._speed},source:e}})})),this._appearance[e]}update(e){}},e.DynamicFadeMaterialProperty=Df,e.DynamicFlowWallMaterialProperty=Of,e.DynamicSpreadMaterialProperty=Bf,e.DynamicWaveMaterialProperty=jf,e.Ellipsoid=Mo,e.Event=Be,e.FillAnalysis=it,e.FlattenPolygonCollection=class{constructor(e,t){this._model=e,e instanceof Vc&&(this._model=e.delegate),this._frameState=t.scene.frameState,this._colorTexture=void 0,this._depthStenclilTexture=void 0,this.frameBuffer=void 0,this._viewport=new og,this._rs=void 0,this.canvas=void 0,this._clearColorCommand=new mg({depth:1,coloe:new lg(0,0,0,1)}),this._useScissorTest=!1,this._scissorRectangle=!1,this._drawCommandList=[],this._camera=new Fg,this._passState=void 0,this._clearPassState=void 0,this._width=4096,this._height=4096,this._positions=[],this._polygonBounding=new og,this._delta=0,this._localModel=void 0,this._inverseLocalModel=void 0,this._uniforms={},this._initShaderSource=!1,this._colorTexture=void 0,this._enabled=!0,this._removeEvent=t.scene.postRender.addEventListener((e=>{this.update(e.frameState)}))}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get ready(){return this._model.ready}get readyPromise(){return this._model.readyPromise}get polygonBounding(){return this._polygonBounding}set polygonBounding(e){this._polygonBounding={x:e.x,y:e.y,z:e.x+e.width,w:e.y+e.height};const t=this._camera.frustum;t.left=e.x,t.top=e.y+e.height,t.right=e.x+e.width,t.bottom=e.y}_updateUniforms(){if(this._uniforms){if(this._uniforms.u_polygonTexture){const e=new Ig({url:"./"});e.texture=this._colorTexture,this._uniforms.u_polygonTexture.value=e}this._uniforms.u_polygonBounding&&(this._uniforms.u_polygonBounding.value=this._polygonBounding),this._uniforms.u_enabled&&(this._uniforms.u_enabled.value=this._enabled),this._uniforms.u_delta&&(this._uniforms.u_delta.value=this._delta)}}_addShaderSource(){if(this._initShaderSource)return;const e=new Ig({url:"./"});e.texture=this._colorTexture;const t={u_inverseLocalModel:{type:Rg.MAT4,value:this._inverseLocalModel},u_localModel:{type:Rg.MAT4,value:this._localModel},u_polygonBounding:{type:Rg.VEC4,value:this.polygonBounding},u_polygonTexture:{type:Rg.SAMPLER_2D,value:e},u_delta:{type:Rg.FLOAT,value:this._delta},u_enabled:{type:Rg.BOOL,value:this._enabled}};this._uniforms=t,this._model.customShader=new Dg({uniforms:t,vertexShaderText:"bool isPointInBound(vec4 point, vec4 bounds) {\n    return (point.x>bounds.x&&point.x<bounds.z&&point.y>bounds.y&&point.y<bounds.w);\n  }\n  void vertexMain(VertexInput vsInput, inout czm_modelVertexOutput vsOutput) {\n  vec4 positionLC = u_inverseLocalModel * czm_model * vec4(vsInput.attributes.positionMC, 1.0);  \n    if (u_enabled && isPointInBound(positionLC, u_polygonBounding)) {\n      vec2 textureCoord;\n      textureCoord.x = (positionLC.x-u_polygonBounding.x)/(u_polygonBounding.z-u_polygonBounding.x);\n      textureCoord.y = (positionLC.y-u_polygonBounding.y)/(u_polygonBounding.w-u_polygonBounding.y);\n      float depth = czm_unpackDepth(texture2D(u_polygonTexture, textureCoord));\n      depth = depth * 4096.0;\n      if (depth > 1.0 && positionLC.z > depth) {\n        positionLC.z = mix(depth, positionLC.z, u_delta);\n      }\n      vsOutput.positionMC = (czm_inverseModel * u_localModel * positionLC).xyz;\n    }       \n  }"}),this._initShaderSource=!0}_createDrawCommand(e,t){const i=this._frameState,n=e.attributes.position.values;for(let e=0,i=n.length;e<i/3;e++){const i=new sg(n[3*e],n[3*e+1],n[3*e+2]);hg.multiplyByPoint(t,i,i),n[3*e]=i.x,n[3*e+1]=i.y,n[3*e+2]=i.z,this._positions.push(i)}e.boundingSphere=Cg.transform(e.boundingSphere,t),this.polygonBounding=og.fromPoints(this._positions);const r=wg.fromGeometry({context:i.context,geometry:e,attributeLocations:{position:0},bufferUsage:bg.STREAM_DRAW,interleave:!0}),o=Sg.fromCache({context:i.context,vertexShaderSource:"\nattribute vec3 position;\nvarying float depth;\nvoid main() {\n  vec4 pos = vec4(position, 1.0);\n  depth = position.z;\n  gl_Position = czm_projection * vec4(position.xy, 0.0, 1.0); \n}\n",fragmentShaderSource:"\nvarying float depth;\nvoid main() {\n  float fDepth = depth / 4096.0; \n  gl_FragColor = czm_packDepth(fDepth);\n}\n"}),s=new Tg;s.depthTest.enabled=!0,s.cull.enabled=!0,s.cull.face=Eg.BACK;const a=new Pg({primitiveType:Ag.TRIANGLES,vertexArray:r,shaderProgram:o,uniformMap:{},renderState:s,pass:Mg.CESIUM_3D_TILE});this._updateUniforms(),this._drawCommandList.push(a)}addPolygon(e){this._localModel?this._createDrawCommand(e,this._inverseLocalModel):this.readyPromise.then((()=>{this._updateMatrix(),this._createDrawCommand(e,this._inverseLocalModel)}))}_updateMatrix(){let e=this._model._rtcCenter;if(!e){const t=this._model.boundingSphere.center,i=ag.fromCartesian(t);e=sg.fromRadians(i.longitude,i.latitude,0)}this._localModel=Lg.eastNorthUpToFixedFrame(e),this._inverseLocalModel=hg.inverse(this._localModel,{})}addPolygonFromPositionArray(e){const t=Math.min(...e.map((e=>ag.fromCartesian(e).height))),i=new _g({polygonHierarchy:new xg(e),height:t}),n=_g.createGeometry(i);this.addPolygon(n)}update(e){if(!this._drawCommandList.length)return;zg.call(this,e),this._initShaderSource||this._addShaderSource(),cg(this._passState)||(this._passState=new gg(e.context)),this._updateUniforms(),this._passState.viewport=new og(0,0,this._width,this._height);const t=e.context.uniformState;t.updateCamera(this._camera),this._clearColorCommand.framebuffer=this.frameBuffer,this._clearColorCommand.execute(e.context,this._clearPassState);for(const i of this._drawCommandList)t.updatePass(i.pass),i.framebuffer=this.frameBuffer,i.execute(e.context,this._passState)}clear(){this._clearColorCommand&&this._clearColorCommand.execute(this._frameState.context,this._clearPassState)}isDestroyed(){return!1}destroy(){this._colorTexture&&!this._colorTexture.isDestroyed()&&this._colorTexture.destroy(),this._depthStenclilTexture&&!this._depthStenclilTexture.isDestroyed()&&this._depthStenclilTexture.destroy(),this.frameBuffer&&!this.frameBuffer.isDestroyed()&&this.frameBuffer.destroy(),ug(this),this._removeEvent()}},e.GaoDeLayer=wm,e.GeoJsonDataSource=fl,e.Geographic4490TilingScheme=ko,e.Globe=Yu,e.Graphic=Oo,e.GraphicGroup=zo,e.GroundSkyBox=class{constructor(e={}){this.sources=Ho(e.sources,{positiveX:di.buildModuleUrl("./assets/skybox/px.png"),negativeX:di.buildModuleUrl("./assets/skybox/nx.png"),positiveY:di.buildModuleUrl("./assets/skybox/py.png"),negativeY:di.buildModuleUrl("./assets/skybox/ny.png"),positiveZ:di.buildModuleUrl("./assets/skybox/pz.png"),negativeZ:di.buildModuleUrl("./assets/skybox/nz.png")}),this._sources=void 0,this.show=Ho(e.show,!0),this._command=new jo({modelMatrix:Uo.clone(Uo.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0,this._isDestroyed=!1}update(e,t){const i=new ss,n=this;if(!this.show)return;if(e.mode!==ns.SCENE3D&&e.mode!==ns.MORPHING)return;if(!e.passes.render)return;const{context:r}=e;if(this._sources!==this.sources){this._sources=this.sources;const{sources:e}=this;if(!($o(e.positiveX)&&$o(e.negativeX)&&$o(e.positiveY)&&$o(e.negativeY)&&$o(e.positiveZ)&&$o(e.negativeZ)))throw new Le("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof e.positiveX!=typeof e.negativeX||typeof e.positiveX!=typeof e.positiveY||typeof e.positiveX!=typeof e.negativeY||typeof e.positiveX!=typeof e.positiveZ||typeof e.positiveX!=typeof e.negativeZ)throw new Le("this.sources properties must all be the same type.");"string"==typeof e.positiveX?Ko(r,this._sources).then((e=>{n._cubeMap=n._cubeMap&&n._cubeMap.destroy(),n._cubeMap=e})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new Qo({context:r,source:e}))}const o=this._command;if(o.modelMatrix=Xo.eastNorthUpToFixedFrame(e.camera._positionWC),!$o(o.vertexArray)){o.uniformMap={u_cubeMap:()=>n._cubeMap,u_rotateMatrix:()=>"function"==typeof Uo.getRotation?Uo.getRotation(o.modelMatrix,i):Uo.getMatrix3(o.modelMatrix,i)};const e=Vo.createGeometry(Vo.fromDimensions({dimensions:new qo(2,2,2),vertexFormat:Jo.POSITION_ONLY})),t=this._attributeLocations=Yo.createAttributeLocations(e);o.vertexArray=ts.fromGeometry({context:r,geometry:e,attributeLocations:t,bufferUsage:Zo._DRAW}),o.renderState=es.fromCache({blending:is.ALPHA_BLEND})}if(!$o(o.shaderProgram)||this._useHdr!==t){const e=new os({defines:[t?"HDR":""],sources:["uniform samplerCube u_cubeMap;\n  varying vec3 v_texCoord;\n  void main()\n  {\n  vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n  gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n  }\n  "]});o.shaderProgram=rs.fromCache({context:r,vertexShaderSource:"attribute vec3 position;\n  varying vec3 v_texCoord;\n  uniform mat3 u_rotateMatrix;\n  void main()\n  {\n  vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n  gl_Position = czm_projection * vec4(p, 1.0);\n  v_texCoord = position.xyz;\n  }\n  ",fragmentShaderSource:e,attributeLocations:this._attributeLocations}),this._useHdr=t}return $o(this._cubeMap)?o:void 0}isDestroyed(){return this._isDestroyed}destroy(){const e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),Wo(this)}},e.HeightAnalysis=rt,e.HtmlGraphicGroup=class extends zo{constructor(e,t={}){super(e),this._viewer=e,this._allowPicking=De(t.allowPicking,!1),this._createRoot(),this._addEventListener(),this.selectedEvent=new Be}_createRoot(){const e=document.createElement("div");e.style.position="absolute",e.style.zIndex=9999,e.style.pointerEvents="none",e.style.width="100vw",e.style.height="100vh",e.style.left=0,e.style.top=0,this._viewer.container.appendChild(e),this.root=e}_addEventListener(){const e=this._viewer.scene.postRender.addEventListener((()=>{const e=this.values._array,t=viewer.camera._positionCartographic.height;for(let i of e){const e=i.position,n=i.el;if(!n)return;const r=Ie.toPixel(e,this._viewer.scene);if(r&&Ie.isVisible(e,this._viewer))if(n.style.left=r.x+"px",n.style.top=r.y+"px",i.distanceDisplayCondition){const{near:e,far:r}=i.distanceDisplayCondition;n.style.display=t<r&&t>e?i.display||"block":"none"}else n.style.display=i.display||"block";else n.style.display="none"}})),t=this;function i(e){const{target:i}=e;if(!i)return;const n=t.getById(i.id);t.selectedEvent.raise(n)}this.root.addEventListener("click",i),this.removeEventListener=function(){e(),t.root.removeEventListener("click",i)}}add(e){if(!(e instanceof as))throw new Le(e+"is not a html graphic.");this.values.set(e.id,e),this.root.appendChild(e.el),e.group=this,e._loadEvent.raise()}remove(e){this.values.remove(e.id),e.el&&this.root.removeChild(e.el)}getById(e){return this.values.get(e)}removeById(e){const t=this.values.get(e);this.remove(t)}clear(){const e=[...this.values._array];for(let t of e)t.remove();this.values.removeAll()}destroy(){this._viewer.container.removeChild(this.root),this.removeEventListener(),je(this)}get boundingSphere(){const e=this.values._array.map((e=>Ie.toCartesian(e.position)));return Cesium.BoundingSphere.fromPoints(e)}},e.HtmlPointGraphic=as,e.ImageGraphic=class extends Fd{constructor(e){super(e),this._primitive=new Lp,this._image=e.image,this._speedFactor=De(e.speedFactor,1),this._imageIndex=0,this._imageParser=e.imageParser,this.createGraphic()}get clampToGround(){}set clampToGround(e){throw new Le("clampToGround is not valid.")}get speedFactor(){return this._speedFactor}set speedFactor(e){this._speedFactor=e}createGraphic(){this._requestImage=function(e,t=[],i){const n=document.createElement("img");n.src=e,n.setAttribute("rel:animated_src",e),n.setAttribute("rel:auto_play","0"),n.style.cssText="position:fixed;zIndex: -1;",document.body.appendChild(n);const r=new Mp({gif:n});return new Promise((e=>{r.load((()=>{for(let e=1;e<=r.get_length();e++){r.move_to(e);const n=r.get_canvas();i&&i(n),t.push(n.toDataURL())}e(t)}))}))}(this._image,[],this._imageParser),this._billboard=this._primitive.add({position:Ie.toCartesian(this._position),image:this._image,verticalOrigin:Dp.BOTTOM})}update(){this._speedFactor<=0||this._requestImage.then((e=>{const t=e[Math.floor(this._imageIndex++/this._speedFactor)%e.length];this._billboard.image=t}))}remove(){super.remove(),this._billboard=void 0}},e.InfoBox=Uc,e.LonLat=Ie,e.LonLatNetLayer=class{constructor(e={}){const t=new ps({rectangle:Cesium.Rectangle.MAX_VALUE,intervalOfZeorLevel:e.intervalOfZeorLevel});this._hasAlphaChannel=De(e.hasAlphaChannel,!0),this._tilingScheme=t,this._image=void 0,this._texture=void 0,this._errorEvent=new Be,this._ready=!0,this._readyPromise=Promise.resolve(!0),this._font=De(e.font,"bold 24px sans-serif"),this._color=De(e.color,"white"),this._lineColor=De(e.lineColor,"gold"),this._lineWidth=De(e.lineWidth,2)}get hasAlphaChannel(){return this._hasAlphaChannel}get tileHeight(){return 256}get tileWidth(){return 256}get minimumLevel(){return 0}get maximumLevel(){return 4}get rectangle(){return Cesium.Rectangle.MAX_VALUE}get errorEvent(){return this._errorEvent}get tileDiscardPolicy(){}get readyPromise(){return this._readyPromise}get ready(){return!0}get tilingScheme(){return this._tilingScheme}get font(){return this._font}set font(e){this._font=e}get color(){return`rgba(${255*this._color.red}, ${255*this._color.green}, ${255*this._color.blue}, ${this._color.alpha})`}set color(e){this._color=e}get lineColor(){const e=this._lineColor;return`rgba(${255*e.red}, ${255*e.green}, ${255*e.blue}, ${e.alpha})`}set lineColor(e){this._lineColor=e}get lineWidth(){return this._lineWidth}createCanvas(){const e=document.createElement("canvas");e.width=this.tileWidth,e.height=this.tileHeight;const t=e.getContext("2d");return t.textBaseline="middle",t.textAlign="center",t.font=this.font,t.fillStyle=this.color,t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,{canvas:e,ctx:t}}getOffset(e,t,i){const n=this.tilingScheme.getDelatXY(i),r=Math.floor(e),o=Math.floor(t);if(r===e&&o===t)return[0,0,r,o];const s=e-r,a=t-o;let l=0,c=0;return s&&(l=this.tileWidth/n.dx*s),a&&(c=this.tileHeight/n.dy*a),[l,c,r,o]}requestImage(e,t,i,n){const{ctx:r,canvas:o}=this.createCanvas(),s=this.tilingScheme.getPosition(i,e,t);return r.textAlign="left",r.fillText(s.lon,10,o.height/2),r.textAlign="center",r.fillText(s.lat,o.width/2,20),r.strokeRect(0,0,o.width,o.height),Promise.resolve(o)}},e.LonlatTilingScheme=ps,e.MassiveBillboardLayer=class extends qg{constructor(e={}){e.objects=De(e.objects,[]),e.pixelSize=De(e.pixelSize,5),e.color=De(e.color,Qg.fromRandom),e.createGeometryFunction=De(e.createGeometryFunction,function(e){return function(t){const i={id:t.id,position:t.position,point:{pixelSize:De(t.pixelSize,e.pixelSize),color:De(t.color,e.color)}};return t.label&&(i.label={text:t.label}),new Kg(i)}}(e)),super(e)}},e.MassiveEntityLayer=qg,e.MassiveGraphicLayer=qc,e.MassiveGraphicLayerCollection=Yc,e.MassiveModelLayer=class extends qc{constructor(e={}){e.objects.forEach((e=>{e._id=e.id,delete e.id})),super(e),this._id=De(e.id,Ii()),this._createGeometryFunction=e.createGeometryFunction,this._data=e.objects,this._needReclass=!0,this._changeEvent=new ty,this._maxClusterLevel=De(e.maxClusterLevel,12),this._minLoadLevel=De(e.minLoadLevel,12),this._geometryCached={},this._objectsCached={},this._options=e}get id(){return this._id}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(e){this._minLoadLevel=e}get objects(){return this._objects||this._data}set objects(e){this._objects=e}updateCluster(e){const t=oy(e),i=this._objects;return t>this._maxClusterLevel?(this._objects=this._data,this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._objectsCached[t]?(this._objects=this._objectsCached[t],this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._cluster?new Promise(((e,i)=>{this._cluster.update(),this._objects=this._cluster._clusterObjects,this._objectsCached[t]=JSON.parse(JSON.stringify(this._objects)),this._needReclass=!0,e(!0)})):void 0}beginUpdate(e){oy(e.camera.positionCartographic.height)<this._minLoadLevel?this._objects=[]:this._objects=this._data}endUpdate(e){const t=oy(e.camera.positionCartographic.height);return this._needReclass=!1,t<this._minLoadLevel}initialize(e,t){if(!this._collection){this._scene=t;const e=new Cesium.PrimitiveCollection;t.primitives.add(e),this._collection=e}}createGeometry(e,t,i){if(e.level<this._minLoadLevel)return;const n=De(this._createGeometryFunction,ny)(i,this._options);return this.add(n),n}removeGeometry(e,t){if(!t)return;return this._collection.remove(t)}add(e){this._collection&&e&&this._collection.add(e)}removeAll(){this._collection.removeAll()}isDestroyed(){return!1}destroy(){this._collection.removeAll(),ey(this)}},e.MassivePointLayer=class extends qg{constructor(e={}){e.objects=De(e.objects,[]),e.pixelSize=De(e.pixelSize,5),e.color=De(e.color,hy.fromRandom),e.createGeometryFunction=De(e.createGeometryFunction,function(e){return function(t){let i=py();"string"!=typeof t.id&&"number"!=typeof t.id||(i=t.id);const n={id:i,position:t.position,point:{pixelSize:De(t.pixelSize,e.pixelSize),color:De(t.color,e.color)}};return t.label&&(n.label={text:t.label}),new dy(n)}}(e)),super(e)}},e.Material=fy,e.Model=Gs,e.MultipleTerrainProvider=class{constructor(e,t={}){this._heightmapWidth=65,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._ellipsoid=t.ellipsoid,this._requestVertexNormals=De(t.requestVertexNormals,!1),this._requestWaterMask=De(t.requestWaterMask,!1),this._requestMetadata=De(t.requestMetadata,!0),this._errorEvent=new Be,this._terrainProviders=[];const i=[];for(let n of e){n.requestVertexNormals=n.requestVertexNormals||t.requestVertexNormals,n.requestWaterMask=n.requestWaterMask||t.requestWaterMask,n.requestMetadata=n.requestMetadata||t.requestMetadata;const e=new Yt(n);e.zIndex=n.zIndex||-1,this._terrainProviders.push(e),i.push(bs(e,n.url))}this._ready=!1,this._readyPromise=new Promise((e=>{Promise.all([...this._terrainProviders.map((e=>e.readyPromise)),...i]).then((t=>{this._ready=!0,e(!0),this._tilingScheme=this._terrainProviders[0]._tilingScheme,this._levelZeroMaximumGeometricError=fs.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0))}))})),this._terrainList=e,this._validProvider=void 0}get errorEvent(){return this._errorEvent}get tilingScheme(){return this._tilingScheme}get ready(){return this._ready}get readyPromise(){return this._readyPromise}createBoundingRectangle(e){const t=new ys("multiple-terrain-provider");for(let e of this._terrainProviders)t.entities.add(ws(e));return e.addLayer(t),function(){const t=e.dataSources.getByName("multiple-terrain-provider");e.dataSources.remove(t[0])}}getLevelMaximumGeometricError(e){return this._validProvider?this._validProvider.getLevelMaximumGeometricError(e):this._levelZeroMaximumGeometricError/(1<<e)}getTileDataAvailable(e,t,i){const n=this._terrainProviders.filter((n=>n.getTileDataAvailable(e,t,i))).sort(((e,t)=>t.zIndex-e.zIndex));return this._validProvider=n[0],!!this._validProvider}requestTileGeometry(e,t,i,n){for(let n of this._terrainProviders)n!==this._validProvider&&n.getTileDataAvailable(e,t,i)&&n.requestTileGeometry(e,t,i);if(this._validProvider)return this._validProvider.requestTileGeometry(e,t,i)}},e.NodePlot=gf,e.PbfDataSource=function(){},e.PlotManager=class{constructor(e,t){Fe(e),this._viewer=e,t=De(t,{}),this._id=De(t.id,Ge()),this._dataSource=new Cesium.CustomDataSource("cesiumpro-graphic_"+this._id),this._nodeDataSource=new Cesium.CustomDataSource("cesiumpro-graphic-node_"+this._id),this._viewer.dataSources.add(this._dataSource),this._viewer.dataSources.add(this._nodeDataSource),this._root=this._dataSource.entities,this._nodeRoot=this._nodeDataSource.entities,this._preEdit=new Be,this._postEdit=new Be,this._preCreate=new Be,this._postCreate=new Be,this._preRemove=new Be,this._postRemove=new Be,this._values=new Cesium.AssociativeArray,this._handler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._pointStyle=De(t.pointStyle,df.defaultPointStyle),this._labelStyle=De(t.labelStyle,df.defaultLabelStyle),this._modelStyle=De(t.modelStyle,df.defaultModelStyle),this._billboardStyle=De(t.billboardStyle,df.defaultBillboardStyle),this._polylineStyle=De(t.polylineStyle,pf.defaultStyle),this._polygonStyle=De(t.polygonStyle,mf.defaultStyle),this._editEventHandler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._viewer.screenSpaceEventHandler.removeInputAction(bf),this.showTip=De(t.showTip,!0),this._mode=Ef,t.contextEnabled=De(t.contextEnabled,!0),t.contextEnabled&&(this.contextMenu=this.createContext(),this.addContextEventListener()),this.cursorTip=new Po({text:"",id:"plot-manager-tip",viewer:this._viewer,show:!1}),this.activeGraphic=void 0,this.selectedGraphic=void 0}get viewer(){return this._viewer}get preEdit(){return this._preEdit}get postEdit(){return this._postEdit}get preCreate(){return this._preCreate}get postCreate(){return this._postCreate}get preRemove(){return this._preRemove}get postRemove(){return this._postRemove}get root(){return this._root}pick(e){let t,i=!1;return hf.isPoint(e)&&(i=!0),this._mode=Pf,e===hf.POINT?t=this.createPoint(this._pointStyle,this._labelStyle):e===hf.LABEL?t=this.createLabel(this._labelStyle):e===hf.MODEL?t=this.createModel(this._modelStyle,this._labelStyle):e===hf.BILLBOARD?t=this.createBillboard(this._billboardStyle,this._labelStyle):e===hf.POLYLINE?t=this.createPolyline(this._polylineStyle):e===hf.POLYGON?t=this.createPolygon(this._polygonStyle):hf.isArrow(e)&&(t=this.createArrow(this._polygonStyle,e)),this.activeGraphic=t,t.startEdit(),this.addEventListener(i),t}createPoint(e,t){const i=new df(e,{label:t});return this.add(i),i}createLabel(e){const t=new df(e,{type:hf.LABEL});return this.add(t),t}createModel(e,t){const i=new df(e,{type:hf.MODEL,label:t});return this.add(i),i}createBillboard(e,t){const i=new df(e,{type:hf.BILLBOARD,label:t});return this.add(i),i}createPolyline(e){const t=new pf(e);return this.add(t),t}createPolygon(e){const t=new mf(e);return this.add(t),t}createArrow(e,t){const i=new yf(e,{type:t});return this.add(i),i}add(e){this.preCreate.raise(e),Re(this.viewer&&Re(e.entity))&&(this.root.add(e.entity),this._values.set(e.id,e),this.postCreate.raise(e))}remove(e){Re(e)&&(this.preRemove.raise(e),Re(this.viewer)&&Re(e.entity)&&(this.root.remove(e.entity),this.postRemove.raise(e)),this._values.remove(e.id),this.activeGraphic&&(this.activeGraphic=void 0))}get(e){return this._values.values[e]}getById(e){return this._values.get(e)}hasEntity(e){return!!Re(e)&&this._root.contains(e)}removeAll(){this.root.removeAll(),this.removeNodeGraphic(),this._values.removeAll()}destroy(){this.removeAll(),this.contextMenu&&this.contextMenu.destroy(),this.removeContextEventListener(),this._viewer.dataSources.remove(this._dataSource),this._viewer.dataSources.remove(this._nodeDataSource),this.cursorTip.destroy(),this._handler.isDestroyed()||this._handler.destroy(),je(this)}zoomTo(e){const t=[];if(Array.isArray(e))for(let i of e)t.push(i.entity);else t.push(e.entity);Re(this._viewer)&&this._viewer.zoomTo(t)}has(e){return"string"==typeof e?this._values.contains(e):this._values.values.includes(e)}startEdit(e){this.activeGraphic&&this.stopEdit(this.activeGraphic),e&&(e.startEdit(),this.preEdit.raise(e),this.createNodeGraphic(e),this.activeGraphic=e,this.addEditEventListener(),this.cursorTip.show=!0,this.cursorTip.text="单击节点选中")}stopEdit(e){e&&(e.stopEdit(),e.highlightGraphic(!1),this._nodeRoot.removeAll(),this.cursorTip.show=!1,this.activeGraphic=void 0,this._mode=Ef,this.postEdit.raise(e),this.removeEditListener&&this.removeEditListener())}createNodeGraphic(e){if(hf.isPoint(e.type))return;const t=new gf({positions:e._nodePositions,...df.defaultStyle}),i=t._values;for(let e of i)this._nodeRoot.add(e);this._nodeGraphic=t}removeNodeGraphic(){this._nodeRoot.removeAll(),this._nodeGraphic=void 0}addEventListener(e=!0){if(!Re(this.activeGraphic))return;const t=this.activeGraphic.positions,i=e=>{const i=this.pickPosition(e.endPosition);Re(i)&&(this.showTip&&(this.cursorTip.show=!0,this.cursorTip.text="左键单击添加节点，右键结束。"),t.length<1||(t.length>1&&this.activeGraphic.popNode(),this.activeGraphic.addNode(i)))},n=()=>{this._handler.removeInputAction(vf),this._handler.removeInputAction(_f),this._handler.removeInputAction(Tf),this.stopEdit(this.activeGraphic),Re(this.contextMenu)&&this.addContextEventListener()};e||(this._handler.setInputAction(i,_f),this._handler.setInputAction(n,Tf)),this._handler.setInputAction((t=>{const i=hf.isPoint(this.activeGraphic.type)?this.activeGraphic.updatePosition.bind(this.activeGraphic):this.activeGraphic.addNode.bind(this.activeGraphic),n=this.pickPosition(t.position);Re(n)&&(Re(i)&&i(n),e&&(this._handler.removeInputAction(vf),this.stopEdit(this.activeGraphic)))}),vf)}addEditEventListener(){const e=this._editEventHandler;let t=!1;const i=i=>{t=!1,Is(this._viewer,!t),e.removeInputAction(_f),e.removeInputAction(wf)},n=e=>{const t=this.pickPosition(e.endPosition);this.updatePosition(t)};e.setInputAction((e=>{if(Re(this.contextMenu)&&(this.contextMenu.show=!1),!Re(this.activeGraphic))return;const t=this._viewer.scene.pick(e.position);Re(t)&&t.id instanceof Cesium.Entity?this.hasEntity(t.id)?(this.activeGraphic.highlightGraphic(),this._nodeGraphic&&(this._nodeGraphic.activeNode=void 0)):this._nodeGraphic&&this._nodeGraphic.has(t.id)?(this._nodeGraphic.activeNode=t.id.position.getValue(this._viewer.clock.currentTime),this.activeGraphic.highlightGraphic(!1)):(this._nodeGraphic.activeNode=void 0,this.activeGraphic.highlightGraphic(!1)):(this._nodeGraphic&&(this._nodeGraphic.activeNode=void 0),this.activeGraphic&&this.activeGraphic.highlightGraphic(!1))}),vf),e.setInputAction((()=>{t=!0,Is(this._viewer,!t),e.setInputAction(i,wf),e.setInputAction(n,_f)}),Cf),this.removeEditListener=function(){e.removeInputAction(_f),e.removeInputAction(wf),e.removeInputAction(vf),e.removeInputAction(Cf),this.removeEditListener=void 0}}addContextEventListener(){this._editEventHandler.setInputAction((e=>{if(this._mode!==Ef)return;const t=this._viewer.scene.pick(e.position),i=Ss(e.position,this._viewer,!0);Re(t)&&this.hasEntity(t.id)&&(this.contextMenu.position=i,this.selectedGraphic=this.getById(t.id.id),Re(this.contextMenu)&&(this.contextMenu.show=!0))}),Sf)}removeContextEventListener(){this._editEventHandler.removeInputAction(Sf)}removeEditEventListener(){this._editEventHandler.removeInputAction(vf),this._editEventHandler.removeInputAction(Cf)}updatePosition(e){const t=this.activeGraphic;if(Re(t))if(hf.isPoint(t.type))t.updatePosition(e);else{if(!Re(this._nodeGraphic)||!Re(this._nodeGraphic.activeIndex))return;t.updateNode(this._nodeGraphic.activeIndex,e)}}pickPosition(e){if(Re(this.activeGraphic))return this.activeGraphic.clampToModel,Ss(e,this._viewer)}addNode(e,t,i){if(e.addNode(t,i),this._nodeGraphic){const e=this._nodeGraphic.addNode(t,i);this._nodeRoot.add(e)}}removeNode(e,t){if(e.removeNode&&e.removeNode(t),this._nodeGraphic){const e=this._nodeGraphic.removeNode(t);this._nodeRoot.remove(e)}}get show(){return this._root.show}set show(e){this._root.show=e}get pointStyle(){return this._pointStyle}set pointStyle(e){this._pointStyle=e}get labelStyle(){return this._labelStyle}set labelStyle(e){this._labelStyle=e}get billboardStyle(){return this._billboardStyle}set billboardStyle(e){this._billboardStyle=e}get modelStyle(){return this._modelStyle}set modelStyle(e){this._modelStyle=e}createContext(){return this.contextMenu=new Ri(this._viewer,{items:[{id:"startEdit",text:"开始编辑",class:"fa fa-pencil-square-o",disabled:this.activeGraphic,callback:e=>{if(this.selectedGraphic){this.startEdit(this.selectedGraphic);const t=this.contextMenu.getById("stopEdit");this.contextMenu.updateItemDistabled(t,!1),this.contextMenu.updateItemDistabled(e,!0)}}},{id:"stopEdit",text:"停止编辑",class:"fa fa-floppy-o",disabled:!this.activeGraphic,callback:e=>{if(this.selectedGraphic){this.stopEdit(this.selectedGraphic);const t=this.contextMenu.getById("startEdit");this.contextMenu.updateItemDistabled(e,!0),this.contextMenu.updateItemDistabled(t,!1)}}},{id:"delete",text:"删除图形",class:"fa fa-times",callback:e=>{this.remove(this.selectedGraphic)}},{id:"select",text:"选择顶点",class:"fa fa-mouse-pointer"}]}),this.contextMenu}},e.PlotType=hf,e.PointBaseGraphic=Fd,e.PointPlot=df,e.PolygonPlot=mf,e.PolylineAntialiasingMaterialProperty=$f,e.PolylineFlowMaterialProperty=Zf,e.PolylineODMaterialProperty=eg,e.PolylinePlot=pf,e.PolylineTrailLinkMaterialProperty=rg,e.PostProcessing=vy,e.Primitive=function(){Object.defineProperty(jh.prototype,"needUpdate",{get(){return!!this._needUpdate},set(e){this._needUpdate=e}}),jh.prototype.update=function(e){if(Jh.call(this,e),this.needUpdate){var t=Yh(this._createShaderProgramFunction,td);console.log("update shader"),t(this,e,appearance),this.needUpdate=!1}}},e.Properties=Rs,e.RadarScanGraphic=class extends Fd{constructor(e){super(e),this._speed=De(e.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(e){e!==this._speed&&(e<0&&(this._speed=0),this.definedChanged.raise("speed",e,this._speed),this._speed=e)}createAppearance(){return this._appearance||(this._appearance=new Ip({material:new kp({translucent:!0,fabric:{uniforms:{color:this._color,time:0},source:Rp}})})),this._appearance}update(e){if(!this.material)return;if(0===this.speed)return void(this.material.uniforms.time=.9999);const t=Cesium.JulianDate.toDate(e).getTime()/500*this.speed;this.material.uniforms.time=t-parseInt(t)}},e.RectangularSensorPrimitive=class{constructor(e){e=De(e,De.EMPTY_OBJECT);const t=this;if(this._createVS=!0,this._createRS=!0,this._createSP=!0,this.show=De(e.show,!0),this.slice=De(e.slice,32),e.modelMatrix)this._modelMatrix=by.clone(e.modelMatrix,new by);else{if(!e.position)throw new Le("parameter position or modelMatrix must be provided.");this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(Ie.toCartesian(e.position))}this._computedModelMatrix=new by,this._computedScanPlaneModelMatrix=new by,this._radius=De(e.radius,Number.POSITIVE_INFINITY),this._xHalfAngle=Zy.toRadians(De(e.xHalfAngle,0)),this._yHalfAngle=Zy.toRadians(De(e.yHalfAngle,0)),this._color=De(e._color,Ty.AQUA.withAlpha(.4)),this.lineColor=De(e.lineColor,Ty.WHITE),this.showSectorLines=De(e.showSectorLines,!0),this.showSectorSegmentLines=De(e.showSectorSegmentLines,!0),this.showLateralSurfaces=De(e.showLateralSurfaces,!0),this._material=Re(e.material)?e.material:Sy.fromType(Sy.ColorType),this._material.uniforms.color=this._color,this._translucent=void 0,this.lateralSurfaceMaterial=Re(e.lateralSurfaceMaterial)?e.lateralSurfaceMaterial:Sy.fromType(Sy.ColorType),this._lateralSurfaceMaterial=void 0,this._lateralSurfaceTranslucent=void 0,this.showDomeSurfaces=De(e.showDomeSurfaces,!0),this.domeSurfaceMaterial=Re(e.domeSurfaceMaterial)?e.domeSurfaceMaterial:Sy.fromType(Sy.ColorType),this.showDomeLines=De(e.showDomeLines,!0),this.showIntersection=De(e.showIntersection,!1),this.intersectionColor=De(e.intersectionColor,Ty.WHITE),this.intersectionWidth=De(e.intersectionWidth,5),this._showThroughEllipsoid=De(e.showThroughEllipsoid,!1),this.showScanPlane=De(e.showScanPlane,!0),this.scanPlaneColor=De(e.scanPlaneColor,Ty.AQUA),this.scanPlaneMode=De(e.scanPlaneMode,"H"),this.speed=De(e.speed,10),this._scanePlaneXHalfAngle=0,this._scanePlaneYHalfAngle=0,this._time=Ey.now(),this._boundingSphere=new Py,this._boundingSphereWC=new Py,this._boundingSphere=new Py(Wy.ZERO,this._radius),by.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),Py.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC),this._sectorFrontCommand=new Ay({owner:this,primitiveType:My.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorBackCommand=new Ay({owner:this,primitiveType:My.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorVA=void 0,this._sectorLineCommand=new Ay({owner:this,primitiveType:My.LINES,boundingVolume:this._boundingSphereWC}),this._sectorLineVA=void 0,this._sectorSegmentLineCommand=new Ay({owner:this,primitiveType:My.LINES,boundingVolume:this._boundingSphereWC}),this._sectorSegmentLineVA=void 0,this._domeFrontCommand=new Ay({owner:this,primitiveType:My.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeBackCommand=new Ay({owner:this,primitiveType:My.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeVA=void 0,this._domeLineCommand=new Ay({owner:this,primitiveType:My.LINES,boundingVolume:this._boundingSphereWC}),this._domeLineVA=void 0,this._scanPlaneFrontCommand=new Ay({owner:this,primitiveType:My.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanPlaneBackCommand=new Ay({owner:this,primitiveType:My.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanRadialCommand=void 0,this._colorCommands=[],this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._uniforms={u_type:function(){return 0},u_xHalfAngle:function(){return t._xHalfAngle},u_yHalfAngle:function(){return t._yHalfAngle},u_radius:function(){return t.radius},u_showThroughEllipsoid:function(){return t.showThroughEllipsoid},u_showIntersection:function(){return t.showIntersection},u_intersectionColor:function(){return t.intersectionColor},u_intersectionWidth:function(){return t.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return t.lineColor}},this._scanUniforms={u_xHalfAngle:function(){return t._scanePlaneXHalfAngle},u_yHalfAngle:function(){return t._scanePlaneYHalfAngle},u_radius:function(){return t.radius},u_color:function(){return t.scanPlaneColor},u_showThroughEllipsoid:function(){return t.showThroughEllipsoid},u_showIntersection:function(){return t.showIntersection},u_intersectionColor:function(){return t.intersectionColor},u_intersectionWidth:function(){return t.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return t.lineColor}}}get color(){return this._color}set color(e){this._color=e,this._material.uniforms.color=e}get boundingSphere(){return this._boundingSphere}get xHalfAngle(){return Zy.toDegrees(this._xHalfAngle)}set xHalfAngle(e){this._xHalfAngle!==e&&(this._xHalfAngle=Zy.toRadians(e),this._createVS=!0)}get yHalfAngle(){return Zy.toDegrees(this._yHalfAngle)}set yHalfAngle(e){this._yHalfAngle!==e&&(this._yHalfAngle=Zy.toRadians(e),this._createVS=!0)}get radius(){return this._radius}set radius(e){this._radius!==e&&(this._radius=e,this._boundingSphere=new Py(Wy.ZERO,e),by.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),Py.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC))}get modelMatrix(){return this._modelMatrix}set modelMatrix(e){!by.equals(e,this._modelMatrix)&&(by.clone(e,this._modelMatrix),by.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),Py.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC))}get showThroughEllipsoid(){return this._showThroughEllipsoid}set showThroughEllipsoid(e){this._showThroughEllipsoid!==e&&(this._showThroughEllipsoid=e,this._createRS=!0)}get material(){return this._material}set material(e){this._material=e,this._createRS=!0,this._createSP=!0}update(e){const t=e.mode;if(!this.show||t!==Ly.SCENE3D)return;const i=this._xHalfAngle,n=this._yHalfAngle;if(i<0||n<0)throw new Le("halfAngle must be greater than or equal to zero.");if(0==i||0==n)return;if(this.radius<0)throw new Le("this.radius must be greater than or equal to zero.");const r=this.showThroughEllipsoid,o=this.material,s=o.isTranslucent();if(this._translucent!==s&&(this._translucent=s,this._createRS=!0),this.showScanPlane){const t=e.time;let r,o,s=Ey.secondsDifference(t,this._time);if(s<0&&(this._time=Ey.clone(t,this._time)),this.speed<=0)r=0;else{const e=10/this.speed;r=Math.max(s%e/e,0)}const a=new Dy;if("H"==this.scanPlaneMode){o=2*n*r-n;const e=$y(o),t=Xy(i),s=Jy(e*t);this._scanePlaneXHalfAngle=s,this._scanePlaneYHalfAngle=o,Dy.fromRotationX(this._scanePlaneYHalfAngle,a)}else{o=2*i*r-i;const e=Xy(n),t=$y(o),s=Jy(t*e);this._scanePlaneXHalfAngle=o,this._scanePlaneYHalfAngle=s,Dy.fromRotationY(this._scanePlaneXHalfAngle,a)}by.multiplyByMatrix3(this.modelMatrix,a,this._computedScanPlaneModelMatrix),by.multiplyByUniformScale(this._computedScanPlaneModelMatrix,this.radius,this._computedScanPlaneModelMatrix)}this._createVS&&function(e,t){const i=t.context,n=ev(e,e._xHalfAngle,e._yHalfAngle),r=function(e,t){const i=e._xHalfAngle,n=e._yHalfAngle,r=t.zoy,o=t.zox,s=[],a=new Dy;let l=Dy.fromRotationY(i,a);return s.push(r.map((function(e){return Dy.multiplyByVector(l,e,new Wy)}))),l=Dy.fromRotationX(-n,a),s.push(o.map((function(e){return Dy.multiplyByVector(l,e,new Wy)})).reverse()),l=Dy.fromRotationY(-i,a),s.push(r.map((function(e){return Dy.multiplyByVector(l,e,new Wy)})).reverse()),l=Dy.fromRotationX(n,a),s.push(o.map((function(e){return Dy.multiplyByVector(l,e,new Wy)}))),s}(e,n);e.showLateralSurfaces&&(e._sectorVA=function(e,t){const i=Array.prototype.concat.apply([],t).length-t.length,n=new Float32Array(18*i);let r=0;for(let e=0,i=t.length;e<i;e++){const i=t[e],o=new Wy,s=Wy.normalize(Wy.cross(i[0],i[i.length-1],o),o);for(let e=0,t=i.length-1;e<t;e++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z,n[r++]=i[e].x,n[r++]=i[e].y,n[r++]=i[e].z,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z,n[r++]=i[e+1].x,n[r++]=i[e+1].y,n[r++]=i[e+1].z,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z}const o=Ry.createVertexBuffer({context:e,typedArray:n,usage:Iy.STATIC_DRAW}),s=6*Float32Array.BYTES_PER_ELEMENT,a=[{index:Qy.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:Ny.FLOAT,offsetInBytes:0,strideInBytes:s},{index:Qy.normal,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:Ny.FLOAT,offsetInBytes:3*Float32Array.BYTES_PER_ELEMENT,strideInBytes:s}];return new ky({context:e,attributes:a})}(i,r));e.showSectorLines&&(e._sectorLineVA=function(e,t){const i=t.length,n=new Float32Array(9*i);let r=0;for(let e=0,i=t.length;e<i;e++){const i=t[e];n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=i[0].x,n[r++]=i[0].y,n[r++]=i[0].z}const o=Ry.createVertexBuffer({context:e,typedArray:n,usage:Iy.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:Qy.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:Ny.FLOAT,offsetInBytes:0,strideInBytes:s}];return new ky({context:e,attributes:a})}(i,r));e.showSectorSegmentLines&&(e._sectorSegmentLineVA=function(e,t){const i=Array.prototype.concat.apply([],t).length-t.length,n=new Float32Array(9*i);let r=0;for(let e=0,i=t.length;e<i;e++){const i=t[e];for(let e=0,t=i.length-1;e<t;e++)n[r++]=i[e].x,n[r++]=i[e].y,n[r++]=i[e].z,n[r++]=i[e+1].x,n[r++]=i[e+1].y,n[r++]=i[e+1].z}const o=Ry.createVertexBuffer({context:e,typedArray:n,usage:Iy.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:Qy.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:Ny.FLOAT,offsetInBytes:0,strideInBytes:s}];return new ky({context:e,attributes:a})}(i,r));e.showDomeSurfaces&&(e._domeVA=function(e){const t=Uy.createGeometry(new Uy({vertexFormat:Oy.POSITION_ONLY,stackPartitions:32,slicePartitions:32}));return ky.fromGeometry({context:e,geometry:t,attributeLocations:Qy,bufferUsage:Iy.STATIC_DRAW,interleave:!1})}(i));e.showDomeLines&&(e._domeLineVA=function(e){const t=jy.createGeometry(new jy({vertexFormat:Oy.POSITION_ONLY,stackPartitions:32,slicePartitions:32}));return ky.fromGeometry({context:e,geometry:t,attributeLocations:Qy,bufferUsage:Iy.STATIC_DRAW,interleave:!1})}(i));if(e.showScanPlane)if("H"==e.scanPlaneMode){const t=ev(e,Zy.PI_OVER_TWO,0);e._scanPlaneVA=tv(i,t.zox)}else{const t=ev(e,0,Zy.PI_OVER_TWO);e._scanPlaneVA=tv(i,t.zoy)}}(this,e),this._createRS&&function(e,t,i){i?(e._frontFaceRS=Fy.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:zy.ALPHA_BLEND,cull:{enabled:!0,face:Hy.BACK}}),e._backFaceRS=Fy.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:zy.ALPHA_BLEND,cull:{enabled:!0,face:Hy.FRONT}}),e._pickRS=Fy.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:zy.ALPHA_BLEND})):(e._frontFaceRS=Fy.fromCache({depthTest:{enabled:!t},depthMask:!0}),e._pickRS=Fy.fromCache({depthTest:{enabled:!0},depthMask:!0}))}(this,r,s),this._createSP&&function(e,t,i){(function(e,t,i){const n=t.context,r=wy,o=new Vy({sources:[xy,i.shaderSource,Cy]});e._sp=qy.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:Qy});const s=new Vy({sources:[xy,i.shaderSource,Cy],pickColorQualifier:"uniform"});e._pickSP=qy.replaceCache({context:n,shaderProgram:e._pickSP,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:Qy})})(e,t,i),e.showScanPlane&&function(e,t,i){const n=t.context,r=wy,o=new Vy({sources:[xy,i.shaderSource,_y]});e._scanePlaneSP=qy.replaceCache({context:n,shaderProgram:e._scanePlaneSP,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:Qy})}(e,t,i)}(this,e,o),(this._createRS||this._createSP)&&function(e,t){e._colorCommands.length=0;const i=t?By.TRANSLUCENT:By.OPAQUE;e.showLateralSurfaces&&Ky(e,e._sectorFrontCommand,e._sectorBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorVA,e._uniforms,e._computedModelMatrix,t,i);e.showSectorLines&&Ky(e,e._sectorLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showSectorSegmentLines&&Ky(e,e._sectorSegmentLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorSegmentLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showDomeSurfaces&&Ky(e,e._domeFrontCommand,e._domeBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._domeVA,e._uniforms,e._computedModelMatrix,t,i);e.showDomeLines&&Ky(e,e._domeLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._domeLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showScanPlane&&Ky(e,e._scanPlaneFrontCommand,e._scanPlaneBackCommand,e._frontFaceRS,e._backFaceRS,e._scanePlaneSP,e._scanPlaneVA,e._scanUniforms,e._computedScanPlaneModelMatrix,t,i)}(this,s);const a=e.commandList,l=e.passes,c=this._colorCommands;if(l.render)for(let e=0,t=c.length;e<t;e++){const t=c[e];a.push(t)}}destroy(){this._pickSP.destroy(),this._sp=this._sp.destroy(),this._scanePlaneSP&&(this._scanePlaneSP=this._scanePlaneSP.destroy()),je(this)}},e.SatelliteScanGraphic=class extends Oo{constructor(e){if(e.path&&(e.position=e.path.position.getValue(viewer.clock.currentTime)),super(e),this._clampToGround=!1,!Re(e.position))throw new Le("参数options必须定义position或path属性。");const t=Ie.toCartographic(e.position,viewer);this._position=Ie.toCartesian(e.position),this._thickness=De(e.thickness,.3),this._slices=De(e.slices,20),this.speed=De(e.speed,.5),this._height=t.height,this._surface=Op.fromRadians(t.longitude,t.latitude),this.radius=e.radius||.5*this._height,this._inverse=e.inverse||!1,this._animation=!Re(e.animation)||e.animation,this._show=!Re(e.show)||e.show,this._color=e.color,this.path=e.path,this._tracked=e.tracked||!1,this._rotation=e.rotation,this._axis=e.axis,this._matrix=Np.multiplyByTranslation(Fp.eastNorthUpToFixedFrame(this._surface),new Op(0,0,.5*this._height),new Np),this.transform(this._rotation),this.image=e.image,this.model=e.model,this._primitive=new Gp,this._primitive.name="SatelliteScan",this._loadEvent.addEventListener((()=>{this._viewer&&(this.stopAnimate=this._viewer.scene.preUpdate.addEventListener((()=>{Yp(this)})))})),this.createGraphic()}updateMatrix(e){e&&(this._matrix=e,this.scanPrimitive.modelMatrix=e,this.modelPrimitive&&(this.modelPrimitive.modelMatrix=e))}updatePrimitive(){this.createGraphic()}createGraphic(){if(this.model){const e=zp.fromGltf({url:this.model,pixelOffset:new Cesium.Cartesian2(-10,10)});this.modelPrimitive=this.primitive.add(e)}if(this.image){const e=new Hp;this.primitive.add(e),this.imagePrimitive=e.add({image:this.image,position:this._position})}const e=new Bp({length:this._height,topRadius:0,bottomRadius:this.radius,vertextFormat:Wp.MaterialSupport.TEXTURED.vertextFormat}),t=new Up({geometry:e}),i=this.getShaderSorce(),n=new jp({fabric:{type:"satelliteMaterial",uniforms:{color:this._color||Vp.WHITE,repeat:this.slices,offset:0,thickness:this.thickness,sign:this.inverse?1:-1},source:i}}),r=new qp({modelMatrix:this._matrix,show:this.show,geometryInstances:t,appearance:new Wp({material:n}),asynchronous:!1});this.scanPrimitive=this.primitive.add(r),this.stopAnimate&&this.stopAnimate()}trackSatellite(){if(this._viewer)if(this._tracked){const e=new Cesium.BoundingSphere(this._position,this._height);this._viewer.camera.viewBoundingSphere(e),this._viewer.camera.lookAtTransform(this._matrix)}else this._viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY)}get inverse(){return this._inverse}set inverse(e){this._inverse=e,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.sign=e?1:-1)}get slices(){return this._slices}set slices(e){this._slices=e,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.repeat=e)}get thickness(){return this._thickness}set thickness(e){e<0&&(e=0),e>1&&(e=1),this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.thickness=e)}get rotation(){return this._rotation}set rotation(e){this._rotation=e,this.transform(e)}get axis(){return this._axis}get tracked(){return this._tracked}set tracked(e){e!==this._tracked&&(this._tracked=e,this.trackSatellite())}get color(){return this._color}set color(e){this._color=e,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.color=e)}get animation(){return this._animation}set animation(e){e!==this._animation&&(e?this.stopAnimate=this._viewer.scene.preUpdate.addEventListener((()=>{Yp(this)})):(this.stopAnimate&&this.stopAnimate(),this.stopAnimate=void 0),this._animation=e)}getShaderSorce(){return"\n    uniform vec4 color;\n    uniform float repeat;\n    uniform float offset;\n    uniform float thickness;\n    uniform float sign;\n    czm_material czm_getMaterial(czm_materialInput inputM){\n      czm_material material=czm_getDefaultMaterial(inputM);\n      float sp=1.0/repeat;\n      vec2 st=inputM.st;\n      float dis=distance(st,vec2(0.5));\n      float m=mod(dis + sign * offset,sp);\n      float a=step(sp*(1.0-thickness),m);\n      material.diffuse=color.rgb;\n      material.alpha=a*color.a;\n      return material;\n    }"}zoomTo(e){if(!this.show||!this._viewer)return;const t=new Cesium.BoundingSphere(this._position,this._height);this._viewer.camera.flyToBoundingSphere(t,{duration:e})}transform(e){e&&(e.x&&$p(this,e.x,new Op(1,0,0)),e.y&&$p(this,e.y,new Op(0,1,0)),e.z&&$p(this,e.z,new Op(0,0,1)))}},e.Scene=Uh,e.SectorGeometry=class{constructor(e){if(!Re((e=De(e,De.EMPTY_OBJECT)).center))throw new Le("parameter center is required.");if(!Re(e.radius))throw new Le("parameter radius is required.");if(!Re(e.fov))throw new Le("parameter fov is required.");this._center=e.center,this._radius=e.radius,this._fov=e.fov,this._slices=De(e.slices,this._fov),this._rotation=Cesium.Math.toRadians(De(e.rotation,0)),this._vertexFormat=De(e.vertexFormat,iv.POSITION_AND_ST),this._extrudedHeight=De(e.extrudedHeight,0),this._height=De(e.height,0),this._positions=void 0,this._workerName="createSectorGeometry",this._rectangle=void 0}get center(){return this._center}get rotation(){return Cesium.Math.toDegrees(this._rotation)}get radius(){return this._radius}get fov(){return this._fov}get positions(){return this._positions}get vertexFormat(){return this._vertexFormat}get extrudedHeight(){return this._extrudedHeight}get height(){return this._height}get slices(){return this._slices}static createGeometry(e){const t=[],i=Cesium.Transforms.eastNorthUpToFixedFrame(e._center),n=e._fov/e._slices,r=e.rotation;e._vertexNumber=2*e.slices;const o=[],s=[],a=[];for(let s=0,l=e._slices;s<l;s++){const l=e._radius*Math.cos(Cesium.Math.toRadians(r+n*s)),c=e._radius*Math.sin(Cesium.Math.toRadians(r+n*s)),u=new Cesium.Cartesian3(l,c,0),h=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(i,u,h),t.push(h.x,h.y,h.z),o.push(.5*Math.cos(Cesium.Math.toRadians(r+n*s))+.5),o.push(.5*Math.sin(Cesium.Math.toRadians(r+n*s))+.5),a.push(0,0,1)}a.push(0,0,1),o.push(.5,.5),t.push(e.center.x,e.center.y,e.center.z);const l=t.length/3-1;0!==e.height&&Cesium.PolygonPipeline.scaleToGeodeticHeight(t,e.height,Cesium.Ellipsoid.WGS84,!1);for(let t=0;t<e._slices-1;t++)s.push(t),s.push(l),s.push(t+1);const c={position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:new Float64Array(t)})};return e.vertexFormat.normal&&(c.normal=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:a})),e.vertexFormat.st&&(c.st=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:o})),new Cesium.Geometry({attributes:c,indices:Cesium.IndexDatatype.createTypedArray(e._vertexNumber,s),primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:Cesium.BoundingSphere.fromVertices(t)})}},e.Selection=Os,e.ShaderProgram=gh,e.ShapefileDataSource=kc,e.SnowEffect=class extends vy{constructor(e){super(e),this._fragmentShader=De(this._options.fragmentShader,nv),this._thickness=De(this._options.thickness,.5),this._density=De(this._options.density,10),this._speed=De(this._options.speed,350);const t={alpha:()=>this.thickness,snowDensity:()=>this.density,speed:()=>this.speed};this._uniforms=De(this._options.uniforms,t)}get thickness(){return Cesium.Math.clamp(this._thickness,0,1)}set thickness(e){this._thickness=e}get density(){return Cesium.Math.clamp(this._density,0,20)}set density(e){this._density=e}get speed(){const e=this._speed;return 10+Cesium.Math.clamp(390-e,0,390)}set speed(e){this._speed=e}createPostStage(){return new Cesium.PostProcessStage({fragmentShader:this._fragmentShader,uniforms:this._uniforms})}},e.SplitDirection=Ns,e.TDTLayer=class extends Sm{constructor(e){const t=(e=De(e,{})).key;t||(console.warn("未定义key，地图服务将不可用"),console.warn("请前往http://lbs.tianditu.gov.cn/server/MapService.html获取地图key"));const i=De(e.tilingScheme,new Cesium.WebMercatorTilingScheme);let n="w",r="w",o=e.tileMatrixLabels;i instanceof Cesium.GeographicTilingScheme&&(n="c",r="c",Re(o)||(o=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"]));const s=De(e.layer,"img"),a=`http://t{s}.tianditu.com/${s}_${n}/wmts?service=wmts&tileMatrixSet=${r}&request=GetTile&version=1.0.0&LAYER=${s}&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=${t}`;return new Cesium.WebMapTileServiceImageryProvider({url:a,layer:s,style:e.style||"default",format:e.format||"tiles",tileMatrixSetID:"GoogleMapsCompatible",credit:e.credit?new Cesium.Credit(e.credit||""):null,tilingScheme:e.tilingScheme,maximumLevel:e.maximumLevel||19,minimumLevel:e.minimumLevel||0,tileMatrixLabels:o,subdomains:"01234567"})}static layers=[{layer:"vec",desc:"矢量底图"},{layer:"cva",desc:"矢量注记"},{layer:"img",desc:"影像底图"},{layer:"cia",desc:"影像注记"},{layer:"ter",desc:"地形晕渲"},{layer:"cta",desc:"地形注记"},{layer:"ibo",desc:"全球境界"},{layer:"eva",desc:"矢量英文注记"},{layer:"eia",desc:"影像英文注记"}]},e.TMSLayer=Am,e.TaskProcessor=class{constructor(e,t={}){this._workers=[],this._workerPath="workers/"+e,this._options=t,Math.max(pi.hardwareConcurrency-1,1),this._worker=yi(this)}},e.TecentLayer=class extends wa{constructor(e={}){e.layer=De(e.layer,"img"),e.subdomains="123",e.url=Tm[e.layer],e.customTags={sx:function(e,t,i,n){return t>>4},sy:function(e,t,i,n){return(1<<n)-i>>4}},super(e)}},e.TileDebugLayer=class{constructor(e={}){e.tileWidth=De(e.tileWidth,256),e.tileHeight=De(e.tileHeight,256),this._tilingScheme=Re(e.tilingScheme)?e.tilingScheme:Ls.get("EPSG:4326",{ellipsoid:e.ellipsoid}),this._errorEvent=new Be,this._tileWidth=De(e.tileWidth,256),this._tileHeight=De(e.tileHeight,256),this._readyPromise=Promise.resolve(!0),this._font=De(e.font,"bold 24px sans-serif"),this._color=De(e.color,new Cesium.Color(1,1,1,1)),this._borderColor=De(e.borderColor,Cesium.Color.GOLD),this._borderWidth=De(e.borderWidth,2)}get ready(){return!0}get readyPromise(){return this._readyPromise}get hasAlphaChannel(){return!0}get errorEvent(){return this._errorEvent}get rectangle(){return this._tilingScheme.rectangle}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get tilingScheme(){return this._tilingScheme}get font(){return this._font}set font(e){this._font=e}get color(){return this._color}set color(e){this._color=e}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get borderWidth(){return this._borderWidth}createCanvas(){const e=document.createElement("canvas");e.width=this.tileWidth,e.height=this.tileHeight;const t=e.getContext("2d");return t.textBaseline="middle",t.textAlign="center",t.font=this.font,t.fillStyle=Em(this.color),t.strokeStyle=Em(this.color),t.lineWidth=this.borderWidth,{canvas:e,ctx:t}}requestImage(e,t,i,n){const{canvas:r,ctx:o}=this.createCanvas(),s=function(e,t,i,n){let r=[];return r[0]="L: "+n,r[1]="X: "+t,e.reverseY?r[2]="Y: "+e.tilingScheme.getNumberOfYTilesAtLevel(n)-i-1:r[2]="Y: "+i,r}(this,e,t,i);return o.fillText(s[0],r.width/2,r.height/4*1),o.fillText(s[1],r.width/2,r.height/4*2),o.fillText(s[2],r.width/2,r.height/4*3),o.strokeRect(0,0,r.width,r.height),Promise.resolve(r)}},e.TileLayer=class{constructor(e={}){this._errorEvent=new Be,this._tilingScheme=Ls.get("EPSG:4326"),this._ready=!1,this._ready=!0,this._minimumLevel=De(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._tileWidth=De(e.tileWidth,256),this._tileHeight=De(e.tileHeight,256),this._rectangle=De(e.rectangle,Pm.MAX_VALUE),this._readyPromise=Promise.resolve(!0),this._errorEvent.addEventListener(((e,t,i)=>{}))}get errorEvent(){return this._errorEvent}get minimumLevel(){return this._minimumLevel}get maximumLevel(){return this._maximumLevel}get errorEvent(){return this._errorEvent}get rectangle(){return this._rectangle}get ready(){return this._ready}get readyPromise(){return this._readyPromise}get tilingScheme(){return this._tilingScheme}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(e){this._tileProvider.enablePickFeatures=e}get tileHeight(){return this._tileHeight}get tileWidth(){return this._tileWidth}pickFeatures(e,t,i,n,r){}requestImage(e,t,i,n){return this.requestGeometry(e,t,i),Promise.reject(!1)}requestGeometry(e,t,i){}},e.Tileset=Vc,e.TransformHelper=class{constructor(e={}){this.lineWidth=Vs(e.lineWidth,15),this.xAxisColor=Vs(e.xAxisColor,js.RED),this.yAxisColor=Vs(e.yAxisColor,js.GREEN),this.zAxisColor=Vs(e.zAxisColor,js.BLUE),this.scaleAxisColor=Vs(e.scaleAxisColor,js.WHITE),this.activeAxisColor=Vs(e.activeAxisColor,js.YELLOW),this._translateEnabled=Vs(e.translateEnabled,!0),this._rotateEnabled=Vs(e.rotateEnabled,!1),this._scaleEnabled=Vs(e.scaleEnabled,!1),this.xAxisLength=e.xAxisLength,this.yAxisLength=e.yAxisLength,this.zAxisLength=e.zAxisLength,this.scaleAxisLength=e.scaleAxisLength,this.root=new Hs,this.object=null,this._modelMatrix=void 0,this._primitives=[],this._center=new qs,this._radius=0,this._originOffset=Vs(e.originOffset,new qs),this._selectedPrimitives=[],this._offset=new qs(0,0,0),this._angle=0,this.rotatePlaneRadius=e.rotatePlaneRadius,this._mode=va,this.preTranformEvent=new Be,this.postTransformEvent=new Be}get translateEnabled(){return this._translateEnabled}set translateEnabled(e){this._translateEnabled=e;for(let t of this._primitives){const i=t.axis;i&&(i.includes(xa)||i.includes(Ca)||(t.show=e))}}get rotateEnabled(){return this._rotateEnabled}set rotateEnabled(e){this._rotateEnabled=e;for(let t of this._primitives){const i=t.axis;i&&(i.includes(xa)&&(t.show=e))}}get scaleEnabled(){return this._scaleEnabled}set scaleEnabled(e){this._scaleEnabled=e;for(let t of this._primitives){const i=t.axis;i&&(i.includes(Ca)&&(t.show=e))}}get center(){return qs.add(this._center,this._originOffset,new qs)}get modelMatrix(){return this._modelMatrix}set modelMatrix(e){if(!e)return this._modelMatrix=void 0,void(this._inverseModelMatrix=void 0);this._modelMatrix=e,this._inverseModelMatrix=Ys.inverse(e,new Ys)}createMoveAxis(){if(!this.center)return;const e=1.3*this._radius,t=this.axisRoot,i=this.center;this.xAxis=t.add({positions:[i,new qs(Vs(this.xAxisLength,e)+i.x,i.y,i.z)],width:this.lineWidth,material:this.getAxisMaterial(this.xAxisColor)}),this.xAux=t.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.xAxis.axis="X",this.xAxis.color=this.xAxisColor,this.yAxis=t.add({positions:[i,new qs(i.x,-(Vs(this.yAxisLength,e)+i.y),i.z)],width:this.lineWidth,material:this.getAxisMaterial(this.yAxisColor)}),this.yAux=t.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.yAxis.axis="Y",this.yAxis.color=this.yAxisColor,this.zAxis=t.add({positions:[i,new qs(i.x,i.y,Vs(this.zAxisLength,e)+i.z)],width:this.lineWidth,material:this.getAxisMaterial(this.zAxisColor)}),this.zAux=t.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.zAxis.axis="Z",this.zAxis.color=this.zAxisColor,this._primitives.push(this.xAxis,this.yAxis,this.zAxis)}createAxisPlane(){this.XOYPlane=this.root.add(new wt({color:this.zAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new qs(0,0,1),axis:"XY"})),this.XOYPlane.relativeAxis=[this.xAxis,this.yAxis],this.XOZPlane=this.root.add(new wt({color:this.yAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new qs(0,1,0),axis:"XZ"})),this.XOZPlane.relativeAxis=[this.xAxis,this.zAxis],this.YOZPlane=this.root.add(new wt({color:this.xAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new qs(1,0,0),axis:"YZ"})),this.YOZPlane.relativeAxis=[this.yAxis,this.zAxis],this._primitives.push(this.XOYPlane,this.YOZPlane,this.XOZPlane)}createOrignPoint(){const e=new Zs({modelMatrix:this.modelMatrix});this.origin=e.add({show:!0,position:this.center,pixelSize:1.5*this.lineWidth,color:Cesium.Color.WHITE}),this.root.add(e),this._primitives.push(this.origin)}getAxisMaterial(e,t=!1,i=16){return new Us(t?{fabric:{type:"dasharrow",source:Fs,uniforms:{color:e,gapColor:js.TRANSPARENT,dashLength:i,dashPattern:255}}}:{fabric:{type:"PolylineArrow",uniforms:{color:e}}})}createRotateAxis(){const e=[],t=this.rotatePlaneRadius||this._radius,i=this.center;for(let n=0;n<=360;n++){const r=n/180*Math.PI;e.push(new qs(i.x+t*Math.cos(r),i.y+t*Math.sin(r),i.z))}this.zRotate=this.axisRoot.add({positions:[...e],width:this.lineWidth,material:this.getAxisMaterial(this.zAxisColor,!0,0)}),this.zRotate.axis="RZ",this.zRotate.color=this.zAxisColor,this.zRotate.normal=new qs(0,0,1),e.splice(0);for(let n=0;n<=360;n++){const r=n/180*Math.PI;e.push(new qs(i.x+t*Math.cos(r),i.y,i.z+t*Math.sin(r)))}this.yRotate=this.axisRoot.add({positions:[...e],width:this.lineWidth,material:this.getAxisMaterial(this.yAxisColor,!0,0)}),this.yRotate.axis="RY",this.yRotate.color=this.yAxisColor,this.yRotate.normal=new qs(0,1,0),e.splice(0);for(let n=0;n<=360;n++){const r=n/180*Math.PI;e.push(new qs(i.x,i.y+t*Math.cos(r),i.z+t*Math.sin(r)))}this.xRotate=this.axisRoot.add({positions:[...e],width:this.lineWidth,material:this.getAxisMaterial(this.xAxisColor,!0,0)}),this.xRotate.axis="RX",this.xRotate.color=this.xAxisColor,this.xRotate.normal=new qs(-1,0,0),this.rAxuStart=this.axisRoot.add({positions:[],width:this.lineWidth/2,material:this.getAxisMaterial(this.activeAxisColor,!0,0)}),this.rAxuEnd=this.axisRoot.add({positions:[],width:this.lineWidth/2,material:this.getAxisMaterial(this.activeAxisColor,!0,0)}),this._primitives.push(this.xRotate,this.yRotate,this.zRotate,this.rAxuStart,this.rAxuEnd)}createScaleAxis(){const e=1.1*this._radius,t=Vs(this.scaleAxisLength,e),i=Math.sqrt(3);this.scaleAxis=this.axisRoot.add({positions:[this._center,new qs((t+this._center.x)/i,-(t+this._center.y)/i,(t+this._center.z)/i)],width:this.lineWidth,material:this.getAxisMaterial(this.scaleAxisColor)}),this._primitives.push(this.scaleAxis),this.scaleAxis.axis="SXYZ",this.scaleAxis.color=this.scaleAxisColor}bind(e){this._viewer&&(this.unbind(),e instanceof Gs&&(e=e.delegate),this.object=e,e instanceof ra!=!1?(this.modelMatrix=e.modelMatrix,e.readyPromise.then((()=>{const t=qs.clone(e.boundingSphere.center);Ys.multiplyByPoint(this._inverseModelMatrix,t,this._center),this._radius=e.boundingSphere.radius,this.createPrimitive()}))):this.bindPosition(e))}bindPosition(e){if("function"==typeof e.getValue&&(e=e.getValue(this._viewer.clock.currentTime)),e instanceof qs==!1)throw new Le("position is invalid");this.modelMatrix=sa.eastNorthUpToFixedFrame(e),this._center=new qs,qs.clone(this.originOffset,this._center),this._radius=10,this.rotateEnabled=!1,this.scaleEnabled=!1,this.createPrimitive(!1)}createPrimitive(e=!0){const t=new Ws({modelMatrix:this.modelMatrix});this.axisRoot=t,this.root.add(t),this.createOrignPoint(),this.translateEnabled&&this.createMoveAxis(),this.translateEnabled&&this.createAxisPlane(),e&&this.rotateEnabled&&this.createRotateAxis(),e&&this.scaleEnabled&&this.createScaleAxis()}unbind(){this.object=void 0,this.root.removeAll(),this.origon=void 0,this.xAxis=void 0,this.yAxis=void 0,this.zAxis=void 0,this.modelMatrix=void 0}addTo(e){this._viewer=e,e.scene.primitives.add(this.root),this.addEventListener()}addEventListener(){const e=this._viewer,t=new Qs(e.canvas);t.setInputAction((i=>{const n=e.scene.pick(i.position);n&&this._primitives.includes(n.primitive)&&(this._mousedownPixel=i.position,this.active(n.primitive),this._offset=new qs,this._angle=0,t.setInputAction((e=>{const{startPosition:t,endPosition:i}=e;this.transform(t,i)}),Ks.MOUSE_MOVE),e.scene.screenSpaceCameraController.enableRotate=!1)}),Ks.LEFT_DOWN),t.setInputAction((i=>{this.active(null),t.removeInputAction(Ks.MOUSE_MOVE),e.scene.screenSpaceCameraController.enableRotate=!0,this.translateEnabled&&(this.xAux.positions=[],this.yAux.positions=[],this.zAux.positions=[]),this.rotateEnabled&&(this.rAxuStart.positions=[],this.rAxuEnd.positions=[])}),Ks.LEFT_UP),this._removeEventListener=function(){t.removeInputAction(Ks.LEFT_DOWN),t.removeInputAction(Ks.LEFT_UP)}}active(e){if(e||this.activePrimitive){if(!e&&this.activePrimitive){if(pa(this.activePrimitive,this.activePrimitive.color),this.activePrimitive.isAxisPlane)for(let e of this.activePrimitive.relativeAxis)pa(e,e.color);return this.activePrimitive=void 0,void(this._mode=va)}if(e.isAxisPlane)for(let t of e.relativeAxis)pa(t,this.activeAxisColor);if(this.activePrimitive=e,pa(this.activePrimitive,this.activeAxisColor),e.axis)if(e.axis.includes("R")){this._mode=xa;const e=ma(this._mousedownPixel,helper);this.rAxuStart.positions=[this.center,e],this._startLocalPosition=e}else e.axis.includes("S")?this._mode=Ca:this._mode=_a}}remove(){this._viewer.scene.primitives.remove(this.root),this._removeEventListener(),this._primitives.splice(0)}transform(e,t){if(this.preTranformEvent.raise(this.modelMatrix),this._mode===_a)ya(this,e,t,aa),this.translate(aa);else if(this._mode===xa){const i=function(e,t,i){const n=e.center;qs.subtract(t,n,t),qs.subtract(i,n,i);const r=qs.dot(qs.normalize(t,t),qs.normalize(i,i)),o=qs.subtract(t,i,ua),s=t,a=qs.cross(o,s,ua),l=e.activePrimitive.normal,c=ia.sign(qs.dot(a,l));return Math.acos(r)*c}(this,ma(e,this),ma(t,this));this.rotate(i)}else if(this._mode=Ca){ya(this,e,t,aa);const i=-aa.sxyz/qs.distance(...this.scaleAxis.positions)+1;this.scale(new qs(i,i,i))}this.postTransformEvent.raise(this.modelMatrix)}scale(e){const t=Ys.fromScale(e,ha);Ys.multiply(this._modelMatrix,t,this._modelMatrix),this.modelMatrix=this._modelMatrix;for(let e of this.root._primitives)Ys.multiply(e.modelMatrix,t,e.modelMatrix)}rotate(e){this._angle+=e;const t=this.activePrimitive.normal,i=Ys.fromTranslation(this.center,ha),n=Js.fromAxisAngle(t,e,la),r=Xs.fromQuaternion(n,ca),o=Ys.fromTranslation(qs.negate(this.center,ua),da);Ys.multiply(this.modelMatrix,i,this.modelMatrix),Ys.multiplyByMatrix3(this.modelMatrix,r,this.modelMatrix),Ys.multiply(this.modelMatrix,o,this.modelMatrix);for(let e of this.root._primitives)Ys.multiply(e.modelMatrix,i,e.modelMatrix),Ys.multiplyByMatrix3(e.modelMatrix,r,e.modelMatrix),Ys.multiply(e.modelMatrix,o,e.modelMatrix);this.modelMatrix=this._modelMatrix,this.createRotateAux(this._startLocalPosition,this._angle)}translate(e){if(!this.activePrimitive)return;const t=this.activePrimitive.axis;-1===t.indexOf("X")&&(e.x=0),-1===t.indexOf("Y")&&(e.y=0),-1===t.indexOf("Z")&&(e.z=0),e.x=-e.x,e.z=-e.z,qs.add(this._offset,e,this._offset);const i=Ys.fromTranslation(e);Ys.multiply(this._modelMatrix,i,this._modelMatrix),this.modelMatrix=this._modelMatrix;for(let e of this.root._primitives)Ys.multiply(e.modelMatrix,i,e.modelMatrix);this.createAux(this._offset,i)}createAux(e){if(e.x>0){const t=qs.clone(this.xAxis.positions[0]),i=qs.clone(this.xAxis.positions[0]);i.x+=-e.x,this.xAux.positions=[t,i]}else{const t=qs.clone(this.xAxis.positions[1]),i=qs.clone(this.xAxis.positions[1]);i.x+=-e.x,this.xAux.positions=[t,i]}if(e.y<0){const t=qs.clone(this.yAxis.positions[0]),i=qs.clone(this.yAxis.positions[0]);i.y+=-e.y,this.yAux.positions=[t,i]}else{const t=qs.clone(this.yAxis.positions[1]),i=qs.clone(this.yAxis.positions[1]);i.y+=-e.y,this.yAux.positions=[t,i]}if(e.z>0){const t=qs.clone(this.zAxis.positions[0]),i=qs.clone(this.zAxis.positions[0]);i.z+=-e.z,this.zAux.positions=[t,i]}else{const t=qs.clone(this.zAxis.positions[1]),i=qs.clone(this.zAxis.positions[1]);i.z+=-e.z,this.zAux.positions=[t,i]}}createRotateAux(e,t){if(!this._startLocalPosition)return;const i=Js.fromAxisAngle(this.activePrimitive.normal,-t),n=Xs.fromQuaternion(i,ca),r=Ys.fromRotation(n,ha);let o=qs.subtract(e,this.center,ua);Ys.multiplyByPoint(r,o,o),qs.add(this.center,o,o),this.rAxuEnd.positions=[this.center,o]}},e.Url=di,e.VERSION="1.1.1",e.VectorTileProvider=gu,e.Viewer=Md,e.WFSLayer=rd,e.WMSLayer=Mm,e.WMTSLayer=Sm,e.WaterFaceAppearance=class{constructor(e){return e=De(e,{}),this._normalMap=De(e.normalMap,mv.buildModuleUrl("./assets/images/waterNormal.jpg")),this._baseWaterColor=De(e.baseWaterColor,new Cesium.Color(0,.42,.71)),this._blendColor=De(e.blendColor,this._baseWaterColor),this._frequency=De(e.frequency,8e3),this._animationSpeed=De(e.animationSpeed,.02),this._amplitude=De(e.amplitude,5),this._specularIntensity=De(e.specularIntensity,.8),this._fadeFactor=De(e.fadeFactor,1),this._alpha=De(e.alpha,.4),this._material=new fv({fabric:{type:fv.WaterType,uniforms:{normalMap:this._normalMap,baseWaterColor:this._baseWaterColor,blendColor:this._blendColor,frequency:this._frequency,animationSpeed:this._animationSpeed,amplitude:this._amplitude,specularIntensity:this._specularIntensity,fadeFactor:this._fadeFactor}}}),new Cesium.MaterialAppearance({material:this._material,faceForward:!0,vertexShaderSource:this.vertexShaderSource,fragmentShaderSource:this.fragmentShaderSource})}get vertexShaderSource(){return rv}get fragmentShaderSource(){return ov.replace(/{alpha}/g,this._alpha)}},e.WindField=class{constructor(e,t){const i={};i.speedFactor=De(t.speedFactor,1),i.lineWidth=De(t.lineWidth,4),i.dropRateBump=De(t.dropRateBump,.01),i.dropRate=De(t.dropRate,.003),i.particlesTextureSize=Math.ceil(Math.sqrt(De(t.maxParticles,4096))),i.maxParticles=i.particlesTextureSize*i.particlesTextureSize,i.fadeOpacity=De(t.fadeOpacity,.996),i.particleHeight=De(t.particleHeight,100),i.color=De(t.color,Qv.WHITE),this._maxParticles=i.maxParticles,this._color=De(t.color,"#FFFFFF"),this.viewer=e,this.scene=this.viewer.scene,this.camera=this.viewer.camera,this.options=i,this.viewerParameters={lonRange:new Yv,latRange:new Yv,pixelSize:0},this.globeBoundingSphere=new Jv(Xv.ZERO,6314355.63),this.updateViewerParameters(),this.imageryLayers=this.viewer.imageryLayers,this.primitives=new Zv,this.viewer.scene.primitives.add(this.primitives)}get fadeOpacity(){return this.particleSystem.userInput.fadeOpacity}set fadeOpacity(e){this.particleSystem.userInput.fadeOpacity=e}get particleHeight(){return this.particleSystem.userInput.particleHeight}set particleHeight(e){this.particleSystem.userInput.particleHeight=e}get color(){return this.particleSystem.userInput.color}set color(e){this.particleSystem.userInput.color=e}get maxParticles(){return this._maxParticles}set maxParticles(e){this._maxParticles=e;const t=this.particleSystem.userInput.maxParticles!==e,i=Math.ceil(Math.sqrt(e));this.particleSystem.userInput.particlesTextureSize=i,this.particleSystem.userInput.maxParticles=i*i,this.particleSystem.refreshParticles(t)}get show(){return this.primitives.show}set show(e){this.primitives.show=e}get speedFactor(){return this.particleSystem.userInput.speedFactor}set speedFactor(e){this.particleSystem.userInput.speedFactor=e}get lineWidth(){return this.particleSystem.userInput.lineWidth}set lineWidth(e){this.particleSystem.userInput.lineWidth=e}loadDataFromNC(e){Uv.loadData(e).then((e=>{this.loadDataFromJson(e)}))}loadDataFromJson(e){this.particleSystem=new $v(this.scene.context,e,this.options,this.viewerParameters),this.addPrimitives(),this.setupEventListeners()}remove(){this.viewer.scene.primitives.remove(this.primitives)}addPrimitives(){const e=this.primitives;e.add(this.particleSystem.particlesComputing.primitives.calculateSpeed),e.add(this.particleSystem.particlesComputing.primitives.updatePosition),e.add(this.particleSystem.particlesComputing.primitives.postProcessingPosition),e.add(this.particleSystem.particlesRendering.primitives.segments),e.add(this.particleSystem.particlesRendering.primitives.trails),e.add(this.particleSystem.particlesRendering.primitives.screen)}updateViewerParameters(){const e=this.camera.computeViewRectangle(this.scene.globe.ellipsoid),t=jv.viewRectangleToLonLatRange(e);this.viewerParameters.lonRange.x=t.lon.min,this.viewerParameters.lonRange.y=t.lon.max,this.viewerParameters.latRange.x=t.lat.min,this.viewerParameters.latRange.y=t.lat.max;const i=this.camera.getPixelSize(this.globeBoundingSphere,this.scene.drawingBufferWidth,this.scene.drawingBufferHeight);i>0&&(this.viewerParameters.pixelSize=i)}setupEventListeners(){const e=this,t=this.camera.moveStart.addEventListener((function(){console.log("xxxxxxxxxxx"),e.primitives.show=!1})),i=this.camera.moveEnd.addEventListener((function(){e.updateViewerParameters(),e.particleSystem.applyViewerParameters(e.viewerParameters),e.primitives.show=!0}));let n=!1;function r(){n=!0,e.primitives.show=!1,e.primitives.removeAll()}window.addEventListener("resize",r);const o=this.scene.preRender.addEventListener((function(){n&&(e.particleSystem.canvasResize(e.scene.context),n=!1,e.addPrimitives(),e.scene.primitives.show=!0)}));this.removeEventListener=function(){t(),i(),o(),window.removeEventListener("resize",r)}}destroy(){this.remove(),this.removeEventListener&&this.removeEventListener(),je(this)}},e.XYZLayer=wa,e._shaderBloom="\n#define NUM_MIPS 5\nvarying vec2 v_textureCoordinates;\nuniform sampler2D blurTexture1;\nuniform sampler2D blurTexture2;\nuniform sampler2D blurTexture3;\nuniform sampler2D blurTexture4;\nuniform sampler2D blurTexture5;\nuniform sampler2D colorTexture;\nuniform float bloomStrength;\nuniform float bloomRadius;\nuniform float bloomFactors[NUM_MIPS];\nuniform vec3 bloomTintColors[NUM_MIPS];\nfloat lerpBloomFactor(const in float factor){\n  float mirrorFactor=1.2-factor;\n  return mix(factor,mirrorFactor,bloomRadius);\n}\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  gl_FragColor=bloomStrength*(\n    lerpBloomFactor(bloomFactors[0])*vec4(bloomTintColors[0],1.0)*texture2D(blurTexture1,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[1])*vec4(bloomTintColors[1],1.0)*texture2D(blurTexture2,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[2])*vec4(bloomTintColors[2],1.0)*texture2D(blurTexture3,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[3])*vec4(bloomTintColors[3],1.0)*texture2D(blurTexture4,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[4])*vec4(bloomTintColors[4],1.0)*texture2D(blurTexture5,v_textureCoordinates)\n  )+color;\n}",e._shaderBuildUniforms=s_,e._shaderCircleScan=zd,e._shaderCircleSpread=Hd,e._shaderDynamicConeMaterial=jd,e._shaderDynamicSpreadMaterial=Nf,e._shaderDynamicSpreadWallMaterial=Rf,e._shaderDynamicWaveMaterial=Gf,e._shaderEllipsoid=t_,e._shaderFlowImage=my,e._shaderFog="\nfloat getDistance(sampler2D depthTexture, vec2 texCoords)\n{\n  float depth = czm_unpackDepth(texture2D(depthTexture, texCoords));\n  if (depth == 0.0) {\n      return czm_infinity;\n  }\n      vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depth);\n  return -eyeCoordinate.z / eyeCoordinate.w;\n}\nfloat interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n  float startDistance = nearFarScalar.x;\n  float startValue = 1.0-nearFarScalar.y;\n  float endDistance = nearFarScalar.z;\n  float endValue = 1.0-nearFarScalar.w;\n  float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n  return mix(startValue, endValue, t);\n}\nvec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)\n{\n  return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);\n}\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform vec4 fogByDistance;\nuniform vec4 fogColor;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\n    float distance = getDistance(depthTexture, v_textureCoordinates);\n    vec4 sceneColor = texture2D(colorTexture, v_textureCoordinates);\n    float blendAmount = interpolateByDistance(fogByDistance, distance);\n    vec4 finalFogColor = vec4(fogColor.rgb, fogColor.a * blendAmount);\n    gl_FragColor = alphaBlend(finalFogColor, sceneColor);\n} ",e._shaderGetDepth=e_,e._shaderGetWgs84EllipsoidEC=i_,e._shaderGlobeFS=yu,e._shaderGroundSkyBoxFS=Bo,e._shaderGroundSkyBoxVS=Go,e._shaderPhong=r_,e._shaderPolylineAntialiasingMaterial=Fs,e._shaderPolylineFlowMaterial=Yf,e._shaderPolylineTrailLinkMaterial=tg,e._shaderRadarScan=Rp,e._shaderRain="\nuniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nuniform float speed;\nuniform float angle;\nfloat hash(float x){\n    return fract(sin(x*133.3)*13.13);\n}\n\nvoid main(void){\n\n    float time = czm_frameNumber / speed;\n    vec2 resolution = czm_viewport.zw;\n\n    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n    vec3 c=vec3(.6,.7,.8);\n    //方向\n    float a=angle;\n    float si=sin(a),co=cos(a);\n    uv*=mat2(co,-si,si,co);\n    uv*=length(uv+vec2(0,4.9))*.3+1.;\n\n    float v=1.-sin(hash(floor(uv.x*100.))*2.);\n    float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;\n    c*=v*b;\n\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5);\n}",e._shaderRectangularSensorComm=xy,e._shaderRectangularSensorFS=Cy,e._shaderRectangularSensorScanPlaneFS=_y,e._shaderRectangularSensorVS=wy,e._shaderSelected="\nuniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  if(czm_selected()){\n    gl_FragColor=color;\n  }else{\n    gl_FragColor=vec4(0.0);\n  }\n}\n",e._shaderSeperableBlur="\nuniform sampler2D colorTexture;\nuniform vec2 direction;\nuniform float scale;\nuniform float bloomRadius;\nfloat gaussianPdf(in float x, in float sigma) {\n  return 0.39894 * exp(-0.5 * x * x/(sigma * sigma))/sigma;\n}\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  float fSigma=float(SIGMA);\n  vec2 size=vec2(czm_viewport.z,czm_viewport.w)*scale*fSigma*2.0;\n  vec2 invSize=(1.0+bloomRadius)/size;\n  float weightSum=gaussianPdf(0.0,fSigma);\n  vec3 diffuseSum=texture2D(colorTexture,v_textureCoordinates).rgb*weightSum;\n  bool selected=false;\n  for(int i=0;i<KERNEL_RADIUS;i++){\n    float x=float(i);\n    float w=gaussianPdf(x,fSigma);\n    vec2 uvOffset=direction*invSize*x;\n    vec3 sample1=texture2D(colorTexture,v_textureCoordinates+uvOffset).rgb;\n    vec3 sample2=texture2D(colorTexture,v_textureCoordinates-uvOffset).rgb;\n    diffuseSum+=(sample1+sample2)*w;\n    weightSum+=2.0*w;\n  }\n  gl_FragColor=vec4(diffuseSum/weightSum,2.0);\n}\n",e._shaderSnow=nv,e._shaderSpecularReflection="\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nvec4 toEye(in vec2 uv, in float depth){\n    vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n    vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n    posInCamera =posInCamera / posInCamera.w;\n    return posInCamera;\n}\nfloat getDepth(in vec4 depth){\n    float z_window = czm_unpackDepth(depth);\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\nvec3 guussColor(vec2 uv){\n    vec2 pixelSize = 1.0 / czm_viewport.zw;\n    float dx0 = -pixelSize.x;\n    float dy0 = -pixelSize.y;\n    float dx1 = pixelSize.x;\n    float dy1 = pixelSize.y;\n    vec4 gc = (\n        texture2D(colorTexture, uv)+\n        texture2D(colorTexture, uv + vec2(dx0, dy0)) +\n        texture2D(colorTexture, uv + vec2(0.0, dy0)) +\n        texture2D(colorTexture, uv + vec2(dx1, dy0)) +\n        texture2D(colorTexture, uv + vec2(dx0, 0.0)) +\n        texture2D(colorTexture, uv + vec2(dx1, 0.0)) +\n        texture2D(colorTexture, uv + vec2(dx0, dy1)) +\n        texture2D(colorTexture, uv + vec2(0.0, dy1)) +\n        texture2D(colorTexture, uv + vec2(dx1, dy1))\n    ) * (1.0 / 9.0);\n    return gc.rgb;\n}\nvoid main(){\n    float offset = 0.0;\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    vec4 currD = texture2D(depthTexture, v_textureCoordinates);\n    if(currD.r>=1.0){\n        gl_FragColor = color;\n        return;\n    }\n    float depth = getDepth(currD);\n\n    vec4 positionEC = toEye(v_textureCoordinates, depth);\n    vec3 dx = dFdx(positionEC.xyz);\n    vec3 dy = dFdy(positionEC.xyz);\n    vec3 normal = normalize(cross(dx,dy));\n    vec4 positionWC = normalize(czm_inverseView * positionEC);\n    vec3 normalWC = normalize(czm_inverseViewRotation * normal);\n    float fotNumWC = dot(positionWC.xyz,normalWC);\n    if(fotNumWC<=0.5){\n        gl_FragColor = color;\n        return;\n    }\n\n    vec3 viewDir = normalize(positionEC.xyz);\n    vec3 reflectDir = reflect(viewDir, normal);\n    // vec3 viewReflectDir = czm_viewRotation * reflectDir;\n    vec3 viewReflectDir = reflectDir;\n\n\n    float step = 0.05;\n    int stepNum = int(20.0 / step);\n    vec3 pos;\n    vec3 albedo;\n    bool jd = false;\n    for(int i = 1;i <= 400;i++)\n    {\n        float delta = step * float(i) + offset;\n        pos = positionEC.xyz + viewReflectDir * delta;\n        float d = -pos.z;\n\n        vec4 tmp = czm_projection * vec4(pos,1.0);\n        vec3 screenPos = tmp.xyz / tmp.w;\n        vec2 uv = vec2(screenPos.x, screenPos.y) * 0.5 + vec2(0.5, 0.5);\n\n        if(uv.x > 0.0 && uv.x < 1.0 && uv.y > 0.0 && uv.y < 1.0){\n            float dd = getDepth(texture2D(depthTexture, uv));\n            vec4 jzc = toEye(uv, dd);\n            dd = -jzc.z;\n            if(d>dd){\n                if(abs(abs(d) - abs(dd)) <=step){\n                    jd = true;\n                    // albedo = texture2D(colorTexture, uv).rgb;\n                    albedo = guussColor(uv);\n                }\n                break;\n            }\n        }\n    }\n    if(jd){\n        gl_FragColor = vec4(mix(color.xyz,albedo,0.5),1.0);\n    }else{\n        gl_FragColor = color;\n    }\n}",e._shaderToEye=Kv,e._shaderTranslucentPhong=n_,e._shaderWaterAppearanceFS=ov,e._shaderWaterAppearanceVS=rv,e.abstract=ot,e.checkViewer=Fe,e.clone=ii,e.computeDistancePerPixel=Mi,e.computeSceneCenterPoint=Li,e.computeSceneExtent=Di,e.createDefaultLayer=ba,e.createGuid=Ii,e.customPrimitive=yv,e.dataProcess=Uv,e.dateFormat=Ao,e.defaultValue=De,e.defined=Re,e.destroyObject=je,e.getParabolaPoints=function(e,t,i=5e3,n=50){const r=i>5e3?i:5e3,o=Math.abs(e.lon-t.lon)>Math.abs(e.lat-t.lat),s=o?Math.abs(e.lon-t.lon):Math.abs(e.lat-t.lat),a=n>50?n:50,l=[];let c=s/a;if(o){const i=(t.lat-e.lat)/a;e.lon-t.lon>0&&(c=-c);for(let t=0;t<a;t++){const n=r-4*Math.pow(-.5*s+Math.abs(c)*t,2)*r/Math.pow(s,2),o=e.lon+c*t,a=e.lat+i*t;l.push([o,a,n])}}else{const i=(t.lon-e.lon)/a;e.lat-t.lat>0&&(c=-c);for(let t=0;t<a;t++){const n=r-4*Math.pow(-.5*s+Math.abs(c)*t,2)*r/Math.pow(s,2),o=e.lon+i*t,a=e.lat+c*t;l.push([o,a,n])}}return l},e.guid=Ge,e.index=id,e.particleSystem=$v,e.particlesComputing=Vv,e.particlesRendering=qv,e.pickPosition=Ss,e.proj=Ls,e.randomPosition=function(e,t=1){const i=e.west,n=e.east,r=e.south,o=e.north;t<1&&(t=1);const s=[];for(let e=0;e<t;e++){const e=i+Math.random()*(n-i),t=r+Math.random()*(o-r);s.push(Cesium.Cartesian3.fromRadians(e,t))}return s},e.rotateEnabled=Is,e.util=jv}));
