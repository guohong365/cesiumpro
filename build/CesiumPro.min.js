!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CesiumPro={})}(this,(function(e){"use strict";let t=class extends Error{constructor(e){super(e),this.name="CesiumProError"}};function i(){throw new t("抽象方法无法被调用。")}t.throwInstantiationError=function(){throw new DeveloperError("This function defines an interface and should not be called directly.")},t.throwNoInstance=function(){throw new t("它的定义了一个接口，不能被以直接调用.")};const{Cartesian3:n,Primitive:r,Material:o,Geometry:s,MaterialAppearance:a,GeometryAttribute:l,ComponentDatatype:c,PrimitiveType:u,BoundingSphere:h,VertexFormat:d,defaultValue:p,GeometryAttributes:m,Check:f}=Cesium,g=new d,_=new n;class y{constructor(e={}){this._normal=e.normal,this._radius=e.radius,this._center=e.center;const t=p(e.vertexFormat,d.DEFAULT);this._vertexFormat=t}static packedLength=d.packedLength+n.packedLength+1;static pack(e,t,i){return i=p(i,0),d.pack(e._vertexFormat,t,i),i+=d.packedLength,n.pack(e._normal,t,i),i+=n.packedLength,t[i++]=e._radius,t}static unpack(e,t,i){t=p(t,0);const r=d.unpack(e,t,g);t+=d.packedLength;const o=n.unpack(e,t,_),s=e[t+=n.packedLength];return defined(i)?(i._vertexFormat=d.clone(r,i._vertexFormat),i._normal=n.clone(o,i._normal),i._radius=s,i):new PlaneGeometry({vertexFormat:r,normal:o,radius:s})}static createGeometry(e){const t=Math.max(1,.02*e._radius),i=Math.max(.2*e._radius,2*t);let r=[],o=[];const{x:a,y:d,z:p}=e._center;let f;n.equals(e._normal,n.UNIT_X)?(r=[a,-t+d,t+p,a,-i+d,t+p,a,-i+d,i+p,a,-t+d,i+p],f=new n(a,-(t+i)/2+d,(t+i)/2+p),o=[1,0,0,1,0,0,1,0,0,1,0,0]):n.equals(e._normal,n.UNIT_Y)?(r=[t+a,d,t+p,i+a,d,t+p,i+a,d,i+p,t+a,d,i+p],f=new n((t+i)/2+a,d,(t+i)/2+p),o=[0,1,0,0,1,0,0,1,0,0,1,0]):n.equals(e._normal,n.UNIT_Z)&&(r=[t+a,-t+d,p,i+a,-t+d,p,i+a,-i+d,p,t+a,-i+d,p],f=new n((t+i)/2+a,-(t+i)/2+d,p),o=[0,0,1,0,0,1,0,0,1,0,0,1]),r=new Float32Array([...r]);const g=new Float32Array([0,0,1,0,1,1,0,1]),_=new Uint16Array([0,1,2,2,3,0]);return new s({attributes:new m({position:new l({componentDatatype:c.DOUBLE,componentsPerAttribute:3,values:r}),normal:new l({componentDatatype:c.FLOAT,componentsPerAttribute:3,values:o}),st:new l({componentDatatype:c.FLOAT,componentsPerAttribute:2,values:g})}),indices:_,primitiveType:u.TRIANGLES,boundingSphere:new h(f,(t+i)/2)})}}class v{constructor(e={}){this._center=e.center,this._modelMatrix=e.modelMatrix,this._color=e.color;const t=e.radius;this._normal=e.normal;const i=new y({normal:this._normal,radius:t,vertexFormat:d.DEFAULT,center:this._center}),n=new Cesium.GeometryInstance({geometry:y.createGeometry(i)}),s=new r({asynchronous:!1,geometryInstances:n,modelMatrix:this._modelMatrix,appearance:new a({material:o.fromType("Color",{color:this._color})})});return s.isAxisPlane=!0,s.normal=this._normal,s.axis=e.axis,s.color=this._color,s}}function C(e,t){return null!=e?e:t}function x(e){return null!=e}class w{constructor(e,i,n){if(!x(e))throw new t("longitude is required.");if(!x(i))throw new t("latitude is required.");this.lon=e,this.lat=i,this.alt=C(n,0)}get height(){return this.alt}toPixel(e){return w.toPixel(this,e)}toCartesian(){return w.toCartesian(this)}toCartographic(){return w.toCartographic(this)}getRadias(){return{lon:Cesium.Math.toRadians(this.lon),lat:Cesium.Math.toRadians(this.lat),alt:alt}}isVisible(e){return w.isVisible(this,e)}toString(){return`{lon: ${this.lon}, lat: ${this.lat}, alt: ${this.alt}}`}toJson(){return{lon:this.lon,lat:this.lat,alt:this.alt}}toArray(){return[this.lon,this.lat,this.alt]}static isVisible(e,i){if(i instanceof Cesium.Viewer==!1)throw new t("viewer不是一个有效的Cesium.Viewer对象");if(!x(e))return!1;const n=w.toCartesian(e);if(!n)return!1;if(i.scene.mode===Cesium.SceneMode.SCENE3D){if(!new Cesium.EllipsoidalOccluder(Cesium.Ellipsoid.WGS84,i.camera.position).isPointVisible(n))return!1;const t=w.toPixel(e,i.scene);if(!x(t))return!1;const r=i.canvas.width||i.canvas.clientWidth,o=i.canvas.height||i.canvas.clientHeight;return t.x>0&&t.x<r&&t.y>0&&t.y<o}if(i.scene.mode===Cesium.SceneMode.SCENE2D){const e=i.scene.camera.frustum,{positionWC:t,directionWC:r,upWC:o}=i.scene.camera,s=e.computeCullingVolume(t,r,o),a=Cesium.BoundingSphere.projectTo2D(new BoundingSphere(n,1)),l=s.computeVisibility(a);return l===Cesium.Intersect.INSIDE||l===Cesium.Intersect.INERSECTING}}static toPixel(e,i){if(!x(i))throw new t("scene未定义。");if(!x(e))return;const n=w.toCartesian(e);return x(n)?Cesium.SceneTransforms.wgs84ToWindowCoordinates(i,n):void 0}static toCartographic(e,i){if(!x(e))throw new t("point is not defined.");if(e instanceof w)return Cesium.Cartographic.fromDegrees(e.lon,e.lat,e.alt);if(e instanceof Cesium.Cartesian3)return Cesium.Cartographic.fromCartesian(e);if(e instanceof Cesium.Cartographic)return e;if(e instanceof Cesium.Cartesian2){const t=w.toCartesian(e,i);return w.toCartographic(t)}}static toCartesian(e,t){if(x(e)){if(e instanceof Cesium.Cartesian3)return e;if(e instanceof Cesium.Cartographic)return Cesium.Cartographic.toCartesian(e);if(e instanceof w)return Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.alt);if(e instanceof Cesium.Cartesian2){if(!t)return;const i=t.scene.camera.getPickRay(e);return t.scene.globe.pick(i,t.scene)}}}static fromCartesian(e){if(!x(e))return;const t=Cesium.Cartographic.fromCartesian(e);return x(t)?w.fromCartographic(t):void 0}static fromCartographic(e){if(!x(e))throw new t("cartographic is not defined.");return new w(Cesium.Math.toDegrees(e.longitude),Cesium.Math.toDegrees(e.latitude),e.height)}static fromPixel(e,i){if(!i.scene.globe)return;if(!x(e))throw new t("pixel is not defined.");if(i instanceof Cesium.Viewer==!1)throw new t("viewer不是一个有效的Cesium.Viewer对象");const n=i.scene.camera.getPickRay(e),r=i.scene.globe.pick(n,i.scene);return x(r)?w.fromCartesian(r):void 0}static fromDegrees(e,t,i){return new w(e,t,i)}static fromRadians(e,t,i){return new w(Cesium.Math.toDegrees(e),Cesium.Math.toDegrees(t),i)}static inChina(...e){if(1!==e.length){const t=+e[0],i=+e[1];return t>73.66&&t<135.05&&i>3.86&&i<53.55}{const t=e[0];if(e[0]instanceof w)return w.inChina(t.lon,t.lat)}}static fromArray(e){return new w(...e)}static fromJson(e){return new w(e.lon,e.lat,e.alt)}static isValid(e){return e instanceof w?!!x(e.lon)&&(!!x(e.lat)&&!!x(e.alt)):e instanceof Cesium.Cartesian3&&(!!x(e.x)&&(!!x(e.y)&&!!x(e.z)))}}function b(e,t,i){var n=i;return function(e,t){var i,n,r,o,s,a,l,c,u,h,d=0,p="FeatureCollection"===e.type,m="Feature"===e.type,f=p?e.features.length:1;for(i=0;i<f;i++){for(a=p?e.features[i].geometry:m?e.geometry:e,c=p?e.features[i].properties:m?e.properties:{},u=p?e.features[i].bbox:m?e.bbox:void 0,h=p?e.features[i].id:m?e.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,d,c,u,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===t(o.geometries[n],d,c,u,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,d,c,u,h))return!1;d++}}(e,(function(e,r,o,s,a){n=0===r&&void 0===i?e:t(n,e,r,o,s,a)})),n}var S=6378137;function T(e){return b(e,(function(e,t){return e+function(e){var t,i=0;switch(e.type){case"Polygon":return A(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)i+=A(e.coordinates[t]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)}),0)}function A(e){var t=0;if(e&&e.length>0){t+=Math.abs(E(e[0]));for(var i=1;i<e.length;i++)t-=Math.abs(E(e[i]))}return t}function E(e){var t,i,n,r,o,s,a=0,l=e.length;if(l>2){for(s=0;s<l;s++)s===l-2?(n=l-2,r=l-1,o=0):s===l-1?(n=l-1,r=0,o=1):(n=s,r=s+1,o=s+2),t=e[n],i=e[r],a+=(P(e[o][0])-P(t[0]))*Math.sin(P(i[1]));a=a*S*S/2}return a}function P(e){return e*Math.PI/180}const L={surfaceDistance:function(e){let t=0;for(let i=0;i<e.length-1;i+=1){const n=Cesium.Cartographic.fromCartesian(e[i]),r=Cesium.Cartographic.fromCartesian(e[i+1]),o=new Cesium.EllipsoidGeodesic;o.setEndPoints(n,r);t+=o.surfaceDistance}return t},spaceDistance:function(e){let t=0;for(let i=1;i<e.length;i++){const n=e[i-1],r=e[i];t+=Cesium.Cartesian3.distance(n,r)}return t},angle:function(e,t,i){const n=Cesium.Transforms.eastNorthUpToFixedFrame(e),r=Cesium.Matrix4.inverseTransformation(n,new Cesium.Matrix4),o=Cesium.Matrix4.multiplyByPoint(r,t,new Cesium.Cartesian3),s=Cesium.Matrix4.multiplyByPoint(r,i,new Cesium.Cartesian3),a=Cesium.Cartesian3.normalize(o,new Cesium.Cartesian3),l=Cesium.Cartesian3.normalize(s,new Cesium.Cartesian3),c=Cesium.Cartesian3.dot(a,l),u=Cesium.Math.acosClamped(c);return Cesium.Math.toDegrees(u)},angleBetweenNorth:function(e,t){const i=Cesium.Transforms.eastNorthUpToFixedFrame(e),n=Cesium.Matrix4.inverseTransformation(i,new Cesium.Matrix4),r=Cesium.Matrix4.multiplyByPoint(n,t,new Cesium.Cartesian3),o=Cesium.Cartesian3.normalize(r,new Cesium.Cartesian3),s=new Cesium.Cartesian3(0,1,0),a=Cesium.Cartesian3.dot(o,s);let l=Cesium.Math.acosClamped(a);l=Cesium.Math.toDegrees(l);const c=new Cesium.Cartesian3(1,0,0);return Cesium.Cartesian3.dot(c,o)<0&&(l=360-l),l},surfaceArea:function(e){let t=0;for(let i=0;i<e.length-2;i+=1){const n=(i+1)%e.length,r=(i+2)%e.length,o=L.angle(e[i],e[n],e[r]);t+=L.spaceDistance([e[i],e[n]])*L.spaceDistance([e[n],e[r]])*Math.abs(Math.sin(Cesium.Math.toRadians(o)))}return t}};L.spaceArea=function(e){const t=[];for(let i of e){const e=w.fromCartesian(i);t.push([e.lon,e.lat])}t.push(t[0]);return T(function(e,t,i){void 0===i&&(i={});for(var n=0,r=e;n<r.length;n++){var o=r[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return function(e,t,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=t||{},n.geometry=e,n}({type:"Polygon",coordinates:e},t,i)}([t]))},L.heightFromCartesianArray=function(e){if(e.length<2)return 0;const t=[];for(let i=1;i<e.length;i++){const n=Cesium.Cartographic.fromCartesian(e[i-1]),r=Cesium.Cartographic.fromCartesian(e[i]);n&&r?t.push(r.height-n.height):t.push("NaN")}return t};const D={SURFACE_DISTANCE:1,SPACE_DISTANCE:2,SPACE_AREA:3,SURFACE_AREA:4,HEIGHT:5,ANGLE:6,validate:function(e){return e===D.SURFACE_AREA||e===D.SURFACE_DISTANCE||e===D.SPACE_AREA||e===D.SPACE_DISTANCE||e===D.HEIGHT||e===D.ANGLE},getKey:function(e){let t;switch(e){case 1:t="SURFACE_DISTANCE";break;case 2:t="SPACE_DISTANCE";break;case 3:t="SPACE_AREA";break;case 4:t="SURFACE_AREA";break;case 5:t="HEIGHT";break;case 6:t="ANGLE";break;default:t=void 0}return t}};var M=Object.freeze(D);function R(e,t){return t-e}let I=class{constructor(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}get numberOfListeners(){return this._listeners.length-this._toRemove.length}addEventListener(e,i){if("function"!=typeof e)throw new t("侦听器应该是一个函数");this._listeners.push(e),this._scopes.push(i);const n=this;return function(){n.removeEventListener(e,i)}}removeEventListener(e,i){if("function"!=typeof e)throw new t("侦听器应该是一个函数");const n=this._listeners,r=this._scopes;let o=-1;for(let t=0;t<n.length;t++)if(n[t]===e&&r[t]===i){o=t;break}return-1!==o&&(this._insideRaiseEvent?(this._toRemove.push(o),n[o]=void 0,r[o]=void 0):(n.splice(o,1),r.splice(o,1)),!0)}raise(){let e;this._insideRaiseEvent=!0;const t=this._listeners,i=this._scopes;let{length:n}=t;for(e=0;e<n;e++){const n=t[e];Cesium.defined(n)&&t[e].apply(i[e],arguments)}const r=this._toRemove;if(n=r.length,n>0){for(r.sort(R),e=0;e<n;e++){const n=r[e];t.splice(n,1),i.splice(n,1)}r.length=0}this._insideRaiseEvent=!1}raiseEvent(){this.raise(...arguments)}};const{RequestState:N,AttributeCompression:O,BoundingSphere:F,Cartesian3:k,Credit:z,defaultValue:B,defined:G,DeveloperError:H,GeographicTilingScheme:W,WebMercatorTilingScheme:U,getJsonFromTypedArray:j,HeightmapTerrainData:V,IndexDatatype:q,OrientedBoundingBox:$,QuantizedMeshTerrainData:Y,Request:X,RequestType:J,Resource:Z,RuntimeError:Q,TerrainProvider:K,TileAvailability:ee,TileProviderError:te}=Cesium;function ie(e){this.resource=e.resource,this.version=e.version,this.isHeightmap=e.isHeightmap,this.tileUrlTemplates=e.tileUrlTemplates,this.availability=e.availability,this.hasVertexNormals=e.hasVertexNormals,this.hasWaterMask=e.hasWaterMask,this.hasMetadata=e.hasMetadata,this.availabilityLevels=e.availabilityLevels,this.availabilityTilesLoaded=e.availabilityTilesLoaded,this.littleEndianExtensionSize=e.littleEndianExtensionSize,this.availabilityPromiseCache={}}function ne(e){this._heightmapWidth=65,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._ellipsoid=e.ellipsoid,this._requestVertexNormals=B(e.requestVertexNormals,!1),this._requestWaterMask=B(e.requestWaterMask,!1),this._requestMetadata=B(e.requestMetadata,!0),this._errorEvent=new I;let t=e.credit;"string"==typeof t&&(t=new z(t)),this._credit=t,this._availability=void 0,this._ready=!1,this._tileCredits=void 0;const i=this;let n,r,o;const s=this._layers=[];let a="";const l=[];let c=0;function u(e){let t;if(!e.format)return t="The tile format is not specified in the layer.json file.",o=te.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Q(t));if(!e.tiles||0===e.tiles.length)return t="The layer.json file does not specify any tile URL templates.",o=te.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Q(t));let d=!1,p=!1,f=!1,g=!0,_=!1;if("heightmap-1.0"===e.format)_=!0,G(i._heightmapStructure)||(i._heightmapStructure={heightScale:.2,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:65535}),p=!0,i._requestWaterMask=!0;else if(0!==e.format.indexOf("quantized-mesh-1."))return t=`The tile format "${e.format}" is invalid or not supported.`,o=te.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Q(t));const y=e.tiles,v=e.maxzoom;if(c=Math.max(c,v),e.projection&&"EPSG:4326"!==e.projection){if("EPSG:3857"!==e.projection)return t=`The projection "${e.projection}" is invalid or not supported.`,o=te.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Q(t));i._tilingScheme=new U({numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:i._ellipsoid})}else i._tilingScheme=new W({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:i._ellipsoid});if(i._levelZeroMaximumGeometricError=K.getEstimatedLevelZeroGeometricErrorForAHeightmap(i._tilingScheme.ellipsoid,i._heightmapWidth,i._tilingScheme.getNumberOfXTilesAtLevel(0)),e.scheme&&"tms"!==e.scheme&&"slippyMap"!==e.scheme)return t=`The scheme "${e.scheme}" is invalid or not supported.`,o=te.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Q(t));let C;i._scheme=e.scheme,G(e.extensions)&&-1!==e.extensions.indexOf("octvertexnormals")?d=!0:G(e.extensions)&&-1!==e.extensions.indexOf("vertexnormals")&&(d=!0,g=!1),G(e.extensions)&&-1!==e.extensions.indexOf("watermask")&&(p=!0),G(e.extensions)&&-1!==e.extensions.indexOf("metadata")&&(f=!0);const x=e.metadataAvailability,w=e.available;let b;if(G(w)&&!G(x)){b=new ee(i._tilingScheme,w.length);for(let e=0;e<w.length;++e){const t=w[e],n=i._tilingScheme.getNumberOfYTilesAtLevel(e);G(l[e])||(l[e]=[]);for(let i=0;i<t.length;++i){const r=t[i],o=n-r.endY-1,s=n-r.startY-1;l[e].push([r.startX,o,r.endX,s]),b.addAvailableTileRange(e,r.startX,o,r.endX,s)}}}else G(x)&&(C=new ee(i._tilingScheme,v),b=new ee(i._tilingScheme,v),l[0]=[[0,0,1,0]],b.addAvailableTileRange(0,0,0,1,0));i._hasWaterMask=i._hasWaterMask||p,i._hasVertexNormals=i._hasVertexNormals||d,i._hasMetadata=i._hasMetadata||f,G(e.attribution)&&(a.length>0&&(a+=" "),a+=e.attribution),s.push(new ie({resource:n,version:e.version,isHeightmap:_,tileUrlTemplates:y,availability:b,hasVertexNormals:d,hasWaterMask:p,hasMetadata:f,availabilityLevels:x,availabilityTilesLoaded:C,littleEndianExtensionSize:g}));const S=e.parentUrl;if(G(S)){if(!G(b))return console.log("A layer.json can't have a parentUrl if it does't have an available array."),Promise.resolve(!0);n=n.getDerivedResource({url:S}),n.appendForwardSlash(),r=n.getDerivedResource({url:"layer.json"});const e=r.fetchJson();return Promise.resolve(e).then(u).catch(h)}return Promise.resolve(!0)}function h(e){const t=`An error occurred while accessing ${r.url}.`;return o=te.reportError(o,i,i._errorEvent,t),o.retry?m():Promise.reject(new Q(t))}function d(e){return u(e).then((function(){if(G(o))return;const e=l.length;if(e>0){const t=i._availability=new ee(i._tilingScheme,c);for(let i=0;i<e;++i){const e=l[i];for(let n=0;n<e.length;++n){const r=e[n];t.addAvailableTileRange(i,r[0],r[1],r[2],r[3])}}}if(a.length>0){const e=new z(a);G(i._tileCredits)?i._tileCredits.push(e):i._tileCredits=[e]}return i._ready=!0,Promise.resolve(!0)}))}function p(e){return G(e)&&404===e.statusCode?d({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]}):h()}function m(){return Promise.resolve(r.fetchJson()).then(d).catch(p)}this._readyPromise=Promise.resolve(e.url).then((function(e){const t=Z.createIfNeeded(e);return t.appendForwardSlash(),n=t,r=n.getDerivedResource({url:"layer.json"}),i._tileCredits=t.credits,m()}))}const re=1,oe=2,se=4;function ae(e){if(!G(e)||0===e.length)return{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"};return{Accept:`application/vnd.quantized-mesh;extensions=${e.join("-")},application/octet-stream;q=0.9,*/*;q=0.01`}}function le(e,t,i,n,r,o){if(!G(r))return Promise.reject(new Q("Terrain tile doesn't exist"));const s=r.tileUrlTemplates;if(0===s.length)return;let a;if(e._scheme&&"tms"!==e._scheme)a=i;else{a=e._tilingScheme.getNumberOfYTilesAtLevel(n)-i-1}const l=[];let c,u;e._requestVertexNormals&&r.hasVertexNormals&&l.push(r.littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),e._requestWaterMask&&r.hasWaterMask&&l.push("watermask"),e._requestMetadata&&r.hasMetadata&&l.push("metadata");const h=s[(t+a+n)%s.length],d=r.resource;G(d._ionEndpoint)&&!G(d._ionEndpoint.externalType)?(0!==l.length&&(u={extensions:l.join("-")}),c=ae(void 0)):c=ae(l);const p=d.getDerivedResource({url:h,templateValues:{version:r.version,z:n,x:t,y:a},queryParameters:u,headers:c,request:o}).fetchArrayBuffer();return d.request.state!==N.ISSUED&&d.request.state!==N.ACTIVE&&G(p)?p.then((function(o){return G(o)?G(e._heightmapStructure)?function(e,t,i,n,r){const o=new Uint16Array(t,0,e._heightmapWidth*e._heightmapWidth);return new V({buffer:o,childTileMask:new Uint8Array(t,o.byteLength,1)[0],waterMask:new Uint8Array(t,o.byteLength+1,t.byteLength-o.byteLength-1),width:e._heightmapWidth,height:e._heightmapWidth,structure:e._heightmapStructure,credits:e._tileCredits})}(e,o):function(e,t,i,n,r,o){const s=o.littleEndianExtensionSize;let a=0;const l=3*Float64Array.BYTES_PER_ELEMENT,c=4*Float64Array.BYTES_PER_ELEMENT,u=3*Uint16Array.BYTES_PER_ELEMENT;let h=Uint16Array.BYTES_PER_ELEMENT,d=3*h;const p=new DataView(t),m=new k(p.getFloat64(a,!0),p.getFloat64(a+8,!0),p.getFloat64(a+16,!0));a+=l;const f=p.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;const g=p.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;const _=new F(new k(p.getFloat64(a,!0),p.getFloat64(a+8,!0),p.getFloat64(a+16,!0)),p.getFloat64(a+l,!0));a+=c;const y=new k(p.getFloat64(a,!0),p.getFloat64(a+8,!0),p.getFloat64(a+16,!0));a+=l;const v=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const C=new Uint16Array(t,a,3*v);a+=v*u,v>65536&&(h=Uint32Array.BYTES_PER_ELEMENT,d=3*h);const x=C.subarray(0,v),w=C.subarray(v,2*v),b=C.subarray(2*v,3*v);O.zigZagDeltaDecode(x,w,b),a%h!=0&&(a+=h-a%h);const S=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const T=q.createTypedArrayFromArrayBuffer(v,t,a,3*S);a+=S*d;let A=0;const E=T.length;for(let e=0;e<E;++e){const t=T[e];T[e]=A-t,0===t&&++A}const P=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const L=q.createTypedArrayFromArrayBuffer(v,t,a,P);a+=P*h;const D=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const M=q.createTypedArrayFromArrayBuffer(v,t,a,D);a+=D*h;const R=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const I=q.createTypedArrayFromArrayBuffer(v,t,a,R);a+=R*h;const N=p.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const z=q.createTypedArrayFromArrayBuffer(v,t,a,N);let B,H;for(a+=N*h;a<p.byteLength;){const l=p.getUint8(a,!0);a+=Uint8Array.BYTES_PER_ELEMENT;const c=p.getUint32(a,s);if(a+=Uint32Array.BYTES_PER_ELEMENT,l===re&&e._requestVertexNormals)B=new Uint8Array(t,a,2*v);else if(l===oe&&e._requestWaterMask)H=new Uint8Array(t,a,c);else if(l===se&&e._requestMetadata){const s=p.getUint32(a,!0);if(s>0){const n=j(new Uint8Array(t),a+Uint32Array.BYTES_PER_ELEMENT,s).available;if(G(n))for(let t=0;t<n.length;++t){const r=i+t+1,s=n[t],a=e._tilingScheme.getNumberOfYTilesAtLevel(r);for(let t=0;t<s.length;++t){const i=s[t],n=a-i.endY-1,l=a-i.startY-1;e.availability.addAvailableTileRange(r,i.startX,n,i.endX,l),o.availability.addAvailableTileRange(r,i.startX,n,i.endX,l)}}}o.availabilityTilesLoaded.addAvailableTileRange(i,n,r,n,r)}a+=c}const W=5*e.getLevelMaximumGeometricError(i),U=e._tilingScheme.tileXYToRectangle(n,r,i),V=$.fromRectangle(U,f,g,e._tilingScheme.ellipsoid);return new Y({center:m,minimumHeight:f,maximumHeight:g,boundingSphere:_,orientedBoundingBox:V,horizonOcclusionPoint:y,quantizedVertices:C,encodedNormals:B,indices:T,westIndices:L,southIndices:M,eastIndices:I,northIndices:z,westSkirtHeight:W,southSkirtHeight:W,eastSkirtHeight:W,northSkirtHeight:W,childTileMask:e.availability.computeChildMaskForTile(i,n,r),waterMask:H,credits:e._tileCredits})}(e,o,n,t,i,r):Promise.reject(new Q("Mesh buffer doesn't exist."))})):void 0}function ce(e,t,i,n){if(0===n)return;const r=e.availabilityLevels,o=n%r==0?n-r:(n/r|0)*r,s=1<<n-o;return{level:o,x:t/s|0,y:i/s|0}}function ue(e,t,i,n,r,o){if(!G(r.availabilityLevels))return{result:!1};let s;const a=function(){delete r.availabilityPromiseCache[s]},l=r.availabilityTilesLoaded,c=r.availability;let u=ce(r,t,i,n);for(;G(u);){if(c.isTileAvailable(u.level,u.x,u.y)&&!l.isTileAvailable(u.level,u.x,u.y)){let t;if(!o&&(s=`${u.level}-${u.x}-${u.y}`,t=r.availabilityPromiseCache[s],!G(t))){const i=new X({throttle:!1,throttleByServer:!0,type:J.TERRAIN});t=le(e,u.x,u.y,u.level,r,i),G(t)&&(r.availabilityPromiseCache[s]=t,t.then(a))}return{result:!0,promise:t}}u=ce(r,u.x,u.y,u.level)}return{result:!1}}function he(e){if(!(e&&e instanceof Cesium.Viewer)){throw new t(`Expected viewer to be typeof Viewer, actual typeof was ${typeof e}`)}}function de(e,t){if(null===e||"object"!=typeof e)return e;t=C(t,!1);const i=new e.constructor;for(const n in e)if(e.hasOwnProperty(n)){let r=e[n];t&&(r=de(r,t)),i[n]=r}return i}ne.prototype.requestTileGeometry=function(e,t,i,n){const r=this._layers;let o;const s=r.length;if(1===s)o=r[0];else for(let n=0;n<s;++n){const s=r[n];if(!G(s.availability)||s.availability.isTileAvailable(i,e,t)){o=s;break}}return le(this,e,t,i,o,n)},Object.defineProperties(ne.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){return this._hasVertexNormals&&this._requestVertexNormals}},hasMetadata:{get:function(){return this._hasMetadata&&this._requestMetadata}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},requestMetadata:{get:function(){return this._requestMetadata}},availability:{get:function(){return this._availability}}}),ne.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},ne.prototype.getTileDataAvailable=function(e,t,i){if(!G(this._availability))return;if(i>this._availability._maximumLevel)return!1;if(this._availability.isTileAvailable(i,e,t))return!0;if(!this._hasMetadata)return!1;const n=this._layers,r=n.length;for(let o=0;o<r;++o){if(ue(this,e,t,i,n[o],0===o).result)return}return!1},ne.prototype.loadTileDataAvailability=function(e,t,i){if(!G(this._availability)||i>this._availability._maximumLevel||this._availability.isTileAvailable(i,e,t)||!this._hasMetadata)return;const n=this._layers,r=n.length;for(let o=0;o<r;++o){const r=ue(this,e,t,i,n[o],0===o);if(G(r.promise))return r.promise}},ne._getAvailabilityTile=ce;const pe=/((?:.*\/)|^)CesiumPro\.js(?:\?|#|$)/;let me,fe,ge;function _e(e){return"undefined"==typeof document?e:(x(me)||(me=document.createElement("a")),me.href=e,me.href=me.href,me.href)}function ye(e){return _e(`../${e}`)}function ve(){if(x(fe))return fe;let e;if(e="undefined"!=typeof CESIUMPRO_BASE_URL?CESIUMPRO_BASE_URL:"object"==typeof window.define&&x(window.define.amd)&&!window.define.amd.toUrlUndefined?Cesium.getAbsoluteUri("..","core/Url.js"):function(){const e=document.getElementsByTagName("script");for(let t=0,i=e.length;t<i;++t){const i=e[t].getAttribute("src"),n=pe.exec(i);if(null!==n)return n[1]}}(),!x(e))throw new t("Unable to determine CesiumPro base URL automatically, try defining a global variable called CESIUMPRO_BASE_URL.");return x(e)||(e=""),fe=new Cesium.Resource({url:_e(e)}),fe.appendForwardSlash(),fe}function Ce(e){return ve().getDerivedResource({url:e}).url}function xe(e){x(ge)||(ge="object"==typeof window.define&&x(window.define.amd)&&!window.define.amd.toUrlUndefined?ye:Ce);return ge(e)}const we={join:function(...e){const t=[];for(let i of e)i.startsWith("/")&&(i=i.substring(1)),i.endsWith("/")&&(i=i.substring(0,i.length-1)),t.push(i);return t.join("/")},buildModuleUrl:function(e){return xe(e)}};we.getCesiumProBaseUrl=ve;const{FeatureDetection:be,isCrossOriginUrl:Se}=Cesium;let Te;function Ae(){return x(Te)||(Te=function(e){let t=Cesium.buildModuleUrl(e);if(Se(t)){const e='importScripts("'+t+'");';let i;try{i=new Blob([e],{type:"application/javascript"})}catch(t){let n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(e),i=n.getBlob("application/javascript")}t=(window.URL||window.webkitURL).createObjectURL(i)}return t}("Workers/cesiumWorkerBootstrapper.js")),Te}function Ee(e){const t=new Worker(Ae());t.postMessage=C(t.webkitPostMessage,t.postMessage);const i={loaderConfig:{paths:{Workers:xe("workers")},baseUrl:ve().url},workerModule:e._workerPath};return t.postMessage(i),t.onmessage=function(t){!function(e,t){console.log(e,t,"------complete-----")}(e,t.data)},t.postMessage(e._options),t}const{kdbush:Pe,Cartesian3:Le,Cartographic:De,PointPrimitive:Me,BoundingRectangle:Re,SceneMode:Ie,EllipsoidalOccluder:Ne}=Cesium;function Oe(e){return e.__pixel.x}function Fe(e){return e.__pixel.y}function ke(e,t){const i=new Re;return Me.getScreenSpaceBoundingBox(e,t,i),function(e,t){e.x-=t,e.y-=t,e.width+=2*t,e.height+=2*t}(i,this.pixelRange),i}let ze;function Be(e){if(!e.scene.globe)return;const t=Cesium.getTimestamp(),i=e.scene;if(x(ze)&&t-ze<250)return;ze=t;const n=i.canvas.clientWidth,r=i.canvas.clientHeight,o=i.camera.getPickRay(new Cesium.Cartesian2(n/2,r/2)),s=i.camera.getPickRay(new Cesium.Cartesian2(n/2+1,r/2)),a=i.globe.pick(o,i),l=i.globe.pick(s,i);if(!x(a)||!x(l))return;return new Cesium.EllipsoidGeodesic(i.globe.ellipsoid.cartesianToCartographic(a),i.globe.ellipsoid.cartesianToCartographic(l)).surfaceDistance}function Ge(e){const t=e.canvas.getBoundingClientRect(),i=new Cesium.Cartesian2(t.width/2,t.height/2);return w.fromPixel(i,e)}function He(e){if(!e.scene.globe)return{};if(e.scene.mode===Cesium.SceneMode.SCENE3D){const t=e.camera.computeViewRectangle();if(!x(t))return;return{west:Cesium.Math.toDegrees(t.west),south:Cesium.Math.toDegrees(t.south),east:Cesium.Math.toDegrees(t.east),north:Cesium.Math.toDegrees(t.north)}}const t=e.canvas.getBoundingClientRect(),i=w.fromPixel(new Cesium.Cartesian2(0,t.height/2),e)||{lon:-180},n=w.fromPixel(new Cesium.Cartesian2(t.width,t.height/2),e)||{lon:180},r=w.fromPixel(new Cesium.Cartesian2(t.width/2,0),e)||{lat:90},o=w.fromPixel(new Cesium.Cartesian2(t.width/2,t.height),e)||{lat:-90};return{west:i.lon,south:o.lat,east:n.lon,north:r.lat}}class We{constructor(e,t){he(e),this._viewer=e,t=C(t,{});const i=C(t.items,[]);this._items=new Cesium.AssociativeArray,this._position=t.position,this._container=C(t.container,e.container),this._root=this.createMenu(),this.createItems(i),this._show=!0,this._activeSubMenu=void 0,this.parent=t.parent}get show(){return this._show}set show(e){this._show=e,this._root.style.display=e?"block":"none",this._menu.style.display=e?"block":"none"}get position(){return this._position}set position(e){if(this._position=e,this._root){const e=w.toPixel(this._position,this._viewer.scene);this._root.style.left=e.x+"px",this._root.style.top=e.y+"px"}}get(e){return this._items.values[e]}getById(e){return this._items.get(e)}add(e){if(this._items.contains(e.id))return;const t=this.createItem(e);this._items.set(t.id,t),this._menu.appendChild(t.el)}remove(e){const t=e.el;try{return this._root.removeChild(t),this._items.remove(e.id),!0}catch(e){return!1}}removeAll(){for(let e of this._items.values)this.remove(e)}createMenu(){const e=document.createElement("div");e.className="context-root";const t=document.createElement("ul");if(t.className="context-menu context-ul",e.appendChild(t),this._container.appendChild(e),this._position){const t=w.toPixel(this._position,this._viewer.scene);e.style.left=t.x+"px",e.style.top=t.y+"px"}return this._menu=t,e.oncontextmenu=function(){return!1},e}updateItemText(e,t){const i=document.getElementById(e.id+"-text");i&&(i.innerHTML=t)}updateItemDistabled(e,t){e&&e.a&&(e.disabled=t,e.a.className=t?"context-item-disabled":"context-item")}createItems(e){for(let t of e)this.add(t)}createItem(e={}){const t=document.createElement("li");t.className="context-menu";const i=document.createElement("a");i.className=e.disabled?"context-item-disabled":"context-item";const n=document.createElement("i");if(n.className=e.class,i.appendChild(n),i.innerHTML+=`<span id="${e.id}-text">${e.text}</span>`,t.appendChild(i),t.id=e.id,e.el=t,e.a=i,e.children){const n=document.createElement("i");n.className="fa fa-caret-right",i.appendChild(n);const r=new We(this._viewer,{items:e.children,position:this._position,parent:this});t.appendChild(r._menu),r._menu.className+=" context-submenu",e.subMenu=r,r.container=e}return e.el.onmouseover=t=>{t.stopPropagation(),e.disabled||(this._activeSubMenu&&(this._activeSubMenu.show=!1),e.subMenu&&(e.subMenu.show=!0),this._activeSubMenu=e.subMenu)},e.el.onclick=t=>{t.stopPropagation(),e.disabled||(e.callback&&e.callback(e),this.show=!1,this.parent&&(this.parent.show=!1))},e}ContextMenuItem(e){}destroy(){}}function Ue(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function je(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=Math.floor(16*Math.random());return("x"===e?t:3&t|8).toString(16)}))}const Ve=[],{document:qe}=window,$e=Object.getPrototypeOf,{slice:Ye}=Ve,{concat:Xe}=Ve,{push:Je}=Ve,{indexOf:Ze}=Ve,Qe={},{toString:Ke}=Qe,et=Qe.hasOwnProperty,tt=et.toString,it=tt.call(Object),nt={},rt=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},ot=function(e){return null!=e&&e===e.window},st={type:!0,src:!0,nonce:!0,noModule:!0};function at(e,t,i){let n,r;const o=(i=i||qe).createElement("script");if(o.text=e,t)for(n in st)r=t[n]||t.getAttribute&&t.getAttribute(n),r&&o.setAttribute(n,r);i.head.appendChild(o).parentNode.removeChild(o)}function lt(e){return null==e?`${e}`:"object"==typeof e||"function"==typeof e?Qe[Ke.call(e)]||"object":typeof e}const ct="3.4.1";var ut=function(e,t){return new ut.fn.init(e,t)};const ht=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function dt(e){const t=!!e&&"length"in e&&e.length,i=lt(e);return!rt(e)&&!ot(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}ut.fn=ut.prototype={jquery:ct,constructor:ut,length:0,toArray(){return Ye.call(this)},get(e){return null==e?Ye.call(this):e<0?this[e+this.length]:this[e]},pushStack(e){const t=ut.merge(this.constructor(),e);return t.prevObject=this,t},each(e){return ut.each(this,e)},map(e){return this.pushStack(ut.map(this,((t,i)=>e.call(t,i,t))))},slice(){return this.pushStack(Ye.apply(this,arguments))},first(){return this.eq(0)},last(){return this.eq(-1)},eq(e){const t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end(){return this.prevObject||this.constructor()},push:Je,sort:Ve.sort,splice:Ve.splice},ut.extend=ut.fn.extend=function(){let e,t,i,n,r,o,s=arguments[0]||{},a=1;const{length:l}=arguments;let c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||rt(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)n=e[t],"__proto__"!==t&&s!==n&&(c&&n&&(ut.isPlainObject(n)||(r=Array.isArray(n)))?(i=s[t],o=r&&!Array.isArray(i)?[]:r||ut.isPlainObject(i)?i:{},r=!1,s[t]=ut.extend(c,o,n)):void 0!==n&&(s[t]=n));return s},ut.extend({expando:`jQuery${(ct+Math.random()).replace(/\D/g,"")}`,isReady:!0,error(e){throw new Error(e)},noop(){},isPlainObject(e){let t,i;return!(!e||"[object Object]"!==Ke.call(e))&&(t=$e(e),!t||(i=et.call(t,"constructor")&&t.constructor,"function"==typeof i&&tt.call(i)===it))},isEmptyObject(e){let t;for(t in e)return!1;return!0},globalEval(e,t){at(e,{nonce:t&&t.nonce})},each(e,t){let i,n=0;if(dt(e))for(i=e.length;n<i&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:e=>null==e?"":`${e}`.replace(ht,""),makeArray(e,t){const i=t||[];return null!=e&&(dt(Object(e))?ut.merge(i,"string"==typeof e?[e]:e):Je.call(i,e)),i},inArray:(e,t,i)=>null==t?-1:Ze.call(t,e,i),merge(e,t){const i=+t.length;let n=0,r=e.length;for(;n<i;n++)e[r++]=t[n];return e.length=r,e},grep(e,t,i){let n;const r=[];let o=0;const{length:s}=e,a=!i;for(;o<s;o++)n=!t(e[o],o),n!==a&&r.push(e[o]);return r},map(e,t,i){let n,r,o=0;const s=[];if(dt(e))for(n=e.length;o<n;o++)r=t(e[o],o,i),null!=r&&s.push(r);else for(o in e)r=t(e[o],o,i),null!=r&&s.push(r);return Xe.apply([],s)},guid:1,support:nt}),"function"==typeof Symbol&&(ut.fn[Symbol.iterator]=Ve[Symbol.iterator]),ut.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),((e,t)=>{Qe[`[object ${t}]`]=t.toLowerCase()}));const pt=
/*!
     * Sizzle CSS Selector Engine v2.3.4
     * https://sizzlejs.com/
     *
     * Copyright JS Foundation and other contributors
     * Released under the MIT license
     * https://js.foundation/
     *
     * Date: 2019-04-08
     */
function(e){let t,i,n,r,o,s,a,l,c,u,h,d,p,m,f,g,_,y,v;const C="sizzle"+1*new Date,x=e.document;let w=0,b=0;const S=le(),T=le(),A=le(),E=le();let P=function(e,t){return e===t&&(h=!0),0};const L={}.hasOwnProperty;let D=[];const{pop:M}=D,R=D.push;let{push:I}=D;const{slice:N}=D,O=function(e,t){let i=0;const n=e.length;for(;i<n;i++)if(e[i]===t)return i;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",k="[\\x20\\t\\r\\n\\f]",z="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",B=`\\[${k}*(${z})(?:${k}*([*^$|!~]?=)${k}*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(${z}))|)${k}*\\]`,G=`:(${z})(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|${B})*)|.*)\\)|)`,H=new RegExp(`${k}+`,"g"),W=new RegExp(`^${k}+|((?:^|[^\\\\])(?:\\\\.)*)${k}+$`,"g"),U=new RegExp(`^${k}*,${k}*`),j=new RegExp(`^${k}*([>+~]|${k})${k}*`),V=new RegExp(`${k}|>`),q=new RegExp(G),$=new RegExp(`^${z}$`),Y={ID:new RegExp(`^#(${z})`),CLASS:new RegExp(`^\\.(${z})`),TAG:new RegExp(`^(${z}|[*])`),ATTR:new RegExp(`^${B}`),PSEUDO:new RegExp(`^${G}`),CHILD:new RegExp(`^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(${k}*(even|odd|(([+-]|)(\\d*)n|)${k}*(?:([+-]|)${k}*(\\d+)|))${k}*\\)|)`,"i"),bool:new RegExp(`^(?:${F})$`,"i"),needsContext:new RegExp(`^${k}*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(${k}*((?:-\\d)?\\d*)${k}*\\)|)(?=[^-]|$)`,"i")},X=/HTML$/i,J=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp(`\\\\([\\da-f]{1,6}${k}?|(${k})|.)`,"ig"),ie=function(e,t,i){const n=`0x${t}`-65536;return n!=n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ne=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,re=function(e,t){return t?"\0"===e?"�":`${e.slice(0,-1)}\\${e.charCodeAt(e.length-1).toString(16)} `:`\\${e}`},oe=function(){d()},se=Ce((e=>!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()),{dir:"parentNode",next:"legend"});try{I.apply(D=N.call(x.childNodes),x.childNodes),D[x.childNodes.length].nodeType}catch(e){I={apply:D.length?function(e,t){R.apply(e,N.call(t))}:function(e,t){let i=e.length,n=0;for(;e[i++]=t[n++];);e.length=i-1}}}function ae(e,t,n,r){let o,a,c,u,h,m,_,y=t&&t.ownerDocument;const w=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return n;if(!r&&((t?t.ownerDocument||t:x)!==p&&d(t),t=t||p,f)){if(11!==w&&(h=K.exec(e)))if(o=h[1]){if(9===w){if(!(c=t.getElementById(o)))return n;if(c.id===o)return n.push(c),n}else if(y&&(c=y.getElementById(o))&&v(t,c)&&c.id===o)return n.push(c),n}else{if(h[2])return I.apply(n,t.getElementsByTagName(e)),n;if((o=h[3])&&i.getElementsByClassName&&t.getElementsByClassName)return I.apply(n,t.getElementsByClassName(o)),n}if(i.qsa&&!E[`${e} `]&&(!g||!g.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(_=e,y=t,1===w&&V.test(e)){for((u=t.getAttribute("id"))?u=u.replace(ne,re):t.setAttribute("id",u=C),m=s(e),a=m.length;a--;)m[a]=`#${u} ${ve(m[a])}`;_=m.join(","),y=ee.test(e)&&_e(t.parentNode)||t}try{return I.apply(n,y.querySelectorAll(_)),n}catch(t){E(e,!0)}finally{u===C&&t.removeAttribute("id")}}}return l(e.replace(W,"$1"),t,n,r)}function le(){const e=[];return function t(i,r){return e.push(`${i} `)>n.cacheLength&&delete t[e.shift()],t[`${i} `]=r}}function ce(e){return e[C]=!0,e}function ue(e){let t=p.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function he(e,t){const i=e.split("|");let r=i.length;for(;r--;)n.attrHandle[i[r]]=t}function de(e,t){let i=t&&e;const n=i&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function pe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function me(e){return function(t){const i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function fe(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ge(e){return ce((t=>(t=+t,ce(((i,n)=>{let r;const o=e([],i.length,t);let s=o.length;for(;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})))))}function _e(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in i=ae.support={},o=ae.isXML=function(e){const t=e.namespaceURI,i=(e.ownerDocument||e).documentElement;return!X.test(t||i&&i.nodeName||"HTML")},d=ae.setDocument=function(e){let t,r;const s=e?e.ownerDocument||e:x;return s!==p&&9===s.nodeType&&s.documentElement?(p=s,m=p.documentElement,f=!o(p),x!==p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",oe,!1):r.attachEvent&&r.attachEvent("onunload",oe)),i.attributes=ue((e=>(e.className="i",!e.getAttribute("className")))),i.getElementsByTagName=ue((e=>(e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length))),i.getElementsByClassName=Q.test(p.getElementsByClassName),i.getById=ue((e=>(m.appendChild(e).id=C,!p.getElementsByName||!p.getElementsByName(C).length))),i.getById?(n.filter.ID=function(e){const t=e.replace(te,ie);return function(e){return e.getAttribute("id")===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){const i=t.getElementById(e);return i?[i]:[]}}):(n.filter.ID=function(e){const t=e.replace(te,ie);return function(e){const i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){let i,n,r,o=t.getElementById(e);if(o){if(i=o.getAttributeNode("id"),i&&i.value===e)return[o];for(r=t.getElementsByName(e),n=0;o=r[n++];)if(i=o.getAttributeNode("id"),i&&i.value===e)return[o]}return[]}}),n.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){let i;const n=[];let r=0;const o=t.getElementsByTagName(e);if("*"===e){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},n.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&f)return t.getElementsByClassName(e)},_=[],g=[],(i.qsa=Q.test(p.querySelectorAll))&&(ue((e=>{m.appendChild(e).innerHTML=`<a id='${C}'></a><select id='${C}-\r\\' msallowcapture=''><option selected=''></option></select>`,e.querySelectorAll("[msallowcapture^='']").length&&g.push(`[*^$]=${k}*(?:''|"")`),e.querySelectorAll("[selected]").length||g.push(`\\[${k}*(?:value|${F})`),e.querySelectorAll(`[id~=${C}-]`).length||g.push("~="),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll(`a#${C}+*`).length||g.push(".#.+[+~]")})),ue((e=>{e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";const t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push(`name${k}*[*^$|!~]?=`),2!==e.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),m.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")}))),(i.matchesSelector=Q.test(y=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&ue((e=>{i.disconnectedMatch=y.call(e,"*"),y.call(e,"[s!='']:x"),_.push("!=",G)})),g=g.length&&new RegExp(g.join("|")),_=_.length&&new RegExp(_.join("|")),t=Q.test(m.compareDocumentPosition),v=t||Q.test(m.contains)?function(e,t){const i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},P=t?function(e,t){if(e===t)return h=!0,0;let n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!i.sortDetached&&t.compareDocumentPosition(e)===n?e===p||e.ownerDocument===x&&v(x,e)?-1:t===p||t.ownerDocument===x&&v(x,t)?1:u?O(u,e)-O(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return h=!0,0;let i,n=0;const r=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!r||!o)return e===p?-1:t===p?1:r?-1:o?1:u?O(u,e)-O(u,t):0;if(r===o)return de(e,t);for(i=e;i=i.parentNode;)s.unshift(i);for(i=t;i=i.parentNode;)a.unshift(i);for(;s[n]===a[n];)n++;return n?de(s[n],a[n]):s[n]===x?-1:a[n]===x?1:0},p):p},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&d(e),i.matchesSelector&&f&&!E[`${t} `]&&(!_||!_.test(t))&&(!g||!g.test(t)))try{const n=y.call(e,t);if(n||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){E(t,!0)}return ae(t,p,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!==p&&d(e),v(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!==p&&d(e);const r=n.attrHandle[t.toLowerCase()];let o=r&&L.call(n.attrHandle,t.toLowerCase())?r(e,t,!f):void 0;return void 0!==o?o:i.attributes||!f?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},ae.escape=function(e){return`${e}`.replace(ne,re)},ae.error=function(e){throw new Error(`Syntax error, unrecognized expression: ${e}`)},ae.uniqueSort=function(e){let t;const n=[];let r=0,o=0;if(h=!i.detectDuplicates,u=!i.sortStable&&e.slice(0),e.sort(P),h){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return u=null,e},r=ae.getText=function(e){let t,i="",n=0;const{nodeType:o}=e;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=r(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)i+=r(t);return i},n=ae.selectors={cacheLength:50,createPseudo:ce,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:e=>(e[1]=e[1].replace(te,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ie),"~="===e[2]&&(e[3]=` ${e[3]} `),e.slice(0,4)),CHILD:e=>(e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e),PSEUDO(e){let t;const i=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&q.test(i)&&(t=s(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG(e){const t=e.replace(te,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS(e){let t=S[`${e} `];return t||(t=new RegExp(`(^|${k})${e}(${k}|$)`))&&S(e,(e=>t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")))},ATTR:(e,t,i)=>function(n){let r=ae.attr(n,e);return null==r?"!="===t:!t||(r+="","="===t?r===i:"!="===t?r!==i:"^="===t?i&&0===r.indexOf(i):"*="===t?i&&r.indexOf(i)>-1:"$="===t?i&&r.slice(-i.length)===i:"~="===t?` ${r.replace(H," ")} `.indexOf(i)>-1:"|="===t&&(r===i||r.slice(0,i.length+1)===`${i}-`))},CHILD(e,t,i,n,r){const o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,l){let c,u,h,d,p,m,f=o!==s?"nextSibling":"previousSibling";const g=t.parentNode,_=a&&t.nodeName.toLowerCase(),y=!l&&!a;let v=!1;if(g){if(o){for(;f;){for(d=t;d=d[f];)if(a?d.nodeName.toLowerCase()===_:1===d.nodeType)return!1;m=f="only"===e&&!m&&"nextSibling"}return!0}if(m=[s?g.firstChild:g.lastChild],s&&y){for(d=g,h=d[C]||(d[C]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),c=u[e]||[],p=c[0]===w&&c[1],v=p&&c[2],d=p&&g.childNodes[p];d=++p&&d&&d[f]||(v=p=0)||m.pop();)if(1===d.nodeType&&++v&&d===t){u[e]=[w,p,v];break}}else if(y&&(d=t,h=d[C]||(d[C]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),c=u[e]||[],p=c[0]===w&&c[1],v=p),!1===v)for(;(d=++p&&d&&d[f]||(v=p=0)||m.pop())&&((a?d.nodeName.toLowerCase()!==_:1!==d.nodeType)||!++v||(y&&(h=d[C]||(d[C]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),u[e]=[w,v]),d!==t)););return v-=r,v===n||v%n==0&&v/n>=0}}},PSEUDO(e,t){let i;const r=n.pseudos[e]||n.setFilters[e.toLowerCase()]||ae.error(`unsupported pseudo: ${e}`);return r[C]?r(t):r.length>1?(i=[e,e,"",t],n.setFilters.hasOwnProperty(e.toLowerCase())?ce(((e,i)=>{let n;const o=r(e,t);let s=o.length;for(;s--;)n=O(e,o[s]),e[n]=!(i[n]=o[s])})):function(e){return r(e,0,i)}):r}},pseudos:{not:ce((e=>{const t=[],i=[],n=a(e.replace(W,"$1"));return n[C]?ce(((e,t,i,r)=>{let o;const s=n(e,null,r,[]);let a=e.length;for(;a--;)(o=s[a])&&(e[a]=!(t[a]=o))})):function(e,r,o){return t[0]=e,n(t,null,o,i),t[0]=null,!i.pop()}})),has:ce((e=>function(t){return ae(e,t).length>0})),contains:ce((e=>(e=e.replace(te,ie),function(t){return(t.textContent||r(t)).indexOf(e)>-1}))),lang:ce((e=>($.test(e||"")||ae.error(`unsupported lang: ${e}`),e=e.replace(te,ie).toLowerCase(),function(t){let i;do{if(i=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(`${e}-`)}while((t=t.parentNode)&&1===t.nodeType);return!1}))),target(t){const i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:e=>e===m,focus:e=>e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex),enabled:fe(!1),disabled:fe(!0),checked(e){const t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:e=>(e.parentNode&&e.parentNode.selectedIndex,!0===e.selected),empty(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:e=>!n.pseudos.empty(e),header:e=>Z.test(e.nodeName),input:e=>J.test(e.nodeName),button(e){const t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text(e){let t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ge((()=>[0])),last:ge(((e,t)=>[t-1])),eq:ge(((e,t,i)=>[i<0?i+t:i])),even:ge(((e,t)=>{let i=0;for(;i<t;i+=2)e.push(i);return e})),odd:ge(((e,t)=>{let i=1;for(;i<t;i+=2)e.push(i);return e})),lt:ge(((e,t,i)=>{let n=i<0?i+t:i>t?t:i;for(;--n>=0;)e.push(n);return e})),gt:ge(((e,t,i)=>{let n=i<0?i+t:i;for(;++n<t;)e.push(n);return e}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[t]=pe(t);for(t in{submit:!0,reset:!0})n.pseudos[t]=me(t);function ye(){}function ve(e){let t=0;const i=e.length;let n="";for(;t<i;t++)n+=e[t].value;return n}function Ce(e,t,i){const{dir:n}=t,r=t.next,o=r||n,s=i&&"parentNode"===o,a=b++;return t.first?function(t,i,r){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,r);return!1}:function(t,i,l){let c,u,h;const d=[w,a];if(l){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,l))return!0}else for(;t=t[n];)if(1===t.nodeType||s)if(h=t[C]||(t[C]={}),u=h[t.uniqueID]||(h[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[n]||t;else{if((c=u[o])&&c[0]===w&&c[1]===a)return d[2]=c[2];if(u[o]=d,d[2]=e(t,i,l))return!0}return!1}}function xe(e){return e.length>1?function(t,i,n){let r=e.length;for(;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function we(e,t,i,n,r){let o;const s=[];let a=0;const l=e.length,c=null!=t;for(;a<l;a++)(o=e[a])&&(i&&!i(o,n,r)||(s.push(o),c&&t.push(a)));return s}function be(e,t,i,n,r,o){return n&&!n[C]&&(n=be(n)),r&&!r[C]&&(r=be(r,o)),ce(((o,s,a,l)=>{let c,u,h;const d=[],p=[],m=s.length,f=o||function(e,t,i){let n=0;const r=t.length;for(;n<r;n++)ae(e,t[n],i);return i}(t||"*",a.nodeType?[a]:a,[]),g=!e||!o&&t?f:we(f,d,e,a,l);let _=i?r||(o?e:m||n)?[]:s:g;if(i&&i(g,_,a,l),n)for(c=we(_,p),n(c,[],a,l),u=c.length;u--;)(h=c[u])&&(_[p[u]]=!(g[p[u]]=h));if(o){if(r||e){if(r){for(c=[],u=_.length;u--;)(h=_[u])&&c.push(g[u]=h);r(null,_=[],c,l)}for(u=_.length;u--;)(h=_[u])&&(c=r?O(o,h):d[u])>-1&&(o[c]=!(s[c]=h))}}else _=we(_===s?_.splice(m,_.length):_),r?r(null,s,_,l):I.apply(s,_)}))}function Se(e){let t,i,r;const o=e.length,s=n.relative[e[0].type],a=s||n.relative[" "];let l=s?1:0;const u=Ce((e=>e===t),a,!0),h=Ce((e=>O(t,e)>-1),a,!0);let d=[function(e,i,n){const r=!s&&(n||i!==c)||((t=i).nodeType?u(e,i,n):h(e,i,n));return t=null,r}];for(;l<o;l++)if(i=n.relative[e[l].type])d=[Ce(xe(d),i)];else{if(i=n.filter[e[l].type].apply(null,e[l].matches),i[C]){for(r=++l;r<o&&!n.relative[e[r].type];r++);return be(l>1&&xe(d),l>1&&ve(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(W,"$1"),i,l<r&&Se(e.slice(l,r)),r<o&&Se(e=e.slice(r)),r<o&&ve(e))}d.push(i)}return xe(d)}return ye.prototype=n.filters=n.pseudos,n.setFilters=new ye,s=ae.tokenize=function(e,t){let i,r,o,s,a,l,c;const u=T[`${e} `];if(u)return t?0:u.slice(0);for(a=e,l=[],c=n.preFilter;a;){for(s in i&&!(r=U.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),i=!1,(r=j.exec(a))&&(i=r.shift(),o.push({value:i,type:r[0].replace(W," ")}),a=a.slice(i.length)),n.filter)!(r=Y[s].exec(a))||c[s]&&!(r=c[s](r))||(i=r.shift(),o.push({value:i,type:s,matches:r}),a=a.slice(i.length));if(!i)break}return t?a.length:a?ae.error(e):T(e,l).slice(0)},a=ae.compile=function(e,t){let i;const r=[],o=[];let a=A[`${e} `];if(!a){for(t||(t=s(e)),i=t.length;i--;)a=Se(t[i]),a[C]?r.push(a):o.push(a);a=A(e,function(e,t){const i=t.length>0,r=e.length>0,o=function(o,s,a,l,u){let h,m,g,_=0,y="0";const v=o&&[];let C=[];const x=c,b=o||r&&n.find.TAG("*",u),S=w+=null==x?1:Math.random()||.1,T=b.length;for(u&&(c=s===p||s||u);y!==T&&null!=(h=b[y]);y++){if(r&&h){for(m=0,s||h.ownerDocument===p||(d(h),a=!f);g=e[m++];)if(g(h,s||p,a)){l.push(h);break}u&&(w=S)}i&&((h=!g&&h)&&_--,o&&v.push(h))}if(_+=y,i&&y!==_){for(m=0;g=t[m++];)g(v,C,s,a);if(o){if(_>0)for(;y--;)v[y]||C[y]||(C[y]=M.call(l));C=we(C)}I.apply(l,C),u&&!o&&C.length>0&&_+t.length>1&&ae.uniqueSort(l)}return u&&(w=S,c=x),v};return i?ce(o):o}(o,r)),a.selector=e}return a},l=ae.select=function(e,t,i,r){let o,l,c,u,h;const d="function"==typeof e&&e,p=!r&&s(e=d.selector||e);if(i=i||[],1===p.length){if(l=p[0]=p[0].slice(0),l.length>2&&"ID"===(c=l[0]).type&&9===t.nodeType&&f&&n.relative[l[1].type]){if(!(t=(n.find.ID(c.matches[0].replace(te,ie),t)||[])[0]))return i;d&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(o=Y.needsContext.test(e)?0:l.length;o--&&(c=l[o],!n.relative[u=c.type]);)if((h=n.find[u])&&(r=h(c.matches[0].replace(te,ie),ee.test(l[0].type)&&_e(t.parentNode)||t))){if(l.splice(o,1),!(e=r.length&&ve(l)))return I.apply(i,r),i;break}}return(d||a(e,p))(r,t,!f,i,!t||ee.test(e)&&_e(t.parentNode)||t),i},i.sortStable=C.split("").sort(P).join("")===C,i.detectDuplicates=!!h,d(),i.sortDetached=ue((e=>1&e.compareDocumentPosition(p.createElement("fieldset")))),ue((e=>(e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href"))))||he("type|href|height|width",((e,t,i)=>{if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),i.attributes&&ue((e=>(e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value"))))||he("value",((e,t,i)=>{if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),ue((e=>null==e.getAttribute("disabled")))||he(F,((e,t,i)=>{let n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null})),ae}(window);ut.find=pt,ut.expr=pt.selectors,ut.expr[":"]=ut.expr.pseudos,ut.uniqueSort=ut.unique=pt.uniqueSort,ut.text=pt.getText,ut.isXMLDoc=pt.isXML,ut.contains=pt.contains,ut.escapeSelector=pt.escape;const mt=function(e,t,i){const n=[],r=void 0!==i;for(;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&ut(e).is(i))break;n.push(e)}return n},ft=function(e,t){const i=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},gt=ut.expr.match.needsContext;function _t(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}const yt=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function vt(e,t,i){return rt(t)?ut.grep(e,((e,n)=>!!t.call(e,n,e)!==i)):t.nodeType?ut.grep(e,(e=>e===t!==i)):"string"!=typeof t?ut.grep(e,(e=>Ze.call(t,e)>-1!==i)):ut.filter(t,e,i)}let Ct;ut.filter=function(e,t,i){const n=t[0];return i&&(e=`:not(${e})`),1===t.length&&1===n.nodeType?ut.find.matchesSelector(n,e)?[n]:[]:ut.find.matches(e,ut.grep(t,(e=>1===e.nodeType)))},ut.fn.extend({find(e){let t,i;const n=this.length,r=this;if("string"!=typeof e)return this.pushStack(ut(e).filter((function(){for(t=0;t<n;t++)if(ut.contains(r[t],this))return!0})));for(i=this.pushStack([]),t=0;t<n;t++)ut.find(e,r[t],i);return n>1?ut.uniqueSort(i):i},filter(e){return this.pushStack(vt(this,e||[],!1))},not(e){return this.pushStack(vt(this,e||[],!0))},is(e){return!!vt(this,"string"==typeof e&&gt.test(e)?ut(e):e||[],!1).length}});const xt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ut.fn.init=function(e,t,i){let n,r;if(!e)return this;if(i=i||Ct,"string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:xt.exec(e),n&&(n[1]||!t)){if(n[1]){if(t=t instanceof ut?t[0]:t,ut.merge(this,ut.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:qe,!0)),yt.test(n[1])&&ut.isPlainObject(t))for(n in t)rt(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return r=qe.getElementById(n[2]),r&&(this[0]=r,this.length=1),this}return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e)}return e.nodeType?(this[0]=e,this.length=1,this):rt(e)?void 0!==i.ready?i.ready(e):e(ut):ut.makeArray(e,this)}).prototype=ut.fn,Ct=ut(qe);const wt=/^(?:parents|prev(?:Until|All))/,bt={children:!0,contents:!0,next:!0,prev:!0};function St(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}ut.fn.extend({has(e){const t=ut(e,this),i=t.length;return this.filter((function(){let e=0;for(;e<i;e++)if(ut.contains(this,t[e]))return!0}))},closest(e,t){let i,n=0;const r=this.length,o=[],s="string"!=typeof e&&ut(e);if(!gt.test(e))for(;n<r;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&ut.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?ut.uniqueSort(o):o)},index(e){return e?"string"==typeof e?Ze.call(ut(e),this[0]):Ze.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add(e,t){return this.pushStack(ut.uniqueSort(ut.merge(this.get(),ut(e,t))))},addBack(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ut.each({parent(e){const t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:e=>mt(e,"parentNode"),parentsUntil:(e,t,i)=>mt(e,"parentNode",i),next:e=>St(e,"nextSibling"),prev:e=>St(e,"previousSibling"),nextAll:e=>mt(e,"nextSibling"),prevAll:e=>mt(e,"previousSibling"),nextUntil:(e,t,i)=>mt(e,"nextSibling",i),prevUntil:(e,t,i)=>mt(e,"previousSibling",i),siblings:e=>ft((e.parentNode||{}).firstChild,e),children:e=>ft(e.firstChild),contents:e=>void 0!==e.contentDocument?e.contentDocument:(_t(e,"template")&&(e=e.content||e),ut.merge([],e.childNodes))},((e,t)=>{ut.fn[e]=function(i,n){let r=ut.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=ut.filter(n,r)),this.length>1&&(bt[e]||ut.uniqueSort(r),wt.test(e)&&r.reverse()),this.pushStack(r)}}));const Tt=/[^\x20\t\r\n\f]+/g;function At(e){return e}function Et(e){throw e}function Pt(e,t,i,n){let r;try{e&&rt(r=e.promise)?r.call(e).done(t).fail(i):e&&rt(r=e.then)?r.call(e,t,i):t.apply(void 0,[e].slice(n))}catch(e){i.apply(void 0,[e])}}ut.Callbacks=function(e){let t,i,n,r;e="string"==typeof e?function(e){const t={};return ut.each(e.match(Tt)||[],((e,i)=>{t[i]=!0})),t}(e):ut.extend({},e);let o=[],s=[],a=-1;const l=function(){for(r=r||e.once,n=t=!0;s.length;a=-1)for(i=s.shift();++a<o.length;)!1===o[a].apply(i[0],i[1])&&e.stopOnFalse&&(a=o.length,i=!1);e.memory||(i=!1),t=!1,r&&(o=i?[]:"")};var c={add(){return o&&(i&&!t&&(a=o.length-1,s.push(i)),function t(i){ut.each(i,((i,n)=>{rt(n)?e.unique&&c.has(n)||o.push(n):n&&n.length&&"string"!==lt(n)&&t(n)}))}(arguments),i&&!t&&l()),this},remove(){return ut.each(arguments,((e,t)=>{let i;for(;(i=ut.inArray(t,o,i))>-1;)o.splice(i,1),i<=a&&a--})),this},has:e=>e?ut.inArray(e,o)>-1:o.length>0,empty(){return o&&(o=[]),this},disable(){return r=s=[],o=i="",this},disabled:()=>!o,lock(){return r=s=[],i||t||(o=i=""),this},locked:()=>!!r,fireWith(e,i){return r||(i=[e,(i=i||[]).slice?i.slice():i],s.push(i),t||l()),this},fire(){return c.fireWith(this,arguments),this},fired:()=>!!n};return c},ut.extend({Deferred(e){const t=[["notify","progress",ut.Callbacks("memory"),ut.Callbacks("memory"),2],["resolve","done",ut.Callbacks("once memory"),ut.Callbacks("once memory"),0,"resolved"],["reject","fail",ut.Callbacks("once memory"),ut.Callbacks("once memory"),1,"rejected"]];let i="pending";var n={state:()=>i,always(){return r.done(arguments).fail(arguments),this},catch:e=>n.then(null,e),pipe(){let e=arguments;return ut.Deferred((i=>{ut.each(t,((t,n)=>{const o=rt(e[n[4]])&&e[n[4]];r[n[1]]((function(){const e=o&&o.apply(this,arguments);e&&rt(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[`${n[0]}With`](this,o?[e]:arguments)}))})),e=null})).promise()},then(e,i,n){let r=0;function o(e,t,i,n){return function(){let s=this,a=arguments;const l=function(){let l,c;if(!(e<r)){if(l=i.apply(s,a),l===t.promise())throw new TypeError("Thenable self-resolution");c=l&&("object"==typeof l||"function"==typeof l)&&l.then,rt(c)?n?c.call(l,o(r,t,At,n),o(r,t,Et,n)):(r++,c.call(l,o(r,t,At,n),o(r,t,Et,n),o(r,t,At,t.notifyWith))):(i!==At&&(s=void 0,a=[l]),(n||t.resolveWith)(s,a))}};var c=n?l:function(){try{l()}catch(n){ut.Deferred.exceptionHook&&ut.Deferred.exceptionHook(n,c.stackTrace),e+1>=r&&(i!==Et&&(s=void 0,a=[n]),t.rejectWith(s,a))}};e?c():(ut.Deferred.getStackHook&&(c.stackTrace=ut.Deferred.getStackHook()),window.setTimeout(c))}}return ut.Deferred((r=>{t[0][3].add(o(0,r,rt(n)?n:At,r.notifyWith)),t[1][3].add(o(0,r,rt(e)?e:At)),t[2][3].add(o(0,r,rt(i)?i:Et))})).promise()},promise:e=>null!=e?ut.extend(e,n):n},r={};return ut.each(t,((e,o)=>{const s=o[2],a=o[5];n[o[1]]=s.add,a&&s.add((()=>{i=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),s.add(o[3].fire),r[o[0]]=function(){return r[`${o[0]}With`](this===r?void 0:this,arguments),this},r[`${o[0]}With`]=s.fireWith})),n.promise(r),e&&e.call(r,r),r},when(e){let t=arguments.length,i=t;const n=Array(i),r=Ye.call(arguments),o=ut.Deferred(),s=function(e){return function(i){n[e]=this,r[e]=arguments.length>1?Ye.call(arguments):i,--t||o.resolveWith(n,r)}};if(t<=1&&(Pt(e,o.done(s(i)).resolve,o.reject,!t),"pending"===o.state()||rt(r[i]&&r[i].then)))return o.then();for(;i--;)Pt(r[i],s(i),o.reject);return o.promise()}});const Lt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ut.Deferred.exceptionHook=function(e,t){window.console&&window.console.warn&&e&&Lt.test(e.name)&&window.console.warn(`jQuery.Deferred exception: ${e.message}`,e.stack,t)},ut.readyException=function(e){window.setTimeout((()=>{throw e}))};const Dt=ut.Deferred();function Mt(){qe.removeEventListener("DOMContentLoaded",Mt),window.removeEventListener("load",Mt),ut.ready()}ut.fn.ready=function(e){return Dt.then(e).catch((e=>{ut.readyException(e)})),this},ut.extend({isReady:!1,readyWait:1,ready(e){(!0===e?--ut.readyWait:ut.isReady)||(ut.isReady=!0,!0!==e&&--ut.readyWait>0||Dt.resolveWith(qe,[ut]))}}),ut.ready.then=Dt.then,"complete"===qe.readyState||"loading"!==qe.readyState&&!qe.documentElement.doScroll?window.setTimeout(ut.ready):(qe.addEventListener("DOMContentLoaded",Mt),window.addEventListener("load",Mt));var Rt=function(e,t,i,n,r,o,s){let a=0;const l=e.length;let c=null==i;if("object"===lt(i))for(a in r=!0,i)Rt(e,t,a,i[a],!0,o,s);else if(void 0!==n&&(r=!0,rt(n)||(s=!0),c&&(s?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(ut(e),i)})),t))for(;a<l;a++)t(e[a],i,s?n:n.call(e[a],a,t(e[a],i)));return r?e:c?t.call(e):l?t(e[0],i):o};const It=/^-ms-/,Nt=/-([a-z])/g;function Ot(e,t){return t.toUpperCase()}function Ft(e){return e.replace(It,"ms-").replace(Nt,Ot)}const kt=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function zt(){this.expando=ut.expando+zt.uid++}zt.uid=1,zt.prototype={cache(e){let t=e[this.expando];return t||(t={},kt(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set(e,t,i){let n;const r=this.cache(e);if("string"==typeof t)r[Ft(t)]=i;else for(n in t)r[Ft(n)]=t[n];return r},get(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][Ft(t)]},access(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove(e,t){let i;const n=e[this.expando];if(void 0!==n){if(void 0!==t){i=(t=Array.isArray(t)?t.map(Ft):(t=Ft(t))in n?[t]:t.match(Tt)||[]).length;for(;i--;)delete n[t[i]]}(void 0===t||ut.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData(e){const t=e[this.expando];return void 0!==t&&!ut.isEmptyObject(t)}};const Bt=new zt,Gt=new zt,Ht=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Wt=/[A-Z]/g;function Ut(e,t,i){let n;if(void 0===i&&1===e.nodeType)if(n=`data-${t.replace(Wt,"-$&").toLowerCase()}`,"string"==typeof(i=e.getAttribute(n))){try{i=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===""+ +e?+e:Ht.test(e)?JSON.parse(e):e)}(i)}catch(e){}Gt.set(e,t,i)}else i=void 0;return i}ut.extend({hasData:e=>Gt.hasData(e)||Bt.hasData(e),data:(e,t,i)=>Gt.access(e,t,i),removeData(e,t){Gt.remove(e,t)},_data:(e,t,i)=>Bt.access(e,t,i),_removeData(e,t){Bt.remove(e,t)}}),ut.fn.extend({data(e,t){let i,n,r;const o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=Gt.get(o),1===o.nodeType&&!Bt.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=Ft(n.slice(5)),Ut(o,n,r[n])));Bt.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each((function(){Gt.set(this,e)})):Rt(this,(function(t){let i;if(o&&void 0===t)return i=Gt.get(o,e),void 0!==i?i:(i=Ut(o,e),void 0!==i?i:void 0);this.each((function(){Gt.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData(e){return this.each((function(){Gt.remove(this,e)}))}}),ut.extend({queue(e,t,i){let n;if(e)return t=`${t||"fx"}queue`,n=Bt.get(e,t),i&&(!n||Array.isArray(i)?n=Bt.access(e,t,ut.makeArray(i)):n.push(i)),n||[]},dequeue(e,t){t=t||"fx";const i=ut.queue(e,t);let n=i.length,r=i.shift();const o=ut._queueHooks(e,t),s=function(){ut.dequeue(e,t)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,s,o)),!n&&o&&o.empty.fire()},_queueHooks(e,t){const i=`${t}queueHooks`;return Bt.get(e,i)||Bt.access(e,i,{empty:ut.Callbacks("once memory").add((()=>{Bt.remove(e,[`${t}queue`,i])}))})}}),ut.fn.extend({queue(e,t){let i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?ut.queue(this[0],e):void 0===t?this:this.each((function(){const i=ut.queue(this,e,t);ut._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&ut.dequeue(this,e)}))},dequeue(e){return this.each((function(){ut.dequeue(this,e)}))},clearQueue(e){return this.queue(e||"fx",[])},promise(e,t){let i,n=1;const r=ut.Deferred(),o=this;let s=this.length;const a=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)i=Bt.get(o[s],`${e}queueHooks`),i&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(t)}});const jt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Vt=new RegExp(`^(?:([+-])=|)(${jt})([a-z%]*)$`,"i"),qt=["Top","Right","Bottom","Left"],{documentElement:$t}=qe;let Yt=function(e){return ut.contains(e.ownerDocument,e)};const Xt={composed:!0};$t.getRootNode&&(Yt=function(e){return ut.contains(e.ownerDocument,e)||e.getRootNode(Xt)===e.ownerDocument});const Jt=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&Yt(e)&&"none"===ut.css(e,"display")},Zt=function(e,t,i,n){let r,o;const s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];for(o in r=i.apply(e,n||[]),t)e.style[o]=s[o];return r};function Qt(e,t,i,n){let r,o,s=20;const a=n?function(){return n.cur()}:function(){return ut.css(e,t,"")};let l=a(),c=i&&i[3]||(ut.cssNumber[t]?"":"px"),u=e.nodeType&&(ut.cssNumber[t]||"px"!==c&&+l)&&Vt.exec(ut.css(e,t));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)ut.style(e,t,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;u*=2,ut.style(e,t,u+c),i=i||[]}return i&&(u=+u||+l||0,r=i[1]?u+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=u,n.end=r)),r}const Kt={};function ei(e){let t;const i=e.ownerDocument,{nodeName:n}=e;let r=Kt[n];return r||(t=i.body.appendChild(i.createElement(n)),r=ut.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),Kt[n]=r,r)}function ti(e,t){let i,n;const r=[];let o=0;const{length:s}=e;for(;o<s;o++)n=e[o],n.style&&(i=n.style.display,t?("none"===i&&(r[o]=Bt.get(n,"display")||null,r[o]||(n.style.display="")),""===n.style.display&&Jt(n)&&(r[o]=ei(n))):"none"!==i&&(r[o]="none",Bt.set(n,"display",i)));for(o=0;o<s;o++)null!=r[o]&&(e[o].style.display=r[o]);return e}ut.fn.extend({show(){return ti(this,!0)},hide(){return ti(this)},toggle(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){Jt(this)?ut(this).show():ut(this).hide()}))}});const ii=/^(?:checkbox|radio)$/i,ni=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ri=/^$|^module$|\/(?:java|ecma)script/i,oi={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function si(e,t){let i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&_t(e,t)?ut.merge([e],i):i}function ai(e,t){let i=0;const n=e.length;for(;i<n;i++)Bt.set(e[i],"globalEval",!t||Bt.get(t[i],"globalEval"))}oi.optgroup=oi.option,oi.tbody=oi.tfoot=oi.colgroup=oi.caption=oi.thead,oi.th=oi.td;const li=/<|&#?\w+;/;function ci(e,t,i,n,r){let o,s,a,l,c,u;const h=t.createDocumentFragment(),d=[];let p=0;const m=e.length;for(;p<m;p++)if(o=e[p],o||0===o)if("object"===lt(o))ut.merge(d,o.nodeType?[o]:o);else if(li.test(o)){for(s=s||h.appendChild(t.createElement("div")),a=(ni.exec(o)||["",""])[1].toLowerCase(),l=oi[a]||oi._default,s.innerHTML=l[1]+ut.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;ut.merge(d,s.childNodes),s=h.firstChild,s.textContent=""}else d.push(t.createTextNode(o));for(h.textContent="",p=0;o=d[p++];)if(n&&ut.inArray(o,n)>-1)r&&r.push(o);else if(c=Yt(o),s=si(h.appendChild(o),"script"),c&&ai(s),i)for(u=0;o=s[u++];)ri.test(o.type||"")&&i.push(o);return h}!function(){const e=qe.createDocumentFragment().appendChild(qe.createElement("div")),t=qe.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),nt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",nt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();const ui=/^key/,hi=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,di=/^([^.]*)(?:\.(.+)|)/;function pi(){return!0}function mi(){return!1}function fi(e,t){return e===function(){try{return qe.activeElement}catch(e){}}()==("focus"===t)}function gi(e,t,i,n,r,o){let s,a;if("object"==typeof t){for(a in"string"!=typeof i&&(n=n||i,i=void 0),t)gi(e,a,i,n,t[a],o);return e}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=mi;else if(!r)return e;return 1===o&&(s=r,r=function(e){return ut().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=ut.guid++)),e.each((function(){ut.event.add(this,t,r,n,i)}))}function _i(e,t,i){i?(Bt.set(e,t,!1),ut.event.add(e,t,{namespace:!1,handler(e){let n,r,o=Bt.get(this,t);if(1&e.isTrigger&&this[t]){if(o.length)(ut.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=Ye.call(arguments),Bt.set(this,t,o),n=i(this,t),this[t](),r=Bt.get(this,t),o!==r||n?Bt.set(this,t,!1):r={},o!==r)return e.stopImmediatePropagation(),e.preventDefault(),r.value}else o.length&&(Bt.set(this,t,{value:ut.event.trigger(ut.extend(o[0],ut.Event.prototype),o.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Bt.get(e,t)&&ut.event.add(e,t,pi)}ut.event={global:{},add(e,t,i,n,r){let o,s,a,l,c,u,h,d,p,m,f;const g=Bt.get(e);if(g)for(i.handler&&(o=i,i=o.handler,r=o.selector),r&&ut.find.matchesSelector($t,r),i.guid||(i.guid=ut.guid++),(l=g.events)||(l=g.events={}),(s=g.handle)||(s=g.handle=function(t){return void 0!==ut&&ut.event.triggered!==t.type?ut.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(Tt)||[""]).length;c--;)a=di.exec(t[c])||[],p=f=a[1],m=(a[2]||"").split(".").sort(),p&&(h=ut.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=ut.event.special[p]||{},u=ut.extend({type:p,origType:f,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&ut.expr.match.needsContext.test(r),namespace:m.join(".")},o),(d=l[p])||(d=l[p]=[],d.delegateCount=0,h.setup&&!1!==h.setup.call(e,n,m,s)||e.addEventListener&&e.addEventListener(p,s)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),ut.event.global[p]=!0)},remove(e,t,i,n,r){let o,s,a,l,c,u,h,d,p,m,f;const g=Bt.hasData(e)&&Bt.get(e);if(g&&(l=g.events)){for(c=(t=(t||"").match(Tt)||[""]).length;c--;)if(a=di.exec(t[c])||[],p=f=a[1],m=(a[2]||"").split(".").sort(),p){for(h=ut.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,d=l[p]||[],a=a[2]&&new RegExp(`(^|\\.)${m.join("\\.(?:.*\\.|)")}(\\.|$)`),s=o=d.length;o--;)u=d[o],!r&&f!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,m,g.handle)||ut.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)ut.event.remove(e,p+t[c],i,n,!0);ut.isEmptyObject(l)&&Bt.remove(e,"handle events")}},dispatch(e){const t=ut.event.fix(e);let i,n,r,o,s,a;const l=new Array(arguments.length),c=(Bt.get(this,"events")||{})[t.type]||[],u=ut.event.special[t.type]||{};for(l[0]=t,i=1;i<arguments.length;i++)l[i]=arguments[i];if(t.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,t)){for(a=ut.event.handlers.call(this,t,c),i=0;(o=a[i++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,n=0;(s=o.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!1!==s.namespace&&!t.rnamespace.test(s.namespace)||(t.handleObj=s,t.data=s.data,r=((ut.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,l),void 0!==r&&!1===(t.result=r)&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers(e,t){let i,n,r,o,s;const a=[],{delegateCount:l}=t;let c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(o=[],s={},i=0;i<l;i++)n=t[i],r=`${n.selector} `,void 0===s[r]&&(s[r]=n.needsContext?ut(r,this).index(c)>-1:ut.find(r,this,null,[c]).length),s[r]&&o.push(n);o.length&&a.push({elem:c,handlers:o})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp(e,t){Object.defineProperty(ut.Event.prototype,e,{enumerable:!0,configurable:!0,get:rt(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:e=>e[ut.expando]?e:new ut.Event(e),special:{load:{noBubble:!0},click:{setup(e){const t=this||e;return ii.test(t.type)&&t.click&&_t(t,"input")&&_i(t,"click",pi),!1},trigger(e){const t=this||e;return ii.test(t.type)&&t.click&&_t(t,"input")&&_i(t,"click"),!0},_default(e){const{target:t}=e;return ii.test(t.type)&&t.click&&_t(t,"input")&&Bt.get(t,"click")||_t(t,"a")}},beforeunload:{postDispatch(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ut.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},ut.Event=function(e,t){if(!(this instanceof ut.Event))return new ut.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?pi:mi,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ut.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[ut.expando]=!0},ut.Event.prototype={constructor:ut.Event,isDefaultPrevented:mi,isPropagationStopped:mi,isImmediatePropagationStopped:mi,isSimulated:!1,preventDefault(){const e=this.originalEvent;this.isDefaultPrevented=pi,e&&!this.isSimulated&&e.preventDefault()},stopPropagation(){const e=this.originalEvent;this.isPropagationStopped=pi,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation(){const e=this.originalEvent;this.isImmediatePropagationStopped=pi,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ut.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which(e){const{button:t}=e;return null==e.which&&ui.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&hi.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},ut.event.addProp),ut.each({focus:"focusin",blur:"focusout"},((e,t)=>{ut.event.special[e]={setup(){return _i(this,e,fi),!1},trigger(){return _i(this,e),!0},delegateType:t}})),ut.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},((e,t)=>{ut.event.special[e]={delegateType:t,bindType:t,handle(e){let i;const n=e.relatedTarget,{handleObj:r}=e;return n&&(n===this||ut.contains(this,n))||(e.type=r.origType,i=r.handler.apply(this,arguments),e.type=t),i}}})),ut.fn.extend({on(e,t,i,n){return gi(this,e,t,i,n)},one(e,t,i,n){return gi(this,e,t,i,n,1)},off(e,t,i){let n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ut(e.delegateTarget).off(n.namespace?`${n.origType}.${n.namespace}`:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=mi),this.each((function(){ut.event.remove(this,e,i,t)}))}});const yi=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,vi=/<script|<style|<link/i,Ci=/checked\s*(?:[^=]|=\s*.checked.)/i,xi=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function wi(e,t){return _t(e,"table")&&_t(11!==t.nodeType?t:t.firstChild,"tr")&&ut(e).children("tbody")[0]||e}function bi(e){return e.type=`${null!==e.getAttribute("type")}/${e.type}`,e}function Si(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ti(e,t){let i,n,r,o,s,a,l,c;if(1===t.nodeType){if(Bt.hasData(e)&&(o=Bt.access(e),s=Bt.set(t,o),c=o.events,c))for(r in delete s.handle,s.events={},c)for(i=0,n=c[r].length;i<n;i++)ut.event.add(t,r,c[r][i]);Gt.hasData(e)&&(a=Gt.access(e),l=ut.extend({},a),Gt.set(t,l))}}function Ai(e,t){const i=t.nodeName.toLowerCase();"input"===i&&ii.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function Ei(e,t,i,n){let r,o,s,a,l,c;t=Xe.apply([],t);let u=0;const h=e.length,d=h-1,p=t[0],m=rt(p);if(m||h>1&&"string"==typeof p&&!nt.checkClone&&Ci.test(p))return e.each((function(r){const o=e.eq(r);m&&(t[0]=p.call(this,r,o.html())),Ei(o,t,i,n)}));if(h&&(r=ci(t,e[0].ownerDocument,!1,e,n),o=r.firstChild,1===r.childNodes.length&&(r=o),o||n)){for(s=ut.map(si(r,"script"),bi),a=s.length;u<h;u++)l=r,u!==d&&(l=ut.clone(l,!0,!0),a&&ut.merge(s,si(l,"script"))),i.call(e[u],l,u);if(a)for(c=s[s.length-1].ownerDocument,ut.map(s,Si),u=0;u<a;u++)l=s[u],ri.test(l.type||"")&&!Bt.access(l,"globalEval")&&ut.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?ut._evalUrl&&!l.noModule&&ut._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")}):at(l.textContent.replace(xi,""),l,c))}return e}function Pi(e,t,i){let n;const r=t?ut.filter(t,e):e;let o=0;for(;null!=(n=r[o]);o++)i||1!==n.nodeType||ut.cleanData(si(n)),n.parentNode&&(i&&Yt(n)&&ai(si(n,"script")),n.parentNode.removeChild(n));return e}ut.extend({htmlPrefilter:e=>e.replace(yi,"<$1></$2>"),clone(e,t,i){let n,r,o,s;const a=e.cloneNode(!0),l=Yt(e);if(!(nt.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ut.isXMLDoc(e)))for(s=si(a),o=si(e),n=0,r=o.length;n<r;n++)Ai(o[n],s[n]);if(t)if(i)for(o=o||si(e),s=s||si(a),n=0,r=o.length;n<r;n++)Ti(o[n],s[n]);else Ti(e,a);return s=si(a,"script"),s.length>0&&ai(s,!l&&si(e,"script")),a},cleanData(e){let t,i,n;const{special:r}=ut.event;let o=0;for(;void 0!==(i=e[o]);o++)if(kt(i)){if(t=i[Bt.expando]){if(t.events)for(n in t.events)r[n]?ut.event.remove(i,n):ut.removeEvent(i,n,t.handle);i[Bt.expando]=void 0}i[Gt.expando]&&(i[Gt.expando]=void 0)}}}),ut.fn.extend({detach(e){return Pi(this,e,!0)},remove(e){return Pi(this,e)},text(e){return Rt(this,(function(e){return void 0===e?ut.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append(){return Ei(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){wi(this,e).appendChild(e)}}))},prepend(){return Ei(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){const t=wi(this,e);t.insertBefore(e,t.firstChild)}}))},before(){return Ei(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after(){return Ei(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty(){let e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(ut.cleanData(si(e,!1)),e.textContent="");return this},clone(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return ut.clone(this,e,t)}))},html(e){return Rt(this,(function(e){let t=this[0]||{},i=0;const n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!vi.test(e)&&!oi[(ni.exec(e)||["",""])[1].toLowerCase()]){e=ut.htmlPrefilter(e);try{for(;i<n;i++)t=this[i]||{},1===t.nodeType&&(ut.cleanData(si(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith(){const e=[];return Ei(this,arguments,(function(t){const i=this.parentNode;ut.inArray(this,e)<0&&(ut.cleanData(si(this)),i&&i.replaceChild(t,this))}),e)}}),ut.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},((e,t)=>{ut.fn[e]=function(e){let i;const n=[],r=ut(e),o=r.length-1;let s=0;for(;s<=o;s++)i=s===o?this:this.clone(!0),ut(r[s])[t](i),Je.apply(n,i.get());return this.pushStack(n)}}));const Li=new RegExp(`^(${jt})(?!px)[a-z%]+$`,"i"),Di=function(e){let t=e.ownerDocument.defaultView;return t&&t.opener||(t=window),t.getComputedStyle(e)},Mi=new RegExp(qt.join("|"),"i");function Ri(e,t,i){let n,r,o,s;const{style:a}=e;return(i=i||Di(e))&&(s=i.getPropertyValue(t)||i[t],""!==s||Yt(e)||(s=ut.style(e,t)),!nt.pixelBoxStyles()&&Li.test(s)&&Mi.test(t)&&(n=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=r,a.maxWidth=o)),void 0!==s?`${s}`:s}function Ii(e,t){return{get(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(!l)return;a.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",$t.appendChild(a).appendChild(l);const e=window.getComputedStyle(l);i="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),n=36===t(e.width),l.style.position="absolute",r=12===t(l.offsetWidth/3),$t.removeChild(a),l=null}function t(e){return Math.round(parseFloat(e))}let i,n,r,o,s;var a=qe.createElement("div"),l=qe.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",nt.clearCloneStyle="content-box"===l.style.backgroundClip,ut.extend(nt,{boxSizingReliable:()=>(e(),n),pixelBoxStyles:()=>(e(),o),pixelPosition:()=>(e(),i),reliableMarginLeft:()=>(e(),s),scrollboxSize:()=>(e(),r)}))}();const Ni=["Webkit","Moz","ms"],Oi=qe.createElement("div").style,Fi={};function ki(e){const t=ut.cssProps[e]||Fi[e];return t||(e in Oi?e:Fi[e]=function(e){const t=e[0].toUpperCase()+e.slice(1);let i=Ni.length;for(;i--;)if((e=Ni[i]+t)in Oi)return e}(e)||e)}const zi=/^(none|table(?!-c[ea]).+)/,Bi=/^--/,Gi={position:"absolute",visibility:"hidden",display:"block"},Hi={letterSpacing:"0",fontWeight:"400"};function Wi(e,t,i){const n=Vt.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function Ui(e,t,i,n,r,o){let s="width"===t?1:0,a=0,l=0;if(i===(n?"border":"content"))return 0;for(;s<4;s+=2)"margin"===i&&(l+=ut.css(e,i+qt[s],!0,r)),n?("content"===i&&(l-=ut.css(e,`padding${qt[s]}`,!0,r)),"margin"!==i&&(l-=ut.css(e,`border${qt[s]}Width`,!0,r))):(l+=ut.css(e,`padding${qt[s]}`,!0,r),"padding"!==i?l+=ut.css(e,`border${qt[s]}Width`,!0,r):a+=ut.css(e,`border${qt[s]}Width`,!0,r));return!n&&o>=0&&(l+=Math.max(0,Math.ceil(e[`offset${t[0].toUpperCase()}${t.slice(1)}`]-o-l-a-.5))||0),l}function ji(e,t,i){const n=Di(e);let r=(!nt.boxSizingReliable()||i)&&"border-box"===ut.css(e,"boxSizing",!1,n),o=r,s=Ri(e,t,n);const a=`offset${t[0].toUpperCase()}${t.slice(1)}`;if(Li.test(s)){if(!i)return s;s="auto"}return(!nt.boxSizingReliable()&&r||"auto"===s||!parseFloat(s)&&"inline"===ut.css(e,"display",!1,n))&&e.getClientRects().length&&(r="border-box"===ut.css(e,"boxSizing",!1,n),o=a in e,o&&(s=e[a])),s=parseFloat(s)||0,`${s+Ui(e,t,i||(r?"border":"content"),o,n,s)}px`}function Vi(e,t,i,n,r){return new Vi.prototype.init(e,t,i,n,r)}let qi,$i;ut.extend({cssHooks:{opacity:{get(e,t){if(t){const t=Ri(e,"opacity");return""===t?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style(e,t,i,n){if(!e||3===e.nodeType||8===e.nodeType||!e.style)return;let r,o,s;const a=Ft(t),l=Bi.test(t),{style:c}=e;if(l||(t=ki(a)),s=ut.cssHooks[t]||ut.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(r=s.get(e,!1,n))?r:c[t];o=typeof i,"string"===o&&(r=Vt.exec(i))&&r[1]&&(i=Qt(e,t,r),o="number"),null!=i&&i==i&&("number"!==o||l||(i+=r&&r[3]||(ut.cssNumber[a]?"":"px")),nt.clearCloneStyle||""!==i||0!==t.indexOf("background")||(c[t]="inherit"),s&&"set"in s&&void 0===(i=s.set(e,i,n))||(l?c.setProperty(t,i):c[t]=i))},css(e,t,i,n){let r,o,s;const a=Ft(t);return Bi.test(t)||(t=ki(a)),s=ut.cssHooks[t]||ut.cssHooks[a],s&&"get"in s&&(r=s.get(e,!0,i)),void 0===r&&(r=Ri(e,t,n)),"normal"===r&&t in Hi&&(r=Hi[t]),""===i||i?(o=parseFloat(r),!0===i||isFinite(o)?o||0:r):r}}),ut.each(["height","width"],((e,t)=>{ut.cssHooks[t]={get(e,i,n){if(i)return!zi.test(ut.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ji(e,t,n):Zt(e,Gi,(()=>ji(e,t,n)))},set(e,i,n){let r;const o=Di(e),s=!nt.scrollboxSize()&&"absolute"===o.position,a=(s||n)&&"border-box"===ut.css(e,"boxSizing",!1,o);let l=n?Ui(e,t,n,a,o):0;return a&&s&&(l-=Math.ceil(e[`offset${t[0].toUpperCase()}${t.slice(1)}`]-parseFloat(o[t])-Ui(e,t,"border",!1,o)-.5)),l&&(r=Vt.exec(i))&&"px"!==(r[3]||"px")&&(e.style[t]=i,i=ut.css(e,t)),Wi(0,i,l)}}})),ut.cssHooks.marginLeft=Ii(nt.reliableMarginLeft,((e,t)=>{if(t)return`${parseFloat(Ri(e,"marginLeft"))||e.getBoundingClientRect().left-Zt(e,{marginLeft:0},(()=>e.getBoundingClientRect().left))}px`})),ut.each({margin:"",padding:"",border:"Width"},((e,t)=>{ut.cssHooks[e+t]={expand(i){let n=0;const r={},o="string"==typeof i?i.split(" "):[i];for(;n<4;n++)r[e+qt[n]+t]=o[n]||o[n-2]||o[0];return r}},"margin"!==e&&(ut.cssHooks[e+t].set=Wi)})),ut.fn.extend({css(e,t){return Rt(this,((e,t,i)=>{let n,r;const o={};let s=0;if(Array.isArray(t)){for(n=Di(e),r=t.length;s<r;s++)o[t[s]]=ut.css(e,t[s],!1,n);return o}return void 0!==i?ut.style(e,t,i):ut.css(e,t)}),e,t,arguments.length>1)}}),ut.Tween=Vi,Vi.prototype={constructor:Vi,init(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||ut.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(ut.cssNumber[i]?"":"px")},cur(){const e=Vi.propHooks[this.prop];return e&&e.get?e.get(this):Vi.propHooks._default.get(this)},run(e){let t;const i=Vi.propHooks[this.prop];return this.options.duration?this.pos=t=ut.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Vi.propHooks._default.set(this),this}},Vi.prototype.init.prototype=Vi.prototype,Vi.propHooks={_default:{get(e){let t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ut.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set(e){ut.fx.step[e.prop]?ut.fx.step[e.prop](e):1!==e.elem.nodeType||!ut.cssHooks[e.prop]&&null==e.elem.style[ki(e.prop)]?e.elem[e.prop]=e.now:ut.style(e.elem,e.prop,e.now+e.unit)}}},Vi.propHooks.scrollTop=Vi.propHooks.scrollLeft={set(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ut.easing={linear:e=>e,swing:e=>.5-Math.cos(e*Math.PI)/2,_default:"swing"},ut.fx=Vi.prototype.init,ut.fx.step={};const Yi=/^(?:toggle|show|hide)$/,Xi=/queueHooks$/;function Ji(){$i&&(!1===qe.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(Ji):window.setTimeout(Ji,ut.fx.interval),ut.fx.tick())}function Zi(){return window.setTimeout((()=>{qi=void 0})),qi=Date.now()}function Qi(e,t){let i,n=0;const r={height:e};for(t=t?1:0;n<4;n+=2-t)i=qt[n],r[`margin${i}`]=r[`padding${i}`]=e;return t&&(r.opacity=r.width=e),r}function Ki(e,t,i){let n;const r=(en.tweeners[t]||[]).concat(en.tweeners["*"]);let o=0;const{length:s}=r;for(;o<s;o++)if(n=r[o].call(i,t,e))return n}function en(e,t,i){let n,r,o=0;const{length:s}=en.prefilters,a=ut.Deferred().always((()=>{delete l.elem}));var l=function(){if(r)return!1;const t=qi||Zi(),i=Math.max(0,c.startTime+c.duration-t),n=1-(i/c.duration||0);let o=0;const{length:s}=c.tweens;for(;o<s;o++)c.tweens[o].run(n);return a.notifyWith(e,[c,n,i]),n<1&&s?i:(s||a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:ut.extend({},t),opts:ut.extend(!0,{specialEasing:{},easing:ut.easing._default},i),originalProperties:t,originalOptions:i,startTime:qi||Zi(),duration:i.duration,tweens:[],createTween(t,i){const n=ut.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop(t){let i=0;const n=t?c.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)c.tweens[i].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}});const{props:u}=c;for(!function(e,t){let i,n,r,o,s;for(i in e)if(n=Ft(i),r=t[n],o=e[i],Array.isArray(o)&&(r=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),s=ut.cssHooks[n],s&&"expand"in s)for(i in o=s.expand(o),delete e[n],o)i in e||(e[i]=o[i],t[i]=r);else t[n]=r}(u,c.opts.specialEasing);o<s;o++)if(n=en.prefilters[o].call(c,e,u,c.opts),n)return rt(n.stop)&&(ut._queueHooks(c.elem,c.opts.queue).stop=n.stop.bind(n)),n;return ut.map(u,Ki,c),rt(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),ut.fx.timer(ut.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}let tn;ut.Animation=ut.extend(en,{tweeners:{"*":[function(e,t){const i=this.createTween(e,t);return Qt(i.elem,e,Vt.exec(t),i),i}]},tweener(e,t){let i;rt(e)?(t=e,e=["*"]):e=e.match(Tt);let n=0;const{length:r}=e;for(;n<r;n++)i=e[n],en.tweeners[i]=en.tweeners[i]||[],en.tweeners[i].unshift(t)},prefilters:[function(e,t,i){let n,r,o,s,a,l,c,u;const h="width"in t||"height"in t,d=this,p={},{style:m}=e;let f=e.nodeType&&Jt(e),g=Bt.get(e,"fxshow");for(n in i.queue||(s=ut._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((()=>{d.always((()=>{s.unqueued--,ut.queue(e,"fx").length||s.empty.fire()}))}))),t)if(r=t[n],Yi.test(r)){if(delete t[n],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!g||void 0===g[n])continue;f=!0}p[n]=g&&g[n]||ut.style(e,n)}if(l=!ut.isEmptyObject(t),l||!ut.isEmptyObject(p))for(n in h&&1===e.nodeType&&(i.overflow=[m.overflow,m.overflowX,m.overflowY],c=g&&g.display,null==c&&(c=Bt.get(e,"display")),u=ut.css(e,"display"),"none"===u&&(c?u=c:(ti([e],!0),c=e.style.display||c,u=ut.css(e,"display"),ti([e]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===ut.css(e,"float")&&(l||(d.done((()=>{m.display=c})),null==c&&(u=m.display,c="none"===u?"":u)),m.display="inline-block")),i.overflow&&(m.overflow="hidden",d.always((()=>{m.overflow=i.overflow[0],m.overflowX=i.overflow[1],m.overflowY=i.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(f=g.hidden):g=Bt.access(e,"fxshow",{display:c}),o&&(g.hidden=!f),f&&ti([e],!0),d.done((()=>{for(n in f||ti([e]),Bt.remove(e,"fxshow"),p)ut.style(e,n,p[n])}))),l=Ki(f?g[n]:0,n,d),n in g||(g[n]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter(e,t){t?en.prefilters.unshift(e):en.prefilters.push(e)}}),ut.speed=function(e,t,i){const n=e&&"object"==typeof e?ut.extend({},e):{complete:i||!i&&t||rt(e)&&e,duration:e,easing:i&&t||t&&!rt(t)&&t};return ut.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in ut.fx.speeds?n.duration=ut.fx.speeds[n.duration]:n.duration=ut.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){rt(n.old)&&n.old.call(this),n.queue&&ut.dequeue(this,n.queue)},n},ut.fn.extend({fadeTo(e,t,i,n){return this.filter(Jt).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate(e,t,i,n){const r=ut.isEmptyObject(e),o=ut.speed(t,i,n),s=function(){const t=en(this,ut.extend({},e),o);(r||Bt.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop(e,t,i){const n=function(e){const{stop:t}=e;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each((function(){let t=!0,r=null!=e&&`${e}queueHooks`;const{timers:o}=ut,s=Bt.get(this);if(r)s[r]&&s[r].stop&&n(s[r]);else for(r in s)s[r]&&s[r].stop&&Xi.test(r)&&n(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(i),t=!1,o.splice(r,1));!t&&i||ut.dequeue(this,e)}))},finish(e){return!1!==e&&(e=e||"fx"),this.each((function(){let t;const i=Bt.get(this),n=i[`${e}queue`],r=i[`${e}queueHooks`],{timers:o}=ut,s=n?n.length:0;for(i.finish=!0,ut.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish}))}}),ut.each(["toggle","show","hide"],((e,t)=>{const i=ut.fn[t];ut.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(Qi(t,!0),e,n,r)}})),ut.each({slideDown:Qi("show"),slideUp:Qi("hide"),slideToggle:Qi("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},((e,t)=>{ut.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}})),ut.timers=[],ut.fx.tick=function(){let e,t=0;const{timers:i}=ut;for(qi=Date.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||ut.fx.stop(),qi=void 0},ut.fx.timer=function(e){ut.timers.push(e),ut.fx.start()},ut.fx.interval=13,ut.fx.start=function(){$i||($i=!0,Ji())},ut.fx.stop=function(){$i=null},ut.fx.speeds={slow:600,fast:200,_default:400},ut.fn.delay=function(e,t){return e=ut.fx&&ut.fx.speeds[e]||e,t=t||"fx",this.queue(t,((t,i)=>{const n=window.setTimeout(t,e);i.stop=function(){window.clearTimeout(n)}}))},function(){let e=qe.createElement("input");const t=qe.createElement("select").appendChild(qe.createElement("option"));e.type="checkbox",nt.checkOn=""!==e.value,nt.optSelected=t.selected,e=qe.createElement("input"),e.value="t",e.type="radio",nt.radioValue="t"===e.value}();const{attrHandle:nn}=ut.expr;ut.fn.extend({attr(e,t){return Rt(this,ut.attr,e,t,arguments.length>1)},removeAttr(e){return this.each((function(){ut.removeAttr(this,e)}))}}),ut.extend({attr(e,t,i){let n,r;const o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?ut.prop(e,t,i):(1===o&&ut.isXMLDoc(e)||(r=ut.attrHooks[t.toLowerCase()]||(ut.expr.match.bool.test(t)?tn:void 0)),void 0!==i?null===i?void ut.removeAttr(e,t):r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:(e.setAttribute(t,`${i}`),i):r&&"get"in r&&null!==(n=r.get(e,t))?n:(n=ut.find.attr(e,t),null==n?void 0:n))},attrHooks:{type:{set(e,t){if(!nt.radioValue&&"radio"===t&&_t(e,"input")){const i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr(e,t){let i,n=0;const r=t&&t.match(Tt);if(r&&1===e.nodeType)for(;i=r[n++];)e.removeAttribute(i)}}),tn={set:(e,t,i)=>(!1===t?ut.removeAttr(e,i):e.setAttribute(i,i),i)},ut.each(ut.expr.match.bool.source.match(/\w+/g),((e,t)=>{const i=nn[t]||ut.find.attr;nn[t]=function(e,t,n){let r,o;const s=t.toLowerCase();return n||(o=nn[s],nn[s]=r,r=null!=i(e,t,n)?s:null,nn[s]=o),r}}));const rn=/^(?:input|select|textarea|button)$/i,on=/^(?:a|area)$/i;function sn(e){return(e.match(Tt)||[]).join(" ")}function an(e){return e.getAttribute&&e.getAttribute("class")||""}function ln(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(Tt)||[]}ut.fn.extend({prop(e,t){return Rt(this,ut.prop,e,t,arguments.length>1)},removeProp(e){return this.each((function(){delete this[ut.propFix[e]||e]}))}}),ut.extend({prop(e,t,i){let n,r;const o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ut.isXMLDoc(e)||(t=ut.propFix[t]||t,r=ut.propHooks[t]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:e[t]=i:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get(e){const t=ut.find.attr(e,"tabindex");return t?parseInt(t,10):rn.test(e.nodeName)||on.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),nt.optSelected||(ut.propHooks.selected={get(e){const t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set(e){const t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ut.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){ut.propFix[this.toLowerCase()]=this})),ut.fn.extend({addClass(e){let t,i,n,r,o,s,a,l=0;if(rt(e))return this.each((function(t){ut(this).addClass(e.call(this,t,an(this)))}));if(t=ln(e),t.length)for(;i=this[l++];)if(r=an(i),n=1===i.nodeType&&` ${sn(r)} `,n){for(s=0;o=t[s++];)n.indexOf(` ${o} `)<0&&(n+=`${o} `);a=sn(n),r!==a&&i.setAttribute("class",a)}return this},removeClass(e){let t,i,n,r,o,s,a,l=0;if(rt(e))return this.each((function(t){ut(this).removeClass(e.call(this,t,an(this)))}));if(!arguments.length)return this.attr("class","");if(t=ln(e),t.length)for(;i=this[l++];)if(r=an(i),n=1===i.nodeType&&` ${sn(r)} `,n){for(s=0;o=t[s++];)for(;n.indexOf(` ${o} `)>-1;)n=n.replace(` ${o} `," ");a=sn(n),r!==a&&i.setAttribute("class",a)}return this},toggleClass(e,t){const i=typeof e,n="string"===i||Array.isArray(e);return"boolean"==typeof t&&n?t?this.addClass(e):this.removeClass(e):rt(e)?this.each((function(i){ut(this).toggleClass(e.call(this,i,an(this),t),t)})):this.each((function(){let t,r,o,s;if(n)for(r=0,o=ut(this),s=ln(e);t=s[r++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==i||(t=an(this),t&&Bt.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Bt.get(this,"__className__")||""))}))},hasClass(e){let t,i,n=0;for(t=` ${e} `;i=this[n++];)if(1===i.nodeType&&` ${sn(an(i))} `.indexOf(t)>-1)return!0;return!1}});const cn=/\r/g;ut.fn.extend({val(e){let t,i,n;const r=this[0];return arguments.length?(n=rt(e),this.each((function(i){let r;1===this.nodeType&&(r=n?e.call(this,i,ut(this).val()):e,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=ut.map(r,(e=>null==e?"":`${e}`))),t=ut.valHooks[this.type]||ut.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))}))):r?(t=ut.valHooks[r.type]||ut.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(cn,""):null==i?"":i)):void 0}}),ut.extend({valHooks:{option:{get(e){const t=ut.find.attr(e,"value");return null!=t?t:sn(ut.text(e))}},select:{get(e){let t,i,n;const{options:r}=e,o=e.selectedIndex,s="select-one"===e.type,a=s?null:[],l=s?o+1:r.length;for(n=o<0?l:s?o:0;n<l;n++)if(i=r[n],(i.selected||n===o)&&!i.disabled&&(!i.parentNode.disabled||!_t(i.parentNode,"optgroup"))){if(t=ut(i).val(),s)return t;a.push(t)}return a},set(e,t){let i,n;const{options:r}=e,o=ut.makeArray(t);let s=r.length;for(;s--;)n=r[s],(n.selected=ut.inArray(ut.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(e.selectedIndex=-1),o}}}}),ut.each(["radio","checkbox"],(function(){ut.valHooks[this]={set(e,t){if(Array.isArray(t))return e.checked=ut.inArray(ut(e).val(),t)>-1}},nt.checkOn||(ut.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),nt.focusin="onfocusin"in window;const un=/^(?:focusinfocus|focusoutblur)$/,hn=function(e){e.stopPropagation()};ut.extend(ut.event,{trigger(e,t,i,n){let r,o,s,a,l,c,u,h;const d=[i||qe];let p=et.call(e,"type")?e.type:e,m=et.call(e,"namespace")?e.namespace.split("."):[];if(o=h=s=i=i||qe,3!==i.nodeType&&8!==i.nodeType&&!un.test(p+ut.event.triggered)&&(p.indexOf(".")>-1&&(m=p.split("."),p=m.shift(),m.sort()),l=p.indexOf(":")<0&&`on${p}`,(e=e[ut.expando]?e:new ut.Event(p,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp(`(^|\\.)${m.join("\\.(?:.*\\.|)")}(\\.|$)`):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:ut.makeArray(t,[e]),u=ut.event.special[p]||{},n||!u.trigger||!1!==u.trigger.apply(i,t))){if(!n&&!u.noBubble&&!ot(i)){for(a=u.delegateType||p,un.test(a+p)||(o=o.parentNode);o;o=o.parentNode)d.push(o),s=o;s===(i.ownerDocument||qe)&&d.push(s.defaultView||s.parentWindow||window)}for(r=0;(o=d[r++])&&!e.isPropagationStopped();)h=o,e.type=r>1?a:u.bindType||p,c=(Bt.get(o,"events")||{})[e.type]&&Bt.get(o,"handle"),c&&c.apply(o,t),c=l&&o[l],c&&c.apply&&kt(o)&&(e.result=c.apply(o,t),!1===e.result&&e.preventDefault());return e.type=p,n||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(d.pop(),t)||!kt(i)||l&&rt(i[p])&&!ot(i)&&(s=i[l],s&&(i[l]=null),ut.event.triggered=p,e.isPropagationStopped()&&h.addEventListener(p,hn),i[p](),e.isPropagationStopped()&&h.removeEventListener(p,hn),ut.event.triggered=void 0,s&&(i[l]=s)),e.result}},simulate(e,t,i){const n=ut.extend(new ut.Event,i,{type:e,isSimulated:!0});ut.event.trigger(n,null,t)}}),ut.fn.extend({trigger(e,t){return this.each((function(){ut.event.trigger(e,t,this)}))},triggerHandler(e,t){const i=this[0];if(i)return ut.event.trigger(e,t,i,!0)}}),nt.focusin||ut.each({focus:"focusin",blur:"focusout"},((e,t)=>{const i=function(e){ut.event.simulate(t,e.target,ut.event.fix(e))};ut.event.special[t]={setup(){const n=this.ownerDocument||this,r=Bt.access(n,t);r||n.addEventListener(e,i,!0),Bt.access(n,t,(r||0)+1)},teardown(){const n=this.ownerDocument||this,r=Bt.access(n,t)-1;r?Bt.access(n,t,r):(n.removeEventListener(e,i,!0),Bt.remove(n,t))}}}));const{location:dn}=window;let pn=Date.now();const mn=/\?/;ut.parseXML=function(e){let t;if(!e||"string"!=typeof e)return null;try{t=(new window.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||ut.error(`Invalid XML: ${e}`),t};const fn=/\[\]$/,gn=/\r?\n/g,_n=/^(?:submit|button|image|reset|file)$/i,yn=/^(?:input|select|textarea|keygen)/i;function vn(e,t,i,n){let r;if(Array.isArray(t))ut.each(t,((t,r)=>{i||fn.test(e)?n(e,r):vn(`${e}[${"object"==typeof r&&null!=r?t:""}]`,r,i,n)}));else if(i||"object"!==lt(t))n(e,t);else for(r in t)vn(`${e}[${r}]`,t[r],i,n)}ut.param=function(e,t){let i;const n=[],r=function(e,t){const i=rt(t)?t():t;n[n.length]=`${encodeURIComponent(e)}=${encodeURIComponent(null==i?"":i)}`};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!ut.isPlainObject(e))ut.each(e,(function(){r(this.name,this.value)}));else for(i in e)vn(i,e[i],t,r);return n.join("&")},ut.fn.extend({serialize(){return ut.param(this.serializeArray())},serializeArray(){return this.map((function(){const e=ut.prop(this,"elements");return e?ut.makeArray(e):this})).filter((function(){const{type:e}=this;return this.name&&!ut(this).is(":disabled")&&yn.test(this.nodeName)&&!_n.test(e)&&(this.checked||!ii.test(e))})).map((function(e,t){const i=ut(this).val();return null==i?null:Array.isArray(i)?ut.map(i,(e=>({name:t.name,value:e.replace(gn,"\r\n")}))):{name:t.name,value:i.replace(gn,"\r\n")}})).get()}});const Cn=/%20/g,xn=/#.*$/,wn=/([?&])_=[^&]*/,bn=/^(.*?):[ \t]*([^\r\n]*)$/gm,Sn=/^(?:GET|HEAD)$/,Tn=/^\/\//,An={},En={},Pn="*/".concat("*"),Ln=qe.createElement("a");function Dn(e){return function(t,i){let n;"string"!=typeof t&&(i=t,t="*");let r=0;const o=t.toLowerCase().match(Tt)||[];if(rt(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function Mn(e,t,i,n){const r={},o=e===En;function s(a){let l;return r[a]=!0,ut.each(e[a]||[],((e,a)=>{const c=a(t,i,n);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)})),l}return s(t.dataTypes[0])||!r["*"]&&s("*")}function Rn(e,t){let i,n;const r=ut.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((r[i]?e:n||(n={}))[i]=t[i]);return n&&ut.extend(!0,e,n),e}Ln.href=dn.href,ut.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:dn.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(dn.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Pn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ut.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:(e,t)=>t?Rn(Rn(e,ut.ajaxSettings),t):Rn(ut.ajaxSettings,e),ajaxPrefilter:Dn(An),ajaxTransport:Dn(En),ajax(e,t){let i,n,r,o,s,a,l,c,u,h;"object"==typeof e&&(t=e,e=void 0),t=t||{};const d=ut.ajaxSetup({},t),p=d.context||d,m=d.context&&(p.nodeType||p.jquery)?ut(p):ut.event,f=ut.Deferred(),g=ut.Callbacks("once memory");let _=d.statusCode||{};const y={},v={};let C="canceled";var x={readyState:0,getResponseHeader(e){let t;if(l){if(!o)for(o={};t=bn.exec(r);)o[`${t[1].toLowerCase()} `]=(o[`${t[1].toLowerCase()} `]||[]).concat(t[2]);t=o[`${e.toLowerCase()} `]}return null==t?null:t.join(", ")},getAllResponseHeaders:()=>l?r:null,setRequestHeader(e,t){return null==l&&(e=v[e.toLowerCase()]=v[e.toLowerCase()]||e,y[e]=t),this},overrideMimeType(e){return null==l&&(d.mimeType=e),this},statusCode(e){let t;if(e)if(l)x.always(e[x.status]);else for(t in e)_[t]=[_[t],e[t]];return this},abort(e){const t=e||C;return i&&i.abort(t),w(0,t),this}};if(f.promise(x),d.url=`${e||d.url||dn.href}`.replace(Tn,`${dn.protocol}//`),d.type=t.method||t.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(Tt)||[""],null==d.crossDomain){a=qe.createElement("a");try{a.href=d.url,a.href=a.href,d.crossDomain=`${Ln.protocol}//${Ln.host}`!=`${a.protocol}//${a.host}`}catch(e){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ut.param(d.data,d.traditional)),Mn(An,d,t,x),l)return x;for(u in c=ut.event&&d.global,c&&0==ut.active++&&ut.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Sn.test(d.type),n=d.url.replace(xn,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Cn,"+")):(h=d.url.slice(n.length),d.data&&(d.processData||"string"==typeof d.data)&&(n+=(mn.test(n)?"&":"?")+d.data,delete d.data),!1===d.cache&&(n=n.replace(wn,"$1"),h=`${mn.test(n)?"&":"?"}_=${pn++}${h}`),d.url=n+h),d.ifModified&&(ut.lastModified[n]&&x.setRequestHeader("If-Modified-Since",ut.lastModified[n]),ut.etag[n]&&x.setRequestHeader("If-None-Match",ut.etag[n])),(d.data&&d.hasContent&&!1!==d.contentType||t.contentType)&&x.setRequestHeader("Content-Type",d.contentType),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?`, ${Pn}; q=0.01`:""):d.accepts["*"]),d.headers)x.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(!1===d.beforeSend.call(p,x,d)||l))return x.abort();if(C="abort",g.add(d.complete),x.done(d.success),x.fail(d.error),i=Mn(En,d,t,x),i){if(x.readyState=1,c&&m.trigger("ajaxSend",[x,d]),l)return x;d.async&&d.timeout>0&&(s=window.setTimeout((()=>{x.abort("timeout")}),d.timeout));try{l=!1,i.send(y,w)}catch(e){if(l)throw e;w(-1,e)}}else w(-1,"No Transport");function w(e,t,o,a){let u,h,y,v,C,w=t;l||(l=!0,s&&window.clearTimeout(s),i=void 0,r=a||"",x.readyState=e>0?4:0,u=e>=200&&e<300||304===e,o&&(v=function(e,t,i){let n,r,o,s;const{contents:a}=e,{dataTypes:l}=e;for(;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){l.unshift(r);break}if(l[0]in i)o=l[0];else{for(r in i){if(!l[0]||e.converters[`${r} ${l[0]}`]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),i[o]}(d,x,o)),v=function(e,t,i,n){let r,o,s,a,l;const c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(o=u.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift(),o)if("*"===o)o=l;else if("*"!==l&&l!==o){if(s=c[`${l} ${o}`]||c[`* ${o}`],!s)for(r in c)if(a=r.split(" "),a[1]===o&&(s=c[`${l} ${a[0]}`]||c[`* ${a[0]}`],s)){!0===s?s=c[r]:!0!==c[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:`No conversion from ${l} to ${o}`}}}return{state:"success",data:t}}(d,v,x,u),u?(d.ifModified&&(C=x.getResponseHeader("Last-Modified"),C&&(ut.lastModified[n]=C),C=x.getResponseHeader("etag"),C&&(ut.etag[n]=C)),204===e||"HEAD"===d.type?w="nocontent":304===e?w="notmodified":(w=v.state,h=v.data,y=v.error,u=!y)):(y=w,!e&&w||(w="error",e<0&&(e=0))),x.status=e,x.statusText=`${t||w}`,u?f.resolveWith(p,[h,w,x]):f.rejectWith(p,[x,w,y]),x.statusCode(_),_=void 0,c&&m.trigger(u?"ajaxSuccess":"ajaxError",[x,d,u?h:y]),g.fireWith(p,[x,w]),c&&(m.trigger("ajaxComplete",[x,d]),--ut.active||ut.event.trigger("ajaxStop")))}return x},getJSON:(e,t,i)=>ut.get(e,t,i,"json"),getScript:(e,t)=>ut.get(e,void 0,t,"script")}),ut.each(["get","post"],((e,t)=>{ut[t]=function(e,i,n,r){return rt(i)&&(r=r||n,n=i,i=void 0),ut.ajax(ut.extend({url:e,type:t,dataType:r,data:i,success:n},ut.isPlainObject(e)&&e))}})),ut._evalUrl=function(e,t){return ut.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter(e){ut.globalEval(e,t)}})},ut.fn.extend({wrapAll(e){let t;return this[0]&&(rt(e)&&(e=e.call(this[0])),t=ut(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){let e=this;for(;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner(e){return rt(e)?this.each((function(t){ut(this).wrapInner(e.call(this,t))})):this.each((function(){const t=ut(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)}))},wrap(e){const t=rt(e);return this.each((function(i){ut(this).wrapAll(t?e.call(this,i):e)}))},unwrap(e){return this.parent(e).not("body").each((function(){ut(this).replaceWith(this.childNodes)})),this}}),ut.expr.pseudos.hidden=function(e){return!ut.expr.pseudos.visible(e)},ut.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ut.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};const In={0:200,1223:204};let Nn=ut.ajaxSettings.xhr();nt.cors=!!Nn&&"withCredentials"in Nn,nt.ajax=Nn=!!Nn,ut.ajaxTransport((e=>{let t,i;if(nt.cors||Nn&&!e.crossDomain)return{send(n,r){let o;const s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)s[o]=e.xhrFields[o];for(o in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)s.setRequestHeader(o,n[o]);t=function(e){return function(){t&&(t=i=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?r(0,"error"):r(s.status,s.statusText):r(In[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),i=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&window.setTimeout((()=>{t&&i()}))},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort(){t&&t()}}})),ut.ajaxPrefilter((e=>{e.crossDomain&&(e.contents.script=!1)})),ut.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return ut.globalEval(e),e}}}),ut.ajaxPrefilter("script",(e=>{void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),ut.ajaxTransport("script",(e=>{if(e.crossDomain||e.scriptAttrs){let t,i;return{send(n,r){t=ut("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&r("error"===e.type?404:200,e.type)}),qe.head.appendChild(t[0])},abort(){i&&i()}}}}));const On=[],Fn=/(=)\?(?=&|$)|\?\?/;ut.ajaxSetup({jsonp:"callback",jsonpCallback(){const e=On.pop()||`${ut.expando}_${pn++}`;return this[e]=!0,e}}),ut.ajaxPrefilter("json jsonp",((e,t,i)=>{let n,r,o;const s=!1!==e.jsonp&&(Fn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fn.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=rt(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Fn,`$1${n}`):!1!==e.jsonp&&(e.url+=`${(mn.test(e.url)?"&":"?")+e.jsonp}=${n}`),e.converters["script json"]=function(){return o||ut.error(`${n} was not called`),o[0]},e.dataTypes[0]="json",r=window[n],window[n]=function(){o=arguments},i.always((()=>{void 0===r?ut(window).removeProp(n):window[n]=r,e[n]&&(e.jsonpCallback=t.jsonpCallback,On.push(n)),o&&rt(r)&&r(o[0]),o=r=void 0})),"script"})),nt.createHTMLDocument=function(){const{body:e}=qe.implementation.createHTMLDocument("");return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),ut.parseHTML=function(e,t,i){if("string"!=typeof e)return[];let n,r,o;return"boolean"==typeof t&&(i=t,t=!1),t||(nt.createHTMLDocument?(n=(t=qe.implementation.createHTMLDocument("")).createElement("base"),n.href=qe.location.href,t.head.appendChild(n)):t=qe),r=yt.exec(e),o=!i&&[],r?[t.createElement(r[1])]:(r=ci([e],t,o),o&&o.length&&ut(o).remove(),ut.merge([],r.childNodes))},ut.fn.load=function(e,t,i){let n,r,o;const s=this,a=e.indexOf(" ");return a>-1&&(n=sn(e.slice(a)),e=e.slice(0,a)),rt(t)?(i=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&ut.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done((function(e){o=arguments,s.html(n?ut("<div>").append(ut.parseHTML(e)).find(n):e)})).always(i&&((e,t)=>{s.each((function(){i.apply(this,o||[e.responseText,t,e])}))})),this},ut.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],((e,t)=>{ut.fn[t]=function(e){return this.on(t,e)}})),ut.expr.pseudos.animated=function(e){return ut.grep(ut.timers,(t=>e===t.elem)).length},ut.offset={setOffset(e,t,i){let n,r,o,s,a,l,c;const u=ut.css(e,"position"),h=ut(e),d={};"static"===u&&(e.style.position="relative"),a=h.offset(),o=ut.css(e,"top"),l=ut.css(e,"left"),c=("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1,c?(n=h.position(),s=n.top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),rt(t)&&(t=t.call(e,i,ut.extend({},a))),null!=t.top&&(d.top=t.top-a.top+s),null!=t.left&&(d.left=t.left-a.left+r),"using"in t?t.using.call(e,d):h.css(d)}},ut.fn.extend({offset(e){if(arguments.length)return void 0===e?this:this.each((function(t){ut.offset.setOffset(this,e,t)}));let t,i;const n=this[0];return n?n.getClientRects().length?(t=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position(){if(!this[0])return;let e,t,i;const n=this[0];let r={top:0,left:0};if("fixed"===ut.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),i=n.ownerDocument,e=n.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===ut.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&(r=ut(e).offset(),r.top+=ut.css(e,"borderTopWidth",!0),r.left+=ut.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-ut.css(n,"marginTop",!0),left:t.left-r.left-ut.css(n,"marginLeft",!0)}},offsetParent(){return this.map((function(){let{offsetParent:e}=this;for(;e&&"static"===ut.css(e,"position");)e=e.offsetParent;return e||$t}))}}),ut.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},((e,t)=>{const i="pageYOffset"===t;ut.fn[e]=function(n){return Rt(this,((e,n,r)=>{let o;if(ot(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===r)return o?o[t]:e[n];o?o.scrollTo(i?o.pageXOffset:r,i?r:o.pageYOffset):e[n]=r}),e,n,arguments.length)}})),ut.each(["top","left"],((e,t)=>{ut.cssHooks[t]=Ii(nt.pixelPosition,((e,i)=>{if(i)return i=Ri(e,t),Li.test(i)?`${ut(e).position()[t]}px`:i}))})),ut.each({Height:"height",Width:"width"},((e,t)=>{ut.each({padding:`inner${e}`,content:t,"":`outer${e}`},((i,n)=>{ut.fn[n]=function(r,o){const s=arguments.length&&(i||"boolean"!=typeof r),a=i||(!0===r||!0===o?"margin":"border");return Rt(this,((t,i,r)=>{let o;return ot(t)?0===n.indexOf("outer")?t[`inner${e}`]:t.document.documentElement[`client${e}`]:9===t.nodeType?(o=t.documentElement,Math.max(t.body[`scroll${e}`],o[`scroll${e}`],t.body[`offset${e}`],o[`offset${e}`],o[`client${e}`])):void 0===r?ut.css(t,i,a):ut.style(t,i,r,a)}),t,s?r:void 0,s)}}))})),ut.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),((e,t)=>{ut.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}})),ut.fn.extend({hover(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ut.fn.extend({bind(e,t,i){return this.on(e,null,t,i)},unbind(e,t){return this.off(e,null,t)},delegate(e,t,i,n){return this.on(t,e,i,n)},undelegate(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}}),ut.proxy=function(e,t){let i,n,r;if("string"==typeof t&&(i=e[t],t=e,e=i),rt(e))return n=Ye.call(arguments,2),r=function(){return e.apply(t||this,n.concat(Ye.call(arguments)))},r.guid=e.guid=e.guid||ut.guid++,r},ut.holdReady=function(e){e?ut.readyWait++:ut.ready(!0)},ut.isArray=Array.isArray,ut.parseJSON=JSON.parse,ut.nodeName=_t,ut.isFunction=rt,ut.isWindow=ot,ut.camelCase=Ft,ut.type=lt,ut.now=Date.now,ut.isNumeric=function(e){const t=ut.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))};class kn{constructor(e={}){const{text:t,id:i,viewer:n}=e;i&&document.getElementById(i)&&!e.reduplicate&&ut(`#${i}`).remove();const r=document.createElement("div");r.id=C(i,je()),r.className="cursor-tip-class",r.innerHTML=t;const o=n?n.container:document.body;o.appendChild(r),this.ele=r,this._show=C(e.show,!0),this._isDestryoed=!1,this._target=o,this._id=r.id,this._text=t,this._position=void 0;const s=this;this.show=this._show,n instanceof Cesium.Viewer&&(this._handler=new Cesium.ScreenSpaceEventHandler(n.canvas),this._handler.setInputAction((e=>{s.updatePosition(e.endPosition)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE))}updatePosition(e){this.ele.style.left=`${e.x+10}px`,this.ele.style.top=`${e.y+10}px`}updateText(e){this.ele.innerHTML=e}destroy(){this._isDestryoed||(this._target.removeChild(this.ele),this._handler.isDestroyed()&&this._handler.destroy(),this._isDestryoed=!0)}get show(){return this._show}set show(e){this._show=e,this.ele.style.display=e?"block":"none"}get id(){return this._id}get text(){return this._text}set text(e){this._text=e,this.updateText(e)}get position(){return this._position}set position(e){e.x&&e.y?(this._position=e,this.updatePosition(e)):console.warn("CursorTip:设置了一个无效的位置，将被忽略.")}}function zn(e,t){let i;const n={"y+":t.getFullYear().toString(),"m+":(t.getMonth()+1).toString(),"d+":t.getDate().toString(),"H+":t.getHours().toString(),"M+":t.getMinutes().toString(),"S+":t.getSeconds().toString()},r=Object.keys(n);for(const t of r)i=new RegExp(`(${t})`).exec(e),i&&(e=e.replace(i[1],1===i[1].length?n[t]:n[t].padStart(i[1].length,"0")));return e}function Bn(){return!0}function Gn(e,t){function i(){}const n=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertyNames(Object.getPrototypeOf(e))];for(var r of n)"function"==typeof e[r]&&(e[r]=i);e.isDestroyed=Bn}window.Date.prototype.format=function(e){zn(e,this)};class Hn{constructor(e){this._options=C(e,{}),this._id=C(e.id,Ue()),this._primitive=null,this._oldPrimitive=null,this._definedChanged=new I,this._loadEvent=new I,this._clampToGround=C(!!e.clampToGround,!1),this._show=C(e.show,!0),this._removed=!1,this._allowPicking=C(e.allowPicking,!0),this._property=e.property}get id(){return this._id}get property(){return this._property}get allowPicking(){return this._allowPicking}set allowPicking(e){!!e!==this._allowPicking&&(this.definedChanged.raise("allowPicking",e,this._allowPicking),this._allowPicking=e,this.updatePrimitive&&this.updatePrimitive())}get clampToGround(){return this._clampToGround}set clampToGround(e){e!==this._clampToGround&&(this.definedChanged.raise("clampToGround",e,this._clampToGround),this._clampToGround=e,this.updatePrimitive())}get show(){return this._show}set show(e){e!==this._show&&(this.definedChanged.raise("show",e,this._show),this._show=e,this.primitive&&(this.primitive.show=e))}get primitive(){return this._primitive}get definedChanged(){return this._definedChanged}get readyPromise(){return this.primitive?this.primitive.readyPromise:new Primise}get material(){if(this.primitive)return this.primitive.appearance.material}toJson(){if(x(this.primitive))return JSON.parse(JSON.stringify(this._options))}update(){}updateAttribute(e,t){if(this.isDestroyed())return;if(!this.primitive)return;const i=this.primitive.appearance.material;if(!i)return;const n=i.uniforms;n&&(n[e]=t)}addTo(e){x(this.primitive)&&e.graphicGroup.add(this)}zoomTo(){}remove(){if(x(this.primitive))return this.group?(this.group.remove(this),this):void 0}isDestroyed(){return!1}destroy(){this.remove(),this.primitive&&!this.primitive.isDestroyed()&&(this.primitive.destroy(),this.primitive=void 0),Cesium.destroyObject(this)}}const{AssociativeArray:Wn,PrimitiveCollection:Un}=Cesium;class jn{constructor(e){this.values=new Wn,this.id=Ue(),this.viewer=e,this.root=new Un,this.root.name="graphicGroup",e.scene.primitives.add(this.root)}add(e){e instanceof jn&&(this.values.set(e.id,e),this.root.add(e.root)),e instanceof Hn&&(this.values.set(e.id,e),e.primitive&&this.root.add(e.primitive),e._viewer=this.viewer,e.group=this,e._loadEvent.raise())}get(e){return this.values.get(e)}getById(e){return this.get(e)}remove(e){this.values.remove(e.id),e instanceof jn&&(e.clear(),this.root.remove(e.root)),e.primitive&&this.root.remove(e.primitive)}removeById(e){const t=this.values.get(e);this.remove(t)}has(e){return this.values.contains(e)}update(e){const t=this.values._array;for(let i of t)i.update(e)}clear(){const e=[...this.values._array];for(let t of e)t.destroy();this.root.removeAll(),this.values.removeAll()}}const Vn="uniform samplerCube u_cubeMap;\n  varying vec3 v_texCoord;\n  void main()\n  {\n  vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n  gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n  }\n  ",qn="attribute vec3 position;\n  varying vec3 v_texCoord;\n  uniform mat3 u_rotateMatrix;\n  void main()\n  {\n  vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n  gl_Position = czm_projection * vec4(p, 1.0);\n  v_texCoord = position.xyz;\n  }\n  ",{defaultValue:$n,destroyObject:Yn,Matrix4:Xn,DrawCommand:Jn,BoxGeometry:Zn,Cartesian3:Qn,defined:Kn,GeometryPipeline:er,Transforms:tr,VertexFormat:ir,BufferUsage:nr,CubeMap:rr,loadCubeMap:or,RenderState:sr,VertexArray:ar,BlendingState:lr,SceneMode:cr,ShaderProgram:ur,ShaderSource:hr,Matrix3:dr}=Cesium;Cesium;class pr extends Hn{constructor(e){if(e.el instanceof HTMLElement==!1)throw new t("options.el parameter is invalid.");super(e),this._clampToGround=void 0,this._asynchronous=void 0,this._distanceDisplayCondition=e.distanceDisplayCondition,this.createGraphic()}get clampToGround(){}set clampToGround(e){throw new t("HtmlPointGraphic is not support clampToGround.")}get asynchronous(){}set asynchronous(e){throw new t("HtmlPointGraphic is not support asynchronous.")}get color(){}set color(e){throw new t("HtmlPointGraphic is not support color.")}set show(e){this.el&&(this.display=e?"block":"none"),this._show=e}get distanceDisplayCondition(){return this._distanceDisplayCondition}set distanceDisplayCondition(e){this._distanceDisplayCondition=e}get position(){return this._position}set position(e){this._definedChanged.raise("position",e,this._position),this._position=e}createGraphic(){this.el=this._options.el,this.el.id=this._id,this.el.style.position="absolute",this._position=this._options.position,this.updatePrimitive()}updatePrimitive(){this._allowPicking?this.el.style.pointerEvents="auto":this.el.style.pointerEvents="none"}addTo(e){defined(this.primitive)&&e.htmlGraphicGroup.add(this)}remove(){if(this.group)return this.group.remove(this),this}zoomTo(){if(this._viewer)return this._viewer.flyTo(this.position)}updateStyle(e,t){this.el.style[e]=t}addClass(e){this.el.classList.add(e)}}const{Cartesian2:mr,Rectangle:fr,GeographicProjection:gr,Ellipsoid:_r}=Cesium,yr=Cesium.Math;function vr(e){e=C(e,C.EMPTY_OBJECT),this._ellipsoid=C(e.ellipsoid,_r.WGS84),this._rectangle=C(e.rectangle,fr.MAX_VALUE),this._projection=new gr(this._ellipsoid),this._numberOfLevelZeroTilesX=36,this._numberOfLevelZeroTilesY=18,this._intervalOfZeorLevel=C(e.intervalOfZeorLevel,16)}Object.defineProperties(vr.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),vr.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},vr.prototype.modifyLevel=function(e){return e<3?0:e<6?1:void 0},vr.prototype.getDelatXY=function(e){const t=this._intervalOfZeorLevel;return{dx:t/2**e,dy:t/2**e}},vr.prototype.getLonLatValue=function(e,t,i){const n=this.getDelatXY(e);return{lon:n.dx*t-180,lat:90-n.dy*i}},vr.prototype.getPosition=function(e,t,i){const n=this._rectangle,r=this.getNumberOfXTilesAtLevel(e),o=this.getNumberOfYTilesAtLevel(e),s=n.width/r,a=t*s+n.west;n.west;const l=n.height/o,c=n.north-i*l;return n.north,{lon:+yr.toDegrees(a).toFixed(5),lat:+yr.toDegrees(c).toFixed(5)}},vr.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},vr.prototype.rectangleToNativeRectangle=function(e,t){const i=yr.toDegrees(e.west),n=yr.toDegrees(e.south),r=yr.toDegrees(e.east),o=yr.toDegrees(e.north);return x(t)?(t.west=i,t.south=n,t.east=r,t.north=o,t):new fr(i,n,r,o)},vr.prototype.tileXYToNativeRectangle=function(e,t,i,n){const r=this.tileXYToRectangle(e,t,i,n);return r.west=yr.toDegrees(r.west),r.south=yr.toDegrees(r.south),r.east=yr.toDegrees(r.east),r.north=yr.toDegrees(r.north),r},vr.prototype.tileXYToRectangle=function(e,t,i,n){var r=this._rectangle,o=this.getNumberOfXTilesAtLevel(i),s=this.getNumberOfYTilesAtLevel(i),a=r.width/o,l=e*a+r.west,c=(e+1)*a+r.west,u=r.height/s,h=r.north-t*u,d=r.north-(t+1)*u;return x(n)||(n=new fr(l,d,c,h)),n.west=l,n.south=d,n.east=c,n.north=h,n},vr.prototype.positionToTileXY=function(e,t,i){var n=this._rectangle;if(fr.contains(n,e)){var r=this.getNumberOfXTilesAtLevel(t),o=this.getNumberOfYTilesAtLevel(t),s=n.width/r,a=n.height/o,l=e.longitude;n.east<n.west&&(l+=yr.TWO_PI);var c=(l-n.west)/s|0;c>=r&&(c=r-1);var u=(n.north-e.latitude)/a|0;return u>=o&&(u=o-1),x(i)?(i.x=c,i.y=u,i):new mr(c,u)}};const{CesiumTerrainProvider:Cr,TerrainProvider:xr,Resource:wr,CustomDataSource:br,Cartesian3:Sr,Entity:Tr,Color:Ar,Rectangle:Er}=Cesium;function Pr(e){let t=[];const i=[e.bounds.west,e.bounds.south,e.bounds.east,e.bounds.north];return"EPSG:4326"===e.projection.toUpperCase()&&(t=[i[0],i[1],i[0],i[3],i[2],i[3],i[2],i[1],i[0],i[1]]),new Tr({polyline:{positions:Sr.fromRadiansArray(t),material:Ar.fromRandom({alpha:1}),width:3,clampToGround:!0}})}function Lr(e,t){const i=wr.createIfNeeded(t);i.appendForwardSlash();return i.getDerivedResource({url:"layer.json"}).fetchJson().then((t=>{e.projection=t.projection,e.bounds=Er.fromDegrees(...t.valid_bounds)}))}function Dr(e,t,i=!0){let n;t.scene.globe.ellipsoid;const r=t.camera.getPickRay(e);n=t.scene.globe.pick(r,t.scene);return function(e){if(!e)return!1;if(e.primitive instanceof Cesium.Model||e.primitive instanceof Cesium.Cesium3DTileset)return!0;return!1}(t.scene.pick(e))&&i&&(t.scene.pickPositionSupported?n=t.scene.pickPosition(e)||n:console.warn("This browser does not support pickPosition.")),n}const Mr=52.35987755982988,Rr=3.141592653589793,Ir=6378245,Nr=.006693421622965943;function Or(e,t){let i=this.transformLng(e-105,t-35),n=this.transformLat(e-105,t-35);const r=t/180*Rr;let o=Math.sin(r);o=1-Nr*o*o;const s=Math.sqrt(o);return i=180*i/(Ir/s*Math.cos(r)*Rr),n=180*n/(Ir*(1-Nr)/(o*s)*Rr),[i,n]}const Fr={};function kr(e,t=!1){const i=`_${e}`;return{configurable:t,get(){return this[i]},set(t){const n=this[i];t!==n&&(this[i]=t,this._definitionChanged.raise(e,t,n))}}}Fr.get=function(e="EPSG:3857",i){const n=e.toUpperCase();if("EPSG:3857"===n)return new Cesium.WebMercatorTilingScheme(i);if("EPSG:4326"===n)return new Cesium.GeographicTilingScheme(i);throw new t("未知的坐标系.")},Fr.BD09ToGCJ02=function(e,t){const i=+e-.0065,n=+t-.006,r=Math.sqrt(i*i+n*n)-2e-5*Math.sin(n*Mr),o=Math.atan2(n,i)-3e-6*Math.cos(i*Mr);return[r*Math.cos(o),r*Math.sin(o)]},Fr.GCJ02ToBD09=function(e,t){t=+t,e=+e;const i=Math.sqrt(e*e+t*t)+2e-5*Math.sin(t*Mr),n=Math.atan2(t,e)+3e-6*Math.cos(e*Mr);return[i*Math.cos(n)+.0065,i*Math.sin(n)+.006]},Fr.WGS84ToGCJ02=function(e,t){if(t=+t,e=+e,w.inChina(e,t)){const i=Or(e,t);return[e+i[0],t+i[1]]}return[e,t]},Fr.GCJ02ToWGS84=function(e,t){if(t=+t,e=+e,w.inChina(e,t)){const i=Or(e,t);return[2*e-(e+i[0]),2*t-(t+i[1])]}return[e,t]};class zr{constructor(e={}){this._definitionChange=new I,this._propertyNames=[];for(const t in e)e.hasOwnProperty(t)&&(this[`_${t}`]=e[t],this._propertyNames.push(t),Object.defineProperty(this,t,kr(t)))}get propertyNames(){return this._propertyNames}addProperty(e,i){if(!x(e))throw new t("key is reqiured.");if(this.propertyNames.includes(e))throw new t(`${e}has be a registered property.`);this[`_${e}`]=i,this._propertyNames.push(e),Object.defineProperty(this,e,kr(e))}removeProperty(e){if(!x(e))throw new t("key is reqiured.");if(this.propertyNames.includes(e)){delete this[e],delete this[`_${e}`];const t=this.propertyNames.indexOf(e);this.propertyNames.slice(t,1),this.definitionChanged.raise(e)}}toString(){const e=this.toJson();return JSON.stringify(e)}toJson(){const e={};for(const t of this.propertyNames)e[t]=this[t];return e}hasProperty(e){if(!x(e))throw new t("key is reqiured.");return this.propertyNames.includes(e)}get definitionChanged(){return this._definitionChanged}destroy(){this._definitionChanged=void 0,this._propertyNames=void 0}}function Br(e,t=!0){he(e),e.scene.screenSpaceCameraController.enableRotate=t}const{Color:Gr}=Cesium;class Hr{constructor(){}static pointColor=Gr.AQUA;static fillColor=Gr.AQUA;static strokeColor=Gr.AQUA}const Wr=Object.freeze({LEFT:-1,RIGHT:1,NONE:0,TOP:-10,BOTTOM:10}),Ur="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nvarying float v_polylineAngle;\n\nconst float maskLength = 16.0;\n\nmat2 rotate(float rad) {\n    float c = cos(rad);\n    float s = sin(rad);\n    return mat2(\n        c, s,\n        -s, c\n    );\n}\n\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\n    float slope = (p0.y - p1.y) / (p0.x - p1.x);\n    return slope * (x - p0.x) + p0.y;\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n#ifdef GL_OES_standard_derivatives\n    float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;\n#else\n    float base = 0.975; // 2.5% of the line will be the arrow head\n#endif\n    // 没有箭头\n    base = 1.0;\n\n    vec2 center = vec2(1.0, 0.5);\n    float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\n    float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\n\n    float halfWidth = 0.15;\n    float s = step(0.5 - halfWidth, st.t);\n    s *= 1.0 - step(0.5 + halfWidth, st.t);\n    s *= 1.0 - step(base, st.s);\n\n    float t = step(base, materialInput.st.s);\n    t *= 1.0 - step(ptOnUpperLine, st.t);\n    t *= step(ptOnLowerLine, st.t);\n\n    // Find the distance from the closest separator (region between two colors)\n    float dist;\n    if (st.s < base)\n    {\n        float d1 = abs(st.t - (0.5 - halfWidth));\n        float d2 = abs(st.t - (0.5 + halfWidth));\n        dist = min(d1, d2);\n    }\n    else\n    {\n        float d1 = czm_infinity;\n        if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n        {\n            d1 = abs(st.s - base);\n        }\n        float d2 = abs(st.t - ptOnUpperLine);\n        float d3 = abs(st.t - ptOnLowerLine);\n        dist = min(min(d1, d2), d3);\n    }\n\n    vec4 outsideColor = vec4(0.0);\n    vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\n    vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\n    // dash\n    vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\n    // Get the relative position within the dash from 0 to 1\n    float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));\n    // Figure out the mask index.\n    float maskIndex = floor(dashPosition * maskLength);\n    // Test the bit mask.\n    float maskTest = floor(dashPattern / pow(2.0, maskIndex));\n    vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\n    if (fragColor.a < 0.005) {   // matches 0/255 and 1/255\n        discard;\n    }\n    outColor *= fragColor;\n    outColor = czm_gammaCorrect(outColor);\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n    return material;\n}\n",{Transforms:jr,Cartesian3:Vr}=Cesium;let qr=class{constructor(e={}){if(!x(e.modelMatrix)&&x(e.position)){let t;e.position instanceof Vr?t=e.position:e.position instanceof w&&(t=e.position.toCartesian()),t&&(e.modelMatrix=jr.eastNorthUpToFixedFrame(t))}if(x(e.gltf))this.delegate=new Cesium.Model(e);else{if(!x(e.url))throw new t("one of parameters url or gltf must be provided.");this.delegate=Cesium.Model.fromGltf(e)}this._readyPromise=this.delegate._readyPromise,this._ready=this.delegate._ready}get ready(){return this._ready}get readyPromise(){return this._readyPromise}get activeAnimations(){return this.delegate.activeAnimations}set activeAnimations(e){this.delegate.activeAnimations=e}get allowPicking(){return this.delegate.allowPicking}get asynchronous(){return this.delegate.asynchronous}get backFaceCulling(){return this.delegate.backFaceCulling}get basePath(){return this.delegate.basePath}get boundingSphere(){return this.delegate.boundingSphere}get clippingPlanes(){return this.delegate.clippingPlanes}set clippingPlanes(e){this.delegate.clippingPlanes=e}get color(){return this.delegate.color}set color(e){this.delegate.color=e}get colorBlendMode(){return this.delegate.colorBlendMode}set colorBlendMode(e){this.delegate.colorBlendMode=e}get colorBlendAmount(){return this.delegate.colorBlendAmount}set colorBlendAmount(e){this.delegate.colorBlendAmount=e}get credit(){return this.delegate.credit}set credit(e){this.delegate.credit=e}get debugShowBoundingVolume(){return this.delegate.debugShowBoundingVolume}set debugShowBoundingVolume(e){this.delegate.debugShowBoundingVolume=e}get debugWireframe(){return this.delegate.debugWireframe}set debugWireframe(e){this.delegate.debugWireframe=e}get distanceDisplayCondition(){return this.delegate.distanceDisplayCondition}set distanceDisplayCondition(e){this.delegate.distanceDisplayCondition=e}get gltf(){return this.delegate.gltf}get id(){return this.delegate.id}set id(e){this.delegate.id=e}get maximumScale(){return this.delegate.maximumScale}set maximumScale(e){this.delegate.maximumScale=e}get minimumPixelSize(){return this.delegate.minimumPixelSize}set minimumPixelSize(e){this.delegate.minimumPixelSize=e}get modelMatrix(){return this.delegate.modelMatrix}set modelMatrix(e){this.delegate.modelMatrix=e}get scale(){return this.delegate.scale}set scale(e){this.delegate.scale=e}get shadows(){return this.delegate.shadows}set shadows(e){this.delegate.shadows=e}get show(){return this.delegate.show}set show(e){this.delegate.show=e}get showOutline(){return this.delegate.showOutline}get silhouetteColor(){return this.delegate.silhouetteColor}set silhouetteColor(e){this.delegate.silhouetteColor=e}get silhouetteSize(){return this.delegate.silhouetteSize}set silhouetteSize(e){this.delegate.silhouetteSize=e}static silhouetteSupported(e){return Cesium.Model.silhouetteSupported(e.scene)}destroy(){this.delegate.destroy()}isDestroyed(){this.delegate.isDestroyed()}getMaterial(e){return this.delegate.getMaterial(e)}getMesh(e){return this.delegate.getMesh(e)}getNode(e){return this.delegate.getNode(e)}get sceneGraph(){return this.delegate.sceneGraph}get rootNodes(){if(this.delegate._runtime)return this.delegate._runtime.rootNodes;return this.sceneGraph._rootNodes.map((e=>this.nodes[e]))}get nodes(){return this.nodesByName}get materials(){return this.delegate._runtime?this.delegate._runtime.materialsByName:[]}get meshs(){return this.delegate._runtime?this.delegate._runtime.meshesByName:[]}get nodesByName(){return this.delegate._nodesByName||this.delegate_runtime}};const{PrimitiveCollection:$r,PolylineCollection:Yr,Material:Xr,Color:Jr,defaultValue:Zr,Cartesian3:Qr,Cartesian2:Kr,Matrix4:eo,Matrix3:to,Quaternion:io,PointPrimitiveCollection:no,ScreenSpaceEventHandler:ro,ScreenSpaceEventType:oo,Polyline:so,Primitive:ao,Math:lo,Plane:co,Model:uo,IntersectionTests:ho,Transforms:po}=Cesium,mo=new Qr,fo=new io,go=new to,_o=new Qr;new Qr;const yo=new eo,vo=new eo;function Co(e,t){e instanceof so?e.material.uniforms.color=t:e instanceof ao&&(e.appearance.material.uniforms.color=t)}function xo(e,t){const i=new Qr,n=viewer.camera.getPickRay(e),r=new co(Qr.UNIT_X,0);return co.fromPointNormal(t.center,t.activePrimitive.normal,r),co.transform(r,t._modelMatrix,r),ho.rayPlane(n,r,i),eo.multiplyByPoint(t._inverseModelMatrix,i,i),i}const wo=new Kr,bo=new Kr;function So(e,t,i,n){const r=e.activePrimitive.relativeAxis||[e.activePrimitive];if(!Array.isArray(r))return;const o=e._viewer.camera.positionCartographic.height/1047;for(let l of r){const r=l.positions.map((t=>eo.multiplyByPoint(e._modelMatrix,t,new Qr))).map((t=>w.toPixel(t,e._viewer.scene))),c=(s=Kr.subtract(...r,wo),a=Kr.subtract(i,t,bo),Kr.normalize(s,s),Kr.dot(s,a));n[l.axis.toLowerCase()]=c*o}var s,a;return n}const To="None",Ao="T",Eo="R",Po="S";class Lo extends Cesium.UrlTemplateImageryProvider{constructor(e){"string"==typeof e&&(e={url:e}),e.getFeatureInfoFormats=C(e.getFeatureInfoFormats,Lo.defaultFeatureInfoFormats),super(e)}get url(){return super.url}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get rectangle(){return super.rectangle}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return super.enablePickFeatures}set enablePickFeatures(e){super.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}}function Do(){return new Lo({url:we.buildModuleUrl("assets/tiles/{z}/{x}/{y}.png"),maximumLevel:4})}Lo.defaultFeatureInfoFormats=Object.freeze([Object.freeze(new Cesium.GetFeatureInfoFormat("json","application/json")),Object.freeze(new Cesium.GetFeatureInfoFormat("xml","text/xml")),Object.freeze(new Cesium.GetFeatureInfoFormat("text","text/html"))]);const{defined:Mo,defaultValue:Ro,ColorMaterialProperty:Io,ConstantPositionProperty:No,ConstantProperty:Oo,DataSource:Fo,PolygonGraphics:ko,PolylineGraphics:zo,EntityCluster:Bo,PinBuilder:Go,createGuid:Ho,Cartesian3:Wo,PointGraphics:Uo,ArcType:jo,PolygonHierarchy:Vo,Color:qo,EntityCollection:$o,HeightReference:Yo,Resource:Xo,describe:Jo,Event:Zo}=Cesium,Qo={small:24,medium:48,large:64},Ko={},es={},ts={"urn:ogc:def:crs:OGC:1.3:CRS84":xs,"EPSG:4326":xs,"urn:ogc:def:crs:EPSG::4326":xs},is=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"],ns={Feature:as,FeatureCollection:function(e,t,i,n,r){for(var o=t.features,s=0,a=o.length;s<a;s++)as(e,o[s],void 0,n,r)},GeometryCollection:ls,LineString:ms,MultiLineString:fs,MultiPoint:hs,MultiPolygon:ys,Point:us,Polygon:_s,Topology:vs},rs={GeometryCollection:ls,LineString:ms,MultiLineString:fs,MultiPoint:hs,MultiPolygon:ys,Point:us,Polygon:_s,Topology:vs};function os(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=t(e[n]);return i}function ss(e,t,i){var n=e.id;if(Mo(n)&&"Feature"===e.type){for(var r=2,o=n;Mo(t.getById(o));)o=n+"_"+r,r++;n=o}else n=Ho();var s=t.getOrCreateEntity(n),a=e.properties;if(Mo(a)){var l;s.properties=a;var c=a.title;if(Mo(c))s.name=c,l="title";else{var u=Number.MAX_VALUE;for(var h in a)if(a.hasOwnProperty(h)&&a[h]){var d=h.toLowerCase();if(u>1&&"title"===d){u=1,l=h;break}u>2&&"name"===d?(u=2,l=h):u>3&&/title/i.test(h)?(u=3,l=h):u>4&&/name/i.test(h)&&(u=4,l=h)}Mo(l)&&(s.name=a[l])}var p=a.description;null!==p&&(s.description=Mo(p)?new Oo(p):i(a,l))}return s}function as(e,i,n,r,o){if(null!==i.geometry){if(!Mo(i.geometry))throw new t("feature.geometry is required.");var s=i.geometry.type,a=rs[s];if(!Mo(a))throw new t("Unknown geometry type: "+s);a(e,i,i.geometry,r,o)}else ss(i,e._entityCollection,o.describe)}function ls(e,i,n,r,o){for(var s=n.geometries,a=0,l=s.length;a<l;a++){var c=s[a],u=c.type,h=rs[u];if(!Mo(h))throw new t("Unknown geometry type: "+u);h(e,i,c,r,o)}}function cs(e,t,i,n,r){let o=r.pointSize,s=r.pointColor;const a=t.properties;if(Mo(a)){const e=a["point-color"];Mo(e)&&(s=qo.fromCssColorString(e)),o=Ro(Qo[a["point-size"]],o)}const l=new Uo;2===n.length&&r.clampToGround&&(l.heightReference=Yo.CLAMP_TO_GROUND);const c=ss(t,e._entityCollection,r.describe);c.point=l,c.point.color=s,c.point.pixelSize=o,c.position=new No(i(n))}function us(e,t,i,n,r){cs(e,t,n,i.coordinates,r)}function hs(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)cs(e,t,n,o[s],r)}function ds(e,t,i,n,r){const o=r.lineColor,s=r.lineWidth,a=t.properties;if(Mo(a)){const e=a["stroke-width"];let t;Mo(e)&&(s=new Oo(e));let i=a.stroke;Mo(i)&&(t=qo.fromCssColorString(i));let n=a["stroke-opacity"];Mo(n)&&1!==n&&(Mo(t)||(t=o.color.clone()),t.alpha=n),Mo(t)&&(o=new Io(t))}const l=ss(t,e._entityCollection,r.describe),c=new zo;l.polyline=c,c.clampToGround=r.clampToGround,c.material=o,c.width=s,c.positions=new Oo(os(n,i)),c.arcType=jo.RHUMB}function ps(e,t){var i="";for(var n in e)if(e.hasOwnProperty(n)){if(n===t||-1!==is.indexOf(n))continue;var r=e[n];Mo(r)&&(i+="object"==typeof r?"<tr><th>"+n+"</th><td>"+ps(r)+"</td></tr>":"<tr><th>"+n+"</th><td>"+r+"</td></tr>")}return i.length>0&&(i='<table class="cesium-infoBox-defaultTable"><tbody>'+i+"</tbody></table>"),i}function ms(e,t,i,n,r){ds(e,t,n,i.coordinates,r)}function fs(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)ds(e,t,n,o[s],r)}function gs(e,t,i,n,r){if(0===n.length||0===n[0].length)return;let o=r.outlineColor.color,s=r.fill,a=r.outlineWidth;const l=t.properties;if(Mo(l)){const e=l["stroke-width"];let t;Mo(e)&&(a=new Oo(e));const i=l.stroke;Mo(i)&&(t=qo.fromCssColorString(i));let n,c=l["stroke-opacity"];Mo(c)&&1!==c&&(Mo(t)||(t=r.outlineColor.color.clone()),t.alpha=c),Mo(t)&&(o=new Oo(t));const u=l.fill;Mo(u)&&(n=qo.fromCssColorString(u),n.alpha=s.color.alpha),c=l["fill-opacity"],Mo(c)&&c!==s.color.alpha&&(Mo(n)||(n=s.color.clone()),n.alpha=c),Mo(n)&&(s=new Io(n))}const c=new ko;c.outline=new Oo(r.outline),c.outlineColor=o,c.outlineWidth=a,c.material=s,c.arcType=jo.RHUMB;const u=r.extrudedHeight;if(u)if("number"==typeof u)c.extrudedHeight=u;else if("string"==typeof u){const e=u.match(/\$\{\s*.*?\s*\}/gi);if(e){let t=u;for(let i of e){const e=/\$\{\s*(.*?)\s*\}/gi.exec(i);Mo(e)&&Mo(e[1])&&(t=t.replace(i,l[e[1]]))}try{const e=window.eval(t);"number"==typeof e&&(c.extrudedHeight=e)}catch(e){}}}const h=[];for(var d=1,p=n.length;d<p;d++)h.push(new Vo(os(n[d],i)));const m=n[0];c.hierarchy=new Oo(new Vo(os(m,i),h)),m[0].length>2?c.perPositionHeight=new Oo(!0):r.clampToGround||(c.height=0);ss(t,e._entityCollection,r.describe).polygon=c}function _s(e,t,i,n,r){gs(e,t,n,i.coordinates,r)}function ys(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)gs(e,t,n,o[s],r)}function vs(e,t,i,n,r){for(var o in i.objects)if(i.objects.hasOwnProperty(o)){var s=topojson.feature(i,i.objects[o]);(0,ns[s.type])(e,s,s,n,r)}}function Cs(e,t){return new Cesium.CallbackProperty(function(e,t,i){var n;return function(r,o){return Mo(n)||(n=e(t,i)),n}}(ps,e,t),!0)}function xs(e){return Wo.fromDegrees(e[0],e[1],e[2])}class ws{constructor(e){this._name=e,this._changed=new Zo,this._error=new Zo,this._isLoading=!1,this._loading=new Zo,this._entityCollection=new $o(this),this._promises=[],this._pinBuilder=new Go,this._entityCluster=new Bo,this._credit=void 0,this._resourceCredits=[]}static pointSize=5;static pointColor=qo.ROYALBLUE;static lineColor=qo.YELLOW;static fill=qo.fromBytes(255,255,0,100);static outline=!0;static outlineColor=qo.YELLOW;static lineWidth=2;static clampToGround=!1;static outlineWidth=1;static crsNames(){return ts}static crsLinkHrefs(){return Ko}static crsLinkTypes(){return es}get entities(){return this._entityCollection}get name(){return this._name}set name(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}get clock(){}get isLoading(){return this._isLoading}get changedEvent(){return this._changed}get errorEvent(){return this._error}get loadingEvent(){return this._loading}get show(){return this._entityCollection.show}set show(e){this._entityCollection.show=e}get clustering(){return this._entityCluster}set clustering(e){this._entityCluster=e}get credit(){return this._credit}load(e,i){Fo.setLoading(this,!0);let n=(i=Ro(i,{})).credit;"string"==typeof n&&(n=new Credit(n)),this._credit=n;let r=e,o=i.sourceUri;if("string"==typeof e||e instanceof Xo){r=(e=Xo.createIfNeeded(e)).fetchJson(),o=Ro(o,e.getUrlComponent());const t=this._resourceCredits,i=e.credits;if(Mo(i)){const e=i.length;for(const n=0;n<e;n++)t.push(i[n])}}i={describe:Ro(i.describe,Cs),pointSize:Ro(i.pointSize,ws.pointSize),pointColor:Ro(i.pointColor,ws.pointColor),lineWidth:new Oo(Ro(i.lineWidth,ws.lineWidth)),outlineColor:new Io(Ro(i.outlineColor,ws.outlineColor)),lineColor:new Io(Ro(i.lineColor,ws.lineColor)),outlineWidth:Ro(i.outlineWidth,ws.outlineWidth),fill:new Io(Ro(i.fill,ws.fill)),outline:Ro(i.outline,ws.outline),clampToGround:Ro(i.clampToGround,ws.clampToGround),extrudedHeight:i.extrudedHeight};const s=this;return Promise.resolve(r).then((function(e){return function(e,i,n,r){let o;Mo(r)&&(o=Cesium.getFilenameFromUri(r)),Mo(o)&&e._name!==o&&(e._name=o,e._changed.raiseEvent(e));const s=ns[i.type];if(!Mo(s))throw new t("Unsupported GeoJSON object type: "+i.type);const a=i.crs;let l=null!==a?xs:null;if(Mo(a)){if(!Mo(a.properties))throw new t("crs.properties is undefined.");const e=a.properties;if("name"===a.type){if(l=ts[e.name],!Mo(l))throw new t("Unknown crs name: "+e.name)}else if("link"===a.type){var c=Ko[e.href];if(Mo(c)||(c=es[e.type]),!Mo(c))throw new t("Unable to resolve crs link: "+JSON.stringify(e));l=c(e)}else{if("EPSG"!==a.type)throw new t("Unknown crs type: "+a.type);if(l=ts["EPSG:"+e.code],!Mo(l))throw new t("Unknown crs EPSG code: "+e.code)}}return Promise.resolve(l).then((function(t){return e._entityCollection.removeAll(),null!==t&&s(e,i,i,t,n),Promise.all(e._promises).then((function(){return e._promises.length=0,Fo.setLoading(e,!1),e}))}))}(s,e,i,o)})).catch((function(e){throw Fo.setLoading(s,!1),s._error.raiseEvent(s,e),e}))}update(){return!0}}ws.load=function(e,t){return(new ws).load(e,t)};const bs={};function Ss(e){return new Ts(e instanceof Uint8Array?e:new Uint8Array(e))}function Ts(e){this._array=e}Ts.prototype.read=function(){var e=this._array;return this._array=null,Promise.resolve(e?{done:!1,value:e}:{done:!0,value:void 0})},Ts.prototype.cancel=function(){return this._array=null,Promise.resolve()};var As=function(e){return fetch(e).then((function(e){return e.body&&e.body.getReader?e.body.getReader():e.arrayBuffer().then(Ss)}))},Es=function(e){return new Promise((function(t,i){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onload=function(){t(Ss(n.response))},n.onerror=i,n.ontimeout=i,n.open("GET",e,!0),n.send()}))};function Ps(e){return("function"==typeof fetch?As:Es)(e)}function Ls(e){return"function"==typeof e.read?e:e.getReader()}var Ds=new Uint8Array(0);function Ms(e,t){if(!e.length)return t;if(!t.length)return e;var i=new Uint8Array(e.length+t.length);return i.set(e),i.set(t,e.length),i}function Rs(e){return"function"==typeof e.slice?e:new Is("function"==typeof e.read?e:e.getReader())}function Is(e){this._source=e,this._array=Ds,this._index=0}Is.prototype.read=function(){var e=this,t=e._array.subarray(e._index);return e._source.read().then((function(i){return e._array=Ds,e._index=0,i.done?t.length>0?{done:!1,value:t}:{done:!0,value:void 0}:{done:!1,value:Ms(t,i.value)}}))},Is.prototype.slice=function(e){if((e|=0)<0)throw new Error("invalid length");var t=this,i=this._array.length-this._index;if(this._index+e<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=e));var n=new Uint8Array(e);return n.set(this._array.subarray(this._index)),function r(){return t._source.read().then((function(o){return o.done?(t._array=Ds,t._index=0,i>0?n.subarray(0,i):null):i+o.value.length>=e?(t._array=o.value,t._index=e-i,n.set(o.value.subarray(0,e-i),i),n):(n.set(o.value,i),i+=o.value.length,r())}))}()},Is.prototype.cancel=function(){return this._source.cancel()};var Ns=function(e){return!(e=e.trim())||isNaN(e=+e)?null:e},Os={B:Ns,C:function(e){return e.trim()||null},D:function(e){return new Date(+e.substring(0,4),e.substring(4,6)-1,+e.substring(6,8))},F:Ns,L:function(e){return!/^[nf]$/i.test(e)&&(!!/^[yt]$/i.test(e)||null)},M:Ns,N:Ns},Fs=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},ks=function(e,t){return(e=Rs(e)).slice(32).then((function(i){var n=Fs(i);return e.slice(n.getUint16(8,!0)-32).then((function(i){return new zs(e,t,n,Fs(i))}))}))};function zs(e,t,i,n){this._source=e,this._decode=t.decode.bind(t),this._recordLength=i.getUint16(10,!0),this._fields=[];for(var r=0;13!==n.getUint8(r);r+=32){for(var o=0;o<11&&0!==n.getUint8(r+o);++o);this._fields.push({name:this._decode(new Uint8Array(n.buffer,n.byteOffset+r,o)),type:String.fromCharCode(n.getUint8(r+11)),length:n.getUint8(r+16)})}}var Bs=zs.prototype;Bs.read=function(){var e=this,t=1;return e._source.slice(e._recordLength).then((function(i){return i&&26!==i[0]?{done:!1,value:e._fields.reduce((function(n,r){return n[r.name]=Os[r.type](e._decode(i.subarray(t,t+=r.length))),n}),{})}:{done:!0,value:void 0}}))},Bs.cancel=function(){return this._source.cancel()};var Gs=function(e){var t,i=40,n=e.getInt32(36,!0),r=new Array(n);for(t=0;t<n;++t,i+=16)r[t]=[e.getFloat64(i,!0),e.getFloat64(i+8,!0)];return{type:"MultiPoint",coordinates:r}},Hs=function(e){return{type:"Point",coordinates:[e.getFloat64(4,!0),e.getFloat64(12,!0)]}},Ws=function(e){var t,i=44,n=e.getInt32(36,!0),r=e.getInt32(40,!0),o=new Array(n),s=new Array(r),a=[],l=[];for(t=0;t<n;++t,i+=4)o[t]=e.getInt32(i,!0);for(t=0;t<r;++t,i+=16)s[t]=[e.getFloat64(i,!0),e.getFloat64(i+8,!0)];return o.forEach((function(e,t){var i=s.slice(e,o[t+1]);!function(e){if((t=e.length)<4)return!1;var t,i=0,n=e[t-1][1]*e[0][0]-e[t-1][0]*e[0][1];for(;++i<t;)n+=e[i-1][1]*e[i][0]-e[i-1][0]*e[i][1];return n>=0}(i)?l.push(i):a.push([i])})),l.forEach((function(e){a.some((function(t){if(function(e,t){var i,n=-1,r=t.length;for(;++n<r;)if(i=Us(e,t[n]))return i>0;return!1}(t[0],e))return t.push(e),!0}))||a.push([e])})),1===a.length?{type:"Polygon",coordinates:a[0]}:{type:"MultiPolygon",coordinates:a}};function Us(e,t){for(var i=t[0],n=t[1],r=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var l=e[o],c=l[0],u=l[1],h=e[a],d=h[0],p=h[1];if(js(l,h,t))return 0;u>n!=p>n&&i<(d-c)*(n-u)/(p-u)+c&&(r=-r)}return r}function js(e,t,i){var n=i[0]-e[0],r=i[1]-e[1];if(0===n&&0===r)return!0;var o=t[0]-e[0],s=t[1]-e[1];if(0===o&&0===s)return!1;var a=(n*o+r*s)/(o*o+s*s);return!(a<0||a>1)&&(0===a||1===a||a*o===n&&a*s===r)}var Vs=function(e){var t,i=44,n=e.getInt32(36,!0),r=e.getInt32(40,!0),o=new Array(n),s=new Array(r);for(t=0;t<n;++t,i+=4)o[t]=e.getInt32(i,!0);for(t=0;t<r;++t,i+=16)s[t]=[e.getFloat64(i,!0),e.getFloat64(i+8,!0)];return 1===n?{type:"LineString",coordinates:s}:{type:"MultiLineString",coordinates:o.map((function(e,t){return s.slice(e,o[t+1])}))}},qs=function(e,t){var i=new Uint8Array(e.length+t.length);return i.set(e,0),i.set(t,e.length),i},$s={0:function(){return null},1:Hs,3:Vs,5:Ws,8:Gs,11:Hs,13:Vs,15:Ws,18:Gs,21:Hs,23:Vs,25:Ws,28:Gs},Ys=function(e){return(e=Rs(e)).slice(100).then((function(t){return new Xs(e,Fs(t))}))};function Xs(e,t){var i=t.getInt32(32,!0);if(!(i in $s))throw new Error("unsupported shape type: "+i);this._source=e,this._type=i,this._index=0,this._parse=$s[i],this.bbox=[t.getFloat64(36,!0),t.getFloat64(44,!0),t.getFloat64(52,!0),t.getFloat64(60,!0)]}var Js=Xs.prototype;function Zs(){}Js.read=function(){var e=this;return++e._index,e._source.slice(12).then((function(t){if(null==t)return{done:!0,value:void 0};var i=Fs(t);function n(){return e._source.slice(4).then((function(o){return null==o?{done:!0,value:void 0}:(i=Fs(t=qs(t.slice(4),o))).getInt32(0,!1)!==e._index?n():r()}))}function r(){var r=2*i.getInt32(4,!1)-4,o=i.getInt32(8,!0);return r<0||o&&o!==e._type?n():e._source.slice(r).then((function(i){return{done:!1,value:o?e._parse(Fs(qs(t.slice(8),i))):null}}))}return r()}))},Js.cancel=function(){return this._source.cancel()};function Qs(e,t){this._shp=e,this._dbf=t,this.bbox=e.bbox}var Ks=Qs.prototype;function ea(e,t,i){return"string"==typeof t?(/\.dbf$/.test(t)||(t+=".dbf"),t=Ps(t)):t instanceof ArrayBuffer||t instanceof Uint8Array?t=Ss(t):null!=t&&(t=Ls(t)),"string"==typeof e?(/\.shp$/.test(e)||(e+=".shp"),void 0===t&&(t=Ps(e.substring(0,e.length-4)+".dbf").catch((function(){}))),e=Ps(e)):e=e instanceof ArrayBuffer||e instanceof Uint8Array?Ss(e):Ls(e),Promise.all([e,t]).then((function(e){var t,n,r,o=e[0],s=e[1],a="windows-1252";return i&&null!=i.encoding&&(a=i.encoding),t=o,n=s,r=s&&new TextDecoder(a),Promise.all([Ys(t),n&&ks(n,r)]).then((function(e){return new Qs(e[0],e[1])}))}))}Ks.read=function(){var e=this;return Promise.all([e._dbf?e._dbf.read():{value:{}},e._shp.read()]).then((function(e){var t=e[0],i=e[1];return i.done?i:{done:!1,value:{type:"Feature",properties:t.value,geometry:i.value}}}))},Ks.cancel=function(){return Promise.all([this._dbf&&this._dbf.cancel(),this._shp.cancel()]).then(Zs)},bs.open=ea,bs.openShp=function(e,t){return"string"==typeof e?(/\.shp$/.test(e)||(e+=".shp"),e=Ps(e)):e=e instanceof ArrayBuffer||e instanceof Uint8Array?Ss(e):Ls(e),Promise.resolve(e).then(Ys)},bs.openDbf=function(e,t){var i="windows-1252";return t&&null!=t.encoding&&(i=t.encoding),i=new TextDecoder(i),"string"==typeof e?(/\.dbf$/.test(e)||(e+=".dbf"),e=Ps(e)):e=e instanceof ArrayBuffer||e instanceof Uint8Array?Ss(e):Ls(e),Promise.resolve(e).then((function(e){return ks(e,i)}))},bs.read=function(e,t,i){return ea(e,t,i).then((function(e){var t=[],i={type:"FeatureCollection",features:t,bbox:e.bbox};return e.read().then((function n(r){return r.done?i:(t.push(r.value),e.read().then(n))}))}))},Object.defineProperty(bs,"__esModule",{value:!0});const{defined:ta,defaultValue:ia,ColorMaterialProperty:na,ConstantPositionProperty:ra,ConstantProperty:oa,DataSource:sa,PolygonGraphics:aa,PolylineGraphics:la,createGuid:ca,Cartesian3:ua,PointGraphics:ha,ArcType:da,PolygonHierarchy:pa,Color:ma,HeightReference:fa,Resource:ga}=Cesium,_a={small:24,medium:48,large:64},ya={},va={},Ca={"urn:ogc:def:crs:OGC:1.3:CRS84":Ga,"EPSG:4326":Ga,"urn:ogc:def:crs:EPSG::4326":Ga},xa={Feature:Ta,FeatureCollection:function(e,t,i,n,r){for(var o=t.features,s=0,a=o.length;s<a;s++)Ta(e,o[s],void 0,n,r)},GeometryCollection:Aa,LineString:Ma,MultiLineString:Ra,MultiPoint:La,MultiPolygon:Oa,Point:Pa,Polygon:Na,Topology:Fa},wa={GeometryCollection:Aa,LineString:Ma,MultiLineString:Ra,MultiPoint:La,MultiPolygon:Oa,Point:Pa,Polygon:Na,Topology:Fa};function ba(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=t(e[n]);return i}function Sa(e,t,i){var n=e.id;if(ta(n)&&"Feature"===e.type){for(var r=2,o=n;ta(t.getById(o));)o=n+"_"+r,r++;n=o}else n=ca();var s=t.getOrCreateEntity(n),a=e.properties;if(ta(a)){var l;s.properties=a;var c=a.title;if(ta(c))s.name=c,l="title";else{var u=Number.MAX_VALUE;for(var h in a)if(a.hasOwnProperty(h)&&a[h]){var d=h.toLowerCase();if(u>1&&"title"===d){u=1,l=h;break}u>2&&"name"===d?(u=2,l=h):u>3&&/title/i.test(h)?(u=3,l=h):u>4&&/name/i.test(h)&&(u=4,l=h)}ta(l)&&(s.name=a[l])}var p=a.description;null!==p&&(s.description=ta(p)?new oa(p):i(a,l))}return s}function Ta(e,i,n,r,o){if(null!==i.geometry){if(!ta(i.geometry))throw new t("feature.geometry is required.");var s=i.geometry.type,a=wa[s];if(!ta(a))throw new t("Unknown geometry type: "+s);a(e,i,i.geometry,r,o)}else Sa(i,e._entityCollection,o.describe)}function Aa(e,i,n,r,o){for(var s=n.geometries,a=0,l=s.length;a<l;a++){var c=s[a],u=c.type,h=wa[u];if(!ta(h))throw new t("Unknown geometry type: "+u);h(e,i,c,r,o)}}function Ea(e,t,i,n,r){let o=r.pointSize,s=r.pointColor;const a=t.properties;if(ta(a)){const e=a["point-color"];ta(e)&&(s=ma.fromCssColorString(e)),o=ia(_a[a["point-size"]],o)}const l=new ha;2===n.length&&r.clampToGround&&(l.heightReference=fa.CLAMP_TO_GROUND);const c=Sa(t,e._entityCollection,r.describe);c.point=l,c.point.color=s,c.point.pixelSize=o,c.position=new ra(i(n))}function Pa(e,t,i,n,r){Ea(e,t,n,i.coordinates,r)}function La(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)Ea(e,t,n,o[s],r)}function Da(e,t,i,n,r){const o=r.lineColor,s=r.lineWidth,a=t.properties;if(ta(a)){const e=a["stroke-width"];let t;ta(e)&&(s=new oa(e));let i=a.stroke;ta(i)&&(t=ma.fromCssColorString(i));let n=a["stroke-opacity"];ta(n)&&1!==n&&(ta(t)||(t=o.color.clone()),t.alpha=n),ta(t)&&(o=new na(t))}const l=Sa(t,e._entityCollection,r.describe),c=new la;l.polyline=c,c.clampToGround=r.clampToGround,c.material=o,c.width=s,c.positions=new oa(ba(n,i)),c.arcType=da.RHUMB}function Ma(e,t,i,n,r){Da(e,t,n,i.coordinates,r)}function Ra(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)Da(e,t,n,o[s],r)}function Ia(e,t,i,n,r){if(0===n.length||0===n[0].length)return;let o=r.outlineColor.color,s=r.fill,a=r.outlineWidth;const l=t.properties;if(ta(l)){const e=l["stroke-width"];let t;ta(e)&&(a=new oa(e));const i=l.stroke;ta(i)&&(t=ma.fromCssColorString(i));let n,c=l["stroke-opacity"];ta(c)&&1!==c&&(ta(t)||(t=r.outlineColor.color.clone()),t.alpha=c),ta(t)&&(o=new oa(t));const u=l.fill;ta(u)&&(n=ma.fromCssColorString(u),n.alpha=s.color.alpha),c=l["fill-opacity"],ta(c)&&c!==s.color.alpha&&(ta(n)||(n=s.color.clone()),n.alpha=c),ta(n)&&(s=new na(n))}const c=new aa;c.outline=new oa(r.outline),c.outlineColor=o,c.outlineWidth=a,c.material=s,c.arcType=da.RHUMB;const u=r.extrudedHeight;if(u)if("number"==typeof u)c.extrudedHeight=u;else if("string"==typeof u){const e=u.match(/\$\{\s*.*?\s*\}/gi);if(e){let t=u;for(let i of e){const e=/\$\{\s*(.*?)\s*\}/gi.exec(i);ta(e)&&ta(e[1])&&(t=t.replace(i,l[e[1]]))}try{const e=window.eval(t);"number"==typeof e&&(c.extrudedHeight=e)}catch(e){}}}const h=[];for(var d=1,p=n.length;d<p;d++)h.push(new pa(ba(n[d],i)));const m=n[0];c.hierarchy=new oa(new pa(ba(m,i),h)),m[0].length>2?c.perPositionHeight=new oa(!0):r.clampToGround||(c.height=0);Sa(t,e._entityCollection,r.describe).polygon=c}function Na(e,t,i,n,r){Ia(e,t,n,i.coordinates,r)}function Oa(e,t,i,n,r){for(var o=i.coordinates,s=0;s<o.length;s++)Ia(e,t,n,o[s],r)}function Fa(e,t,i,n,r){for(var o in i.objects)if(i.objects.hasOwnProperty(o)){var s=topojson.feature(i,i.objects[o]);(0,xa[s.type])(e,s,s,n,r)}}function ka(e,t){var i="";for(var n in e)if(e.hasOwnProperty(n)){if(n===t||-1!==za.indexOf(n))continue;var r=e[n];ta(r)&&(i+="object"==typeof r?"<tr><th>"+n+"</th><td>"+ka(r)+"</td></tr>":"<tr><th>"+n+"</th><td>"+r+"</td></tr>")}return i.length>0&&(i='<table class="cesium-infoBox-defaultTable"><tbody>'+i+"</tbody></table>"),i}const za=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function Ba(e,t){return new Cesium.CallbackProperty(function(e,t,i){var n;return function(r,o){return ta(n)||(n=e(t,i)),n}}(ka,e,t),!0)}function Ga(e){return ua.fromDegrees(e[0],e[1],e[2])}class Ha extends ws{constructor(e){super(e),this._geoJson=void 0}get geoJson(){return this._geoJson}set geoJson(e){this._geoJson?this._geoJson.features.push(e):this._geoJson={type:"FeatureCollection",features:[e]}}static pointSize=5;static pointColor=ma.ROYALBLUE;static lineColor=ma.YELLOW;static fill=ma.fromBytes(255,255,0,100);static outline=!0;static outlineColor=ma.YELLOW;static lineWidth=2;static clampToGround=!1;static outlineWidth=1;static crsNames(){return Ca}static crsLinkHrefs(){return ya}static crsLinkTypes(){return va}load(e,i={encoding:"utf-8"}){if(!ta(e))throw new t("data is required.");Cesium.DataSource.setLoading(this,!0);const n=i.credit;"string"==typeof n&&(n=new Cesium.Credit(n)),this._credit=n;const r=this;let o=e,s=i.sourceUri;if("string"==typeof e||e instanceof ga){o=new Promise(((t,n)=>{bs.open(e,void 0,{encoding:i.encoding}).then((e=>e.read().then((function i(n){if(!n.done)return r.geoJson=n.value,e.read().then(i);t(r.geoJson)})))).catch((e=>n(e.stack)))})),s=ia(s,"");var a=this._resourceCredits,l=e.credits;if(ta(l))for(var c=l.length,u=0;u<c;u++)a.push(l[u])}return i={describe:ia(i.describe,Ba),pointSize:ia(i.pointSize,Ha.pointSize),pointColor:ia(i.pointColor,Ha.pointColor),lineWidth:new oa(ia(i.lineWidth,Ha.lineWidth)),outlineColor:new na(ia(i.outlineColor,Ha.outlineColor)),lineColor:new na(ia(i.lineColor,Ha.lineColor)),outlineWidth:ia(i.outlineWidth,Ha.outlineWidth),fill:new na(ia(i.fill,Ha.fill)),outline:ia(i.outline,Ha.outline),clampToGround:ia(i.clampToGround,Ha.clampToGround),extrudedHeight:i.extrudedHeight},Promise.resolve(o).then((function(e){return function(e,i,n,r){let o;ta(r)&&(o=Cesium.getFilenameFromUri(r)),ta(o)&&e._name!==o&&(e._name=o,e._changed.raiseEvent(e));const s=xa[i.type];if(!ta(s))throw new t("Unsupported GeoJSON object type: "+i.type);const a=i.crs;let l=null!==a?Ga:null;if(ta(a)){if(!ta(a.properties))throw new t("crs.properties is undefined.");const e=a.properties;if("name"===a.type){if(l=Ca[e.name],!ta(l))throw new t("Unknown crs name: "+e.name)}else if("link"===a.type){var c=ya[e.href];if(ta(c)||(c=va[e.type]),!ta(c))throw new t("Unable to resolve crs link: "+JSON.stringify(e));l=c(e)}else{if("EPSG"!==a.type)throw new t("Unknown crs type: "+a.type);if(l=Ca["EPSG:"+e.code],!ta(l))throw new t("Unknown crs EPSG code: "+e.code)}}return Promise.resolve(l).then((function(t){return e._entityCollection.removeAll(),null!==t&&s(e,i,i,t,n),Promise.all(e._promises).then((function(){return e._promises.length=0,sa.setLoading(e,!1),e}))}))}(r,e,i,s)})).catch((function(e){throw sa.setLoading(r,!1),r._error.raiseEvent(r,e),e}))}}Ha.load=function(e,t){return(new Ha).load(e,t)};const{buildModuleUrl:Wa,Color:Ua,defined:ja,destroyObject:Va,knockout:qa,getElement:$a,subscribeAndEvaluate:Ya,InfoBoxViewModel:Xa}=Cesium;class Ja{constructor(e){e=$a(e);var t=document.createElement("div");t.className="cesium-infoBox",t.setAttribute("data-bind",'      css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),e.appendChild(t);var i=document.createElement("div");i.className="cesium-infoBox-title",i.setAttribute("data-bind","text: titleText"),t.appendChild(i);var n=document.createElement("button");n.type="button",n.className="cesium-infoBox-close",n.setAttribute("data-bind","      click: function () { closeClicked.raiseEvent(this); }"),n.innerHTML="&times;",t.appendChild(n);var r=document.createElement("iframe");r.className="cesium-infoBox-iframe",r.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),r.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),r.setAttribute("allowfullscreen",!0),t.appendChild(r);var o=new Xa;qa.applyBindings(o,t),this._container=e,this._element=t,this._frame=r,this._viewModel=o,this._descriptionSubscription=void 0;var s=this;r.addEventListener("load",(function(){var e=r.contentDocument,i=e.createElement("link");i.href=Wa("Widgets/InfoBox/InfoBoxDescription.css"),i.rel="stylesheet",i.type="text/css";var n=e.createElement("div");n.className="cesium-infoBox-description",e.head.appendChild(i),e.body.appendChild(n),s._descriptionSubscription=Ya(o,"description",(function(e){r.style.height="5px",n.innerHTML=e;var i=null,o=n.firstElementChild;if(null!==o&&1===n.childNodes.length){var s=window.getComputedStyle(o);if(null!==s){var a=s["background-color"],l=Ua.fromCssColorString(a);ja(l)&&0!==l.alpha&&(i=s["background-color"])}}t.style["background-color"]=i;var c=n.getBoundingClientRect().height;r.style.height=c+"px"}))})),r.setAttribute("src","about:blank")}get container(){return this._container}get viewModel(){return this._viewModel}get frame(){return this._frame}isDestroyed(){return!1}destroy(){var e=this._container;return qa.cleanNode(this._element),e.removeChild(this._element),ja(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),Va(this)}}function Za(e,t){const{center:i}=e.boundingSphere,n=w.fromCartesian(i),r=Cesium.Cartesian3.fromDegrees(n.lon,n.lat,0),o=Cesium.Cartesian3.fromDegrees(n.lon,n.lat,t),s=Cesium.Cartesian3.subtract(o,r,new Cesium.Cartesian3);e.modelMatrix=Cesium.Matrix4.multiply(e.modelMatrix,Cesium.Matrix4.fromTranslation(s),e.modelMatrix)}class Qa{constructor(e={},t={}){this._params={height:0,position:new Cesium.Cartesian3(0,0,0),rotation:0};let{transform:i,position:n,height:r,rotationZ:o,debug:s}=e;const a=new Cesium.Cesium3DTileset(e);a.readyPromise.then((e=>{if(viewer.scene.primitives.add(e),Cesium.defined(n)&&function(e,t,i,n){if(t)e.root.transform=t;else{const t=Cesium.Transforms.eastNorthUpToFixedFrame(i),r=Cesium.Matrix3.fromRotationZ(n);Cesium.Matrix4.multiplyByMatrix3(t,r,t),Cesium.Matrix4.multiply(e.root.transform,t,e.root.transform)}}(e,i,n,o),Cesium.defined(r)&&Za(e,r),s){let t=0,i=new Cesium.Cartesian3,n=0;parent.onkeypress=function(r){r.keyCode==="Q".charCodeAt()||r.keyCode==="q".charCodeAt()?t=1:r.keyCode==="E".charCodeAt()||r.keyCode==="e".charCodeAt()?t=-1:r.keyCode==="A".charCodeAt()||r.keyCode==="a".charCodeAt()?i=new Cesium.Cartesian3(-2,0,0):r.keyCode==="D".charCodeAt()||r.keyCode==="d".charCodeAt()?i=new Cesium.Cartesian3(2,0,0):r.keyCode==="W".charCodeAt()||r.keyCode==="w".charCodeAt()?i=new Cesium.Cartesian3(0,-2,0):r.keyCode==="S".charCodeAt()||r.keyCode==="s".charCodeAt()?i=new Cesium.Cartesian3(0,2,0):r.keyCode==="Z".charCodeAt()||r.keyCode==="z".charCodeAt()?n=-1:r.keyCode!=="X".charCodeAt()&&r.keyCode!=="x".charCodeAt()||(n=1),function(e,t){const i=new Cesium.Matrix4;Cesium.Matrix4.fromTranslation(t,i),Cesium.Matrix4.multiply(e.modelMatrix,i,e.modelMatrix)}(e,i),function(e,t){const i=Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(t));Cesium.Matrix4.multiplyByMatrix3(e.root.transform,i,e.root.transform)}(e,n),Za(e,t),n=0,i=new Cesium.Cartesian3,t=0}}})),this.delegate=a}get allTilesLoaded(){return this.delegate.allTilesLoaded}get readyPromise(){return this.delegate.readyPromise}get boundingSphere(){return this.delegate.boundingSphere}get colorBlendAmount(){return this.delegate.colorBlendAmount}set colorBlendAmount(e){this.delegate.colorBlendAmount=e}get colorBlendMode(){return this.delegate.colorBlendMode}set colorBlendMode(e){this.delegate.colorBlendMode=e}get style(){return this.delegate.style}set style(e){this.delegate.style=e}get customShader(){return this.delegate.customShader}set customShader(e){this.delegate.customShader=e}get debugColorizeTiles(){return this.delegate.debugColorizeTiles}set debugColorizeTiles(e){this.delegate.debugColorizeTiles=e}get debugFreezeFrame(){return this.delegate.debugFreezeFrame}set debugFreezeFrame(e){this.delegate.debugFreezeFrame=e}get debugShowBoundingVolume(){return this.delegate.debugShowBoundingVolume}set debugShowBoundingVolume(e){this.delegate.debugShowBoundingVolume=e}get debugShowContentBoundingVolume(){return this.delegate.debugShowContentBoundingVolume}set debugShowContentBoundingVolume(e){this.delegate.debugShowContentBoundingVolume=e}get debugShowGeometricError(){return this.delegate.debugShowGeometricError}set debugShowGeometricError(e){this.delegate.debugShowGeometricError=e}get debugShowMemoryUsage(){return this.delegate.debugShowMemoryUsage}set debugShowMemoryUsage(e){this.delegate.debugShowMemoryUsage=e}get debugShowRenderingStatistics(){return this.delegate.debugShowRenderingStatistics}set debugShowRenderingStatistics(e){this.delegate.debugShowRenderingStatistics=e}get debugShowUrl(){return this.delegate.debugShowUrl}set debugShowUrl(e){this.delegate.debugShowUrl=e}get debugWireframe(){return this.delegate.debugWireframe}set debugWireframe(e){this.delegate.debugWireframe=e}get dynamicScreenSpaceError(){return this.delegate.dynamicScreenSpaceError}set dynamicScreenSpaceError(e){this.delegate.dynamicScreenSpaceError=e}get dynamicScreenSpaceErrorFactor(){return this.delegate.dynamicScreenSpaceErrorFactor}set dynamicScreenSpaceErrorFactor(e){this.delegate.dynamicScreenSpaceErrorFactor=e}get extensions(){return this.delegate.extensions}get extras(){return this.delegate.extras}get dynamicScreenSpaceErrorDensity(){return this.delegate.dynamicScreenSpaceErrorDensity}set dynamicScreenSpaceErrorDensity(e){this.delegate.dynamicScreenSpaceErrorDensity=e}get foveatedScreenSpaceError(){return this.delegate.foveatedScreenSpaceError}set foveatedScreenSpaceError(e){this.delegate.foveatedScreenSpaceError=e}get foveatedConeSize(){return this.delegate.foveatedConeSize}set foveatedConeSize(e){this.delegate.foveatedConeSize=e}get foveatedInterpolationCallback(){return this.delegate.foveatedInterpolationCallback}set foveatedInterpolationCallback(e){this.delegate.foveatedInterpolationCallback=e}get foveatedMinimumScreenSpaceErrorRelaxation(){return this.delegate.foveatedMinimumScreenSpaceErrorRelaxation}set foveatedMinimumScreenSpaceErrorRelaxation(e){this.delegate.foveatedMinimumScreenSpaceErrorRelaxation=e}get foveatedTimeDelay(){return this.delegate.foveatedTimeDelay}set foveatedTimeDelay(e){this.delegate.foveatedTimeDelay=e}get imageBasedLightingFactor(){return this.delegate.imageBasedLightingFactor}set imageBasedLightingFactor(e){this.delegate.imageBasedLightingFactor=e}get immediateLoadDesiredLevelOfDetail(){return this.delegate.immediateLoadDesiredLevelOfDetail}set immediateLoadDesiredLevelOfDetail(e){this.delegate.immediateLoadDesiredLevelOfDetail=e}get initialTilesLoaded(){return this.delegate.initialTilesLoaded}get lightColor(){return this.delegate.lightColor}set lightColor(e){this.delegate.lightColor=e}get loadProgress(){return this.delegate.loadProgress}get loadSiblings(){return this.delegate.loadSiblings}get maximumMemoryUsage(){return this.delegate.maximumMemoryUsage}set maximumMemoryUsage(e){this.delegate.maximumMemoryUsage=e}get maximumScreenSpaceError(){return this.delegate.maximumScreenSpaceError}set maximumScreenSpaceError(e){this.delegate.maximumScreenSpaceError=e}get modelMatrix(){return this.delegate.modelMatrix}set modelMatrix(e){this.delegate.modelMatrix=e}get pointCloudShading(){return this.delegate.pointCloudShading}set pointCloudShading(e){this.delegate.pointCloudShading}get preferLeaves(){return this.delegate.preferLeaves}set preferLeaves(e){this.delegate.preferLeaves=e}get preloadFlightDestinations(){return this.delegate.preloadFlightDestinations}set preloadFlightDestinations(e){this.delegate.preloadFlightDestinations}get preloadWhenHidden(){return this.delegate.preloadWhenHidden}set preloadWhenHidden(e){this.delegate.preloadWhenHidden}get progressResolutionHeightFraction(){return this.delegate.progressResolutionHeightFraction}set progressResolutionHeightFraction(e){this.delegate.progressResolutionHeightFraction=e}get properties(){return this.delegate.properties}get resource(){return this.delegate.resource}get root(){return this.delegate.root}get shadows(){return this.delegate.shadows}set shadows(e){this.delegate.shadows=e}get showOutline(){return this.delegate.showOutline}get skipLevelOfDetail(){return this.delegate.skipLevelOfDetail}set skipLevelOfDetail(e){this.delegate.skipLevelOfDetail}get skipLevels(){return this.delegate.skipLevels}set skipLevels(e){this.delegate.skipLevels=e}get skipScreenSpaceErrorFactor(){return this.delegate.skipScreenSpaceErrorFactor}set skipScreenSpaceErrorFactor(e){this.delegate.skipScreenSpaceErrorFactor=e}get clippingPlanes(){return this.delegate.clippingPlanes}set clippingPlanes(e){this.delegate.clippingPlanes=e}get specularEnvironmentMaps(){return this.delegate.specularEnvironmentMaps}set specularEnvironmentMaps(e){this.delegate.specularEnvironmentMaps=e}get tileFailed(){return this.delegate.tileFailed}get tileLoad(){return this.delegate.tileLoad}set tileLoad(e){this.delegate.tileLoad=e}get tileUnload(){return this.delegate.tileUnload}set tileUnload(e){this.delegate.tileUnload=e}get tilesLoaded(){return this.delegate.tilesLoaded}get tileVisible(){return this.delegate.tileVisible}set tileVisible(e){this.delegate.tileVisible=e}get timeSinceLoad(){return this.delegate.timeSinceLoad}get totalMemoryUsageInBytes(){return this.delegate.totalMemoryUsageInBytes}get classificationType(){return this.delegate.classificationType}set classificationType(e){this.delegate.classificationType=e}get baseScreenSpaceError(){return this.delegate.baseScreenSpaceError}set baseScreenSpaceError(e){this.delegate.baseScreenSpaceError=e}destroy(){this.delegate.destroy()}hasExtension(e){return this.delegate.hasExtension(e)}isDestroyed(){return this.delegate.isDestroyed()}makeStyleDirty(){return this.delegate.makeStyleDirty()}trimLoadedTiles(){this.delegate.trimLoadedTiles()}static loadJson(e){return Cesium3DTileset.loadJson(e)}}class Ka{constructor(e={}){this._id=C(e.id,Ue()),this._maxClusterLevel=C(e.maxClusterLevel,12),this._minLoadLevel=C(e.minLoadLevel,12),this._objects=void 0}get id(){return this._id}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(e){this._minLoadLevel=e}get objects(){return this._objects}set objects(e){this._objects=e}updateCluster(e){t.throwInstantiationError()}beginUpdate(e){t.throwInstantiationError()}endUpdate(e){t.throwInstantiationError()}initialize(e,i){t.throwInstantiationError()}createGeometry(e,i,n){t.throwInstantiationError()}removeGeometry(e,t){}removeAll(){t.throwInstantiationError()}isDestroyed(){return!1}destroy(){t.throwInstantiationError()}}const{AssociativeArray:el}=Cesium;class tl{constructor(){this._layers=new el}get layer(){return this._layers}get length(){return this._layers.length}get values(){return this._layers.values}get(e){return this._layers.get(e)}add(e){e instanceof Ka&&this._layers.set(e.id,e)}has(e){return e instanceof Ka?this._layers.contains(e):"string"==typeof e&&this._layers.contains(this.get(e))}remove(e){if(e instanceof Ka)return e.destroy(),this._layers.remove(e.id);if("string"==typeof e){const t=this._layers.get(e);return t&&t.destroy(),this._layers.remove(e)}return!1}removeAll(){return this._layers.removeAll()}}const{GeographicTilingScheme:il,GlobeSurfaceTileProvider:nl,Event:rl,TerrainState:ol,RequestType:sl,Request:al,Rectangle:ll,QuadtreeTileLoadState:cl,Visibility:ul,AssociativeArray:hl,Cartesian3:dl,Cartographic:pl,getTimestamp:ml,RequestState:fl}=Cesium;function gl(e,t,i){let n=e.data;!function(){const t=new al({throttle:!1,throttleByServer:!0,type:sl.TERRAIN});n.request=t;const r=i.requestTileGeometry(e.x,e.y,e.level,t);x(r)?(n.terrainState=ol.RECEIVING,Promise.resolve(r).then((function(e){!function(e){n.terrainData=e,n.terrainState=ol.RECEIVED,n.request=void 0}(e)})).catch((function(e){!function(e){if(n.request.state===fl.CANCELLED)return n.terrainData=void 0,n.terrainState=ol.UNLOADED,void(n.request=void 0);n.terrainState=ol.FAILED,n.request=void 0}()}))):(n.terrainState=ol.UNLOADED,n.request=void 0)}()}const _l={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function yl(e,t,i,n,r){const o=e.data;o.terrainState===ol.UNLOADED&&gl(e,0,i),o.terrainState===ol.RECEIVED&&function(e,t,i,n,r,o){const s=i.tilingScheme,a=_l;a.tilingScheme=s,a.x=n,a.y=r,a.level=o,a.exaggeration=t.terrainExaggeration,a.exaggerationRelativeHeight=t.terrainExaggerationRelativeHeight,a.throttle=!0;const l=e.terrainData.createMesh(a);x(l)&&(e.terrainState=ol.TRANSFORMING,Promise.resolve(l).then((function(t){e.mesh=t,e.terrainState=ol.TRANSFORMED})).catch((function(){e.terrainState=ol.FAILED})))}(o,t,i,e.x,e.y,e.level),o.terrainState===ol.TRANSFORMED&&(e.renderable=!0)}function vl(e,t){const i=[];for(let n of e)x(n)&&(x(n.id)||(n.id=Ue()),x(n)&&x(n.position)&&(n.position instanceof dl?n.cartesian=n.position:n.position instanceof pl?(n.cartesian=pl.toCartesian(n.position),n.catographic=n.position):n.position instanceof w?(n.cartesian=n.position.toCartesian(),n.cartographic=n.position.toCartoGraphic()):n.cartesian=n.position,n.cartographic||(n.cartographic=pl.fromCartesian(n.cartesian)),ll.contains(t.rectangle,n.cartographic)&&i.push(n)));return i}class Cl{constructor(){this.boundingVolumeSourceTile=void 0,this.terrainState=Cesium.TerrainState.UNLOADED,this.mesh=void 0,this.terrainData=void 0,this.objects=void 0,this._geometryOfTile=new hl,this._objectsOfTile=new hl,this._needRenderObjects=new hl}static processStateMachine(e,t,i,n,r){Cl.initialize(e,i),e.state===cl.LOADING&&yl(e,t,i)}static initialize(e,t){let i=e.data;x(i)||(i=e.data=new Cl),e.state===cl.START&&(e.state=cl.LOADING)}}function xl(e,t,i,n,r){let o=i.data._geometryOfTile.get(t.id),s=e._hasRenderCached.get(t.id);s||(s={},e._hasRenderCached.set(t.id,s)),o||(o=[]);for(let e of r){if(s[e.id])return;const r=t.createGeometry(i,n,e);r&&(s[e.id]=!0,o.push({id:e.id,geometry:r}))}i.data._geometryOfTile.set(t.id,o)}function wl(e,t,i,n,r){const o=e._hasRenderCached.get(t.id);for(let e of r){const{id:i,geometry:r}=e;t.removeGeometry(n,r),delete o[i]}i.data._geometryOfTile.remove(t.id)}class bl{constructor(e={}){this._ready=!0,this._scene=e.scene,this._tilingSceheme=new il,this._readyPromise=Promise.resolve(!0),this._errorEvent=new rl,this._terrainProvider=e.terrainProvider,this._show=!0,this.cartographicLimitRectangle=ll.clone(ll.MAX_VALUE),this.tree=void 0,this._layers=new tl,this._lastTilesToRender=[],this._hasRenderCached=new hl,this._tilesCahced=[]}get terrainProvider(){return this._terrainProvider}get show(){return this._show}set show(e){this._show=e}get ready(){return this._ready}get tilingScheme(){return this._tilingSceheme}get readyPromise(){return this._readyPromise}get quadtree(){return this._quadtree}set quadtree(e){x(e)&&(this._quadtree=e)}initialize(e){for(let t of this._layers.values)t.initialize(e,this._scene)}beginUpdate(e){const t=this._layers.values;for(let i of t)i.beginUpdate(e);this._frameNumber++}showTileThisFrame(e,t){const i=e.data;if(!x(i))return;this._tilesCahced.includes(e)||this._tilesCahced.push(e);const n=this._layers.values;ml();for(let r of n){if(!x(r.objects)||!Array.isArray(r.objects))continue;const n=r.id;if(i._geometryOfTile.get(n)&&!r._needReclass)return;let o=i._objectsOfTile.get(n);x(o)&&!r._needReclass||(o=vl(r.objects,e),i._objectsOfTile.set(n,o)),xl(this,r,e,t,o)}}endUpdate(e){const t=this._quadtree;if(!t)return;const i=this._lastTilesToRender,n=t._tilesToRender,r=this._layers.values;for(let t of i)if(!n.includes(t))for(let i of r){const n=t.data._geometryOfTile.get(i.id)||[];wl(this,i,t,e,n)}for(let t of r){t.endUpdate(e)&&n.forEach((i=>{const n=i.data._geometryOfTile.get(t.id)||[];wl(this,t,i,e,n)}))}this._lastTilesToRender=[...n]}loadTile(e,t){if(!this.terrainProvider.ready)return;let i,n=!0;t.data&&(i=t.data.terrainState,n=t.data.boundingVolumeSourceTile!==t),Cl.processStateMachine(t,e,this.terrainProvider,this._layers,this.quadtree);const r=t.data;n&&i!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==ul.NONE&&r.boundingVolumeSourceTile===t&&Cl.processStateMachine(t,e,this.terrainProvider,this._layers,this.quadtree)}getLevelMaximumGeometricError(e){return this._terrainProvider.getLevelMaximumGeometricError(e)}canRefine(e){return nl.prototype.canRefine.call(this,e)}computeTileVisibility(e,t,i){return x(e.data)||(e.data=new Cl),nl.prototype.computeTileVisibility.call(this,e,t,i)}computeDistanceToTile(e,t){return e.data||(e.data=new Cl),nl.prototype.computeDistanceToTile.call(this,e,t)}clearTile(e){const t=this._tilesCahced;for(let i of t)i.data._geometryOfTile.remove(e),i.data._objectsOfTile.remove(e);this._hasRenderCached.remove(e)}isDestroyed(){return!1}destroy(){this._removeEventListener();const e=this._layers.values;for(let t of e)t.destroy()}computeTileLoadPriority(e,t){return nl.prototype.computeTileLoadPriority(e,t)}_onLayerAdded(e,t){}_onLayerRemoved(e,t){}_onLayerShownOrHidden(e,t,i){i?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)}}var Sl="uniform vec4 u_initialColor;\n\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_DAY_NIGHT_ALPHA\nuniform float u_dayTextureNightAlpha[TEXTURE_UNITS];\nuniform float u_dayTextureDayAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SPLIT\nuniform float czm_p_splitPosition;\nuniform float czm_p_drawingBufferHeight;\nuniform float czm_p_drawingBufferWidth;\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_IMAGERY_CUTOUT\nuniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_COLOR_TO_ALPHA\nuniform vec4 u_colorsToAlpha[TEXTURE_UNITS];\n#endif\n\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nuniform vec2 u_lightingFadeDistance;\n#endif\n\n#ifdef TILE_LIMIT_RECTANGLE\nuniform vec4 u_cartographicLimitRectangle;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nuniform vec2 u_nightFadeDistance;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\nuniform highp sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG) && defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\nuniform float u_minimumBrightness;\n#endif\n\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\nuniform vec4 u_fillHighlightColor;\n#endif\n\n#ifdef TRANSLUCENT\nuniform vec4 u_frontFaceAlphaByDistance;\nuniform vec4 u_backFaceAlphaByDistance;\nuniform vec4 u_translucencyRectangle;\n#endif\n\n#ifdef UNDERGROUND_COLOR\nuniform vec4 u_undergroundColor;\nuniform vec4 u_undergroundColorAlphaByDistance;\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\nuniform float u_lambertDiffuseMultiplier;\n#endif\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nvarying float v_height;\nvarying float v_slope;\nvarying float v_aspect;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nvarying float v_distance;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\nvarying vec3 v_atmosphereRayleighColor;\nvarying vec3 v_atmosphereMieColor;\nvarying float v_atmosphereOpacity;\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nfloat interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n    float startDistance = nearFarScalar.x;\n    float startValue = nearFarScalar.y;\n    float endDistance = nearFarScalar.z;\n    float endValue = nearFarScalar.w;\n    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n    return mix(startValue, endValue, t);\n}\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT) || defined(APPLY_MATERIAL)\nvec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)\n{\n    return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);\n}\n#endif\n\n#ifdef TRANSLUCENT\nbool inTranslucencyRectangle()\n{\n    return\n        v_textureCoordinates.x > u_translucencyRectangle.x &&\n        v_textureCoordinates.x < u_translucencyRectangle.z &&\n        v_textureCoordinates.y > u_translucencyRectangle.y &&\n        v_textureCoordinates.y < u_translucencyRectangle.w;\n}\n#endif\n\nvec4 sampleAndBlend(\n    vec4 previousColor,\n    sampler2D textureToSample,\n    vec2 tileTextureCoordinates,\n    vec4 textureCoordinateRectangle,\n    vec4 textureCoordinateTranslationAndScale,\n    float textureAlpha,\n    float textureNightAlpha,\n    float textureDayAlpha,\n    float textureBrightness,\n    float textureContrast,\n    float textureHue,\n    float textureSaturation,\n    float textureOneOverGamma,\n    float split,\n    vec4 colorToAlpha,\n    float nightBlend)\n{\n    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:\n    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||\n    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||\n    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||\n    //    tileTextureCoordinates.t > textureCoordinateRectangle.q\n    // In other words, the alpha is zero if the fragment is outside the rectangle\n    // covered by this texture.  Would an actual 'if' yield better performance?\n    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    textureAlpha *= mix(textureDayAlpha, textureNightAlpha, nightBlend);\n#endif\n\n    vec2 translation = textureCoordinateTranslationAndScale.xy;\n    vec2 scale = textureCoordinateTranslationAndScale.zw;\n    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;\n    vec4 value = texture2D(textureToSample, textureCoordinates);\n    vec3 color = value.rgb;\n    float alpha = value.a;\n\n#ifdef APPLY_COLOR_TO_ALPHA\n    vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);\n    colorDiff.r = max(max(colorDiff.r, colorDiff.g), colorDiff.b);\n    alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);\n#endif\n\n#if !defined(APPLY_GAMMA)\n    vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));\n    color = tempColor.rgb;\n    alpha = tempColor.a;\n#else\n    color = pow(color, vec3(textureOneOverGamma));\n#endif\n\n#ifdef APPLY_SPLIT\n    float splitPosition = czm_p_splitPosition * czm_p_drawingBufferWidth;\n    // 垂直分割 \n    if(split < -2.0 || split > 2.0) {\n        splitPosition = (1.0 - czm_p_splitPosition) * czm_p_drawingBufferHeight;\n    }\n    if(split < -2.0 && gl_FragCoord.y < splitPosition) {\n        alpha = 0.0;\n    }\n    else if (split > 2.0 && gl_FragCoord.y > splitPosition) {\n        alpha = 0.0;\n    }\n    // Split to the left\n    else if (split > -2.0 && split < 0.0 && gl_FragCoord.x > splitPosition) {\n       alpha = 0.0;\n    }\n    // Split to the right\n    else if (split < 2.0 && split > 0.0 && gl_FragCoord.x < splitPosition) {\n       alpha = 0.0;\n    }\n#endif\n\n#ifdef APPLY_BRIGHTNESS\n    color = mix(vec3(0.0), color, textureBrightness);\n#endif\n\n#ifdef APPLY_CONTRAST\n    color = mix(vec3(0.5), color, textureContrast);\n#endif\n\n#ifdef APPLY_HUE\n    color = czm_hue(color, textureHue);\n#endif\n\n#ifdef APPLY_SATURATION\n    color = czm_saturation(color, textureSaturation);\n#endif\n\n    float sourceAlpha = alpha * textureAlpha;\n    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\n    outAlpha += sign(outAlpha) - 1.0;\n\n    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\n\n    // When rendering imagery for a tile in multiple passes,\n    // some GPU/WebGL implementation combinations will not blend fragments in\n    // additional passes correctly if their computation includes an unmasked\n    // divide-by-zero operation,\n    // even if it's not in the output or if the output has alpha zero.\n    //\n    // For example, without sanitization for outAlpha,\n    // this renders without artifacts:\n    //   if (outAlpha == 0.0) { outColor = vec3(0.0); }\n    //\n    // but using czm_branchFreeTernary will cause portions of the tile that are\n    // alpha-zero in the additional pass to render as black instead of blending\n    // with the previous pass:\n    //   outColor = czm_branchFreeTernary(outAlpha == 0.0, vec3(0.0), outColor);\n    //\n    // So instead, sanitize against divide-by-zero,\n    // store this state on the sign of outAlpha, and correct on return.\n\n    return vec4(outColor, max(outAlpha, 0.0));\n}\n\nvec3 colorCorrect(vec3 rgb) {\n#ifdef COLOR_CORRECT\n    // Convert rgb color to hsb\n    vec3 hsb = czm_RGBToHSB(rgb);\n    // Perform hsb shift\n    hsb.x += u_hsbShift.x; // hue\n    hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n    hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n    // Convert shifted hsb back to rgb\n    rgb = czm_HSBToRGB(hsb);\n#endif\n    return rgb;\n}\n\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);\n\nconst float fExposure = 2.0;\n\nvec3 computeEllipsoidPosition()\n{\n    float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0), 1.0);\n    vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);\n    xy *= czm_viewport.zw * mpp * 0.5;\n\n    vec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n\n    vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);\n    return (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;\n}\n\nvoid main()\n{\n#ifdef TILE_LIMIT_RECTANGLE\n    if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||\n        v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)\n        {\n            discard;\n        }\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)\n    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates\n    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordiantes\n#endif\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    float nightBlend = 1.0 - clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0, 0.0, 1.0);\n#else\n    float nightBlend = 0.0;\n#endif\n\n    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0\n    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the\n    // fragments on the edges of tiles even though the vertex shader is outputting\n    // coordinates strictly in the 0-1 range.\n    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0), nightBlend);\n\n#ifdef SHOW_TILE_BOUNDARIES\n    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\n        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n    {\n        color = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\n    float cameraDist;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;\n    }\n    else if (czm_sceneMode == czm_sceneModeColumbusView)\n    {\n        cameraDist = -czm_view[3].z;\n    }\n    else\n    {\n        cameraDist = length(czm_view[3]);\n    }\n    float fadeOutDist = u_lightingFadeDistance.x;\n    float fadeInDist = u_lightingFadeDistance.y;\n    if (czm_sceneMode != czm_sceneMode3D) {\n        vec3 radii = czm_ellipsoidRadii;\n        float maxRadii = max(radii.x, max(radii.y, radii.z));\n        fadeOutDist -= maxRadii;\n        fadeInDist -= maxRadii;\n    }\n    float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#else\n    float fade = 0.0;\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\n    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\n    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\n    waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;\n\n    float mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\n\n    if (mask > 0.0)\n    {\n        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\n\n        vec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\n        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\n\n        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\n\n        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);\n    }\n#endif\n\n#ifdef APPLY_MATERIAL\n    czm_materialInput materialInput;\n    materialInput.st = v_textureCoordinates.st;\n    materialInput.normalEC = normalize(v_normalEC);\n    materialInput.positionToEyeEC = -v_positionEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalize(v_normalEC));     \n    materialInput.slope = v_slope;\n    materialInput.height = v_height;\n    materialInput.aspect = v_aspect;\n    czm_material material = czm_getMaterial(materialInput);\n    vec4 materialColor = vec4(material.diffuse, material.alpha);\n    color = alphaBlend(materialColor, color);\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalize(v_normalEC)) * u_lambertDiffuseMultiplier + 0.3, 0.0, 1.0);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\n    diffuseIntensity = mix(1.0, diffuseIntensity, fade);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#else\n    vec4 finalColor = color;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\n\n    if (clipDistance < clippingPlanesEdgeWidth)\n    {\n        finalColor = clippingPlanesEdgeColor;\n    }\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\n    finalColor = vec4(mix(finalColor.rgb, u_fillHighlightColor.rgb, u_fillHighlightColor.a), finalColor.a);\n#endif\n\n#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)\n    vec3 atmosphereLightDirection = czm_sunDirectionWC;\n#else\n    vec3 atmosphereLightDirection = czm_lightDirectionWC;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\n    if (!czm_backFacing())\n    {\n        bool dynamicLighting = false;\n        #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n            dynamicLighting = true;     \n        #endif\n\n        vec3 rayleighColor;\n        vec3 mieColor;\n        float opacity;\n\n        vec3 positionWC;\n        vec3 lightDirection;\n\n        // When the camera is far away (camera distance > nightFadeOutDistance), the scattering is computed in the fragment shader.\n        // Otherwise, the scattering is computed in the vertex shader.\n        #ifdef PER_FRAGMENT_GROUND_ATMOSPHERE\n            positionWC = computeEllipsoidPosition();\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            computeAtmosphereScattering(\n                positionWC,\n                lightDirection,\n                rayleighColor,\n                mieColor,\n                opacity\n            );\n        #else\n            positionWC = v_positionMC;\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            rayleighColor = v_atmosphereRayleighColor;\n            mieColor = v_atmosphereMieColor;\n            opacity = v_atmosphereOpacity;\n        #endif\n\n        rayleighColor = colorCorrect(rayleighColor);\n        mieColor = colorCorrect(mieColor);\n\n        vec4 groundAtmosphereColor = computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);\n\n        // Fog is applied to tiles selected for fog, close to the Earth.\n        #ifdef FOG\n            vec3 fogColor = groundAtmosphereColor.rgb;\n            \n            // If there is lighting, apply that to the fog.\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float darken = clamp(dot(normalize(czm_viewerPositionWC), atmosphereLightDirection), u_minimumBrightness, 1.0);\n                fogColor *= darken;                \n            #endif\n\n            #ifndef HDR\n                fogColor.rgb = czm_acesTonemapping(fogColor.rgb);\n                fogColor.rgb = czm_inverseGamma(fogColor.rgb);\n            #endif\n            \n            const float modifier = 0.15;\n            finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor.rgb, modifier), finalColor.a);\n\n        #else\n            // The transmittance is based on optical depth i.e. the length of segment of the ray inside the atmosphere.\n            // This value is larger near the \"circumference\", as it is further away from the camera. We use it to\n            // brighten up that area of the ground atmosphere.\n            const float transmittanceModifier = 0.5;\n            float transmittance = transmittanceModifier + clamp(1.0 - groundAtmosphereColor.a, 0.0, 1.0);\n\n            vec3 finalAtmosphereColor = finalColor.rgb + groundAtmosphereColor.rgb * transmittance;\n\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float fadeInDist = u_nightFadeDistance.x;\n                float fadeOutDist = u_nightFadeDistance.y;\n            \n                float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.05, 1.0);\n                float darken = clamp(dot(normalize(positionWC), atmosphereLightDirection), 0.0, 1.0);\n                vec3 darkenendGroundAtmosphereColor = mix(groundAtmosphereColor.rgb, finalAtmosphereColor.rgb, darken);\n\n                finalAtmosphereColor = mix(darkenendGroundAtmosphereColor, finalAtmosphereColor, sunlitAtmosphereIntensity);\n            #endif\n            \n            #ifndef HDR\n                finalAtmosphereColor.rgb = vec3(1.0) - exp(-fExposure * finalAtmosphereColor.rgb);\n            #else\n                finalAtmosphereColor.rgb = czm_saturation(finalAtmosphereColor.rgb, 1.6);\n            #endif\n            \n            finalColor.rgb = mix(finalColor.rgb, finalAtmosphereColor.rgb, fade);\n        #endif\n    }\n#endif\n\n#ifdef UNDERGROUND_COLOR\n    if (czm_backFacing())\n    {\n        float distanceFromEllipsoid = max(czm_eyeHeight, 0.0);\n        float distance = max(v_distance - distanceFromEllipsoid, 0.0);\n        float blendAmount = interpolateByDistance(u_undergroundColorAlphaByDistance, distance);\n        vec4 undergroundColor = vec4(u_undergroundColor.rgb, u_undergroundColor.a * blendAmount);\n        finalColor = alphaBlend(undergroundColor, finalColor);\n    }\n#endif\n\n#ifdef TRANSLUCENT\n    if (inTranslucencyRectangle())\n    {\n      vec4 alphaByDistance = gl_FrontFacing ? u_frontFaceAlphaByDistance : u_backFaceAlphaByDistance;\n      finalColor.a *= interpolateByDistance(alphaByDistance, v_distance);\n    }\n#endif\n    \n    gl_FragColor =  finalColor;\n}\n\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n\nfloat waveFade(float edge0, float edge1, float x)\n{\n    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return pow(1.0 - y, 5.0);\n}\n\nfloat linearFade(float edge0, float edge1, float x)\n{\n    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\n// Based on water rendering by Jonas Wagner:\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\n// low altitude wave settings\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\n\n// high altitude wave settings\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\n\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)\n{\n    vec3 positionToEyeEC = -positionEyeCoordinates;\n    float positionToEyeECLength = length(positionToEyeEC);\n\n    // The double normalize below works around a bug in Firefox on Android devices.\n    vec3 normalizedPositionToEyeEC = normalize(normalize(positionToEyeEC));\n\n    // Fade out the waves as the camera moves far from the surface.\n    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n\n#ifdef SHOW_OCEAN_WAVES\n    // high altitude waves\n    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\n    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\n    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\n\n    // low altitude waves\n    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;\n    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\n    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\n\n    // blend the 2 wave layers based on distance to surface\n    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\n    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\n    vec3 normalTangentSpace =\n        (highAltitudeFade * normalTangentSpaceHighAltitude) +\n        (lowAltitudeFade * normalTangentSpaceLowAltitude);\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // fade out the normal perturbation as we move farther from the water surface\n    normalTangentSpace.xy *= waveIntensity;\n    normalTangentSpace = normalize(normalTangentSpace);\n#else\n    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 normalEC = enuToEye * normalTangentSpace;\n\n    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\n\n    // Use diffuse light to highlight the waves\n    float diffuseIntensity = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * maskValue;\n    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);\n\n#ifdef SHOW_OCEAN_WAVES\n    // Where diffuse light is low or non-existent, use wave highlights based solely on\n    // the wave bumpiness and no particular light direction.\n    float tsPerturbationRatio = normalTangentSpace.z;\n    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\n    vec3 nonDiffuseHighlight = vec3(0.0);\n#endif\n\n    // Add specular highlights in 3D, and in all modes when zoomed in.\n    float specularIntensity = czm_getSpecular(czm_lightDirectionEC, normalizedPositionToEyeEC, normalEC, 10.0);\n    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\n    float specular = specularIntensity * surfaceReflectance;\n\n#ifdef HDR\n    specular *= 1.4;\n\n    float e = 0.2;\n    float d = 3.3;\n    float c = 1.7;\n\n    vec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));\n#else\n    vec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;\n#endif\n\n    return vec4(color, imageryColor.a);\n}\n\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n";const{BoundingSphere:Tl,buildModuleUrl:Al,Cartesian3:El,Cartographic:Pl,Color:Ll,defaultValue:Dl,defined:Ml,destroyObject:Rl,DeveloperError:Il,Ellipsoid:Nl,EllipsoidTerrainProvider:Ol,Event:Fl,IntersectionTests:kl,NearFarScalar:zl,Ray:Bl,Rectangle:Gl,Resource:Hl,ShaderSource:Wl,Texture:Ul,when:jl,GlobeSurfaceShaderSet:Vl,GlobeSurfaceTileProvider:ql,GlobeTranslucency:$l,ImageryLayerCollection:Yl,QuadtreePrimitive:Xl,SceneMode:Jl,ShadowMode:Zl}=Cesium,Ql=Cesium._shadersGlobeVS,Kl=Cesium._shadersAtmosphereCommon,ec=Cesium._shadersGroundAtmosphere;function tc(e){e=Dl(e,Nl.WGS84);const t=new Ol({ellipsoid:e}),i=new Yl;this._ellipsoid=e,this._imageryLayerCollection=i,this._from="cesiumpro-globe",this._surfaceShaderSet=new Vl,this._material=void 0,this._surface=new Xl({tileProvider:new ql({terrainProvider:t,imageryLayers:i,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new Fl,this._undergroundColor=Ll.clone(Ll.BLACK),this._undergroundColorAlphaByDistance=new zl(e.maximumRadius/1e3,0,e.maximumRadius/5,1),this._translucency=new $l,ic(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new Hl({url:Al("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.lambertDiffuseMultiplier=.9,this.dynamicAtmosphereLighting=!0,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!0,this.atmosphereLightIntensity=10,this.atmosphereRayleighCoefficient=new El(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new El(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=Zl.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.showSkirts=!0,this.backFaceCulling=!0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0}function ic(e){const t=[],i=Ml(e._material)&&(e._material.shaderSource.match(/slope/)||e._material.shaderSource.match("normalEC")),n=[Kl,ec];!Ml(e._material)||i&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.materialUniformMap=void 0:(n.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.materialUniformMap=e._material._uniforms),n.push(Sl),e._surfaceShaderSet.baseVertexShaderSource=new Wl({sources:[Kl,ec,Ql],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new Wl({sources:n,defines:t}),e._surfaceShaderSet.material=e._material}Object.defineProperties(tc.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return!Ml(this._surface)||this._surface.tileProvider.ready&&0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){Ml(e)||(e=Gl.clone(Gl.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),Ml(this._material)&&ic(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,ic(this))}},undergroundColor:{get:function(){return this._undergroundColor},set:function(e){this._undergroundColor=Ll.clone(e,this._undergroundColor)}},undergroundColorAlphaByDistance:{get:function(){return this._undergroundColorAlphaByDistance},set:function(e){this._undergroundColorAlphaByDistance=zl.clone(e,this._undergroundColorAlphaByDistance)}},translucency:{get:function(){return this._translucency}}});const nc=[],rc={start:0,stop:0};tc.prototype.pickWorldCoordinates=function(e,t,i,n){i=Dl(i,!0);const r=t.mode,o=t.mapProjection,s=nc;s.length=0;const a=this._surface._tilesToRender;let l,c,u=a.length;for(c=0;c<u;++c){l=a[c];const t=l.data;if(!Ml(t))continue;let i=t.pickBoundingSphere;if(r!==Jl.SCENE3D)t.pickBoundingSphere=i=Tl.fromRectangleWithHeights2D(l.rectangle,o,t.tileBoundingRegion.minimumHeight,t.tileBoundingRegion.maximumHeight,i),El.fromElements(i.center.z,i.center.x,i.center.y,i.center);else{if(!Ml(t.renderedMesh))continue;Tl.clone(t.tileBoundingRegion.boundingSphere,i)}const n=kl.raySphere(e,i,rc);Ml(n)&&s.push(t)}var h;let d;for(s.sort((h=e.origin,function(e,t){return Tl.distanceSquaredTo(e.pickBoundingSphere,h)-Tl.distanceSquaredTo(t.pickBoundingSphere,h)})),u=s.length,c=0;c<u&&(d=s[c].pick(e,t.mode,t.mapProjection,i,n),!Ml(d));++c);return d};const oc=new Pl;tc.prototype.pick=function(e,t,i){if(i=this.pickWorldCoordinates(e,t,!0,i),Ml(i)&&t.mode!==Jl.SCENE3D){i=El.fromElements(i.y,i.z,i.x,i);const e=t.mapProjection.unproject(i,oc);i=t.globe.ellipsoid.cartographicToCartesian(e,i)}return i};const sc=new El,ac=new El,lc=new Pl,cc=new Bl;function uc(e,t){return Ml(e)&&Gl.contains(e.rectangle,t)?e:void 0}tc.prototype.getHeight=function(e){const t=this._surface._levelZeroTiles;if(!Ml(t))return;let i,n;const r=t.length;for(n=0;n<r&&(i=t[n],!Gl.contains(i.rectangle,e));++n);if(n>=r)return;let o=i;for(;Ml(i);)i=uc(i._southwestChild,e)||uc(i._southeastChild,e)||uc(i._northwestChild,e)||i._northeastChild,Ml(i)&&Ml(i.data)&&Ml(i.data.renderedMesh)&&(o=i);if(i=o,!Ml(i)||!Ml(i.data)||!Ml(i.data.renderedMesh))return;const s=this._surface._tileProvider.tilingScheme.projection,a=this._surface._tileProvider.tilingScheme.ellipsoid,l=El.fromRadians(e.longitude,e.latitude,0,a,sc),c=cc,u=a.geodeticSurfaceNormal(l,c.direction),h=a.getSurfaceNormalIntersectionWithZAxis(l,11500,c.origin);if(!Ml(h)){let e;Ml(i.data.tileBoundingRegion)&&(e=i.data.tileBoundingRegion.minimumHeight);const t=Math.min(Dl(e,0),-11500),n=El.multiplyByScalar(u,Math.abs(t)+1,ac);El.subtract(l,n,c.origin)}const d=i.data.pick(c,void 0,s,!1,ac);return Ml(d)?a.cartesianToCartographic(d,lc).height:void 0},tc.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},tc.prototype.beginFrame=function(e){const t=this._surface,i=t.tileProvider,n=this.terrainProvider,r=this.showWaterEffect&&n.ready&&n.hasWaterMask;if(r&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;const t=this._oceanNormalMapResource,i=t.url;if(Ml(i)){const n=this;t.fetchImage().then((function(t){i===n._oceanNormalMapResource.url&&(n._oceanNormalMap=n._oceanNormalMap&&n._oceanNormalMap.destroy(),n._oceanNormalMap=new Ul({context:e.context,source:t}))}))}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}const o=e.passes,s=e.mode;o.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,t.loadingDescendantLimit=this.loadingDescendantLimit,t.preloadAncestors=this.preloadAncestors,t.preloadSiblings=this.preloadSiblings,i.terrainProvider=this.terrainProvider,i.lightingFadeOutDistance=this.lightingFadeOutDistance,i.lightingFadeInDistance=this.lightingFadeInDistance,i.nightFadeOutDistance=this.nightFadeOutDistance,i.nightFadeInDistance=this.nightFadeInDistance,i.zoomedOutOceanSpecularIntensity=s===Jl.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,i.hasWaterMask=r,i.oceanNormalMap=this._oceanNormalMap,i.enableLighting=this.enableLighting,i.dynamicAtmosphereLighting=this.dynamicAtmosphereLighting,i.dynamicAtmosphereLightingFromSun=this.dynamicAtmosphereLightingFromSun,i.showGroundAtmosphere=this.showGroundAtmosphere,i.atmosphereLightIntensity=this.atmosphereLightIntensity,i.atmosphereRayleighCoefficient=this.atmosphereRayleighCoefficient,i.atmosphereMieCoefficient=this.atmosphereMieCoefficient,i.atmosphereRayleighScaleHeight=this.atmosphereRayleighScaleHeight,i.atmosphereMieScaleHeight=this.atmosphereMieScaleHeight,i.atmosphereMieAnisotropy=this.atmosphereMieAnisotropy,i.shadows=this.shadows,i.hueShift=this.atmosphereHueShift,i.saturationShift=this.atmosphereSaturationShift,i.brightnessShift=this.atmosphereBrightnessShift,i.fillHighlightColor=this.fillHighlightColor,i.showSkirts=this.showSkirts,i.backFaceCulling=this.backFaceCulling,i.undergroundColor=this._undergroundColor,i.undergroundColorAlphaByDistance=this._undergroundColorAlphaByDistance,i.lambertDiffuseMultiplier=this.lambertDiffuseMultiplier,t.beginFrame(e))},tc.prototype.render=function(e){this.show&&(Ml(this._material)&&this._material.update(e.context),this._surface.render(e))},tc.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},tc.prototype.isDestroyed=function(){return!1},tc.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),Rl(this)};const{ShaderProgram:hc,RuntimeError:dc,createUniform:pc,defined:mc,createUniformArray:fc,WebGLConstants:gc}=Cesium;function _c(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}const yc=Cesium.AutomaticUniforms,vc="[Cesium WebGL] ",Cc={...yc,czm_p_drawingBufferWidth:new _c({size:1,datatype:gc.FLOAT,getValue:function(e){return e.frameState.context.drawingBufferWidth}}),czm_p_drawingBufferHeight:new _c({size:1,datatype:gc.FLOAT,getValue:function(e){return e.frameState.context.drawingBufferHeight}}),czm_p_splitPosition:new _c({size:1,datatype:gc.FLOAT,getValue:function(e){return e.frameState.splitPosition}})};function xc(e){mc(e._program)||wc(e)}function wc(e){var t=e._program,i=e._gl,n=function(e,t){var i=t._vertexShaderText,n=t._fragmentShaderText,r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,i),e.compileShader(r);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,n),e.compileShader(o);var s=e.createProgram();e.attachShader(s,r),e.attachShader(s,o),e.deleteShader(r),e.deleteShader(o);var a,l=t._attributeLocations;if(mc(l))for(var c in l)l.hasOwnProperty(c)&&e.bindAttribLocation(s,l[c],c);if(e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS)){var u=t._debugShaders;if(!e.getShaderParameter(o,e.COMPILE_STATUS)){if(a=e.getShaderInfoLog(o),console.error(vc+"Fragment shader compile log: "+a),mc(u)){var h=u.getTranslatedShaderSource(o);""!==h?console.error(vc+"Translated fragment shader source:\n"+h):console.error(vc+"Fragment shader translation failed.")}throw e.deleteProgram(s),new dc("Fragment shader failed to compile.  Compile log: "+a)}if(!e.getShaderParameter(r,e.COMPILE_STATUS)){if(a=e.getShaderInfoLog(r),console.error(vc+"Vertex shader compile log: "+a),mc(u)){var d=u.getTranslatedShaderSource(r);""!==d?console.error(vc+"Translated vertex shader source:\n"+d):console.error(vc+"Vertex shader translation failed.")}throw e.deleteProgram(s),new dc("Vertex shader failed to compile.  Compile log: "+a)}throw a=e.getProgramInfoLog(s),console.error(vc+"Shader program link log: "+a),mc(u)&&(console.error(vc+"Translated vertex shader source:\n"+u.getTranslatedShaderSource(r)),console.error(vc+"Translated fragment shader source:\n"+u.getTranslatedShaderSource(o))),e.deleteProgram(s),new dc("Program failed to link.  Link log: "+a)}var p=t._logShaderCompilation;return p&&(a=e.getShaderInfoLog(r),mc(a)&&a.length>0&&console.log(vc+"Vertex shader compile log: "+a)),p&&(a=e.getShaderInfoLog(o),mc(a)&&a.length>0&&console.log(vc+"Fragment shader compile log: "+a)),p&&(a=e.getProgramInfoLog(s),mc(a)&&a.length>0&&console.log(vc+"Shader program link log: "+a)),s}(i,e,e._debugShaders),r=i.getProgramParameter(n,i.ACTIVE_ATTRIBUTES),o=function(e,t){for(var i={},n=[],r=[],o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),s=0;s<o;++s){var a=e.getActiveUniform(t,s),l=-1!==a.name.indexOf("[0]",a.name.length-"[0]".length)?a.name.slice(0,a.name.length-3):a.name;if(0!==l.indexOf("gl_"))if(a.name.indexOf("[")<0){var c=e.getUniformLocation(t,l);if(null!==c){var u=pc(e,a,l,c);i[l]=u,n.push(u),u._setSampler&&r.push(u)}}else{var h,d,p,m,f=l.indexOf("[");if(f>=0){if(h=i[l.slice(0,f)],!mc(h))continue;(d=h._locations).length<=1&&(p=h.value,null!==(m=e.getUniformLocation(t,l))&&(d.push(m),p.push(e.getUniform(t,m))))}else{d=[];for(var g=0;g<a.size;++g)null!==(m=e.getUniformLocation(t,l+"["+g+"]"))&&d.push(m);h=fc(e,a,l,d),i[l]=h,n.push(h),h._setSampler&&r.push(h)}}}return{uniformsByName:i,uniforms:n,samplerUniforms:r}}(i,n),s=function(e,t){var i=[],n=[];for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],s=r,a=e._duplicateUniformNames[s];mc(a)&&(o.name=a,s=a);var l=Cc[s];mc(l)?i.push({uniform:o,automaticUniform:l}):n.push(o)}return{automaticUniforms:i,manualUniforms:n}}(e,o.uniformsByName);e._program=n,e._numberOfVertexAttributes=r,e._vertexAttributes=function(e,t,i){for(var n={},r=0;r<i;++r){var o=e.getActiveAttrib(t,r),s=e.getAttribLocation(t,o.name);n[o.name]={name:o.name,type:o.type,index:s}}return n}(i,n,r),e._uniformsByName=o.uniformsByName,e._uniforms=o.uniforms,e._automaticUniforms=s.automaticUniforms,e._manualUniforms=s.manualUniforms,e.maximumTextureUnitIndex=function(e,t,i){e.useProgram(t);for(var n=0,r=i.length,o=0;o<r;++o)n=i[o]._setSampler(n);return e.useProgram(null),n}(i,n,o.samplerUniforms),t&&e._gl.deleteProgram(t),"undefined"!=typeof spector&&(e._program.__SPECTOR_rebuildProgram=function(t,i,n,r){var o=e._vertexShaderText,s=e._fragmentShaderText,a=/ ! = /g;e._vertexShaderText=t.replace(a," != "),e._fragmentShaderText=i.replace(a," != ");try{wc(e),n(e._program)}catch(t){e._vertexShaderText=o,e._fragmentShaderText=s;var l=/(?:Compile|Link) error: ([^]*)/.exec(t.message);r(l?l[1]:t.message)}})}function bc(){const e=hc.prototype;hc.prototype={},hc.prototype._bind=function(){xc(this),this._gl.useProgram(this._program)},hc.prototype.destroy=e.destroy,hc.prototype._setUniforms=function(t,i,n){e._setUniforms.call(this,t,i,n)},hc.prototype.isDestroyed=e.isDestroyed,hc.prototype.finalDestroy=e.finalDestroy,Object.defineProperties(hc.prototype,{vertexAttributes:{get:function(){return xc(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return xc(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return xc(this),this._uniformsByName}},vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}}})}const Sc=Cesium.Scene,{JulianDate:Tc,defined:Ac,RequestScheduler:Ec,PerformanceDisplay:Pc,Cesium3DTilePassState:Lc,Cesium3DTilePass:Dc,defaultValue:Mc,Color:Rc,BoundingRectangle:Ic,Pass:Nc,SunLight:Oc,Cartesian3:Fc}=Cesium,kc=new Lc({pass:Dc.PRELOAD}),zc=new Lc({pass:Dc.PRELOAD_FLIGHT}),Bc=new Lc({pass:Dc.REQUEST_RENDER_MODE_DEFER_CHECK});function Gc(e,t){try{t(e)}catch(t){if(e._renderError.raiseEvent(e,t),e.rethrowRenderErrors)throw t}}function Hc(e){e._jobScheduler.resetBudgets();var t=e._frameState;e.primitives.prePassesUpdate(t),Ac(e.globe)&&e.globe.update(t),e._picking.update(),t.creditDisplay.update()}function Wc(e){return e._picking.updateMostDetailedRayPicks(e)}function Uc(e){var t=e._frameState;kc.camera=t.camera,kc.cullingVolume=t.cullingVolume,e.primitives.updateForPass(t,kc)}function jc(e){var t=e._frameState;t.camera.canPreloadFlight()&&(zc.camera=e.preloadFlightCamera,zc.cullingVolume=e.preloadFlightCullingVolume,e.primitives.updateForPass(t,zc))}const Vc=new Lc({pass:Dc.RENDER});function qc(e){e.primitives.updateForPass(e._frameState,Bc)}function $c(e){var t=e._frameState;e.primitives.postPassesUpdate(t),Ec.update()}function Yc(e){var t=e._frameState,i=e.context,n=i.uniformState,r=e._defaultView;e._view=r,e.updateFrameState(),t.passes.render=!0,t.passes.postProcess=e.postProcessStages.hasSelected,t.tilesetPassState=Vc;var o=Mc(e.backgroundColor,Rc.BLACK);e._hdr&&((o=Rc.clone(o,scratchBackgroundColor)).red=Math.pow(o.red,e.gamma),o.green=Math.pow(o.green,e.gamma),o.blue=Math.pow(o.blue,e.gamma)),t.backgroundColor=o,e.fog.update(t),n.update(t);var s=e.shadowMap;Ac(s)&&s.enabled&&(!Ac(e.light)||e.light instanceof Oc?Fc.negate(n.sunDirectionWC,e._shadowMapCamera.direction):Fc.clone(e.light.direction,e._shadowMapCamera.direction),t.shadowMaps.push(s)),e._computeCommandList.length=0,e._overlayCommandList.length=0;var a=r.viewport;a.x=0,a.y=0,a.width=i.drawingBufferWidth,a.height=i.drawingBufferHeight;var l=r.passState;l.framebuffer=void 0,l.blendingEnabled=void 0,l.scissorTest=void 0,l.viewport=Ic.clone(a,l.viewport),Ac(e.globe)&&(e.globe.beginFrame(t),e._vectorTileQuadtree.beginFrame(t)),e.updateEnvironment(),e.updateAndExecuteCommands(l,o),e.globe&&e._vectorTileQuadtree.render(t),e.resolveFramebuffers(l),l.framebuffer=void 0,function(e,t){e.context.uniformState.updatePass(Nc.OVERLAY);for(var i=e.context,n=e._overlayCommandList,r=n.length,o=0;o<r;++o)n[o].execute(i,t)}(e,l),Ac(e.globe)&&(e.globe.endFrame(t),e._vectorTileQuadtree.endFrame(t),e.globe.tilesLoaded||(e._renderRequested=!0)),i.endFrame()}function Xc(e){this._preUpdate.raiseEvent(this,e);var t=this._frameState;t.newFrame=!1,Ac(e)||(e=Tc.now());var i=this._view.checkForCameraUpdates(this),n=!this.requestRenderMode||this._renderRequested||i||this._logDepthBufferDirty||this._hdrDirty||this.mode===SceneMode.MORPHING;if(!n&&Ac(this.maximumRenderTimeChange)&&Ac(this._lastRenderTime)){var r=Math.abs(Tc.secondsDifference(this._lastRenderTime,e));n=n||r>this.maximumRenderTimeChange}n&&(this._lastRenderTime=Tc.clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1,function(e,t,i){var n=e._frameState;n.frameNumber=t,n.time=Tc.clone(i,n.time)}(this,Cesium.Math.incrementWrap(t.frameNumber,15e6,1),e),t.newFrame=!0);Gc(this,Hc),this.primitives.show&&(Gc(this,Wc),Gc(this,Uc),Gc(this,jc),n||Gc(this,qc)),this._postUpdate.raiseEvent(this,e),n&&(this._preRender.raiseEvent(this,e),t.creditDisplay.beginFrame(),Gc(this,Yc)),function(e,t){if(e.debugShowFramesPerSecond){if(!Ac(e._performanceDisplay)){var i=document.createElement("div");i.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(i);var n=new Pc({container:i});e._performanceDisplay=n,e._performanceContainer=i}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else Ac(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}(this,n),Gc(this,$c),function(e){for(var t=e._frameState.afterRender,i=0,n=t.length;i<n;++i)t[i](),e.requestRender();t.length=0}(this),n&&(this._postRender.raiseEvent(this,e),t.creditDisplay.endFrame())}function Jc(){(class{static overrideRenderFunction(){Sc.prototype.render=Xc}}).overrideRenderFunction()}const{Primitive:Zc,ShaderProgram:Qc,defined:Kc,DeveloperError:eu,defaultValue:tu,ShaderSource:iu}=Cesium,nu=Zc.prototype.update;function ru(e){return iu.replaceMain(e,"czm_non_pick_main")+"\nvarying vec4 v_pickColor; \nvoid main() \n{ \n    czm_non_pick_main(); \n    v_pickColor = czm_batchTable_pickColor(batchId); \n}"}function ou(e,t){if(!e.compressVertices)return t;var i=-1!==t.search(/attribute\s+vec3\s+normal;/g),n=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!i&&!n)return t;var r=-1!==t.search(/attribute\s+vec3\s+tangent;/g),o=-1!==t.search(/attribute\s+vec3\s+bitangent;/g),s=n&&i?2:1,a="compressedAttributes",l="attribute "+((s+=r||o?1:0)>1?"vec"+s:"float")+" "+a+";",c="",u="";n&&(c+="vec2 st;\n",u+="    st = czm_decompressTextureCoordinates("+(s>1?a+".x":a)+");\n");i&&r&&o?(c+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",u+="    czm_octDecode("+a+"."+(n?"yz":"xy")+", normal, tangent, bitangent);\n"):(i&&(c+="vec3 normal;\n",u+="    normal = czm_octDecode("+a+(s>1?"."+(n?"y":"x"):"")+");\n"),r&&(c+="vec3 tangent;\n",u+="    tangent = czm_octDecode("+a+"."+(n&&i?"z":"y")+");\n"),o&&(c+="vec3 bitangent;\n",u+="    bitangent = czm_octDecode("+a+"."+(n&&i?"z":"y")+");\n"));var h=t;return h=(h=(h=(h=h.replace(/attribute\s+vec3\s+normal;/g,"")).replace(/attribute\s+vec2\s+st;/g,"")).replace(/attribute\s+vec3\s+tangent;/g,"")).replace(/attribute\s+vec3\s+bitangent;/g,""),[l,c,h=iu.replaceMain(h,"czm_non_compressed_main"),"void main() \n{ \n"+u+"    czm_non_compressed_main(); \n}"].join("\n")}function su(e){return"varying vec4 v_pickColor;\n"+e}function au(e,t){e.vertexAttributes}function lu(e,t,i){const n=t.context,r=e._attributeLocations;let o=e._batchTable.getVertexShaderCallback()(i.vertexShaderSource);o=Zc._appendOffsetToShader(e,o),o=Zc._appendShowToShader(e,o),o=Zc._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=ru(o),o=Zc._updateColorAttribute(e,o,!1),o=ou(e,o),o=Zc._modifyShaderPosition(e,o,t.scene3DOnly);var s,a,l=i.getFragmentShaderSource();l=su(l),e._sp=Qc.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:o,fragmentShaderSource:l,attributeLocations:r}),au(e._sp),Kc(e._depthFailAppearance)&&(o=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),o=Zc._appendShowToShader(e,o),o=Zc._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=ru(o),o=Zc._updateColorAttribute(e,o,!0),o=ou(e,o),o=Zc._modifyShaderPosition(e,o,t.scene3DOnly),a=o,o=iu.replaceMain(a,"czm_non_depth_clamp_main")+"void main() {\n    czm_non_depth_clamp_main();\n    gl_Position = czm_depthClamp(gl_Position);}\n",l=su(l=e._depthFailAppearance.getFragmentShaderSource()),s=l,l="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n"+iu.replaceMain(s,"czm_non_depth_clamp_main")+"void main() {\n    czm_non_depth_clamp_main();\n#if defined(GL_EXT_frag_depth)\n    #if defined(LOG_DEPTH)\n        czm_writeLogDepth();\n    #else\n        czm_writeDepthClamp();\n    #endif\n#endif\n}\n",e._spDepthFail=Qc.replaceCache({context:n,shaderProgram:e._spDepthFail,vertexShaderSource:o,fragmentShaderSource:l,attributeLocations:r}),au(e._spDepthFail))}function cu(){Jc(),bc()}const{Resource:uu}=Cesium;class hu{constructor(e={}){if(this._url=e.url,this._typeName=e.typeName,this._style=e.style,!x(this._url))throw new t("parameter url must be provided.");if(!x(this._typeName))throw new t("parameter typeName must be provided.");const i=new uu({url:e.url,queryParameters:{service:"WFS",version:"1.0.0",request:"GetFeature",typeName:e.typeName,maxFeatures:50,outputFormat:"application/json"}});this._dataSource=ws.load(i,this._style)}get rectangle(){return this._rectangle||this.tilingScheme.rectangle}get tilingScheme(){return Fr.get("EPSG:4326")}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get ready(){return this._ready}get readyPromise(){return this._readyPromise}}const{CustomDataSource:du,Color:pu,HeightReference:mu,HorizontalOrigin:fu,VerticalOrigin:gu}=Cesium;class _u{constructor(e,t={}){this.viewer=e,this.pointStyle=C(t.point,{color:pu.RED,pixelSize:10,outlineColor:pu.WHITE,outlineWidth:4}),this.lineStyle=C(t.polyline,{width:5,material:pu.GOLD.withAlpha(.5),clampToGround:!0}),this.labelStyle=C(t.label,{fillColor:pu.WHITE,showBackground:!0,horizontalOrigin:fu.LEFT,verticalOrigin:gu.TOP,showBackground:!0,backgroundColor:pu.BLACK.withAlpha(.5),fillColor:pu.WHITE,font:"40px sans-serif",scale:.5}),this.polygonStyle=C(t.polygon,{material:pu.GOLD.withAlpha(.6)}),this.ds=new du("cesiumpro-default"),e.dataSources.add(this.ds)}addPoint(e,t,i){const n=Object.assign({position:new w(e,t,i).toCartesian()},{point:this.pointStyle});return this.ds.entities.add(n)}addLabel(e,t,i,n){const r=Object.assign({position:new w(t,i,n).toCartesian()},{label:Object.assign({text:e},this.labelStyle)});return this.ds.entities.add(r)}addPolyline(e){const t=Object.assign({positions:e},this.labelStyle);return this.ds.entities.add({polyline:t})}addPolygon(e,t){const i=Object.assign({hierarchy:e,height:t},this.labelStyle);return this.ds.entities.add({polygon:i})}remove(e){this.entities.remove(e)}clear(){this.entities.removeAll()}destroy(){this.viewer.dataSources.remove(this.ds),this.ds.destroy()}}const{Matrix4:yu,BoundingSphere:vu,ScreenSpaceEventType:Cu,ScreenSpaceEventHandler:xu}=Cesium;function wu(e,t,i){e.camera.flyToBoundingSphere(t,{duration:i.duration,maximumHeight:i.maximumHeight,endTransform:i.endTransform,offset:i.offset,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!0)},offset:i.offset})}let bu,Su,Tu=0,Au=0,Eu="N/A",Pu="N/A";function Lu(e){return null!=e&&"object"==typeof e&&"function"==typeof e.then}function Du(e,t,i,n){const r=Cesium.Cartesian3.fromDegrees(t,i,n),o=e.camera,s=o.heading,a=o.pitch,l=function(e,t,i){t=Cesium.Math.clamp(t,-Cesium.Math.PI_OVER_TWO,Cesium.Math.PI_OVER_TWO),e=Cesium.Math.zeroToTwoPi(e)-Cesium.Math.PI_OVER_TWO;const n=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,-t),r=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Z,-e),o=Cesium.Quaternion.multiply(r,n,r),s=Cesium.Matrix3.fromQuaternion(o),a=Cesium.Cartesian3.clone(Cesium.Cartesian3.UNIT_X);return Cesium.Matrix3.multiplyByVector(s,a,a),Cesium.Cartesian3.negate(a,a),Cesium.Cartesian3.multiplyByScalar(a,i,a),a}(s,a,2*n),c=Cesium.Transforms.eastNorthUpToFixedFrame(r);Cesium.Matrix4.multiplyByPoint(c,l,r),o.setView({destination:r,orientation:{heading:s,pitch:a},easingFunction:Cesium.EasingFunction.QUADRATIC_OUT})}function Mu(e,t){e.infoBox&&(t._infoBox=function(e){const t=document.createElement("div");t.className="cesium-viewer-infoBoxContainer",e.container.appendChild(t);const i=new Ja(t),n=i.viewModel;return e._eventHelper.add(n.cameraClicked,Iu.prototype._onInfoBoxCameraClicked,e),e._eventHelper.add(n.closeClicked,Iu.prototype._onInfoBoxClockClicked,e),e._enableInfoOrSelection=!0,i}(t))}function Ru(e,t,i){const n=e._zoomPromise=new Promise((t=>{e._completeZoom=function(e){t(e)}}));return t.readyPromise.then((()=>{if(t._boundingSpheres)wu(e,vu.fromBoundingSpheres(t._boundingSpheres),i);else if(t.boundingSphere){let n=t.boundingSphere;n=vu.clone(n),wu(e,n,i)}})),n}class Iu extends Cesium.Viewer{constructor(e,t={}){cu(),t=Object.assign({animation:!1,timeline:!1,geocoder:!1,homeButton:!1,navigationHelpButton:!1,baseLayerPicker:!1,fullscreenElement:"cesiumContainer",fullscreenButton:!1,shouldAnimate:!0,infoBox:!1,selectionIndicator:!1,sceneModePicker:!1,shadows:!1,imageryProvider:Do()},t),Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Cesium.Rectangle.fromDegrees(70,5,130,60),!1===t.globe&&(t.imageryProvider=void 0);const i=Object.assign({},t,{infoBox:!1});i.globe?i.globe=new tc(i.globe._ellipsoid):!1!==i.globe&&(i.globe=new tc),super(e,i);const n=document.querySelector(".cesium-credit-logoContainer");if(n&&n.parentElement.removeChild(n),Mu(t,this),this._options=t,this.scene.postRender.addEventListener(this.update,this),this._distancePerPixel=void 0,this._extent=void 0,this._center=void 0,this._autoRotation=!1,this.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.scene.globe){const e=new bl({terrainProvider:this.terrainProvider,scene:this.scene}),t=new Cesium.QuadtreePrimitive({tileProvider:e});this.scene._vectorTileQuadtree=t}this.scene.dataSources=this.dataSources,this._graphicGroup=new jn(this),this.dds=new _u(this)}get graphicGroup(){return this._graphicGroup}get vectorTileCollection(){return this.scene._vectorTileQuadtree.tileProvider._layers}get entities(){return super.entities}get primitives(){return this.scene.primitives}get enableLighting(){if(x(this.globe))return this.scene.globe.enableLighting}set enableLighting(e){x(this.globe)&&(this.scene.globe.enableLighting=e)}get autoRotation(){return this._autoRotation}set autoRotation(e){this._autoRotation=e}get fxaa(){return this.scene.postProcessStages.fxaa.enabled}set fxaa(e){this.scene.postProcessStages.fxaa.enabled=e}get distancePerPixel(){return this._distancePerPixel}get extent(){return this._extent}get center(){return this._center}get container(){return this._container}get layers(){return this.scene.imageryLayers}get dataSources(){return super.dataSources}get globe(){return this.scene.globe}get ellipsoid(){if(this.globe)return this.globe.ellipsoid}get terrain(){return this.terrainProvider}set terrain(e){x(e)&&!1!==e||(this.terrainProvider=new Cesium.EllipsoidTerrainProvider),e!==this.terrainProvider&&(this.terrainProvider=e)}get terrainChanged(){return this.scene.terrainProviderChanged}get terrainExaggeration(){if(this.globe)return this.globe.terrainExaggeration}set terrainExaggeration(e){e<0&&(e=0),this.globe&&(this.globe.terrainExaggeration=e)}get showFps(){return this.scene.debugShowFramesPerSecond}set showFps(e){this.scene.debugShowFramesPerSecond=e}get fps(){return this._fps+"FPS"}get ms(){return this._ms+"MS"}get heading(){return Cesium.Math.toDegrees(this.camera.heading)}get pitch(){return Cesium.Math.toDegrees(this.camera.pitch)}get roll(){return Cesium.Math.toDegrees(this.camera.roll)}get depthTest(){return this.scene.globe.depthTestAgainstTerrain}set depthTest(e){this.scene.globe.depthTestAgainstTerrain=e}addModel(e){this.primitives.add(e.delegate)}removeModel(e){this.primitives.remove(e.delegate)}setView(e){let t;e instanceof Cesium.Cartographic?t=w.fromCartographic(e):e instanceof Cesium.Cartesian3?t=w.fromCartesian(e):e instanceof w&&(t=e),t&&Du(this,t.lon,t.lat,t.alt)}stepFlyTo(e={}){let t;e.destination instanceof Cesium.Cartesian3?t=w.fromCartesian(e.destination):e.destination instanceof Cesium.Cartographic?t=w.fromCartographic(e.destination):e.destination instanceof w&&(t=e.destination),t&&(e.destination=t,function(e,t={}){const{camera:i}=e,n=C(t.step1Duration,3),r=C(t.step2Duration,3),o=C(t.step3Duration,3),s=t.destination,a=e.camera._positionCartographic.height,l=Cesium.Cartesian3.fromDegrees(s.lon,s.lat,a),c=t.destination.toCartesian();new Promise((e=>{i.flyTo({destination:l,duration:n,complete(){i.flyTo({destination:c,duration:r,complete(){i.flyTo({destination:c,orientation:t.orientation,duration:o,complete(){e()}})}})}})}))}(this,e))}linkView(e){if(!x(e))throw new t("viewer不是一个有效的Cesium.Viewer对象");return function(e,t){let i,n;return n=function n(r,o){return r.scene.postRender.addEventListener((()=>{const s=r.camera.positionWC,a=r.camera.heading,l=r.camera.pitch,c=r.camera.roll;i&&(i(),i=void 0),o.camera.flyTo({destination:s,orientation:{heading:a,pitch:l,roll:c},duration:0,complete:function(){i=n(t,e)},cancel:function(){i=n(t,e)}})}))}(e,t),function(){n&&n(),i&&i()}}(this,e)}flyTo(e,t={}){if(!e)return;if(e instanceof w){const i=e.toCartesian();return this.flyTo(i,t)}const i=this;if(e instanceof Cesium.Cartesian3){const n=viewer._zoomPromise=new Promise((e=>{i._completeZoom=function(t){e(t)}})),r=C(t.radius,1e3);delete t.radius;return wu(this,new Cesium.BoundingSphere(e,r),t),n}if(e instanceof Cesium.Primitive)return Ru(this,e,t);if(e instanceof Cesium.Model)return Ru(this,e,t);if(e instanceof qr)return Ru(this,e.delegate,t);if(e instanceof Qa)return super.flyTo(e.delegate,t);if(e instanceof Cesium.Cesium3DTileset)super.flyTo(e,t);else if(e.boundingSphere){const t=e.modelMatrix||yu.IDENTITY,i=yu.multiplyByPoint(t,e.boundingSphere.center,{}),n=new vu(i,e.boundingSphere.radius);return this.camera.flyToBoundingSphere(n)}return super.flyTo(e,t)}rotateAroundPoint(e,t={}){const i=this;let n;if(e instanceof Cesium.Cartesian3)n=e;else if(e instanceof Cesium.Cartographic)n=Cesium.Cartographic.toCartesian(e);else{if(!(e instanceof w))return;n=e.toCartesian()}const r=C(t.multiplier,1),o=C(t.offset,{});return this._cancelRotateAroundPoint&&(this._cancelRotateAroundPoint(),this._cancelRotateAroundPoint=void 0),this._cancelRotateAroundPoint=this.scene.postRender.addEventListener((function(){const e=Cesium.Math.toRadians(C(o.heading,i.heading)+1*r),t=Cesium.Math.toRadians(C(o.pitch,-20)),s=C(o.range,1e4);i.flyTo(n,{duration:0,offset:new Cesium.HeadingPitchRange(e,t,s)})})),this._cancelRotateAroundPoint}addLayer(e){return e instanceof Cesium.GeoJsonDataSource||e instanceof Cesium.KmlDataSource||e instanceof Cesium.CzmlDataSource||e instanceof Cesium.CustomDataSource||e instanceof ws||e instanceof Ha||Lu(e)?this.dataSources.add(e):e instanceof hu?this.dataSources.add(e._dataSource):this.layers.addImageryProvider(e)}removeLayer(e){if(Lu(e))e.then((e=>{this.removeLayer(e)}));else{this.layers.remove(e)||this.dataSources.remove(e)}}pickLayer(e){const t=this.scene,i=t.camera.getPickRay(e);return this.layers.pickImageryLayerFeatures(i,t)}render(){super.render()}update(){const e=function(){x(bu)||(bu=Cesium.getTimestamp()),x(Su)||(Su=Cesium.getTimestamp()),Tu++;const e=Cesium.getTimestamp();let t=(e-bu)/1e3;return t>1&&(Eu=Tu/t||0,bu=e,Tu=0,Eu=Eu.toFixed(0)),Au++,t=e-Su,t>100&&(Pu=t/Au,Su=e,Au=0,Pu=Pu.toFixed(2)),{ms:Pu,fps:Eu}}();this._fps=e.fps,this._ms=e.ms;const t=Be(this);t&&(this._distancePerPixel=t),this._extent=He(this),this._center=Ge(this),this._autoRotation&&function(e){if(!e||e.scene.mode!==Cesium.SceneMode.SCENE3D)return;const t=Cesium.Transforms.computeIcrfToFixedMatrix(e.clock.currentTime);if(x(t)){const i=e.camera,n=Cesium.Cartesian3.clone(i.position),r=Cesium.Matrix4.fromRotationTranslation(t);i.lookAtTransform(r,n)}}(this),this.graphicGroup.update(this.clock.currentTime)}resize(){super.resize()}forceResize(){super.forceResize()}destroy(){super.destroy()}isDestroyed(){return super.isDestroyed()}on(e,t="LEFT_CLICK",i=this.canvas){const n=new xu(i),r=n.setInputAction(e,Cu[t]);return function(){n.isDestroyed()||(r(),n.destroy())}}addPoint(e,t,i){this.dds.addPoint(e,t,i)}}const{Color:Nu,MaterialAppearance:Ou,CircleGeometry:Fu,GroundPrimitive:ku,Primitive:zu,GeometryInstance:Bu,Material:Gu}=Cesium;class Hu extends Hn{constructor(e){if(!x(e))throw new t("options must be provided.");if(!1===w.isValid(e.position))throw new t("options.position parameter is invalid.");if(isNaN(e.radius)&&e.radius<=0)throw new t("options.radius parameter must be a number greater than 0.");super(e),this._color=C(e.color,Nu.WHITE),"string"==typeof this._color&&(this._color=Nu.fromCssColorString(this._color)),this._position=e.position,this._radius=e.radius,this._stRotation=Cesium.Math.toRadians(C(e.stRotation,0)),this._height=C(e.height,0),this._extrudedHeight=C(e.extrudedHeight,0),this._asynchronous=C(e.asynchronous,!0)}createGraphic(){this._clampToGround?this.createGroundPrimitive(this._asynchronous):this.createPrimitive(this._asynchronous)}createPrimitive(e=!0){if(this.isDestroyed())return;const t=new Fu({center:w.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height,granularity:.01});return this._primitive=new zu({geometryInstances:new Bu({geometry:t,id:this.property}),appearance:this.createAppearance(),asynchronous:e,allowPicking:this._allowPicking}),this._primitive}createGroundPrimitive(e=!0){if(this.isDestroyed())return;const t=new Fu({center:w.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height});return this._primitive=new ku({geometryInstances:new Bu({geometry:t,id:this.property}),appearance:this.createAppearance(),asynchronous:e,allowPicking:this._allowPicking}),this._primitive}createAppearance(){return x(this._appearance)||(this._appearance=new Ou({material:Gu.fromType("Color",{color:this._color})})),this._appearance}get position(){return this._position}set position(e){w.isValid(e)&&(this.definedChanged.raise("position",e,this._position),this._position=e,this._options.position=e,this.updatePrimitive())}get radius(){return this._radius}set radius(e){!e!==this._radius&&(this.definedChanged.raise("radius",e,this._radius),this._radius=e,this._options.radius=e,this.updatePrimitive())}get height(){return this._height}set height(e){e!==this._height&&(this.definedChanged.raise("height",e,this._height),this._height=e,this._options.height=e,this._extrudedHeight=e,this.updatePrimitive())}get color(){if(x(this._color))return this._color.toCssColorString()}set color(e){this.definedChanged.raise("color",e,this._color),this._color="string"==typeof e?Cesium.Color.fromCssColorString(e):e,this._options.color=this._color,this.updateAttribute("color",this._color)}toJson(){return Object.assign({},super.toJson(),{position:this._position.toArray(),radius:this.radius,clampToGround:this.clampToGround})}updatePrimitive(){if(!this._viewer)return;const e=this.primitive;this.createGraphic(),this.group.root.add(this._primitive),this.group.root.remove(e)}zoomTo(e){if(!this._viewer)return;const t=this.boundingSphere;this._viewer.camera.flyToBoundingSphere(t,e)}get boundingSphere(){return new Cesium.BoundingSphere(w.toCartesian(this.position,this.radius||1e3))}}const Wu="\n    float circle(vec2 uv, float r, float blur) {\n        float d = length(uv);\n        float c = smoothstep(r+blur, r, d);\n        return c;\n    }\n    czm_material czm_getMaterial(czm_materialInput materialInput) {\n        czm_material material = czm_getDefaultMaterial(materialInput);\n        mat2 rotateMatrix = mat2(stRotation.x, stRotation.y, stRotation.z, stRotation.w);\n        vec2 st = rotateMatrix * (materialInput.st - vec2(0.5));\n        float t = time;\n        float s = 0.4;\n        float radius1 = smoothstep(.0, s, 1.0) * 0.5;\n        float alpha1 = circle(st, radius1, 0.02) * circle(st, radius1, -0.02);\n        float alpha2 = circle(st, radius1, 0.02 - radius1) * circle(st, radius1, 0.02);\n        float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n        float alpha3 = circle(st, radius1, radius2 + 0.01 - radius1) * circle(st, radius1, -0.02);\n    \n        float circleAlpha = color.a * smoothstep(1.0, s, 0.0) * (alpha1 + alpha2*0.1 + alpha3*0.2);\n        vec4 imageColor = texture2D(image, st + vec2(0.5));\n        material.diffuse = color.rgb;\n        material.alpha = imageColor.a * color.a + circleAlpha;\n        return material;\n    }\n",{MaterialAppearance:Uu,Material:ju}=Cesium;const Vu="\nfloat circle(vec2 uv, float r, float blur) {\n    float d = length(uv) * 2.0;\n    float c = smoothstep(r+blur, r, d);\n    return c;\n}\n\nuniform vec4 color;\nuniform float time;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st - .5;\n    material.diffuse = color.rgb;\n    material.emission = vec3(0);\n    float t = time;\n    float s = 0.3;\n    float radius1 = smoothstep(.0, s, t) * 0.5;\n    float blurRadius = 0.015;\n    float alpha1 = circle(st, radius1, blurRadius) * circle(st, radius1, -blurRadius);\n    float alpha2 = circle(st, radius1, blurRadius - radius1) * circle(st, radius1, blurRadius);\n    float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n    float alpha3 = circle(st, radius1, radius2 + blurRadius - radius1) * circle(st, radius1, -blurRadius);\n    material.alpha = smoothstep(1.0, s, t) * (alpha1 + alpha2 * 0.1 + alpha3 * 0.1);\n    material.alpha *= color.a;\n    return material;\n}\n",{MaterialAppearance:qu,Material:$u}=Cesium;var Yu={baseMaterialShader:"\nuniform sampler2D image;\nuniform vec4 color;\n\nfloat glow(float var, float radius, float blur) {\n    float innerRadius = radius - blur;\n    float outerRadius = radius + blur;\n    float alpha = 1.0 - step(var, innerRadius);\n    alpha *= step(var, outerRadius);\n    float innerBlur = (1.0 - step(var, innerRadius)) * var;\n    float outerBlur = (1.0 - abs(var - radius) / blur) * alpha;\n    return outerBlur ;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  // calculate distance from the fragment to circle center and normalize it.\n  float length = distance(st, vec2(0.5)) * 2.0;\n  float innerCircle = glow(length, 0.35, 0.2);\n  float outerCircle = glow(length, 0.8, 0.2);\n  float alpha = innerCircle + outerCircle;\n  material.diffuse = color.rgb * vec3(color.a);\n  material.alpha = pow(alpha, 4.0) * color.a;\n  return material;\n}\n",dashCircleMaterialShader:"\nfloat dashCircle(vec2 st, float time) {\n  float slice = 18.0;\n  time = 3.1415926 / 180.0 * time;\n  float cost = cos(time);\n  float sint = sin(time);\n  mat2 rotateMatrix = mat2(cost, -sint, sint, cost);\n  st = rotateMatrix * st;\n  float cos = dot(normalize(st), vec2(1.0, 0.0));\n  float angle  = acos(cos);\n  float sliceAngle = 3.1415926 * 2.0 / slice;\n  float index = mod(floor(angle / sliceAngle), 2.0);\n  if (st.t > 0.0) {\n    return 1.0 - index;\n  }\n  return index;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  float length = distance(st, vec2(0.5)) * 2.0;\n  vec2 center = st - vec2(0.5, 0.5);\n  float time = -czm_frameNumber * 3.1415926 / 180.;//扫描速度1度\n  float sin_t = sin(time);\n  float cos_t = cos(time);\n  float alpha = step(length, 0.7);\n  alpha *= step(0.55, length);\n  alpha *= dashCircle(st - vec2(0.5), mod(czm_frameNumber * speed, 180.0 * 2.0));\n  alpha *= min((1.0 - abs(length - 0.625) / 0.15), 1.0);\n  material.diffuse = color.rgb;\n  material.alpha = alpha * color.a;\n  return material;\n}\n",coneMaterialShader:"\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  float powerRatio = 1.0 / (fract(czm_frameNumber / 30.0) + 1.0);\n  float alpha = pow(1.0 - st.t, powerRatio);\n  material.diffuse = color.rgb;\n  material.alpha = alpha * color.a;\n  return material;\n}\n",cylinderMaterialShader:"\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n  vec2 st = materialInput.st;\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  float dt=fract(czm_frameNumber * speed /180.0);\n  st=fract(st-vec2(dt,dt));\n  vec4 imageColor = texture2D(image, st);\n  vec4 tempColor=vec4(color.rgb,imageColor.a);\n  tempColor.a = tempColor.a;\n  material.alpha = tempColor.a;\n  material.diffuse = tempColor.rgb *vec3(1.5);\n  return material;\n}"};const{PrimitiveType:Xu,VertexFormat:Ju,Math:Zu,IndexDatatype:Qu,GeometryOffsetAttribute:Ku,GeometryAttributes:eh,GeometryAttribute:th,Geometry:ih,ComponentDatatype:nh,Cartesian2:rh,Cartesian3:oh,BoundingSphere:sh}=Cesium,ah=new rh,lh=new oh,ch=new oh,uh=new oh;function hh(e){var t=(e=C(e,C.EMPTY_OBJECT)).length,i=e.topRadius,n=e.bottomRadius,r=C(e.vertexFormat,Ju.DEFAULT),o=C(e.slices,128);this._length=t,this._topRadius=i,this._bottomRadius=n,this._vertexFormat=Ju.clone(r),this._slices=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}hh.packedLength=Ju.packedLength+5,hh.pack=function(e,t,i){return i=C(i,0),Ju.pack(e._vertexFormat,t,i),i+=Ju.packedLength,t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i]=C(e._offsetAttribute,-1),t};var dh,ph=new Ju,mh={vertexFormat:ph,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};hh.unpack=function(e,t,i){t=C(t,0);var n=Ju.unpack(e,t,ph);t+=Ju.packedLength;var r=e[t++],o=e[t++],s=e[t++],a=e[t++],l=e[t];return x(i)?(i._vertexFormat=Ju.clone(n,i._vertexFormat),i._length=r,i._topRadius=o,i._bottomRadius=s,i._slices=a,i._offsetAttribute=-1===l?void 0:l,i):(mh.length=r,mh.topRadius=o,mh.bottomRadius=s,mh.slices=a,mh.offsetAttribute=-1===l?void 0:l,new hh(mh))},hh.createGeometry=function(e){var t=e._length,i=e._topRadius,n=e._bottomRadius,r=e._vertexFormat,o=e._slices;if(!(t<=0||i<0||n<0||0===i&&0===n)){var s,a=o+o,l=a+a,c=function(e,t,i,n,r){var o,s=.5*e,a=-s,l=n+n,c=new Float64Array(3*(r?2*l:l)),u=0,h=0,d=r?3*l:0,p=r?3*(l+n):3*n;for(o=0;o<n;o++){var m=o/n*Zu.TWO_PI,f=Math.cos(m),g=Math.sin(m),_=f*i,y=g*i,v=f*t,C=g*t;c[h+d]=_,c[h+d+1]=y,c[h+d+2]=a,c[h+p]=v,c[h+p+1]=C,c[h+p+2]=s,h+=3,r&&(c[u++]=_,c[u++]=y,c[u++]=a,c[u++]=v,c[u++]=C,c[u++]=s)}return c}(t,i,n,o,!1),u=r.st?new Float32Array(2*a):void 0,h=r.normal?new Float32Array(3*l):void 0,d=r.tangent?new Float32Array(3*l):void 0,p=r.bitangent?new Float32Array(3*l):void 0,m=r.normal||r.tangent||r.bitangent;if(m){var f=r.tangent||r.bitangent,g=0,_=0,y=0,v=Math.atan2(n-i,t),w=lh;w.z=Math.sin(v);var b=Math.cos(v),S=uh,T=ch;for(s=0;s<o;s++){var A=s/o*Zu.TWO_PI,E=b*Math.cos(A),P=b*Math.sin(A);m&&(w.x=E,w.y=P,f&&(S=oh.normalize(oh.cross(oh.UNIT_Z,w,S),S)),r.normal&&(h[g++]=w.x,h[g++]=w.y,h[g++]=w.z,h[g++]=w.x,h[g++]=w.y,h[g++]=w.z),r.tangent&&(d[_++]=S.x,d[_++]=S.y,d[_++]=S.z,d[_++]=S.x,d[_++]=S.y,d[_++]=S.z),r.bitangent&&(T=oh.normalize(oh.cross(w,S,T),T),p[y++]=T.x,p[y++]=T.y,p[y++]=T.z,p[y++]=T.x,p[y++]=T.y,p[y++]=T.z))}for(s=0;s<o;s++)r.normal&&(h[g++]=0,h[g++]=0,h[g++]=-1),r.tangent&&(d[_++]=1,d[_++]=0,d[_++]=0),r.bitangent&&(p[y++]=0,p[y++]=-1,p[y++]=0);for(s=0;s<o;s++)r.normal&&(h[g++]=0,h[g++]=0,h[g++]=1)}var L=6*o,D=Qu.createTypedArray(l,L),M=0,R=0;for(s=0;s<o-1;s++)D[M++]=R,D[M++]=R+1,D[M++]=R+o,D[M++]=R+1,D[M++]=R+o+1,D[M++]=R+o,R++;D[M++]=R,D[M++]=0,D[M++]=o+R,D[M++]=0,D[M++]=o,D[M++]=o+R;var I=0;if(r.st){var N=1/o;for(s=0;s<o;s++)u[I++]=N*s,u[I++]=0;for(s=0;s<o;s++)u[I++]=N*s,u[I++]=1}var O=new eh;r.position&&(O.position=new th({componentDatatype:nh.DOUBLE,componentsPerAttribute:3,values:c})),r.st&&(O.st=new th({componentDatatype:nh.FLOAT,componentsPerAttribute:2,values:u})),r.normal&&(O.normal=new th({componentDatatype:nh.FLOAT,componentsPerAttribute:3,values:h})),ah.x=.5*t,ah.y=Math.max(n,i);var F=new sh(oh.ZERO,rh.magnitude(ah));if(x(e._offsetAttribute)){t=c.length;var k=new Uint8Array(t/3);!function(e,t,i,n){if("function"==typeof e.fill)return e.fill(t,i,n);for(var r=e.length>>>0,o=C(i,0),s=o<0?Math.max(r+o,0):Math.min(o,r),a=C(n,r),l=a<0?Math.max(r+a,0):Math.min(a,r);s<l;)e[s]=t,s++}(k,e._offsetAttribute===Ku.NONE?0:1),O.applyOffset=new th({componentDatatype:nh.UNSIGNED_BYTE,componentsPerAttribute:1,values:k})}return new ih({attributes:O,indices:D,primitiveType:Xu.TRIANGLES,boundingSphere:F,offsetAttribute:e._offsetAttribute})}},hh.getUnitCylinder=function(){return x(dh)||(dh=hh.createGeometry(new hh({topRadius:1,bottomRadius:1,length:1,vertexFormat:Ju.POSITION_ONLY}))),dh};const{baseMaterialShader:fh,dashCircleMaterialShader:gh,coneMaterialShader:_h,cylinderMaterialShader:yh}=Yu,{MaterialAppearance:vh,Material:Ch,GroundPrimitive:xh,Primitive:wh,GeometryInstance:bh,PrimitiveCollection:Sh,CircleGeometry:Th,Transforms:Ah,Matrix4:Eh,Cartesian3:Ph}=Cesium;var Lh=function(e){return e.reduce((function(e,t){return 2*e+t}),0)},Dh=function(e){for(var t=[],i=7;i>=0;i--)t.push(!!(e&1<<i));return t},Mh=function(e){this.data=e,this.len=this.data.length,this.pos=0,this.readByte=function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return e instanceof Uint8Array?e[this.pos++]:255&e.charCodeAt(this.pos++)},this.readBytes=function(e){for(var t=[],i=0;i<e;i++)t.push(this.readByte());return t},this.read=function(e){for(var t="",i=0;i<e;i++)t+=String.fromCharCode(this.readByte());return t},this.readUnsigned=function(){var e=this.readBytes(2);return(e[1]<<8)+e[0]}},Rh=function(e,t){t||(t={});var i=function(t){for(var i=[],n=0;n<t;n++)i.push(e.readBytes(3));return i},n=function(){var t,i;i="";do{t=e.readByte(),i+=e.read(t)}while(0!==t);return i},r=function(r){r.leftPos=e.readUnsigned(),r.topPos=e.readUnsigned(),r.width=e.readUnsigned(),r.height=e.readUnsigned();var o=Dh(e.readByte());r.lctFlag=o.shift(),r.interlaced=o.shift(),r.sorted=o.shift(),r.reserved=o.splice(0,2),r.lctSize=Lh(o.splice(0,3)),r.lctFlag&&(r.lct=i(1<<r.lctSize+1)),r.lzwMinCodeSize=e.readByte();var s=n();r.pixels=function(e,t){for(var i,n,r=0,o=function(e){for(var i=0,n=0;n<e;n++)t.charCodeAt(r>>3)&1<<(7&r)&&(i|=1<<n),r++;return i},s=[],a=1<<e,l=a+1,c=e+1,u=[],h=function(){u=[],c=e+1;for(var t=0;t<a;t++)u[t]=[t];u[a]=[],u[l]=null};;)if(n=i,(i=o(c))!==a){if(i===l)break;if(i<u.length)n!==a&&u.push(u[n].concat(u[i][0]));else{if(i!==u.length)throw new Error("Invalid LZW code.");u.push(u[n].concat(u[n][0]))}s.push.apply(s,u[i]),u.length===1<<c&&c<12&&c++}else h();return s}(r.lzwMinCodeSize,s),r.interlaced&&(r.pixels=function(e,t){for(var i=new Array(e.length),n=e.length/t,r=function(n,r){var o=e.slice(r*t,(r+1)*t);i.splice.apply(i,[n*t,t].concat(o))},o=[0,4,2,1],s=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=o[l];c<n;c+=s[l])r(c,a),a++;return i}(r.pixels,r.width)),t.img&&t.img(r)},o=function(){var i={};switch(i.sentinel=e.readByte(),String.fromCharCode(i.sentinel)){case"!":i.type="ext",function(i){switch(i.label=e.readByte(),i.label){case 249:i.extType="gce",function(i){e.readByte();var n=Dh(e.readByte());i.reserved=n.splice(0,3),i.disposalMethod=Lh(n.splice(0,3)),i.userInput=n.shift(),i.transparencyGiven=n.shift(),i.delayTime=e.readUnsigned(),i.transparencyIndex=e.readByte(),i.terminator=e.readByte(),t.gce&&t.gce(i)}(i);break;case 254:i.extType="com",function(e){e.comment=n(),t.com&&t.com(e)}(i);break;case 1:i.extType="pte",function(i){e.readByte(),i.ptHeader=e.readBytes(12),i.ptData=n(),t.pte&&t.pte(i)}(i);break;case 255:i.extType="app",function(i){e.readByte(),i.identifier=e.read(8),i.authCode=e.read(3),"NETSCAPE"===i.identifier?function(i){e.readByte(),i.unknown=e.readByte(),i.iterations=e.readUnsigned(),i.terminator=e.readByte(),t.app&&t.app.NETSCAPE&&t.app.NETSCAPE(i)}(i):function(e){e.appData=n(),t.app&&t.app[e.identifier]&&t.app[e.identifier](e)}(i)}(i);break;default:i.extType="unknown",function(e){e.data=n(),t.unknown&&t.unknown(e)}(i)}}(i);break;case",":i.type="img",r(i);break;case";":i.type="eof",t.eof&&t.eof(i);break;default:throw new Error("Unknown block: 0x"+i.sentinel.toString(16))}"eof"!==i.type&&setTimeout(o,0)};!function(){var n={};if(n.sig=e.read(3),n.ver=e.read(3),"GIF"!==n.sig)throw new Error("Not a GIF file.");n.width=e.readUnsigned(),n.height=e.readUnsigned();var r=Dh(e.readByte());n.gctFlag=r.shift(),n.colorRes=Lh(r.splice(0,3)),n.sorted=r.shift(),n.gctSize=Lh(r.splice(0,3)),n.bgColor=e.readByte(),n.pixelAspectRatio=e.readByte(),n.gctFlag&&(n.gct=i(1<<n.gctSize+1)),t.hdr&&t.hdr(n)}(),setTimeout(o,0)},Ih=function(e){var t,i,n={vp_l:0,vp_t:0,vp_w:null,vp_h:null,c_w:null,c_h:null};for(var r in e)n[r]=e[r];n.vp_w&&n.vp_h&&(n.is_vp=!0);var o=null,s=!1,a=null,l=null,c=null,u=null,h=null,d=null,p=null,m=!0,f=!1,g=[],_=[],y=n.gif;void 0===n.auto_play&&(n.auto_play=!y.getAttribute("rel:auto_play")||"1"==y.getAttribute("rel:auto_play"));var v,C,x,w,b=n.hasOwnProperty("on_end")?n.on_end:null,S=n.hasOwnProperty("loop_delay")?n.loop_delay:0,T=n.hasOwnProperty("loop_mode")?n.loop_mode:"auto",A=!n.hasOwnProperty("draw_while_loading")||n.draw_while_loading,E=!!A&&(!n.hasOwnProperty("show_progress_bar")||n.show_progress_bar),P=n.hasOwnProperty("progressbar_height")?n.progressbar_height:25,L=n.hasOwnProperty("progressbar_background_color")?n.progressbar_background_color:"rgba(255,255,255,0.4)",D=n.hasOwnProperty("progressbar_foreground_color")?n.progressbar_foreground_color:"rgba(255,0,22,.8)",M=function(){a=null,l=null,h=c,c=null,d=null},R=function(){try{Rh(t,H)}catch(e){O("parse")}},I=function(e,t){v.width=e*U(),v.height=t*U(),x.style.minWidth=e*U()+"px",w.width=e,w.height=t,w.style.width=e+"px",w.style.height=t+"px",w.getContext("2d").setTransform(1,0,0,1,0,0)},N=function(e,t,i){if(i&&E){var r,o,s,a=P;n.is_vp?f?(o=(n.vp_t+n.vp_h-a)/U(),a/=U(),r=n.vp_l/U()+e/t*(n.vp_w/U()),s=v.width/U()):(o=n.vp_t+n.vp_h-a,a=a,r=n.vp_l+e/t*n.vp_w,s=v.width):(o=(v.height-a)/(f?U():1),r=e/t*v.width/(f?U():1),s=v.width/(f?U():1),a/=f?U():1),C.fillStyle=L,C.fillRect(r,o,s-r,a),C.fillStyle=D,C.fillRect(0,o,r,a)}},O=function(e){o=e,i={width:y.width,height:y.height},g=[],C.fillStyle="black",C.fillRect(0,0,n.c_w?n.c_w:i.width,n.c_h?n.c_h:i.height),C.strokeStyle="red",C.lineWidth=3,C.moveTo(0,0),C.lineTo(n.c_w?n.c_w:i.width,n.c_h?n.c_h:i.height),C.moveTo(0,n.c_h?n.c_h:i.height),C.lineTo(n.c_w?n.c_w:i.width,0),C.stroke()},F=function(){d&&(g.push({data:d.getImageData(0,0,i.width,i.height),delay:l}),_.push({x:0,y:0}))},k=function(){var e,t,i,r=-1,s=0,a=function(e){r+=e,c()},l=(e=!1,t=function(){null!==b&&b(y),s++,!1!==T||s<0?i():(e=!1,m=!1)},i=function(){if(e=m){a(1);var n=10*g[r].delay;n||(n=100),0==(r+1+g.length)%g.length?(n+=S,setTimeout(t,n)):setTimeout(i,n)}},function(){e||setTimeout(i,0)}),c=function(){var e;(r=parseInt(r,10))>g.length-1&&(r=0),r<0&&(r=0),e=_[r],w.getContext("2d").putImageData(g[r].data,e.x,e.y),C.globalCompositeOperation="copy",C.drawImage(w,0,0)};return{init:function(){o||(n.c_w&&n.c_h||C.scale(U(),U()),n.auto_play?l():(r=0,c()))},step:l,play:function(){m=!0,l()},pause:function(){m=!1},playing:m,move_relative:a,current_frame:function(){return r},length:function(){return g.length},move_to:function(e){r=e,c()}}}(),z=function(e){N(t.pos,t.data.length,e)},B=function(){},G=function(e,t){return function(i){e(i),z(t)}},H={hdr:G((function(e){I((i=e).width,i.height)})),gce:G((function(e){F(),M(),a=e.transparencyGiven?e.transparencyIndex:null,l=e.delayTime,c=e.disposalMethod})),com:G(B),app:{NETSCAPE:G(B)},img:G((function(e){d||(d=w.getContext("2d"));var t=g.length,r=e.lctFlag?e.lct:i.gct;t>0&&(3===h?null!==u?d.putImageData(g[u].data,0,0):d.clearRect(p.leftPos,p.topPos,p.width,p.height):u=t-1,2===h&&d.clearRect(p.leftPos,p.topPos,p.width,p.height));var o=d.getImageData(e.leftPos,e.topPos,e.width,e.height);e.pixels.forEach((function(e,t){e!==a&&(o.data[4*t+0]=r[e][0],o.data[4*t+1]=r[e][1],o.data[4*t+2]=r[e][2],o.data[4*t+3]=255)})),d.putImageData(o,e.leftPos,e.topPos),f||(C.scale(U(),U()),f=!0),A&&(C.drawImage(w,0,0),A=n.auto_play),p=e}),!0),eof:function(e){F(),z(!1),n.c_w&&n.c_h||(v.width=i.width*U(),v.height=i.height*U()),k.init(),s=!1,V&&V(y)}},W=function(){var e=y.parentNode,t=document.createElement("div");v=document.createElement("canvas"),C=v.getContext("2d"),x=document.createElement("div"),w=document.createElement("canvas"),t.width=v.width=y.width,t.height=v.height=y.height,x.style.minWidth=y.width+"px",t.className="jsgif",x.className="jsgif_toolbar",t.appendChild(v),t.appendChild(x),e.insertBefore(t,y),e.removeChild(y),n.c_w&&n.c_h&&I(n.c_w,n.c_h),j=!0},U=function(){return n.max_width&&i&&i.width>n.max_width?n.max_width/i.width:1},j=!1,V=!1,q=function(e){return!s&&(V=e||!1,s=!0,g=[],M(),u=null,h=null,d=null,p=null,!0)},$=function(){return g.reduce((function(e,t){return e+t.delay}),0)};return{play:k.play,pause:k.pause,move_relative:k.move_relative,move_to:k.move_to,get_playing:function(){return m},get_canvas:function(){return v},get_canvas_scale:function(){return U()},get_loading:function(){return s},get_auto_play:function(){return n.auto_play},get_length:function(){return k.length()},get_frames:function(){return g},get_duration:function(){return $()},get_duration_ms:function(){return 10*$()},get_current_frame:function(){return k.current_frame()},load_url:function(e,i){if(q(i)){var n=new XMLHttpRequest;n.open("GET",e,!0),"overrideMimeType"in n?n.overrideMimeType("text/plain; charset=x-user-defined"):"responseType"in n?n.responseType="arraybuffer":n.setRequestHeader("Accept-Charset","x-user-defined"),n.onloadstart=function(){j||W()},n.onload=function(e){200!=this.status&&O("xhr - response"),"response"in this||(this.response=new VBArray(this.responseText).toArray().map(String.fromCharCode).join(""));var i=this.response;i.toString().indexOf("ArrayBuffer")>0&&(i=new Uint8Array(i)),t=new Mh(i),setTimeout(R,0)},n.onprogress=function(e){e.lengthComputable&&N(e.loaded,e.total,!0)},n.onerror=function(){O("xhr")},n.send()}},load:function(e){this.load_url(y.getAttribute("rel:animated_src")||y.src,e)},load_raw:function(e,i){q(i)&&(j||W(),t=new Mh(e),setTimeout(R,0))},set_frame_offset:function(e,t){_[e]?(void 0!==t.x&&(_[e].x=t.x),void 0!==t.y&&(_[e].y=t.y)):_[e]=t}}};const{BillboardCollection:Nh,VerticalOrigin:Oh}=Cesium;const Fh="\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    material.diffuse = color.rgb;\n    vec2 st = materialInput.st - vec2(0.5);\n    float dis = distance(st, vec2(0.0));\n    // material.alpha = min(pow(dis * 2.0, 5.0) * color.a, 1.0);\n    if (dis * 2.0 > fract(time)) {\n        discard;\n    }  \n    float scale = 1.0 / (max(time, 0.0001));\n    material.alpha = min(pow(dis * 2.0 * scale, 5.0), 1.0) * color.a;\n    return material;\n}\n",{MaterialAppearance:kh,Material:zh}=Cesium;const{Cartesian3:Bh,Matrix4:Gh,Transforms:Hh,Model:Wh,CylinderGeometry:Uh,PrimitiveCollection:jh,BillboardCollection:Vh,MaterialAppearance:qh,GeometryInstance:$h,Material:Yh,Color:Xh,Primitive:Jh}=Cesium;function Zh(e,t,i){if(!x(e))return;t=Cesium.Math.toRadians(t);const n=new Cesium.Matrix3,r=new Cesium.Quaternion;Cesium.Quaternion.fromAxisAngle(i,t,r),Cesium.Matrix3.fromQuaternion(r,n);const o=new Cesium.Matrix4;Cesium.Matrix4.fromRotationTranslation(n,new Cesium.Cartesian3(0,0,0),o),Cesium.Matrix4.multiplyByMatrix3(e._matrix,n,e._matrix);const s=w.fromCartesian(e._surface,e._viewer),a=new Cesium.Matrix4;Cesium.Matrix4.inverseTransformation(e._matrix,a);const l=Cesium.Cartesian3.fromDegrees(s.lon,s.lat,e._height),c=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(a,l,c);const u=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(o,c,u);const h=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(c,u,h),Cesium.Matrix4.multiplyByTranslation(e._matrix,h,e._matrix),e.updateMatrix(e._matrix)}function Qh(e){const t=e.scanPrimitive.appearance.material,i=e._viewer;if(e.path){const t=e.path.position.getValue(i.clock.currentTime);e._position=t;const n=w.fromCartesian(t,i),r=Cesium.Cartesian3.fromDegrees(n.lon,n.lat);e._surface=r,e._height=n.height;const o=new Cesium.Cartesian3(0,0,n.height/2),s=Cesium.Matrix4.multiplyByTranslation(Hh.eastNorthUpToFixedFrame(r),o,new Cesium.Matrix4);e.updateMatrix(s),e.imagePrimitive.position=t,e.transform(e.rotation),e.tracked&&e.trackSatellite()}let n=t.uniforms.offset;n-=.005*e.speed,n>1&&(n=0),e.scanPrimitive.appearance.material.uniforms.offset=n}const Kh=33746824,ed=33554054;const{BingMapsImageryProvider:td,BingMapsStyle:id}=Cesium;class nd extends td{constructor(e={}){e.url="https://dev.virtualearth.net",e.mapStyle=C(e.mapStyle,nd.mapStyle.AERIAL),e.key=C(e.key,"AqMhBWJKbBPBtoWEvtGdUii6XSkDCJ3vWFpOVWzplD-Q0J-ECUF6i8MGXpew8bkc"),super(e)}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get rectangle(){return super.rectangle}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(e){this._tileProvider.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}static tileXYToQuadKey(e,t,i){return td.tileXYToQuadKey(e,t,i)}static quadKeyToTileXY(e){return td.quadKeyToTileXY(e)}static mapStyle=id}class rd extends Lo{constructor(e){e=C(e,{});const t=C(e.layer,"img"),{scl:i,style:n}=rd.getParametersByLayer(t),r=C(e.lang,"zh_cn");e.url=`https://webst0{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=${r}&size=1&scl=${i}&style=${n}`,e.subdomains="1234",super(e)}static layers=[{layer:"img",desc:"影像地图"},{layer:"vec",desc:"矢量地图"},{layer:"vei",desc:"矢量地图（含注记）"},{layer:"roa",desc:"路网地图"},{layer:"roi",desc:"路网地图（含注记）"}];static getParametersByLayer(e){let t={scl:1,style:6};switch(e){case"img":break;case"vec":t.scl=2,t.style=7;break;case"vei":t.scl=1,t.style=7;break;case"roa":t.scl=2,t.style=8;break;case"roi":t.scl=1,t.style=8}return t}}const{WebMapTileServiceImageryProvider:od}=Cesium;class sd extends od{constructor(e={}){super(e)}get dimensions(){return super.dimensions}set dimensions(e){super.dimensions=e}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get rectangle(){return super.rectangle}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(e){this._tileProvider.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}}const ad={map:"https://rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=1&version=297",road:"https://rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=2&version=297",img:"https://p{s}.map.gtimg.com/sateTiles/{z}/{sx}/{sy}/{x}_{reverseY}.jpg?version=229"};function ld(e){return`rgba(${255*e.red}, ${255*e.green}, ${255*e.blue}, ${e.alpha})`}const{Rectangle:cd}=Cesium;class ud extends Cesium.TileMapServiceImageryProvider{constructor(e){super(e)}get url(){return super.url}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get rectangle(){return super.rectangle}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return super.enablePickFeatures}set enablePickFeatures(e){super.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}}class hd extends Cesium.WebMapServiceImageryProvider{constructor(e={}){x(e.parameters)||(e.parameters=hd.DefaultParameters),x(e.GetFeatureInfoDefaultParameters),super(e)}get minimumLevel(){return super.minimumLevel}get maximumLevel(){return super.maximumLevel}get errorEvent(){return super.errorEvent}get rectangle(){return super.rectangle}get ready(){return super.ready}get readyPromise(){return super.readyPromise}get tilingScheme(){return super.tilingScheme}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(e){this._tileProvider.enablePickFeatures=e}pickFeatures(e,t,i,n,r){return super.pickFeatures(e,t,i,n,r)}requestImage(e,t,i,n){return super.requestImage(e,t,i,n)}}hd.DefaultParameters=Object.assign({transparent:!0},Cesium.WebMapServiceImageryProvider.DefaultParameters,{format:"image/png"}),hd.GetFeatureInfoDefaultParameters=Cesium.WebMapServiceImageryProvider.GetFeatureInfoDefaultParameters;const{CallbackProperty:dd}=Cesium;function pd(e){return new dd((()=>e),!1)}class md{constructor(e,t={}){this._type=void 0,this._properties=void 0,this._show=!0,this._id=C(e.id,je()),this._clampToGround=C(t.clampToGround),this._clampToModel=C(t.clampToModel)}highlightGraphic(e=!0){const t=md.highlightColor;this.entity&&e?(this.entity.point&&(this.entity.point.color=t),this.entity.polyline&&(this.entity.polyline.material=t),this.entity.polygon&&(this.entity.polygon.material=t),this.entity.polygon&&(this.entity.polygon.outlineColor=t)):(this.entity.point&&(this.entity.point.color=this._entityOptions.point.color),this.entity.polyline&&(this.entity.polyline.material=this._entityOptions.polyline.material),this.entity.polygon&&(this.entity.polygon.material=this._entityOptions.polygon.material),this.entity.polygon&&(this.entity.polygon.outlineColor=this._entityOptions.polygon.outlineColor))}static highlightColor=Cesium.Color.AQUA;get clampToGround(){return this._clampToGround}set clampToGround(e){this._clampToGround=e}get clampToModel(){return this._clampToModel}set clampToModel(e){this._clampToModel=e}get id(){return this._id}get positions(){return this._positions}get type(){return this._type}get properties(){return this._properties}set properties(e){this._properties=new zr(e)}get entity(){return this._entity}get show(){return this._show}set show(e){this._show=e,this.entity&&(this.entity.show=this._show)}destroy(){console.log("destroy"),this._entity=void 0,this._entityOptions=void 0,this._positions=void 0,this.properties&&this.properties.destroy(),this._properties=void 0,Gn(this)}startEdit(){if(this.entity){const e=pd(this.positions);this.entity.position&&(this.entity.position=e),this.entity.polyline&&(this.entity.polyline.positions=pd(this._nodePositions||this.positions)),this.entity.polygon&&(this.entity.polygon.hierarchy=pd(new Cesium.PolygonHierarchy(this.positions)))}}stopEdit(){this.entity&&(this.entity.position&&(this.entity.position=this.positions),this.entity.polyline&&(this.entity.polyline.positions=this._nodePositions||this.positions),this.entity.polygon&&(this.entity.polygon.hierarchy=new Cesium.PolygonHierarchy(this.positions)))}createProperties(){const e=this._entityOptions,{properties:t}=e;this._properties=new zr(t),delete e.properties}createEntity(){this.createProperties()}toGeoJson(){i()}getGeometry(){i()}static getEntityFromGeoJson(e){if(x(e)){if(e.geometry&&"POLYGON"===e.geometry.type.toUpperCase()){let t=[];const i=e.geometry.coordinates;if(!x(i)||!Array.isArray(i))return;for(let e of i){if(!Array.isArray(e))return;for(let i of e){const e=Cesium.Cartesian3.fromDegrees(i[0],i[1]);if(!x(e))return;t.push(e)}}return new Cesium.Entity({polygon:{material:Cesium.Color.fromCssColorString("rgba(247,224,32,0.5)"),outlineColor:Cesium.Color.RED,perPositionHeight:!1,hierarchy:t}})}return hierarchy}}}function fd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _d(e,t,i){return t&&gd(e.prototype,t),i&&gd(e,i),e}function yd(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function vd(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xd(e,t)}function Cd(e){return Cd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Cd(e)}function xd(e,t){return xd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xd(e,t)}function wd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bd(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?wd(e):t}function Sd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Cd(e);if(t){var r=Cd(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return bd(this,i)}}function Td(e,t,i){return Td="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Cd(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}},Td(e,t,i||e)}function Ad(e){return function(e){if(Array.isArray(e))return Ed(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ed(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ed(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ed(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Pd(e,t){return null!=e?e:t}Pd.EMPTY_OBJECT=Object.freeze({});var Ld={ARROW:0,HALF_ARROW:1,BEZIER:2,SPLINE:3,SWALLOW_TRAIL:4,TRAPEZOID:5,HALF_TRAPEZOID:6,HALF_SWALLOW_TRAIL:7,HALF_SPLINE:8,getLabel:function(e){var t;switch(e.type){case Ld.HALF_ARROW:t="HALF_ARROW";break;case Ld.ARROW:lebel="ARROW";break;case Ld.BEZIER:t="BEZIER";break;case Ld.SPLINE:t="SPLINE";break;case Ld.SWALLOW_TRAIL:t="SWALLOW_TRAIL";break;case Ld.HALF_SWALLOW_TRAIL:t="HALF_SWALLOW_TRAIL";break;case Ld.HALF_SPLINE:t="HALF_SPLINE";break;default:t=void 0}return t},getErrorMsg:function(e){e.type;var t=e.controls.length;if(!Ld.validate(e))throw new Error(Ld.getLabel(e)+"控制点个数必须不少于"+e.controlPointsCount[0]+",实际只有"+t+"个")},validate:function(e){return!(e.controls.length<e.controlPointsCount[0])}},Dd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(fd(this,e),this._controls=t.controls||[],this._index=t.index,this._inverse=t.inverse||!1,!this._index){var i=this._controls.length;this._index=new Array(i);for(var n=0;n<i;n++)this._index[n]=n}}return _d(e,[{key:"createNodes",value:function(){Ld.getErrorMsg(this)}},{key:"get",value:function(e){return this.index?this.controls[this.index[e]]:this.controls[e]}},{key:"controls",get:function(){return this._controls}},{key:"index",get:function(){return this._index}},{key:"type",get:function(){return this._type}},{key:"controlPointsCount",get:function(){return this._controlPointsCount}},{key:"nodes",get:function(){return this._nodes},set:function(e){this._nodes=e}},{key:"inverse",get:function(){return this._inverse},set:function(e){this._inverse=e}}]),e}(),Md=function(){function e(){fd(this,e)}return _d(e,null,[{key:"distance",value:function(){var e=arguments.length;if(e<2)return 0;for(var t=0,i=0;i<e-1;i++){var n=(i+1)%e,r=i<0||arguments.length<=i?void 0:arguments[i],o=n<0||arguments.length<=n?void 0:arguments[n];t+=Math.sqrt(Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2))}return t}},{key:"baseLength",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.99;return Math.pow(e.distance.apply(e,Ad(t)),i)}},{key:"mid",value:function(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}},{key:"azimuth",value:function(t,i){var n=[i,t];t=n[0],i=n[1];var r=Math.asin(Math.abs(t[1]-i[1])/e.distance(t,i));return t[1]>=i[1]&&t[0]>=i[0]?r+Math.PI:t[1]>=i[1]&&t[0]<i[0]?2*Math.PI-r:t[1]<i[1]&&t[0]>=i[0]?Math.PI-r:r}},{key:"thirdPoint",value:function(t,i,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=e.azimuth(t,i),a=o?s-n:s+n,l=r*Math.cos(a),c=r*Math.sin(a);return[i[0]+l,i[1]+c]}},{key:"isClockWise",value:function(e,t,i){return(i[1]-e[1])*(t[0]-e[0])>(t[1]-e[1])*(i[0]-e[0])}},{key:"angleOfThreePoints",value:function(t,i,n){var r=e.azimuth(t,i)-e.azimuth(t,n);return r>0?r:2*Math.PI+r}},{key:"quadricBSplineFactor",value:function(e,t){return 0===e?Math.pow(t-1,2)/2:1===e?(-2*Math.pow(t,2)+2*t+1)/2:2===e?Math.pow(t,2)/2:0}},{key:"quadricBSpline",value:function(t){if(t<=2)return t;var i=[],n=t.length-2-1;i.push(t[0]);for(var r=0;r<=n;r++)for(var o=0;o<=1;o+=.05){for(var s=0,a=0,l=0;l<=2;l++){var c=e.quadricBSplineFactor(l,o);s+=c*t[r+l][0],a+=c*t[r+l][1]}i.push([s,a])}return i.push(t[t.length-1]),i}},{key:"binomialFactor",value:function(t,i){return e.factorial(t)/(e.factorial(i)*e.factorial(t-i))}},{key:"factorial",value:function(t){return t<0?NaN:0===t?1:t*e.factorial(t-1)}},{key:"BezierCurve",value:function(t){var i=t.length;if(i<2)return t;for(var n=[],r=0;r<=1;r+=.01){for(var o=0,s=0,a=0;a<i;a++){var l=e.binomialFactor(i-1,a),c=Math.pow(r,a),u=Math.pow(1-r,i-a-1);o+=l*c*u*t[a][0],s+=l*c*u*t[a][1]}n.push([o,s])}return n.push(t[i-1]),n}}]),e}(),Rd=function(e){vd(i,e);var t=Sd(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fd(this,i),(e=t.call(this,n))._controlPointsCount=[2,2],e._type=Ld.HALF_ARROW,e._heightFactor=Pd(n.heightFactor,.18),e._neckHeightFactor=Pd(n.neckHeightFactor,.15),e._headWidthFactor=Pd(n.headWidthFactor,.5),e._neckWidthFactor=Pd(n.neckWidthFactor,.3),e._headMaxHeight=n.headMaxHeight,e._headTailHeightFactor=Pd(n.headTailHeightFactor,.3),e._inverse=Pd(n.inverse,!1),e._nodes=[],e.createNodes(),e}return _d(i,[{key:"createNodes",value:function(){Td(Cd(i.prototype),"createNodes",this).call(this);var e=this.controls,t=Md.baseLength(e),n=this.heightFactor*t;t=Md.distance(this.get(0),this.get(1)),this.headMaxHeight&&n>this.headMaxHeight&&(n=this.headMaxHeight);var r=this.neckWidthFactor*n,o=this.headWidthFactor*n;n=n>t?t:n;var s=this.neckHeightFactor*n,a=Md.thirdPoint(this.get(0),this.get(1),0,n),l=Md.thirdPoint(this.get(0),this.get(1),0,s),c=Md.thirdPoint(this.get(1),a,Math.PI/2,o,this.inverse),u=Md.thirdPoint(this.get(1),l,Math.PI/2,r,this.inverse);return this.neck=u,this.tail=c,this.neckControl=l,this.tailControl=a,this._nodes=[l,u,c,this.get(1)],this.completedNodes=new Map,this.completedNodes.set(this.inverse,[l,u,c,this.get(1)]),this._nodes}},{key:"headMaxHeight",get:function(){return this._headMaxHeight}},{key:"heightFactor",get:function(){return this._heightFactor}},{key:"neckHeightFactor",get:function(){return this._neckHeightFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}},{key:"neckWidthFactor",get:function(){return this._neckWidthFactor}},{key:"nodes",get:function(){return this._nodes}}]),i}(Dd),Id=function(e){vd(i,e);var t=Sd(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fd(this,i),(e=t.call(this,n))._type=Ld.ARROW,e.createNodes(),e}return _d(i,[{key:"createNodes",value:function(){var e=new Map;this._inverse=!0;var t=Td(Cd(i.prototype),"createNodes",this).call(this);e.set(this.inverse,Ad(t)),this._inverse=!1;var n=Td(Cd(i.prototype),"createNodes",this).call(this);return e.set(this.inverse,Ad(n)),n.shift(),t.shift(),n.pop(),this.inverse=void 0,this.completedNodes=e,this._nodes=[].concat(Ad(n),Ad(t.reverse())),[].concat(Ad(n),Ad(t.reverse()))}}]),i}(Rd),Nd=function(e){vd(i,e);var t=Sd(i);function i(e){var n;return fd(this,i),(n=t.call(this,e))._type=Ld.HALF_TRAPEZOID,n._controlPointsCount=[2,2],n._heightFactor=Pd(e.heightFactor,.82),n._tailWidthFactor=Pd(e.tailWidthFactor,.5),n._headWidthFactor=Pd(e.headWidthFactor,.3),n.createNodes(),n}return _d(i,[{key:"createNodes",value:function(){Td(Cd(i.prototype),"createNodes",this).call(this);var e=this.get(0),t=Md.baseLength(this._controls),n=this.heightFactor*t,r=Md.thirdPoint(this.get(1),e,0,n,this.inverse),o=this.tailWidthFactor*t,s=this.headWidthFactor*t,a=Md.thirdPoint(e,r,Math.PI/2,s,this.inverse),l=Md.thirdPoint(r,e,Math.PI/2,o,!this.inverse);return this._nodes=[a,l,e,r].flat(),this.completedNodes=new Map,this.completedNodes.set(this.inverse,[l]),[l]}},{key:"linkArrow",value:function(e){var t=e.arrowNodes,i=e.bodyNodes;return e.inverse?[].concat(Ad(i),Ad(t)):[].concat(Ad(t),Ad(i))}},{key:"linkTail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tailNodes,i=e.bodyNodes;return e.inverse,[].concat(Ad(t),Ad(i))}},{key:"heightFactor",get:function(){return this._heightFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}},{key:"tailWidthFactor",get:function(){return this._tailWidthFactor}}]),i}(Dd),Od=function(e){vd(i,e);var t=Sd(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fd(this,i),(e=t.call(this,n))._type=Ld.TRAPEZOID,e}return _d(i,[{key:"createNodes",value:function(){var e=new Map;this.inverse=!1;var t=Td(Cd(i.prototype),"createNodes",this).call(this);e.set(this.inverse,Ad(t)),this.inverse=!0;var n=Td(Cd(i.prototype),"createNodes",this).call(this);return e.set(this.inverse,Ad(n)),this.completedNodes=e,this.inverse=void 0,this._nodes=n.concat(t),this._nodes}}]),i}(Nd),Fd=function(){function e(t){fd(this,e),this._headHeightFactor=Pd(t.headHeightFactor,.2),this._neckHeightFactor=Pd(t.neckHeightFactor,.8),this._headWidthFactor=Pd(t.headWidthFactor,.5),this._neckWidthFactor=Pd(t.neckWidthFactor,.3),this._tailWidthFactor=Pd(t.tailWidthFactor,.3),this._tailHeightFactor=Pd(t.tailHeightFactor,.2),this._controls=Pd(t.controls,[]),this._headComponent=void 0,this._bodyComponent=void 0,this._tailComponent=void 0,this._nodes=void 0,this._polygon=[],this._polyline=[]}return _d(e,[{key:"postProcessing",value:function(e){return e}},{key:"merge",value:function(){var e,t,i,n=this.headComponent,r=this.bodyComponent,o=this.tailComponent;r&&(i=r.completedNodes);var s,a,l=[];(i&&i.get(!0)&&(s=i.get(!0),l=r.linkTail({tailNodes:l,bodyNodes:s})),n&&(s=n.nodes,l=r?r.linkArrow({arrowNodes:s,bodyNodes:l,inverse:!0,target:this}):s),i&&i.get(!1)&&(s=i.get(!1),l=r.linkArrow({arrowNodes:l,bodyNodes:s,inverse:!1,target:this})),o)&&(a=l).push.apply(a,Ad(o.nodes));this.reset(),(e=this.polygon).push.apply(e,Ad(l.flat())),(t=this.polyline).push.apply(t,Ad(l.flat()))}},{key:"update",value:function(){this.createNodes()}},{key:"reset",value:function(){this.polygon.splice(0),this.polyline.splice(0)}},{key:"polygon",get:function(){return this._polygon}},{key:"polyline",get:function(){return this._polyline}},{key:"controls",get:function(){return this._controls}}]),e}(),kd=function(e){vd(i,e);var t=Sd(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fd(this,i),(e=t.call(this,n))._type=Ld.HALF_SWALLOW_TRAIL,e._controlPointsCount=[3,1/0],e._heightFactor=Pd(n.heightFactor,.3),e.createNodes(),e}return _d(i,[{key:"createNodes",value:function(){Td(Cd(i.prototype),"createNodes",this).call(this);var e=Md.baseLength(this.controls),t=this._heightFactor*e,n=Md.mid(this.get(0),this.get(1)),r=Md.thirdPoint(this.get(2),n,0,t,this.inverse);return this.nodes=[r],this.nodes}},{key:"heightFactor",get:function(){return this._heightFactor}}]),i}(Dd);function zd(e){var t=function(t){if(e.hasOwnProperty(t)&&t.startsWith("_")){var i=t.replace("_","");Object.defineProperty(e,i,{get:function(){return e[t]},set:function(i){e[t]=i}})}};for(var i in e)t(i)}var Bd=function(e){vd(i,e);var t=Sd(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fd(this,i),n=Pd(n,Pd.EMPTY_OBJECT),(e=t.call(this,n))._tail=Pd(n.tail,!1),e.init(),zd(wd(e)),e.merge(),e}return _d(i,[{key:"addControl",value:function(e){this.controls.length>=i.MIN_CONTROL_COUNT&&this.controls.pop(),this.controls.push(e),this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"popControl",value:function(){return this.controls.pop()}},{key:"updateControl",value:function(e,t){this.controls[e]=t,this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"init",value:function(){this.controls.length<i.MIN_CONTROL_COUNT||(this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()))}},{key:"update",value:function(){this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()),this.merge()}},{key:"createBodyComponent",value:function(){return new Od({controls:this._controls,heightFactor:1-this._neckHeightFactor,headWidthFactor:this._neckWidthFactor,tailWidthFactor:this._tailWidthFactor})}},{key:"createHeadComponent",value:function(){return new Id({controls:this._controls,headWidthFactor:this._headWidthFactor,neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headHeightFactor:this._headHeightFactor})}},{key:"createTailComponent",value:function(){if(this._bodyComponent){var e=this._bodyComponent.nodes;return new kd({controls:[].concat(Ad(e),[this._controls[1]]),heightFactor:this._tailHeightFactor})}}},{key:"tail",set:function(e){this._tail=e}}]),i}(Fd);yd(Bd,"MIN_CONTROL_COUNT",2);var Gd=function(e){vd(i,e);var t=Sd(i);function i(e){var n;return fd(this,i),(n=t.call(this,e))._type=Ld.HALF_SPLINE,n._controlPointsCount=[2,1/0],n._headWidthFactor=Pd(e.headWidthFactor,.1),n._tailWidthFactor=Pd(e.tailWidthFactor,.3),n.createNodes(),n}return _d(i,[{key:"createNodes",value:function(){Td(Cd(i.prototype),"createNodes",this).call(this);for(var e=this.controls,t=Md.distance.apply(Md,Ad(e)),n=Md.baseLength(e),r=this.tailWidthFactor*n,o=this.headWidthFactor*n,s=Math.abs(r-o)/2,a=0,l=e,c=[],u=1;u<e.length-1;u++){var h=Md.angleOfThreePoints(l[u],l[u-1],l[u+1])/2;a+=Md.distance(l[u-1],l[u]),this.inverse||(h=Math.PI-h);var d=(r/2-a/t*s)/Math.sin(h),p=Md.thirdPoint(l[u-1],l[u],h,d,this.inverse);c.push(p)}return this.completedNodes=new Map,this.completedNodes.set(this.inverse,c),this.nodes=c,c}},{key:"linkArrow",value:function(e){var t=e.arrowNodes,i=e.bodyNodes,n=e.inverse,r=e.target,o=[];if(r._tail&&o.push(r.controls[+!n]),n){o.push.apply(o,Ad(i).concat([t[0]]));var s=Md.quadricBSpline(o);return[].concat(Ad(s),Ad(t))}o.push.apply(o,Ad(i).concat([t[t.length-1]]));var a=Md.quadricBSpline(o);return[].concat(Ad(t),Ad(a.reverse()))}},{key:"linkTail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tailNodes,i=e.bodyNodes;return e.inverse,[].concat(Ad(t),Ad(i))}},{key:"tailWidthFactor",get:function(){return this._tailWidthFactor}},{key:"headWidthFactor",get:function(){return this._headWidthFactor}}]),i}(Dd),Hd=function(e){vd(i,e);var t=Sd(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fd(this,i),t.call(this,e)}return _d(i,[{key:"createNodes",value:function(){var e=new Map;this.inverse=!1;var t=Td(Cd(i.prototype),"createNodes",this).call(this);e.set(this.inverse,Ad(t)),this.inverse=!0;var n=Td(Cd(i.prototype),"createNodes",this).call(this);return e.set(this.inverse,Ad(n)),this.inverse=void 0,this.nodes=[].concat(Ad(t),Ad(n.reverse())),this.completedNodes=e,[].concat(Ad(t),Ad(n.reverse()))}}]),i}(Gd),Wd=function(e){vd(i,e);var t=Sd(i);function i(e){var n;return fd(this,i),(e=Pd(e,{})).headHeightFactor=Pd(e.headHeightFactor,.15),e.neckHeightFactor=Pd(e.headWidthFactor,.8),e.neckWidthFactor=Pd(e.neckWidthFactor,.15),e.headWidthFactor=Pd(e.headWidthFactor,.4),e.tailWidthFactor=Pd(e.tailWidthFactor,.25),(n=t.call(this,e))._headTailHeightFactor=Pd(e.headTailHeightFactor,.5),n._tail=Pd(e.tail,!0),n._heightFactor=Pd(e.heightFactor,.8),n._tailHeightFactor=Pd(e.tailHeightFactor,.05),n.init(),zd(wd(n)),n.merge(),n}return _d(i,[{key:"addControl",value:function(e){this.controls[this.controls.length-1],this.controls.push(e),(!this.tail&&this.controls.length>=i.MIN_CONTROL_COUNT||this.controls.length>=i.MIN_CONTROL_COUNT+1)&&(this.init(),this.merge())}},{key:"updateControl",value:function(e,t){this.controls[e]=t,(!this.tail&&this.controls.length>=i.MIN_CONTROL_COUNT||this.controls.length>=i.MIN_CONTROL_COUNT+1)&&(this.init(),this.merge())}},{key:"popControl",value:function(){this.controls.pop()}},{key:"init",value:function(){var e;!this.tail&&this.controls.length<i.MIN_CONTROL_COUNT||this.tail&&this.controls.length<i.MIN_CONTROL_COUNT+1||(this._head1=this.controls[0],this._head2=this.controls[1],this.tail&&Md.isClockWise(this.controls[0],this.controls[1],this.controls[2])&&(e=[this._head2,this._head1],this._head1=e[0],this._head2=e[1]),this._headComponent=this.createHeadComponent(),this._bodyComponent=this.createBodyComponent(),this._tail&&(this._tailComponent=this.createTailComponent()))}},{key:"createHeadComponent",value:function(){var e,t;this.tail?(e=[Md.mid(this._head1,this._head2)].concat(Ad(this.controls.slice(2))),t=Md.distance(this._head1,this._head2)):e=this.controls;var i=e.length;return new Id({controls:e,heightFactor:this._headHeightFactor,neckHeightFactor:this._neckHeightFactor,headWidthFactor:this._headWidthFactor,neckWidthFactor:this._neckWidthFactor,headMaxHeight:this._headTailHeightFactor*t,index:[i-2,i-1]})}},{key:"createBodyComponent",value:function(){var e,t=this.controls.slice(2),i=Md.distance(this._headComponent.nodes[0],this._headComponent.nodes[4]),n=Md.baseLength(t);if(this._tail){e=Md.distance(this.controls[0],this.controls[1]),t=[Md.mid(this._head1,this._head2)].concat(Ad(t));var r=Md.baseLength(t);this._tailWidthFactor=e/r}else e=n*this._tailWidthFactor,t=this.controls;return new Hd({controls:t,headWidthFactor:i/n,tailWidthFactor:this._tailWidthFactor})}},{key:"createTailComponent",value:function(){if(this._bodyComponent){var e=this.controls;return new kd({controls:e,heightFactor:this._tailHeightFactor})}}}]),i}(Fd);yd(Wd,"MIN_CONTROL_COUNT",2);var Ud=function(e){vd(i,e);var t=Sd(i);function i(e){var n;return fd(this,i),(e=Pd(e,{})).neckHeightFactor=Pd(e.neckHeightFactor,.8),e.neckWidthFactor=Pd(e.neckWidthFactor,.2),e.headWidthFactor=Pd(e.headWidthFactor,.5),(n=t.call(this,e))._nodes=[],n.init(),zd(wd(n)),n.merge(),n}return _d(i,[{key:"addControl",value:function(e){this.controls.length>=i.MAX_CONTROL_COUNT&&this.popControl(),this.controls.push(e),this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"updateControl",value:function(e,t){this.controls[e]=t,this.controls.length>=i.MIN_CONTROL_COUNT&&(this.init(),this.merge())}},{key:"popControl",value:function(){return this.controls.pop()}},{key:"init",value:function(){this.controls.length<i.MIN_CONTROL_COUNT||this.getPoints()}},{key:"tempPoint4",value:function(e,t,i){var n,r,o=Md.mid(e,t),s=Md.distance(o,i),a=Md.angleOfThreePoints(e,o,i);a<Math.PI/2||(a<Math.PI&&a>=Math.PI/2?a=Math.PI-a:a>=Math.PI&&a<1.5*Math.PI?a-=Math.PI:a>=1.5*Math.PI&&(a=2*Math.PI-a)),n=s*Math.cos(a),r=s*Math.sin(a);var l=Md.thirdPoint(e,o,Math.PI/2,n,!0);return Md.thirdPoint(o,l,Math.PI/2,r,!1)}},{key:"getPoints",value:function(){var e,t,i,n,r,o,s,a=this.controls;if(!(a<3))if(t=3===a.length?this.tempPoint4.apply(this,Ad(a)):a[3],i=a.length<=4?Md.mid(a[0],a[1]):a[4],Md.isClockWise.apply(Md,Ad(this.controls.slice(0,3)))){var l;e=this.getArrowControls(a[0],i,t,!0),n=new Id({controls:e,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=Md.distance(a[0],i)/Md.baseLength(e)/2,o=this.getBodyControls(e,n.nodes[0],n.nodes[4],s),e=this.getArrowControls(i,a[1],a[2],!1),r=new Id({controls:e,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=Md.distance(i,a[1])/Md.baseLength(e)/2,(l=o).unshift.apply(l,Ad(this.getBodyControls(e,r.nodes[0],r.nodes[4],s)));var c=this.geoBodyPoints([n,r],o,i);this._nodes=[].concat(Ad(c[0]),Ad(n.nodes),Ad(c[1]),Ad(r.nodes),Ad(c[2]))}else{var u;e=this.getArrowControls(a[0],i,t,!1),n=new Id({controls:e,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=Md.distance(a[0],i)/Md.baseLength(e)/2,o=this.getBodyControls(e,n.nodes[0],n.nodes[4],s),e=this.getArrowControls(i,a[1],a[2],!0),r=new Id({controls:e,index:[2,3],neckHeightFactor:this._neckHeightFactor,neckWidthFactor:this._neckWidthFactor,headWidthFactor:this._headWidthFactor}),s=Md.distance(i,a[1])/Md.baseLength(e)/2,(u=o).unshift.apply(u,Ad(this.getBodyControls(e,r.nodes[0],r.nodes[4],s)));var h=this.geoBodyPoints([n,r],o,i);this._nodes=[].concat(Ad(h[0]),Ad(n.nodes),Ad(h[1]),Ad(r.nodes),Ad(h[2]))}}},{key:"getArrowControls",value:function(e,t,i,n){var r=Md.mid(e,t),o=Md.distance(r,i),s=Md.thirdPoint(i,r,0,.3*o,!1),a=Md.thirdPoint(i,r,0,.5*o,!1);return[r,s=Md.thirdPoint(r,s,Math.PI/2,o/5,n),a=Md.thirdPoint(r,a,Math.PI/2,o/4,n),i]}},{key:"geoBodyPoints",value:function(e,t,i){var n=Md.BezierCurve([this.controls[1],t[0],t[1],e[1].nodes[4]]);return[Md.BezierCurve([this.controls[0],t[6],t[7],e[0].nodes[0]]),Md.BezierCurve([e[0].nodes[4],t[5],t[4],i,t[3],t[2],e[1].nodes[0]]),n.reverse()]}},{key:"getBodyControls",value:function(e,t,i,n){for(var r=Md.distance.apply(Md,Ad(e)),o=Md.baseLength(e)*n,s=(o-Md.distance(t,i))/2,a=0,l=[],c=[],u=1;u<e.length-1;u++){var h=Md.angleOfThreePoints(e[u],e[u-1],e[u+1])/2,d=(o/2-(a+=Md.distance(e[u-1],e[u]))/r*s)/Math.sin(h);l.push(Md.thirdPoint(e[u-1],e[u],Math.PI-h,d,!1)),c.push(Md.thirdPoint(e[u-1],e[u],h,d,!0))}return l.concat(c)}},{key:"merge",value:function(){var e,t;this.reset(),(e=this.polygon).push.apply(e,Ad(Ad(this.nodes).flat())),(t=this.polyline).push.apply(t,Ad(Ad(this.nodes).flat()))}}]),i}(Fd);yd(Ud,"MIN_CONTROL_COUNT",3),yd(Ud,"MAX_CONTROL_COUNT",5);var jd={straightarrow:"straightarrow",attackarrow:"attackarrow",doublearrow:"doublearrow",validate:function(e){return e===jd.straightarrow||e===jd.attackarrow||e===jd.doublearrow}};const Vd={POINT:"point",POLYLINE:"polyline",POLYGON:"polygon",MODEL:"model",LABEL:"label",STRAIGHTARROW:jd.straightarrow,ATTACKARROW:jd.attackarrow,DOUBLEARROW:jd.doublearrow,BILLBOARD:"billboard",MUTIPOINT:"mutipoint",getOGCType:function(e){if(!Vd.validate(e))return"unknown";let t="";switch(e){case Vd.POINT:case Vd.LABEL:case Vd.MODEL:case Vd.BILLBOARD:t="Point";break;case Vd.POLYLINE:t="LineString";break;case Vd.STRAIGHTARROW:case Vd.ATTACKARROW:case Vd.DOUBLEARROW:case Vd.POLYGON:t="Polygon";break;case Vd.MUTIPOINT:t="MutlPoint"}return t},validate:function(e){return e===Vd.POINT||e===Vd.POLYLINE||e===Vd.POLYGON||e===Vd.STRAIGHTARROW||e===Vd.ATTACKARROW||e===Vd.DOUBLEARROW||e===Vd.MODEL||e===Vd.LABEL||e===Vd.MUTIPOINT||e===Vd.BILLBOARD},isPoint:function(e){return e===Vd.POINT||e===Vd.MODEL||e===Vd.LABEL||e===Vd.BILLBOARD},isArrow:function(e){return e===Vd.ATTACKARROW||e===Vd.STRAIGHTARROW||e===Vd.DOUBLEARROW}};var qd=Object.freeze(Vd);class $d extends md{constructor(e,t={}){super(e=C(e,{}),t),this._entityOptions=e,this._options=t,this._positions=C(e.position,new Cesium.Cartesian3),this._type=C(t.type,qd.POINT),this._entity=this.createEntity(),this._text=C(e.text,"")}getGeometry(){const e=$d.toDegrees(this.positions),t=[e.lon,e.lat,e.height];return{type:qd.getOGCType(this.type),coordinates:t}}createEntity(){super.createEntity(),delete this._entityOptions.position;const e={id:this.id,position:this.positions};return this.type===qd.POINT&&(e.point=de(this._entityOptions)),this.type===qd.BILLBOARD&&(e.billboard=de(this._entityOptions),x(e.billboard.image)||(e.billboard.image=we.buildModuleUrl("./assets/marker.png"))),this.type===qd.LABEL&&(e.label=de(this._entityOptions)),this.type===qd.MODEL&&(e.orientation=this._entityOptions.orientation,delete this._entityOptions.orientation,e.model=de(this._entityOptions),x(e.model.uri)||(e.model.uri=we.buildModuleUrl("./assets/Wood_Tower.gltf"))),this._options.label&&this._type!==qd.LABEL&&(e.label=Cesium.clone(this._options.label)),this._entityOptions=e,new Cesium.Entity(this._entityOptions)}equal(e){return $d.equal(this,e)}get text(){return this._text}set text(e){if(this.entity.label)this.entity.label.text=e;else{const t=Cesium.clone(this._entityOptions);t.text=e,this.addLabel(t)}this._text=e}addLabel(e){this.entity.label=e}updatePointStyle(e){if(e&&this.entity.point)for(const t in e)e.hasOwnProperty(t)&&(this.entity.point[t]=e[t])}updateLabelStyle(e){if(e&&this.entity.label)for(const t in e)e.hasOwnProperty(t)&&(this.entity.label[t]=e[t])}updateModelStyle(e){if(e&&this.entity.model)for(const t in e)e.hasOwnProperty(t)&&(this.entity.model[t]=e[t])}updateBillboardStyle(e){if(e&&this.entity.billboard)for(const t in e)e.hasOwnProperty(t)&&(this.entity.billboard[t]=e[t])}updatePosition(e){this.positions.x=e.x,this.positions.y=e.y,this.positions.z=e.z}static equal(e,t){return!(!x(e)||!x(t))&&(e instanceof $d&&(e=e.positions),t instanceof $d&&(t=t.positions),Cesium.Cartesian3.equals(e,t))}static defaultStyle={color:Cesium.Color.RED,pixelSize:5,outlineColor:Cesium.Color.WHITE,outlineWidth:3,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND};static toDegrees(e){return e instanceof Cesium.Cartesian3?w.fromCartesian(e):e instanceof $d?w.fromCartesian(e.positions):void 0}toGeoJson(){return $d.toGeoJson(this)}static toGeoJson(e){qd.getOGCType(e.type);const t=e.properties?e.properties.toJson():{};t.PlotType=e.type;return{type:"Feature",properties:t,geometry:e.getGeometry()}}static fromGeoJson(e,t){if("string"==typeof e&&(e=JSON.parse(e)),!x(e.geometry)||!x(e.properties))return;if(e.properties.PlotType!==qd.POINT)throw new CesiumProError("json没有包含一个有效的PointGraphic.");const i=e.geometry&&e.geometry.coordinates;return $d.fromCoordinates(i,e.properties,t)}static fromCoordinates(e,t,i=$d.defaultStyle){const n={position:Cesium.Cartesian3.fromDegrees(...e),properties:t,...i};return new $d(n)}static defaultPointStyle=$d.defaultStyle;static defaultLabelStyle={font:"30px Helvetica",fillColor:Cesium.Color.WHITE,showBackground:!0,style:Cesium.LabelStyle.FILL_AND_OUTLINE,scale:1,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,0),heightReference:Cesium.HeightReference.NONE};static defaultBillboardStyle={verticalOrigin:Cesium.VerticalOrigin.BASELINE,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND};static defaultModelStyle={colorBlendMode:Cesium.ColorBlendMode.HIGHLIGHT,color:Cesium.Color.WHITE,colorBlendAmount:.5,minimumPixelSize:64}}class Yd extends md{constructor(e,t={}){super(e,t),this._entityOptions=C(e,{}),this._positions=C(this._entityOptions.positions,[]),this._nodePositions=this._positions,this._type=qd.POLYLINE,this._entity=this.createEntity()}getGeometry(){const e=[],t=qd.getOGCType(this.type);for(const t of this.positions){const i=$d.toDegrees(t);e.push([i.lon,i.lat,i.height])}return{type:t,coordinates:e}}createEntity(){super.createEntity();const e={id:this.id,polyline:this._entityOptions};return this._entityOptions=e,new Cesium.Entity(this._entityOptions)}toGeoJson(){return Yd.toGeoJson(this)}startEdit(){super.startEdit()}stopEdit(){super.stopEdit()}addNode(e,t){const i=this.positions.length;if(x(t)&&t<i){for(let e=i;e>t;e--)this.positions[e]=this.positions[e-1];this.positions[t]=e}else this.positions.push(e)}removeNode(e){x(e)&&(e<0||e>=this.positions.length||this.positions.splice(e,1))}popNode(){const e=this.positions.length-1;this.removeNode(e)}updateNode(e,t){e>=this.positions.length||(this.positions[e]=t)}updateStyle(e){if(e&&this.entity.model)for(const t in e)e.hasOwnProperty(t)&&(this.entity.polyline[t]=e[t])}static toGeoJson(e){qd.getOGCType(e.type);const t=e.properties?e.properties.toJson():{};t.PlotType=e.type;return{type:"Feature",properties:t,geometry:e.getGeometry()}}static fromGeoJson(e,t){if("string"==typeof e&&(e=JSON.parse(e)),!x(e.geometry)||!x(e.properties))return;if(e.properties.PlotType!==qd.POLYLINE)throw new CesiumProError("json没有包含一个有效的PolylineGraphic.");const i=e.geometry&&e.geometry.coordinates;return Yd.fromCoordinates(i,e.properties,t)}static fromCoordinates(e,t,i=Yd.defaultStyle){const n={positions:Cesium.Cartesian3.fromDegreesArray(e.flat()),properties:t,...i};return new Yd(n)}static defaultStyle={clampToGround:!0,material:Cesium.Color.fromCssColorString("rgba(247,224,32,1)"),width:3};static highlightStyle={clampToGround:!0,material:Cesium.Color.AQUA,width:3}}class Xd extends md{constructor(e,t={}){super(e,t),this._entityOptions=e,this._positions=C(e.positions,[]),this._nodePositions=[...this.positions],this._nodePositions.length&&(this._nodePositions[this._nodePositions.length]=this._nodePositions[0]),this._type=qd.POLYGON,this._entity=this.createEntity()}getGeometry(){return Xd.getGeometry(this)}static getGeometry(e){const t=[],i=qd.getOGCType(e.type);for(const i of e.positions){const e=$d.toDegrees(i);t.push([e.lon,e.lat,e.height])}return t.push(t[0]),{type:i,coordinates:[t]}}createEntity(){super.createEntity(),delete this._entityOptions.positions;const e={id:this.id,polygon:{hierarchy:this.positions,...this._entityOptions}};return this._entityOptions.outline&&(e.polyline={positions:this._nodePositions,material:this._entityOptions.outlineColor,width:this._entityOptions.outlineWidth},e.polygon.outline=!1,e.polyline.clampToGround=this._entityOptions.heightReference===Cesium.HeightReference.CLAMP_TO_GROUND),this._entityOptions=e,new Cesium.Entity(this._entityOptions)}toGeoJson(){return Xd.toGeoJson(this)}startEdit(){super.startEdit()}stopEdit(){super.stopEdit()}addNode(e,t){const i=this.positions.length;if(x(t)&&t<i&&t>=0){for(let e=i;e>t;e--)this.positions[e]=this.positions[e-1],this._nodePositions[e]=this._nodePositions[e-1];this.positions[t]=e,this._nodePositions[t]=e}else t=i,this.positions.push(e),this._nodePositions[t]=e;this._positions.length&&(this._nodePositions[i+1]=this._nodePositions[0])}removeNode(e){if(!x(e))return;if(e<0||e>=this.positions.length)return;this.positions.splice(e,1),this._nodePositions.splice(e,1);const t=this.positions.length;0===e&&(this._nodePositions[t]=this._nodePositions[0])}popNode(){const e=this.positions.length-1;this.removeNode(e)}updateNode(e,t){if(e>=this.positions.length)return;this.positions[e]=t;const i=this.positions.length;this._nodePositions[e]=t,0===e&&(this._nodePositions[i]=t)}updateStyle(e){if(e&&this.entity.model)for(const t in e)e.hasOwnProperty(t)&&("outline"===t&&!e.outline&&this.entity.polyline&&(this.entity.polyline=void 0),"outlineColor"===t&&this.entity.polyline&&(this.entity.polyline.material=e[t]),"outlineWidth"===t&&this.entity.polyline&&(this.entity.polyline.width=e[t]),this.entity.polygon[t]=e[t])}static toGeoJson(e){qd.getOGCType(e.type);const t=e.properties?e.properties.toJson():{};t.PlotType=e.type;return{type:"Feature",properties:t,geometry:e.getGeometry()}}static fromGeoJson(e,i){if("string"==typeof e&&(e=JSON.parse(e)),!x(e.geometry)||!x(e.properties))return;if(e.properties.PlotType!==qd.POLYGON)throw new t("json没有包含一个有效的PolygonGraphic.");const n=e.geometry&&e.geometry.coordinates;return Xd.fromCoordinates(n,e.properties,i)}static fromCoordinates(e,t,i=Xd.defaultStyle){const n={positions:Cesium.Cartesian3.fromDegreesArray(e[0].flat()),properties:t,...i};return new Xd(n)}static defaultStyle={material:Cesium.Color.fromCssColorString("rgba(247,224,32,0.5)"),outlineColor:Cesium.Color.RED,outlineWidth:2,outline:!0,perPositionHeight:!1};static highlightStyle={material:new Cesium.ColorMaterialProperty(Cesium.Color.AQUA.withAlpha(.4)),outlineColor:Cesium.Color.AQUA.withAlpha(.4)};static centerFromPonits(e){const t=Cesium.BoundingSphere.fromPoints(e);if(t)return t.center}static center(e){let t=[];function i(e){if(e.getValue){const i=e.getValue();t=i instanceof Cesium.PolygonHierarchy?i.positions:i}else Array.isArray(e)&&(t=e)}if(e instanceof Cesium.Entity){const{hierarchy:t}=e.polygon;i(t)}else e.polygonHierarchy?t=e.polygonHierarchy.positions:e.hierarchy&&i(e.hierarchy);return Xd.centerFromPonits(t)}static isClockWise(e,t){const i=Cesium.EllipsoidTangentPlane.fromPoints(e,t.scene.globe.ellipsoid),n=Cesium.arrayRemoveDuplicates(e,Cesium.Cartesian3.equalsEpsilon,!0),r=i.projectPointsOntoPlane.bind(i)(n);return Cesium.PolygonPipeline.computeWindingOrder2D(r)===Cesium.WebGLConstants.CW}}const Jd=function(e,t,i){if(t===M.SURFACE_DISTANCE||t===M.SPACE_DISTANCE||t===M.HEIGHT){const t=i?"总长度 ":"";return e>1e4?`${t}${(e/1e3).toFixed(2)} km`:`${t}${e.toFixed(2)} m`}return t===M.SURFACE_AREA||t===M.SPACE_AREA?e>1e7?`${(e/1e3/1e3).toFixed(2)} km²`:`${e.toFixed(2)} m²`:t===M.ANGLE?`${(e%360).toFixed(2)}°`:void 0};class Zd{constructor(e){this._type=qd.MUTIPOINT,this._positions=C(e.positions,[]),this._entityOptions=e,this._values=[],this.createEntity(),this._activeNode=void 0,this.activeIndex=void 0}get activeNode(){return this._activeNode}set activeNode(e){this._activeNode=e,this.activeIndex=this.getIndexByPosition(e),this.highlightActiveNode()}highlightActiveNode(){const e=this._values.filter((e=>x(e.position)));for(let t=0,i=e.length;t<i;t++){const i=e[t];t===this.activeIndex?Zd.highlightNode(i):(i.point.color=this._entityOptions.color,i.point.outlineColor=this._entityOptions.outlineColor)}}getGeometry(){const e=[],t=qd.getOGCType(this.type);for(const t of this.positions){const i=$d.toDegrees(t);e.push([i.lon,i.lat,i.height])}return{type:t,coordinates:e}}static highlightNode(e){e&&e.point&&(e.point.color=Cesium.Color.AQUA,e.point.outlineColor=Cesium.Color.AQUA)}get(e){return this._values.filter((e=>x(e.position)))[e]}getIndexByPosition(e){for(let t=0,i=this._positions.length;t<i;t++){const i=this._positions[t];if($d.equal(i,e))return t}return-1}has(e){return this._values.includes(e)}createEntity(){delete this._entityOptions.positions;const e=this._entityOptions,t=this._positions.length;for(let i=0;i<t;i++){const t=new Cesium.Entity({position:new Cesium.CallbackProperty((()=>this._positions[i]),!1),point:e});this._values.push(t)}}addNode(e,t){const i=this._entityOptions;if(this._values.length<this._positions.length){return new Cesium.Entity({position:new Cesium.CallbackProperty((()=>this._positions[this._positions.length-1]),!1),point:i})}}removeNode(e){x(e)}popNode(){const e=this._positions.length-1;return this.removeNode(e)}updateNode(e,t){e>=this._positions.length||(this._positions[e]=t)}destroy(){this._values=void 0}toGeoJson(){return Zd.toGeoJson(this)}get values(){return this._values}static toGeoJson(e){qd.getOGCType(graphic.type);const t=graphic.properties?graphic.properties.toJson():{};t.PlotType=graphic.type;return{type:"Feature",properties:t,geometry:graphic.getGeometry()}}static defaultStyle=$d.defaultStyle}class Qd extends md{constructor(e,i={}){if(super(e,i),this._type=C(i.type,qd.STRAIGHTARROW),this._entityOptions=e,this._positions=C(e.positions,[]),this._arrowType=C(i.type,qd.STRAIGHTARROW),!jd.validate(this._arrowType))throw new t("无效的箭头图形.");const n=[];for(let e of this.positions){const t=$d.toDegrees(e);n.push([t.lon,t.lat])}this._arrowType===jd.straightarrow&&(this._arrow=new Bd({controls:n})),this._arrowType===jd.attackarrow&&(this._arrow=new Wd({controls:n})),this._arrowType===jd.doublearrow&&(this._arrow=new Ud({controls:n})),this._entity=this.createEntity(),this._nodePositions=this._positions}get arrow(){return this._arrow}getGeometry(){Xd.getGeometry(this)}createEntity(){super.createEntity(),delete this._entityOptions.positions;const e={id:this.id,polygon:{hierarchy:this._arrow.polygon.length?Cesium.Cartesian3.fromDegreesArray(this._arrow.polygon):this._arrow.polygon,...this._entityOptions}};return this._entityOptions.outline&&(e.polyline={positions:this._arrow.polyline.length?Cesium.Cartesian3.fromDegreesArray(this._arrow.polyline):this._arrow.polyline,material:this._entityOptions.outlineColor,width:this._entityOptions.outlineWidth},e.polygon.outline=!1),this._entityOptions=e,new Cesium.Entity(this._entityOptions)}startEdit(){}stopEdit(){}addNode(e){if(this.arrow){const t=$d.toDegrees(e);this.arrow.addControl([t.lon,t.lat]),this.updatePositions(),this.updateEntity(),this.lastLon=t.lon}}popNode(){this.arrow&&(this.arrow.popControl(),this.updatePositions(),this.updateEntity())}updateNode(e,t){if(this.arrow){const i=$d.toDegrees(t);this.arrow.updateControl(e,[i.lon,i.lat]),this.updatePositions(),this.updateEntity()}}updatePositions(){if(!x(this.arrow))return;const e=this.arrow.controls;for(let t=0;t<e.length;t++)this.positions[t]=Cesium.Cartesian3.fromDegrees(e[t][0],e[t][1]);this.positions.length>e.length&&this.positions.splice(e.length)}updateEntity(){if(this.entity&&this.entity.polygon){const e=this.arrow.polygon.filter((e=>!isNaN(e))),t=this.arrow.polyline.filter((e=>!isNaN(e)));this.entity.polygon.hierarchy=e.length?Cesium.Cartesian3.fromDegreesArray(e):e,this.entity.polyline&&(this.entity.polyline.positions=t.length?Cesium.Cartesian3.fromDegreesArray([...t,t[0],t[1]]):t)}}}const{LEFT_CLICK:Kd,MOUSE_MOVE:ep,RIGHT_CLICK:tp,LEFT_DOWN:ip,LEFT_UP:np,LEFT_DOUBLE_CLICK:rp,RIGHT_DOWN:op,RIGHT_UP:sp}=Cesium.ScreenSpaceEventType,ap=1,lp=3;const{Material:cp,Color:up,Property:hp}=Cesium;class dp{constructor(e={}){this._fadeInColor=C(e.fadeInColor,Cesium.Color.RED),this._fadeOutColor=C(e.fadeOutColor,Cesium.Color.WHITE.withAlpha(.5)),this._time=C(e.time,new Cesium.Cartesian2(0,0)),this._repeat=C(e.repeat,!1),this._duration=C(e.duration,3e3),this._fadeDirection=C(e.fadeDirection,{x:!0,y:!1}),this._maximumDistance=C(e.maximumDistance,.5),this._definitionChanged=new I}get fadeInColor(){return this._fadeInColor}set fadeInColor(e){this._fadeInColor=e}get fadeOutColor(){return this._fadeOutColor}set fadeOutColor(e){this._fadeOutColor=e}get duration(){return this._duration}set duration(e){this._duration=e}get time(){return this._time}set time(e){this._time=e}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get fadeDirection(){return this._fadeDirection}set fadeDirection(e){this._fadeDirection=e}get repeat(){return this._repeat}set repeat(e){this._repeat=e}get maximumDistance(){return this._maximumDistance}set maximumDistance(e){this._maximumDistance=e}getType(){return cp.FadeType}getValue(e,t){return t=C(t,{}),void 0===this._time&&(this._time={x:e.secondsOfDay,y:e.secondsOfDay}),this.fadeDirection.x&&(t.time.x=1e3*(e.secondsOfDay-this.time.x)/this.duration%1),this.fadeDirection.y&&(t.time.y=1e3*(e.secondsOfDay-this.time.y)/this.duration%1),t.fadeInColor=this.fadeInColor,t.fadeOutColor=this.fadeOutColor,t.maximumDistance=this.maximumDistance,t.repeat=this.repeat,t.fadeDirection=this.fadeDirection,t}equals(e){return this===e||e instanceof dp&&this.fadeInColor===e.fadeInColor&&this.fadeOutColor===e.fadeOutColor&&this.maximumDistance===e.maximumDistance&&this.repeat===e.repeat&&this.fadeDirection===e.fadeDirection}}const pp="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  vec2 st=materialInput.st*repeat;\n  float s=1.0-fract(time-st.s);\n  if(wrapX){\n    s= s=1.0-fract(time-st.t);\n  }\n  vec4 imageRGBA=texture2D(image,vec2(s,st.t));\n  material.alpha = imageRGBA.a * color.a;\n\tmaterial.diffuse = max(color.rgb * material.alpha * gradient, color.rgb);\n  return material;\n}\n",{Material:mp,Color:fp}=Cesium;mp.DynamicFlowWallType="DynamicFlowWall",mp._materialCache.addMaterial(mp.DynamicFlowWallType,{fabric:{type:mp.DynamicFlowWallType,uniforms:{color:new fp(1,0,0),time:0,gradient:1,image:"",repeat:{x:1,y:1},wrapX:!1},source:pp}});class gp{constructor(e={}){this._color=C(e.color,Cesium.Color.RED),this._time=0,this._duration=C(e.duration,1e3),this._gradient=C(e.gradient,1),this._image=C(e.image,we.buildModuleUrl("./assets/images/wall.png")),this._wrapX=C(e.wrapX,!1),this._repeat=C(e.repeat,new Cesium.Cartesian2(1,1)),this._definitionChanged=new I}get color(){return this._color}get time(){return this._time}get definitionChanged(){return this._definitionChanged}get isConstant(){return!1}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}get gradient(){return this._gradient>0?this._gradient:0}set gradient(e){this._gradient=e}get image(){return this._image}set image(e){this._image=e}get wrapX(){return this._wrapX}set wrapX(e){this._wrapX=e}get repeat(){return this._repeat}set repeat(e){this._repeat=e}getType(e){return mp.DynamicFlowWallType}getValue(e,t){return(t=C(t,{})).color=this.color,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.gradient=this.gradient,t.image=this.image,t.wrapX=this.wrapX,t.repeat=this.repeat,t}equals(e){return this===e||e instanceof gp&&this.color===e.color&&this.gradient===e.gradient&&this.image===e.image&&this.wrapX===e.wrapX&&this.repeat===e.repeat}}const _p="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  vec2 st=materialInput.st;\n  float per=fract(time);\n  float dis=distance(st,vec2(0.5));\n  if(dis*2.0>per){\n    discard;\n  }else{\n    material.alpha=pow(color.a*dis*2.0/per,gradient);\n    material.diffuse=color.rgb;\n  }\n  return material;\n}\n",{Material:yp,Color:vp}=Cesium;yp.DynamicSpreadType="DynamicSpread",yp._materialCache.addMaterial(yp.DynamicSpreadType,{fabric:{type:yp.DynamicSpreadType,uniforms:{color:new vp(1,0,0),time:0,gradient:0},source:_p}});class Cp{constructor(e={}){this._color=C(e.color,Cesium.Color.RED),this._time=0,this._duration=C(e.duration,1e3),this._gradient=C(e.gradient,4),this._definitionChanged=new I}get color(){return this._color}get time(){return this._time}get definitionChanged(){return this._definitionChanged}get isConstant(){return!1}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}get gradient(){return this._gradient}set gradient(e){this._gradient=e}getType(e){return yp.DynamicSpreadType}getValue(e,t){return(t=C(t,{})).color=this.color,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.gradient=this.gradient,t}equals(e){return this===e||e instanceof Cp&&this.color===e.color&&this.gradient===e.gradient}}const xp="\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material=czm_getDefaultMaterial(materialInput);\n  material.diffuse=1.5*color.rgb;\n  vec2 st=materialInput.st;\n  vec3 str=materialInput.str;\n  float dis=distance(st,vec2(0.5));\n  float per=fract(time);\n  if(dis>=0.5){\n    discard;\n  }else{\n    float perDis=0.5/count;\n    float bl=0.0;\n    for(int i=0;i<99;i++){\n      if(float(i)>count){\n        break;\n      }\n      float disNum=perDis*float(i)-dis+per/count;\n      if(disNum>0.0){\n        if(disNum<perDis){\n          bl=1.0-disNum/perDis;\n        }else if(disNum-perDis<perDis){\n          bl=1.0-abs(1.0-disNum/perDis);\n        }\n        material.alpha=pow(bl,gradient);\n      }\n    }\n  }\n  return material;\n}\n",{Material:wp,Color:bp,Property:Sp}=Cesium;wp.DynamicWaveType="DynamicWave",wp._materialCache.addMaterial(wp.DynamicWaveType,{fabric:{type:wp.DynamicWaveType,uniforms:{count:1,color:bp.RED,duration:1e3,time:0,gradient:.1},source:xp}});class Tp{constructor(e={}){this._color=C(e.color,Cesium.Color.RED),this._time=C(e.time,0),this._duration=C(e.duration,1e3),this._count=C(e.count,3),this._gradient=C(e.gradient,1),this._gradient=Cesium.Math.clamp(this._gradient,0,1),this._definitionChanged=new I}get color(){return this._color}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}get time(){return this._time}set time(e){this._time=e}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get count(){return this._count}set count(e){this._count=e}get gradient(){return this._gradient}set gradient(e){this._gradient=e}getType(){return wp.DynamicWaveType}getValue(e,t){return t=C(t,{}),void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.color=this.color,t.count=this.count,t.duration=this.duration,t.gradient=10*this.gradient+1,t}equals(e){return this===e||e instanceof Tp&&this.count===e.count&&this.duration===e.duration&&this.color===e.color&&this.gradient===e.gradient}}const{Material:Ap,Color:Ep}=Cesium;class Pp{constructor(e={}){this._definitionChanged=new I,this._color=void 0,this.color=e.color}get isConstant(){return!0}get definitionChanged(){return this._definitionChanged}getType(){return Pp.materialType}getValue(e,t={}){return t.color=this.color||Ep.RED,t}equals(e){return this===e||e instanceof Pp&&e.color===this.color}static materialType="PolylineAntialiasing"}Ap._materialCache.addMaterial(Pp.materialType,{fabric:{type:Pp.materialType,uniforms:{color:new Ep(1,1,1,1)},source:"\n    czm_material czm_getMaterial(czm_materialInput materialInput) { \n\n      czm_material material = czm_getDefaultMaterial(materialInput); \n\n      vec2 st = materialInput.st; \n\n      material.diffuse = color.rgb * vec3(2.0); \n\n      float dis = 1.0 - abs(0.5 - st.t) * 2.0;\n      material.alpha = pow(dis * color.a, 3.0); \n\n      return material; \n\n    }\n    "},translucent:!0});const Lp="\n  czm_material czm_getMaterial(czm_materialInput materialInput) {\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  vec2 st = materialInput.st;\n  vec4 imageRgba=texture2D(image, vec2(1.0 - fract(time - st.s),st.t));\n  material.alpha =imageRgba.a * color.a;\n  material.diffuse = max(color.rgb * material.alpha * 3.0, color.rgb);\n  return material;\n}\n",{Material:Dp,Color:Mp}=Cesium;Dp.PolylineFlowType="PolylineFlow",Dp._materialCache.addMaterial(Dp.PolylineFlowType,{fabric:{type:Dp.PolylineFlowType,uniforms:{color:new Mp(1,0,0),image:"",time:0},source:Lp}});class Rp{constructor(e={}){this._color=C(e.color,Cesium.Color.RED),this._time=C(e.time,0),this._image=C(e.image,we.buildModuleUrl("./assets/images/flowLine.png")),this._duration=C(e.duration,1e3),this._definitionChanged=new I}get color(){return this._color}get time(){return this._time}get image(){return this._image}set image(e){this._image=e}get definitionChanged(){return this._definitionChanged}get isConstant(){return!0}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}getType(e){return Dp.PolylineFlowType}getValue(e,t){return(t=C(t,{})).color=this.color,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.image=this.image,t}equals(e){return this===e||e instanceof Rp&&this.color===e.color&&this.image===e.image}}const{Material:Ip,Color:Np}=Cesium;Ip.ODLineType="ODLine",Ip._materialCache.addMaterial(Ip.ODLineType,{fabric:{type:Ip.ODLineType,uniforms:{startTime:0,speed:2.3,bidirectional:2,baseColor:Np.RED,color:Np.WHITE},source:"\n    czm_material czm_getMaterial(czm_materialInput materialInput) {\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st;\n      float t = fract(startTime + czm_frameNumber * speed / 1000.0);\n      t *= 1.03;\n      float alpha0 = smoothstep(t - 0.03, t, st.s) * step(st.s, t);\n      float mt = 1. - t;\n      float alpha1 = smoothstep(mt + 0.03, mt, st.s) * step(mt, st.s);\n\n      float a0 = step(abs(bidirectional - 0.0) - 0.001, 0.);//1\n      float a1 = step(abs(bidirectional - 1.0) - 0.001, 0.);//\n      float db = step(abs(bidirectional - 2.0) - 0.001, 0.);\n      float alpha = alpha0 * (a0 + db) + alpha1 * (a1 + db);\n      alpha = clamp(alpha, 0., 1.);    \n      material.diffuse = color.rgb * alpha + baseColor.rgb * (1. - alpha);\n      material.alpha = (color.a * alpha + baseColor.a * (1. - alpha));\n      return material;\n    }"}});class Op{constructor(e={}){this.baseColor=C(e.baseColor,Cesium.Color.RED),this.color=C(e.color,Cesium.Color.WHITE),this.speed=C(e.speed,3),this.startTime=C(e.startTime,Math.random()),this.bidirectional=C(e.bidirectional,2),this._definitionChanged=new Event}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(){return Ip.ODLineType}getValue(e,t){return(t=C(t,{})).baseColor=this.baseColor,t.color=this.color,t.speed=this.speed,t.startTime=this.startTime,t.bidirectional=this.bidirectional,t}equals(e){return this===e||e instanceof Op&&this.baseColor===e.baseColor&&this.speed===e.speed&&this.color===e.color&&this.startTime===e.startTime&&this.bidirectional===e.bidirectional}}const Fp="czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n         czm_material material = czm_getDefaultMaterial(materialInput);\n         vec2 st = materialInput.st;\n         vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n         material.alpha=colorImage.a*color.a;\n         float factor=colorImage.a;\n         material.diffuse=mix(color.rgb,colorImage.rgb,factor);\n         return material;\n        }",{Material:kp,Color:zp}=Cesium;kp.PolylineTrailLinkType="PolylineTrailLink",kp._materialCache.addMaterial(kp.PolylineTrailLinkType,{fabric:{type:kp.PolylineTrailLinkType,uniforms:{color:new zp(1,0,0),image:"",time:0},source:Fp}});class Bp{constructor(e={}){this._color=C(e.color,Cesium.Color.RED),this._time=C(e.time,0),this._image=C(e.image,we.buildModuleUrl("./assets/images/colors.png")),this._duration=C(e.duration,1e3),this._definitionChanged=new I}get color(){return this._color}set color(e){this._color=e}get duration(){return this._duration}set duration(e){this._duration=e}get time(){return this._time}set time(e){this._time=e}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}get image(){return this._image}set image(e){this._image=e}getType(){return kp.PolylineTrailLinkType}getValue(e,t){return t=C(t,{}),void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this.time)/this.duration,t.color=this.color,t.image=this.image,t}equals(e){return this===e||e instanceof Bp&&this.color===e.color&&this.image===e.image}}Cesium;const{BoundingRectangle:Gp,Cartesian3:Hp,Cartographic:Wp,Color:Up,defined:jp,destroyObject:Vp,Matrix4:qp,OrthographicOffCenterFrustum:$p,PixelFormat:Yp,ClearCommand:Xp,Framebuffer:Jp,PassState:Zp,PixelDatatype:Qp,Texture:Kp,PolygonGeometry:em,PolygonHierarchy:tm,BoundingSphere:im,VertexArray:nm,BufferUsage:rm,ShaderProgram:om,RenderState:sm,WebGLConstants:am,DrawCommand:lm,PrimitiveType:cm,Pass:um,Transforms:hm,CustomShader:dm,UniformType:pm,TextureUniform:mm,TextureManager:fm,ShaderSource:gm}=Cesium,_m=fm.prototype.loadTexture2D;fm.prototype.loadTexture2D=function(e,t){t.texture?this._textures[e]=t.texture:_m(e,t)};class ym{constructor(){this.viewMatrix=qp.IDENTITY,this.inverseViewMatrix=qp.IDENTITY,this.frustum=new $p,this.positionCartographic=new Wp,this.upWC=Hp.clone(Hp.UNIT_Y),this.rightWC=Hp.clone(Hp.UNIT_X),this.directionWC=Hp.clone(Hp.UNIT_Z),this.viewPorjectionMatrix=qp.IDENTITY}clone(e){qp.clone(e.viewMatrix,this.viewMatrix),qp.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),Wp.clone(e.positionCartographic,this.positionCartographic),Hp.clone(e.upWC,this.upWC),Hp.clone(e.rigtWC,this.rightWC),Hp.clone(e.directionWC,this.directionWC)}}function vm(e){const t=parseInt(this._width),i=parseInt(this._height),n=this._colorTexture,r=jp(n)&&n.width!==t&&n.height!==i;jp(this.frameBuffer)||r||(n&&!n.isDestroyed()&&n.destroy(),this._depthStenclilTexture&&!this._depthStenclilTexture.isDestroyed()&&this._depthStenclilTexture.destroy(),this.frameBuffer&&!this.frameBuffer.isDestroyed()&&this.frameBuffer.destroy(),this._colorTexture=new Kp({context:this._frameState.context,width:this._width,height:this._height,pixelFormat:Yp.RGBA,pixelDatatype:Qp.UNSIGNED_BYTE}),window._colorTexture=this._colorTexture,this._clearPassState=new Zp(e.context),this._depthStenclilTexture=new Kp({context:e.context,width:t,height:i,pixelFormat:Yp.DEPTH_STENCIL,pixelDatatype:Qp.UNSIGNED_INT_24_8}),this.frameBuffer=new Jp({context:e.context,colorTextures:[this._colorTexture],depthStencilTexture:this._depthStenclilTexture,destroyAttachments:!1}))}const{AssociativeArray:Cm,destroyObject:xm,CustomDataSource:wm,Event:bm}=Cesium,Sm=function(){return{}},Tm=[31638318];for(let e=1;e<20;e++)Tm.push(Tm[e-1]/2);function Am(e){let t=0;for(let i of Tm){if(e>i)break;t++}return t}class Em extends Ka{constructor(e={}){super(e),this._id=C(e.id,Ue()),this._createGeometryFunction=e.createGeometryFunction,this._data=e.objects,this._needReclass=!0,this._changeEvent=new bm,this._maxClusterLevel=C(e.maxClusterLevel,12),this._minLoadLevel=C(e.minLoadLevel,12),this._geometryCached={},this._objectsCached={}}get id(){return this._id}get dataSource(){return this._dataSource}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(e){this._minLoadLevel=e}get objects(){return this._objects||this._data}set objects(e){this._objects=e}updateCluster(e){const t=Am(e),i=this._objects;return t>this._maxClusterLevel?(this._objects=this._data,this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._objectsCached[t]?(this._objects=this._objectsCached[t],this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._cluster?new Promise(((e,i)=>{this._cluster.update(),this._objects=this._cluster._clusterObjects,this._objectsCached[t]=JSON.parse(JSON.stringify(this._objects)),this._needReclass=!0,e(!0)})):void 0}beginUpdate(e){Am(e.camera.positionCartographic.height)<this._minLoadLevel?this._objects=[]:this._objects=this._data}endUpdate(e){const t=Am(e.camera.positionCartographic.height);return this._needReclass=!1,t<this._minLoadLevel}initialize(e,t){this._dataSource||(this._scene=t,this._dataSource=new wm("massive-layer"+Ue()),this._scene.dataSources.add(this._dataSource))}createGeometry(e,t,i){if(e.level<this._minLoadLevel)return;const n=C(this._createGeometryFunction,Sm)(i,e,t),r=Object.keys(i);for(let e of r)"position"!==e&&"id"!==e&&"cartesian"!==e&&"cartographic"!==e&&"label"!==e&&"billboard"!==e&&"__pixel"!==e&&(n[e]=i[e]);return this.add(n),n}removeGeometry(e,t){if(!t)return;const i=this._dataSource.entities.remove(t);return xm(t),i}add(e){this._dataSource&&e&&this._dataSource.entities.add(e)}removeAll(){this._dataSource.entities.removeAll()}isDestroyed(){return!1}destroy(){this._dataSource.removeAll(),xm(this)}}const{QuadtreeTileProvider:Pm,GeographicTilingScheme:Lm,when:Dm,Event:Mm,Cartographic:Rm,Color:Im,Entity:Nm}=Cesium;const{destroyObject:Om,Event:Fm,Transforms:km}=Cesium,zm=function(e,t){const i={};if(e.modelMatrix)i.modelMatrix=e.modelMatrix;else if(e.position){let t=e.position;if(e.position instanceof w&&(t=e.position.toCartesian()),!t)return;i.modelMatrix=km.eastNorthUpToFixedFrame(t),e.modelMatrix=i.modelMatrix}return i.minimumPixelSize=C(e.minimumPixelSize,t.minimumPixelSize),i.maximumScale=C(e.maximumScale,t.maximumScale),i.scale=C(e.scale,t.scale),i.allowPicking=C(e.allowPicking,t.allowPicking),i.shadows=C(e.shadows,t.shadows),i.id=e._id,i.url=C(e.url,t.url),Cesium.Model.fromGltf(i)},Bm=[31638318];for(let e=1;e<20;e++)Bm.push(Bm[e-1]/2);function Gm(e){let t=0;for(let i of Bm){if(e>i)break;t++}return t}const{QuadtreeTileProvider:Hm,GeographicTilingScheme:Wm,when:Um,Event:jm,Cartographic:Vm,Color:qm,Entity:$m,createGuid:Ym}=Cesium;const Xm="\nczm_material czm_getMaterial(czm_materialInput materialInput) {\n    float time = (czm_frameNumber * speed / 1000.0);\n    vec2 st = fract(repeat * materialInput.st);\n    st = vec2(fract(time - st.s), st.t);\n    vec4 imageColor = texture2D(image, st);\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    float alpha = 1.0 - (abs(0.5 - st.t) * 2.0);\n    material.alpha = imageColor.a * color.a * alpha;\n    material.diffuse = imageColor.rgb * color.rgb;\n    return material;\n}\n",{Material:Jm,Cartesian2:Zm,Color:Qm}=Cesium;Jm.FlowImageType="FlowImage",Jm._materialCache.addMaterial(Jm.FlowImageType,{fabric:{type:Jm.FlowImageType,uniforms:{color:new Qm(1,1,1,1),repeat:new Zm(1,1),image:"",speed:1},source:Xm}});class Km{constructor(e){e=C(e,{}),this._options=e,this._postProcessStage=void 0}addTo(e){if(he(e),x(this._viewer)||(this._viewer=e),this._postProcessStage||(this._postProcessStage=this.createPostStage()),!this._viewer.scene.postProcessStages.contains(this._postProcessStage)){if(!this._postProcessStage)throw new t("createPostStage method must reture a Cesium.PostProcessStage object.");return this._viewer.scene.postProcessStages.add(this._postProcessStage)}}createPostStage(){throw new t("抽象类不能被直接调用")}get selected(){return this._postProcessStage?this._postProcessStage.selected:[]}set selected(e){this._postProcessStage&&(this._postProcessStage.selected=e)}get enabled(){if(this._postProcessStage)return this._postProcessStage.enabled}set enabled(e){this._postProcessStage&&(this._postProcessStage.enabled=e)}remove(){if(this._viewer)return this._viewer.scene.postProcessStages.remove(this._postProcessStage)}destroy(){this.remove(),this._postProcessStage.isDestroyed()||this._postProcessStage.destroy(),this._viewer=void 0}zoomTo(){if(this._viewer&&this.center)return this.viewer.flyTo(this.center,{duration:0})}}var ef='#ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform bool u_showIntersection;\nuniform bool u_showThroughEllipsoid;\n\nuniform float u_radius;\nuniform float u_xHalfAngle;\nuniform float u_yHalfAngle;\nuniform float u_normalDirection;\nuniform vec4 u_color;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvec4 getColor(float sensorRadius, vec3 pointEC)\n{\n  czm_materialInput materialInput;\n\n  vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\n  materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\n  materialInput.str = pointMC / sensorRadius;\n\n  vec3 positionToEyeEC = -v_positionEC;\n  materialInput.positionToEyeEC = positionToEyeEC;\n\n  vec3 normalEC = normalize(v_normalEC);\n  materialInput.normalEC = u_normalDirection * normalEC;\n\n  czm_material material = czm_getMaterial(materialInput);\n\n  material.diffuse = u_color.rgb;\n  material.alpha = u_color.a;\n\n  return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);\n\n}\n\nbool isOnBoundary(float value, float epsilon)\n{\n  float width = getIntersectionWidth();\n  float tolerance = width * epsilon;\n\n#ifdef GL_OES_standard_derivatives\n  float delta = max(abs(dFdx(value)), abs(dFdy(value)));\n  float pixels = width * delta;\n  float temp = abs(value);\n  // There are a couple things going on here.\n  // First we test the value at the current fragment to see if it is within the tolerance.\n  // We also want to check if the value of an adjacent pixel is within the tolerance,\n  // but we don\'t want to admit points that are obviously not on the surface.\n  // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\n  // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\n  // the points is close to zero.\n  return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\n#else\n  return abs(value) < tolerance;\n#endif\n}\n\nvec4 shade(bool isOnBoundary)\n{\n  if (u_showIntersection && isOnBoundary)\n  {\n      return getIntersectionColor();\n  }\n  return getColor(u_radius, v_positionEC);\n}\n\nfloat ellipsoidSurfaceFunction(czm_ellipsoid ellipsoid, vec3 point)\n{\n  vec3 scaled = ellipsoid.inverseRadii * point;\n  return dot(scaled, scaled) - 1.0;\n}\n\nvoid main()\n{\n  vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\n  vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\n\n  //vec3 pixDir = normalize(v_position);\n  float positionX = v_position.x;\n  float positionY = v_position.y;\n  float positionZ = v_position.z;\n\n  vec3 zDir = vec3(0.0, 0.0, 1.0);\n  vec3 lineX = vec3(positionX, 0 ,positionZ);\n  vec3 lineY = vec3(0, positionY, positionZ);\n  float resX = dot(normalize(lineX), zDir);\n  if(resX < cos(u_xHalfAngle) - 0.0001){\n      discard;\n  }\n  float resY = dot(normalize(lineY), zDir);\n  if(resY < cos(u_yHalfAngle)- 0.0001){\n      discard;\n  }\n\n\n  czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n  float ellipsoidValue = ellipsoidSurfaceFunction(ellipsoid, v_positionWC);\n\n  // Occluded by the ellipsoid?\nif (!u_showThroughEllipsoid)\n{\n    // Discard if in the ellipsoid\n    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\n    if (ellipsoidValue < 0.0)\n    {\n          discard;\n    }\n\n    // Discard if in the sensor\'s shadow\n    if (inSensorShadow(sensorVertexWC, ellipsoid, v_positionWC))\n    {\n        discard;\n    }\n  }\n\n  // Notes: Each surface functions should have an associated tolerance based on the floating point error.\n  bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\n  gl_FragColor = shade(isOnEllipsoid);\n\n}',tf="\nuniform vec4 u_intersectionColor;\nuniform float u_intersectionWidth;\nuniform vec4 u_lineColor;\nbool inSensorShadow(vec3 coneVertexWC, czm_ellipsoid ellipsoidEC, vec3 pointWC)\n{\n  // Diagonal matrix from the unscaled ellipsoid space to the scaled space.\n  vec3 D = ellipsoidEC.inverseRadii;\n\n  // Sensor vertex in the scaled ellipsoid space\n  vec3 q = D * coneVertexWC;\n  float qMagnitudeSquared = dot(q, q);\n  float test = qMagnitudeSquared - 1.0;\n\n  // Sensor vertex to fragment vector in the ellipsoid's scaled space\n  vec3 temp = D * pointWC - q;\n  float d = dot(temp, q);\n\n  // Behind silhouette plane and inside silhouette cone\n  return (d < -test) && (d / length(temp) < -sqrt(test));\n}\n\n///////////////////////////////////////////////////////////////////////////////\n\nvec4 getLineColor()\n{\n  return u_lineColor;\n}\n\nvec4 getIntersectionColor()\n{\n  return u_intersectionColor;\n}\n\nfloat getIntersectionWidth()\n{\n  return u_intersectionWidth;\n}\n\nvec2 sensor2dTextureCoordinates(float sensorRadius, vec3 pointMC)\n{\n  // (s, t) both in the range [0, 1]\n  float t = pointMC.z / sensorRadius;\n  float s = 1.0 + (atan(pointMC.y, pointMC.x) / czm_twoPi);\n  s = s - floor(s);\n\n  return vec2(s, t);\n}",nf='\n#ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform bool u_showIntersection;\nuniform bool u_showThroughEllipsoid;\n\nuniform float u_radius;\nuniform float u_xHalfAngle;\nuniform float u_yHalfAngle;\nuniform float u_normalDirection;\nuniform float u_type;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvec4 getColor(float sensorRadius, vec3 pointEC)\n{\n  czm_materialInput materialInput;\n\n  vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\n  materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\n  materialInput.str = pointMC / sensorRadius;\n\n  vec3 positionToEyeEC = -v_positionEC;\n  materialInput.positionToEyeEC = positionToEyeEC;\n\n  vec3 normalEC = normalize(v_normalEC);\n  materialInput.normalEC = u_normalDirection * normalEC;\n\n  czm_material material = czm_getMaterial(materialInput);\n\n  return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);\n\n}\n\nbool isOnBoundary(float value, float epsilon)\n{\n  float width = getIntersectionWidth();\n  float tolerance = width * epsilon;\n\n#ifdef GL_OES_standard_derivatives\n  float delta = max(abs(dFdx(value)), abs(dFdy(value)));\n  float pixels = width * delta;\n  float temp = abs(value);\n  // There are a couple things going on here.\n  // First we test the value at the current fragment to see if it is within the tolerance.\n  // We also want to check if the value of an adjacent pixel is within the tolerance,\n  // but we don\'t want to admit points that are obviously not on the surface.\n  // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\n  // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\n  // the points is close to zero.\n  return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\n#else\n  return abs(value) < tolerance;\n#endif\n}\n\nvec4 shade(bool isOnBoundary)\n{\n  if (u_showIntersection && isOnBoundary)\n  {\n      return getIntersectionColor();\n  }\n  if(u_type == 1.0){\n      return getLineColor();\n  }\n  return getColor(u_radius, v_positionEC);\n}\n\nfloat ellipsoidSurfaceFunction(czm_ellipsoid ellipsoid, vec3 point)\n{\n  vec3 scaled = ellipsoid.inverseRadii * point;\n  return dot(scaled, scaled) - 1.0;\n}\n\nvoid main()\n{\n  vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\n  vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\n\n  //vec3 pixDir = normalize(v_position);\n  float positionX = v_position.x;\n  float positionY = v_position.y;\n  float positionZ = v_position.z;\n\n  vec3 zDir = vec3(0.0, 0.0, 1.0);\n  vec3 lineX = vec3(positionX, 0 ,positionZ);\n  vec3 lineY = vec3(0, positionY, positionZ);\n  float resX = dot(normalize(lineX), zDir);\n  if(resX < cos(u_xHalfAngle)-0.00001){\n      discard;\n  }\n  float resY = dot(normalize(lineY), zDir);\n  if(resY < cos(u_yHalfAngle)-0.00001){\n      discard;\n  }\n\n\n  czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n  float ellipsoidValue = ellipsoidSurfaceFunction(ellipsoid, v_positionWC);\n\n  // Occluded by the ellipsoid?\nif (!u_showThroughEllipsoid)\n{\n    // Discard if in the ellipsoid\n    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\n    if (ellipsoidValue < 0.0)\n    {\n          discard;\n    }\n\n    // Discard if in the sensor\'s shadow\n    if (inSensorShadow(sensorVertexWC, ellipsoid, v_positionWC))\n    {\n        discard;\n    }\n  }\n\n  // Notes: Each surface functions should have an associated tolerance based on the floating point error.\n  bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\n  //isOnEllipsoid = false;\n  //if((resX >= 0.8 && resX <= 0.81)||(resY >= 0.8 && resY <= 0.81)){\n  /*if(false){\n      gl_FragColor = vec4(1.0,0.0,0.0,1.0);\n  }else{\n      gl_FragColor = shade(isOnEllipsoid);\n  }\n*/\n  gl_FragColor = shade(isOnEllipsoid);\n\n}',rf="attribute vec4 position;\nattribute vec3 normal;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n  gl_Position = czm_modelViewProjection * position;\n  v_position = vec3(position);\n  v_positionWC = (czm_model * position).xyz;\n  v_positionEC = (czm_modelView * position).xyz;\n  v_normalEC = czm_normal * normal;\n}";const{Matrix4:of,Material:sf,Color:af,JulianDate:lf,BoundingSphere:cf,DrawCommand:uf,PrimitiveType:hf,SceneMode:df,Matrix3:pf,Buffer:mf,BufferUsage:ff,VertexArray:gf,VertexFormat:_f,ComponentDatatype:yf,RenderState:vf,BlendingState:Cf,Pass:xf,combine:wf,CullFace:bf,Cartesian3:Sf,EllipsoidGeometry:Tf,EllipsoidOutlineGeometry:Af,ShaderSource:Ef,ShaderProgram:Pf}=Cesium,{cos:Lf,sin:Df,tan:Mf,atan:Rf}=Math,If=Cesium.Math,Nf={position:0,normal:1};function Of(e,t,i,n,r,o,s,a,l,c,u,h){c&&i&&(i.vertexArray=s,i.renderState=r,i.shaderProgram=o,i.uniformMap=wf(a,e._material._uniforms),i.uniformMap.u_normalDirection=function(){return-1},i.pass=u,i.modelMatrix=l,e._colorCommands.push(i)),t.vertexArray=s,t.renderState=n,t.shaderProgram=o,t.uniformMap=wf(a,e._material._uniforms),h&&(t.uniformMap.u_type=function(){return 1}),t.pass=u,t.modelMatrix=l,e._colorCommands.push(t)}function Ff(e,t,i){const n=e.slice,r=Lf(i),o=Mf(i),s=Lf(t),a=Mf(t),l=Rf(s*o),c=Rf(r*a),u=[];for(let e=0;e<n;e++){const t=2*l*e/(n-1)-l;u.push(new Sf(0,Df(t),Lf(t)))}const h=[];for(let e=0;e<n;e++){const t=2*c*e/(n-1)-c;h.push(new Sf(Df(t),0,Lf(t)))}return{zoy:u,zox:h}}function kf(e,t){const i=t.length-1,n=new Float32Array(9*i);let r=0;for(let e=0;e<i;e++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=t[e].x,n[r++]=t[e].y,n[r++]=t[e].z,n[r++]=t[e+1].x,n[r++]=t[e+1].y,n[r++]=t[e+1].z;const o=mf.createVertexBuffer({context:e,typedArray:n,usage:ff.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:Nf.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:yf.FLOAT,offsetInBytes:0,strideInBytes:s}];return new gf({context:e,attributes:a})}const{VertexFormat:zf}=Cesium;const Bf="\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform float alpha;\nuniform float snowDensity;\nvarying vec2 v_textureCoordinates;\nuniform float speed;\nfloat snow(vec2 uv,float scale){\n  float time = czm_frameNumber/speed ;\n  float w=smoothstep(1.,0.,-uv.y*(scale/10.));\n  if(w<.1)return 0.;\n  uv+=time/scale;\n  uv.y+=time*2./scale;\n  uv.x+=sin(uv.y+time*.5)/scale;\n  uv*=scale;\n  vec2 s=floor(uv),f=fract(uv),p;\n  float k=3.;\n  p=.5+.35*sin(11.*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.))-f;\n  float d=length(p);\n  k=min(d,k);\n  k=smoothstep(0.,k,sin(f.x+f.y)*0.01);\n  return k*w;\n}\nvoid main(){\n  vec4 bgColor=vec4(0.0);\n  vec4 color = texture2D(colorTexture, v_textureCoordinates);\n  vec4 depth = texture2D(depthTexture, v_textureCoordinates);\n  vec2 resolution = czm_viewport.zw;\n  vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n  vec3 snowColor=vec3(0);\n  float c = 0.0;\n  float per=20.0/snowDensity;\n  for(float scale=2.0;scale<=20.0;scale++){\n    if(scale>snowDensity){\n      break;\n    }\n    c+=snow(uv,scale*per);\n  }\n  //雪花\n  snowColor=(vec3(c));\n  if (depth.r >= 1.0) {\n    gl_FragColor = color;\n    return;\n  }\n  vec4 positionEC = czm_p_toEye(gl_FragCoord.xy, czm_unpackDepth(texture2D(depthTexture, v_textureCoordinates)));\n  vec3 dx = dFdx(positionEC.xyz);\n  vec3 dy = dFdy(positionEC.xyz);\n  vec3 nor = normalize(cross(dx,dy));\n  vec4 positionWC = normalize(czm_inverseView * positionEC);\n  vec3 normalWC = normalize(czm_inverseViewRotation * nor);\n  float dotNumWC = dot(positionWC.xyz,normalWC);\n  //雪地\n  bgColor = mix(color,vec4(1.0),alpha * max(dotNumWC, 0.3));\n  gl_FragColor = mix(bgColor,vec4(snowColor,1.0),0.5);\n}";class Gf{constructor(e){this.commandType=e.commandType,this.geometry=e.geometry,this.attributeLocations=e.attributeLocations,this.primitiveType=e.primitiveType,this.uniformMap=e.uniformMap,this.vertexShaderSource=e.vertexShaderSource,this.fragmentShaderSource=e.fragmentShaderSource,this.rawRenderState=e.rawRenderState,this.framebuffer=e.framebuffer,this.outputTexture=e.outputTexture,this.autoClear=Cesium.defaultValue(e.autoClear,!1),this.preExecute=e.preExecute,this.show=!0,this.commandToExecute=void 0,this.clearCommand=void 0,this.autoClear&&(this.clearCommand=new Cesium.ClearCommand({color:new Cesium.Color(0,0,0,0),depth:1,framebuffer:this.framebuffer,pass:Cesium.Pass.OPAQUE}))}createCommand(e){switch(this.commandType){case"Draw":{const t=Cesium.VertexArray.fromGeometry({context:e,geometry:this.geometry,attributeLocations:this.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW}),i=Cesium.ShaderProgram.fromCache({context:e,attributeLocations:this.attributeLocations,vertexShaderSource:this.vertexShaderSource,fragmentShaderSource:this.fragmentShaderSource}),n=Cesium.RenderState.fromCache(this.rawRenderState);return new Cesium.DrawCommand({owner:this,vertexArray:t,primitiveType:this.primitiveType,uniformMap:this.uniformMap,modelMatrix:Cesium.Matrix4.IDENTITY,shaderProgram:i,framebuffer:this.framebuffer,renderState:n,pass:Cesium.Pass.OPAQUE})}case"Compute":return new Cesium.ComputeCommand({owner:this,fragmentShaderSource:this.fragmentShaderSource,uniformMap:this.uniformMap,outputTexture:this.outputTexture,persists:!0})}}setGeometry(e,t){this.geometry=t;const i=Cesium.VertexArray.fromGeometry({context:e,geometry:this.geometry,attributeLocations:this.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW});this.commandToExecute.vertexArray=i}update(e){this.show&&(Cesium.defined(this.commandToExecute)||(this.commandToExecute=this.createCommand(e.context)),Cesium.defined(this.preExecute)&&this.preExecute(),Cesium.defined(this.clearCommand)&&e.commandList.push(this.clearCommand),e.commandList.push(this.commandToExecute))}isDestroyed(){return!1}destroy(){return Cesium.defined(this.commandToExecute)&&(this.commandToExecute.shaderProgram=this.commandToExecute.shaderProgram&&this.commandToExecute.shaderProgram.destroy()),Cesium.destroyObject(this)}}function Hf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Wf(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var i=function e(){if(this instanceof e){var i=[null];i.push.apply(i,arguments);var n=Function.bind.apply(t,i);return new n}return t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),i}var Uf={};
/*! https://mths.be/utf8js v3.0.0 by @mathias */!function(e){!function(e){var t,i,n,r=String.fromCharCode;function o(e){for(var t,i,n=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(i=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--):n.push(t);return n}function s(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function a(e,t){return r(e>>t&63|128)}function l(e){if(0==(4294967168&e))return r(e);var t="";return 0==(4294965248&e)?t=r(e>>6&31|192):0==(4294901760&e)?(s(e),t=r(e>>12&15|224),t+=a(e,6)):0==(4292870144&e)&&(t=r(e>>18&7|240),t+=a(e,12),t+=a(e,6)),t+=r(63&e|128)}function c(){if(n>=i)throw Error("Invalid byte index");var e=255&t[n];if(n++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(){var e,r;if(n>i)throw Error("Invalid byte index");if(n==i)return!1;if(e=255&t[n],n++,0==(128&e))return e;if(192==(224&e)){if((r=(31&e)<<6|c())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if((r=(15&e)<<12|c()<<6|c())>=2048)return s(r),r;throw Error("Invalid continuation byte")}if(240==(248&e)&&(r=(7&e)<<18|c()<<12|c()<<6|c())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}e.version="3.0.0",e.encode=function(e){for(var t=o(e),i=t.length,n=-1,r="";++n<i;)r+=l(t[n]);return r},e.decode=function(e){t=o(e),i=t.length,n=0;for(var s,a=[];!1!==(s=u());)a.push(s);return function(e){for(var t,i=e.length,n=-1,o="";++n<i;)(t=e[n])>65535&&(o+=r((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=r(t);return o}(a)}}(e)}(Uf);var jf=Object.freeze({__proto__:null,IOBuffer:class e{constructor(t=8192,i={}){let n=!1;"number"==typeof t?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const r=i.offset?i.offset>>>0:0,o=t.byteLength-r;let s=r;(ArrayBuffer.isView(t)||t instanceof e)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+r),t=t.buffer),this.lastWrittenByte=n?o:0,this.buffer=t,this.length=o,this.byteLength=o,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,o),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const t=2*(this.offset+e),i=new Uint8Array(t);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){const t=new Uint8Array(e);for(let i=0;i<e;i++)t[i]=this.readByte();return t}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let i=0;i<e;i++)t+=this.readChar();return t}readUtf8(e=1){const t=this.readChars(e);return Uf.decode(t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){const t=Uf.encode(e);return this.writeChars(t)}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),Vf=Wf(jf),qf={};function $f(e){e.offset%4!=0&&e.skip(4-e.offset%4)}qf.notNetcdf=function(e,t){if(e)throw new TypeError(`Not a valid NetCDF v3.x file: ${t}`)},qf.padding=$f,qf.readName=function(e){var t=e.readUint32(),i=e.readChars(t);return $f(e),i};var Yf={},Xf={exports:{}};const Jf=qf.notNetcdf,Zf={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function Qf(e,t){if(1!==e){for(var i=new Array(e),n=0;n<e;n++)i[n]=t();return i}return t()}Xf.exports=Zf,Xf.exports.num2str=function(e){switch(Number(e)){case Zf.BYTE:return"byte";case Zf.CHAR:return"char";case Zf.SHORT:return"short";case Zf.INT:return"int";case Zf.FLOAT:return"float";case Zf.DOUBLE:return"double";default:return"undefined"}},Xf.exports.num2bytes=function(e){switch(Number(e)){case Zf.BYTE:case Zf.CHAR:return 1;case Zf.SHORT:return 2;case Zf.INT:case Zf.FLOAT:return 4;case Zf.DOUBLE:return 8;default:return-1}},Xf.exports.str2num=function(e){switch(String(e)){case"byte":return Zf.BYTE;case"char":return Zf.CHAR;case"short":return Zf.SHORT;case"int":return Zf.INT;case"float":return Zf.FLOAT;case"double":return Zf.DOUBLE;default:return-1}},Xf.exports.readType=function(e,t,i){switch(t){case Zf.BYTE:return e.readBytes(i);case Zf.CHAR:return function(e){if(0===e.charCodeAt(e.length-1))return e.substring(0,e.length-1);return e}(e.readChars(i));case Zf.SHORT:return Qf(i,e.readInt16.bind(e));case Zf.INT:return Qf(i,e.readInt32.bind(e));case Zf.FLOAT:return Qf(i,e.readFloat32.bind(e));case Zf.DOUBLE:return Qf(i,e.readFloat64.bind(e));default:return void Jf(!0,`non valid type ${t}`)}};var Kf=Xf.exports;const eg=Kf;Yf.nonRecord=function(e,t){const i=eg.str2num(t.type);for(var n=t.size/eg.num2bytes(i),r=new Array(n),o=0;o<n;o++)r[o]=eg.readType(e,i,1);return r},Yf.record=function(e,t,i){const n=eg.str2num(t.type),r=t.size?t.size/eg.num2bytes(n):1;var o=i.length,s=new Array(o);const a=i.recordStep;for(var l=0;l<o;l++){var c=e.offset;s[l]=eg.readType(e,n,r),e.seek(c+a)}return s};const tg=qf,ig=Kf;function ng(e){const t=e.readUint32();if(0===t)return tg.notNetcdf(0!==e.readUint32(),"wrong empty tag for list of attributes"),[];{tg.notNetcdf(12!==t,"wrong tag for list of attributes");const l=e.readUint32();for(var i=new Array(l),n=0;n<l;n++){var r=tg.readName(e),o=e.readUint32();tg.notNetcdf(o<1||o>6,`non valid type ${o}`);var s=e.readUint32(),a=ig.readType(e,o,s);tg.padding(e),i[n]={name:r,type:ig.num2str(o),value:a}}}return i}var rg=function(e,t){var i={recordDimension:{length:e.readUint32()}};i.version=t;var n=function(e){var t,i;const n=e.readUint32();if(0===n)return tg.notNetcdf(0!==e.readUint32(),"wrong empty tag for list of dimensions"),[];{tg.notNetcdf(10!==n,"wrong tag for list of dimensions");const a=e.readUint32();for(var r=new Array(a),o=0;o<a;o++){var s=tg.readName(e);const n=e.readUint32();0===n&&(t=o,i=s),r[o]={name:s,size:n}}}return{dimensions:r,recordId:t,recordName:i}}(e);i.recordDimension.id=n.recordId,i.recordDimension.name=n.recordName,i.dimensions=n.dimensions,i.globalAttributes=ng(e);var r=function(e,t,i){const n=e.readUint32();var r=0;if(0===n)return tg.notNetcdf(0!==e.readUint32(),"wrong empty tag for list of variables"),[];{tg.notNetcdf(11!==n,"wrong tag for list of variables");const p=e.readUint32();for(var o=new Array(p),s=0;s<p;s++){var a=tg.readName(e);const n=e.readUint32();for(var l=new Array(n),c=0;c<n;c++)l[c]=e.readUint32();var u=ng(e),h=e.readUint32();tg.notNetcdf(h<1&&h>6,`non valid type ${h}`);const p=e.readUint32();var d=e.readUint32();2===i&&(tg.notNetcdf(d>0,"offsets larger than 4GB not supported"),d=e.readUint32());let m=!1;void 0!==t&&l[0]===t&&(r+=p,m=!0),o[s]={name:a,dimensions:l,attributes:u,type:ig.num2str(h),size:p,offset:d,record:m}}}return{variables:o,recordStep:r}}(e,n.recordId,t);return i.variables=r.variables,i.recordDimension.recordStep=r.recordStep,i};var og=function(){let e=[];e.push("DIMENSIONS");for(let t of this.dimensions)e.push(`  ${t.name.padEnd(30)} = size: ${t.size}`);e.push(""),e.push("GLOBAL ATTRIBUTES");for(let t of this.globalAttributes)e.push(`  ${t.name.padEnd(30)} = ${t.value}`);let t=JSON.parse(JSON.stringify(this.variables));e.push(""),e.push("VARIABLES:");for(let i of t){i.value=this.getDataVariable(i);let t=JSON.stringify(i.value);t.length>50&&(t=t.substring(0,50)),isNaN(i.value.length)||(t+=` (length: ${i.value.length})`),e.push(`  ${i.name.padEnd(30)} = ${t}`)}return e.join("\n")};const{IOBuffer:sg}=Vf,ag=qf,lg=Yf,cg=rg,ug=og;var hg=class{constructor(e){const t=new sg(e);t.setBigEndian(),ag.notNetcdf("CDF"!==t.readChars(3),"should start with CDF");const i=t.readByte();ag.notNetcdf(i>2,"unknown version"),this.header=cg(t,i),this.buffer=t}get version(){return 1===this.header.version?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(e){const t=this.globalAttributes.find((t=>t.name===e));return t?t.value:null}getDataVariableAsString(e){const t=this.getDataVariable(e);return t?t.join(""):null}get variables(){return this.header.variables}toString(){return ug.call(this)}getDataVariable(e){let t;return t="string"==typeof e?this.header.variables.find((function(t){return t.name===e})):e,ag.notNetcdf(void 0===t,`variable not found: ${e}`),this.buffer.seek(t.offset),t.record?lg.record(this.buffer,t,this.header.recordDimension):lg.nonRecord(this.buffer,t)}dataVariableExists(e){return void 0!==this.header.variables.find((function(t){return t.name===e}))}attributeExists(e){return void 0!==this.globalAttributes.find((t=>t.name===e))}},dg=Hf(hg);let pg;var mg={loadData:async function(e){var t;return await(t=e,new Promise((function(e){const i=new XMLHttpRequest;i.open("GET",t),i.responseType="arraybuffer",i.onload=function(){const t=function(e){return e.reduce((function(e,t){return e[t.name]=t,e}),{})},n=new dg(i.response);pg={};const r=t(n.dimensions);pg.dimensions={},pg.dimensions.lon=r.lon.size,pg.dimensions.lat=r.lat.size,pg.dimensions.lev=r.lev.size;const o=t(n.variables),s=t(o.U.attributes),a=t(o.V.attributes);pg.lon={},pg.lon.array=new Float32Array(n.getDataVariable("lon").flat()),pg.lon.min=Math.min(...pg.lon.array),pg.lon.max=Math.max(...pg.lon.array),pg.lat={},pg.lat.array=new Float32Array(n.getDataVariable("lat").flat()),pg.lat.min=Math.min(...pg.lat.array),pg.lat.max=Math.max(...pg.lat.array),pg.lev={},pg.lev.array=new Float32Array(n.getDataVariable("lev").flat()),pg.lev.min=Math.min(...pg.lev.array),pg.lev.max=Math.max(...pg.lev.array),pg.U={},pg.U.array=new Float32Array(n.getDataVariable("U").flat()),pg.U.min=s.min.value,pg.U.max=s.max.value,pg.V={},pg.V.array=new Float32Array(n.getDataVariable("V").flat()),pg.V.min=a.min.value,pg.V.max=a.max.value,e(pg)},i.send()}))),pg},randomizeParticles:function(e,t){const i=new Float32Array(4*e);for(let n=0;n<e;n++)i[4*n]=Cesium.Math.randomBetween(t.lonRange.x,t.lonRange.y),i[4*n+1]=Cesium.Math.randomBetween(t.latRange.x,t.latRange.y),i[4*n+2]=Cesium.Math.randomBetween(pg.lev.min,pg.lev.max),i[4*n+3]=0;return i}};var fg={loadText:function(e){const t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t.responseText},getFullscreenQuad:function(){return new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}),st:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array([0,0,1,0,1,1,0,1])})}),indices:new Uint32Array([3,2,0,0,2,1])})},createTexture:function(e,t){if(Cesium.defined(t)){const i={};i.arrayBufferView=t,e.source=i}return new Cesium.Texture(e)},createFramebuffer:function(e,t,i){return new Cesium.Framebuffer({context:e,colorTextures:[t],depthTexture:i})},createRawRenderState:function(e){const t={viewport:e.viewport,depthTest:e.depthTest,depthMask:e.depthMask,blending:e.blending};return Cesium.Appearance.getDefaultRenderState(!0,!1,t)},viewRectangleToLonLatRange:function(e){const t={},i=Cesium.Math.mod(e.west,Cesium.Math.TWO_PI),n=Cesium.Math.mod(e.east,Cesium.Math.TWO_PI),r=e.width;let o,s;r>Cesium.Math.THREE_PI_OVER_TWO?(o=0,s=Cesium.Math.TWO_PI):n-i<r?(o=i,s=i+r):(o=i,s=n),t.lon={min:Cesium.Math.toDegrees(o),max:Cesium.Math.toDegrees(s)};const a=e.south,l=e.north,c=e.height;let u=c>Cesium.Math.PI/12?c/2:0,h=Cesium.Math.clampToLatitudeRange(a-u),d=Cesium.Math.clampToLatitudeRange(l+u);return h<-Cesium.Math.PI_OVER_THREE&&(h=-Cesium.Math.PI_OVER_TWO),d>Cesium.Math.PI_OVER_THREE&&(d=Cesium.Math.PI_OVER_TWO),t.lat={min:Cesium.Math.toDegrees(h),max:Cesium.Math.toDegrees(d)},t},_shaderCalculateSpeedFrag:"\n// the size of UV textures: width = lon, height = lat*lev\nuniform sampler2D U; // eastward wind \nuniform sampler2D V; // northward wind\nuniform sampler2D currentParticlesPosition; // (lon, lat, lev)\n\nuniform vec3 dimension; // (lon, lat, lev)\nuniform vec3 minimum; // minimum of each dimension\nuniform vec3 maximum; // maximum of each dimension\nuniform vec3 interval; // interval of each dimension\n\n// used to calculate the wind norm\nuniform vec2 uSpeedRange; // (min, max);\nuniform vec2 vSpeedRange;\nuniform float pixelSize;\nuniform float speedFactor;\n\nfloat speedScaleFactor = speedFactor * pixelSize;\n\nvarying vec2 v_textureCoordinates;\n\nvec2 mapPositionToNormalizedIndex2D(vec3 lonLatLev) {\n    // ensure the range of longitude and latitude\n    lonLatLev.x = mod(lonLatLev.x, 360.0);\n    lonLatLev.y = clamp(lonLatLev.y, -90.0, 90.0);\n\n    vec3 index3D = vec3(0.0);\n    index3D.x = (lonLatLev.x - minimum.x) / interval.x;\n    index3D.y = (lonLatLev.y - minimum.y) / interval.y;\n    index3D.z = (lonLatLev.z - minimum.z) / interval.z;\n\n    // the st texture coordinate corresponding to (col, row) index\n    // example\n    // data array is [0, 1, 2, 3, 4, 5], width = 3, height = 2\n    // the content of texture will be\n    // t 1.0\n    //    |  3 4 5\n    //    |\n    //    |  0 1 2\n    //   0.0------1.0 s\n\n    vec2 index2D = vec2(index3D.x, index3D.z * dimension.y + index3D.y);\n    vec2 normalizedIndex2D = vec2(index2D.x / dimension.x, index2D.y / (dimension.y * dimension.z));\n    return normalizedIndex2D;\n}\n\nfloat getWindComponent(sampler2D componentTexture, vec3 lonLatLev) {\n    vec2 normalizedIndex2D = mapPositionToNormalizedIndex2D(lonLatLev);\n    float result = texture2D(componentTexture, normalizedIndex2D).r;\n    return result;\n}\n\nfloat interpolateTexture(sampler2D componentTexture, vec3 lonLatLev) {\n    float lon = lonLatLev.x;\n    float lat = lonLatLev.y;\n    float lev = lonLatLev.z;\n\n    float lon0 = floor(lon / interval.x) * interval.x;\n    float lon1 = lon0 + 1.0 * interval.x;\n    float lat0 = floor(lat / interval.y) * interval.y;\n    float lat1 = lat0 + 1.0 * interval.y;\n\n    float lon0_lat0 = getWindComponent(componentTexture, vec3(lon0, lat0, lev));\n    float lon1_lat0 = getWindComponent(componentTexture, vec3(lon1, lat0, lev));\n    float lon0_lat1 = getWindComponent(componentTexture, vec3(lon0, lat1, lev));\n    float lon1_lat1 = getWindComponent(componentTexture, vec3(lon1, lat1, lev));\n\n    float lon_lat0 = mix(lon0_lat0, lon1_lat0, lon - lon0);\n    float lon_lat1 = mix(lon0_lat1, lon1_lat1, lon - lon0);\n    float lon_lat = mix(lon_lat0, lon_lat1, lat - lat0);\n    return lon_lat;\n}\n\nvec3 linearInterpolation(vec3 lonLatLev) {\n    // https://en.wikipedia.org/wiki/Bilinear_interpolation\n    float u = interpolateTexture(U, lonLatLev);\n    float v = interpolateTexture(V, lonLatLev);\n    float w = 0.0;\n    return vec3(u, v, w);\n}\n\nvec2 lengthOfLonLat(vec3 lonLatLev) {\n    // unit conversion: meters -> longitude latitude degrees\n    // see https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree for detail\n\n    // Calculate the length of a degree of latitude and longitude in meters\n    float latitude = radians(lonLatLev.y);\n\n    float term1 = 111132.92;\n    float term2 = 559.82 * cos(2.0 * latitude);\n    float term3 = 1.175 * cos(4.0 * latitude);\n    float term4 = 0.0023 * cos(6.0 * latitude);\n    float latLength = term1 - term2 + term3 - term4;\n\n    float term5 = 111412.84 * cos(latitude);\n    float term6 = 93.5 * cos(3.0 * latitude);\n    float term7 = 0.118 * cos(5.0 * latitude);\n    float longLength = term5 - term6 + term7;\n\n    return vec2(longLength, latLength);\n}\n\nvec3 convertSpeedUnitToLonLat(vec3 lonLatLev, vec3 speed) {\n    vec2 lonLatLength = lengthOfLonLat(lonLatLev);\n    float u = speed.x / lonLatLength.x;\n    float v = speed.y / lonLatLength.y;\n    float w = 0.0;\n    vec3 windVectorInLonLatLev = vec3(u, v, w);\n\n    return windVectorInLonLatLev;\n}\n\nvec3 calculateSpeedByRungeKutta2(vec3 lonLatLev) {\n    // see https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Second-order_methods_with_two_stages for detail\n    const float h = 0.5;\n\n    vec3 y_n = lonLatLev;\n    vec3 f_n = linearInterpolation(lonLatLev);\n    vec3 midpoint = y_n + 0.5 * h * convertSpeedUnitToLonLat(y_n, f_n) * speedScaleFactor;\n    vec3 speed = h * linearInterpolation(midpoint) * speedScaleFactor;\n\n    return speed;\n}\n\nfloat calculateWindNorm(vec3 speed) {\n    vec3 percent = vec3(0.0);\n    percent.x = (speed.x - uSpeedRange.x) / (uSpeedRange.y - uSpeedRange.x);\n    percent.y = (speed.y - vSpeedRange.x) / (vSpeedRange.y - vSpeedRange.x);\n    float norm = length(percent);\n\n    return norm;\n}\n\nvoid main() {\n    // texture coordinate must be normalized\n    vec3 lonLatLev = texture2D(currentParticlesPosition, v_textureCoordinates).rgb;\n    vec3 speed = calculateSpeedByRungeKutta2(lonLatLev);\n    vec3 speedInLonLat = convertSpeedUnitToLonLat(lonLatLev, speed);\n\n    vec4 particleSpeed = vec4(speedInLonLat, calculateWindNorm(speed / speedScaleFactor));\n    gl_FragColor = particleSpeed;\n}\n",_shaderFullscreenVert:"attribute vec3 position;\nattribute vec2 st;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    textureCoordinate = st;\n    gl_Position = vec4(position, 1.0);\n}",_shaderPostProcessingPositionFrag:"uniform sampler2D nextParticlesPosition;\nuniform sampler2D particlesSpeed; // (u, v, w, norm)\n\n// range (min, max)\nuniform vec2 lonRange;\nuniform vec2 latRange;\n\nuniform float randomCoefficient; // use to improve the pseudo-random generator\nuniform float dropRate; // drop rate is a chance a particle will restart at random position to avoid degeneration\nuniform float dropRateBump;\n\nvarying vec2 v_textureCoordinates;\n\n// pseudo-random generator\nconst vec3 randomConstants = vec3(12.9898, 78.233, 4375.85453);\nconst vec2 normalRange = vec2(0.0, 1.0);\nfloat rand(vec2 seed, vec2 range) {\n    vec2 randomSeed = randomCoefficient * seed;\n    float temp = dot(randomConstants.xy, randomSeed);\n    temp = fract(sin(temp) * (randomConstants.z + temp));\n    return temp * (range.y - range.x) + range.x;\n}\n\nvec3 generateRandomParticle(vec2 seed, float lev) {\n    // ensure the longitude is in [0, 360]\n    float randomLon = mod(rand(seed, lonRange), 360.0);\n    float randomLat = rand(-seed, latRange);\n\n    return vec3(randomLon, randomLat, lev);\n}\n\nbool particleOutbound(vec3 particle) {\n    return particle.y < -90.0 || particle.y > 90.0;\n}\n\nvoid main() {\n    vec3 nextParticle = texture2D(nextParticlesPosition, v_textureCoordinates).rgb;\n    vec4 nextSpeed = texture2D(particlesSpeed, v_textureCoordinates);\n    float speedNorm = nextSpeed.a;\n    float particleDropRate = dropRate + dropRateBump * speedNorm;\n\n    vec2 seed1 = nextParticle.xy + v_textureCoordinates;\n    vec2 seed2 = nextSpeed.xy + v_textureCoordinates;\n    vec3 randomParticle = generateRandomParticle(seed1, nextParticle.z);\n    float randomNumber = rand(seed2, normalRange);\n\n    if (randomNumber < particleDropRate || particleOutbound(nextParticle)) {\n        gl_FragColor = vec4(randomParticle, 1.0); // 1.0 means this is a random particle\n    } else {\n        gl_FragColor = vec4(nextParticle, 0.0);\n    }\n}",_shaderScreenDrawFrag:"uniform sampler2D trailsColorTexture;\nuniform sampler2D trailsDepthTexture;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    vec4 trailsColor = texture2D(trailsColorTexture, textureCoordinate);\n    float trailsDepth = texture2D(trailsDepthTexture, textureCoordinate).r;\n    float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, textureCoordinate));\n\n    if (trailsDepth < globeDepth) {\n        gl_FragColor = trailsColor;\n    } else {\n        gl_FragColor = vec4(0.0);\n    }\n}",_shaderSegmentDragFrag:"\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}\n",_shaderSegmentDrawVert:"attribute vec2 st;\n// it is not normal itself, but used to control lines drawing\nattribute vec3 normal; // (point to use, offset sign, not used component)\n\nuniform sampler2D previousParticlesPosition;\nuniform sampler2D currentParticlesPosition;\nuniform sampler2D postProcessingPosition;\n\nuniform float particleHeight;\n\nuniform float aspect;\nuniform float pixelSize;\nuniform float lineWidth;\n\nstruct adjacentPoints {\n    vec4 previous;\n    vec4 current;\n    vec4 next;\n};\n\nvec3 convertCoordinate(vec3 lonLatLev) {\n    // WGS84 (lon, lat, lev) -> ECEF (x, y, z)\n    // read https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates for detail\n\n    // WGS 84 geometric constants \n    float a = 6378137.0; // Semi-major axis \n    float b = 6356752.3142; // Semi-minor axis \n    float e2 = 6.69437999014e-3; // First eccentricity squared\n\n    float latitude = radians(lonLatLev.y);\n    float longitude = radians(lonLatLev.x);\n\n    float cosLat = cos(latitude);\n    float sinLat = sin(latitude);\n    float cosLon = cos(longitude);\n    float sinLon = sin(longitude);\n\n    float N_Phi = a / sqrt(1.0 - e2 * sinLat * sinLat);\n    float h = particleHeight; // it should be high enough otherwise the particle may not pass the terrain depth test\n\n    vec3 cartesian = vec3(0.0);\n    cartesian.x = (N_Phi + h) * cosLat * cosLon;\n    cartesian.y = (N_Phi + h) * cosLat * sinLon;\n    cartesian.z = ((b * b) / (a * a) * N_Phi + h) * sinLat;\n    return cartesian;\n}\n\nvec4 calculateProjectedCoordinate(vec3 lonLatLev) {\n    // the range of longitude in Cesium is [-180, 180] but the range of longitude in the NetCDF file is [0, 360]\n    // [0, 180] is corresponding to [0, 180] and [180, 360] is corresponding to [-180, 0]\n    lonLatLev.x = mod(lonLatLev.x + 180.0, 360.0) - 180.0;\n    vec3 particlePosition = convertCoordinate(lonLatLev);\n    vec4 projectedCoordinate = czm_modelViewProjection * vec4(particlePosition, 1.0);\n    return projectedCoordinate;\n}\n\nvec4 calculateOffsetOnNormalDirection(vec4 pointA, vec4 pointB, float offsetSign) {\n    vec2 aspectVec2 = vec2(aspect, 1.0);\n    vec2 pointA_XY = (pointA.xy / pointA.w) * aspectVec2;\n    vec2 pointB_XY = (pointB.xy / pointB.w) * aspectVec2;\n\n    float offsetLength = lineWidth / 2.0;\n    vec2 direction = normalize(pointB_XY - pointA_XY);\n    vec2 normalVector = vec2(-direction.y, direction.x);\n    normalVector.x = normalVector.x / aspect;\n    normalVector = offsetLength * normalVector;\n\n    vec4 offset = vec4(offsetSign * normalVector, 0.0, 0.0);\n    return offset;\n}\n\nvec4 calculateOffsetOnMiterDirection(adjacentPoints projectedCoordinates, float offsetSign) {\n    vec2 aspectVec2 = vec2(aspect, 1.0);\n\n    vec4 PointA = projectedCoordinates.previous;\n    vec4 PointB = projectedCoordinates.current;\n    vec4 PointC = projectedCoordinates.next;\n\n    vec2 pointA_XY = (PointA.xy / PointA.w) * aspectVec2;\n    vec2 pointB_XY = (PointB.xy / PointB.w) * aspectVec2;\n    vec2 pointC_XY = (PointC.xy / PointC.w) * aspectVec2;\n\n    vec2 AB = normalize(pointB_XY - pointA_XY);\n    vec2 BC = normalize(pointC_XY - pointB_XY);\n\n    vec2 normalA = vec2(-AB.y, AB.x);\n    vec2 tangent = normalize(AB + BC);\n    vec2 miter = vec2(-tangent.y, tangent.x);\n\n    float offsetLength = lineWidth / 2.0;\n    float projection = dot(miter, normalA);\n    vec4 offset = vec4(0.0);\n    // avoid to use values that are too small\n    if (projection > 0.1) {\n        float miterLength = offsetLength / projection;\n        offset = vec4(offsetSign * miter * miterLength, 0.0, 0.0);\n        offset.x = offset.x / aspect;\n    } else {\n        offset = calculateOffsetOnNormalDirection(PointB, PointC, offsetSign);\n    }\n\n    return offset;\n}\n\nvoid main() {\n    vec2 particleIndex = st;\n\n    vec3 previousPosition = texture2D(previousParticlesPosition, particleIndex).rgb;\n    vec3 currentPosition = texture2D(currentParticlesPosition, particleIndex).rgb;\n    vec3 nextPosition = texture2D(postProcessingPosition, particleIndex).rgb;\n\n    float isAnyRandomPointUsed = texture2D(postProcessingPosition, particleIndex).a +\n        texture2D(currentParticlesPosition, particleIndex).a +\n        texture2D(previousParticlesPosition, particleIndex).a;\n\n    adjacentPoints projectedCoordinates;\n    if (isAnyRandomPointUsed > 0.0) {\n        projectedCoordinates.previous = calculateProjectedCoordinate(previousPosition);\n        projectedCoordinates.current = projectedCoordinates.previous;\n        projectedCoordinates.next = projectedCoordinates.previous;\n    } else {\n        projectedCoordinates.previous = calculateProjectedCoordinate(previousPosition);\n        projectedCoordinates.current = calculateProjectedCoordinate(currentPosition);\n        projectedCoordinates.next = calculateProjectedCoordinate(nextPosition);\n    }\n\n    int pointToUse = int(normal.x);\n    float offsetSign = normal.y;\n    vec4 offset = vec4(0.0);\n    // render lines with triangles and miter joint\n    // read https://blog.scottlogic.com/2019/11/18/drawing-lines-with-webgl.html for detail\n    if (pointToUse == -1) {\n        offset = pixelSize * calculateOffsetOnNormalDirection(projectedCoordinates.previous, projectedCoordinates.current, offsetSign);\n        gl_Position = projectedCoordinates.previous + offset;\n    } else {\n        if (pointToUse == 0) {\n            offset = pixelSize * calculateOffsetOnMiterDirection(projectedCoordinates, offsetSign);\n            gl_Position = projectedCoordinates.current + offset;\n        } else {\n            if (pointToUse == 1) {\n                offset = pixelSize * calculateOffsetOnNormalDirection(projectedCoordinates.current, projectedCoordinates.next, offsetSign);\n                gl_Position = projectedCoordinates.next + offset;\n            } else {\n\n            }\n        }\n    }\n}",_shaderTrailDrawFrag:"uniform sampler2D segmentsColorTexture;\nuniform sampler2D segmentsDepthTexture;\n\nuniform sampler2D currentTrailsColor;\nuniform sampler2D trailsDepthTexture;\n\nuniform float fadeOpacity;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    vec4 pointsColor = texture2D(segmentsColorTexture, textureCoordinate);\n    vec4 trailsColor = texture2D(currentTrailsColor, textureCoordinate);\n\n    trailsColor = floor(fadeOpacity * 255.0 * trailsColor) / 255.0; // make sure the trailsColor will be strictly decreased\n\n    float pointsDepth = texture2D(segmentsDepthTexture, textureCoordinate).r;\n    float trailsDepth = texture2D(trailsDepthTexture, textureCoordinate).r;\n    float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, textureCoordinate));\n\n    gl_FragColor = vec4(0.0);\n    if (pointsDepth < globeDepth) {\n        gl_FragColor = gl_FragColor + pointsColor;\n    }\n    if (trailsDepth < globeDepth) {\n        gl_FragColor = gl_FragColor + trailsColor;\n    }\n    gl_FragDepthEXT = min(pointsDepth, trailsDepth);\n}",_shaderUpdatePosition:"uniform sampler2D currentParticlesPosition; // (lon, lat, lev)\nuniform sampler2D particlesSpeed; // (u, v, w, norm) Unit converted to degrees of longitude and latitude \n\nvarying vec2 v_textureCoordinates;\n\nvoid main() {\n    // texture coordinate must be normalized\n    vec3 lonLatLev = texture2D(currentParticlesPosition, v_textureCoordinates).rgb;\n    vec3 speed = texture2D(particlesSpeed, v_textureCoordinates).rgb;\n    vec3 nextParticle = lonLatLev + speed;\n\n    gl_FragColor = vec4(nextParticle, 0.0);\n}"};class gg{constructor(e,t,i,n){this.createWindTextures(e,t),this.createParticlesTextures(e,i,n),this.createComputingPrimitives(t,i,n)}createWindTextures(e,t){const i={context:e,width:t.dimensions.lon,height:t.dimensions.lat*t.dimensions.lev,pixelFormat:Cesium.PixelFormat.LUMINANCE,pixelDatatype:Cesium.PixelDatatype.FLOAT,flipY:!1,sampler:new Cesium.Sampler({minificationFilter:Cesium.TextureMinificationFilter.NEAREST,magnificationFilter:Cesium.TextureMagnificationFilter.NEAREST})};this.windTextures={U:fg.createTexture(i,t.U.array),V:fg.createTexture(i,t.V.array)}}createParticlesTextures(e,t,i){const n={context:e,width:t.particlesTextureSize,height:t.particlesTextureSize,pixelFormat:Cesium.PixelFormat.RGBA,pixelDatatype:Cesium.PixelDatatype.FLOAT,flipY:!1,sampler:new Cesium.Sampler({minificationFilter:Cesium.TextureMinificationFilter.NEAREST,magnificationFilter:Cesium.TextureMagnificationFilter.NEAREST})},r=mg.randomizeParticles(t.maxParticles,i),o=new Float32Array(4*t.maxParticles).fill(0);this.particlesTextures={previousParticlesPosition:fg.createTexture(n,r),currentParticlesPosition:fg.createTexture(n,r),nextParticlesPosition:fg.createTexture(n,r),postProcessingPosition:fg.createTexture(n,r),particlesSpeed:fg.createTexture(n,o)}}destroyParticlesTextures(){Object.keys(this.particlesTextures).forEach((e=>{this.particlesTextures[e].destroy()}))}createComputingPrimitives(e,t,i){const n=new Cesium.Cartesian3(e.dimensions.lon,e.dimensions.lat,e.dimensions.lev),r=new Cesium.Cartesian3(e.lon.min,e.lat.min,e.lev.min),o=new Cesium.Cartesian3(e.lon.max,e.lat.max,e.lev.max),s=new Cesium.Cartesian3((o.x-r.x)/(n.x-1),(o.y-r.y)/(n.y-1),n.z>1?(o.z-r.z)/(n.z-1):1),a=new Cesium.Cartesian2(e.U.min,e.U.max),l=new Cesium.Cartesian2(e.V.min,e.V.max),c=this;this.primitives={calculateSpeed:new Gf({commandType:"Compute",uniformMap:{U:function(){return c.windTextures.U},V:function(){return c.windTextures.V},currentParticlesPosition:function(){return c.particlesTextures.currentParticlesPosition},dimension:function(){return n},minimum:function(){return r},maximum:function(){return o},interval:function(){return s},uSpeedRange:function(){return a},vSpeedRange:function(){return l},pixelSize:function(){return i.pixelSize},speedFactor:function(){return t.speedFactor}},fragmentShaderSource:new Cesium.ShaderSource({sources:[fg._shaderCalculateSpeedFrag]}),outputTexture:this.particlesTextures.particlesSpeed,preExecute:function(){let e;e=c.particlesTextures.previousParticlesPosition,c.particlesTextures.previousParticlesPosition=c.particlesTextures.currentParticlesPosition,c.particlesTextures.currentParticlesPosition=c.particlesTextures.postProcessingPosition,c.particlesTextures.postProcessingPosition=e,c.primitives.calculateSpeed.commandToExecute.outputTexture=c.particlesTextures.particlesSpeed}}),updatePosition:new Gf({commandType:"Compute",uniformMap:{currentParticlesPosition:function(){return c.particlesTextures.currentParticlesPosition},particlesSpeed:function(){return c.particlesTextures.particlesSpeed}},fragmentShaderSource:new Cesium.ShaderSource({sources:[fg._shaderUpdatePosition]}),outputTexture:this.particlesTextures.nextParticlesPosition,preExecute:function(){c.primitives.updatePosition.commandToExecute.outputTexture=c.particlesTextures.nextParticlesPosition}}),postProcessingPosition:new Gf({commandType:"Compute",uniformMap:{nextParticlesPosition:function(){return c.particlesTextures.nextParticlesPosition},particlesSpeed:function(){return c.particlesTextures.particlesSpeed},lonRange:function(){return i.lonRange},latRange:function(){return i.latRange},randomCoefficient:function(){return Math.random()},dropRate:function(){return t.dropRate},dropRateBump:function(){return t.dropRateBump}},fragmentShaderSource:new Cesium.ShaderSource({sources:[fg._shaderPostProcessingPositionFrag]}),outputTexture:this.particlesTextures.postProcessingPosition,preExecute:function(){c.primitives.postProcessingPosition.commandToExecute.outputTexture=c.particlesTextures.postProcessingPosition}})}}}class _g{constructor(e,t,i,n,r){this.createRenderingTextures(e,t),this.createRenderingFramebuffers(e),this.createRenderingPrimitives(e,i,n,r)}createRenderingTextures(e,t){const i={context:e,width:e.drawingBufferWidth,height:e.drawingBufferHeight,pixelFormat:Cesium.PixelFormat.RGBA,pixelDatatype:Cesium.PixelDatatype.UNSIGNED_BYTE},n={context:e,width:e.drawingBufferWidth,height:e.drawingBufferHeight,pixelFormat:Cesium.PixelFormat.DEPTH_COMPONENT,pixelDatatype:Cesium.PixelDatatype.UNSIGNED_INT};this.textures={segmentsColor:fg.createTexture(i),segmentsDepth:fg.createTexture(n),currentTrailsColor:fg.createTexture(i),currentTrailsDepth:fg.createTexture(n),nextTrailsColor:fg.createTexture(i),nextTrailsDepth:fg.createTexture(n)}}createRenderingFramebuffers(e){this.framebuffers={segments:fg.createFramebuffer(e,this.textures.segmentsColor,this.textures.segmentsDepth),currentTrails:fg.createFramebuffer(e,this.textures.currentTrailsColor,this.textures.currentTrailsDepth),nextTrails:fg.createFramebuffer(e,this.textures.nextTrailsColor,this.textures.nextTrailsDepth)}}createSegmentsGeometry(e){let t=[];for(let i=0;i<e.particlesTextureSize;i++)for(let n=0;n<e.particlesTextureSize;n++)for(let r=0;r<6;r++)t.push(i/e.particlesTextureSize),t.push(n/e.particlesTextureSize);t=new Float32Array(t);let i=[];const n=[-1,0,1],r=[-1,1];for(let t=0;t<e.maxParticles;t++)for(let e=0;e<n.length;e++)for(let t=0;t<r.length;t++)i.push(n[e]),i.push(r[t]),i.push(0);i=new Float32Array(i);const o=12*e.maxParticles;let s=new Uint32Array(o);for(let t=0,i=0,n=0;t<e.maxParticles;t++)s[i++]=n+0,s[i++]=n+1,s[i++]=n+2,s[i++]=n+2,s[i++]=n+1,s[i++]=n+3,s[i++]=n+2,s[i++]=n+4,s[i++]=n+3,s[i++]=n+4,s[i++]=n+3,s[i++]=n+5,n+=6;return new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({st:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:t}),normal:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:i})}),indices:s})}createRenderingPrimitives(e,t,i,n){const r=this;this.primitives={segments:new Gf({commandType:"Draw",attributeLocations:{st:0,normal:1},geometry:this.createSegmentsGeometry(t),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{previousParticlesPosition:function(){return n.particlesTextures.previousParticlesPosition},currentParticlesPosition:function(){return n.particlesTextures.currentParticlesPosition},postProcessingPosition:function(){return n.particlesTextures.postProcessingPosition},aspect:function(){return e.drawingBufferWidth/e.drawingBufferHeight},pixelSize:function(){return i.pixelSize},lineWidth:function(){return t.lineWidth},particleHeight:function(){return t.particleHeight},color:function(){return t.color}},vertexShaderSource:new Cesium.ShaderSource({sources:[fg._shaderSegmentDrawVert]}),fragmentShaderSource:new Cesium.ShaderSource({sources:[fg._shaderSegmentDragFrag]}),rawRenderState:fg.createRawRenderState({viewport:void 0,depthTest:{enabled:!0},depthMask:!0}),framebuffer:this.framebuffers.segments,autoClear:!0}),trails:new Gf({commandType:"Draw",attributeLocations:{position:0,st:1},geometry:fg.getFullscreenQuad(),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{segmentsColorTexture:function(){return r.textures.segmentsColor},segmentsDepthTexture:function(){return r.textures.segmentsDepth},currentTrailsColor:function(){return r.framebuffers.currentTrails.getColorTexture(0)},trailsDepthTexture:function(){return r.framebuffers.currentTrails.depthTexture},fadeOpacity:function(){return t.fadeOpacity}},vertexShaderSource:new Cesium.ShaderSource({defines:["DISABLE_GL_POSITION_LOG_DEPTH"],sources:[fg._shaderFullscreenVert]}),fragmentShaderSource:new Cesium.ShaderSource({defines:["DISABLE_LOG_DEPTH_FRAGMENT_WRITE"],sources:[fg._shaderTrailDrawFrag]}),rawRenderState:fg.createRawRenderState({viewport:void 0,depthTest:{enabled:!0,func:Cesium.DepthFunction.ALWAYS},depthMask:!0}),framebuffer:this.framebuffers.nextTrails,autoClear:!0,preExecute:function(){let e;e=r.framebuffers.currentTrails,r.framebuffers.currentTrails=r.framebuffers.nextTrails,r.framebuffers.nextTrails=e,r.primitives.trails.commandToExecute.framebuffer=r.framebuffers.nextTrails,r.primitives.trails.clearCommand.framebuffer=r.framebuffers.nextTrails}}),screen:new Gf({commandType:"Draw",attributeLocations:{position:0,st:1},geometry:fg.getFullscreenQuad(),primitiveType:Cesium.PrimitiveType.TRIANGLES,uniformMap:{trailsColorTexture:function(){return r.framebuffers.nextTrails.getColorTexture(0)},trailsDepthTexture:function(){return r.framebuffers.nextTrails.depthTexture}},vertexShaderSource:new Cesium.ShaderSource({defines:["DISABLE_GL_POSITION_LOG_DEPTH"],sources:[fg._shaderFullscreenVert]}),fragmentShaderSource:new Cesium.ShaderSource({defines:["DISABLE_LOG_DEPTH_FRAGMENT_WRITE"],sources:[fg._shaderScreenDrawFrag]}),rawRenderState:fg.createRawRenderState({viewport:void 0,depthTest:{enabled:!1},depthMask:!0,blending:{enabled:!0}}),framebuffer:void 0})}}}class yg{constructor(e,t,i,n){this.context=e,this.data=t,this.userInput=i,this.viewerParameters=n,this.particlesComputing=new gg(this.context,this.data,this.userInput,this.viewerParameters),this.particlesRendering=new _g(this.context,this.data,this.userInput,this.viewerParameters,this.particlesComputing)}canvasResize(e){this.particlesComputing.destroyParticlesTextures(),Object.keys(this.particlesComputing.windTextures).forEach((e=>{this.particlesComputing.windTextures[e].destroy()})),Object.keys(this.particlesRendering.framebuffers).forEach((e=>{this.particlesRendering.framebuffers[e].destroy()})),this.context=e,this.particlesComputing=new gg(this.context,this.data,this.userInput,this.viewerParameters),this.particlesRendering=new _g(this.context,this.data,this.userInput,this.viewerParameters,this.particlesComputing)}clearFramebuffers(){const e=new Cesium.ClearCommand({color:new Cesium.Color(0,0,0,0),depth:1,framebuffer:void 0,pass:Cesium.Pass.OPAQUE});Object.keys(this.particlesRendering.framebuffers).forEach((t=>{e.framebuffer=this.particlesRendering.framebuffers[t],e.execute(this.context)}))}refreshParticles(e){if(this.clearFramebuffers(),this.particlesComputing.destroyParticlesTextures(),this.particlesComputing.createParticlesTextures(this.context,this.userInput,this.viewerParameters),e){const e=this.particlesRendering.createSegmentsGeometry(this.userInput);this.particlesRendering.primitives.segments.geometry=e;const t=Cesium.VertexArray.fromGeometry({context:this.context,geometry:e,attributeLocations:this.particlesRendering.primitives.segments.attributeLocations,bufferUsage:Cesium.BufferUsage.STATIC_DRAW});this.particlesRendering.primitives.segments.commandToExecute.vertexArray=t}}applyUserInput(e){let t=!1;this.userInput.maxParticles!=e.maxParticles&&(t=!0),Object.keys(e).forEach((t=>{this.userInput[t]=e[t]})),this.refreshParticles(t)}applyViewerParameters(e){Object.keys(e).forEach((t=>{this.viewerParameters[t]=e[t]})),this.refreshParticles(!1)}}const{Cartesian2:vg,Cartesian3:Cg,BoundingSphere:xg,PrimitiveCollection:wg,Color:bg}=Cesium;const Sg="\nvec4 czm_p_toEye(vec2 uv,float depth){\n  vec4 eyeCoordinate = czm_windowToEyeCoordinates(uv, depth);\n  return eyeCoordinate/eyeCoordinate.w;\n}\nvec4 czm_p_toEye(in vec2 uv, in sampler2D depthTexture){\n    float depth=czm_p_getDepth(texture2D(depthTexture, uv));\n    vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n    vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n    posInCamera =posInCamera / posInCamera.w;\n    return posInCamera;\n}\n",Tg="\nfloat czm_p_getDepth(in vec4 depth){\n  float z_window = czm_unpackDepth(depth);\n  z_window = czm_reverseLogDepth(z_window);\n  float n_range = czm_depthRange.near;\n  float f_range = czm_depthRange.far;\n  return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}";var Ag="struct czm_ellipsoid\n{\n    vec3 center;\n    vec3 radii;\n    vec3 inverseRadii;\n    vec3 inverseRadiiSquared;\n};";const Eg="czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\n    vec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\n    vec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\n    vec3 inverseRadiiSquared = inverseRadii * inverseRadii;\n    czm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\n    return temp;\n}",Pg="vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\n    // Diffuse from directional light sources at eye (for top-down and horizon views)\n    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\n\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n    }\n\n    diffuse = clamp(diffuse, 0.0, 1.0);\n\n    // Specular from sun and pseudo-moon\n    float specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\n    specular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n/**\n * @private\n */\nvec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    // Diffuse from directional light sources at eye (for top-down and horizon views)\n    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\n\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n    }\n\n    diffuse = clamp(diffuse, 0.0, 1.0);\n\n    float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n\n",Lg="\n//low version cesium.\nfloat czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\n    return czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\n\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\n    return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\n\n/**\n * Computes a color using the Phong lighting model.\n *\n * @name czm_phong\n * @glslFunction\n *\n * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.\n * @param {czm_material} material The fragment's material.\n *\n * @returns {vec4} The computed color.\n *\n * @example\n * vec3 positionToEyeEC = // ...\n * czm_material material = // ...\n * gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n *\n * @see czm_getMaterial\n */\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\n    // Diffuse from directional light sources at eye (for top-down)\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n    }\n\n    // Specular from sun and pseudo-moon\n    float specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse;\n    color += material.specular * specular;\n\n#ifdef HDR\n    float sunDiffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\n    color += materialDiffuse * sunDiffuse * czm_sunColor;\n#endif\n\n    return vec4(color, material.alpha);\n}\n\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\n    float specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\n\n    vec3 ambient = vec3(0.0);\n    vec3 color = ambient + material.emission;\n    color += material.diffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n//high version Cesium\n\n/**\n * Computes a color using the Phong lighting model.\n *\n * @name czm_phong\n * @glslFunction\n *\n * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.\n * @param {czm_material} material The fragment's material.\n *\n * @returns {vec4} The computed color.\n *\n * @example\n * vec3 positionToEyeEC = // ...\n * czm_material material = // ...\n * vec3 lightDirectionEC = // ...\n * gl_FragColor = czm_phong(normalize(positionToEyeEC), material, lightDirectionEC);\n *\n * @see czm_getMaterial\n */\nvec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    // Diffuse from directional light sources at eye (for top-down)\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n    }\n\n    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n\nvec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);\n    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);\n\n    vec3 ambient = vec3(0.0);\n    vec3 color = ambient + material.emission;\n    color += material.diffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n",Dg={czm_p_toEye:Sg,czm_p_getDepth:Tg,czm_ellipsoid:Ag,czm_getWgs84EllipsoidEC:Eg,czm_translucentPhong:Pg,czm_phong:Lg};function Mg(){for(var e in Dg)Dg.hasOwnProperty(e)&&(Cesium.ShaderSource._czmBuiltinsAndUniforms[e]=Dg[e])}Mg();e.ArrowPlot=Qd,e.AxisPlane=v,e.BaiDuLayer=class extends Lo{constructor(e){(e=C(e,{})).url=C(e.url,"http://maponline{s}.bdimg.com/tile/?qt=vtile&styles=pl&scaler=1&udt=20200102"),e.customid&&(e.url=`https://api.map.baidu.com/customimage/tile?customid=${e.customid}`);const t=new Cesium.Cartesian2(-ed,-Kh),i=new Cesium.Cartesian2(ed,Kh);e.tilingScheme=new Cesium.WebMercatorTilingScheme({rectangleSouthwestInMeters:t,rectangleNortheastInMeters:i}),e.subdomains="123",super(e)}get rectangle(){return this.tilingScheme.rectangle}requestImage(e,t,i){const n=function(e,t,i,n){let r=e.url+"&x={x}&y={y}&z={z}";const o=e._tilingScheme.getNumberOfXTilesAtLevel(n),s=e._tilingScheme.getNumberOfYTilesAtLevel(n),a=4*Math.random()|0;return r=r.replace("{s}",a).replace("{x}",t-o/2).replace("{y}",s/2-i-1).replace("{z}",n),r}(this,e,t,i);return Cesium.ImageryProvider.loadImage(this,n)}},e.BasePlot=md,e.BingLayer=nd,e.Cartometry=L,e.CartometryManager=class{constructor(e,t={}){const{labelStyle:i,polylineStyle:n,polygonStyle:r,pointStyle:o}=t;he(e),this._viewer=e;const s=$d.defaultLabelStyle;s.disableDepthTestDistance=Number.POSITIVE_INFINITY,this._labelStyle=C(i,s),this._polylineStyle=C(n,Yd.defaultStyle),this._polygonStyle=C(r,Xd.defaultStyle),this._pointStyle=C(o,$d.defaultStyle),this._startMeasure=new I,this._stopMeasure=new I,this._addNode=new I,this.formatText=C(t.formatText,Jd);this._nodeMode=C(t.nodeMode,{distance:!0,area:!1,height:!1,angle:!1}),this._auxiliaryGeometry=C(t.auxiliaryGeometry,{distance:!0,area:!1,height:!0,angle:!0});const a=new Cesium.ScreenSpaceEventHandler(e.canvas);this._handler=a,this._values=[],this._mode=C(t.mode,M.SURFACE_DISTANCE),this._tip=new kn,this._tip.show=!1,this._autoDepthTest=C(t.autoDepthTest,!0),this.listening=!1;const l=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.RED});this._auxiliarylineMaterial=C(t.auxiliaryLineMaterial,l);const c=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.RED});this._depthTestAgainstTerrain=this._viewer.scene.globe.depthTestAgainstTerrain,this._auxiliaryPolygonMaterial=C(t.auxiliaryPolygonMaterial,c)}get viewer(){return this.viewer}get labelStyle(){return this._labelStyle}set labelStyle(e){this._labelStyle=e}get polylineStyle(){return this._polylineStyle}set polylineStyle(e){this._polylineStyle=e}get polygonStyle(){return this._polygonStyle}set polygonStyle(e){this._polygonStyle=e}get pointStyle(){return this._pointStyle}set pointStyle(e){this._pointStyle=e}get startMeasure(){return this._startMeasure}get stopMeasure(){return this._stopMeasure}get addNode(){return this._addNode}get tip(){return this._tip}get mode(){return this._mode}set mode(e){M.validate(e)?this._mode=e:console.warn("CartometryManaer:无效的测量模式")}addEventListener(e,t=[]){this._listening=!0;const i=M.getKey(e),n=/.*_?(distance|area|height|angle)$/.exec(i.toLowerCase());let r=!1,o=!1;n&&n[1]&&(r=this._nodeMode[n[1]],o=this._auxiliaryGeometry[n[1]]);const s=this._handler;s.setInputAction((i=>{const n=this.pickPosition(i.position);if(n&&t.push(n),r&&this.createNode(n),o&&this.createAuxiliaryGraphic(t,n,e),this.addNode.raise(n),(e===M.HEIGHT||e===M.ANGLE)&&(1===t.length&&(this.tip.text="单击地图确定终点."),2===t.length)){this.removeEventListener();let i,n=t[0];if(e===M.HEIGHT){i=this.getHeight(t);const e=w.fromCartesian(t[0]),r=w.fromCartesian(t[1]),o=e.alt<r.alt?e:r;n=Cesium.Cartesian3.fromDegrees(o.lon,o.lat,(r.alt+e.alt)/2)}else i=this.getAngle(t);this.createLabel(n,i)}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction((i=>{if(this.tip.position=i.endPosition,e===M.HEIGHT||e===M.ANGLE)return;const n=this.pickPosition(i.endPosition);t.length>1&&n&&t.pop(),t.length>0&&n&&t.push(n)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),s.setInputAction((i=>{const n=this.pickPosition(i.position);if(n){if(r&&this.createNode(n),e===M.HEIGHT&&e===M.ANGLE||(t.pop(),t.length&&n&&t.push(n),this.removeEventListener(),this.addNode.raise(n)),e===M.SURFACE_DISTANCE||e===M.SPACE_DISTANCE){const i=this.getDistance(t,e);this.createLabel(n,i)}if(e===M.SURFACE_AREA||e===M.SPACE_AREA){const i=this.getArea(t,e);this.createLabel(n,i)}this.stopMeasure.raise()}}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)}removeEventListener(){const e=this._handler;e.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),e.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),e.removeInputAction(Cesium.ScreenSpaceEventType.RIGHT_CLICK),this._listening=!1,this.tip.show=!1,this._autoDepthTest&&(this._viewer.depthTest=this._depthTestAgainstTerrain)}clear(){const e=this._values;for(const t of e)this._viewer.entities.remove(t);this._values=[]}destroy(){this.clear(),this.removeEventListener(),this._handler.isDestroyed()||this._handler.destroy(),this._viewer=undefinesd}getDistance(e,t){if(e.length<2||!e[0]||!e[1])return"起点";let i;return t===M.SURFACE_DISTANCE?i=L.surfaceDistance(e):t===M.SPACE_DISTANCE&&(i=L.spaceDistance(e)),this.formatText(i,t,!this._listening)}getArea(e,t){let i;return i=t===M.SURFACE_AREA?L.surfaceArea(e):L.spaceArea(e),this.formatText(i,t,!this._listening)}getHeight(e){const t=L.heightFromCartesianArray(e);return this.formatText(Math.abs(t[0]),M.HEIGHT)}getAngle(e,t){const i=L.angleBetweenNorth(e[0],e[1]);return this.formatText(i,M.ANGLE)}do(e,t=[]){this._depthTestAgainstTerrain||(this._autoDepthTest?this._viewer.depthTest=!0:console.warn("depthTestAgainstTerrain未开启,点位获取可能不准确.")),this.tip.show=!0,e=C(e,this.mode);if(!M.validate(e))return void console.warn("无效的测量模式");let i;e===M.HEIGHT||e===M.ANGLE?this.tip.text="单击地图确定起点.":this.tip.text="单击地图添加节点，右击地图结束量算",this.startMeasure.raise(e),e===M.SPACE_DISTANCE||e===M.HEIGHT?(i=this.polylineStyle,i.clampToGround=!1,i.positions=new Cesium.CallbackProperty((()=>t),!1),this.createPolyline(i)):e===M.SURFACE_DISTANCE||e===M.ANGLE?(i=this.polylineStyle,i.clampToGround=!0,i.positions=new Cesium.CallbackProperty((()=>t),!1),this.createPolyline(i)):e===M.SPACE_AREA?(i=this.polygonStyle,i.outline=!1,i.perPositionHeight=!0,i.heightReference=Cesium.HeightReference.NONE,i.hierarchy=new Cesium.CallbackProperty((()=>new Cesium.PolygonHierarchy(t)),!1),this.createPolygon(i)):e===M.SURFACE_AREA&&(i=this.polygonStyle,i.perPositionHeight=!1,i.heightReference=Cesium.HeightReference.CLAMP_TO_GROUND,i.hierarchy=new Cesium.CallbackProperty((()=>new Cesium.PolygonHierarchy(t)),!1),this.createPolygon(i)),this.addEventListener(e,t)}surfaceDistance(){this.do(M.SURFACE_DISTANCE)}spaceDistance(){this.do(M.SPACE_DISTANCE)}surfaceArea(){this.do(M.SURFACE_AREA)}spaceArea(){this.do(M.SPACE_AREA)}height(){this.do(M.HEIGHT)}angle(){this.do(M.ANGLE)}pickPosition(e){const t=this._viewer;let i;const n=t.camera.getPickRay(e);i=t.scene.globe.pick(n,t.scene);return t.scene.pick(e)&&(t.scene.pickPositionSupported?i=t.scene.pickPosition(e):console.warn("This browser does not support pickPosition.")),i}createNode(e){if(!e)return;const t=this.pointStyle,i=this._viewer.entities.add({position:e,point:t});return this._values.push(i),i}createLabel(e,t){const i=this.labelStyle;i.text=t;const n=w.fromCartesian(e);i.pixelOffset=new Cesium.Cartesian3(0,0,n.height>0?-n.height:0);const r=this._viewer.entities.add({position:e,label:i});return this._values.push(r),r}createPolygon(e){const t=this._viewer.entities.add({polygon:e});return this._values.push(t),t}createPolyline(e){const t=this._viewer.entities.add({polyline:e});return this._values.push(t),t}_createAuxiliaryGraphicforHeight(e){if(2!==e.length)return;const t=w.fromCartesian(e[0]),i=w.fromCartesian(e[1]);let n,r;t.alt<i.alt?(n=t,r=i):(n=i,r=t);const o=new w(n.lon,n.lat,r.alt),s=[e[0],o.toCartesian(),e[1]],a=this._viewer.entities.add({polyline:{positions:s,material:this._auxiliarylineMaterial,width:this.polylineStyle.width||3}});this._values.push(a)}_createAuxiliaryGraphicforDisgance(e,t){this.createLabel(e,t)}_createAuxiliaryGraphicforAngle(e){if(2!==e.length)return;const t=L.spaceDistance(e),i=new Cesium.Transforms.eastNorthUpToFixedFrame(e[0]),n=new Cesium.Matrix4;Cesium.Matrix4.inverseTransformation(i,n);const r=Cesium.Matrix4.multiplyByPoint(i,new Cesium.Cartesian3(0,t,0),new Cesium.Cartesian3),o={polyline:{positions:[e[0],r],material:this._auxiliarylineMaterial,width:this.polylineStyle.width||3,clampToGround:!0}},s=this._viewer.entities.add(o);this._values.push(s)}createAuxiliaryGraphic(e,t,i){if(i===M.SPACE_DISTANCE||i===M.SURFACE_DISTANCE){const{length:n}=e,r=this.getDistance([e[n-3],e[n-2]],i);this._createAuxiliaryGraphicforDisgance(t,r)}else i===M.HEIGHT?this._createAuxiliaryGraphicforHeight(e):i===M.ANGLE&&this._createAuxiliaryGraphicforAngle(e)}callback(e,t,i){}},e.CartometryType=M,e.CesiumProError=t,e.CesiumProTerrainProvider=ne,e.CircleScanGraphic=class extends Hu{constructor(e){super(e),this._speed=C(e.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(e){this._speed!==e&&(e<=0&&(this._speed=0),this.definedChanged.raise("speed",e,this._speed),this._speed=e)}createAppearance(){return this._appearance||(this._appearance=new Uu({material:new ju({translucent:!0,fabric:{uniforms:{image:we.buildModuleUrl("./assets/images/radarScan.png"),stRotation:Cesium.Matrix2.IDENTITY,color:this._color,time:0},source:Wu}})})),this._appearance}update(e){if(!this.material)return;if(0===this.speed)return void(this.material.uniforms.time=0);const t=Cesium.JulianDate.toDate(e).getTime()*this.speed,i=t%360,n=Cesium.Matrix2.fromRotation(Cesium.Math.toRadians(-i));this.material.uniforms.stRotation={x:n[0],y:n[1],z:n[2],w:n[3]},this.material.uniforms.time=t-parseInt(t)}},e.CircleSpreadGraphic=class extends Hu{constructor(e){super(e),this._speed=C(e.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(e){e!==this._speed&&(e<0&&(e=0),this.definedChanged.raise("speed",e,this._speed),this._speed=e)}createAppearance(){return this._appearance||(this._appearance=new qu({material:new $u({translucent:!0,fabric:{uniforms:{color:this._color,time:0},source:Vu}})})),this._appearance}update(e){if(!this.material)return;const t=Cesium.JulianDate.toDate(e).getTime()*this.speed*.001;this.material.uniforms.time=t-parseInt(t)}},e.Cluster=class{constructor(e,t={}){this._objects=C(t.objects,[]),this._getScreenBoundingBox=C(t.getScreenBoundingBox,ke),this._scene=e,this.clusterSize=3,this.pixelRange=50,this._clusterObjects=[]}get objects(){return this._objects}set objects(e){this._objects=e}_clearCluster(){this._objects.map((e=>e.cluster=!1)),this._clusterObjects=[]}update(){const e=this._objects;this._clearCluster();const t=function(e,t){const i=[],n=new Ne(t.globe.ellipsoid,t.camera.positionWC);for(let r of e)r.position&&(t.mode!==Ie.SCENE3D||n.isPointVisible(r.position))&&(r.__pixel=Cesium.SceneTransforms.wgs84ToWindowCoordinates(t,r.position),r.__pixel&&i.push(r));return i}(e,this._scene),i=new Pe(t,Oe,Fe,64,Int32Array);for(let e of t){if(e.cluster)continue;const n=this._getScreenBoundingBox(e,e.__pixel),r=Re.clone(n,new Re);e.cluster=!0;const o=i.range(n.x,n.y,n.x+n.width,n.y+n.height),s=o.length,a=Le.clone(e.position);let l,c=1;const u=[];for(let e=0;e<s;e++){const i=t[o[e]];if(i.cluster)continue;u.push(i.id),i.cluster=!0;const n=this._getScreenBoundingBox(i,i.__pixel);Le.add(i.position,a,a),Re.union(r,n,r),c++,l=i}c>=this.clusterSize?(Le.multiplyByScalar(a,1/c,a),this._clusterObjects.push({position:new Le(a.x,a.y,a.z),number:c,ids:u,id:l.id+c})):this._clusterObjects.push(e)}}},e.ContextMenu=We,e.CursorTip=kn,e.CylinderGeometry=hh,e.DefaultDataSource=_u,e.DivGraphic=class{constructor(e={}){if(!e.position)throw new t("paramerter position must be provided.");if(!e.element)throw new t("parameter element must be provided.");this._show=C(e.show,!0),this._element=element}get show(){return this._show}set show(e){this._show=e,this._element.style.display=e?"block":"none"}get element(){return this.element}},e.DynamicConeGraphic=class extends Hu{constructor(e){super(e),this._speed=C(e.speed,1),this._image=C(e.image,we.buildModuleUrl("assets/img/particle.png")),this._appearance={},this._length=e.length,this._primitive=new Sh,this._primitive.name="DynamicConeGraphic",this._asynchronous=!1,this.createGraphic()}get speed(){return this._speed}set speed(e){if(e===this._speed)return;if(e<=0)throw new t("速度不能小于0");this.definedChanged.raise("speed",e,this._speed),this._speed=e;const i=Object.values(this._appearance);for(let t of i){t.material.uniforms.speed=e}}get length(){return this._length}set length(e){e!==this._length&&(this.definedChanged.raise("length",e,this._length),this._length=e,this.updatePrimitive())}updatePrimitive(){if(!this._viewer)return;this.primitive.removeAll(),this.createGraphic()}updateAttribute(e,t){if(this.isDestroyed())return;if(!this.primitive)return;const i=this.primitive._primitives;for(let n of i)super.updateAttribute.call({primitive:n,isDestroyed:this.isDestroyed},e,t)}createGraphic(){const e=this.createAppearance(fh),t=this.createAppearance(gh),i=this.createAppearance(_h),n=this.createAppearance(yh);this._clampToGround?(this.createCircleGroundPrimitive(e,this._asynchronous),this.createCircleGroundPrimitive(t,this._asynchronous),this.createCylinder(0,.35*this._radius,i,this._asynchronous),this.createCylinder(.1*this._radius,.45*this._radius,n,this._asynchronous,.8)):(this.createCirclePrimitive(e,this._asynchronous),this.createCirclePrimitive(t,this._asynchronous),this.createCylinder(0,.35*this._radius,i,this._asynchronous),this.createCylinder(.1*this._radius,.45*this._radius,n,this._asynchronous,.8))}createCylinder(e,t,i,n=!0,r=1){if(this.isDestroyed())return;const o=C(this._length,.35*this._radius*8)*r,s=Ah.eastNorthUpToFixedFrame(w.toCartesian(this._position)),a=Eh.fromTranslation(new Ph(0,0,o/2+this._height));Eh.multiply(s,a,s);const l=new hh({bottomRadius:t,topRadius:e,length:o}),c=new wh({geometryInstances:new bh({geometry:l,id:this.property}),appearance:i,asynchronous:n,allowPicking:this._allowPicking,modelMatrix:s});return this.primitive.add(c),c}createCirclePrimitive(e,t=!0){if(this.isDestroyed())return;const i=new Th({center:w.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height,granularity:.01}),n=new wh({geometryInstances:new bh({geometry:i,id:this.property}),appearance:e,asynchronous:t,allowPicking:this._allowPicking});return this.primitive.add(n),n}createCircleGroundPrimitive(e,t=!0){if(this.isDestroyed())return;const i=new Th({center:w.toCartesian(this._position),radius:this._radius,stRotation:this._stRotation,extrudedHeight:this._extrudedHeight,height:this._height}),n=new xh({geometryInstances:new bh({geometry:i,id:this.property}),appearance:e,asynchronous:t,allowPicking:this._allowPicking});return this.primitive.add(n),n}createAppearance(e){return this._appearance[e]||(this._appearance[e]=new vh({flat:!0,material:new Ch({translucent:!0,fabric:{uniforms:{color:this._color,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAEACAYAAAADRnAGAAAAAXNSR0IArs4c6QAACQdJREFUeF7tncmvFUUUxr9yFqdEnNg4oa404kYwutANIBu36sK9Cn+Ngmtnl7pSNFE2DmgiGl0pDnGDJjyMAUXGMh85bZpL9+2699U5VcU7N7mbl/uqvv6dr6u7q0+dCljjn7DGjx8OwB2wxgn4KbDGDeCDoJ8C806BGOMlAPg9E0KIJU4XbQ2jDogxXgHgZgDXAlgB8GcI4YwlBAsNgwCE+gYATwLYBOADAJ+EEP62AmClYQzAZQA2AtgFYCuAVwC8GkI4YgjARMMYAP79RgBbANwL4EsAB0IIx4cAxBj5e44V/JzNMV5Im+oa5o0BlwK4CsCVAI5PHPx1ANYLAI4XRzNBUNew6stgjJGA7gewHTh3X/E+gO9DCCcMT5elNeQAcA2AxwHslAPeDWBfCOGYIYClNeQAwMvlnTJe8Jj3A/glhHDSEMDSGlYNgAcZY7wcAKPAzz+WB99BXlZDFgBWkdboxwFoUG2pTXdAS9HS0OoO0KDaUpvugJaipaHVHaBBtaU2kx0g99pXyyMv5wfMHnZm7vezakgCIAd/N4DNIoZPfD+HEE5ZRVtLQyoAPuk9AeBFOeCX5ZnfcpJURUMqAM64PCCzPmTAWWLO+vxr6AAVDakAOOHJ9wM3yQEfBnAshHDWEICKhiQAMunB33KSkp8ib4pkpjirhmQAVpG27scBWBOvrT93QG0RsdbjDrAmXlt/7oDaImKtxx1gTby2/twBtUXEWo87wJp4bf2pO0Ajg2xRiPM0qAKQjlUyyFIhTGnQBtBlbzHjlLnGnEv8znJKvZfFNqhBGwDnEZlB1s0mM4PMOuV2rgZtAMzeumvmfUKJDLJRDaoAZDKVGWTr5JxlBpnZy5RunJCXKoMa1AGkDlalfucASpGvpV93QC2RKKXDHVCKfC39ugNqiUQpHe6AUuRr6TfZAbKQkRlac1eRaR6YhoYkANJxt4aPCyq7dYSWOUJMkcmuIRUA01K4gJLP9dsA8Ln+deOVpCoaUgGQ/m0AdgB4EMDeAkvjVDQkAZDnek5uMEvsellNvmKZJaalIRmACGAU+D/R+uB7kxtZNSwEQHOEL9W2AyhFvpZ+3QG1RKKUDndAKfK19OsOqCUSpXS4A0qRr6Vfd0AtkSilwx1Qinwt/boDaolEKR3ugJzkJReHc4enAZwqMW22qIZsDpDyl8zG4vT5IQA/yPJas1qky2jICeAGAE8BeAbApwDeBPCbZR3SGOPCGjQAPA3gs8IAkjXkBNAlRa7ZU4AwWQiVIFh+96T1ICiJ0QtpyOaAnFcTy7YcgCXtGvtyB9QYFUtN7oAh2jFGZmPwcsYPL2emVeXlVbyJhgscEGPkdfQWuaenlh8B/GEJwVLDEABmgj0M4FlxwFtMihqrLa5xvsYYzTSMAWDNsD6A/QUAmGgYOwVunTkFfi9wCphoGLwKyDnYHwQ5wWH6sdKgdhmsfclsF00VAAPLVbvia5azQzy2/rLdQQ1aAPpLZgm75KYLXDI7qkELgErxw0UGoRhjkgYtALNLZr8A8KvxoukkDSoA5Fa2WzLLPkpuusAls6Ma1AAsYteSv3UAJenX0Lc7oIYolNTgDihJv4a+3QE1RKGkBndASfo19O0OqCEKJTW4A0rSr6Fvd0ANUSipIasD5KUqt+rll7NAg/sUax7wohqyARjZKPlr441YeDyzmzXP1ZATwGyBgz0AXitcZGFSQ24ALLLAeXgWWfgQwMfGG7YzCAtpyAZAZoL7RRb4JuZIgVzBhTRkBSAQugIHWTZhX2bAlKIvPLZJDdkBLCO45P84gJL0a+j7PAfIucNXWvyeKFQBlmOImYb/AciNDIsQ3wdgg2SHWe8pSD2mGvoAeA29XZKjHgPwDoB3Qwh/WVlVbmNNNcwCuEMAPFoQgKkGPwX69pZxgHdSzBZlimyJMtgMipkGvw+wGuBq7ccdUGtkrHS5A6xI19qPO6DWyFjpcgdYka61H3dArZGx0uUOsCJdaz/ugFojY6XLHWBFutZ+3AG1RsZKV5IDeqtAS5bVp1a+NcqqYRJAb3+R9QCOcnOFEMIJqwj1Xrkz9SW7hhQA3Z6d2wEckI1TD1kmPsQY1TSkACD55wA8D+AjAC8BOGi8nF5NQwoAVnPYJBunHgTAVaCmqS9SUUJFwyQAOQcJgd+TAI5bRr8bawRCdg1JACwHPOu+HIA18dr6U3NAL93m3JtmFloNIZhVkOjdPzDdZlSDCoCRdBvrLbeH0m0u0KAFoJl0GysAbwN4r3C+0aAGLQBslxVcWGC1yzgrcQpMalABMDQAFUq36XIOR1N+1ADUdrkb0+MAWomUlk53gBbZVtp1B7QSKS2d7gAtsq206w5oJVJaOt0BWmRbadcd0EqktHS6A7TIttKuO6CVSGnpdAdokW2lXXdAK5HS0ukO0CLbSrvugFYipaXTHaBFtpV23QGtREpLpztAi2wr7boDWomUls5kB0juH9PfuGLDfAdKAtDQkARASlwxZ5/fYwAOF1g1QvjZNaQC6Lat2gbgW9k7zHrViIqGVADdio0XpFhqyVUjWTWkAmCh5Id6q0Y+l1UjZsnPMUYVDakA+DsKyL5iI3V0lwEwu4YkAKkiW/ydA2gxajk1uwNy0myxLRMHyJ0kryCsFMl1h6X2HbhAgzqA3r4DjwDYyH3MAXxjCWGeBgsAvIe/B8AuAFsB7AbwRghhxeqUEQcOarAAwFUbrPm/Q/Yd2AtgXwiBD1UmH1nCN6hBHYA8xvZr/jPyXHxt+kgdYxzUYAJAINAJ/LLm/1mT0M90Ik44T8NcABoTEIseuLaGUQAXe+mMLhDzAKhMQCzigN7+4WoTMfMADE2C/BRCOL3IQazmtzFGdQ3zAHSlM7bIXgMsncEKMpaTIOoapgbBi7Z0xuQYsBrrtvS/ZvcBtUJxALVGxkqXO0CDtNxFris8AcJ7/kkN2R3Qu4XeLPMAX7EIm/EECA+eN1GTGjQAdBMgOwHwFnZy08PcLuxNgExq0ALAyQeW32MBtBITIN3Gi5MasgMYmACpeuNFFQC9CRC2P7npYe5ToGsvZeNFNQBaB5W7XQeQm2hr7a15B/wHRTppPaBaKTsAAAAASUVORK5CYII=",speed:this._speed},source:e}})})),this._appearance[e]}update(e){}},e.DynamicFadeMaterialProperty=dp,e.DynamicFlowWallMaterialProperty=gp,e.DynamicSpreadMaterialProperty=Cp,e.DynamicWaveMaterialProperty=Tp,e.Event=I,e.FlattenPolygonCollection=class{constructor(e,t){this._model=e,e instanceof Qa&&(this._model=e.delegate),this._frameState=t.scene.frameState,this._colorTexture=void 0,this._depthStenclilTexture=void 0,this.frameBuffer=void 0,this._viewport=new Gp,this._rs=void 0,this.canvas=void 0,this._clearColorCommand=new Xp({depth:1,coloe:new Up(0,0,0,1)}),this._useScissorTest=!1,this._scissorRectangle=!1,this._drawCommandList=[],this._camera=new ym,this._passState=void 0,this._clearPassState=void 0,this._width=4096,this._height=4096,this._positions=[],this._polygonBounding=new Gp,this._delta=0,this._localModel=void 0,this._inverseLocalModel=void 0,this._uniforms={},this._initShaderSource=!1,this._colorTexture=void 0,this._enabled=!0,this._removeEvent=t.scene.postRender.addEventListener((e=>{this.update(e.frameState)}))}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get ready(){return this._model.ready}get readyPromise(){return this._model.readyPromise}get polygonBounding(){return this._polygonBounding}set polygonBounding(e){this._polygonBounding={x:e.x,y:e.y,z:e.x+e.width,w:e.y+e.height};const t=this._camera.frustum;t.left=e.x,t.top=e.y+e.height,t.right=e.x+e.width,t.bottom=e.y}_updateUniforms(){if(this._uniforms){if(this._uniforms.u_polygonTexture){const e=new mm({url:"./"});e.texture=this._colorTexture,this._uniforms.u_polygonTexture.value=e}this._uniforms.u_polygonBounding&&(this._uniforms.u_polygonBounding.value=this._polygonBounding),this._uniforms.u_enabled&&(this._uniforms.u_enabled.value=this._enabled),this._uniforms.u_delta&&(this._uniforms.u_delta.value=this._delta)}}_addShaderSource(){if(this._initShaderSource)return;const e=new mm({url:"./"});e.texture=this._colorTexture;const t={u_inverseLocalModel:{type:pm.MAT4,value:this._inverseLocalModel},u_localModel:{type:pm.MAT4,value:this._localModel},u_polygonBounding:{type:pm.VEC4,value:this.polygonBounding},u_polygonTexture:{type:pm.SAMPLER_2D,value:e},u_delta:{type:pm.FLOAT,value:this._delta},u_enabled:{type:pm.BOOL,value:this._enabled}};this._uniforms=t,this._model.customShader=new dm({uniforms:t,vertexShaderText:"bool isPointInBound(vec4 point, vec4 bounds) {\n    return (point.x>bounds.x&&point.x<bounds.z&&point.y>bounds.y&&point.y<bounds.w);\n  }\n  void vertexMain(VertexInput vsInput, inout czm_modelVertexOutput vsOutput) {\n  vec4 positionLC = u_inverseLocalModel * czm_model * vec4(vsInput.attributes.positionMC, 1.0);  \n    if (u_enabled && isPointInBound(positionLC, u_polygonBounding)) {\n      vec2 textureCoord;\n      textureCoord.x = (positionLC.x-u_polygonBounding.x)/(u_polygonBounding.z-u_polygonBounding.x);\n      textureCoord.y = (positionLC.y-u_polygonBounding.y)/(u_polygonBounding.w-u_polygonBounding.y);\n      float depth = czm_unpackDepth(texture2D(u_polygonTexture, textureCoord));\n      depth = depth * 4096.0;\n      if (depth > 1.0 && positionLC.z > depth) {\n        positionLC.z = mix(depth, positionLC.z, u_delta);\n      }\n      vsOutput.positionMC = (czm_inverseModel * u_localModel * positionLC).xyz;\n    }       \n  }"}),this._initShaderSource=!0}_createDrawCommand(e,t){const i=this._frameState,n=e.attributes.position.values;for(let e=0,i=n.length;e<i/3;e++){const i=new Hp(n[3*e],n[3*e+1],n[3*e+2]);qp.multiplyByPoint(t,i,i),n[3*e]=i.x,n[3*e+1]=i.y,n[3*e+2]=i.z,this._positions.push(i)}e.boundingSphere=im.transform(e.boundingSphere,t),this.polygonBounding=Gp.fromPoints(this._positions);const r=nm.fromGeometry({context:i.context,geometry:e,attributeLocations:{position:0},bufferUsage:rm.STREAM_DRAW,interleave:!0}),o=om.fromCache({context:i.context,vertexShaderSource:"\nattribute vec3 position;\nvarying float depth;\nvoid main() {\n  vec4 pos = vec4(position, 1.0);\n  depth = position.z;\n  gl_Position = czm_projection * vec4(position.xy, 0.0, 1.0); \n}\n",fragmentShaderSource:"\nvarying float depth;\nvoid main() {\n  float fDepth = depth / 4096.0; \n  gl_FragColor = czm_packDepth(fDepth);\n}\n"}),s=new sm;s.depthTest.enabled=!0,s.cull.enabled=!0,s.cull.face=am.BACK;const a=new lm({primitiveType:cm.TRIANGLES,vertexArray:r,shaderProgram:o,uniformMap:{},renderState:s,pass:um.CESIUM_3D_TILE});this._updateUniforms(),this._drawCommandList.push(a)}addPolygon(e){this._localModel?this._createDrawCommand(e,this._inverseLocalModel):this.readyPromise.then((()=>{this._updateMatrix(),this._createDrawCommand(e,this._inverseLocalModel)}))}_updateMatrix(){let e=this._model._rtcCenter;if(!e){const t=this._model.boundingSphere.center,i=Wp.fromCartesian(t);e=Hp.fromRadians(i.longitude,i.latitude,0)}this._localModel=hm.eastNorthUpToFixedFrame(e),this._inverseLocalModel=qp.inverse(this._localModel,{})}addPolygonFromPositionArray(e){const t=Math.min(...e.map((e=>Wp.fromCartesian(e).height))),i=new em({polygonHierarchy:new tm(e),height:t}),n=em.createGeometry(i);this.addPolygon(n)}update(e){if(!this._drawCommandList.length)return;vm.call(this,e),this._initShaderSource||this._addShaderSource(),jp(this._passState)||(this._passState=new Zp(e.context)),this._updateUniforms(),this._passState.viewport=new Gp(0,0,this._width,this._height);const t=e.context.uniformState;t.updateCamera(this._camera),this._clearColorCommand.framebuffer=this.frameBuffer,this._clearColorCommand.execute(e.context,this._clearPassState);for(const i of this._drawCommandList)t.updatePass(i.pass),i.framebuffer=this.frameBuffer,i.execute(e.context,this._passState)}clear(){this._clearColorCommand&&this._clearColorCommand.execute(this._frameState.context,this._clearPassState)}isDestroyed(){return!1}destroy(){this._colorTexture&&!this._colorTexture.isDestroyed()&&this._colorTexture.destroy(),this._depthStenclilTexture&&!this._depthStenclilTexture.isDestroyed()&&this._depthStenclilTexture.destroy(),this.frameBuffer&&!this.frameBuffer.isDestroyed()&&this.frameBuffer.destroy(),Vp(this),this._removeEvent()}},e.GaoDeLayer=rd,e.GeoJsonDataSource=ws,e.Globe=tc,e.Graphic=Hn,e.GraphicGroup=jn,e.GroundSkyBox=class{constructor(e={}){this.sources=$n(e.sources,{positiveX:we.buildModuleUrl("./assets/skybox/px.png"),negativeX:we.buildModuleUrl("./assets/skybox/nx.png"),positiveY:we.buildModuleUrl("./assets/skybox/py.png"),negativeY:we.buildModuleUrl("./assets/skybox/ny.png"),positiveZ:we.buildModuleUrl("./assets/skybox/pz.png"),negativeZ:we.buildModuleUrl("./assets/skybox/nz.png")}),this._sources=void 0,this.show=$n(e.show,!0),this._command=new Jn({modelMatrix:Xn.clone(Xn.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0,this._isDestroyed=!1}update(e,i){const n=new dr,r=this;if(!this.show)return;if(e.mode!==cr.SCENE3D&&e.mode!==cr.MORPHING)return;if(!e.passes.render)return;const{context:o}=e;if(this._sources!==this.sources){this._sources=this.sources;const{sources:e}=this;if(!(Kn(e.positiveX)&&Kn(e.negativeX)&&Kn(e.positiveY)&&Kn(e.negativeY)&&Kn(e.positiveZ)&&Kn(e.negativeZ)))throw new t("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof e.positiveX!=typeof e.negativeX||typeof e.positiveX!=typeof e.positiveY||typeof e.positiveX!=typeof e.negativeY||typeof e.positiveX!=typeof e.positiveZ||typeof e.positiveX!=typeof e.negativeZ)throw new t("this.sources properties must all be the same type.");"string"==typeof e.positiveX?or(o,this._sources).then((e=>{r._cubeMap=r._cubeMap&&r._cubeMap.destroy(),r._cubeMap=e})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new rr({context:o,source:e}))}const s=this._command;if(s.modelMatrix=tr.eastNorthUpToFixedFrame(e.camera._positionWC),!Kn(s.vertexArray)){s.uniformMap={u_cubeMap:()=>r._cubeMap,u_rotateMatrix:()=>"function"==typeof Xn.getRotation?Xn.getRotation(s.modelMatrix,n):Xn.getMatrix3(s.modelMatrix,n)};const e=Zn.createGeometry(Zn.fromDimensions({dimensions:new Qn(2,2,2),vertexFormat:ir.POSITION_ONLY})),t=this._attributeLocations=er.createAttributeLocations(e);s.vertexArray=ar.fromGeometry({context:o,geometry:e,attributeLocations:t,bufferUsage:nr._DRAW}),s.renderState=sr.fromCache({blending:lr.ALPHA_BLEND})}if(!Kn(s.shaderProgram)||this._useHdr!==i){const e=new hr({defines:[i?"HDR":""],sources:["uniform samplerCube u_cubeMap;\n  varying vec3 v_texCoord;\n  void main()\n  {\n  vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n  gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n  }\n  "]});s.shaderProgram=ur.fromCache({context:o,vertexShaderSource:"attribute vec3 position;\n  varying vec3 v_texCoord;\n  uniform mat3 u_rotateMatrix;\n  void main()\n  {\n  vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n  gl_Position = czm_projection * vec4(p, 1.0);\n  v_texCoord = position.xyz;\n  }\n  ",fragmentShaderSource:e,attributeLocations:this._attributeLocations}),this._useHdr=i}return Kn(this._cubeMap)?s:void 0}isDestroyed(){return this._isDestroyed}destroy(){const e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),Yn(this)}},e.HtmlGraphicGroup=class extends jn{constructor(e,t={}){super(e),this._viewer=e,this._allowPicking=C(t.allowPicking,!1),this._createRoot(),this._addEventListener(),this.selectedEvent=new I}_createRoot(){const e=document.createElement("div");e.style.position="absolute",e.style.zIndex=9999,e.style.pointerEvents="none",e.style.width="100vw",e.style.height="100vh",e.style.left=0,e.style.top=0,this._viewer.container.appendChild(e),this.root=e}_addEventListener(){const e=this._viewer.scene.postRender.addEventListener((()=>{const e=this.values._array,t=viewer.camera._positionCartographic.height;for(let i of e){const e=i.position,n=i.el;if(!n)return;const r=w.toPixel(e,this._viewer.scene);if(r&&w.isVisible(e,this._viewer))if(n.style.left=r.x+"px",n.style.top=r.y+"px",i.distanceDisplayCondition){const{near:e,far:r}=i.distanceDisplayCondition;n.style.display=t<r&&t>e?i.display||"block":"none"}else n.style.display=i.display||"block";else n.style.display="none"}})),t=this;function i(e){const{target:i}=e;if(!i)return;const n=t.getById(i.id);t.selectedEvent.raise(n)}this.root.addEventListener("click",i),this.removeEventListener=function(){e(),t.root.removeEventListener("click",i)}}add(e){if(!(e instanceof pr))throw new t(e+"is not a html graphic.");this.values.set(e.id,e),this.root.appendChild(e.el),e.group=this,e._loadEvent.raise()}remove(e){this.values.remove(e.id),e.el&&this.root.removeChild(e.el)}getById(e){return this.values.get(e)}removeById(e){const t=this.values.get(e);this.remove(t)}clear(){const e=[...this.values._array];for(let t of e)t.remove();this.values.removeAll()}destroy(){this._viewer.container.removeChild(this.root),this.removeEventListener(),Gn(this)}get boundingSphere(){const e=this.values._array.map((e=>w.toCartesian(e.position)));return Cesium.BoundingSphere.fromPoints(e)}},e.HtmlPointGraphic=pr,e.ImageGraphic=class extends Hu{constructor(e){super(e),this._primitive=new Nh,this._image=e.image,this._speedFactor=C(e.speedFactor,1),this._imageIndex=0,this._imageParser=e.imageParser,this.createGraphic()}get clampToGround(){}set clampToGround(e){throw new t("clampToGround is not valid.")}get speedFactor(){return this._speedFactor}set speedFactor(e){this._speedFactor=e}createGraphic(){this._requestImage=function(e,t=[],i){const n=document.createElement("img");n.src=e,n.setAttribute("rel:animated_src",e),n.setAttribute("rel:auto_play","0"),n.style.cssText="position:fixed;zIndex: -1;",document.body.appendChild(n);const r=new Ih({gif:n});return new Promise((e=>{r.load((()=>{for(let e=1;e<=r.get_length();e++){r.move_to(e);const n=r.get_canvas();i&&i(n),t.push(n.toDataURL())}e(t)}))}))}(this._image,[],this._imageParser),this._billboard=this._primitive.add({position:w.toCartesian(this._position),image:this._image,verticalOrigin:Oh.BOTTOM})}update(){this._speedFactor<=0||this._requestImage.then((e=>{const t=e[Math.floor(this._imageIndex++/this._speedFactor)%e.length];this._billboard.image=t}))}remove(){super.remove(),this._billboard=void 0}},e.InfoBox=Ja,e.LonLat=w,e.LonLatNetLayer=class{constructor(e={}){const t=new vr({rectangle:Cesium.Rectangle.MAX_VALUE,intervalOfZeorLevel:e.intervalOfZeorLevel});this._hasAlphaChannel=C(e.hasAlphaChannel,!0),this._tilingScheme=t,this._image=void 0,this._texture=void 0,this._errorEvent=new I,this._ready=!0,this._readyPromise=Promise.resolve(!0),this._font=C(e.font,"bold 24px sans-serif"),this._color=C(e.color,"white"),this._lineColor=C(e.lineColor,"gold"),this._lineWidth=C(e.lineWidth,2)}get hasAlphaChannel(){return this._hasAlphaChannel}get tileHeight(){return 256}get tileWidth(){return 256}get minimumLevel(){return 0}get maximumLevel(){return 4}get rectangle(){return Cesium.Rectangle.MAX_VALUE}get errorEvent(){return this._errorEvent}get tileDiscardPolicy(){}get readyPromise(){return this._readyPromise}get ready(){return!0}get tilingScheme(){return this._tilingScheme}get font(){return this._font}set font(e){this._font=e}get color(){return`rgba(${255*this._color.red}, ${255*this._color.green}, ${255*this._color.blue}, ${this._color.alpha})`}set color(e){this._color=e}get lineColor(){const e=this._lineColor;return`rgba(${255*e.red}, ${255*e.green}, ${255*e.blue}, ${e.alpha})`}set lineColor(e){this._lineColor=e}get lineWidth(){return this._lineWidth}createCanvas(){const e=document.createElement("canvas");e.width=this.tileWidth,e.height=this.tileHeight;const t=e.getContext("2d");return t.textBaseline="middle",t.textAlign="center",t.font=this.font,t.fillStyle=this.color,t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,{canvas:e,ctx:t}}getOffset(e,t,i){const n=this.tilingScheme.getDelatXY(i),r=Math.floor(e),o=Math.floor(t);if(r===e&&o===t)return[0,0,r,o];const s=e-r,a=t-o;let l=0,c=0;return s&&(l=this.tileWidth/n.dx*s),a&&(c=this.tileHeight/n.dy*a),[l,c,r,o]}requestImage(e,t,i,n){const{ctx:r,canvas:o}=this.createCanvas(),s=this.tilingScheme.getPosition(i,e,t);return r.textAlign="left",r.fillText(s.lon,10,o.height/2),r.textAlign="center",r.fillText(s.lat,o.width/2,20),r.strokeRect(0,0,o.width,o.height),Promise.resolve(o)}},e.LonlatTilingScheme=vr,e.MassiveBillboardLayer=class extends Em{constructor(e={}){e.objects=C(e.objects,[]),e.pixelSize=C(e.pixelSize,5),e.color=C(e.color,Im.fromRandom),e.createGeometryFunction=C(e.createGeometryFunction,function(e){return function(t){const i={id:t.id,position:t.position,point:{pixelSize:C(t.pixelSize,e.pixelSize),color:C(t.color,e.color)}};return t.label&&(i.label={text:t.label}),new Nm(i)}}(e)),super(e)}},e.MassiveEntityLayer=Em,e.MassiveGraphicLayer=Ka,e.MassiveGraphicLayerCollection=tl,e.MassiveModelLayer=class extends Ka{constructor(e={}){e.objects.forEach((e=>{e._id=e.id,delete e.id})),super(e),this._id=C(e.id,Ue()),this._createGeometryFunction=e.createGeometryFunction,this._data=e.objects,this._needReclass=!0,this._changeEvent=new Fm,this._maxClusterLevel=C(e.maxClusterLevel,12),this._minLoadLevel=C(e.minLoadLevel,12),this._geometryCached={},this._objectsCached={},this._options=e}get id(){return this._id}get minLoadLevel(){return this._minLoadLevel}set minLoadLevel(e){this._minLoadLevel=e}get objects(){return this._objects||this._data}set objects(e){this._objects=e}updateCluster(e){const t=Gm(e),i=this._objects;return t>this._maxClusterLevel?(this._objects=this._data,this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._objectsCached[t]?(this._objects=this._objectsCached[t],this._needReclass=i!==this._objects,Promise.resolve(this._needReclass)):this._cluster?new Promise(((e,i)=>{this._cluster.update(),this._objects=this._cluster._clusterObjects,this._objectsCached[t]=JSON.parse(JSON.stringify(this._objects)),this._needReclass=!0,e(!0)})):void 0}beginUpdate(e){Gm(e.camera.positionCartographic.height)<this._minLoadLevel?this._objects=[]:this._objects=this._data}endUpdate(e){const t=Gm(e.camera.positionCartographic.height);return this._needReclass=!1,t<this._minLoadLevel}initialize(e,t){if(!this._collection){this._scene=t;const e=new Cesium.PrimitiveCollection;t.primitives.add(e),this._collection=e}}createGeometry(e,t,i){if(e.level<this._minLoadLevel)return;const n=C(this._createGeometryFunction,zm)(i,this._options);return this.add(n),n}removeGeometry(e,t){if(!t)return;return this._collection.remove(t)}add(e){this._collection&&e&&this._collection.add(e)}removeAll(){this._collection.removeAll()}isDestroyed(){return!1}destroy(){this._collection.removeAll(),Om(this)}},e.MassivePointLayer=class extends Em{constructor(e={}){e.objects=C(e.objects,[]),e.pixelSize=C(e.pixelSize,5),e.color=C(e.color,qm.fromRandom),e.createGeometryFunction=C(e.createGeometryFunction,function(e){return function(t){let i=Ym();"string"!=typeof t.id&&"number"!=typeof t.id||(i=t.id);const n={id:i,position:t.position,point:{pixelSize:C(t.pixelSize,e.pixelSize),color:C(t.color,e.color)}};return t.label&&(n.label={text:t.label}),new $m(n)}}(e)),super(e)}},e.Material=Jm,e.Model=qr,e.MultipleTerrainProvider=class{constructor(e,t={}){this._heightmapWidth=65,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._ellipsoid=t.ellipsoid,this._requestVertexNormals=C(t.requestVertexNormals,!1),this._requestWaterMask=C(t.requestWaterMask,!1),this._requestMetadata=C(t.requestMetadata,!0),this._errorEvent=new I,this._terrainProviders=[];const i=[];for(let n of e){n.requestVertexNormals=n.requestVertexNormals||t.requestVertexNormals,n.requestWaterMask=n.requestWaterMask||t.requestWaterMask,n.requestMetadata=n.requestMetadata||t.requestMetadata;const e=new ne(n);e.zIndex=n.zIndex||-1,this._terrainProviders.push(e),i.push(Lr(e,n.url))}this._ready=!1,this._readyPromise=new Promise((e=>{Promise.all([...this._terrainProviders.map((e=>e.readyPromise)),...i]).then((t=>{this._ready=!0,e(!0),this._tilingScheme=this._terrainProviders[0]._tilingScheme,this._levelZeroMaximumGeometricError=xr.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0))}))})),this._terrainList=e,this._validProvider=void 0}get errorEvent(){return this._errorEvent}get tilingScheme(){return this._tilingScheme}get ready(){return this._ready}get readyPromise(){return this._readyPromise}createBoundingRectangle(e){const t=new br("multiple-terrain-provider");for(let e of this._terrainProviders)t.entities.add(Pr(e));return e.addLayer(t),function(){const t=e.dataSources.getByName("multiple-terrain-provider");e.dataSources.remove(t[0])}}getLevelMaximumGeometricError(e){return this._validProvider?this._validProvider.getLevelMaximumGeometricError(e):this._levelZeroMaximumGeometricError/(1<<e)}getTileDataAvailable(e,t,i){const n=this._terrainProviders.filter((n=>n.getTileDataAvailable(e,t,i))).sort(((e,t)=>t.zIndex-e.zIndex));return this._validProvider=n[0],!!this._validProvider}requestTileGeometry(e,t,i,n){for(let n of this._terrainProviders)n!==this._validProvider&&n.getTileDataAvailable(e,t,i)&&n.requestTileGeometry(e,t,i);if(this._validProvider)return this._validProvider.requestTileGeometry(e,t,i)}},e.NodePlot=Zd,e.PbfDataSource=function(){},e.PlotManager=class{constructor(e,t){he(e),this._viewer=e,t=C(t,{}),this._id=C(t.id,je()),this._dataSource=new Cesium.CustomDataSource("cesiumpro-graphic_"+this._id),this._nodeDataSource=new Cesium.CustomDataSource("cesiumpro-graphic-node_"+this._id),this._viewer.dataSources.add(this._dataSource),this._viewer.dataSources.add(this._nodeDataSource),this._root=this._dataSource.entities,this._nodeRoot=this._nodeDataSource.entities,this._preEdit=new I,this._postEdit=new I,this._preCreate=new I,this._postCreate=new I,this._preRemove=new I,this._postRemove=new I,this._values=new Cesium.AssociativeArray,this._handler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._pointStyle=C(t.pointStyle,$d.defaultPointStyle),this._labelStyle=C(t.labelStyle,$d.defaultLabelStyle),this._modelStyle=C(t.modelStyle,$d.defaultModelStyle),this._billboardStyle=C(t.billboardStyle,$d.defaultBillboardStyle),this._polylineStyle=C(t.polylineStyle,Yd.defaultStyle),this._polygonStyle=C(t.polygonStyle,Xd.defaultStyle),this._editEventHandler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._viewer.screenSpaceEventHandler.removeInputAction(rp),this._mode=ap,t.contextEnabled=C(t.contextEnabled,!0),t.contextEnabled&&(this.contextMenu=this.createContext()),this.cursorTip=new kn({text:"",id:"plot-manager-tip",viewer:this._viewer,show:!1}),this.activeGraphic=void 0,this.selectedGraphic=void 0}get viewer(){return this._viewer}get preEdit(){return this._preEdit}get postEdit(){return this._postEdit}get preCreate(){return this._preCreate}get postCreate(){return this._postCreate}get preRemove(){return this._preRemove}get postRemove(){return this._postRemove}get root(){return this._root}pick(e){let t,i=!1;return qd.isPoint(e)&&(i=!0),this._mode=lp,e===qd.POINT?t=this.createPoint(this._pointStyle,this._labelStyle):e===qd.LABEL?t=this.createLabel(this._labelStyle):e===qd.MODEL?t=this.createModel(this._modelStyle,this._labelStyle):e===qd.BILLBOARD?t=this.createBillboard(this._billboardStyle,this._labelStyle):e===qd.POLYLINE?t=this.createPolyline(this._polylineStyle):e===qd.POLYGON?t=this.createPolygon(this._polygonStyle):qd.isArrow(e)&&(t=this.createArrow(this._polygonStyle,e)),this.activeGraphic=t,t.startEdit(),this.addEventListener(i),t}createPoint(e,t){const i=new $d(e,{label:t});return this.add(i),i}createLabel(e){const t=new $d(e,{type:qd.LABEL});return this.add(t),t}createModel(e,t){const i=new $d(e,{type:qd.MODEL,label:t});return this.add(i),i}createBillboard(e,t){const i=new $d(e,{type:qd.BILLBOARD,label:t});return this.add(i),i}createPolyline(e){const t=new Yd(e);return this.add(t),t}createPolygon(e){const t=new Xd(e);return this.add(t),t}createArrow(e,t){const i=new Qd(e,{type:t});return this.add(i),i}add(e){this.preCreate.raise(e),x(this.viewer&&x(e.entity))&&(this.root.add(e.entity),this._values.set(e.id,e),this.postCreate.raise(e))}remove(e){x(e)&&(this.preRemove.raise(e),x(this.viewer)&&x(e.entity)&&(this.root.remove(e.entity),this.postRemove.raise(e)),this._values.remove(e.id),this.activeGraphic&&(this.activeGraphic=void 0))}get(e){return this._values.values[e]}getById(e){return this._values.get(e)}hasEntity(e){return!!x(e)&&this._root.contains(e)}removeAll(){this.root.removeAll(),this.removeNodeGraphic(),this._values.removeAll()}destroy(){this.removeAll(),this.contextMenu.destroy(),this._viewer.dataSources.remove(this._dataSource),this._viewer.dataSources.remove(this._nodeDataSource),this.cursorTip.destroy(),this._handler.isDestroyed()||this._handler.destroy(),Gn(this)}zoomTo(e){const t=[];if(Array.isArray(e))for(let i of e)t.push(i.entity);else t.push(e.entity);x(this._viewer)&&this._viewer.zoomTo(t)}has(e){return"string"==typeof e?this._values.contains(e):this._values.values.includes(e)}startEdit(e){this.activeGraphic&&this.stopEdit(this.activeGraphic),e&&(e.startEdit(),this.preEdit.raise(e),this.createNodeGraphic(e),this.activeGraphic=e,this.addEditEventListener(),this.cursorTip.show=!0,this.cursorTip.text="单击节点选中")}stopEdit(e){e&&(e.stopEdit(),e.highlightGraphic(!1),this._nodeRoot.removeAll(),this.cursorTip.show=!1,this.activeGraphic=void 0,this._mode=ap,this.postEdit.raise(e),this.removeEditListener&&this.removeEditListener())}createNodeGraphic(e){if(qd.isPoint(e.type))return;const t=new Zd({positions:e._nodePositions,...$d.defaultStyle}),i=t._values;for(let e of i)this._nodeRoot.add(e);this._nodeGraphic=t}removeNodeGraphic(){this._nodeRoot.removeAll(),this._nodeGraphic=void 0}addEventListener(e=!0){if(!x(this.activeGraphic))return;const t=this.activeGraphic.positions,i=e=>{const i=this.pickPosition(e.endPosition);x(i)&&(t.length<1||(t.length>1&&this.activeGraphic.popNode(),this.activeGraphic.addNode(i)))},n=()=>{this._handler.removeInputAction(Kd),this._handler.removeInputAction(ep),this._handler.removeInputAction(sp),this.stopEdit(this.activeGraphic),x(this.contextMenu)&&this.addContextEventListener()};e||(this._handler.setInputAction(i,ep),this._handler.setInputAction(n,sp)),this._handler.setInputAction((t=>{const i=qd.isPoint(this.activeGraphic.type)?this.activeGraphic.updatePosition.bind(this.activeGraphic):this.activeGraphic.addNode.bind(this.activeGraphic),n=this.pickPosition(t.position);x(n)&&(x(i)&&i(n),e&&(this._handler.removeInputAction(Kd),this.stopEdit(this.activeGraphic),x(this.contextMenu)&&this.addContextEventListener()),x(this.contextMenu)&&this.removeContextEventListener())}),Kd)}addEditEventListener(){const e=this._editEventHandler;let t=!1;const i=i=>{t=!1,Br(this._viewer,!t),e.removeInputAction(ep),e.removeInputAction(np)},n=e=>{const t=this.pickPosition(e.endPosition);this.updatePosition(t)};e.setInputAction((e=>{if(x(this.contextMenu)&&(this.contextMenu.show=!1),!x(this.activeGraphic))return;const t=this._viewer.scene.pick(e.position);x(t)&&t.id instanceof Cesium.Entity?this.hasEntity(t.id)?(this.activeGraphic.highlightGraphic(),this._nodeGraphic&&(this._nodeGraphic.activeNode=void 0)):this._nodeGraphic&&this._nodeGraphic.has(t.id)?(this._nodeGraphic.activeNode=t.id.position.getValue(this._viewer.clock.currentTime),this.activeGraphic.highlightGraphic(!1)):(this._nodeGraphic.activeNode=void 0,this.activeGraphic.highlightGraphic(!1)):(this._nodeGraphic&&(this._nodeGraphic.activeNode=void 0),this.activeGraphic&&this.activeGraphic.highlightGraphic(!1))}),Kd),e.setInputAction((()=>{t=!0,Br(this._viewer,!t),e.setInputAction(i,np),e.setInputAction(n,ep)}),ip),this.removeEditListener=function(){e.removeInputAction(ep),e.removeInputAction(np),e.removeInputAction(Kd),e.removeInputAction(ip),this.removeEditListener=void 0}}addContextEventListener(){this._editEventHandler.setInputAction((e=>{if(this._mode!==ap)return;const t=this._viewer.scene.pick(e.position),i=Dr(e.position,this._viewer,!0);x(t)&&this.hasEntity(t.id)&&(this.contextMenu.position=i,this.selectedGraphic=this.getById(t.id.id),x(this.contextMenu)&&(this.contextMenu.show=!0))}),op)}removeContextEventListener(){this._editEventHandler.removeInputAction(op)}removeEditEventListener(){this._editEventHandler.removeInputAction(Kd),this._editEventHandler.removeInputAction(ip)}updatePosition(e){const t=this.activeGraphic;if(x(t))if(qd.isPoint(t.type))t.updatePosition(e);else{if(!x(this._nodeGraphic)||!x(this._nodeGraphic.activeIndex))return;t.updateNode(this._nodeGraphic.activeIndex,e)}}pickPosition(e){if(!x(this.activeGraphic))return;const t=this.activeGraphic.clampToModel;return Dr(e,this._viewer,t)}addNode(e,t,i){if(e.addNode(t,i),this._nodeGraphic){const e=this._nodeGraphic.addNode(t,i);this._nodeRoot.add(e)}}removeNode(e,t){if(e.removeNode&&e.removeNode(t),this._nodeGraphic){const e=this._nodeGraphic.removeNode(t);this._nodeRoot.remove(e)}}get show(){return this._root.show}set show(e){this._root.show=e}get pointStyle(){return this._pointStyle}set pointStyle(e){this._pointStyle=e}get labelStyle(){return this._labelStyle}set labelStyle(e){this._labelStyle=e}get billboardStyle(){return this._billboardStyle}set billboardStyle(e){this._billboardStyle=e}get modelStyle(){return this._modelStyle}set modelStyle(e){this._modelStyle=e}createContext(){return this.contextMenu=new We(this._viewer,{items:[{id:"startEdit",text:"开始编辑",class:"fa fa-pencil-square-o",disabled:this.activeGraphic,callback:e=>{if(this.selectedGraphic){this.startEdit(this.selectedGraphic);const t=this.contextMenu.getById("stopEdit");this.contextMenu.updateItemDistabled(t,!1),this.contextMenu.updateItemDistabled(e,!0)}}},{id:"stopEdit",text:"停止编辑",class:"fa fa-floppy-o",disabled:!this.activeGraphic,callback:e=>{if(this.selectedGraphic){this.stopEdit(this.selectedGraphic);const t=this.contextMenu.getById("startEdit");this.contextMenu.updateItemDistabled(e,!0),this.contextMenu.updateItemDistabled(t,!1)}}},{id:"delete",text:"删除图形",class:"fa fa-times",callback:e=>{this.remove(this.selectedGraphic)}},{id:"select",text:"选择顶点",class:"fa fa-mouse-pointer"}]}),this.contextMenu}},e.PlotType=qd,e.PointBaseGraphic=Hu,e.PointPlot=$d,e.PolygonPlot=Xd,e.PolylineAntialiasingMaterialProperty=Pp,e.PolylineFlowMaterialProperty=Rp,e.PolylineODMaterialProperty=Op,e.PolylinePlot=Yd,e.PolylineTrailLinkMaterialProperty=Bp,e.PostProcessing=Km,e.Primitive=function(){Object.defineProperty(Zc.prototype,"needUpdate",{get(){return!!this._needUpdate},set(e){this._needUpdate=e}}),Zc.prototype.update=function(e){if(nu.call(this,e),this.needUpdate){var t=tu(this._createShaderProgramFunction,lu);console.log("update shader"),t(this,e,appearance),this.needUpdate=!1}}},e.Properties=zr,e.RadarScanGraphic=class extends Hu{constructor(e){super(e),this._speed=C(e.speed,10),this._time=0,this.createGraphic()}get speed(){return this._speed}set speed(e){e!==this._speed&&(e<0&&(this._speed=0),this.definedChanged.raise("speed",e,this._speed),this._speed=e)}createAppearance(){return this._appearance||(this._appearance=new kh({material:new zh({translucent:!0,fabric:{uniforms:{color:this._color,time:0},source:Fh}})})),this._appearance}update(e){if(!this.material)return;if(0===this.speed)return void(this.material.uniforms.time=.9999);const t=Cesium.JulianDate.toDate(e).getTime()/500*this.speed;this.material.uniforms.time=t-parseInt(t)}},e.RectangularSensorPrimitive=class{constructor(e){e=C(e,C.EMPTY_OBJECT);const i=this;if(this._createVS=!0,this._createRS=!0,this._createSP=!0,this.show=C(e.show,!0),this.slice=C(e.slice,32),e.modelMatrix)this._modelMatrix=of.clone(e.modelMatrix,new of);else{if(!e.position)throw new t("parameter position or modelMatrix must be provided.");this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(w.toCartesian(e.position))}this._computedModelMatrix=new of,this._computedScanPlaneModelMatrix=new of,this._radius=C(e.radius,Number.POSITIVE_INFINITY),this._xHalfAngle=If.toRadians(C(e.xHalfAngle,0)),this._yHalfAngle=If.toRadians(C(e.yHalfAngle,0)),this._color=C(e._color,af.AQUA.withAlpha(.4)),this.lineColor=C(e.lineColor,af.WHITE),this.showSectorLines=C(e.showSectorLines,!0),this.showSectorSegmentLines=C(e.showSectorSegmentLines,!0),this.showLateralSurfaces=C(e.showLateralSurfaces,!0),this._material=x(e.material)?e.material:sf.fromType(sf.ColorType),this._material.uniforms.color=this._color,this._translucent=void 0,this.lateralSurfaceMaterial=x(e.lateralSurfaceMaterial)?e.lateralSurfaceMaterial:sf.fromType(sf.ColorType),this._lateralSurfaceMaterial=void 0,this._lateralSurfaceTranslucent=void 0,this.showDomeSurfaces=C(e.showDomeSurfaces,!0),this.domeSurfaceMaterial=x(e.domeSurfaceMaterial)?e.domeSurfaceMaterial:sf.fromType(sf.ColorType),this.showDomeLines=C(e.showDomeLines,!0),this.showIntersection=C(e.showIntersection,!1),this.intersectionColor=C(e.intersectionColor,af.WHITE),this.intersectionWidth=C(e.intersectionWidth,5),this._showThroughEllipsoid=C(e.showThroughEllipsoid,!1),this.showScanPlane=C(e.showScanPlane,!0),this.scanPlaneColor=C(e.scanPlaneColor,af.AQUA),this.scanPlaneMode=C(e.scanPlaneMode,"H"),this.speed=C(e.speed,10),this._scanePlaneXHalfAngle=0,this._scanePlaneYHalfAngle=0,this._time=lf.now(),this._boundingSphere=new cf,this._boundingSphereWC=new cf,this._boundingSphere=new cf(Sf.ZERO,this._radius),of.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),cf.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC),this._sectorFrontCommand=new uf({owner:this,primitiveType:hf.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorBackCommand=new uf({owner:this,primitiveType:hf.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorVA=void 0,this._sectorLineCommand=new uf({owner:this,primitiveType:hf.LINES,boundingVolume:this._boundingSphereWC}),this._sectorLineVA=void 0,this._sectorSegmentLineCommand=new uf({owner:this,primitiveType:hf.LINES,boundingVolume:this._boundingSphereWC}),this._sectorSegmentLineVA=void 0,this._domeFrontCommand=new uf({owner:this,primitiveType:hf.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeBackCommand=new uf({owner:this,primitiveType:hf.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeVA=void 0,this._domeLineCommand=new uf({owner:this,primitiveType:hf.LINES,boundingVolume:this._boundingSphereWC}),this._domeLineVA=void 0,this._scanPlaneFrontCommand=new uf({owner:this,primitiveType:hf.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanPlaneBackCommand=new uf({owner:this,primitiveType:hf.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanRadialCommand=void 0,this._colorCommands=[],this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._uniforms={u_type:function(){return 0},u_xHalfAngle:function(){return i._xHalfAngle},u_yHalfAngle:function(){return i._yHalfAngle},u_radius:function(){return i.radius},u_showThroughEllipsoid:function(){return i.showThroughEllipsoid},u_showIntersection:function(){return i.showIntersection},u_intersectionColor:function(){return i.intersectionColor},u_intersectionWidth:function(){return i.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return i.lineColor}},this._scanUniforms={u_xHalfAngle:function(){return i._scanePlaneXHalfAngle},u_yHalfAngle:function(){return i._scanePlaneYHalfAngle},u_radius:function(){return i.radius},u_color:function(){return i.scanPlaneColor},u_showThroughEllipsoid:function(){return i.showThroughEllipsoid},u_showIntersection:function(){return i.showIntersection},u_intersectionColor:function(){return i.intersectionColor},u_intersectionWidth:function(){return i.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return i.lineColor}}}get color(){return this._color}set color(e){this._color=e,this._material.uniforms.color=e}get boundingSphere(){return this._boundingSphere}get xHalfAngle(){return If.toDegrees(this._xHalfAngle)}set xHalfAngle(e){this._xHalfAngle!==e&&(this._xHalfAngle=If.toRadians(e),this._createVS=!0)}get yHalfAngle(){return If.toDegrees(this._yHalfAngle)}set yHalfAngle(e){this._yHalfAngle!==e&&(this._yHalfAngle=If.toRadians(e),this._createVS=!0)}get radius(){return this._radius}set radius(e){this._radius!==e&&(this._radius=e,this._boundingSphere=new cf(Sf.ZERO,e),of.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),cf.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC))}get modelMatrix(){return this._modelMatrix}set modelMatrix(e){!of.equals(e,this._modelMatrix)&&(of.clone(e,this._modelMatrix),of.multiplyByUniformScale(this._modelMatrix,this._radius,this._computedModelMatrix),cf.transform(this._boundingSphere,this._modelMatrix,this._boundingSphereWC))}get showThroughEllipsoid(){return this._showThroughEllipsoid}set showThroughEllipsoid(e){this._showThroughEllipsoid!==e&&(this._showThroughEllipsoid=e,this._createRS=!0)}get material(){return this._material}set material(e){this._material=e,this._createRS=!0,this._createSP=!0}update(e){const i=e.mode;if(!this.show||i!==df.SCENE3D)return;const n=this._xHalfAngle,r=this._yHalfAngle;if(n<0||r<0)throw new t("halfAngle must be greater than or equal to zero.");if(0==n||0==r)return;if(this.radius<0)throw new t("this.radius must be greater than or equal to zero.");const o=this.showThroughEllipsoid,s=this.material,a=s.isTranslucent();if(this._translucent!==a&&(this._translucent=a,this._createRS=!0),this.showScanPlane){const t=e.time;let i,o,s=lf.secondsDifference(t,this._time);if(s<0&&(this._time=lf.clone(t,this._time)),this.speed<=0)i=0;else{const e=10/this.speed;i=Math.max(s%e/e,0)}const a=new pf;if("H"==this.scanPlaneMode){o=2*r*i-r;const e=Lf(o),t=Mf(n),s=Rf(e*t);this._scanePlaneXHalfAngle=s,this._scanePlaneYHalfAngle=o,pf.fromRotationX(this._scanePlaneYHalfAngle,a)}else{o=2*n*i-n;const e=Mf(r),t=Lf(o),s=Rf(t*e);this._scanePlaneXHalfAngle=o,this._scanePlaneYHalfAngle=s,pf.fromRotationY(this._scanePlaneXHalfAngle,a)}of.multiplyByMatrix3(this.modelMatrix,a,this._computedScanPlaneModelMatrix),of.multiplyByUniformScale(this._computedScanPlaneModelMatrix,this.radius,this._computedScanPlaneModelMatrix)}this._createVS&&function(e,t){const i=t.context,n=Ff(e,e._xHalfAngle,e._yHalfAngle),r=function(e,t){const i=e._xHalfAngle,n=e._yHalfAngle,r=t.zoy,o=t.zox,s=[],a=new pf;let l=pf.fromRotationY(i,a);return s.push(r.map((function(e){return pf.multiplyByVector(l,e,new Sf)}))),l=pf.fromRotationX(-n,a),s.push(o.map((function(e){return pf.multiplyByVector(l,e,new Sf)})).reverse()),l=pf.fromRotationY(-i,a),s.push(r.map((function(e){return pf.multiplyByVector(l,e,new Sf)})).reverse()),l=pf.fromRotationX(n,a),s.push(o.map((function(e){return pf.multiplyByVector(l,e,new Sf)}))),s}(e,n);e.showLateralSurfaces&&(e._sectorVA=function(e,t){const i=Array.prototype.concat.apply([],t).length-t.length,n=new Float32Array(18*i);let r=0;for(let e=0,i=t.length;e<i;e++){const i=t[e],o=new Sf,s=Sf.normalize(Sf.cross(i[0],i[i.length-1],o),o);for(let e=0,t=i.length-1;e<t;e++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z,n[r++]=i[e].x,n[r++]=i[e].y,n[r++]=i[e].z,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z,n[r++]=i[e+1].x,n[r++]=i[e+1].y,n[r++]=i[e+1].z,n[r++]=-s.x,n[r++]=-s.y,n[r++]=-s.z}const o=mf.createVertexBuffer({context:e,typedArray:n,usage:ff.STATIC_DRAW}),s=6*Float32Array.BYTES_PER_ELEMENT,a=[{index:Nf.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:yf.FLOAT,offsetInBytes:0,strideInBytes:s},{index:Nf.normal,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:yf.FLOAT,offsetInBytes:3*Float32Array.BYTES_PER_ELEMENT,strideInBytes:s}];return new gf({context:e,attributes:a})}(i,r));e.showSectorLines&&(e._sectorLineVA=function(e,t){const i=t.length,n=new Float32Array(9*i);let r=0;for(let e=0,i=t.length;e<i;e++){const i=t[e];n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=i[0].x,n[r++]=i[0].y,n[r++]=i[0].z}const o=mf.createVertexBuffer({context:e,typedArray:n,usage:ff.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:Nf.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:yf.FLOAT,offsetInBytes:0,strideInBytes:s}];return new gf({context:e,attributes:a})}(i,r));e.showSectorSegmentLines&&(e._sectorSegmentLineVA=function(e,t){const i=Array.prototype.concat.apply([],t).length-t.length,n=new Float32Array(9*i);let r=0;for(let e=0,i=t.length;e<i;e++){const i=t[e];for(let e=0,t=i.length-1;e<t;e++)n[r++]=i[e].x,n[r++]=i[e].y,n[r++]=i[e].z,n[r++]=i[e+1].x,n[r++]=i[e+1].y,n[r++]=i[e+1].z}const o=mf.createVertexBuffer({context:e,typedArray:n,usage:ff.STATIC_DRAW}),s=3*Float32Array.BYTES_PER_ELEMENT,a=[{index:Nf.position,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:yf.FLOAT,offsetInBytes:0,strideInBytes:s}];return new gf({context:e,attributes:a})}(i,r));e.showDomeSurfaces&&(e._domeVA=function(e){const t=Tf.createGeometry(new Tf({vertexFormat:_f.POSITION_ONLY,stackPartitions:32,slicePartitions:32}));return gf.fromGeometry({context:e,geometry:t,attributeLocations:Nf,bufferUsage:ff.STATIC_DRAW,interleave:!1})}(i));e.showDomeLines&&(e._domeLineVA=function(e){const t=Af.createGeometry(new Af({vertexFormat:_f.POSITION_ONLY,stackPartitions:32,slicePartitions:32}));return gf.fromGeometry({context:e,geometry:t,attributeLocations:Nf,bufferUsage:ff.STATIC_DRAW,interleave:!1})}(i));if(e.showScanPlane)if("H"==e.scanPlaneMode){const t=Ff(e,If.PI_OVER_TWO,0);e._scanPlaneVA=kf(i,t.zox)}else{const t=Ff(e,0,If.PI_OVER_TWO);e._scanPlaneVA=kf(i,t.zoy)}}(this,e),this._createRS&&function(e,t,i){i?(e._frontFaceRS=vf.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cf.ALPHA_BLEND,cull:{enabled:!0,face:bf.BACK}}),e._backFaceRS=vf.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cf.ALPHA_BLEND,cull:{enabled:!0,face:bf.FRONT}}),e._pickRS=vf.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cf.ALPHA_BLEND})):(e._frontFaceRS=vf.fromCache({depthTest:{enabled:!t},depthMask:!0}),e._pickRS=vf.fromCache({depthTest:{enabled:!0},depthMask:!0}))}(this,o,a),this._createSP&&function(e,t,i){(function(e,t,i){const n=t.context,r=rf,o=new Ef({sources:[tf,i.shaderSource,nf]});e._sp=Pf.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:Nf});const s=new Ef({sources:[tf,i.shaderSource,nf],pickColorQualifier:"uniform"});e._pickSP=Pf.replaceCache({context:n,shaderProgram:e._pickSP,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:Nf})})(e,t,i),e.showScanPlane&&function(e,t,i){const n=t.context,r=rf,o=new Ef({sources:[tf,i.shaderSource,ef]});e._scanePlaneSP=Pf.replaceCache({context:n,shaderProgram:e._scanePlaneSP,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:Nf})}(e,t,i)}(this,e,s),(this._createRS||this._createSP)&&function(e,t){e._colorCommands.length=0;const i=t?xf.TRANSLUCENT:xf.OPAQUE;e.showLateralSurfaces&&Of(e,e._sectorFrontCommand,e._sectorBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorVA,e._uniforms,e._computedModelMatrix,t,i);e.showSectorLines&&Of(e,e._sectorLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showSectorSegmentLines&&Of(e,e._sectorSegmentLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorSegmentLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showDomeSurfaces&&Of(e,e._domeFrontCommand,e._domeBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._domeVA,e._uniforms,e._computedModelMatrix,t,i);e.showDomeLines&&Of(e,e._domeLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._domeLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showScanPlane&&Of(e,e._scanPlaneFrontCommand,e._scanPlaneBackCommand,e._frontFaceRS,e._backFaceRS,e._scanePlaneSP,e._scanPlaneVA,e._scanUniforms,e._computedScanPlaneModelMatrix,t,i)}(this,a);const l=e.commandList,c=e.passes,u=this._colorCommands;if(c.render)for(let e=0,t=u.length;e<t;e++){const t=u[e];l.push(t)}}destroy(){this._pickSP.destroy(),this._sp=this._sp.destroy(),this._scanePlaneSP&&(this._scanePlaneSP=this._scanePlaneSP.destroy()),Gn(this)}},e.SatelliteScanGraphic=class extends Hn{constructor(e){if(e.path&&(e.position=e.path.position.getValue(viewer.clock.currentTime)),super(e),this._clampToGround=!1,!x(e.position))throw new t("参数options必须定义position或path属性。");const i=w.toCartographic(e.position,viewer);this._position=w.toCartesian(e.position),this._thickness=C(e.thickness,.3),this._slices=C(e.slices,20),this.speed=C(e.speed,.5),this._height=i.height,this._surface=Bh.fromRadians(i.longitude,i.latitude),this.radius=e.radius||.5*this._height,this._inverse=e.inverse||!1,this._animation=!x(e.animation)||e.animation,this._show=!x(e.show)||e.show,this._color=e.color,this.path=e.path,this._tracked=e.tracked||!1,this._rotation=e.rotation,this._axis=e.axis,this._matrix=Gh.multiplyByTranslation(Hh.eastNorthUpToFixedFrame(this._surface),new Bh(0,0,.5*this._height),new Gh),this.transform(this._rotation),this.image=e.image,this.model=e.model,this._primitive=new jh,this._primitive.name="SatelliteScan",this._loadEvent.addEventListener((()=>{this._viewer&&(this.stopAnimate=this._viewer.scene.preUpdate.addEventListener((()=>{Qh(this)})))})),this.createGraphic()}updateMatrix(e){e&&(this._matrix=e,this.scanPrimitive.modelMatrix=e,this.modelPrimitive&&(this.modelPrimitive.modelMatrix=e))}updatePrimitive(){this.createGraphic()}createGraphic(){if(this.model){const e=Wh.fromGltf({url:this.model,pixelOffset:new Cesium.Cartesian2(-10,10)});this.modelPrimitive=this.primitive.add(e)}if(this.image){const e=new Vh;this.primitive.add(e),this.imagePrimitive=e.add({image:this.image,position:this._position})}const e=new Uh({length:this._height,topRadius:0,bottomRadius:this.radius,vertextFormat:qh.MaterialSupport.TEXTURED.vertextFormat}),t=new $h({geometry:e}),i=this.getShaderSorce(),n=new Yh({fabric:{type:"satelliteMaterial",uniforms:{color:this._color||Xh.WHITE,repeat:this.slices,offset:0,thickness:this.thickness,sign:this.inverse?1:-1},source:i}}),r=new Jh({modelMatrix:this._matrix,show:this.show,geometryInstances:t,appearance:new qh({material:n}),asynchronous:!1});this.scanPrimitive=this.primitive.add(r),this.stopAnimate&&this.stopAnimate()}trackSatellite(){if(this._viewer)if(this._tracked){const e=new Cesium.BoundingSphere(this._position,this._height);this._viewer.camera.viewBoundingSphere(e),this._viewer.camera.lookAtTransform(this._matrix)}else this._viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY)}get inverse(){return this._inverse}set inverse(e){this._inverse=e,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.sign=e?1:-1)}get slices(){return this._slices}set slices(e){this._slices=e,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.repeat=e)}get thickness(){return this._thickness}set thickness(e){e<0&&(e=0),e>1&&(e=1),this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.thickness=e)}get rotation(){return this._rotation}set rotation(e){this._rotation=e,this.transform(e)}get axis(){return this._axis}get tracked(){return this._tracked}set tracked(e){e!==this._tracked&&(this._tracked=e,this.trackSatellite())}get color(){return this._color}set color(e){this._color=e,this.scanPrimitive&&(this.scanPrimitive.appearance.material.uniforms.color=e)}get animation(){return this._animation}set animation(e){e!==this._animation&&(e?this.stopAnimate=this._viewer.scene.preUpdate.addEventListener((()=>{Qh(this)})):(this.stopAnimate&&this.stopAnimate(),this.stopAnimate=void 0),this._animation=e)}getShaderSorce(){return"\n    uniform vec4 color;\n    uniform float repeat;\n    uniform float offset;\n    uniform float thickness;\n    uniform float sign;\n    czm_material czm_getMaterial(czm_materialInput inputM){\n      czm_material material=czm_getDefaultMaterial(inputM);\n      float sp=1.0/repeat;\n      vec2 st=inputM.st;\n      float dis=distance(st,vec2(0.5));\n      float m=mod(dis + sign * offset,sp);\n      float a=step(sp*(1.0-thickness),m);\n      material.diffuse=color.rgb;\n      material.alpha=a*color.a;\n      return material;\n    }"}zoomTo(e){if(!this.show||!this._viewer)return;const t=new Cesium.BoundingSphere(this._position,this._height);this._viewer.camera.flyToBoundingSphere(t,{duration:e})}transform(e){e&&(e.x&&Zh(this,e.x,new Bh(1,0,0)),e.y&&Zh(this,e.y,new Bh(0,1,0)),e.z&&Zh(this,e.z,new Bh(0,0,1)))}},e.Scene=Jc,e.SectorGeometry=class{constructor(e){if(!x((e=C(e,C.EMPTY_OBJECT)).center))throw new t("parameter center is required.");if(!x(e.radius))throw new t("parameter radius is required.");if(!x(e.fov))throw new t("parameter fov is required.");this._center=e.center,this._radius=e.radius,this._fov=e.fov,this._slices=C(e.slices,this._fov),this._rotation=Cesium.Math.toRadians(C(e.rotation,0)),this._vertexFormat=C(e.vertexFormat,zf.POSITION_AND_ST),this._extrudedHeight=C(e.extrudedHeight,0),this._height=C(e.height,0),this._positions=void 0,this._workerName="createSectorGeometry",this._rectangle=void 0}get center(){return this._center}get rotation(){return Cesium.Math.toDegrees(this._rotation)}get radius(){return this._radius}get fov(){return this._fov}get positions(){return this._positions}get vertexFormat(){return this._vertexFormat}get extrudedHeight(){return this._extrudedHeight}get height(){return this._height}get slices(){return this._slices}static createGeometry(e){const t=[],i=Cesium.Transforms.eastNorthUpToFixedFrame(e._center),n=e._fov/e._slices,r=e.rotation;e._vertexNumber=2*e.slices;const o=[],s=[],a=[];for(let s=0,l=e._slices;s<l;s++){const l=e._radius*Math.cos(Cesium.Math.toRadians(r+n*s)),c=e._radius*Math.sin(Cesium.Math.toRadians(r+n*s)),u=new Cesium.Cartesian3(l,c,0),h=new Cesium.Cartesian3;Cesium.Matrix4.multiplyByPoint(i,u,h),t.push(h.x,h.y,h.z),o.push(.5*Math.cos(Cesium.Math.toRadians(r+n*s))+.5),o.push(.5*Math.sin(Cesium.Math.toRadians(r+n*s))+.5),a.push(0,0,1)}a.push(0,0,1),o.push(.5,.5),t.push(e.center.x,e.center.y,e.center.z);const l=t.length/3-1;0!==e.height&&Cesium.PolygonPipeline.scaleToGeodeticHeight(t,e.height,Cesium.Ellipsoid.WGS84,!1);for(let t=0;t<e._slices-1;t++)s.push(t),s.push(l),s.push(t+1);const c={position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:new Float64Array(t)})};return e.vertexFormat.normal&&(c.normal=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:a})),e.vertexFormat.st&&(c.st=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:o})),new Cesium.Geometry({attributes:c,indices:Cesium.IndexDatatype.createTypedArray(e._vertexNumber,s),primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:Cesium.BoundingSphere.fromVertices(t)})}},e.Selection=Hr,e.ShaderProgram=bc,e.ShapefileDataSource=Ha,e.SnowEffect=class extends Km{constructor(e){super(e),this._fragmentShader=C(this._options.fragmentShader,Bf),this._thickness=C(this._options.thickness,.5),this._density=C(this._options.density,10),this._speed=C(this._options.speed,350);const t={alpha:()=>this.thickness,snowDensity:()=>this.density,speed:()=>this.speed};this._uniforms=C(this._options.uniforms,t)}get thickness(){return Cesium.Math.clamp(this._thickness,0,1)}set thickness(e){this._thickness=e}get density(){return Cesium.Math.clamp(this._density,0,20)}set density(e){this._density=e}get speed(){const e=this._speed;return 10+Cesium.Math.clamp(390-e,0,390)}set speed(e){this._speed=e}createPostStage(){return new Cesium.PostProcessStage({fragmentShader:this._fragmentShader,uniforms:this._uniforms})}},e.SplitDirection=Wr,e.TDTLayer=class extends sd{constructor(e){const t=(e=C(e,{})).key;t||(console.warn("未定义key，地图服务将不可用"),console.warn("请前往http://lbs.tianditu.gov.cn/server/MapService.html获取地图key"));const i=C(e.tilingScheme,new Cesium.WebMercatorTilingScheme);let n="w",r="w",o=e.tileMatrixLabels;i instanceof Cesium.GeographicTilingScheme&&(n="c",r="c",x(o)||(o=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"]));const s=C(e.layer,"img"),a=`http://t{s}.tianditu.com/${s}_${n}/wmts?service=wmts&tileMatrixSet=${r}&request=GetTile&version=1.0.0&LAYER=${s}&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=${t}`;return new Cesium.WebMapTileServiceImageryProvider({url:a,layer:s,style:e.style||"default",format:e.format||"tiles",tileMatrixSetID:"GoogleMapsCompatible",credit:e.credit?new Cesium.Credit(e.credit||""):null,tilingScheme:e.tilingScheme,maximumLevel:e.maximumLevel||19,minimumLevel:e.minimumLevel||0,tileMatrixLabels:o,subdomains:"01234567"})}static layers=[{layer:"vec",desc:"矢量底图"},{layer:"cva",desc:"矢量注记"},{layer:"img",desc:"影像底图"},{layer:"cia",desc:"影像注记"},{layer:"ter",desc:"地形晕渲"},{layer:"cta",desc:"地形注记"},{layer:"ibo",desc:"全球境界"},{layer:"eva",desc:"矢量英文注记"},{layer:"eia",desc:"影像英文注记"}]},e.TMSLayer=ud,e.TaskProcessor=class{constructor(e,t={}){this._workers=[],this._workerPath="workers/"+e,this._options=t,Math.max(be.hardwareConcurrency-1,1),this._worker=Ee(this)}},e.TecentLayer=class extends Lo{constructor(e={}){e.layer=C(e.layer,"img"),e.subdomains="123",e.url=ad[e.layer],e.customTags={sx:function(e,t,i,n){return t>>4},sy:function(e,t,i,n){return(1<<n)-i>>4}},super(e)}},e.TileDebugLayer=class{constructor(e={}){e.tileWidth=C(e.tileWidth,256),e.tileHeight=C(e.tileHeight,256),this._tilingScheme=x(e.tilingScheme)?e.tilingScheme:Fr.get("EPSG:4326",{ellipsoid:e.ellipsoid}),this._errorEvent=new I,this._tileWidth=C(e.tileWidth,256),this._tileHeight=C(e.tileHeight,256),this._readyPromise=Promise.resolve(!0),this._font=C(e.font,"bold 24px sans-serif"),this._color=C(e.color,new Cesium.Color(1,1,1,1)),this._borderColor=C(e.borderColor,Cesium.Color.GOLD),this._borderWidth=C(e.borderWidth,2)}get ready(){return!0}get readyPromise(){return this._readyPromise}get hasAlphaChannel(){return!0}get errorEvent(){return this._errorEvent}get rectangle(){return this._tilingScheme.rectangle}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get tilingScheme(){return this._tilingScheme}get font(){return this._font}set font(e){this._font=e}get color(){return this._color}set color(e){this._color=e}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get borderWidth(){return this._borderWidth}createCanvas(){const e=document.createElement("canvas");e.width=this.tileWidth,e.height=this.tileHeight;const t=e.getContext("2d");return t.textBaseline="middle",t.textAlign="center",t.font=this.font,t.fillStyle=ld(this.color),t.strokeStyle=ld(this.color),t.lineWidth=this.borderWidth,{canvas:e,ctx:t}}requestImage(e,t,i,n){const{canvas:r,ctx:o}=this.createCanvas(),s=function(e,t,i,n){let r=[];return r[0]="L: "+n,r[1]="X: "+t,e.reverseY?r[2]="Y: "+e.tilingScheme.getNumberOfYTilesAtLevel(n)-i-1:r[2]="Y: "+i,r}(this,e,t,i);return o.fillText(s[0],r.width/2,r.height/4*1),o.fillText(s[1],r.width/2,r.height/4*2),o.fillText(s[2],r.width/2,r.height/4*3),o.strokeRect(0,0,r.width,r.height),Promise.resolve(r)}},e.TileLayer=class{constructor(e={}){this._errorEvent=new I,this._tilingScheme=Fr.get("EPSG:4326"),this._ready=!1,this._ready=!0,this._minimumLevel=C(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._tileWidth=C(e.tileWidth,256),this._tileHeight=C(e.tileHeight,256),this._rectangle=C(e.rectangle,cd.MAX_VALUE),this._readyPromise=Promise.resolve(!0),this._errorEvent.addEventListener(((e,t,i)=>{}))}get errorEvent(){return this._errorEvent}get minimumLevel(){return this._minimumLevel}get maximumLevel(){return this._maximumLevel}get errorEvent(){return this._errorEvent}get rectangle(){return this._rectangle}get ready(){return this._ready}get readyPromise(){return this._readyPromise}get tilingScheme(){return this._tilingScheme}get enablePickFeatures(){return this._tileProvider.enablePickFeatures}set enablePickFeatures(e){this._tileProvider.enablePickFeatures=e}get tileHeight(){return this._tileHeight}get tileWidth(){return this._tileWidth}pickFeatures(e,t,i,n,r){}requestImage(e,t,i,n){return this.requestGeometry(e,t,i),Promise.reject(!1)}requestGeometry(e,t,i){}},e.Tileset=Qa,e.TransformHelper=class{constructor(e={}){this.lineWidth=Zr(e.lineWidth,15),this.xAxisColor=Zr(e.xAxisColor,Jr.RED),this.yAxisColor=Zr(e.yAxisColor,Jr.GREEN),this.zAxisColor=Zr(e.zAxisColor,Jr.BLUE),this.scaleAxisColor=Zr(e.scaleAxisColor,Jr.WHITE),this.activeAxisColor=Zr(e.activeAxisColor,Jr.YELLOW),this._translateEnabled=Zr(e.translateEnabled,!0),this._rotateEnabled=Zr(e.rotateEnabled,!1),this._scaleEnabled=Zr(e.scaleEnabled,!1),this.xAxisLength=e.xAxisLength,this.yAxisLength=e.yAxisLength,this.zAxisLength=e.zAxisLength,this.scaleAxisLength=e.scaleAxisLength,this.root=new $r,this.object=null,this._modelMatrix=void 0,this._primitives=[],this._center=new Qr,this._radius=0,this._originOffset=Zr(e.originOffset,new Qr),this._selectedPrimitives=[],this._offset=new Qr(0,0,0),this._angle=0,this.rotatePlaneRadius=e.rotatePlaneRadius,this._mode=To,this.preTranformEvent=new I,this.postTransformEvent=new I}get translateEnabled(){return this._translateEnabled}set translateEnabled(e){this._translateEnabled=e;for(let t of this._primitives){const i=t.axis;i&&(i.includes(Eo)||i.includes(Po)||(t.show=e))}}get rotateEnabled(){return this._rotateEnabled}set rotateEnabled(e){this._rotateEnabled=e;for(let t of this._primitives){const i=t.axis;i&&(i.includes(Eo)&&(t.show=e))}}get scaleEnabled(){return this._scaleEnabled}set scaleEnabled(e){this._scaleEnabled=e;for(let t of this._primitives){const i=t.axis;i&&(i.includes(Po)&&(t.show=e))}}get center(){return Qr.add(this._center,this._originOffset,new Qr)}get modelMatrix(){return this._modelMatrix}set modelMatrix(e){if(!e)return this._modelMatrix=void 0,void(this._inverseModelMatrix=void 0);this._modelMatrix=e,this._inverseModelMatrix=eo.inverse(e,new eo)}createMoveAxis(){if(!this.center)return;const e=1.3*this._radius,t=this.axisRoot,i=this.center;this.xAxis=t.add({positions:[i,new Qr(Zr(this.xAxisLength,e)+i.x,i.y,i.z)],width:this.lineWidth,material:this.getAxisMaterial(this.xAxisColor)}),this.xAux=t.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.xAxis.axis="X",this.xAxis.color=this.xAxisColor,this.yAxis=t.add({positions:[i,new Qr(i.x,-(Zr(this.yAxisLength,e)+i.y),i.z)],width:this.lineWidth,material:this.getAxisMaterial(this.yAxisColor)}),this.yAux=t.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.yAxis.axis="Y",this.yAxis.color=this.yAxisColor,this.zAxis=t.add({positions:[i,new Qr(i.x,i.y,Zr(this.zAxisLength,e)+i.z)],width:this.lineWidth,material:this.getAxisMaterial(this.zAxisColor)}),this.zAux=t.add({positions:[],width:this.lineWidth,material:this.getAxisMaterial(this.activeAxisColor,!0)}),this.zAxis.axis="Z",this.zAxis.color=this.zAxisColor,this._primitives.push(this.xAxis,this.yAxis,this.zAxis)}createAxisPlane(){this.XOYPlane=this.root.add(new v({color:this.zAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new Qr(0,0,1),axis:"XY"})),this.XOYPlane.relativeAxis=[this.xAxis,this.yAxis],this.XOZPlane=this.root.add(new v({color:this.yAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new Qr(0,1,0),axis:"XZ"})),this.XOZPlane.relativeAxis=[this.xAxis,this.zAxis],this.YOZPlane=this.root.add(new v({color:this.xAxisColor,modelMatrix:this.modelMatrix,center:this.center,radius:this._radius,normal:new Qr(1,0,0),axis:"YZ"})),this.YOZPlane.relativeAxis=[this.yAxis,this.zAxis],this._primitives.push(this.XOYPlane,this.YOZPlane,this.XOZPlane)}createOrignPoint(){const e=new no({modelMatrix:this.modelMatrix});this.origin=e.add({show:!0,position:this.center,pixelSize:1.5*this.lineWidth,color:Cesium.Color.WHITE}),this.root.add(e),this._primitives.push(this.origin)}getAxisMaterial(e,t=!1,i=16){return new Xr(t?{fabric:{type:"dasharrow",source:Ur,uniforms:{color:e,gapColor:Jr.TRANSPARENT,dashLength:i,dashPattern:255}}}:{fabric:{type:"PolylineArrow",uniforms:{color:e}}})}createRotateAxis(){const e=[],t=this.rotatePlaneRadius||this._radius,i=this.center;for(let n=0;n<=360;n++){const r=n/180*Math.PI;e.push(new Qr(i.x+t*Math.cos(r),i.y+t*Math.sin(r),i.z))}this.zRotate=this.axisRoot.add({positions:[...e],width:this.lineWidth,material:this.getAxisMaterial(this.zAxisColor,!0,0)}),this.zRotate.axis="RZ",this.zRotate.color=this.zAxisColor,this.zRotate.normal=new Qr(0,0,1),e.splice(0);for(let n=0;n<=360;n++){const r=n/180*Math.PI;e.push(new Qr(i.x+t*Math.cos(r),i.y,i.z+t*Math.sin(r)))}this.yRotate=this.axisRoot.add({positions:[...e],width:this.lineWidth,material:this.getAxisMaterial(this.yAxisColor,!0,0)}),this.yRotate.axis="RY",this.yRotate.color=this.yAxisColor,this.yRotate.normal=new Qr(0,1,0),e.splice(0);for(let n=0;n<=360;n++){const r=n/180*Math.PI;e.push(new Qr(i.x,i.y+t*Math.cos(r),i.z+t*Math.sin(r)))}this.xRotate=this.axisRoot.add({positions:[...e],width:this.lineWidth,material:this.getAxisMaterial(this.xAxisColor,!0,0)}),this.xRotate.axis="RX",this.xRotate.color=this.xAxisColor,this.xRotate.normal=new Qr(-1,0,0),this.rAxuStart=this.axisRoot.add({positions:[],width:this.lineWidth/2,material:this.getAxisMaterial(this.activeAxisColor,!0,0)}),this.rAxuEnd=this.axisRoot.add({positions:[],width:this.lineWidth/2,material:this.getAxisMaterial(this.activeAxisColor,!0,0)}),this._primitives.push(this.xRotate,this.yRotate,this.zRotate,this.rAxuStart,this.rAxuEnd)}createScaleAxis(){const e=1.1*this._radius,t=Zr(this.scaleAxisLength,e),i=Math.sqrt(3);this.scaleAxis=this.axisRoot.add({positions:[this._center,new Qr((t+this._center.x)/i,-(t+this._center.y)/i,(t+this._center.z)/i)],width:this.lineWidth,material:this.getAxisMaterial(this.scaleAxisColor)}),this._primitives.push(this.scaleAxis),this.scaleAxis.axis="SXYZ",this.scaleAxis.color=this.scaleAxisColor}bind(e){this._viewer&&(this.unbind(),e instanceof qr&&(e=e.delegate),this.object=e,e instanceof uo!=!1?(this.modelMatrix=e.modelMatrix,e.readyPromise.then((()=>{const t=Qr.clone(e.boundingSphere.center);eo.multiplyByPoint(this._inverseModelMatrix,t,this._center),this._radius=e.boundingSphere.radius,this.createPrimitive()}))):this.bindPosition(e))}bindPosition(e){if(e instanceof Cesium.Property&&(e=e.getValue(this._viewer.clock.currentTime)),e instanceof Qr==!1)throw new t("position is invalid");this.modelMatrix=po.eastNorthUpToFixedFrame(e),this._center=new Qr,Qr.clone(this.originOffset,this._center),this._radius=10,this.createPrimitive()}createPrimitive(e=!0){const t=new Yr({modelMatrix:this.modelMatrix});this.axisRoot=t,this.root.add(t),this.createOrignPoint(),this.translateEnabled&&this.createMoveAxis(),this.translateEnabled&&this.createAxisPlane(),e&&this.rotateEnabled&&this.createRotateAxis(),e&&this.scaleEnabled&&this.createScaleAxis()}unbind(){this.object=void 0,this.root.removeAll(),this.origon=void 0,this.xAxis=void 0,this.yAxis=void 0,this.zAxis=void 0,this.modelMatrix=void 0}addTo(e){this._viewer=e,e.scene.primitives.add(this.root),this.addEventListener()}addEventListener(){const e=this._viewer,t=new ro(e.canvas);t.setInputAction((i=>{const n=e.scene.pick(i.position);n&&this._primitives.includes(n.primitive)&&(this._mousedownPixel=i.position,this.active(n.primitive),this._offset=new Qr,this._angle=0,t.setInputAction((e=>{const{startPosition:t,endPosition:i}=e;this.transform(t,i)}),oo.MOUSE_MOVE),e.scene.screenSpaceCameraController.enableRotate=!1)}),oo.LEFT_DOWN),t.setInputAction((i=>{this.active(null),t.removeInputAction(oo.MOUSE_MOVE),e.scene.screenSpaceCameraController.enableRotate=!0,this.translateEnabled&&(this.xAux.positions=[],this.yAux.positions=[],this.zAux.positions=[]),this.rotateEnabled&&(this.rAxuStart.positions=[],this.rAxuEnd.positions=[])}),oo.LEFT_UP),this._removeEventListener=function(){t.removeInputAction(oo.LEFT_DOWN),t.removeInputAction(oo.LEFT_UP)}}active(e){if(e||this.activePrimitive){if(!e&&this.activePrimitive){if(Co(this.activePrimitive,this.activePrimitive.color),this.activePrimitive.isAxisPlane)for(let e of this.activePrimitive.relativeAxis)Co(e,e.color);return this.activePrimitive=void 0,void(this._mode=To)}if(e.isAxisPlane)for(let t of e.relativeAxis)Co(t,this.activeAxisColor);if(this.activePrimitive=e,Co(this.activePrimitive,this.activeAxisColor),e.axis)if(e.axis.includes("R")){this._mode=Eo;const e=xo(this._mousedownPixel,helper);this.rAxuStart.positions=[this.center,e],this._startLocalPosition=e}else e.axis.includes("S")?this._mode=Po:this._mode=Ao}}remove(){this._viewer.scene.primitives.remove(this.root),this._removeEventListener(),this._primitives.splice(0)}transform(e,t){if(this.preTranformEvent.raise(this.modelMatrix),this._mode===Ao)So(this,e,t,mo),this.translate(mo);else if(this._mode===Eo){const i=function(e,t,i){const n=e.center;Qr.subtract(t,n,t),Qr.subtract(i,n,i);const r=Qr.dot(Qr.normalize(t,t),Qr.normalize(i,i)),o=Qr.subtract(t,i,_o),s=t,a=Qr.cross(o,s,_o),l=e.activePrimitive.normal,c=lo.sign(Qr.dot(a,l));return Math.acos(r)*c}(this,xo(e,this),xo(t,this));this.rotate(i)}else if(this._mode=Po){So(this,e,t,mo);const i=-mo.sxyz/Qr.distance(...this.scaleAxis.positions)+1;this.scale(new Qr(i,i,i))}this.postTransformEvent.raise(this.modelMatrix)}scale(e){const t=eo.fromScale(e,yo);eo.multiply(this._modelMatrix,t,this._modelMatrix),this.modelMatrix=this._modelMatrix;for(let e of this.root._primitives)eo.multiply(e.modelMatrix,t,e.modelMatrix)}rotate(e){this._angle+=e;const t=this.activePrimitive.normal,i=eo.fromTranslation(this.center,yo),n=io.fromAxisAngle(t,e,fo),r=to.fromQuaternion(n,go),o=eo.fromTranslation(Qr.negate(this.center,_o),vo);eo.multiply(this.modelMatrix,i,this.modelMatrix),eo.multiplyByMatrix3(this.modelMatrix,r,this.modelMatrix),eo.multiply(this.modelMatrix,o,this.modelMatrix);for(let e of this.root._primitives)eo.multiply(e.modelMatrix,i,e.modelMatrix),eo.multiplyByMatrix3(e.modelMatrix,r,e.modelMatrix),eo.multiply(e.modelMatrix,o,e.modelMatrix);this.modelMatrix=this._modelMatrix,this.createRotateAux(this._startLocalPosition,this._angle)}translate(e){if(!this.activePrimitive)return;const t=this.activePrimitive.axis;-1===t.indexOf("X")&&(e.x=0),-1===t.indexOf("Y")&&(e.y=0),-1===t.indexOf("Z")&&(e.z=0),e.x=-e.x,e.z=-e.z,Qr.add(this._offset,e,this._offset);const i=eo.fromTranslation(e);eo.multiply(this._modelMatrix,i,this._modelMatrix),this.modelMatrix=this._modelMatrix;for(let e of this.root._primitives)eo.multiply(e.modelMatrix,i,e.modelMatrix);this.createAux(this._offset,i)}createAux(e){if(e.x>0){const t=Qr.clone(this.xAxis.positions[0]),i=Qr.clone(this.xAxis.positions[0]);i.x+=-e.x,this.xAux.positions=[t,i]}else{const t=Qr.clone(this.xAxis.positions[1]),i=Qr.clone(this.xAxis.positions[1]);i.x+=-e.x,this.xAux.positions=[t,i]}if(e.y<0){const t=Qr.clone(this.yAxis.positions[0]),i=Qr.clone(this.yAxis.positions[0]);i.y+=-e.y,this.yAux.positions=[t,i]}else{const t=Qr.clone(this.yAxis.positions[1]),i=Qr.clone(this.yAxis.positions[1]);i.y+=-e.y,this.yAux.positions=[t,i]}if(e.z>0){const t=Qr.clone(this.zAxis.positions[0]),i=Qr.clone(this.zAxis.positions[0]);i.z+=-e.z,this.zAux.positions=[t,i]}else{const t=Qr.clone(this.zAxis.positions[1]),i=Qr.clone(this.zAxis.positions[1]);i.z+=-e.z,this.zAux.positions=[t,i]}}createRotateAux(e,t){if(!this._startLocalPosition)return;const i=io.fromAxisAngle(this.activePrimitive.normal,-t),n=to.fromQuaternion(i,go),r=eo.fromRotation(n,yo);let o=Qr.subtract(e,this.center,_o);eo.multiplyByPoint(r,o,o),Qr.add(this.center,o,o),this.rAxuEnd.positions=[this.center,o]}},e.Url=we,e.VERSION="1.1.1",e.VectorTileProvider=bl,e.Viewer=Iu,e.WFSLayer=hu,e.WMSLayer=hd,e.WMTSLayer=sd,e.WindField=class{constructor(e,t){const i={};i.speedFactor=C(t.speedFactor,1),i.lineWidth=C(t.lineWidth,4),i.dropRateBump=C(t.dropRateBump,.01),i.dropRate=C(t.dropRate,.003),i.particlesTextureSize=Math.ceil(Math.sqrt(C(t.maxParticles,4096))),i.maxParticles=i.particlesTextureSize*i.particlesTextureSize,i.fadeOpacity=C(t.fadeOpacity,.996),i.particleHeight=C(t.particleHeight,100),i.color=C(t.color,bg.WHITE),this._maxParticles=i.maxParticles,this._color=C(t.color,"#FFFFFF"),this.viewer=e,this.scene=this.viewer.scene,this.camera=this.viewer.camera,this.options=i,this.viewerParameters={lonRange:new vg,latRange:new vg,pixelSize:0},this.globeBoundingSphere=new xg(Cg.ZERO,6314355.63),this.updateViewerParameters(),this.imageryLayers=this.viewer.imageryLayers,this.primitives=new wg,this.viewer.scene.primitives.add(this.primitives)}get fadeOpacity(){return this.particleSystem.userInput.fadeOpacity}set fadeOpacity(e){this.particleSystem.userInput.fadeOpacity=e}get particleHeight(){return this.particleSystem.userInput.particleHeight}set particleHeight(e){this.particleSystem.userInput.particleHeight=e}get color(){return this.particleSystem.userInput.color}set color(e){this.particleSystem.userInput.color=e}get maxParticles(){return this._maxParticles}set maxParticles(e){this._maxParticles=e;const t=this.particleSystem.userInput.maxParticles!==e,i=Math.ceil(Math.sqrt(e));this.particleSystem.userInput.particlesTextureSize=i,this.particleSystem.userInput.maxParticles=i*i,this.particleSystem.refreshParticles(t)}get show(){return this.primitives.show}set show(e){this.primitives.show=e}get speedFactor(){return this.particleSystem.userInput.speedFactor}set speedFactor(e){this.particleSystem.userInput.speedFactor=e}get lineWidth(){return this.particleSystem.userInput.lineWidth}set lineWidth(e){this.particleSystem.userInput.lineWidth=e}loadDataFromNC(e){mg.loadData(e).then((e=>{this.loadDataFromJson(e)}))}loadDataFromJson(e){this.particleSystem=new yg(this.scene.context,e,this.options,this.viewerParameters),this.addPrimitives(),this.setupEventListeners()}remove(){this.viewer.scene.primitives.remove(this.primitives)}addPrimitives(){const e=this.primitives;e.add(this.particleSystem.particlesComputing.primitives.calculateSpeed),e.add(this.particleSystem.particlesComputing.primitives.updatePosition),e.add(this.particleSystem.particlesComputing.primitives.postProcessingPosition),e.add(this.particleSystem.particlesRendering.primitives.segments),e.add(this.particleSystem.particlesRendering.primitives.trails),e.add(this.particleSystem.particlesRendering.primitives.screen)}updateViewerParameters(){const e=this.camera.computeViewRectangle(this.scene.globe.ellipsoid),t=fg.viewRectangleToLonLatRange(e);this.viewerParameters.lonRange.x=t.lon.min,this.viewerParameters.lonRange.y=t.lon.max,this.viewerParameters.latRange.x=t.lat.min,this.viewerParameters.latRange.y=t.lat.max;const i=this.camera.getPixelSize(this.globeBoundingSphere,this.scene.drawingBufferWidth,this.scene.drawingBufferHeight);i>0&&(this.viewerParameters.pixelSize=i)}setupEventListeners(){const e=this,t=this.camera.moveStart.addEventListener((function(){console.log("xxxxxxxxxxx"),e.primitives.show=!1})),i=this.camera.moveEnd.addEventListener((function(){e.updateViewerParameters(),e.particleSystem.applyViewerParameters(e.viewerParameters),e.primitives.show=!0}));let n=!1;function r(){n=!0,e.primitives.show=!1,e.primitives.removeAll()}window.addEventListener("resize",r);const o=this.scene.preRender.addEventListener((function(){n&&(e.particleSystem.canvasResize(e.scene.context),n=!1,e.addPrimitives(),e.scene.primitives.show=!0)}));this.removeEventListener=function(){t(),i(),o(),window.removeEventListener("resize",r)}}destroy(){this.remove(),this.removeEventListener&&this.removeEventListener(),Gn(this)}},e.XYZLayer=Lo,e._shaderBloom="\n#define NUM_MIPS 5\nvarying vec2 v_textureCoordinates;\nuniform sampler2D blurTexture1;\nuniform sampler2D blurTexture2;\nuniform sampler2D blurTexture3;\nuniform sampler2D blurTexture4;\nuniform sampler2D blurTexture5;\nuniform sampler2D colorTexture;\nuniform float bloomStrength;\nuniform float bloomRadius;\nuniform float bloomFactors[NUM_MIPS];\nuniform vec3 bloomTintColors[NUM_MIPS];\nfloat lerpBloomFactor(const in float factor){\n  float mirrorFactor=1.2-factor;\n  return mix(factor,mirrorFactor,bloomRadius);\n}\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  gl_FragColor=bloomStrength*(\n    lerpBloomFactor(bloomFactors[0])*vec4(bloomTintColors[0],1.0)*texture2D(blurTexture1,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[1])*vec4(bloomTintColors[1],1.0)*texture2D(blurTexture2,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[2])*vec4(bloomTintColors[2],1.0)*texture2D(blurTexture3,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[3])*vec4(bloomTintColors[3],1.0)*texture2D(blurTexture4,v_textureCoordinates)+\n    lerpBloomFactor(bloomFactors[4])*vec4(bloomTintColors[4],1.0)*texture2D(blurTexture5,v_textureCoordinates)\n  )+color;\n}",e._shaderBuildUniforms=Mg,e._shaderCircleScan=Wu,e._shaderCircleSpread=Vu,e._shaderDynamicConeMaterial=Yu,e._shaderDynamicSpreadMaterial=_p,e._shaderDynamicSpreadWallMaterial=pp,e._shaderDynamicWaveMaterial=xp,e._shaderEllipsoid=Ag,e._shaderFlowImage=Xm,e._shaderFog="\nfloat getDistance(sampler2D depthTexture, vec2 texCoords)\n{\n  float depth = czm_unpackDepth(texture2D(depthTexture, texCoords));\n  if (depth == 0.0) {\n      return czm_infinity;\n  }\n      vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depth);\n  return -eyeCoordinate.z / eyeCoordinate.w;\n}\nfloat interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n  float startDistance = nearFarScalar.x;\n  float startValue = 1.0-nearFarScalar.y;\n  float endDistance = nearFarScalar.z;\n  float endValue = 1.0-nearFarScalar.w;\n  float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n  return mix(startValue, endValue, t);\n}\nvec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)\n{\n  return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);\n}\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform vec4 fogByDistance;\nuniform vec4 fogColor;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\n    float distance = getDistance(depthTexture, v_textureCoordinates);\n    vec4 sceneColor = texture2D(colorTexture, v_textureCoordinates);\n    float blendAmount = interpolateByDistance(fogByDistance, distance);\n    vec4 finalFogColor = vec4(fogColor.rgb, fogColor.a * blendAmount);\n    gl_FragColor = alphaBlend(finalFogColor, sceneColor);\n} ",e._shaderGetDepth=Tg,e._shaderGetWgs84EllipsoidEC=Eg,e._shaderGlobeFS=Sl,e._shaderGroundSkyBoxFS=Vn,e._shaderGroundSkyBoxVS=qn,e._shaderPhong=Lg,e._shaderPolylineAntialiasingMaterial=Ur,e._shaderPolylineFlowMaterial=Lp,e._shaderPolylineTrailLinkMaterial=Fp,e._shaderRadarScan=Fh,e._shaderRain="\nuniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nuniform float speed;\nuniform float angle;\nfloat hash(float x){\n    return fract(sin(x*133.3)*13.13);\n}\n\nvoid main(void){\n\n    float time = czm_frameNumber / speed;\n    vec2 resolution = czm_viewport.zw;\n\n    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n    vec3 c=vec3(.6,.7,.8);\n    //方向\n    float a=angle;\n    float si=sin(a),co=cos(a);\n    uv*=mat2(co,-si,si,co);\n    uv*=length(uv+vec2(0,4.9))*.3+1.;\n\n    float v=1.-sin(hash(floor(uv.x*100.))*2.);\n    float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;\n    c*=v*b;\n\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5);\n}",e._shaderRectangularSensorComm=tf,e._shaderRectangularSensorFS=nf,e._shaderRectangularSensorScanPlaneFS=ef,e._shaderRectangularSensorVS=rf,e._shaderSelected="\nuniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  if(czm_selected()){\n    gl_FragColor=color;\n  }else{\n    gl_FragColor=vec4(0.0);\n  }\n}\n",e._shaderSeperableBlur="\nuniform sampler2D colorTexture;\nuniform vec2 direction;\nuniform float scale;\nuniform float bloomRadius;\nfloat gaussianPdf(in float x, in float sigma) {\n  return 0.39894 * exp(-0.5 * x * x/(sigma * sigma))/sigma;\n}\nvoid main(){\n  vec4 color=texture2D(colorTexture,v_textureCoordinates);\n  float fSigma=float(SIGMA);\n  vec2 size=vec2(czm_viewport.z,czm_viewport.w)*scale*fSigma*2.0;\n  vec2 invSize=(1.0+bloomRadius)/size;\n  float weightSum=gaussianPdf(0.0,fSigma);\n  vec3 diffuseSum=texture2D(colorTexture,v_textureCoordinates).rgb*weightSum;\n  bool selected=false;\n  for(int i=0;i<KERNEL_RADIUS;i++){\n    float x=float(i);\n    float w=gaussianPdf(x,fSigma);\n    vec2 uvOffset=direction*invSize*x;\n    vec3 sample1=texture2D(colorTexture,v_textureCoordinates+uvOffset).rgb;\n    vec3 sample2=texture2D(colorTexture,v_textureCoordinates-uvOffset).rgb;\n    diffuseSum+=(sample1+sample2)*w;\n    weightSum+=2.0*w;\n  }\n  gl_FragColor=vec4(diffuseSum/weightSum,2.0);\n}\n",e._shaderSnow=Bf,e._shaderSpecularReflection="\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nvec4 toEye(in vec2 uv, in float depth){\n    vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n    vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n    posInCamera =posInCamera / posInCamera.w;\n    return posInCamera;\n}\nfloat getDepth(in vec4 depth){\n    float z_window = czm_unpackDepth(depth);\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\nvec3 guussColor(vec2 uv){\n    vec2 pixelSize = 1.0 / czm_viewport.zw;\n    float dx0 = -pixelSize.x;\n    float dy0 = -pixelSize.y;\n    float dx1 = pixelSize.x;\n    float dy1 = pixelSize.y;\n    vec4 gc = (\n        texture2D(colorTexture, uv)+\n        texture2D(colorTexture, uv + vec2(dx0, dy0)) +\n        texture2D(colorTexture, uv + vec2(0.0, dy0)) +\n        texture2D(colorTexture, uv + vec2(dx1, dy0)) +\n        texture2D(colorTexture, uv + vec2(dx0, 0.0)) +\n        texture2D(colorTexture, uv + vec2(dx1, 0.0)) +\n        texture2D(colorTexture, uv + vec2(dx0, dy1)) +\n        texture2D(colorTexture, uv + vec2(0.0, dy1)) +\n        texture2D(colorTexture, uv + vec2(dx1, dy1))\n    ) * (1.0 / 9.0);\n    return gc.rgb;\n}\nvoid main(){\n    float offset = 0.0;\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    vec4 currD = texture2D(depthTexture, v_textureCoordinates);\n    if(currD.r>=1.0){\n        gl_FragColor = color;\n        return;\n    }\n    float depth = getDepth(currD);\n\n    vec4 positionEC = toEye(v_textureCoordinates, depth);\n    vec3 dx = dFdx(positionEC.xyz);\n    vec3 dy = dFdy(positionEC.xyz);\n    vec3 normal = normalize(cross(dx,dy));\n    vec4 positionWC = normalize(czm_inverseView * positionEC);\n    vec3 normalWC = normalize(czm_inverseViewRotation * normal);\n    float fotNumWC = dot(positionWC.xyz,normalWC);\n    if(fotNumWC<=0.5){\n        gl_FragColor = color;\n        return;\n    }\n\n    vec3 viewDir = normalize(positionEC.xyz);\n    vec3 reflectDir = reflect(viewDir, normal);\n    // vec3 viewReflectDir = czm_viewRotation * reflectDir;\n    vec3 viewReflectDir = reflectDir;\n\n\n    float step = 0.05;\n    int stepNum = int(20.0 / step);\n    vec3 pos;\n    vec3 albedo;\n    bool jd = false;\n    for(int i = 1;i <= 400;i++)\n    {\n        float delta = step * float(i) + offset;\n        pos = positionEC.xyz + viewReflectDir * delta;\n        float d = -pos.z;\n\n        vec4 tmp = czm_projection * vec4(pos,1.0);\n        vec3 screenPos = tmp.xyz / tmp.w;\n        vec2 uv = vec2(screenPos.x, screenPos.y) * 0.5 + vec2(0.5, 0.5);\n\n        if(uv.x > 0.0 && uv.x < 1.0 && uv.y > 0.0 && uv.y < 1.0){\n            float dd = getDepth(texture2D(depthTexture, uv));\n            vec4 jzc = toEye(uv, dd);\n            dd = -jzc.z;\n            if(d>dd){\n                if(abs(abs(d) - abs(dd)) <=step){\n                    jd = true;\n                    // albedo = texture2D(colorTexture, uv).rgb;\n                    albedo = guussColor(uv);\n                }\n                break;\n            }\n        }\n    }\n    if(jd){\n        gl_FragColor = vec4(mix(color.xyz,albedo,0.5),1.0);\n    }else{\n        gl_FragColor = color;\n    }\n}",e._shaderToEye=Sg,e._shaderTranslucentPhong=Pg,e.abstract=i,e.checkViewer=he,e.clone=de,e.computeDistancePerPixel=Be,e.computeSceneCenterPoint=Ge,e.computeSceneExtent=He,e.createDefaultLayer=Do,e.createGuid=Ue,e.customPrimitive=Gf,e.dataProcess=mg,e.dateFormat=zn,e.defaultValue=C,e.defined=x,e.destroyObject=Gn,e.getParabolaPoints=function(e,t,i=5e3,n=50){const r=i>5e3?i:5e3,o=Math.abs(e.lon-t.lon)>Math.abs(e.lat-t.lat),s=o?Math.abs(e.lon-t.lon):Math.abs(e.lat-t.lat),a=n>50?n:50,l=[];let c=s/a;if(o){const i=(t.lat-e.lat)/a;e.lon-t.lon>0&&(c=-c);for(let t=0;t<a;t++){const n=r-4*Math.pow(-.5*s+Math.abs(c)*t,2)*r/Math.pow(s,2),o=e.lon+c*t,a=e.lat+i*t;l.push([o,a,n])}}else{const i=(t.lon-e.lon)/a;e.lat-t.lat>0&&(c=-c);for(let t=0;t<a;t++){const n=r-4*Math.pow(-.5*s+Math.abs(c)*t,2)*r/Math.pow(s,2),o=e.lon+i*t,a=e.lat+c*t;l.push([o,a,n])}}return l},e.guid=je,e.index=cu,e.particleSystem=yg,e.particlesComputing=gg,e.particlesRendering=_g,e.pickPosition=Dr,e.proj=Fr,e.randomPosition=function(e,t=1){const i=e.west,n=e.east,r=e.south,o=e.north;t<1&&(t=1);const s=[];for(let e=0;e<t;e++){const e=i+Math.random()*(n-i),t=r+Math.random()*(o-r);s.push(Cesium.Cartesian3.fromRadians(e,t))}return s},e.rotateEnabled=Br,e.util=fg}));
